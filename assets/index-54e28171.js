var C8=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var e0e=C8((bn,_n)=>{function M8(e,t){for(var r=0;r<t.length;r++){const i=t[r];if(typeof i!="string"&&!Array.isArray(i)){for(const n in i)if(n!=="default"&&!(n in e)){const s=Object.getOwnPropertyDescriptor(i,n);s&&Object.defineProperty(e,n,s.get?s:{enumerable:!0,get:()=>i[n]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function r(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=r(n);fetch(n.href,s)}})();function E8(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var rL={exports:{}},uy={},iL={exports:{}},St={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jf=Symbol.for("react.element"),T8=Symbol.for("react.portal"),P8=Symbol.for("react.fragment"),D8=Symbol.for("react.strict_mode"),L8=Symbol.for("react.profiler"),I8=Symbol.for("react.provider"),O8=Symbol.for("react.context"),R8=Symbol.for("react.forward_ref"),B8=Symbol.for("react.suspense"),z8=Symbol.for("react.memo"),k8=Symbol.for("react.lazy"),tC=Symbol.iterator;function N8(e){return e===null||typeof e!="object"?null:(e=tC&&e[tC]||e["@@iterator"],typeof e=="function"?e:null)}var nL={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},sL=Object.assign,aL={};function id(e,t,r){this.props=e,this.context=t,this.refs=aL,this.updater=r||nL}id.prototype.isReactComponent={};id.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};id.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function oL(){}oL.prototype=id.prototype;function K_(e,t,r){this.props=e,this.context=t,this.refs=aL,this.updater=r||nL}var Z_=K_.prototype=new oL;Z_.constructor=K_;sL(Z_,id.prototype);Z_.isPureReactComponent=!0;var rC=Array.isArray,lL=Object.prototype.hasOwnProperty,$_={current:null},cL={key:!0,ref:!0,__self:!0,__source:!0};function hL(e,t,r){var i,n={},s=null,a=null;if(t!=null)for(i in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(s=""+t.key),t)lL.call(t,i)&&!cL.hasOwnProperty(i)&&(n[i]=t[i]);var o=arguments.length-2;if(o===1)n.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];n.children=l}if(e&&e.defaultProps)for(i in o=e.defaultProps,o)n[i]===void 0&&(n[i]=o[i]);return{$$typeof:Jf,type:e,key:s,ref:a,props:n,_owner:$_.current}}function F8(e,t){return{$$typeof:Jf,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function J_(e){return typeof e=="object"&&e!==null&&e.$$typeof===Jf}function U8(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var iC=/\/+/g;function f1(e,t){return typeof e=="object"&&e!==null&&e.key!=null?U8(""+e.key):t.toString(36)}function cv(e,t,r,i,n){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case Jf:case T8:a=!0}}if(a)return a=e,n=n(a),e=i===""?"."+f1(a,0):i,rC(n)?(r="",e!=null&&(r=e.replace(iC,"$&/")+"/"),cv(n,t,r,"",function(c){return c})):n!=null&&(J_(n)&&(n=F8(n,r+(!n.key||a&&a.key===n.key?"":(""+n.key).replace(iC,"$&/")+"/")+e)),t.push(n)),1;if(a=0,i=i===""?".":i+":",rC(e))for(var o=0;o<e.length;o++){s=e[o];var l=i+f1(s,o);a+=cv(s,t,r,l,n)}else if(l=N8(e),typeof l=="function")for(e=l.call(e),o=0;!(s=e.next()).done;)s=s.value,l=i+f1(s,o++),a+=cv(s,t,r,l,n);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function Sm(e,t,r){if(e==null)return e;var i=[],n=0;return cv(e,i,"","",function(s){return t.call(r,s,n++)}),i}function j8(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Ui={current:null},hv={transition:null},V8={ReactCurrentDispatcher:Ui,ReactCurrentBatchConfig:hv,ReactCurrentOwner:$_};St.Children={map:Sm,forEach:function(e,t,r){Sm(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Sm(e,function(){t++}),t},toArray:function(e){return Sm(e,function(t){return t})||[]},only:function(e){if(!J_(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};St.Component=id;St.Fragment=P8;St.Profiler=L8;St.PureComponent=K_;St.StrictMode=D8;St.Suspense=B8;St.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=V8;St.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=sL({},e.props),n=e.key,s=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,a=$_.current),t.key!==void 0&&(n=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)lL.call(t,l)&&!cL.hasOwnProperty(l)&&(i[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)i.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];i.children=o}return{$$typeof:Jf,type:e.type,key:n,ref:s,props:i,_owner:a}};St.createContext=function(e){return e={$$typeof:O8,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:I8,_context:e},e.Consumer=e};St.createElement=hL;St.createFactory=function(e){var t=hL.bind(null,e);return t.type=e,t};St.createRef=function(){return{current:null}};St.forwardRef=function(e){return{$$typeof:R8,render:e}};St.isValidElement=J_;St.lazy=function(e){return{$$typeof:k8,_payload:{_status:-1,_result:e},_init:j8}};St.memo=function(e,t){return{$$typeof:z8,type:e,compare:t===void 0?null:t}};St.startTransition=function(e){var t=hv.transition;hv.transition={};try{e()}finally{hv.transition=t}};St.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};St.useCallback=function(e,t){return Ui.current.useCallback(e,t)};St.useContext=function(e){return Ui.current.useContext(e)};St.useDebugValue=function(){};St.useDeferredValue=function(e){return Ui.current.useDeferredValue(e)};St.useEffect=function(e,t){return Ui.current.useEffect(e,t)};St.useId=function(){return Ui.current.useId()};St.useImperativeHandle=function(e,t,r){return Ui.current.useImperativeHandle(e,t,r)};St.useInsertionEffect=function(e,t){return Ui.current.useInsertionEffect(e,t)};St.useLayoutEffect=function(e,t){return Ui.current.useLayoutEffect(e,t)};St.useMemo=function(e,t){return Ui.current.useMemo(e,t)};St.useReducer=function(e,t,r){return Ui.current.useReducer(e,t,r)};St.useRef=function(e){return Ui.current.useRef(e)};St.useState=function(e){return Ui.current.useState(e)};St.useSyncExternalStore=function(e,t,r){return Ui.current.useSyncExternalStore(e,t,r)};St.useTransition=function(){return Ui.current.useTransition()};St.version="18.2.0";iL.exports=St;var ne=iL.exports;const Yn=E8(ne),H8=M8({__proto__:null,default:Yn},[ne]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var G8=ne,W8=Symbol.for("react.element"),q8=Symbol.for("react.fragment"),X8=Object.prototype.hasOwnProperty,Y8=G8.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Q8={key:!0,ref:!0,__self:!0,__source:!0};function uL(e,t,r){var i,n={},s=null,a=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(a=t.ref);for(i in t)X8.call(t,i)&&!Q8.hasOwnProperty(i)&&(n[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps,t)n[i]===void 0&&(n[i]=t[i]);return{$$typeof:W8,type:e,key:s,ref:a,props:n,_owner:Y8.current}}uy.Fragment=q8;uy.jsx=uL;uy.jsxs=uL;rL.exports=uy;var L=rL.exports,Kw={},dL={exports:{}},Tn={},pL={exports:{}},fL={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(R,q){var F=R.length;R.push(q);e:for(;0<F;){var N=F-1>>>1,j=R[N];if(0<n(j,q))R[N]=q,R[F]=j,F=N;else break e}}function r(R){return R.length===0?null:R[0]}function i(R){if(R.length===0)return null;var q=R[0],F=R.pop();if(F!==q){R[0]=F;e:for(var N=0,j=R.length,K=j>>>1;N<K;){var U=2*(N+1)-1,Y=R[U],V=U+1,ie=R[V];if(0>n(Y,F))V<j&&0>n(ie,Y)?(R[N]=ie,R[V]=F,N=V):(R[N]=Y,R[U]=F,N=U);else if(V<j&&0>n(ie,F))R[N]=ie,R[V]=F,N=V;else break e}}return q}function n(R,q){var F=R.sortIndex-q.sortIndex;return F!==0?F:R.id-q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();e.unstable_now=function(){return a.now()-o}}var l=[],c=[],u=1,h=null,d=3,p=!1,f=!1,m=!1,g=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(R){for(var q=r(c);q!==null;){if(q.callback===null)i(c);else if(q.startTime<=R)i(c),q.sortIndex=q.expirationTime,t(l,q);else break;q=r(c)}}function w(R){if(m=!1,x(R),!f)if(r(l)!==null)f=!0,X(b);else{var q=r(c);q!==null&&H(w,q.startTime-R)}}function b(R,q){f=!1,m&&(m=!1,v(S),S=-1),p=!0;var F=d;try{for(x(q),h=r(l);h!==null&&(!(h.expirationTime>q)||R&&!T());){var N=h.callback;if(typeof N=="function"){h.callback=null,d=h.priorityLevel;var j=N(h.expirationTime<=q);q=e.unstable_now(),typeof j=="function"?h.callback=j:h===r(l)&&i(l),x(q)}else i(l);h=r(l)}if(h!==null)var K=!0;else{var U=r(c);U!==null&&H(w,U.startTime-q),K=!1}return K}finally{h=null,d=F,p=!1}}var _=!1,A=null,S=-1,C=5,M=-1;function T(){return!(e.unstable_now()-M<C)}function P(){if(A!==null){var R=e.unstable_now();M=R;var q=!0;try{q=A(!0,R)}finally{q?D():(_=!1,A=null)}}else _=!1}var D;if(typeof y=="function")D=function(){y(P)};else if(typeof MessageChannel<"u"){var I=new MessageChannel,B=I.port2;I.port1.onmessage=P,D=function(){B.postMessage(null)}}else D=function(){g(P,0)};function X(R){A=R,_||(_=!0,D())}function H(R,q){S=g(function(){R(e.unstable_now())},q)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(R){R.callback=null},e.unstable_continueExecution=function(){f||p||(f=!0,X(b))},e.unstable_forceFrameRate=function(R){0>R||125<R?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<R?Math.floor(1e3/R):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(R){switch(d){case 1:case 2:case 3:var q=3;break;default:q=d}var F=d;d=q;try{return R()}finally{d=F}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(R,q){switch(R){case 1:case 2:case 3:case 4:case 5:break;default:R=3}var F=d;d=R;try{return q()}finally{d=F}},e.unstable_scheduleCallback=function(R,q,F){var N=e.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?N+F:N):F=N,R){case 1:var j=-1;break;case 2:j=250;break;case 5:j=1073741823;break;case 4:j=1e4;break;default:j=5e3}return j=F+j,R={id:u++,callback:q,priorityLevel:R,startTime:F,expirationTime:j,sortIndex:-1},F>N?(R.sortIndex=F,t(c,R),r(l)===null&&R===r(c)&&(m?(v(S),S=-1):m=!0,H(w,F-N))):(R.sortIndex=j,t(l,R),f||p||(f=!0,X(b))),R},e.unstable_shouldYield=T,e.unstable_wrapCallback=function(R){var q=d;return function(){var F=d;d=q;try{return R.apply(this,arguments)}finally{d=F}}}})(fL);pL.exports=fL;var K8=pL.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mL=ne,An=K8;function Me(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var gL=new Set,pf={};function Nc(e,t){Lu(e,t),Lu(e+"Capture",t)}function Lu(e,t){for(pf[e]=t,e=0;e<t.length;e++)gL.add(t[e])}var oo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Zw=Object.prototype.hasOwnProperty,Z8=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,nC={},sC={};function $8(e){return Zw.call(sC,e)?!0:Zw.call(nC,e)?!1:Z8.test(e)?sC[e]=!0:(nC[e]=!0,!1)}function J8(e,t,r,i){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return i?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function eN(e,t,r,i){if(t===null||typeof t>"u"||J8(e,t,r,i))return!0;if(i)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function ji(e,t,r,i,n,s,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=i,this.attributeNamespace=n,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=a}var hi={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){hi[e]=new ji(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];hi[t]=new ji(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){hi[e]=new ji(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){hi[e]=new ji(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){hi[e]=new ji(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){hi[e]=new ji(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){hi[e]=new ji(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){hi[e]=new ji(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){hi[e]=new ji(e,5,!1,e.toLowerCase(),null,!1,!1)});var eS=/[\-:]([a-z])/g;function tS(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(eS,tS);hi[t]=new ji(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(eS,tS);hi[t]=new ji(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(eS,tS);hi[t]=new ji(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){hi[e]=new ji(e,1,!1,e.toLowerCase(),null,!1,!1)});hi.xlinkHref=new ji("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){hi[e]=new ji(e,1,!1,e.toLowerCase(),null,!0,!0)});function rS(e,t,r,i){var n=hi.hasOwnProperty(t)?hi[t]:null;(n!==null?n.type!==0:i||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(eN(t,r,n,i)&&(r=null),i||n===null?$8(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):n.mustUseProperty?e[n.propertyName]=r===null?n.type===3?!1:"":r:(t=n.attributeName,i=n.attributeNamespace,r===null?e.removeAttribute(t):(n=n.type,r=n===3||n===4&&r===!0?"":""+r,i?e.setAttributeNS(i,t,r):e.setAttribute(t,r))))}var mo=mL.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Am=Symbol.for("react.element"),Bh=Symbol.for("react.portal"),zh=Symbol.for("react.fragment"),iS=Symbol.for("react.strict_mode"),$w=Symbol.for("react.profiler"),vL=Symbol.for("react.provider"),yL=Symbol.for("react.context"),nS=Symbol.for("react.forward_ref"),Jw=Symbol.for("react.suspense"),eb=Symbol.for("react.suspense_list"),sS=Symbol.for("react.memo"),ko=Symbol.for("react.lazy"),xL=Symbol.for("react.offscreen"),aC=Symbol.iterator;function Ed(e){return e===null||typeof e!="object"?null:(e=aC&&e[aC]||e["@@iterator"],typeof e=="function"?e:null)}var lr=Object.assign,m1;function xp(e){if(m1===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);m1=t&&t[1]||""}return`
`+m1+e}var g1=!1;function v1(e,t){if(!e||g1)return"";g1=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var i=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){i=c}e.call(t.prototype)}else{try{throw Error()}catch(c){i=c}e()}}catch(c){if(c&&i&&typeof c.stack=="string"){for(var n=c.stack.split(`
`),s=i.stack.split(`
`),a=n.length-1,o=s.length-1;1<=a&&0<=o&&n[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(n[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||n[a]!==s[o]){var l=`
`+n[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=a&&0<=o);break}}}finally{g1=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?xp(e):""}function tN(e){switch(e.tag){case 5:return xp(e.type);case 16:return xp("Lazy");case 13:return xp("Suspense");case 19:return xp("SuspenseList");case 0:case 2:case 15:return e=v1(e.type,!1),e;case 11:return e=v1(e.type.render,!1),e;case 1:return e=v1(e.type,!0),e;default:return""}}function tb(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case zh:return"Fragment";case Bh:return"Portal";case $w:return"Profiler";case iS:return"StrictMode";case Jw:return"Suspense";case eb:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case yL:return(e.displayName||"Context")+".Consumer";case vL:return(e._context.displayName||"Context")+".Provider";case nS:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case sS:return t=e.displayName||null,t!==null?t:tb(e.type)||"Memo";case ko:t=e._payload,e=e._init;try{return tb(e(t))}catch{}}return null}function rN(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return tb(t);case 8:return t===iS?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function xl(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function wL(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function iN(e){var t=wL(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var n=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return n.call(this)},set:function(a){i=""+a,s.call(this,a)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return i},setValue:function(a){i=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Cm(e){e._valueTracker||(e._valueTracker=iN(e))}function bL(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),i="";return e&&(i=wL(e)?e.checked?"true":"false":e.value),e=i,e!==r?(t.setValue(e),!0):!1}function zv(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function rb(e,t){var r=t.checked;return lr({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function oC(e,t){var r=t.defaultValue==null?"":t.defaultValue,i=t.checked!=null?t.checked:t.defaultChecked;r=xl(t.value!=null?t.value:r),e._wrapperState={initialChecked:i,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function _L(e,t){t=t.checked,t!=null&&rS(e,"checked",t,!1)}function ib(e,t){_L(e,t);var r=xl(t.value),i=t.type;if(r!=null)i==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(i==="submit"||i==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?nb(e,t.type,r):t.hasOwnProperty("defaultValue")&&nb(e,t.type,xl(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function lC(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!(i!=="submit"&&i!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function nb(e,t,r){(t!=="number"||zv(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var wp=Array.isArray;function ou(e,t,r,i){if(e=e.options,t){t={};for(var n=0;n<r.length;n++)t["$"+r[n]]=!0;for(r=0;r<e.length;r++)n=t.hasOwnProperty("$"+e[r].value),e[r].selected!==n&&(e[r].selected=n),n&&i&&(e[r].defaultSelected=!0)}else{for(r=""+xl(r),t=null,n=0;n<e.length;n++){if(e[n].value===r){e[n].selected=!0,i&&(e[n].defaultSelected=!0);return}t!==null||e[n].disabled||(t=e[n])}t!==null&&(t.selected=!0)}}function sb(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Me(91));return lr({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function cC(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Me(92));if(wp(r)){if(1<r.length)throw Error(Me(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:xl(r)}}function SL(e,t){var r=xl(t.value),i=xl(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),i!=null&&(e.defaultValue=""+i)}function hC(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function AL(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ab(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?AL(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Mm,CL=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,i,n){MSApp.execUnsafeLocalFunction(function(){return e(t,r,i,n)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Mm=Mm||document.createElement("div"),Mm.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Mm.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function ff(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Rp={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},nN=["Webkit","ms","Moz","O"];Object.keys(Rp).forEach(function(e){nN.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Rp[t]=Rp[e]})});function ML(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Rp.hasOwnProperty(e)&&Rp[e]?(""+t).trim():t+"px"}function EL(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var i=r.indexOf("--")===0,n=ML(r,t[r],i);r==="float"&&(r="cssFloat"),i?e.setProperty(r,n):e[r]=n}}var sN=lr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ob(e,t){if(t){if(sN[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Me(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Me(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Me(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Me(62))}}function lb(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var cb=null;function aS(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var hb=null,lu=null,cu=null;function uC(e){if(e=rm(e)){if(typeof hb!="function")throw Error(Me(280));var t=e.stateNode;t&&(t=gy(t),hb(e.stateNode,e.type,t))}}function TL(e){lu?cu?cu.push(e):cu=[e]:lu=e}function PL(){if(lu){var e=lu,t=cu;if(cu=lu=null,uC(e),t)for(e=0;e<t.length;e++)uC(t[e])}}function DL(e,t){return e(t)}function LL(){}var y1=!1;function IL(e,t,r){if(y1)return e(t,r);y1=!0;try{return DL(e,t,r)}finally{y1=!1,(lu!==null||cu!==null)&&(LL(),PL())}}function mf(e,t){var r=e.stateNode;if(r===null)return null;var i=gy(r);if(i===null)return null;r=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(e=e.type,i=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!i;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Me(231,t,typeof r));return r}var ub=!1;if(oo)try{var Td={};Object.defineProperty(Td,"passive",{get:function(){ub=!0}}),window.addEventListener("test",Td,Td),window.removeEventListener("test",Td,Td)}catch{ub=!1}function aN(e,t,r,i,n,s,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(u){this.onError(u)}}var Bp=!1,kv=null,Nv=!1,db=null,oN={onError:function(e){Bp=!0,kv=e}};function lN(e,t,r,i,n,s,a,o,l){Bp=!1,kv=null,aN.apply(oN,arguments)}function cN(e,t,r,i,n,s,a,o,l){if(lN.apply(this,arguments),Bp){if(Bp){var c=kv;Bp=!1,kv=null}else throw Error(Me(198));Nv||(Nv=!0,db=c)}}function Fc(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function OL(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function dC(e){if(Fc(e)!==e)throw Error(Me(188))}function hN(e){var t=e.alternate;if(!t){if(t=Fc(e),t===null)throw Error(Me(188));return t!==e?null:e}for(var r=e,i=t;;){var n=r.return;if(n===null)break;var s=n.alternate;if(s===null){if(i=n.return,i!==null){r=i;continue}break}if(n.child===s.child){for(s=n.child;s;){if(s===r)return dC(n),e;if(s===i)return dC(n),t;s=s.sibling}throw Error(Me(188))}if(r.return!==i.return)r=n,i=s;else{for(var a=!1,o=n.child;o;){if(o===r){a=!0,r=n,i=s;break}if(o===i){a=!0,i=n,r=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===r){a=!0,r=s,i=n;break}if(o===i){a=!0,i=s,r=n;break}o=o.sibling}if(!a)throw Error(Me(189))}}if(r.alternate!==i)throw Error(Me(190))}if(r.tag!==3)throw Error(Me(188));return r.stateNode.current===r?e:t}function RL(e){return e=hN(e),e!==null?BL(e):null}function BL(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=BL(e);if(t!==null)return t;e=e.sibling}return null}var zL=An.unstable_scheduleCallback,pC=An.unstable_cancelCallback,uN=An.unstable_shouldYield,dN=An.unstable_requestPaint,wr=An.unstable_now,pN=An.unstable_getCurrentPriorityLevel,oS=An.unstable_ImmediatePriority,kL=An.unstable_UserBlockingPriority,Fv=An.unstable_NormalPriority,fN=An.unstable_LowPriority,NL=An.unstable_IdlePriority,dy=null,la=null;function mN(e){if(la&&typeof la.onCommitFiberRoot=="function")try{la.onCommitFiberRoot(dy,e,void 0,(e.current.flags&128)===128)}catch{}}var Ms=Math.clz32?Math.clz32:yN,gN=Math.log,vN=Math.LN2;function yN(e){return e>>>=0,e===0?32:31-(gN(e)/vN|0)|0}var Em=64,Tm=4194304;function bp(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Uv(e,t){var r=e.pendingLanes;if(r===0)return 0;var i=0,n=e.suspendedLanes,s=e.pingedLanes,a=r&268435455;if(a!==0){var o=a&~n;o!==0?i=bp(o):(s&=a,s!==0&&(i=bp(s)))}else a=r&~n,a!==0?i=bp(a):s!==0&&(i=bp(s));if(i===0)return 0;if(t!==0&&t!==i&&!(t&n)&&(n=i&-i,s=t&-t,n>=s||n===16&&(s&4194240)!==0))return t;if(i&4&&(i|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=i;0<t;)r=31-Ms(t),n=1<<r,i|=e[r],t&=~n;return i}function xN(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wN(e,t){for(var r=e.suspendedLanes,i=e.pingedLanes,n=e.expirationTimes,s=e.pendingLanes;0<s;){var a=31-Ms(s),o=1<<a,l=n[a];l===-1?(!(o&r)||o&i)&&(n[a]=xN(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}function pb(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function FL(){var e=Em;return Em<<=1,!(Em&4194240)&&(Em=64),e}function x1(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function em(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Ms(t),e[t]=r}function bN(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<r;){var n=31-Ms(r),s=1<<n;t[n]=0,i[n]=-1,e[n]=-1,r&=~s}}function lS(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var i=31-Ms(r),n=1<<i;n&t|e[i]&t&&(e[i]|=t),r&=~n}}var jt=0;function UL(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var jL,cS,VL,HL,GL,fb=!1,Pm=[],rl=null,il=null,nl=null,gf=new Map,vf=new Map,jo=[],_N="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function fC(e,t){switch(e){case"focusin":case"focusout":rl=null;break;case"dragenter":case"dragleave":il=null;break;case"mouseover":case"mouseout":nl=null;break;case"pointerover":case"pointerout":gf.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":vf.delete(t.pointerId)}}function Pd(e,t,r,i,n,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:i,nativeEvent:s,targetContainers:[n]},t!==null&&(t=rm(t),t!==null&&cS(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,n!==null&&t.indexOf(n)===-1&&t.push(n),e)}function SN(e,t,r,i,n){switch(t){case"focusin":return rl=Pd(rl,e,t,r,i,n),!0;case"dragenter":return il=Pd(il,e,t,r,i,n),!0;case"mouseover":return nl=Pd(nl,e,t,r,i,n),!0;case"pointerover":var s=n.pointerId;return gf.set(s,Pd(gf.get(s)||null,e,t,r,i,n)),!0;case"gotpointercapture":return s=n.pointerId,vf.set(s,Pd(vf.get(s)||null,e,t,r,i,n)),!0}return!1}function WL(e){var t=ac(e.target);if(t!==null){var r=Fc(t);if(r!==null){if(t=r.tag,t===13){if(t=OL(r),t!==null){e.blockedOn=t,GL(e.priority,function(){VL(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function uv(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=mb(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var i=new r.constructor(r.type,r);cb=i,r.target.dispatchEvent(i),cb=null}else return t=rm(r),t!==null&&cS(t),e.blockedOn=r,!1;t.shift()}return!0}function mC(e,t,r){uv(e)&&r.delete(t)}function AN(){fb=!1,rl!==null&&uv(rl)&&(rl=null),il!==null&&uv(il)&&(il=null),nl!==null&&uv(nl)&&(nl=null),gf.forEach(mC),vf.forEach(mC)}function Dd(e,t){e.blockedOn===t&&(e.blockedOn=null,fb||(fb=!0,An.unstable_scheduleCallback(An.unstable_NormalPriority,AN)))}function yf(e){function t(n){return Dd(n,e)}if(0<Pm.length){Dd(Pm[0],e);for(var r=1;r<Pm.length;r++){var i=Pm[r];i.blockedOn===e&&(i.blockedOn=null)}}for(rl!==null&&Dd(rl,e),il!==null&&Dd(il,e),nl!==null&&Dd(nl,e),gf.forEach(t),vf.forEach(t),r=0;r<jo.length;r++)i=jo[r],i.blockedOn===e&&(i.blockedOn=null);for(;0<jo.length&&(r=jo[0],r.blockedOn===null);)WL(r),r.blockedOn===null&&jo.shift()}var hu=mo.ReactCurrentBatchConfig,jv=!0;function CN(e,t,r,i){var n=jt,s=hu.transition;hu.transition=null;try{jt=1,hS(e,t,r,i)}finally{jt=n,hu.transition=s}}function MN(e,t,r,i){var n=jt,s=hu.transition;hu.transition=null;try{jt=4,hS(e,t,r,i)}finally{jt=n,hu.transition=s}}function hS(e,t,r,i){if(jv){var n=mb(e,t,r,i);if(n===null)P1(e,t,i,Vv,r),fC(e,i);else if(SN(n,e,t,r,i))i.stopPropagation();else if(fC(e,i),t&4&&-1<_N.indexOf(e)){for(;n!==null;){var s=rm(n);if(s!==null&&jL(s),s=mb(e,t,r,i),s===null&&P1(e,t,i,Vv,r),s===n)break;n=s}n!==null&&i.stopPropagation()}else P1(e,t,i,null,r)}}var Vv=null;function mb(e,t,r,i){if(Vv=null,e=aS(i),e=ac(e),e!==null)if(t=Fc(e),t===null)e=null;else if(r=t.tag,r===13){if(e=OL(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Vv=e,null}function qL(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(pN()){case oS:return 1;case kL:return 4;case Fv:case fN:return 16;case NL:return 536870912;default:return 16}default:return 16}}var qo=null,uS=null,dv=null;function XL(){if(dv)return dv;var e,t=uS,r=t.length,i,n="value"in qo?qo.value:qo.textContent,s=n.length;for(e=0;e<r&&t[e]===n[e];e++);var a=r-e;for(i=1;i<=a&&t[r-i]===n[s-i];i++);return dv=n.slice(e,1<i?1-i:void 0)}function pv(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Dm(){return!0}function gC(){return!1}function Pn(e){function t(r,i,n,s,a){this._reactName=r,this._targetInst=n,this.type=i,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Dm:gC,this.isPropagationStopped=gC,this}return lr(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Dm)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Dm)},persist:function(){},isPersistent:Dm}),t}var nd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dS=Pn(nd),tm=lr({},nd,{view:0,detail:0}),EN=Pn(tm),w1,b1,Ld,py=lr({},tm,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:pS,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ld&&(Ld&&e.type==="mousemove"?(w1=e.screenX-Ld.screenX,b1=e.screenY-Ld.screenY):b1=w1=0,Ld=e),w1)},movementY:function(e){return"movementY"in e?e.movementY:b1}}),vC=Pn(py),TN=lr({},py,{dataTransfer:0}),PN=Pn(TN),DN=lr({},tm,{relatedTarget:0}),_1=Pn(DN),LN=lr({},nd,{animationName:0,elapsedTime:0,pseudoElement:0}),IN=Pn(LN),ON=lr({},nd,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),RN=Pn(ON),BN=lr({},nd,{data:0}),yC=Pn(BN),zN={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kN={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},NN={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function FN(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=NN[e])?!!t[e]:!1}function pS(){return FN}var UN=lr({},tm,{key:function(e){if(e.key){var t=zN[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=pv(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?kN[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:pS,charCode:function(e){return e.type==="keypress"?pv(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?pv(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),jN=Pn(UN),VN=lr({},py,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),xC=Pn(VN),HN=lr({},tm,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:pS}),GN=Pn(HN),WN=lr({},nd,{propertyName:0,elapsedTime:0,pseudoElement:0}),qN=Pn(WN),XN=lr({},py,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),YN=Pn(XN),QN=[9,13,27,32],fS=oo&&"CompositionEvent"in window,zp=null;oo&&"documentMode"in document&&(zp=document.documentMode);var KN=oo&&"TextEvent"in window&&!zp,YL=oo&&(!fS||zp&&8<zp&&11>=zp),wC=String.fromCharCode(32),bC=!1;function QL(e,t){switch(e){case"keyup":return QN.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function KL(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var kh=!1;function ZN(e,t){switch(e){case"compositionend":return KL(t);case"keypress":return t.which!==32?null:(bC=!0,wC);case"textInput":return e=t.data,e===wC&&bC?null:e;default:return null}}function $N(e,t){if(kh)return e==="compositionend"||!fS&&QL(e,t)?(e=XL(),dv=uS=qo=null,kh=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return YL&&t.locale!=="ko"?null:t.data;default:return null}}var JN={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _C(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!JN[e.type]:t==="textarea"}function ZL(e,t,r,i){TL(i),t=Hv(t,"onChange"),0<t.length&&(r=new dS("onChange","change",null,r,i),e.push({event:r,listeners:t}))}var kp=null,xf=null;function e7(e){l6(e,0)}function fy(e){var t=Uh(e);if(bL(t))return e}function t7(e,t){if(e==="change")return t}var $L=!1;if(oo){var S1;if(oo){var A1="oninput"in document;if(!A1){var SC=document.createElement("div");SC.setAttribute("oninput","return;"),A1=typeof SC.oninput=="function"}S1=A1}else S1=!1;$L=S1&&(!document.documentMode||9<document.documentMode)}function AC(){kp&&(kp.detachEvent("onpropertychange",JL),xf=kp=null)}function JL(e){if(e.propertyName==="value"&&fy(xf)){var t=[];ZL(t,xf,e,aS(e)),IL(e7,t)}}function r7(e,t,r){e==="focusin"?(AC(),kp=t,xf=r,kp.attachEvent("onpropertychange",JL)):e==="focusout"&&AC()}function i7(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return fy(xf)}function n7(e,t){if(e==="click")return fy(t)}function s7(e,t){if(e==="input"||e==="change")return fy(t)}function a7(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ps=typeof Object.is=="function"?Object.is:a7;function wf(e,t){if(Ps(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),i=Object.keys(t);if(r.length!==i.length)return!1;for(i=0;i<r.length;i++){var n=r[i];if(!Zw.call(t,n)||!Ps(e[n],t[n]))return!1}return!0}function CC(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function MC(e,t){var r=CC(e);e=0;for(var i;r;){if(r.nodeType===3){if(i=e+r.textContent.length,e<=t&&i>=t)return{node:r,offset:t-e};e=i}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=CC(r)}}function e6(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?e6(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function t6(){for(var e=window,t=zv();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=zv(e.document)}return t}function mS(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function o7(e){var t=t6(),r=e.focusedElem,i=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&e6(r.ownerDocument.documentElement,r)){if(i!==null&&mS(r)){if(t=i.start,e=i.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var n=r.textContent.length,s=Math.min(i.start,n);i=i.end===void 0?s:Math.min(i.end,n),!e.extend&&s>i&&(n=i,i=s,s=n),n=MC(r,s);var a=MC(r,i);n&&a&&(e.rangeCount!==1||e.anchorNode!==n.node||e.anchorOffset!==n.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(n.node,n.offset),e.removeAllRanges(),s>i?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var l7=oo&&"documentMode"in document&&11>=document.documentMode,Nh=null,gb=null,Np=null,vb=!1;function EC(e,t,r){var i=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;vb||Nh==null||Nh!==zv(i)||(i=Nh,"selectionStart"in i&&mS(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Np&&wf(Np,i)||(Np=i,i=Hv(gb,"onSelect"),0<i.length&&(t=new dS("onSelect","select",null,t,r),e.push({event:t,listeners:i}),t.target=Nh)))}function Lm(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Fh={animationend:Lm("Animation","AnimationEnd"),animationiteration:Lm("Animation","AnimationIteration"),animationstart:Lm("Animation","AnimationStart"),transitionend:Lm("Transition","TransitionEnd")},C1={},r6={};oo&&(r6=document.createElement("div").style,"AnimationEvent"in window||(delete Fh.animationend.animation,delete Fh.animationiteration.animation,delete Fh.animationstart.animation),"TransitionEvent"in window||delete Fh.transitionend.transition);function my(e){if(C1[e])return C1[e];if(!Fh[e])return e;var t=Fh[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in r6)return C1[e]=t[r];return e}var i6=my("animationend"),n6=my("animationiteration"),s6=my("animationstart"),a6=my("transitionend"),o6=new Map,TC="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ml(e,t){o6.set(e,t),Nc(t,[e])}for(var M1=0;M1<TC.length;M1++){var E1=TC[M1],c7=E1.toLowerCase(),h7=E1[0].toUpperCase()+E1.slice(1);Ml(c7,"on"+h7)}Ml(i6,"onAnimationEnd");Ml(n6,"onAnimationIteration");Ml(s6,"onAnimationStart");Ml("dblclick","onDoubleClick");Ml("focusin","onFocus");Ml("focusout","onBlur");Ml(a6,"onTransitionEnd");Lu("onMouseEnter",["mouseout","mouseover"]);Lu("onMouseLeave",["mouseout","mouseover"]);Lu("onPointerEnter",["pointerout","pointerover"]);Lu("onPointerLeave",["pointerout","pointerover"]);Nc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Nc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Nc("onBeforeInput",["compositionend","keypress","textInput","paste"]);Nc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Nc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Nc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var _p="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),u7=new Set("cancel close invalid load scroll toggle".split(" ").concat(_p));function PC(e,t,r){var i=e.type||"unknown-event";e.currentTarget=r,cN(i,t,void 0,e),e.currentTarget=null}function l6(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var i=e[r],n=i.event;i=i.listeners;e:{var s=void 0;if(t)for(var a=i.length-1;0<=a;a--){var o=i[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&n.isPropagationStopped())break e;PC(n,o,c),s=l}else for(a=0;a<i.length;a++){if(o=i[a],l=o.instance,c=o.currentTarget,o=o.listener,l!==s&&n.isPropagationStopped())break e;PC(n,o,c),s=l}}}if(Nv)throw e=db,Nv=!1,db=null,e}function Jt(e,t){var r=t[_b];r===void 0&&(r=t[_b]=new Set);var i=e+"__bubble";r.has(i)||(c6(t,e,2,!1),r.add(i))}function T1(e,t,r){var i=0;t&&(i|=4),c6(r,e,i,t)}var Im="_reactListening"+Math.random().toString(36).slice(2);function bf(e){if(!e[Im]){e[Im]=!0,gL.forEach(function(r){r!=="selectionchange"&&(u7.has(r)||T1(r,!1,e),T1(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Im]||(t[Im]=!0,T1("selectionchange",!1,t))}}function c6(e,t,r,i){switch(qL(t)){case 1:var n=CN;break;case 4:n=MN;break;default:n=hS}r=n.bind(null,t,r,e),n=void 0,!ub||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(n=!0),i?n!==void 0?e.addEventListener(t,r,{capture:!0,passive:n}):e.addEventListener(t,r,!0):n!==void 0?e.addEventListener(t,r,{passive:n}):e.addEventListener(t,r,!1)}function P1(e,t,r,i,n){var s=i;if(!(t&1)&&!(t&2)&&i!==null)e:for(;;){if(i===null)return;var a=i.tag;if(a===3||a===4){var o=i.stateNode.containerInfo;if(o===n||o.nodeType===8&&o.parentNode===n)break;if(a===4)for(a=i.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===n||l.nodeType===8&&l.parentNode===n))return;a=a.return}for(;o!==null;){if(a=ac(o),a===null)return;if(l=a.tag,l===5||l===6){i=s=a;continue e}o=o.parentNode}}i=i.return}IL(function(){var c=s,u=aS(r),h=[];e:{var d=o6.get(e);if(d!==void 0){var p=dS,f=e;switch(e){case"keypress":if(pv(r)===0)break e;case"keydown":case"keyup":p=jN;break;case"focusin":f="focus",p=_1;break;case"focusout":f="blur",p=_1;break;case"beforeblur":case"afterblur":p=_1;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=vC;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=PN;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=GN;break;case i6:case n6:case s6:p=IN;break;case a6:p=qN;break;case"scroll":p=EN;break;case"wheel":p=YN;break;case"copy":case"cut":case"paste":p=RN;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=xC}var m=(t&4)!==0,g=!m&&e==="scroll",v=m?d!==null?d+"Capture":null:d;m=[];for(var y=c,x;y!==null;){x=y;var w=x.stateNode;if(x.tag===5&&w!==null&&(x=w,v!==null&&(w=mf(y,v),w!=null&&m.push(_f(y,w,x)))),g)break;y=y.return}0<m.length&&(d=new p(d,f,null,r,u),h.push({event:d,listeners:m}))}}if(!(t&7)){e:{if(d=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",d&&r!==cb&&(f=r.relatedTarget||r.fromElement)&&(ac(f)||f[lo]))break e;if((p||d)&&(d=u.window===u?u:(d=u.ownerDocument)?d.defaultView||d.parentWindow:window,p?(f=r.relatedTarget||r.toElement,p=c,f=f?ac(f):null,f!==null&&(g=Fc(f),f!==g||f.tag!==5&&f.tag!==6)&&(f=null)):(p=null,f=c),p!==f)){if(m=vC,w="onMouseLeave",v="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(m=xC,w="onPointerLeave",v="onPointerEnter",y="pointer"),g=p==null?d:Uh(p),x=f==null?d:Uh(f),d=new m(w,y+"leave",p,r,u),d.target=g,d.relatedTarget=x,w=null,ac(u)===c&&(m=new m(v,y+"enter",f,r,u),m.target=x,m.relatedTarget=g,w=m),g=w,p&&f)t:{for(m=p,v=f,y=0,x=m;x;x=Zc(x))y++;for(x=0,w=v;w;w=Zc(w))x++;for(;0<y-x;)m=Zc(m),y--;for(;0<x-y;)v=Zc(v),x--;for(;y--;){if(m===v||v!==null&&m===v.alternate)break t;m=Zc(m),v=Zc(v)}m=null}else m=null;p!==null&&DC(h,d,p,m,!1),f!==null&&g!==null&&DC(h,g,f,m,!0)}}e:{if(d=c?Uh(c):window,p=d.nodeName&&d.nodeName.toLowerCase(),p==="select"||p==="input"&&d.type==="file")var b=t7;else if(_C(d))if($L)b=s7;else{b=i7;var _=r7}else(p=d.nodeName)&&p.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(b=n7);if(b&&(b=b(e,c))){ZL(h,b,r,u);break e}_&&_(e,d,c),e==="focusout"&&(_=d._wrapperState)&&_.controlled&&d.type==="number"&&nb(d,"number",d.value)}switch(_=c?Uh(c):window,e){case"focusin":(_C(_)||_.contentEditable==="true")&&(Nh=_,gb=c,Np=null);break;case"focusout":Np=gb=Nh=null;break;case"mousedown":vb=!0;break;case"contextmenu":case"mouseup":case"dragend":vb=!1,EC(h,r,u);break;case"selectionchange":if(l7)break;case"keydown":case"keyup":EC(h,r,u)}var A;if(fS)e:{switch(e){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else kh?QL(e,r)&&(S="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(S="onCompositionStart");S&&(YL&&r.locale!=="ko"&&(kh||S!=="onCompositionStart"?S==="onCompositionEnd"&&kh&&(A=XL()):(qo=u,uS="value"in qo?qo.value:qo.textContent,kh=!0)),_=Hv(c,S),0<_.length&&(S=new yC(S,e,null,r,u),h.push({event:S,listeners:_}),A?S.data=A:(A=KL(r),A!==null&&(S.data=A)))),(A=KN?ZN(e,r):$N(e,r))&&(c=Hv(c,"onBeforeInput"),0<c.length&&(u=new yC("onBeforeInput","beforeinput",null,r,u),h.push({event:u,listeners:c}),u.data=A))}l6(h,t)})}function _f(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Hv(e,t){for(var r=t+"Capture",i=[];e!==null;){var n=e,s=n.stateNode;n.tag===5&&s!==null&&(n=s,s=mf(e,r),s!=null&&i.unshift(_f(e,s,n)),s=mf(e,t),s!=null&&i.push(_f(e,s,n))),e=e.return}return i}function Zc(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function DC(e,t,r,i,n){for(var s=t._reactName,a=[];r!==null&&r!==i;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===i)break;o.tag===5&&c!==null&&(o=c,n?(l=mf(r,s),l!=null&&a.unshift(_f(r,l,o))):n||(l=mf(r,s),l!=null&&a.push(_f(r,l,o)))),r=r.return}a.length!==0&&e.push({event:t,listeners:a})}var d7=/\r\n?/g,p7=/\u0000|\uFFFD/g;function LC(e){return(typeof e=="string"?e:""+e).replace(d7,`
`).replace(p7,"")}function Om(e,t,r){if(t=LC(t),LC(e)!==t&&r)throw Error(Me(425))}function Gv(){}var yb=null,xb=null;function wb(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var bb=typeof setTimeout=="function"?setTimeout:void 0,f7=typeof clearTimeout=="function"?clearTimeout:void 0,IC=typeof Promise=="function"?Promise:void 0,m7=typeof queueMicrotask=="function"?queueMicrotask:typeof IC<"u"?function(e){return IC.resolve(null).then(e).catch(g7)}:bb;function g7(e){setTimeout(function(){throw e})}function D1(e,t){var r=t,i=0;do{var n=r.nextSibling;if(e.removeChild(r),n&&n.nodeType===8)if(r=n.data,r==="/$"){if(i===0){e.removeChild(n),yf(t);return}i--}else r!=="$"&&r!=="$?"&&r!=="$!"||i++;r=n}while(r);yf(t)}function sl(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function OC(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var sd=Math.random().toString(36).slice(2),ea="__reactFiber$"+sd,Sf="__reactProps$"+sd,lo="__reactContainer$"+sd,_b="__reactEvents$"+sd,v7="__reactListeners$"+sd,y7="__reactHandles$"+sd;function ac(e){var t=e[ea];if(t)return t;for(var r=e.parentNode;r;){if(t=r[lo]||r[ea]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=OC(e);e!==null;){if(r=e[ea])return r;e=OC(e)}return t}e=r,r=e.parentNode}return null}function rm(e){return e=e[ea]||e[lo],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Uh(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Me(33))}function gy(e){return e[Sf]||null}var Sb=[],jh=-1;function El(e){return{current:e}}function tr(e){0>jh||(e.current=Sb[jh],Sb[jh]=null,jh--)}function $t(e,t){jh++,Sb[jh]=e.current,e.current=t}var wl={},_i=El(wl),Ji=El(!1),Cc=wl;function Iu(e,t){var r=e.type.contextTypes;if(!r)return wl;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var n={},s;for(s in r)n[s]=t[s];return i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=n),n}function en(e){return e=e.childContextTypes,e!=null}function Wv(){tr(Ji),tr(_i)}function RC(e,t,r){if(_i.current!==wl)throw Error(Me(168));$t(_i,t),$t(Ji,r)}function h6(e,t,r){var i=e.stateNode;if(t=t.childContextTypes,typeof i.getChildContext!="function")return r;i=i.getChildContext();for(var n in i)if(!(n in t))throw Error(Me(108,rN(e)||"Unknown",n));return lr({},r,i)}function qv(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||wl,Cc=_i.current,$t(_i,e),$t(Ji,Ji.current),!0}function BC(e,t,r){var i=e.stateNode;if(!i)throw Error(Me(169));r?(e=h6(e,t,Cc),i.__reactInternalMemoizedMergedChildContext=e,tr(Ji),tr(_i),$t(_i,e)):tr(Ji),$t(Ji,r)}var Ha=null,vy=!1,L1=!1;function u6(e){Ha===null?Ha=[e]:Ha.push(e)}function x7(e){vy=!0,u6(e)}function Tl(){if(!L1&&Ha!==null){L1=!0;var e=0,t=jt;try{var r=Ha;for(jt=1;e<r.length;e++){var i=r[e];do i=i(!0);while(i!==null)}Ha=null,vy=!1}catch(n){throw Ha!==null&&(Ha=Ha.slice(e+1)),zL(oS,Tl),n}finally{jt=t,L1=!1}}return null}var Vh=[],Hh=0,Xv=null,Yv=0,jn=[],Vn=0,Mc=null,Ya=1,Qa="";function ql(e,t){Vh[Hh++]=Yv,Vh[Hh++]=Xv,Xv=e,Yv=t}function d6(e,t,r){jn[Vn++]=Ya,jn[Vn++]=Qa,jn[Vn++]=Mc,Mc=e;var i=Ya;e=Qa;var n=32-Ms(i)-1;i&=~(1<<n),r+=1;var s=32-Ms(t)+n;if(30<s){var a=n-n%5;s=(i&(1<<a)-1).toString(32),i>>=a,n-=a,Ya=1<<32-Ms(t)+n|r<<n|i,Qa=s+e}else Ya=1<<s|r<<n|i,Qa=e}function gS(e){e.return!==null&&(ql(e,1),d6(e,1,0))}function vS(e){for(;e===Xv;)Xv=Vh[--Hh],Vh[Hh]=null,Yv=Vh[--Hh],Vh[Hh]=null;for(;e===Mc;)Mc=jn[--Vn],jn[Vn]=null,Qa=jn[--Vn],jn[Vn]=null,Ya=jn[--Vn],jn[Vn]=null}var Sn=null,vn=null,ir=!1,vs=null;function p6(e,t){var r=Xn(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function zC(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Sn=e,vn=sl(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Sn=e,vn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Mc!==null?{id:Ya,overflow:Qa}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Xn(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Sn=e,vn=null,!0):!1;default:return!1}}function Ab(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Cb(e){if(ir){var t=vn;if(t){var r=t;if(!zC(e,t)){if(Ab(e))throw Error(Me(418));t=sl(r.nextSibling);var i=Sn;t&&zC(e,t)?p6(i,r):(e.flags=e.flags&-4097|2,ir=!1,Sn=e)}}else{if(Ab(e))throw Error(Me(418));e.flags=e.flags&-4097|2,ir=!1,Sn=e}}}function kC(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Sn=e}function Rm(e){if(e!==Sn)return!1;if(!ir)return kC(e),ir=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!wb(e.type,e.memoizedProps)),t&&(t=vn)){if(Ab(e))throw f6(),Error(Me(418));for(;t;)p6(e,t),t=sl(t.nextSibling)}if(kC(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Me(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){vn=sl(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}vn=null}}else vn=Sn?sl(e.stateNode.nextSibling):null;return!0}function f6(){for(var e=vn;e;)e=sl(e.nextSibling)}function Ou(){vn=Sn=null,ir=!1}function yS(e){vs===null?vs=[e]:vs.push(e)}var w7=mo.ReactCurrentBatchConfig;function fs(e,t){if(e&&e.defaultProps){t=lr({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}var Qv=El(null),Kv=null,Gh=null,xS=null;function wS(){xS=Gh=Kv=null}function bS(e){var t=Qv.current;tr(Qv),e._currentValue=t}function Mb(e,t,r){for(;e!==null;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===r)break;e=e.return}}function uu(e,t){Kv=e,xS=Gh=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Qi=!0),e.firstContext=null)}function Jn(e){var t=e._currentValue;if(xS!==e)if(e={context:e,memoizedValue:t,next:null},Gh===null){if(Kv===null)throw Error(Me(308));Gh=e,Kv.dependencies={lanes:0,firstContext:e}}else Gh=Gh.next=e;return t}var oc=null;function _S(e){oc===null?oc=[e]:oc.push(e)}function m6(e,t,r,i){var n=t.interleaved;return n===null?(r.next=r,_S(t)):(r.next=n.next,n.next=r),t.interleaved=r,co(e,i)}function co(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var No=!1;function SS(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function g6(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ja(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function al(e,t,r){var i=e.updateQueue;if(i===null)return null;if(i=i.shared,Dt&2){var n=i.pending;return n===null?t.next=t:(t.next=n.next,n.next=t),i.pending=t,co(e,r)}return n=i.interleaved,n===null?(t.next=t,_S(i)):(t.next=n.next,n.next=t),i.interleaved=t,co(e,r)}function fv(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var i=t.lanes;i&=e.pendingLanes,r|=i,t.lanes=r,lS(e,r)}}function NC(e,t){var r=e.updateQueue,i=e.alternate;if(i!==null&&(i=i.updateQueue,r===i)){var n=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?n=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?n=s=t:s=s.next=t}else n=s=t;r={baseState:i.baseState,firstBaseUpdate:n,lastBaseUpdate:s,shared:i.shared,effects:i.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Zv(e,t,r,i){var n=e.updateQueue;No=!1;var s=n.firstBaseUpdate,a=n.lastBaseUpdate,o=n.shared.pending;if(o!==null){n.shared.pending=null;var l=o,c=l.next;l.next=null,a===null?s=c:a.next=c,a=l;var u=e.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==a&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(s!==null){var h=n.baseState;a=0,u=c=l=null,o=s;do{var d=o.lane,p=o.eventTime;if((i&d)===d){u!==null&&(u=u.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var f=e,m=o;switch(d=t,p=r,m.tag){case 1:if(f=m.payload,typeof f=="function"){h=f.call(p,h,d);break e}h=f;break e;case 3:f.flags=f.flags&-65537|128;case 0:if(f=m.payload,d=typeof f=="function"?f.call(p,h,d):f,d==null)break e;h=lr({},h,d);break e;case 2:No=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,d=n.effects,d===null?n.effects=[o]:d.push(o))}else p={eventTime:p,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=p,l=h):u=u.next=p,a|=d;if(o=o.next,o===null){if(o=n.shared.pending,o===null)break;d=o,o=d.next,d.next=null,n.lastBaseUpdate=d,n.shared.pending=null}}while(1);if(u===null&&(l=h),n.baseState=l,n.firstBaseUpdate=c,n.lastBaseUpdate=u,t=n.shared.interleaved,t!==null){n=t;do a|=n.lane,n=n.next;while(n!==t)}else s===null&&(n.shared.lanes=0);Tc|=a,e.lanes=a,e.memoizedState=h}}function FC(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var i=e[t],n=i.callback;if(n!==null){if(i.callback=null,i=r,typeof n!="function")throw Error(Me(191,n));n.call(i)}}}var v6=new mL.Component().refs;function Eb(e,t,r,i){t=e.memoizedState,r=r(i,t),r=r==null?t:lr({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var yy={isMounted:function(e){return(e=e._reactInternals)?Fc(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var i=ki(),n=ll(e),s=Ja(i,n);s.payload=t,r!=null&&(s.callback=r),t=al(e,s,n),t!==null&&(Es(t,e,n,i),fv(t,e,n))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var i=ki(),n=ll(e),s=Ja(i,n);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=al(e,s,n),t!==null&&(Es(t,e,n,i),fv(t,e,n))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=ki(),i=ll(e),n=Ja(r,i);n.tag=2,t!=null&&(n.callback=t),t=al(e,n,i),t!==null&&(Es(t,e,i,r),fv(t,e,i))}};function UC(e,t,r,i,n,s,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(i,s,a):t.prototype&&t.prototype.isPureReactComponent?!wf(r,i)||!wf(n,s):!0}function y6(e,t,r){var i=!1,n=wl,s=t.contextType;return typeof s=="object"&&s!==null?s=Jn(s):(n=en(t)?Cc:_i.current,i=t.contextTypes,s=(i=i!=null)?Iu(e,n):wl),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=yy,e.stateNode=t,t._reactInternals=e,i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=s),t}function jC(e,t,r,i){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,i),t.state!==e&&yy.enqueueReplaceState(t,t.state,null)}function Tb(e,t,r,i){var n=e.stateNode;n.props=r,n.state=e.memoizedState,n.refs=v6,SS(e);var s=t.contextType;typeof s=="object"&&s!==null?n.context=Jn(s):(s=en(t)?Cc:_i.current,n.context=Iu(e,s)),n.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(Eb(e,t,s,r),n.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof n.getSnapshotBeforeUpdate=="function"||typeof n.UNSAFE_componentWillMount!="function"&&typeof n.componentWillMount!="function"||(t=n.state,typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount(),t!==n.state&&yy.enqueueReplaceState(n,n.state,null),Zv(e,r,n,i),n.state=e.memoizedState),typeof n.componentDidMount=="function"&&(e.flags|=4194308)}function Id(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Me(309));var i=r.stateNode}if(!i)throw Error(Me(147,e));var n=i,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(a){var o=n.refs;o===v6&&(o=n.refs={}),a===null?delete o[s]:o[s]=a},t._stringRef=s,t)}if(typeof e!="string")throw Error(Me(284));if(!r._owner)throw Error(Me(290,e))}return e}function Bm(e,t){throw e=Object.prototype.toString.call(t),Error(Me(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function VC(e){var t=e._init;return t(e._payload)}function x6(e){function t(v,y){if(e){var x=v.deletions;x===null?(v.deletions=[y],v.flags|=16):x.push(y)}}function r(v,y){if(!e)return null;for(;y!==null;)t(v,y),y=y.sibling;return null}function i(v,y){for(v=new Map;y!==null;)y.key!==null?v.set(y.key,y):v.set(y.index,y),y=y.sibling;return v}function n(v,y){return v=cl(v,y),v.index=0,v.sibling=null,v}function s(v,y,x){return v.index=x,e?(x=v.alternate,x!==null?(x=x.index,x<y?(v.flags|=2,y):x):(v.flags|=2,y)):(v.flags|=1048576,y)}function a(v){return e&&v.alternate===null&&(v.flags|=2),v}function o(v,y,x,w){return y===null||y.tag!==6?(y=N1(x,v.mode,w),y.return=v,y):(y=n(y,x),y.return=v,y)}function l(v,y,x,w){var b=x.type;return b===zh?u(v,y,x.props.children,w,x.key):y!==null&&(y.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===ko&&VC(b)===y.type)?(w=n(y,x.props),w.ref=Id(v,y,x),w.return=v,w):(w=wv(x.type,x.key,x.props,null,v.mode,w),w.ref=Id(v,y,x),w.return=v,w)}function c(v,y,x,w){return y===null||y.tag!==4||y.stateNode.containerInfo!==x.containerInfo||y.stateNode.implementation!==x.implementation?(y=F1(x,v.mode,w),y.return=v,y):(y=n(y,x.children||[]),y.return=v,y)}function u(v,y,x,w,b){return y===null||y.tag!==7?(y=vc(x,v.mode,w,b),y.return=v,y):(y=n(y,x),y.return=v,y)}function h(v,y,x){if(typeof y=="string"&&y!==""||typeof y=="number")return y=N1(""+y,v.mode,x),y.return=v,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Am:return x=wv(y.type,y.key,y.props,null,v.mode,x),x.ref=Id(v,null,y),x.return=v,x;case Bh:return y=F1(y,v.mode,x),y.return=v,y;case ko:var w=y._init;return h(v,w(y._payload),x)}if(wp(y)||Ed(y))return y=vc(y,v.mode,x,null),y.return=v,y;Bm(v,y)}return null}function d(v,y,x,w){var b=y!==null?y.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return b!==null?null:o(v,y,""+x,w);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Am:return x.key===b?l(v,y,x,w):null;case Bh:return x.key===b?c(v,y,x,w):null;case ko:return b=x._init,d(v,y,b(x._payload),w)}if(wp(x)||Ed(x))return b!==null?null:u(v,y,x,w,null);Bm(v,x)}return null}function p(v,y,x,w,b){if(typeof w=="string"&&w!==""||typeof w=="number")return v=v.get(x)||null,o(y,v,""+w,b);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Am:return v=v.get(w.key===null?x:w.key)||null,l(y,v,w,b);case Bh:return v=v.get(w.key===null?x:w.key)||null,c(y,v,w,b);case ko:var _=w._init;return p(v,y,x,_(w._payload),b)}if(wp(w)||Ed(w))return v=v.get(x)||null,u(y,v,w,b,null);Bm(y,w)}return null}function f(v,y,x,w){for(var b=null,_=null,A=y,S=y=0,C=null;A!==null&&S<x.length;S++){A.index>S?(C=A,A=null):C=A.sibling;var M=d(v,A,x[S],w);if(M===null){A===null&&(A=C);break}e&&A&&M.alternate===null&&t(v,A),y=s(M,y,S),_===null?b=M:_.sibling=M,_=M,A=C}if(S===x.length)return r(v,A),ir&&ql(v,S),b;if(A===null){for(;S<x.length;S++)A=h(v,x[S],w),A!==null&&(y=s(A,y,S),_===null?b=A:_.sibling=A,_=A);return ir&&ql(v,S),b}for(A=i(v,A);S<x.length;S++)C=p(A,v,S,x[S],w),C!==null&&(e&&C.alternate!==null&&A.delete(C.key===null?S:C.key),y=s(C,y,S),_===null?b=C:_.sibling=C,_=C);return e&&A.forEach(function(T){return t(v,T)}),ir&&ql(v,S),b}function m(v,y,x,w){var b=Ed(x);if(typeof b!="function")throw Error(Me(150));if(x=b.call(x),x==null)throw Error(Me(151));for(var _=b=null,A=y,S=y=0,C=null,M=x.next();A!==null&&!M.done;S++,M=x.next()){A.index>S?(C=A,A=null):C=A.sibling;var T=d(v,A,M.value,w);if(T===null){A===null&&(A=C);break}e&&A&&T.alternate===null&&t(v,A),y=s(T,y,S),_===null?b=T:_.sibling=T,_=T,A=C}if(M.done)return r(v,A),ir&&ql(v,S),b;if(A===null){for(;!M.done;S++,M=x.next())M=h(v,M.value,w),M!==null&&(y=s(M,y,S),_===null?b=M:_.sibling=M,_=M);return ir&&ql(v,S),b}for(A=i(v,A);!M.done;S++,M=x.next())M=p(A,v,S,M.value,w),M!==null&&(e&&M.alternate!==null&&A.delete(M.key===null?S:M.key),y=s(M,y,S),_===null?b=M:_.sibling=M,_=M);return e&&A.forEach(function(P){return t(v,P)}),ir&&ql(v,S),b}function g(v,y,x,w){if(typeof x=="object"&&x!==null&&x.type===zh&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case Am:e:{for(var b=x.key,_=y;_!==null;){if(_.key===b){if(b=x.type,b===zh){if(_.tag===7){r(v,_.sibling),y=n(_,x.props.children),y.return=v,v=y;break e}}else if(_.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===ko&&VC(b)===_.type){r(v,_.sibling),y=n(_,x.props),y.ref=Id(v,_,x),y.return=v,v=y;break e}r(v,_);break}else t(v,_);_=_.sibling}x.type===zh?(y=vc(x.props.children,v.mode,w,x.key),y.return=v,v=y):(w=wv(x.type,x.key,x.props,null,v.mode,w),w.ref=Id(v,y,x),w.return=v,v=w)}return a(v);case Bh:e:{for(_=x.key;y!==null;){if(y.key===_)if(y.tag===4&&y.stateNode.containerInfo===x.containerInfo&&y.stateNode.implementation===x.implementation){r(v,y.sibling),y=n(y,x.children||[]),y.return=v,v=y;break e}else{r(v,y);break}else t(v,y);y=y.sibling}y=F1(x,v.mode,w),y.return=v,v=y}return a(v);case ko:return _=x._init,g(v,y,_(x._payload),w)}if(wp(x))return f(v,y,x,w);if(Ed(x))return m(v,y,x,w);Bm(v,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,y!==null&&y.tag===6?(r(v,y.sibling),y=n(y,x),y.return=v,v=y):(r(v,y),y=N1(x,v.mode,w),y.return=v,v=y),a(v)):r(v,y)}return g}var Ru=x6(!0),w6=x6(!1),im={},ca=El(im),Af=El(im),Cf=El(im);function lc(e){if(e===im)throw Error(Me(174));return e}function AS(e,t){switch($t(Cf,t),$t(Af,e),$t(ca,im),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ab(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=ab(t,e)}tr(ca),$t(ca,t)}function Bu(){tr(ca),tr(Af),tr(Cf)}function b6(e){lc(Cf.current);var t=lc(ca.current),r=ab(t,e.type);t!==r&&($t(Af,e),$t(ca,r))}function CS(e){Af.current===e&&(tr(ca),tr(Af))}var nr=El(0);function $v(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var I1=[];function MS(){for(var e=0;e<I1.length;e++)I1[e]._workInProgressVersionPrimary=null;I1.length=0}var mv=mo.ReactCurrentDispatcher,O1=mo.ReactCurrentBatchConfig,Ec=0,or=null,Nr=null,Kr=null,Jv=!1,Fp=!1,Mf=0,b7=0;function pi(){throw Error(Me(321))}function ES(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Ps(e[r],t[r]))return!1;return!0}function TS(e,t,r,i,n,s){if(Ec=s,or=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,mv.current=e===null||e.memoizedState===null?C7:M7,e=r(i,n),Fp){s=0;do{if(Fp=!1,Mf=0,25<=s)throw Error(Me(301));s+=1,Kr=Nr=null,t.updateQueue=null,mv.current=E7,e=r(i,n)}while(Fp)}if(mv.current=e0,t=Nr!==null&&Nr.next!==null,Ec=0,Kr=Nr=or=null,Jv=!1,t)throw Error(Me(300));return e}function PS(){var e=Mf!==0;return Mf=0,e}function Ys(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Kr===null?or.memoizedState=Kr=e:Kr=Kr.next=e,Kr}function es(){if(Nr===null){var e=or.alternate;e=e!==null?e.memoizedState:null}else e=Nr.next;var t=Kr===null?or.memoizedState:Kr.next;if(t!==null)Kr=t,Nr=e;else{if(e===null)throw Error(Me(310));Nr=e,e={memoizedState:Nr.memoizedState,baseState:Nr.baseState,baseQueue:Nr.baseQueue,queue:Nr.queue,next:null},Kr===null?or.memoizedState=Kr=e:Kr=Kr.next=e}return Kr}function Ef(e,t){return typeof t=="function"?t(e):t}function R1(e){var t=es(),r=t.queue;if(r===null)throw Error(Me(311));r.lastRenderedReducer=e;var i=Nr,n=i.baseQueue,s=r.pending;if(s!==null){if(n!==null){var a=n.next;n.next=s.next,s.next=a}i.baseQueue=n=s,r.pending=null}if(n!==null){s=n.next,i=i.baseState;var o=a=null,l=null,c=s;do{var u=c.lane;if((Ec&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),i=c.hasEagerState?c.eagerState:e(i,c.action);else{var h={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=h,a=i):l=l.next=h,or.lanes|=u,Tc|=u}c=c.next}while(c!==null&&c!==s);l===null?a=i:l.next=o,Ps(i,t.memoizedState)||(Qi=!0),t.memoizedState=i,t.baseState=a,t.baseQueue=l,r.lastRenderedState=i}if(e=r.interleaved,e!==null){n=e;do s=n.lane,or.lanes|=s,Tc|=s,n=n.next;while(n!==e)}else n===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function B1(e){var t=es(),r=t.queue;if(r===null)throw Error(Me(311));r.lastRenderedReducer=e;var i=r.dispatch,n=r.pending,s=t.memoizedState;if(n!==null){r.pending=null;var a=n=n.next;do s=e(s,a.action),a=a.next;while(a!==n);Ps(s,t.memoizedState)||(Qi=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,i]}function _6(){}function S6(e,t){var r=or,i=es(),n=t(),s=!Ps(i.memoizedState,n);if(s&&(i.memoizedState=n,Qi=!0),i=i.queue,DS(M6.bind(null,r,i,e),[e]),i.getSnapshot!==t||s||Kr!==null&&Kr.memoizedState.tag&1){if(r.flags|=2048,Tf(9,C6.bind(null,r,i,n,t),void 0,null),ei===null)throw Error(Me(349));Ec&30||A6(r,t,n)}return n}function A6(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=or.updateQueue,t===null?(t={lastEffect:null,stores:null},or.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function C6(e,t,r,i){t.value=r,t.getSnapshot=i,E6(t)&&T6(e)}function M6(e,t,r){return r(function(){E6(t)&&T6(e)})}function E6(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Ps(e,r)}catch{return!0}}function T6(e){var t=co(e,1);t!==null&&Es(t,e,1,-1)}function HC(e){var t=Ys();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ef,lastRenderedState:e},t.queue=e,e=e.dispatch=A7.bind(null,or,e),[t.memoizedState,e]}function Tf(e,t,r,i){return e={tag:e,create:t,destroy:r,deps:i,next:null},t=or.updateQueue,t===null?(t={lastEffect:null,stores:null},or.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(i=r.next,r.next=e,e.next=i,t.lastEffect=e)),e}function P6(){return es().memoizedState}function gv(e,t,r,i){var n=Ys();or.flags|=e,n.memoizedState=Tf(1|t,r,void 0,i===void 0?null:i)}function xy(e,t,r,i){var n=es();i=i===void 0?null:i;var s=void 0;if(Nr!==null){var a=Nr.memoizedState;if(s=a.destroy,i!==null&&ES(i,a.deps)){n.memoizedState=Tf(t,r,s,i);return}}or.flags|=e,n.memoizedState=Tf(1|t,r,s,i)}function GC(e,t){return gv(8390656,8,e,t)}function DS(e,t){return xy(2048,8,e,t)}function D6(e,t){return xy(4,2,e,t)}function L6(e,t){return xy(4,4,e,t)}function I6(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function O6(e,t,r){return r=r!=null?r.concat([e]):null,xy(4,4,I6.bind(null,t,e),r)}function LS(){}function R6(e,t){var r=es();t=t===void 0?null:t;var i=r.memoizedState;return i!==null&&t!==null&&ES(t,i[1])?i[0]:(r.memoizedState=[e,t],e)}function B6(e,t){var r=es();t=t===void 0?null:t;var i=r.memoizedState;return i!==null&&t!==null&&ES(t,i[1])?i[0]:(e=e(),r.memoizedState=[e,t],e)}function z6(e,t,r){return Ec&21?(Ps(r,t)||(r=FL(),or.lanes|=r,Tc|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Qi=!0),e.memoizedState=r)}function _7(e,t){var r=jt;jt=r!==0&&4>r?r:4,e(!0);var i=O1.transition;O1.transition={};try{e(!1),t()}finally{jt=r,O1.transition=i}}function k6(){return es().memoizedState}function S7(e,t,r){var i=ll(e);if(r={lane:i,action:r,hasEagerState:!1,eagerState:null,next:null},N6(e))F6(t,r);else if(r=m6(e,t,r,i),r!==null){var n=ki();Es(r,e,i,n),U6(r,t,i)}}function A7(e,t,r){var i=ll(e),n={lane:i,action:r,hasEagerState:!1,eagerState:null,next:null};if(N6(e))F6(t,n);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var a=t.lastRenderedState,o=s(a,r);if(n.hasEagerState=!0,n.eagerState=o,Ps(o,a)){var l=t.interleaved;l===null?(n.next=n,_S(t)):(n.next=l.next,l.next=n),t.interleaved=n;return}}catch{}finally{}r=m6(e,t,n,i),r!==null&&(n=ki(),Es(r,e,i,n),U6(r,t,i))}}function N6(e){var t=e.alternate;return e===or||t!==null&&t===or}function F6(e,t){Fp=Jv=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function U6(e,t,r){if(r&4194240){var i=t.lanes;i&=e.pendingLanes,r|=i,t.lanes=r,lS(e,r)}}var e0={readContext:Jn,useCallback:pi,useContext:pi,useEffect:pi,useImperativeHandle:pi,useInsertionEffect:pi,useLayoutEffect:pi,useMemo:pi,useReducer:pi,useRef:pi,useState:pi,useDebugValue:pi,useDeferredValue:pi,useTransition:pi,useMutableSource:pi,useSyncExternalStore:pi,useId:pi,unstable_isNewReconciler:!1},C7={readContext:Jn,useCallback:function(e,t){return Ys().memoizedState=[e,t===void 0?null:t],e},useContext:Jn,useEffect:GC,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,gv(4194308,4,I6.bind(null,t,e),r)},useLayoutEffect:function(e,t){return gv(4194308,4,e,t)},useInsertionEffect:function(e,t){return gv(4,2,e,t)},useMemo:function(e,t){var r=Ys();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var i=Ys();return t=r!==void 0?r(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=S7.bind(null,or,e),[i.memoizedState,e]},useRef:function(e){var t=Ys();return e={current:e},t.memoizedState=e},useState:HC,useDebugValue:LS,useDeferredValue:function(e){return Ys().memoizedState=e},useTransition:function(){var e=HC(!1),t=e[0];return e=_7.bind(null,e[1]),Ys().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var i=or,n=Ys();if(ir){if(r===void 0)throw Error(Me(407));r=r()}else{if(r=t(),ei===null)throw Error(Me(349));Ec&30||A6(i,t,r)}n.memoizedState=r;var s={value:r,getSnapshot:t};return n.queue=s,GC(M6.bind(null,i,s,e),[e]),i.flags|=2048,Tf(9,C6.bind(null,i,s,r,t),void 0,null),r},useId:function(){var e=Ys(),t=ei.identifierPrefix;if(ir){var r=Qa,i=Ya;r=(i&~(1<<32-Ms(i)-1)).toString(32)+r,t=":"+t+"R"+r,r=Mf++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=b7++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},M7={readContext:Jn,useCallback:R6,useContext:Jn,useEffect:DS,useImperativeHandle:O6,useInsertionEffect:D6,useLayoutEffect:L6,useMemo:B6,useReducer:R1,useRef:P6,useState:function(){return R1(Ef)},useDebugValue:LS,useDeferredValue:function(e){var t=es();return z6(t,Nr.memoizedState,e)},useTransition:function(){var e=R1(Ef)[0],t=es().memoizedState;return[e,t]},useMutableSource:_6,useSyncExternalStore:S6,useId:k6,unstable_isNewReconciler:!1},E7={readContext:Jn,useCallback:R6,useContext:Jn,useEffect:DS,useImperativeHandle:O6,useInsertionEffect:D6,useLayoutEffect:L6,useMemo:B6,useReducer:B1,useRef:P6,useState:function(){return B1(Ef)},useDebugValue:LS,useDeferredValue:function(e){var t=es();return Nr===null?t.memoizedState=e:z6(t,Nr.memoizedState,e)},useTransition:function(){var e=B1(Ef)[0],t=es().memoizedState;return[e,t]},useMutableSource:_6,useSyncExternalStore:S6,useId:k6,unstable_isNewReconciler:!1};function zu(e,t){try{var r="",i=t;do r+=tN(i),i=i.return;while(i);var n=r}catch(s){n=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:n,digest:null}}function z1(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Pb(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var T7=typeof WeakMap=="function"?WeakMap:Map;function j6(e,t,r){r=Ja(-1,r),r.tag=3,r.payload={element:null};var i=t.value;return r.callback=function(){r0||(r0=!0,Fb=i),Pb(e,t)},r}function V6(e,t,r){r=Ja(-1,r),r.tag=3;var i=e.type.getDerivedStateFromError;if(typeof i=="function"){var n=t.value;r.payload=function(){return i(n)},r.callback=function(){Pb(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Pb(e,t),typeof i!="function"&&(ol===null?ol=new Set([this]):ol.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),r}function WC(e,t,r){var i=e.pingCache;if(i===null){i=e.pingCache=new T7;var n=new Set;i.set(t,n)}else n=i.get(t),n===void 0&&(n=new Set,i.set(t,n));n.has(r)||(n.add(r),e=V7.bind(null,e,t,r),t.then(e,e))}function qC(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function XC(e,t,r,i,n){return e.mode&1?(e.flags|=65536,e.lanes=n,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Ja(-1,1),t.tag=2,al(r,t,1))),r.lanes|=1),e)}var P7=mo.ReactCurrentOwner,Qi=!1;function Di(e,t,r,i){t.child=e===null?w6(t,null,r,i):Ru(t,e.child,r,i)}function YC(e,t,r,i,n){r=r.render;var s=t.ref;return uu(t,n),i=TS(e,t,r,i,s,n),r=PS(),e!==null&&!Qi?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,ho(e,t,n)):(ir&&r&&gS(t),t.flags|=1,Di(e,t,i,n),t.child)}function QC(e,t,r,i,n){if(e===null){var s=r.type;return typeof s=="function"&&!FS(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,H6(e,t,s,i,n)):(e=wv(r.type,null,i,t,t.mode,n),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&n)){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:wf,r(a,i)&&e.ref===t.ref)return ho(e,t,n)}return t.flags|=1,e=cl(s,i),e.ref=t.ref,e.return=t,t.child=e}function H6(e,t,r,i,n){if(e!==null){var s=e.memoizedProps;if(wf(s,i)&&e.ref===t.ref)if(Qi=!1,t.pendingProps=i=s,(e.lanes&n)!==0)e.flags&131072&&(Qi=!0);else return t.lanes=e.lanes,ho(e,t,n)}return Db(e,t,r,i,n)}function G6(e,t,r){var i=t.pendingProps,n=i.children,s=e!==null?e.memoizedState:null;if(i.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},$t(qh,fn),fn|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,$t(qh,fn),fn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=s!==null?s.baseLanes:r,$t(qh,fn),fn|=i}else s!==null?(i=s.baseLanes|r,t.memoizedState=null):i=r,$t(qh,fn),fn|=i;return Di(e,t,n,r),t.child}function W6(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Db(e,t,r,i,n){var s=en(r)?Cc:_i.current;return s=Iu(t,s),uu(t,n),r=TS(e,t,r,i,s,n),i=PS(),e!==null&&!Qi?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,ho(e,t,n)):(ir&&i&&gS(t),t.flags|=1,Di(e,t,r,n),t.child)}function KC(e,t,r,i,n){if(en(r)){var s=!0;qv(t)}else s=!1;if(uu(t,n),t.stateNode===null)vv(e,t),y6(t,r,i),Tb(t,r,i,n),i=!0;else if(e===null){var a=t.stateNode,o=t.memoizedProps;a.props=o;var l=a.context,c=r.contextType;typeof c=="object"&&c!==null?c=Jn(c):(c=en(r)?Cc:_i.current,c=Iu(t,c));var u=r.getDerivedStateFromProps,h=typeof u=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==i||l!==c)&&jC(t,a,i,c),No=!1;var d=t.memoizedState;a.state=d,Zv(t,i,a,n),l=t.memoizedState,o!==i||d!==l||Ji.current||No?(typeof u=="function"&&(Eb(t,r,u,i),l=t.memoizedState),(o=No||UC(t,r,o,i,d,l,c))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=l),a.props=i,a.state=l,a.context=c,i=o):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{a=t.stateNode,g6(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:fs(t.type,o),a.props=c,h=t.pendingProps,d=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=Jn(l):(l=en(r)?Cc:_i.current,l=Iu(t,l));var p=r.getDerivedStateFromProps;(u=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==h||d!==l)&&jC(t,a,i,l),No=!1,d=t.memoizedState,a.state=d,Zv(t,i,a,n);var f=t.memoizedState;o!==h||d!==f||Ji.current||No?(typeof p=="function"&&(Eb(t,r,p,i),f=t.memoizedState),(c=No||UC(t,r,c,i,d,f,l)||!1)?(u||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(i,f,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(i,f,l)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=f),a.props=i,a.state=f,a.context=l,i=c):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),i=!1)}return Lb(e,t,r,i,s,n)}function Lb(e,t,r,i,n,s){W6(e,t);var a=(t.flags&128)!==0;if(!i&&!a)return n&&BC(t,r,!1),ho(e,t,s);i=t.stateNode,P7.current=t;var o=a&&typeof r.getDerivedStateFromError!="function"?null:i.render();return t.flags|=1,e!==null&&a?(t.child=Ru(t,e.child,null,s),t.child=Ru(t,null,o,s)):Di(e,t,o,s),t.memoizedState=i.state,n&&BC(t,r,!0),t.child}function q6(e){var t=e.stateNode;t.pendingContext?RC(e,t.pendingContext,t.pendingContext!==t.context):t.context&&RC(e,t.context,!1),AS(e,t.containerInfo)}function ZC(e,t,r,i,n){return Ou(),yS(n),t.flags|=256,Di(e,t,r,i),t.child}var Ib={dehydrated:null,treeContext:null,retryLane:0};function Ob(e){return{baseLanes:e,cachePool:null,transitions:null}}function X6(e,t,r){var i=t.pendingProps,n=nr.current,s=!1,a=(t.flags&128)!==0,o;if((o=a)||(o=e!==null&&e.memoizedState===null?!1:(n&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(n|=1),$t(nr,n&1),e===null)return Cb(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=i.children,e=i.fallback,s?(i=t.mode,s=t.child,a={mode:"hidden",children:a},!(i&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=_y(a,i,0,null),e=vc(e,i,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Ob(r),t.memoizedState=Ib,e):IS(t,a));if(n=e.memoizedState,n!==null&&(o=n.dehydrated,o!==null))return D7(e,t,a,i,o,n,r);if(s){s=i.fallback,a=t.mode,n=e.child,o=n.sibling;var l={mode:"hidden",children:i.children};return!(a&1)&&t.child!==n?(i=t.child,i.childLanes=0,i.pendingProps=l,t.deletions=null):(i=cl(n,l),i.subtreeFlags=n.subtreeFlags&14680064),o!==null?s=cl(o,s):(s=vc(s,a,r,null),s.flags|=2),s.return=t,i.return=t,i.sibling=s,t.child=i,i=s,s=t.child,a=e.child.memoizedState,a=a===null?Ob(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=e.childLanes&~r,t.memoizedState=Ib,i}return s=e.child,e=s.sibling,i=cl(s,{mode:"visible",children:i.children}),!(t.mode&1)&&(i.lanes=r),i.return=t,i.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=i,t.memoizedState=null,i}function IS(e,t){return t=_y({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function zm(e,t,r,i){return i!==null&&yS(i),Ru(t,e.child,null,r),e=IS(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function D7(e,t,r,i,n,s,a){if(r)return t.flags&256?(t.flags&=-257,i=z1(Error(Me(422))),zm(e,t,a,i)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=i.fallback,n=t.mode,i=_y({mode:"visible",children:i.children},n,0,null),s=vc(s,n,a,null),s.flags|=2,i.return=t,s.return=t,i.sibling=s,t.child=i,t.mode&1&&Ru(t,e.child,null,a),t.child.memoizedState=Ob(a),t.memoizedState=Ib,s);if(!(t.mode&1))return zm(e,t,a,null);if(n.data==="$!"){if(i=n.nextSibling&&n.nextSibling.dataset,i)var o=i.dgst;return i=o,s=Error(Me(419)),i=z1(s,i,void 0),zm(e,t,a,i)}if(o=(a&e.childLanes)!==0,Qi||o){if(i=ei,i!==null){switch(a&-a){case 4:n=2;break;case 16:n=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:n=32;break;case 536870912:n=268435456;break;default:n=0}n=n&(i.suspendedLanes|a)?0:n,n!==0&&n!==s.retryLane&&(s.retryLane=n,co(e,n),Es(i,e,n,-1))}return NS(),i=z1(Error(Me(421))),zm(e,t,a,i)}return n.data==="$?"?(t.flags|=128,t.child=e.child,t=H7.bind(null,e),n._reactRetry=t,null):(e=s.treeContext,vn=sl(n.nextSibling),Sn=t,ir=!0,vs=null,e!==null&&(jn[Vn++]=Ya,jn[Vn++]=Qa,jn[Vn++]=Mc,Ya=e.id,Qa=e.overflow,Mc=t),t=IS(t,i.children),t.flags|=4096,t)}function $C(e,t,r){e.lanes|=t;var i=e.alternate;i!==null&&(i.lanes|=t),Mb(e.return,t,r)}function k1(e,t,r,i,n){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:r,tailMode:n}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=r,s.tailMode=n)}function Y6(e,t,r){var i=t.pendingProps,n=i.revealOrder,s=i.tail;if(Di(e,t,i.children,r),i=nr.current,i&2)i=i&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&$C(e,r,t);else if(e.tag===19)$C(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if($t(nr,i),!(t.mode&1))t.memoizedState=null;else switch(n){case"forwards":for(r=t.child,n=null;r!==null;)e=r.alternate,e!==null&&$v(e)===null&&(n=r),r=r.sibling;r=n,r===null?(n=t.child,t.child=null):(n=r.sibling,r.sibling=null),k1(t,!1,n,r,s);break;case"backwards":for(r=null,n=t.child,t.child=null;n!==null;){if(e=n.alternate,e!==null&&$v(e)===null){t.child=n;break}e=n.sibling,n.sibling=r,r=n,n=e}k1(t,!0,r,null,s);break;case"together":k1(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function vv(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ho(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Tc|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Me(153));if(t.child!==null){for(e=t.child,r=cl(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=cl(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function L7(e,t,r){switch(t.tag){case 3:q6(t),Ou();break;case 5:b6(t);break;case 1:en(t.type)&&qv(t);break;case 4:AS(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,n=t.memoizedProps.value;$t(Qv,i._currentValue),i._currentValue=n;break;case 13:if(i=t.memoizedState,i!==null)return i.dehydrated!==null?($t(nr,nr.current&1),t.flags|=128,null):r&t.child.childLanes?X6(e,t,r):($t(nr,nr.current&1),e=ho(e,t,r),e!==null?e.sibling:null);$t(nr,nr.current&1);break;case 19:if(i=(r&t.childLanes)!==0,e.flags&128){if(i)return Y6(e,t,r);t.flags|=128}if(n=t.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),$t(nr,nr.current),i)break;return null;case 22:case 23:return t.lanes=0,G6(e,t,r)}return ho(e,t,r)}var Q6,Rb,K6,Z6;Q6=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Rb=function(){};K6=function(e,t,r,i){var n=e.memoizedProps;if(n!==i){e=t.stateNode,lc(ca.current);var s=null;switch(r){case"input":n=rb(e,n),i=rb(e,i),s=[];break;case"select":n=lr({},n,{value:void 0}),i=lr({},i,{value:void 0}),s=[];break;case"textarea":n=sb(e,n),i=sb(e,i),s=[];break;default:typeof n.onClick!="function"&&typeof i.onClick=="function"&&(e.onclick=Gv)}ob(r,i);var a;r=null;for(c in n)if(!i.hasOwnProperty(c)&&n.hasOwnProperty(c)&&n[c]!=null)if(c==="style"){var o=n[c];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(pf.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in i){var l=i[c];if(o=n!=null?n[c]:void 0,i.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(s||(s=[]),s.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(pf.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Jt("scroll",e),s||o===l||(s=[])):(s=s||[]).push(c,l))}r&&(s=s||[]).push("style",r);var c=s;(t.updateQueue=c)&&(t.flags|=4)}};Z6=function(e,t,r,i){r!==i&&(t.flags|=4)};function Od(e,t){if(!ir)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var i=null;r!==null;)r.alternate!==null&&(i=r),r=r.sibling;i===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:i.sibling=null}}function fi(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,i=0;if(t)for(var n=e.child;n!==null;)r|=n.lanes|n.childLanes,i|=n.subtreeFlags&14680064,i|=n.flags&14680064,n.return=e,n=n.sibling;else for(n=e.child;n!==null;)r|=n.lanes|n.childLanes,i|=n.subtreeFlags,i|=n.flags,n.return=e,n=n.sibling;return e.subtreeFlags|=i,e.childLanes=r,t}function I7(e,t,r){var i=t.pendingProps;switch(vS(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return fi(t),null;case 1:return en(t.type)&&Wv(),fi(t),null;case 3:return i=t.stateNode,Bu(),tr(Ji),tr(_i),MS(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(e===null||e.child===null)&&(Rm(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,vs!==null&&(Vb(vs),vs=null))),Rb(e,t),fi(t),null;case 5:CS(t);var n=lc(Cf.current);if(r=t.type,e!==null&&t.stateNode!=null)K6(e,t,r,i,n),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(t.stateNode===null)throw Error(Me(166));return fi(t),null}if(e=lc(ca.current),Rm(t)){i=t.stateNode,r=t.type;var s=t.memoizedProps;switch(i[ea]=t,i[Sf]=s,e=(t.mode&1)!==0,r){case"dialog":Jt("cancel",i),Jt("close",i);break;case"iframe":case"object":case"embed":Jt("load",i);break;case"video":case"audio":for(n=0;n<_p.length;n++)Jt(_p[n],i);break;case"source":Jt("error",i);break;case"img":case"image":case"link":Jt("error",i),Jt("load",i);break;case"details":Jt("toggle",i);break;case"input":oC(i,s),Jt("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},Jt("invalid",i);break;case"textarea":cC(i,s),Jt("invalid",i)}ob(r,s),n=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?i.textContent!==o&&(s.suppressHydrationWarning!==!0&&Om(i.textContent,o,e),n=["children",o]):typeof o=="number"&&i.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&Om(i.textContent,o,e),n=["children",""+o]):pf.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&Jt("scroll",i)}switch(r){case"input":Cm(i),lC(i,s,!0);break;case"textarea":Cm(i),hC(i);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(i.onclick=Gv)}i=n,t.updateQueue=i,i!==null&&(t.flags|=4)}else{a=n.nodeType===9?n:n.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=AL(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof i.is=="string"?e=a.createElement(r,{is:i.is}):(e=a.createElement(r),r==="select"&&(a=e,i.multiple?a.multiple=!0:i.size&&(a.size=i.size))):e=a.createElementNS(e,r),e[ea]=t,e[Sf]=i,Q6(e,t,!1,!1),t.stateNode=e;e:{switch(a=lb(r,i),r){case"dialog":Jt("cancel",e),Jt("close",e),n=i;break;case"iframe":case"object":case"embed":Jt("load",e),n=i;break;case"video":case"audio":for(n=0;n<_p.length;n++)Jt(_p[n],e);n=i;break;case"source":Jt("error",e),n=i;break;case"img":case"image":case"link":Jt("error",e),Jt("load",e),n=i;break;case"details":Jt("toggle",e),n=i;break;case"input":oC(e,i),n=rb(e,i),Jt("invalid",e);break;case"option":n=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},n=lr({},i,{value:void 0}),Jt("invalid",e);break;case"textarea":cC(e,i),n=sb(e,i),Jt("invalid",e);break;default:n=i}ob(r,n),o=n;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?EL(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&CL(e,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&ff(e,l):typeof l=="number"&&ff(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(pf.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Jt("scroll",e):l!=null&&rS(e,s,l,a))}switch(r){case"input":Cm(e),lC(e,i,!1);break;case"textarea":Cm(e),hC(e);break;case"option":i.value!=null&&e.setAttribute("value",""+xl(i.value));break;case"select":e.multiple=!!i.multiple,s=i.value,s!=null?ou(e,!!i.multiple,s,!1):i.defaultValue!=null&&ou(e,!!i.multiple,i.defaultValue,!0);break;default:typeof n.onClick=="function"&&(e.onclick=Gv)}switch(r){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return fi(t),null;case 6:if(e&&t.stateNode!=null)Z6(e,t,e.memoizedProps,i);else{if(typeof i!="string"&&t.stateNode===null)throw Error(Me(166));if(r=lc(Cf.current),lc(ca.current),Rm(t)){if(i=t.stateNode,r=t.memoizedProps,i[ea]=t,(s=i.nodeValue!==r)&&(e=Sn,e!==null))switch(e.tag){case 3:Om(i.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Om(i.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else i=(r.nodeType===9?r:r.ownerDocument).createTextNode(i),i[ea]=t,t.stateNode=i}return fi(t),null;case 13:if(tr(nr),i=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(ir&&vn!==null&&t.mode&1&&!(t.flags&128))f6(),Ou(),t.flags|=98560,s=!1;else if(s=Rm(t),i!==null&&i.dehydrated!==null){if(e===null){if(!s)throw Error(Me(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Me(317));s[ea]=t}else Ou(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;fi(t),s=!1}else vs!==null&&(Vb(vs),vs=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(i=i!==null,i!==(e!==null&&e.memoizedState!==null)&&i&&(t.child.flags|=8192,t.mode&1&&(e===null||nr.current&1?Ur===0&&(Ur=3):NS())),t.updateQueue!==null&&(t.flags|=4),fi(t),null);case 4:return Bu(),Rb(e,t),e===null&&bf(t.stateNode.containerInfo),fi(t),null;case 10:return bS(t.type._context),fi(t),null;case 17:return en(t.type)&&Wv(),fi(t),null;case 19:if(tr(nr),s=t.memoizedState,s===null)return fi(t),null;if(i=(t.flags&128)!==0,a=s.rendering,a===null)if(i)Od(s,!1);else{if(Ur!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=$v(e),a!==null){for(t.flags|=128,Od(s,!1),i=a.updateQueue,i!==null&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=r,r=t.child;r!==null;)s=r,e=i,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,e=a.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return $t(nr,nr.current&1|2),t.child}e=e.sibling}s.tail!==null&&wr()>ku&&(t.flags|=128,i=!0,Od(s,!1),t.lanes=4194304)}else{if(!i)if(e=$v(a),e!==null){if(t.flags|=128,i=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Od(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!ir)return fi(t),null}else 2*wr()-s.renderingStartTime>ku&&r!==1073741824&&(t.flags|=128,i=!0,Od(s,!1),t.lanes=4194304);s.isBackwards?(a.sibling=t.child,t.child=a):(r=s.last,r!==null?r.sibling=a:t.child=a,s.last=a)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=wr(),t.sibling=null,r=nr.current,$t(nr,i?r&1|2:r&1),t):(fi(t),null);case 22:case 23:return kS(),i=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==i&&(t.flags|=8192),i&&t.mode&1?fn&1073741824&&(fi(t),t.subtreeFlags&6&&(t.flags|=8192)):fi(t),null;case 24:return null;case 25:return null}throw Error(Me(156,t.tag))}function O7(e,t){switch(vS(t),t.tag){case 1:return en(t.type)&&Wv(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Bu(),tr(Ji),tr(_i),MS(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return CS(t),null;case 13:if(tr(nr),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Me(340));Ou()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return tr(nr),null;case 4:return Bu(),null;case 10:return bS(t.type._context),null;case 22:case 23:return kS(),null;case 24:return null;default:return null}}var km=!1,gi=!1,R7=typeof WeakSet=="function"?WeakSet:Set,Ue=null;function Wh(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(i){ur(e,t,i)}else r.current=null}function Bb(e,t,r){try{r()}catch(i){ur(e,t,i)}}var JC=!1;function B7(e,t){if(yb=jv,e=t6(),mS(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var i=r.getSelection&&r.getSelection();if(i&&i.rangeCount!==0){r=i.anchorNode;var n=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,c=0,u=0,h=e,d=null;t:for(;;){for(var p;h!==r||n!==0&&h.nodeType!==3||(o=a+n),h!==s||i!==0&&h.nodeType!==3||(l=a+i),h.nodeType===3&&(a+=h.nodeValue.length),(p=h.firstChild)!==null;)d=h,h=p;for(;;){if(h===e)break t;if(d===r&&++c===n&&(o=a),d===s&&++u===i&&(l=a),(p=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=p}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(xb={focusedElem:e,selectionRange:r},jv=!1,Ue=t;Ue!==null;)if(t=Ue,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ue=e;else for(;Ue!==null;){t=Ue;try{var f=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(f!==null){var m=f.memoizedProps,g=f.memoizedState,v=t.stateNode,y=v.getSnapshotBeforeUpdate(t.elementType===t.type?m:fs(t.type,m),g);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var x=t.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Me(163))}}catch(w){ur(t,t.return,w)}if(e=t.sibling,e!==null){e.return=t.return,Ue=e;break}Ue=t.return}return f=JC,JC=!1,f}function Up(e,t,r){var i=t.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var n=i=i.next;do{if((n.tag&e)===e){var s=n.destroy;n.destroy=void 0,s!==void 0&&Bb(t,r,s)}n=n.next}while(n!==i)}}function wy(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var i=r.create;r.destroy=i()}r=r.next}while(r!==t)}}function zb(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function $6(e){var t=e.alternate;t!==null&&(e.alternate=null,$6(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[ea],delete t[Sf],delete t[_b],delete t[v7],delete t[y7])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function J6(e){return e.tag===5||e.tag===3||e.tag===4}function eM(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||J6(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function kb(e,t,r){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Gv));else if(i!==4&&(e=e.child,e!==null))for(kb(e,t,r),e=e.sibling;e!==null;)kb(e,t,r),e=e.sibling}function Nb(e,t,r){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(i!==4&&(e=e.child,e!==null))for(Nb(e,t,r),e=e.sibling;e!==null;)Nb(e,t,r),e=e.sibling}var oi=null,ms=!1;function xo(e,t,r){for(r=r.child;r!==null;)eI(e,t,r),r=r.sibling}function eI(e,t,r){if(la&&typeof la.onCommitFiberUnmount=="function")try{la.onCommitFiberUnmount(dy,r)}catch{}switch(r.tag){case 5:gi||Wh(r,t);case 6:var i=oi,n=ms;oi=null,xo(e,t,r),oi=i,ms=n,oi!==null&&(ms?(e=oi,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):oi.removeChild(r.stateNode));break;case 18:oi!==null&&(ms?(e=oi,r=r.stateNode,e.nodeType===8?D1(e.parentNode,r):e.nodeType===1&&D1(e,r),yf(e)):D1(oi,r.stateNode));break;case 4:i=oi,n=ms,oi=r.stateNode.containerInfo,ms=!0,xo(e,t,r),oi=i,ms=n;break;case 0:case 11:case 14:case 15:if(!gi&&(i=r.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){n=i=i.next;do{var s=n,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&Bb(r,t,a),n=n.next}while(n!==i)}xo(e,t,r);break;case 1:if(!gi&&(Wh(r,t),i=r.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=r.memoizedProps,i.state=r.memoizedState,i.componentWillUnmount()}catch(o){ur(r,t,o)}xo(e,t,r);break;case 21:xo(e,t,r);break;case 22:r.mode&1?(gi=(i=gi)||r.memoizedState!==null,xo(e,t,r),gi=i):xo(e,t,r);break;default:xo(e,t,r)}}function tM(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new R7),t.forEach(function(i){var n=G7.bind(null,e,i);r.has(i)||(r.add(i),i.then(n,n))})}}function ss(e,t){var r=t.deletions;if(r!==null)for(var i=0;i<r.length;i++){var n=r[i];try{var s=e,a=t,o=a;e:for(;o!==null;){switch(o.tag){case 5:oi=o.stateNode,ms=!1;break e;case 3:oi=o.stateNode.containerInfo,ms=!0;break e;case 4:oi=o.stateNode.containerInfo,ms=!0;break e}o=o.return}if(oi===null)throw Error(Me(160));eI(s,a,n),oi=null,ms=!1;var l=n.alternate;l!==null&&(l.return=null),n.return=null}catch(c){ur(n,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)tI(t,e),t=t.sibling}function tI(e,t){var r=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ss(t,e),Rs(e),i&4){try{Up(3,e,e.return),wy(3,e)}catch(m){ur(e,e.return,m)}try{Up(5,e,e.return)}catch(m){ur(e,e.return,m)}}break;case 1:ss(t,e),Rs(e),i&512&&r!==null&&Wh(r,r.return);break;case 5:if(ss(t,e),Rs(e),i&512&&r!==null&&Wh(r,r.return),e.flags&32){var n=e.stateNode;try{ff(n,"")}catch(m){ur(e,e.return,m)}}if(i&4&&(n=e.stateNode,n!=null)){var s=e.memoizedProps,a=r!==null?r.memoizedProps:s,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&_L(n,s),lb(o,a);var c=lb(o,s);for(a=0;a<l.length;a+=2){var u=l[a],h=l[a+1];u==="style"?EL(n,h):u==="dangerouslySetInnerHTML"?CL(n,h):u==="children"?ff(n,h):rS(n,u,h,c)}switch(o){case"input":ib(n,s);break;case"textarea":SL(n,s);break;case"select":var d=n._wrapperState.wasMultiple;n._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?ou(n,!!s.multiple,p,!1):d!==!!s.multiple&&(s.defaultValue!=null?ou(n,!!s.multiple,s.defaultValue,!0):ou(n,!!s.multiple,s.multiple?[]:"",!1))}n[Sf]=s}catch(m){ur(e,e.return,m)}}break;case 6:if(ss(t,e),Rs(e),i&4){if(e.stateNode===null)throw Error(Me(162));n=e.stateNode,s=e.memoizedProps;try{n.nodeValue=s}catch(m){ur(e,e.return,m)}}break;case 3:if(ss(t,e),Rs(e),i&4&&r!==null&&r.memoizedState.isDehydrated)try{yf(t.containerInfo)}catch(m){ur(e,e.return,m)}break;case 4:ss(t,e),Rs(e);break;case 13:ss(t,e),Rs(e),n=e.child,n.flags&8192&&(s=n.memoizedState!==null,n.stateNode.isHidden=s,!s||n.alternate!==null&&n.alternate.memoizedState!==null||(BS=wr())),i&4&&tM(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(gi=(c=gi)||u,ss(t,e),gi=c):ss(t,e),Rs(e),i&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!u&&e.mode&1)for(Ue=e,u=e.child;u!==null;){for(h=Ue=u;Ue!==null;){switch(d=Ue,p=d.child,d.tag){case 0:case 11:case 14:case 15:Up(4,d,d.return);break;case 1:Wh(d,d.return);var f=d.stateNode;if(typeof f.componentWillUnmount=="function"){i=d,r=d.return;try{t=i,f.props=t.memoizedProps,f.state=t.memoizedState,f.componentWillUnmount()}catch(m){ur(i,r,m)}}break;case 5:Wh(d,d.return);break;case 22:if(d.memoizedState!==null){iM(h);continue}}p!==null?(p.return=d,Ue=p):iM(h)}u=u.sibling}e:for(u=null,h=e;;){if(h.tag===5){if(u===null){u=h;try{n=h.stateNode,c?(s=n.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=h.stateNode,l=h.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=ML("display",a))}catch(m){ur(e,e.return,m)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(m){ur(e,e.return,m)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:ss(t,e),Rs(e),i&4&&tM(e);break;case 21:break;default:ss(t,e),Rs(e)}}function Rs(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(J6(r)){var i=r;break e}r=r.return}throw Error(Me(160))}switch(i.tag){case 5:var n=i.stateNode;i.flags&32&&(ff(n,""),i.flags&=-33);var s=eM(e);Nb(e,s,n);break;case 3:case 4:var a=i.stateNode.containerInfo,o=eM(e);kb(e,o,a);break;default:throw Error(Me(161))}}catch(l){ur(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function z7(e,t,r){Ue=e,rI(e)}function rI(e,t,r){for(var i=(e.mode&1)!==0;Ue!==null;){var n=Ue,s=n.child;if(n.tag===22&&i){var a=n.memoizedState!==null||km;if(!a){var o=n.alternate,l=o!==null&&o.memoizedState!==null||gi;o=km;var c=gi;if(km=a,(gi=l)&&!c)for(Ue=n;Ue!==null;)a=Ue,l=a.child,a.tag===22&&a.memoizedState!==null?nM(n):l!==null?(l.return=a,Ue=l):nM(n);for(;s!==null;)Ue=s,rI(s),s=s.sibling;Ue=n,km=o,gi=c}rM(e)}else n.subtreeFlags&8772&&s!==null?(s.return=n,Ue=s):rM(e)}}function rM(e){for(;Ue!==null;){var t=Ue;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:gi||wy(5,t);break;case 1:var i=t.stateNode;if(t.flags&4&&!gi)if(r===null)i.componentDidMount();else{var n=t.elementType===t.type?r.memoizedProps:fs(t.type,r.memoizedProps);i.componentDidUpdate(n,r.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&FC(t,s,i);break;case 3:var a=t.updateQueue;if(a!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}FC(t,a,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&yf(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Me(163))}gi||t.flags&512&&zb(t)}catch(d){ur(t,t.return,d)}}if(t===e){Ue=null;break}if(r=t.sibling,r!==null){r.return=t.return,Ue=r;break}Ue=t.return}}function iM(e){for(;Ue!==null;){var t=Ue;if(t===e){Ue=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Ue=r;break}Ue=t.return}}function nM(e){for(;Ue!==null;){var t=Ue;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{wy(4,t)}catch(l){ur(t,r,l)}break;case 1:var i=t.stateNode;if(typeof i.componentDidMount=="function"){var n=t.return;try{i.componentDidMount()}catch(l){ur(t,n,l)}}var s=t.return;try{zb(t)}catch(l){ur(t,s,l)}break;case 5:var a=t.return;try{zb(t)}catch(l){ur(t,a,l)}}}catch(l){ur(t,t.return,l)}if(t===e){Ue=null;break}var o=t.sibling;if(o!==null){o.return=t.return,Ue=o;break}Ue=t.return}}var k7=Math.ceil,t0=mo.ReactCurrentDispatcher,OS=mo.ReactCurrentOwner,Qn=mo.ReactCurrentBatchConfig,Dt=0,ei=null,Dr=null,ci=0,fn=0,qh=El(0),Ur=0,Pf=null,Tc=0,by=0,RS=0,jp=null,Gi=null,BS=0,ku=1/0,Fa=null,r0=!1,Fb=null,ol=null,Nm=!1,Xo=null,i0=0,Vp=0,Ub=null,yv=-1,xv=0;function ki(){return Dt&6?wr():yv!==-1?yv:yv=wr()}function ll(e){return e.mode&1?Dt&2&&ci!==0?ci&-ci:w7.transition!==null?(xv===0&&(xv=FL()),xv):(e=jt,e!==0||(e=window.event,e=e===void 0?16:qL(e.type)),e):1}function Es(e,t,r,i){if(50<Vp)throw Vp=0,Ub=null,Error(Me(185));em(e,r,i),(!(Dt&2)||e!==ei)&&(e===ei&&(!(Dt&2)&&(by|=r),Ur===4&&Vo(e,ci)),tn(e,i),r===1&&Dt===0&&!(t.mode&1)&&(ku=wr()+500,vy&&Tl()))}function tn(e,t){var r=e.callbackNode;wN(e,t);var i=Uv(e,e===ei?ci:0);if(i===0)r!==null&&pC(r),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(r!=null&&pC(r),t===1)e.tag===0?x7(sM.bind(null,e)):u6(sM.bind(null,e)),m7(function(){!(Dt&6)&&Tl()}),r=null;else{switch(UL(i)){case 1:r=oS;break;case 4:r=kL;break;case 16:r=Fv;break;case 536870912:r=NL;break;default:r=Fv}r=hI(r,iI.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function iI(e,t){if(yv=-1,xv=0,Dt&6)throw Error(Me(327));var r=e.callbackNode;if(du()&&e.callbackNode!==r)return null;var i=Uv(e,e===ei?ci:0);if(i===0)return null;if(i&30||i&e.expiredLanes||t)t=n0(e,i);else{t=i;var n=Dt;Dt|=2;var s=sI();(ei!==e||ci!==t)&&(Fa=null,ku=wr()+500,gc(e,t));do try{U7();break}catch(o){nI(e,o)}while(1);wS(),t0.current=s,Dt=n,Dr!==null?t=0:(ei=null,ci=0,t=Ur)}if(t!==0){if(t===2&&(n=pb(e),n!==0&&(i=n,t=jb(e,n))),t===1)throw r=Pf,gc(e,0),Vo(e,i),tn(e,wr()),r;if(t===6)Vo(e,i);else{if(n=e.current.alternate,!(i&30)&&!N7(n)&&(t=n0(e,i),t===2&&(s=pb(e),s!==0&&(i=s,t=jb(e,s))),t===1))throw r=Pf,gc(e,0),Vo(e,i),tn(e,wr()),r;switch(e.finishedWork=n,e.finishedLanes=i,t){case 0:case 1:throw Error(Me(345));case 2:Xl(e,Gi,Fa);break;case 3:if(Vo(e,i),(i&130023424)===i&&(t=BS+500-wr(),10<t)){if(Uv(e,0)!==0)break;if(n=e.suspendedLanes,(n&i)!==i){ki(),e.pingedLanes|=e.suspendedLanes&n;break}e.timeoutHandle=bb(Xl.bind(null,e,Gi,Fa),t);break}Xl(e,Gi,Fa);break;case 4:if(Vo(e,i),(i&4194240)===i)break;for(t=e.eventTimes,n=-1;0<i;){var a=31-Ms(i);s=1<<a,a=t[a],a>n&&(n=a),i&=~s}if(i=n,i=wr()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*k7(i/1960))-i,10<i){e.timeoutHandle=bb(Xl.bind(null,e,Gi,Fa),i);break}Xl(e,Gi,Fa);break;case 5:Xl(e,Gi,Fa);break;default:throw Error(Me(329))}}}return tn(e,wr()),e.callbackNode===r?iI.bind(null,e):null}function jb(e,t){var r=jp;return e.current.memoizedState.isDehydrated&&(gc(e,t).flags|=256),e=n0(e,t),e!==2&&(t=Gi,Gi=r,t!==null&&Vb(t)),e}function Vb(e){Gi===null?Gi=e:Gi.push.apply(Gi,e)}function N7(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var i=0;i<r.length;i++){var n=r[i],s=n.getSnapshot;n=n.value;try{if(!Ps(s(),n))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Vo(e,t){for(t&=~RS,t&=~by,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Ms(t),i=1<<r;e[r]=-1,t&=~i}}function sM(e){if(Dt&6)throw Error(Me(327));du();var t=Uv(e,0);if(!(t&1))return tn(e,wr()),null;var r=n0(e,t);if(e.tag!==0&&r===2){var i=pb(e);i!==0&&(t=i,r=jb(e,i))}if(r===1)throw r=Pf,gc(e,0),Vo(e,t),tn(e,wr()),r;if(r===6)throw Error(Me(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Xl(e,Gi,Fa),tn(e,wr()),null}function zS(e,t){var r=Dt;Dt|=1;try{return e(t)}finally{Dt=r,Dt===0&&(ku=wr()+500,vy&&Tl())}}function Pc(e){Xo!==null&&Xo.tag===0&&!(Dt&6)&&du();var t=Dt;Dt|=1;var r=Qn.transition,i=jt;try{if(Qn.transition=null,jt=1,e)return e()}finally{jt=i,Qn.transition=r,Dt=t,!(Dt&6)&&Tl()}}function kS(){fn=qh.current,tr(qh)}function gc(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,f7(r)),Dr!==null)for(r=Dr.return;r!==null;){var i=r;switch(vS(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&Wv();break;case 3:Bu(),tr(Ji),tr(_i),MS();break;case 5:CS(i);break;case 4:Bu();break;case 13:tr(nr);break;case 19:tr(nr);break;case 10:bS(i.type._context);break;case 22:case 23:kS()}r=r.return}if(ei=e,Dr=e=cl(e.current,null),ci=fn=t,Ur=0,Pf=null,RS=by=Tc=0,Gi=jp=null,oc!==null){for(t=0;t<oc.length;t++)if(r=oc[t],i=r.interleaved,i!==null){r.interleaved=null;var n=i.next,s=r.pending;if(s!==null){var a=s.next;s.next=n,i.next=a}r.pending=i}oc=null}return e}function nI(e,t){do{var r=Dr;try{if(wS(),mv.current=e0,Jv){for(var i=or.memoizedState;i!==null;){var n=i.queue;n!==null&&(n.pending=null),i=i.next}Jv=!1}if(Ec=0,Kr=Nr=or=null,Fp=!1,Mf=0,OS.current=null,r===null||r.return===null){Ur=1,Pf=t,Dr=null;break}e:{var s=e,a=r.return,o=r,l=t;if(t=ci,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var d=u.alternate;d?(u.updateQueue=d.updateQueue,u.memoizedState=d.memoizedState,u.lanes=d.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=qC(a);if(p!==null){p.flags&=-257,XC(p,a,o,s,t),p.mode&1&&WC(s,c,t),t=p,l=c;var f=t.updateQueue;if(f===null){var m=new Set;m.add(l),t.updateQueue=m}else f.add(l);break e}else{if(!(t&1)){WC(s,c,t),NS();break e}l=Error(Me(426))}}else if(ir&&o.mode&1){var g=qC(a);if(g!==null){!(g.flags&65536)&&(g.flags|=256),XC(g,a,o,s,t),yS(zu(l,o));break e}}s=l=zu(l,o),Ur!==4&&(Ur=2),jp===null?jp=[s]:jp.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var v=j6(s,l,t);NC(s,v);break e;case 1:o=l;var y=s.type,x=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(ol===null||!ol.has(x)))){s.flags|=65536,t&=-t,s.lanes|=t;var w=V6(s,o,t);NC(s,w);break e}}s=s.return}while(s!==null)}oI(r)}catch(b){t=b,Dr===r&&r!==null&&(Dr=r=r.return);continue}break}while(1)}function sI(){var e=t0.current;return t0.current=e0,e===null?e0:e}function NS(){(Ur===0||Ur===3||Ur===2)&&(Ur=4),ei===null||!(Tc&268435455)&&!(by&268435455)||Vo(ei,ci)}function n0(e,t){var r=Dt;Dt|=2;var i=sI();(ei!==e||ci!==t)&&(Fa=null,gc(e,t));do try{F7();break}catch(n){nI(e,n)}while(1);if(wS(),Dt=r,t0.current=i,Dr!==null)throw Error(Me(261));return ei=null,ci=0,Ur}function F7(){for(;Dr!==null;)aI(Dr)}function U7(){for(;Dr!==null&&!uN();)aI(Dr)}function aI(e){var t=cI(e.alternate,e,fn);e.memoizedProps=e.pendingProps,t===null?oI(e):Dr=t,OS.current=null}function oI(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=O7(r,t),r!==null){r.flags&=32767,Dr=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ur=6,Dr=null;return}}else if(r=I7(r,t,fn),r!==null){Dr=r;return}if(t=t.sibling,t!==null){Dr=t;return}Dr=t=e}while(t!==null);Ur===0&&(Ur=5)}function Xl(e,t,r){var i=jt,n=Qn.transition;try{Qn.transition=null,jt=1,j7(e,t,r,i)}finally{Qn.transition=n,jt=i}return null}function j7(e,t,r,i){do du();while(Xo!==null);if(Dt&6)throw Error(Me(327));r=e.finishedWork;var n=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Me(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(bN(e,s),e===ei&&(Dr=ei=null,ci=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Nm||(Nm=!0,hI(Fv,function(){return du(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Qn.transition,Qn.transition=null;var a=jt;jt=1;var o=Dt;Dt|=4,OS.current=null,B7(e,r),tI(r,e),o7(xb),jv=!!yb,xb=yb=null,e.current=r,z7(r),dN(),Dt=o,jt=a,Qn.transition=s}else e.current=r;if(Nm&&(Nm=!1,Xo=e,i0=n),s=e.pendingLanes,s===0&&(ol=null),mN(r.stateNode),tn(e,wr()),t!==null)for(i=e.onRecoverableError,r=0;r<t.length;r++)n=t[r],i(n.value,{componentStack:n.stack,digest:n.digest});if(r0)throw r0=!1,e=Fb,Fb=null,e;return i0&1&&e.tag!==0&&du(),s=e.pendingLanes,s&1?e===Ub?Vp++:(Vp=0,Ub=e):Vp=0,Tl(),null}function du(){if(Xo!==null){var e=UL(i0),t=Qn.transition,r=jt;try{if(Qn.transition=null,jt=16>e?16:e,Xo===null)var i=!1;else{if(e=Xo,Xo=null,i0=0,Dt&6)throw Error(Me(331));var n=Dt;for(Dt|=4,Ue=e.current;Ue!==null;){var s=Ue,a=s.child;if(Ue.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(Ue=c;Ue!==null;){var u=Ue;switch(u.tag){case 0:case 11:case 15:Up(8,u,s)}var h=u.child;if(h!==null)h.return=u,Ue=h;else for(;Ue!==null;){u=Ue;var d=u.sibling,p=u.return;if($6(u),u===c){Ue=null;break}if(d!==null){d.return=p,Ue=d;break}Ue=p}}}var f=s.alternate;if(f!==null){var m=f.child;if(m!==null){f.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(m!==null)}}Ue=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,Ue=a;else e:for(;Ue!==null;){if(s=Ue,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Up(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,Ue=v;break e}Ue=s.return}}var y=e.current;for(Ue=y;Ue!==null;){a=Ue;var x=a.child;if(a.subtreeFlags&2064&&x!==null)x.return=a,Ue=x;else e:for(a=y;Ue!==null;){if(o=Ue,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:wy(9,o)}}catch(b){ur(o,o.return,b)}if(o===a){Ue=null;break e}var w=o.sibling;if(w!==null){w.return=o.return,Ue=w;break e}Ue=o.return}}if(Dt=n,Tl(),la&&typeof la.onPostCommitFiberRoot=="function")try{la.onPostCommitFiberRoot(dy,e)}catch{}i=!0}return i}finally{jt=r,Qn.transition=t}}return!1}function aM(e,t,r){t=zu(r,t),t=j6(e,t,1),e=al(e,t,1),t=ki(),e!==null&&(em(e,1,t),tn(e,t))}function ur(e,t,r){if(e.tag===3)aM(e,e,r);else for(;t!==null;){if(t.tag===3){aM(t,e,r);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(ol===null||!ol.has(i))){e=zu(r,e),e=V6(t,e,1),t=al(t,e,1),e=ki(),t!==null&&(em(t,1,e),tn(t,e));break}}t=t.return}}function V7(e,t,r){var i=e.pingCache;i!==null&&i.delete(t),t=ki(),e.pingedLanes|=e.suspendedLanes&r,ei===e&&(ci&r)===r&&(Ur===4||Ur===3&&(ci&130023424)===ci&&500>wr()-BS?gc(e,0):RS|=r),tn(e,t)}function lI(e,t){t===0&&(e.mode&1?(t=Tm,Tm<<=1,!(Tm&130023424)&&(Tm=4194304)):t=1);var r=ki();e=co(e,t),e!==null&&(em(e,t,r),tn(e,r))}function H7(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),lI(e,r)}function G7(e,t){var r=0;switch(e.tag){case 13:var i=e.stateNode,n=e.memoizedState;n!==null&&(r=n.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(Me(314))}i!==null&&i.delete(t),lI(e,r)}var cI;cI=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Ji.current)Qi=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Qi=!1,L7(e,t,r);Qi=!!(e.flags&131072)}else Qi=!1,ir&&t.flags&1048576&&d6(t,Yv,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;vv(e,t),e=t.pendingProps;var n=Iu(t,_i.current);uu(t,r),n=TS(null,t,i,e,n,r);var s=PS();return t.flags|=1,typeof n=="object"&&n!==null&&typeof n.render=="function"&&n.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,en(i)?(s=!0,qv(t)):s=!1,t.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,SS(t),n.updater=yy,t.stateNode=n,n._reactInternals=t,Tb(t,i,e,r),t=Lb(null,t,i,!0,s,r)):(t.tag=0,ir&&s&&gS(t),Di(null,t,n,r),t=t.child),t;case 16:i=t.elementType;e:{switch(vv(e,t),e=t.pendingProps,n=i._init,i=n(i._payload),t.type=i,n=t.tag=q7(i),e=fs(i,e),n){case 0:t=Db(null,t,i,e,r);break e;case 1:t=KC(null,t,i,e,r);break e;case 11:t=YC(null,t,i,e,r);break e;case 14:t=QC(null,t,i,fs(i.type,e),r);break e}throw Error(Me(306,i,""))}return t;case 0:return i=t.type,n=t.pendingProps,n=t.elementType===i?n:fs(i,n),Db(e,t,i,n,r);case 1:return i=t.type,n=t.pendingProps,n=t.elementType===i?n:fs(i,n),KC(e,t,i,n,r);case 3:e:{if(q6(t),e===null)throw Error(Me(387));i=t.pendingProps,s=t.memoizedState,n=s.element,g6(e,t),Zv(t,i,null,r);var a=t.memoizedState;if(i=a.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){n=zu(Error(Me(423)),t),t=ZC(e,t,i,r,n);break e}else if(i!==n){n=zu(Error(Me(424)),t),t=ZC(e,t,i,r,n);break e}else for(vn=sl(t.stateNode.containerInfo.firstChild),Sn=t,ir=!0,vs=null,r=w6(t,null,i,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Ou(),i===n){t=ho(e,t,r);break e}Di(e,t,i,r)}t=t.child}return t;case 5:return b6(t),e===null&&Cb(t),i=t.type,n=t.pendingProps,s=e!==null?e.memoizedProps:null,a=n.children,wb(i,n)?a=null:s!==null&&wb(i,s)&&(t.flags|=32),W6(e,t),Di(e,t,a,r),t.child;case 6:return e===null&&Cb(t),null;case 13:return X6(e,t,r);case 4:return AS(t,t.stateNode.containerInfo),i=t.pendingProps,e===null?t.child=Ru(t,null,i,r):Di(e,t,i,r),t.child;case 11:return i=t.type,n=t.pendingProps,n=t.elementType===i?n:fs(i,n),YC(e,t,i,n,r);case 7:return Di(e,t,t.pendingProps,r),t.child;case 8:return Di(e,t,t.pendingProps.children,r),t.child;case 12:return Di(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(i=t.type._context,n=t.pendingProps,s=t.memoizedProps,a=n.value,$t(Qv,i._currentValue),i._currentValue=a,s!==null)if(Ps(s.value,a)){if(s.children===n.children&&!Ji.current){t=ho(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===i){if(s.tag===1){l=Ja(-1,r&-r),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),Mb(s.return,r,t),o.lanes|=r;break}l=l.next}}else if(s.tag===10)a=s.type===t.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(Me(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),Mb(a,r,t),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===t){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}Di(e,t,n.children,r),t=t.child}return t;case 9:return n=t.type,i=t.pendingProps.children,uu(t,r),n=Jn(n),i=i(n),t.flags|=1,Di(e,t,i,r),t.child;case 14:return i=t.type,n=fs(i,t.pendingProps),n=fs(i.type,n),QC(e,t,i,n,r);case 15:return H6(e,t,t.type,t.pendingProps,r);case 17:return i=t.type,n=t.pendingProps,n=t.elementType===i?n:fs(i,n),vv(e,t),t.tag=1,en(i)?(e=!0,qv(t)):e=!1,uu(t,r),y6(t,i,n),Tb(t,i,n,r),Lb(null,t,i,!0,e,r);case 19:return Y6(e,t,r);case 22:return G6(e,t,r)}throw Error(Me(156,t.tag))};function hI(e,t){return zL(e,t)}function W7(e,t,r,i){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Xn(e,t,r,i){return new W7(e,t,r,i)}function FS(e){return e=e.prototype,!(!e||!e.isReactComponent)}function q7(e){if(typeof e=="function")return FS(e)?1:0;if(e!=null){if(e=e.$$typeof,e===nS)return 11;if(e===sS)return 14}return 2}function cl(e,t){var r=e.alternate;return r===null?(r=Xn(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function wv(e,t,r,i,n,s){var a=2;if(i=e,typeof e=="function")FS(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case zh:return vc(r.children,n,s,t);case iS:a=8,n|=8;break;case $w:return e=Xn(12,r,t,n|2),e.elementType=$w,e.lanes=s,e;case Jw:return e=Xn(13,r,t,n),e.elementType=Jw,e.lanes=s,e;case eb:return e=Xn(19,r,t,n),e.elementType=eb,e.lanes=s,e;case xL:return _y(r,n,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case vL:a=10;break e;case yL:a=9;break e;case nS:a=11;break e;case sS:a=14;break e;case ko:a=16,i=null;break e}throw Error(Me(130,e==null?e:typeof e,""))}return t=Xn(a,r,t,n),t.elementType=e,t.type=i,t.lanes=s,t}function vc(e,t,r,i){return e=Xn(7,e,i,t),e.lanes=r,e}function _y(e,t,r,i){return e=Xn(22,e,i,t),e.elementType=xL,e.lanes=r,e.stateNode={isHidden:!1},e}function N1(e,t,r){return e=Xn(6,e,null,t),e.lanes=r,e}function F1(e,t,r){return t=Xn(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function X7(e,t,r,i,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=x1(0),this.expirationTimes=x1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=x1(0),this.identifierPrefix=i,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function US(e,t,r,i,n,s,a,o,l){return e=new X7(e,t,r,o,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Xn(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:i,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},SS(s),e}function Y7(e,t,r){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Bh,key:i==null?null:""+i,children:e,containerInfo:t,implementation:r}}function uI(e){if(!e)return wl;e=e._reactInternals;e:{if(Fc(e)!==e||e.tag!==1)throw Error(Me(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(en(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Me(171))}if(e.tag===1){var r=e.type;if(en(r))return h6(e,r,t)}return t}function dI(e,t,r,i,n,s,a,o,l){return e=US(r,i,!0,e,n,s,a,o,l),e.context=uI(null),r=e.current,i=ki(),n=ll(r),s=Ja(i,n),s.callback=t??null,al(r,s,n),e.current.lanes=n,em(e,n,i),tn(e,i),e}function Sy(e,t,r,i){var n=t.current,s=ki(),a=ll(n);return r=uI(r),t.context===null?t.context=r:t.pendingContext=r,t=Ja(s,a),t.payload={element:e},i=i===void 0?null:i,i!==null&&(t.callback=i),e=al(n,t,a),e!==null&&(Es(e,n,a,s),fv(e,n,a)),a}function s0(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function oM(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function jS(e,t){oM(e,t),(e=e.alternate)&&oM(e,t)}function Q7(){return null}var pI=typeof reportError=="function"?reportError:function(e){console.error(e)};function VS(e){this._internalRoot=e}Ay.prototype.render=VS.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Me(409));Sy(e,t,null,null)};Ay.prototype.unmount=VS.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Pc(function(){Sy(null,e,null,null)}),t[lo]=null}};function Ay(e){this._internalRoot=e}Ay.prototype.unstable_scheduleHydration=function(e){if(e){var t=HL();e={blockedOn:null,target:e,priority:t};for(var r=0;r<jo.length&&t!==0&&t<jo[r].priority;r++);jo.splice(r,0,e),r===0&&WL(e)}};function HS(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Cy(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function lM(){}function K7(e,t,r,i,n){if(n){if(typeof i=="function"){var s=i;i=function(){var c=s0(a);s.call(c)}}var a=dI(t,i,e,0,null,!1,!1,"",lM);return e._reactRootContainer=a,e[lo]=a.current,bf(e.nodeType===8?e.parentNode:e),Pc(),a}for(;n=e.lastChild;)e.removeChild(n);if(typeof i=="function"){var o=i;i=function(){var c=s0(l);o.call(c)}}var l=US(e,0,!1,null,null,!1,!1,"",lM);return e._reactRootContainer=l,e[lo]=l.current,bf(e.nodeType===8?e.parentNode:e),Pc(function(){Sy(t,l,r,i)}),l}function My(e,t,r,i,n){var s=r._reactRootContainer;if(s){var a=s;if(typeof n=="function"){var o=n;n=function(){var l=s0(a);o.call(l)}}Sy(t,a,e,n)}else a=K7(r,t,e,n,i);return s0(a)}jL=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=bp(t.pendingLanes);r!==0&&(lS(t,r|1),tn(t,wr()),!(Dt&6)&&(ku=wr()+500,Tl()))}break;case 13:Pc(function(){var i=co(e,1);if(i!==null){var n=ki();Es(i,e,1,n)}}),jS(e,1)}};cS=function(e){if(e.tag===13){var t=co(e,134217728);if(t!==null){var r=ki();Es(t,e,134217728,r)}jS(e,134217728)}};VL=function(e){if(e.tag===13){var t=ll(e),r=co(e,t);if(r!==null){var i=ki();Es(r,e,t,i)}jS(e,t)}};HL=function(){return jt};GL=function(e,t){var r=jt;try{return jt=e,t()}finally{jt=r}};hb=function(e,t,r){switch(t){case"input":if(ib(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var i=r[t];if(i!==e&&i.form===e.form){var n=gy(i);if(!n)throw Error(Me(90));bL(i),ib(i,n)}}}break;case"textarea":SL(e,r);break;case"select":t=r.value,t!=null&&ou(e,!!r.multiple,t,!1)}};DL=zS;LL=Pc;var Z7={usingClientEntryPoint:!1,Events:[rm,Uh,gy,TL,PL,zS]},Rd={findFiberByHostInstance:ac,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},$7={bundleType:Rd.bundleType,version:Rd.version,rendererPackageName:Rd.rendererPackageName,rendererConfig:Rd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:mo.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=RL(e),e===null?null:e.stateNode},findFiberByHostInstance:Rd.findFiberByHostInstance||Q7,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Fm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Fm.isDisabled&&Fm.supportsFiber)try{dy=Fm.inject($7),la=Fm}catch{}}Tn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Z7;Tn.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!HS(t))throw Error(Me(200));return Y7(e,t,null,r)};Tn.createRoot=function(e,t){if(!HS(e))throw Error(Me(299));var r=!1,i="",n=pI;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(n=t.onRecoverableError)),t=US(e,1,!1,null,null,r,!1,i,n),e[lo]=t.current,bf(e.nodeType===8?e.parentNode:e),new VS(t)};Tn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Me(188)):(e=Object.keys(e).join(","),Error(Me(268,e)));return e=RL(t),e=e===null?null:e.stateNode,e};Tn.flushSync=function(e){return Pc(e)};Tn.hydrate=function(e,t,r){if(!Cy(t))throw Error(Me(200));return My(null,e,t,!0,r)};Tn.hydrateRoot=function(e,t,r){if(!HS(e))throw Error(Me(405));var i=r!=null&&r.hydratedSources||null,n=!1,s="",a=pI;if(r!=null&&(r.unstable_strictMode===!0&&(n=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),t=dI(t,null,e,1,r??null,n,!1,s,a),e[lo]=t.current,bf(e),i)for(e=0;e<i.length;e++)r=i[e],n=r._getVersion,n=n(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,n]:t.mutableSourceEagerHydrationData.push(r,n);return new Ay(t)};Tn.render=function(e,t,r){if(!Cy(t))throw Error(Me(200));return My(null,e,t,!1,r)};Tn.unmountComponentAtNode=function(e){if(!Cy(e))throw Error(Me(40));return e._reactRootContainer?(Pc(function(){My(null,null,e,!1,function(){e._reactRootContainer=null,e[lo]=null})}),!0):!1};Tn.unstable_batchedUpdates=zS;Tn.unstable_renderSubtreeIntoContainer=function(e,t,r,i){if(!Cy(r))throw Error(Me(200));if(e==null||e._reactInternals===void 0)throw Error(Me(38));return My(e,t,r,!1,i)};Tn.version="18.2.0-next-9e3b772b8-20220608";function fI(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(fI)}catch(e){console.error(e)}}fI(),dL.exports=Tn;var J7=dL.exports,cM=J7;Kw.createRoot=cM.createRoot,Kw.hydrateRoot=cM.hydrateRoot;/**
 * @remix-run/router v1.8.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function rr(){return rr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},rr.apply(this,arguments)}var Pr;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Pr||(Pr={}));const hM="popstate";function e9(e){e===void 0&&(e={});function t(i,n){let{pathname:s,search:a,hash:o}=i.location;return Df("",{pathname:s,search:a,hash:o},n.state&&n.state.usr||null,n.state&&n.state.key||"default")}function r(i,n){return typeof n=="string"?n:Dc(n)}return r9(t,r,null,e)}function yt(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Nu(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function t9(){return Math.random().toString(36).substr(2,8)}function uM(e,t){return{usr:e.state,key:e.key,idx:t}}function Df(e,t,r,i){return r===void 0&&(r=null),rr({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?go(t):t,{state:r,key:t&&t.key||i||t9()})}function Dc(e){let{pathname:t="/",search:r="",hash:i=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),i&&i!=="#"&&(t+=i.charAt(0)==="#"?i:"#"+i),t}function go(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let i=e.indexOf("?");i>=0&&(t.search=e.substr(i),e=e.substr(0,i)),e&&(t.pathname=e)}return t}function r9(e,t,r,i){i===void 0&&(i={});let{window:n=document.defaultView,v5Compat:s=!1}=i,a=n.history,o=Pr.Pop,l=null,c=u();c==null&&(c=0,a.replaceState(rr({},a.state,{idx:c}),""));function u(){return(a.state||{idx:null}).idx}function h(){o=Pr.Pop;let g=u(),v=g==null?null:g-c;c=g,l&&l({action:o,location:m.location,delta:v})}function d(g,v){o=Pr.Push;let y=Df(m.location,g,v);r&&r(y,g),c=u()+1;let x=uM(y,c),w=m.createHref(y);try{a.pushState(x,"",w)}catch(b){if(b instanceof DOMException&&b.name==="DataCloneError")throw b;n.location.assign(w)}s&&l&&l({action:o,location:m.location,delta:1})}function p(g,v){o=Pr.Replace;let y=Df(m.location,g,v);r&&r(y,g),c=u();let x=uM(y,c),w=m.createHref(y);a.replaceState(x,"",w),s&&l&&l({action:o,location:m.location,delta:0})}function f(g){let v=n.location.origin!=="null"?n.location.origin:n.location.href,y=typeof g=="string"?g:Dc(g);return yt(v,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,v)}let m={get action(){return o},get location(){return e(n,a)},listen(g){if(l)throw new Error("A history only accepts one active listener");return n.addEventListener(hM,h),l=g,()=>{n.removeEventListener(hM,h),l=null}},createHref(g){return t(n,g)},createURL:f,encodeLocation(g){let v=f(g);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:d,replace:p,go(g){return a.go(g)}};return m}var xr;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(xr||(xr={}));const i9=new Set(["lazy","caseSensitive","path","id","index","children"]);function n9(e){return e.index===!0}function Hb(e,t,r,i){return r===void 0&&(r=[]),i===void 0&&(i={}),e.map((n,s)=>{let a=[...r,s],o=typeof n.id=="string"?n.id:a.join("-");if(yt(n.index!==!0||!n.children,"Cannot specify children on an index route"),yt(!i[o],'Found a route id collision on id "'+o+`".  Route id's must be globally unique within Data Router usages`),n9(n)){let l=rr({},n,t(n),{id:o});return i[o]=l,l}else{let l=rr({},n,t(n),{id:o,children:void 0});return i[o]=l,n.children&&(l.children=Hb(n.children,t,a,i)),l}})}function Xh(e,t,r){r===void 0&&(r="/");let i=typeof t=="string"?go(t):t,n=ad(i.pathname||"/",r);if(n==null)return null;let s=mI(e);s9(s);let a=null;for(let o=0;a==null&&o<s.length;++o)a=f9(s[o],v9(n));return a}function mI(e,t,r,i){t===void 0&&(t=[]),r===void 0&&(r=[]),i===void 0&&(i="");let n=(s,a,o)=>{let l={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:a,route:s};l.relativePath.startsWith("/")&&(yt(l.relativePath.startsWith(i),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+i+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(i.length));let c=eo([i,l.relativePath]),u=r.concat(l);s.children&&s.children.length>0&&(yt(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),mI(s.children,t,u,c)),!(s.path==null&&!s.index)&&t.push({path:c,score:d9(c,s.index),routesMeta:u})};return e.forEach((s,a)=>{var o;if(s.path===""||!((o=s.path)!=null&&o.includes("?")))n(s,a);else for(let l of gI(s.path))n(s,a,l)}),t}function gI(e){let t=e.split("/");if(t.length===0)return[];let[r,...i]=t,n=r.endsWith("?"),s=r.replace(/\?$/,"");if(i.length===0)return n?[s,""]:[s];let a=gI(i.join("/")),o=[];return o.push(...a.map(l=>l===""?s:[s,l].join("/"))),n&&o.push(...a),o.map(l=>e.startsWith("/")&&l===""?"/":l)}function s9(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:p9(t.routesMeta.map(i=>i.childrenIndex),r.routesMeta.map(i=>i.childrenIndex)))}const a9=/^:\w+$/,o9=3,l9=2,c9=1,h9=10,u9=-2,dM=e=>e==="*";function d9(e,t){let r=e.split("/"),i=r.length;return r.some(dM)&&(i+=u9),t&&(i+=l9),r.filter(n=>!dM(n)).reduce((n,s)=>n+(a9.test(s)?o9:s===""?c9:h9),i)}function p9(e,t){return e.length===t.length&&e.slice(0,-1).every((i,n)=>i===t[n])?e[e.length-1]-t[t.length-1]:0}function f9(e,t){let{routesMeta:r}=e,i={},n="/",s=[];for(let a=0;a<r.length;++a){let o=r[a],l=a===r.length-1,c=n==="/"?t:t.slice(n.length)||"/",u=m9({path:o.relativePath,caseSensitive:o.caseSensitive,end:l},c);if(!u)return null;Object.assign(i,u.params);let h=o.route;s.push({params:i,pathname:eo([n,u.pathname]),pathnameBase:b9(eo([n,u.pathnameBase])),route:h}),u.pathnameBase!=="/"&&(n=eo([n,u.pathnameBase]))}return s}function m9(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,i]=g9(e.path,e.caseSensitive,e.end),n=t.match(r);if(!n)return null;let s=n[0],a=s.replace(/(.)\/+$/,"$1"),o=n.slice(1);return{params:i.reduce((c,u,h)=>{if(u==="*"){let d=o[h]||"";a=s.slice(0,s.length-d.length).replace(/(.)\/+$/,"$1")}return c[u]=y9(o[h]||"",u),c},{}),pathname:s,pathnameBase:a,pattern:e}}function g9(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),Nu(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let i=[],n="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(a,o)=>(i.push(o),"/([^\\/]+)"));return e.endsWith("*")?(i.push("*"),n+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?n+="\\/*$":e!==""&&e!=="/"&&(n+="(?:(?=\\/|$))"),[new RegExp(n,t?void 0:"i"),i]}function v9(e){try{return decodeURI(e)}catch(t){return Nu(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function y9(e,t){try{return decodeURIComponent(e)}catch(r){return Nu(!1,'The value for the URL param "'+t+'" will not be decoded because'+(' the string "'+e+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+r+").")),e}}function ad(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,i=e.charAt(r);return i&&i!=="/"?null:e.slice(r)||"/"}function x9(e,t){t===void 0&&(t="/");let{pathname:r,search:i="",hash:n=""}=typeof e=="string"?go(e):e;return{pathname:r?r.startsWith("/")?r:w9(r,t):t,search:_9(i),hash:S9(n)}}function w9(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(n=>{n===".."?r.length>1&&r.pop():n!=="."&&r.push(n)}),r.length>1?r.join("/"):"/"}function U1(e,t,r,i){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(i)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Ey(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function GS(e,t,r,i){i===void 0&&(i=!1);let n;typeof e=="string"?n=go(e):(n=rr({},e),yt(!n.pathname||!n.pathname.includes("?"),U1("?","pathname","search",n)),yt(!n.pathname||!n.pathname.includes("#"),U1("#","pathname","hash",n)),yt(!n.search||!n.search.includes("#"),U1("#","search","hash",n)));let s=e===""||n.pathname==="",a=s?"/":n.pathname,o;if(i||a==null)o=r;else{let h=t.length-1;if(a.startsWith("..")){let d=a.split("/");for(;d[0]==="..";)d.shift(),h-=1;n.pathname=d.join("/")}o=h>=0?t[h]:"/"}let l=x9(n,o),c=a&&a!=="/"&&a.endsWith("/"),u=(s||a===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const eo=e=>e.join("/").replace(/\/\/+/g,"/"),b9=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),_9=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,S9=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;class WS{constructor(t,r,i,n){n===void 0&&(n=!1),this.status=t,this.statusText=r||"",this.internal=n,i instanceof Error?(this.data=i.toString(),this.error=i):this.data=i}}function vI(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const yI=["post","put","patch","delete"],A9=new Set(yI),C9=["get",...yI],M9=new Set(C9),E9=new Set([301,302,303,307,308]),T9=new Set([307,308]),j1={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},P9={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Bd={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},xI=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,D9=e=>({hasErrorBoundary:!!e.hasErrorBoundary});function L9(e){const t=e.window?e.window:typeof window<"u"?window:void 0,r=typeof t<"u"&&typeof t.document<"u"&&typeof t.document.createElement<"u",i=!r;yt(e.routes.length>0,"You must provide a non-empty routes array to createRouter");let n;if(e.mapRouteProperties)n=e.mapRouteProperties;else if(e.detectErrorBoundary){let Q=e.detectErrorBoundary;n=$=>({hasErrorBoundary:Q($)})}else n=D9;let s={},a=Hb(e.routes,n,void 0,s),o,l=e.basename||"/",c=rr({v7_normalizeFormMethod:!1,v7_prependBasename:!1},e.future),u=null,h=new Set,d=null,p=null,f=null,m=e.hydrationData!=null,g=Xh(a,e.history.location,l),v=null;if(g==null){let Q=Nn(404,{pathname:e.history.location.pathname}),{matches:$,route:de}=wM(a);g=$,v={[de.id]:Q}}let y=!g.some(Q=>Q.route.lazy)&&(!g.some(Q=>Q.route.loader)||e.hydrationData!=null),x,w={historyAction:e.history.action,location:e.history.location,matches:g,initialized:y,navigation:j1,restoreScrollPosition:e.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:e.hydrationData&&e.hydrationData.loaderData||{},actionData:e.hydrationData&&e.hydrationData.actionData||null,errors:e.hydrationData&&e.hydrationData.errors||v,fetchers:new Map,blockers:new Map},b=Pr.Pop,_=!1,A,S=!1,C=!1,M=[],T=[],P=new Map,D=0,I=-1,B=new Map,X=new Set,H=new Map,R=new Map,q=new Map,F=!1;function N(){return u=e.history.listen(Q=>{let{action:$,location:de,delta:Ee}=Q;if(F){F=!1;return}Nu(q.size===0||Ee!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let He=Te({currentLocation:w.location,nextLocation:de,historyAction:$});if(He&&Ee!=null){F=!0,e.history.go(Ee*-1),xe(He,{state:"blocked",location:de,proceed(){xe(He,{state:"proceeding",proceed:void 0,reset:void 0,location:de}),e.history.go(Ee)},reset(){let G=new Map(w.blockers);G.set(He,Bd),U({blockers:G})}});return}return J($,de)}),w.initialized||J(Pr.Pop,w.location),x}function j(){u&&u(),h.clear(),A&&A.abort(),w.fetchers.forEach((Q,$)=>Ae($)),w.blockers.forEach((Q,$)=>be($))}function K(Q){return h.add(Q),()=>h.delete(Q)}function U(Q){w=rr({},w,Q),h.forEach($=>$(w))}function Y(Q,$){var de,Ee;let He=w.actionData!=null&&w.navigation.formMethod!=null&&gs(w.navigation.formMethod)&&w.navigation.state==="loading"&&((de=Q.state)==null?void 0:de._isRedirect)!==!0,G;$.actionData?Object.keys($.actionData).length>0?G=$.actionData:G=null:He?G=w.actionData:G=null;let te=$.loaderData?xM(w.loaderData,$.loaderData,$.matches||[],$.errors):w.loaderData,ae=w.blockers;ae.size>0&&(ae=new Map(ae),ae.forEach((Le,Je)=>ae.set(Je,Bd)));let me=_===!0||w.navigation.formMethod!=null&&gs(w.navigation.formMethod)&&((Ee=Q.state)==null?void 0:Ee._isRedirect)!==!0;o&&(a=o,o=void 0),S||b===Pr.Pop||(b===Pr.Push?e.history.push(Q,Q.state):b===Pr.Replace&&e.history.replace(Q,Q.state)),U(rr({},$,{actionData:G,loaderData:te,historyAction:b,location:Q,initialized:!0,navigation:j1,revalidation:"idle",restoreScrollPosition:qe(Q,$.matches||w.matches),preventScrollReset:me,blockers:ae})),b=Pr.Pop,_=!1,S=!1,C=!1,M=[],T=[]}async function V(Q,$){if(typeof Q=="number"){e.history.go(Q);return}let de=Gb(w.location,w.matches,l,c.v7_prependBasename,Q,$==null?void 0:$.fromRouteId,$==null?void 0:$.relative),{path:Ee,submission:He,error:G}=pM(c.v7_normalizeFormMethod,!1,de,$),te=w.location,ae=Df(w.location,Ee,$&&$.state);ae=rr({},ae,e.history.encodeLocation(ae));let me=$&&$.replace!=null?$.replace:void 0,Le=Pr.Push;me===!0?Le=Pr.Replace:me===!1||He!=null&&gs(He.formMethod)&&He.formAction===w.location.pathname+w.location.search&&(Le=Pr.Replace);let Je=$&&"preventScrollReset"in $?$.preventScrollReset===!0:void 0,ot=Te({currentLocation:te,nextLocation:ae,historyAction:Le});if(ot){xe(ot,{state:"blocked",location:ae,proceed(){xe(ot,{state:"proceeding",proceed:void 0,reset:void 0,location:ae}),V(Q,$)},reset(){let bt=new Map(w.blockers);bt.set(ot,Bd),U({blockers:bt})}});return}return await J(Le,ae,{submission:He,pendingError:G,preventScrollReset:Je,replace:$&&$.replace})}function ie(){if(Oe(),U({revalidation:"loading"}),w.navigation.state!=="submitting"){if(w.navigation.state==="idle"){J(w.historyAction,w.location,{startUninterruptedRevalidation:!0});return}J(b||w.historyAction,w.navigation.location,{overrideNavigation:w.navigation})}}async function J(Q,$,de){A&&A.abort(),A=null,b=Q,S=(de&&de.startUninterruptedRevalidation)===!0,Ve(w.location,w.matches),_=(de&&de.preventScrollReset)===!0;let Ee=o||a,He=de&&de.overrideNavigation,G=Xh(Ee,$,l);if(!G){let bt=Nn(404,{pathname:$.pathname}),{matches:Qt,route:Lt}=wM(Ee);Ge(),Y($,{matches:Qt,loaderData:{},errors:{[Lt.id]:bt}});return}if(w.initialized&&!C&&z9(w.location,$)&&!(de&&de.submission&&gs(de.submission.formMethod))){Y($,{matches:G});return}A=new AbortController;let te=kd(e.history,$,A.signal,de&&de.submission),ae,me;if(de&&de.pendingError)me={[Yh(G).route.id]:de.pendingError};else if(de&&de.submission&&gs(de.submission.formMethod)){let bt=await ee(te,$,de.submission,G,{replace:de.replace});if(bt.shortCircuited)return;ae=bt.pendingActionData,me=bt.pendingActionError,He=Um($,de.submission),te=new Request(te.url,{signal:te.signal})}let{shortCircuited:Le,loaderData:Je,errors:ot}=await se(te,$,G,He,de&&de.submission,de&&de.fetcherSubmission,de&&de.replace,ae,me);Le||(A=null,Y($,rr({matches:G},ae?{actionData:ae}:{},{loaderData:Je,errors:ot})))}async function ee(Q,$,de,Ee,He){He===void 0&&(He={}),Oe();let G=j9($,de);U({navigation:G});let te,ae=qb(Ee,$);if(!ae.route.action&&!ae.route.lazy)te={type:xr.error,error:Nn(405,{method:Q.method,pathname:$.pathname,routeId:ae.route.id})};else if(te=await zd("action",Q,ae,Ee,s,n,l),Q.signal.aborted)return{shortCircuited:!0};if(pu(te)){let me;return He&&He.replace!=null?me=He.replace:me=te.location===w.location.pathname+w.location.search,await Se(w,te,{submission:de,replace:me}),{shortCircuited:!0}}if(Hp(te)){let me=Yh(Ee,ae.route.id);return(He&&He.replace)!==!0&&(b=Pr.Push),{pendingActionData:{},pendingActionError:{[me.route.id]:te.error}}}if(cc(te))throw Nn(400,{type:"defer-action"});return{pendingActionData:{[ae.route.id]:te.data}}}async function se(Q,$,de,Ee,He,G,te,ae,me){let Le=Ee||Um($,He),Je=He||G||SM(Le),ot=o||a,[bt,Qt]=fM(e.history,w,de,Je,$,C,M,T,H,X,ot,l,ae,me);if(Ge(Z=>!(de&&de.some(fe=>fe.route.id===Z))||bt&&bt.some(fe=>fe.route.id===Z)),I=++D,bt.length===0&&Qt.length===0){let Z=k();return Y($,rr({matches:de,loaderData:{},errors:me||null},ae?{actionData:ae}:{},Z?{fetchers:new Map(w.fetchers)}:{})),{shortCircuited:!0}}if(!S){Qt.forEach(fe=>{let Fe=w.fetchers.get(fe.key),lt=Nd(void 0,Fe?Fe.data:void 0);w.fetchers.set(fe.key,lt)});let Z=ae||w.actionData;U(rr({navigation:Le},Z?Object.keys(Z).length===0?{actionData:null}:{actionData:Z}:{},Qt.length>0?{fetchers:new Map(w.fetchers)}:{}))}Qt.forEach(Z=>{P.has(Z.key)&&je(Z.key),Z.controller&&P.set(Z.key,Z.controller)});let Lt=()=>Qt.forEach(Z=>je(Z.key));A&&A.signal.addEventListener("abort",Lt);let{results:ii,loaderResults:qr,fetcherResults:Qc}=await ke(w.matches,de,bt,Qt,Q);if(Q.signal.aborted)return{shortCircuited:!0};A&&A.signal.removeEventListener("abort",Lt),Qt.forEach(Z=>P.delete(Z.key));let is=bM(ii);if(is){if(is.idx>=bt.length){let Z=Qt[is.idx-bt.length].key;X.add(Z)}return await Se(w,is.result,{replace:te}),{shortCircuited:!0}}let{loaderData:ns,errors:Kc}=yM(w,de,bt,qr,me,Qt,Qc,R);R.forEach((Z,fe)=>{Z.subscribe(Fe=>{(Fe||Z.done)&&R.delete(fe)})});let z=k(),le=O(I),ge=z||le||Qt.length>0;return rr({loaderData:ns,errors:Kc},ge?{fetchers:new Map(w.fetchers)}:{})}function ce(Q){return w.fetchers.get(Q)||P9}function ue(Q,$,de,Ee){if(i)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");P.has(Q)&&je(Q);let He=o||a,G=Gb(w.location,w.matches,l,c.v7_prependBasename,de,$,Ee==null?void 0:Ee.relative),te=Xh(He,G,l);if(!te){Ce(Q,$,Nn(404,{pathname:G}));return}let{path:ae,submission:me,error:Le}=pM(c.v7_normalizeFormMethod,!0,G,Ee);if(Le){Ce(Q,$,Le);return}let Je=qb(te,ae);if(_=(Ee&&Ee.preventScrollReset)===!0,me&&gs(me.formMethod)){ye(Q,$,ae,Je,te,me);return}H.set(Q,{routeId:$,path:ae}),Re(Q,$,ae,Je,te,me)}async function ye(Q,$,de,Ee,He,G){if(Oe(),H.delete(Q),!Ee.route.action&&!Ee.route.lazy){let Ye=Nn(405,{method:G.formMethod,pathname:de,routeId:$});Ce(Q,$,Ye);return}let te=w.fetchers.get(Q),ae=V9(G,te);w.fetchers.set(Q,ae),U({fetchers:new Map(w.fetchers)});let me=new AbortController,Le=kd(e.history,de,me.signal,G);P.set(Q,me);let Je=D,ot=await zd("action",Le,Ee,He,s,n,l);if(Le.signal.aborted){P.get(Q)===me&&P.delete(Q);return}if(pu(ot))if(P.delete(Q),I>Je){let Ye=Ph(void 0);w.fetchers.set(Q,Ye),U({fetchers:new Map(w.fetchers)});return}else{X.add(Q);let Ye=Nd(G);return w.fetchers.set(Q,Ye),U({fetchers:new Map(w.fetchers)}),Se(w,ot,{submission:G,isFetchActionRedirect:!0})}if(Hp(ot)){Ce(Q,$,ot.error);return}if(cc(ot))throw Nn(400,{type:"defer-action"});let bt=w.navigation.location||w.location,Qt=kd(e.history,bt,me.signal),Lt=o||a,ii=w.navigation.state!=="idle"?Xh(Lt,w.navigation.location,l):w.matches;yt(ii,"Didn't find any matches after fetcher action");let qr=++D;B.set(Q,qr);let Qc=Nd(G,ot.data);w.fetchers.set(Q,Qc);let[is,ns]=fM(e.history,w,ii,G,bt,C,M,T,H,X,Lt,l,{[Ee.route.id]:ot.data},void 0);ns.filter(Ye=>Ye.key!==Q).forEach(Ye=>{let gt=Ye.key,Rt=w.fetchers.get(gt),Et=Nd(void 0,Rt?Rt.data:void 0);w.fetchers.set(gt,Et),P.has(gt)&&je(gt),Ye.controller&&P.set(gt,Ye.controller)}),U({fetchers:new Map(w.fetchers)});let Kc=()=>ns.forEach(Ye=>je(Ye.key));me.signal.addEventListener("abort",Kc);let{results:z,loaderResults:le,fetcherResults:ge}=await ke(w.matches,ii,is,ns,Qt);if(me.signal.aborted)return;me.signal.removeEventListener("abort",Kc),B.delete(Q),P.delete(Q),ns.forEach(Ye=>P.delete(Ye.key));let Z=bM(z);if(Z){if(Z.idx>=is.length){let Ye=ns[Z.idx-is.length].key;X.add(Ye)}return Se(w,Z.result)}let{loaderData:fe,errors:Fe}=yM(w,w.matches,is,le,void 0,ns,ge,R);if(w.fetchers.has(Q)){let Ye=Ph(ot.data);w.fetchers.set(Q,Ye)}let lt=O(qr);w.navigation.state==="loading"&&qr>I?(yt(b,"Expected pending action"),A&&A.abort(),Y(w.navigation.location,{matches:ii,loaderData:fe,errors:Fe,fetchers:new Map(w.fetchers)})):(U(rr({errors:Fe,loaderData:xM(w.loaderData,fe,ii,Fe)},lt||ns.length>0?{fetchers:new Map(w.fetchers)}:{})),C=!1)}async function Re(Q,$,de,Ee,He,G){let te=w.fetchers.get(Q),ae=Nd(G,te?te.data:void 0);w.fetchers.set(Q,ae),U({fetchers:new Map(w.fetchers)});let me=new AbortController,Le=kd(e.history,de,me.signal);P.set(Q,me);let Je=D,ot=await zd("loader",Le,Ee,He,s,n,l);if(cc(ot)&&(ot=await _I(ot,Le.signal,!0)||ot),P.get(Q)===me&&P.delete(Q),Le.signal.aborted)return;if(pu(ot))if(I>Je){let Qt=Ph(void 0);w.fetchers.set(Q,Qt),U({fetchers:new Map(w.fetchers)});return}else{X.add(Q),await Se(w,ot);return}if(Hp(ot)){let Qt=Yh(w.matches,$);w.fetchers.delete(Q),U({fetchers:new Map(w.fetchers),errors:{[Qt.route.id]:ot.error}});return}yt(!cc(ot),"Unhandled fetcher deferred data");let bt=Ph(ot.data);w.fetchers.set(Q,bt),U({fetchers:new Map(w.fetchers)})}async function Se(Q,$,de){let{submission:Ee,replace:He,isFetchActionRedirect:G}=de===void 0?{}:de;$.revalidate&&(C=!0);let te=Df(Q.location,$.location,rr({_isRedirect:!0},G?{_isFetchActionRedirect:!0}:{}));if(yt(te,"Expected a location on the redirect navigation"),r){let Le=!1;if($.reloadDocument)Le=!0;else if(xI.test($.location)){const Je=e.history.createURL($.location);Le=Je.origin!==t.location.origin||ad(Je.pathname,l)==null}if(Le){He?t.location.replace($.location):t.location.assign($.location);return}}A=null;let ae=He===!0?Pr.Replace:Pr.Push,me=Ee||SM(Q.navigation);if(T9.has($.status)&&me&&gs(me.formMethod))await J(ae,te,{submission:rr({},me,{formAction:$.location}),preventScrollReset:_});else if(G)await J(ae,te,{overrideNavigation:Um(te),fetcherSubmission:me,preventScrollReset:_});else{let Le=Um(te,me);await J(ae,te,{overrideNavigation:Le,preventScrollReset:_})}}async function ke(Q,$,de,Ee,He){let G=await Promise.all([...de.map(me=>zd("loader",He,me,$,s,n,l)),...Ee.map(me=>me.matches&&me.match&&me.controller?zd("loader",kd(e.history,me.path,me.controller.signal),me.match,me.matches,s,n,l):{type:xr.error,error:Nn(404,{pathname:me.path})})]),te=G.slice(0,de.length),ae=G.slice(de.length);return await Promise.all([_M(Q,de,te,te.map(()=>He.signal),!1,w.loaderData),_M(Q,Ee.map(me=>me.match),ae,Ee.map(me=>me.controller?me.controller.signal:null),!0)]),{results:G,loaderResults:te,fetcherResults:ae}}function Oe(){C=!0,M.push(...Ge()),H.forEach((Q,$)=>{P.has($)&&(T.push($),je($))})}function Ce(Q,$,de){let Ee=Yh(w.matches,$);Ae(Q),U({errors:{[Ee.route.id]:de},fetchers:new Map(w.fetchers)})}function Ae(Q){let $=w.fetchers.get(Q);P.has(Q)&&!($&&$.state==="loading"&&B.has(Q))&&je(Q),H.delete(Q),B.delete(Q),X.delete(Q),w.fetchers.delete(Q)}function je(Q){let $=P.get(Q);yt($,"Expected fetch controller: "+Q),$.abort(),P.delete(Q)}function We(Q){for(let $ of Q){let de=ce($),Ee=Ph(de.data);w.fetchers.set($,Ee)}}function k(){let Q=[],$=!1;for(let de of X){let Ee=w.fetchers.get(de);yt(Ee,"Expected fetcher: "+de),Ee.state==="loading"&&(X.delete(de),Q.push(de),$=!0)}return We(Q),$}function O(Q){let $=[];for(let[de,Ee]of B)if(Ee<Q){let He=w.fetchers.get(de);yt(He,"Expected fetcher: "+de),He.state==="loading"&&(je(de),B.delete(de),$.push(de))}return We($),$.length>0}function oe(Q,$){let de=w.blockers.get(Q)||Bd;return q.get(Q)!==$&&q.set(Q,$),de}function be(Q){w.blockers.delete(Q),q.delete(Q)}function xe(Q,$){let de=w.blockers.get(Q)||Bd;yt(de.state==="unblocked"&&$.state==="blocked"||de.state==="blocked"&&$.state==="blocked"||de.state==="blocked"&&$.state==="proceeding"||de.state==="blocked"&&$.state==="unblocked"||de.state==="proceeding"&&$.state==="unblocked","Invalid blocker state transition: "+de.state+" -> "+$.state);let Ee=new Map(w.blockers);Ee.set(Q,$),U({blockers:Ee})}function Te(Q){let{currentLocation:$,nextLocation:de,historyAction:Ee}=Q;if(q.size===0)return;q.size>1&&Nu(!1,"A router only supports one blocker at a time");let He=Array.from(q.entries()),[G,te]=He[He.length-1],ae=w.blockers.get(G);if(!(ae&&ae.state==="proceeding")&&te({currentLocation:$,nextLocation:de,historyAction:Ee}))return G}function Ge(Q){let $=[];return R.forEach((de,Ee)=>{(!Q||Q(Ee))&&(de.cancel(),$.push(Ee),R.delete(Ee))}),$}function Ie(Q,$,de){if(d=Q,f=$,p=de||null,!m&&w.navigation===j1){m=!0;let Ee=qe(w.location,w.matches);Ee!=null&&U({restoreScrollPosition:Ee})}return()=>{d=null,f=null,p=null}}function pe(Q,$){return p&&p(Q,$.map(Ee=>U9(Ee,w.loaderData)))||Q.key}function Ve(Q,$){if(d&&f){let de=pe(Q,$);d[de]=f()}}function qe(Q,$){if(d){let de=pe(Q,$),Ee=d[de];if(typeof Ee=="number")return Ee}return null}function Xe(Q){s={},o=Hb(Q,n,void 0,s)}return x={get basename(){return l},get state(){return w},get routes(){return a},initialize:N,subscribe:K,enableScrollRestoration:Ie,navigate:V,fetch:ue,revalidate:ie,createHref:Q=>e.history.createHref(Q),encodeLocation:Q=>e.history.encodeLocation(Q),getFetcher:ce,deleteFetcher:Ae,dispose:j,getBlocker:oe,deleteBlocker:be,_internalFetchControllers:P,_internalActiveDeferreds:R,_internalSetRoutes:Xe},x}function I9(e){return e!=null&&("formData"in e&&e.formData!=null||"body"in e&&e.body!==void 0)}function Gb(e,t,r,i,n,s,a){let o,l;if(s!=null&&a!=="path"){o=[];for(let u of t)if(o.push(u),u.route.id===s){l=u;break}}else o=t,l=t[t.length-1];let c=GS(n||".",Ey(o).map(u=>u.pathnameBase),ad(e.pathname,r)||e.pathname,a==="path");return n==null&&(c.search=e.search,c.hash=e.hash),(n==null||n===""||n===".")&&l&&l.route.index&&!qS(c.search)&&(c.search=c.search?c.search.replace(/^\?/,"?index&"):"?index"),i&&r!=="/"&&(c.pathname=c.pathname==="/"?r:eo([r,c.pathname])),Dc(c)}function pM(e,t,r,i){if(!i||!I9(i))return{path:r};if(i.formMethod&&!F9(i.formMethod))return{path:r,error:Nn(405,{method:i.formMethod})};let n=()=>({path:r,error:Nn(400,{type:"invalid-body"})}),s=i.formMethod||"get",a=e?s.toUpperCase():s.toLowerCase(),o=bI(r);if(i.body!==void 0){if(i.formEncType==="text/plain"){if(!gs(a))return n();let d=typeof i.body=="string"?i.body:i.body instanceof FormData||i.body instanceof URLSearchParams?Array.from(i.body.entries()).reduce((p,f)=>{let[m,g]=f;return""+p+m+"="+g+`
`},""):String(i.body);return{path:r,submission:{formMethod:a,formAction:o,formEncType:i.formEncType,formData:void 0,json:void 0,text:d}}}else if(i.formEncType==="application/json"){if(!gs(a))return n();try{let d=typeof i.body=="string"?JSON.parse(i.body):i.body;return{path:r,submission:{formMethod:a,formAction:o,formEncType:i.formEncType,formData:void 0,json:d,text:void 0}}}catch{return n()}}}yt(typeof FormData=="function","FormData is not available in this environment");let l,c;if(i.formData)l=Wb(i.formData),c=i.formData;else if(i.body instanceof FormData)l=Wb(i.body),c=i.body;else if(i.body instanceof URLSearchParams)l=i.body,c=vM(l);else if(i.body==null)l=new URLSearchParams,c=new FormData;else try{l=new URLSearchParams(i.body),c=vM(l)}catch{return n()}let u={formMethod:a,formAction:o,formEncType:i&&i.formEncType||"application/x-www-form-urlencoded",formData:c,json:void 0,text:void 0};if(gs(u.formMethod))return{path:r,submission:u};let h=go(r);return t&&h.search&&qS(h.search)&&l.append("index",""),h.search="?"+l,{path:Dc(h),submission:u}}function O9(e,t){let r=e;if(t){let i=e.findIndex(n=>n.route.id===t);i>=0&&(r=e.slice(0,i))}return r}function fM(e,t,r,i,n,s,a,o,l,c,u,h,d,p){let f=p?Object.values(p)[0]:d?Object.values(d)[0]:void 0,m=e.createURL(t.location),g=e.createURL(n),v=p?Object.keys(p)[0]:void 0,x=O9(r,v).filter((b,_)=>{if(b.route.lazy)return!0;if(b.route.loader==null)return!1;if(R9(t.loaderData,t.matches[_],b)||a.some(C=>C===b.route.id))return!0;let A=t.matches[_],S=b;return mM(b,rr({currentUrl:m,currentParams:A.params,nextUrl:g,nextParams:S.params},i,{actionResult:f,defaultShouldRevalidate:s||m.pathname+m.search===g.pathname+g.search||m.search!==g.search||wI(A,S)}))}),w=[];return l.forEach((b,_)=>{if(!r.some(T=>T.route.id===b.routeId))return;let A=Xh(u,b.path,h);if(!A){w.push({key:_,routeId:b.routeId,path:b.path,matches:null,match:null,controller:null});return}let S=t.fetchers.get(_),C=qb(A,b.path),M=!1;c.has(_)?M=!1:o.includes(_)?M=!0:S&&S.state!=="idle"&&S.data===void 0?M=s:M=mM(C,rr({currentUrl:m,currentParams:t.matches[t.matches.length-1].params,nextUrl:g,nextParams:r[r.length-1].params},i,{actionResult:f,defaultShouldRevalidate:s})),M&&w.push({key:_,routeId:b.routeId,path:b.path,matches:A,match:C,controller:new AbortController})}),[x,w]}function R9(e,t,r){let i=!t||r.route.id!==t.route.id,n=e[r.route.id]===void 0;return i||n}function wI(e,t){let r=e.route.path;return e.pathname!==t.pathname||r!=null&&r.endsWith("*")&&e.params["*"]!==t.params["*"]}function mM(e,t){if(e.route.shouldRevalidate){let r=e.route.shouldRevalidate(t);if(typeof r=="boolean")return r}return t.defaultShouldRevalidate}async function gM(e,t,r){if(!e.lazy)return;let i=await e.lazy();if(!e.lazy)return;let n=r[e.id];yt(n,"No route found in manifest");let s={};for(let a in i){let l=n[a]!==void 0&&a!=="hasErrorBoundary";Nu(!l,'Route "'+n.id+'" has a static property "'+a+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+a+'" will be ignored.')),!l&&!i9.has(a)&&(s[a]=i[a])}Object.assign(n,s),Object.assign(n,rr({},t(n),{lazy:void 0}))}async function zd(e,t,r,i,n,s,a,o){o===void 0&&(o={});let l,c,u,h=f=>{let m,g=new Promise((v,y)=>m=y);return u=()=>m(),t.signal.addEventListener("abort",u),Promise.race([f({request:t,params:r.params,context:o.requestContext}),g])};try{let f=r.route[e];if(r.route.lazy)if(f)c=(await Promise.all([h(f),gM(r.route,s,n)]))[0];else if(await gM(r.route,s,n),f=r.route[e],f)c=await h(f);else if(e==="action"){let m=new URL(t.url),g=m.pathname+m.search;throw Nn(405,{method:t.method,pathname:g,routeId:r.route.id})}else return{type:xr.data,data:void 0};else if(f)c=await h(f);else{let m=new URL(t.url),g=m.pathname+m.search;throw Nn(404,{pathname:g})}yt(c!==void 0,"You defined "+(e==="action"?"an action":"a loader")+" for route "+('"'+r.route.id+"\" but didn't return anything from your `"+e+"` ")+"function. Please return a value or `null`.")}catch(f){l=xr.error,c=f}finally{u&&t.signal.removeEventListener("abort",u)}if(N9(c)){let f=c.status;if(E9.has(f)){let v=c.headers.get("Location");if(yt(v,"Redirects returned/thrown from loaders/actions must have a Location header"),!xI.test(v))v=Gb(new URL(t.url),i.slice(0,i.indexOf(r)+1),a,!0,v);else if(!o.isStaticRequest){let y=new URL(t.url),x=v.startsWith("//")?new URL(y.protocol+v):new URL(v),w=ad(x.pathname,a)!=null;x.origin===y.origin&&w&&(v=x.pathname+x.search+x.hash)}if(o.isStaticRequest)throw c.headers.set("Location",v),c;return{type:xr.redirect,status:f,location:v,revalidate:c.headers.get("X-Remix-Revalidate")!==null,reloadDocument:c.headers.get("X-Remix-Reload-Document")!==null}}if(o.isRouteRequest)throw{type:l===xr.error?xr.error:xr.data,response:c};let m,g=c.headers.get("Content-Type");return g&&/\bapplication\/json\b/.test(g)?m=await c.json():m=await c.text(),l===xr.error?{type:l,error:new WS(f,c.statusText,m),headers:c.headers}:{type:xr.data,data:m,statusCode:c.status,headers:c.headers}}if(l===xr.error)return{type:l,error:c};if(k9(c)){var d,p;return{type:xr.deferred,deferredData:c,statusCode:(d=c.init)==null?void 0:d.status,headers:((p=c.init)==null?void 0:p.headers)&&new Headers(c.init.headers)}}return{type:xr.data,data:c}}function kd(e,t,r,i){let n=e.createURL(bI(t)).toString(),s={signal:r};if(i&&gs(i.formMethod)){let{formMethod:a,formEncType:o}=i;s.method=a.toUpperCase(),o==="application/json"?(s.headers=new Headers({"Content-Type":o}),s.body=JSON.stringify(i.json)):o==="text/plain"?s.body=i.text:o==="application/x-www-form-urlencoded"&&i.formData?s.body=Wb(i.formData):s.body=i.formData}return new Request(n,s)}function Wb(e){let t=new URLSearchParams;for(let[r,i]of e.entries())t.append(r,typeof i=="string"?i:i.name);return t}function vM(e){let t=new FormData;for(let[r,i]of e.entries())t.append(r,i);return t}function B9(e,t,r,i,n){let s={},a=null,o,l=!1,c={};return r.forEach((u,h)=>{let d=t[h].route.id;if(yt(!pu(u),"Cannot handle redirect results in processLoaderData"),Hp(u)){let p=Yh(e,d),f=u.error;i&&(f=Object.values(i)[0],i=void 0),a=a||{},a[p.route.id]==null&&(a[p.route.id]=f),s[d]=void 0,l||(l=!0,o=vI(u.error)?u.error.status:500),u.headers&&(c[d]=u.headers)}else cc(u)?(n.set(d,u.deferredData),s[d]=u.deferredData.data):s[d]=u.data,u.statusCode!=null&&u.statusCode!==200&&!l&&(o=u.statusCode),u.headers&&(c[d]=u.headers)}),i&&(a=i,s[Object.keys(i)[0]]=void 0),{loaderData:s,errors:a,statusCode:o||200,loaderHeaders:c}}function yM(e,t,r,i,n,s,a,o){let{loaderData:l,errors:c}=B9(t,r,i,n,o);for(let u=0;u<s.length;u++){let{key:h,match:d,controller:p}=s[u];yt(a!==void 0&&a[u]!==void 0,"Did not find corresponding fetcher result");let f=a[u];if(!(p&&p.signal.aborted))if(Hp(f)){let m=Yh(e.matches,d==null?void 0:d.route.id);c&&c[m.route.id]||(c=rr({},c,{[m.route.id]:f.error})),e.fetchers.delete(h)}else if(pu(f))yt(!1,"Unhandled fetcher revalidation redirect");else if(cc(f))yt(!1,"Unhandled fetcher deferred data");else{let m=Ph(f.data);e.fetchers.set(h,m)}}return{loaderData:l,errors:c}}function xM(e,t,r,i){let n=rr({},t);for(let s of r){let a=s.route.id;if(t.hasOwnProperty(a)?t[a]!==void 0&&(n[a]=t[a]):e[a]!==void 0&&s.route.loader&&(n[a]=e[a]),i&&i.hasOwnProperty(a))break}return n}function Yh(e,t){return(t?e.slice(0,e.findIndex(i=>i.route.id===t)+1):[...e]).reverse().find(i=>i.route.hasErrorBoundary===!0)||e[0]}function wM(e){let t=e.find(r=>r.index||!r.path||r.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:t}],route:t}}function Nn(e,t){let{pathname:r,routeId:i,method:n,type:s}=t===void 0?{}:t,a="Unknown Server Error",o="Unknown @remix-run/router error";return e===400?(a="Bad Request",n&&r&&i?o="You made a "+n+' request to "'+r+'" but '+('did not provide a `loader` for route "'+i+'", ')+"so there is no way to handle the request.":s==="defer-action"?o="defer() is not supported in actions":s==="invalid-body"&&(o="Unable to encode submission body")):e===403?(a="Forbidden",o='Route "'+i+'" does not match URL "'+r+'"'):e===404?(a="Not Found",o='No route matches URL "'+r+'"'):e===405&&(a="Method Not Allowed",n&&r&&i?o="You made a "+n.toUpperCase()+' request to "'+r+'" but '+('did not provide an `action` for route "'+i+'", ')+"so there is no way to handle the request.":n&&(o='Invalid request method "'+n.toUpperCase()+'"')),new WS(e||500,a,new Error(o),!0)}function bM(e){for(let t=e.length-1;t>=0;t--){let r=e[t];if(pu(r))return{result:r,idx:t}}}function bI(e){let t=typeof e=="string"?go(e):e;return Dc(rr({},t,{hash:""}))}function z9(e,t){return e.pathname!==t.pathname||e.search!==t.search?!1:e.hash===""?t.hash!=="":e.hash===t.hash?!0:t.hash!==""}function cc(e){return e.type===xr.deferred}function Hp(e){return e.type===xr.error}function pu(e){return(e&&e.type)===xr.redirect}function k9(e){let t=e;return t&&typeof t=="object"&&typeof t.data=="object"&&typeof t.subscribe=="function"&&typeof t.cancel=="function"&&typeof t.resolveData=="function"}function N9(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.headers=="object"&&typeof e.body<"u"}function F9(e){return M9.has(e.toLowerCase())}function gs(e){return A9.has(e.toLowerCase())}async function _M(e,t,r,i,n,s){for(let a=0;a<r.length;a++){let o=r[a],l=t[a];if(!l)continue;let c=e.find(h=>h.route.id===l.route.id),u=c!=null&&!wI(c,l)&&(s&&s[l.route.id])!==void 0;if(cc(o)&&(n||u)){let h=i[a];yt(h,"Expected an AbortSignal for revalidating fetcher deferred result"),await _I(o,h,n).then(d=>{d&&(r[a]=d||r[a])})}}}async function _I(e,t,r){if(r===void 0&&(r=!1),!await e.deferredData.resolveData(t)){if(r)try{return{type:xr.data,data:e.deferredData.unwrappedData}}catch(n){return{type:xr.error,error:n}}return{type:xr.data,data:e.deferredData.data}}}function qS(e){return new URLSearchParams(e).getAll("index").some(t=>t==="")}function U9(e,t){let{route:r,pathname:i,params:n}=e;return{id:r.id,pathname:i,params:n,data:t[r.id],handle:r.handle}}function qb(e,t){let r=typeof t=="string"?go(t).search:t.search;if(e[e.length-1].route.index&&qS(r||""))return e[e.length-1];let i=Ey(e);return i[i.length-1]}function SM(e){let{formMethod:t,formAction:r,formEncType:i,text:n,formData:s,json:a}=e;if(!(!t||!r||!i)){if(n!=null)return{formMethod:t,formAction:r,formEncType:i,formData:void 0,json:void 0,text:n};if(s!=null)return{formMethod:t,formAction:r,formEncType:i,formData:s,json:void 0,text:void 0};if(a!==void 0)return{formMethod:t,formAction:r,formEncType:i,formData:void 0,json:a,text:void 0}}}function Um(e,t){return t?{state:"loading",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}:{state:"loading",location:e,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function j9(e,t){return{state:"submitting",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}}function Nd(e,t){return e?{state:"loading",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t," _hasFetcherDoneAnything ":!0}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t," _hasFetcherDoneAnything ":!0}}function V9(e,t){return{state:"submitting",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t?t.data:void 0," _hasFetcherDoneAnything ":!0}}function Ph(e){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e," _hasFetcherDoneAnything ":!0}}/**
 * React Router v6.15.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function a0(){return a0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},a0.apply(this,arguments)}const Ty=ne.createContext(null),XS=ne.createContext(null),Uc=ne.createContext(null),Py=ne.createContext(null),Pl=ne.createContext({outlet:null,matches:[],isDataRoute:!1}),SI=ne.createContext(null);function H9(e,t){let{relative:r}=t===void 0?{}:t;nm()||yt(!1);let{basename:i,navigator:n}=ne.useContext(Uc),{hash:s,pathname:a,search:o}=YS(e,{relative:r}),l=a;return i!=="/"&&(l=a==="/"?i:eo([i,a])),n.createHref({pathname:l,search:o,hash:s})}function nm(){return ne.useContext(Py)!=null}function jc(){return nm()||yt(!1),ne.useContext(Py).location}function AI(e){ne.useContext(Uc).static||ne.useLayoutEffect(e)}function G9(){let{isDataRoute:e}=ne.useContext(Pl);return e?nF():W9()}function W9(){nm()||yt(!1);let e=ne.useContext(Ty),{basename:t,navigator:r}=ne.useContext(Uc),{matches:i}=ne.useContext(Pl),{pathname:n}=jc(),s=JSON.stringify(Ey(i).map(l=>l.pathnameBase)),a=ne.useRef(!1);return AI(()=>{a.current=!0}),ne.useCallback(function(l,c){if(c===void 0&&(c={}),!a.current)return;if(typeof l=="number"){r.go(l);return}let u=GS(l,JSON.parse(s),n,c.relative==="path");e==null&&t!=="/"&&(u.pathname=u.pathname==="/"?t:eo([t,u.pathname])),(c.replace?r.replace:r.push)(u,c.state,c)},[t,r,s,n,e])}const q9=ne.createContext(null);function X9(e){let t=ne.useContext(Pl).outlet;return t&&ne.createElement(q9.Provider,{value:e},t)}function YS(e,t){let{relative:r}=t===void 0?{}:t,{matches:i}=ne.useContext(Pl),{pathname:n}=jc(),s=JSON.stringify(Ey(i).map(a=>a.pathnameBase));return ne.useMemo(()=>GS(e,JSON.parse(s),n,r==="path"),[e,s,n,r])}function Y9(e,t,r){nm()||yt(!1);let{navigator:i}=ne.useContext(Uc),{matches:n}=ne.useContext(Pl),s=n[n.length-1],a=s?s.params:{};s&&s.pathname;let o=s?s.pathnameBase:"/";s&&s.route;let l=jc(),c;if(t){var u;let m=typeof t=="string"?go(t):t;o==="/"||(u=m.pathname)!=null&&u.startsWith(o)||yt(!1),c=m}else c=l;let h=c.pathname||"/",d=o==="/"?h:h.slice(o.length)||"/",p=Xh(e,{pathname:d}),f=J9(p&&p.map(m=>Object.assign({},m,{params:Object.assign({},a,m.params),pathname:eo([o,i.encodeLocation?i.encodeLocation(m.pathname).pathname:m.pathname]),pathnameBase:m.pathnameBase==="/"?o:eo([o,i.encodeLocation?i.encodeLocation(m.pathnameBase).pathname:m.pathnameBase])})),n,r);return t&&f?ne.createElement(Py.Provider,{value:{location:a0({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:Pr.Pop}},f):f}function Q9(){let e=iF(),t=vI(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},s=null;return ne.createElement(ne.Fragment,null,ne.createElement("h2",null,"Unexpected Application Error!"),ne.createElement("h3",{style:{fontStyle:"italic"}},t),r?ne.createElement("pre",{style:n},r):null,s)}const K9=ne.createElement(Q9,null);class Z9 extends ne.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error||r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error?ne.createElement(Pl.Provider,{value:this.props.routeContext},ne.createElement(SI.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function $9(e){let{routeContext:t,match:r,children:i}=e,n=ne.useContext(Ty);return n&&n.static&&n.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=r.route.id),ne.createElement(Pl.Provider,{value:t},i)}function J9(e,t,r){var i;if(t===void 0&&(t=[]),r===void 0&&(r=null),e==null){var n;if((n=r)!=null&&n.errors)e=r.matches;else return null}let s=e,a=(i=r)==null?void 0:i.errors;if(a!=null){let o=s.findIndex(l=>l.route.id&&(a==null?void 0:a[l.route.id]));o>=0||yt(!1),s=s.slice(0,Math.min(s.length,o+1))}return s.reduceRight((o,l,c)=>{let u=l.route.id?a==null?void 0:a[l.route.id]:null,h=null;r&&(h=l.route.errorElement||K9);let d=t.concat(s.slice(0,c+1)),p=()=>{let f;return u?f=h:l.route.Component?f=ne.createElement(l.route.Component,null):l.route.element?f=l.route.element:f=o,ne.createElement($9,{match:l,routeContext:{outlet:o,matches:d,isDataRoute:r!=null},children:f})};return r&&(l.route.ErrorBoundary||l.route.errorElement||c===0)?ne.createElement(Z9,{location:r.location,revalidation:r.revalidation,component:h,error:u,children:p(),routeContext:{outlet:null,matches:d,isDataRoute:!0}}):p()},null)}var CI=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(CI||{}),o0=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(o0||{});function eF(e){let t=ne.useContext(Ty);return t||yt(!1),t}function tF(e){let t=ne.useContext(XS);return t||yt(!1),t}function rF(e){let t=ne.useContext(Pl);return t||yt(!1),t}function MI(e){let t=rF(),r=t.matches[t.matches.length-1];return r.route.id||yt(!1),r.route.id}function iF(){var e;let t=ne.useContext(SI),r=tF(o0.UseRouteError),i=MI(o0.UseRouteError);return t||((e=r.errors)==null?void 0:e[i])}function nF(){let{router:e}=eF(CI.UseNavigateStable),t=MI(o0.UseNavigateStable),r=ne.useRef(!1);return AI(()=>{r.current=!0}),ne.useCallback(function(n,s){s===void 0&&(s={}),r.current&&(typeof n=="number"?e.navigate(n):e.navigate(n,a0({fromRouteId:t},s)))},[e,t])}const sF="startTransition",AM=H8[sF];function aF(e){let{fallbackElement:t,router:r,future:i}=e,[n,s]=ne.useState(r.state),{v7_startTransition:a}=i||{},o=ne.useCallback(h=>{a&&AM?AM(()=>s(h)):s(h)},[s,a]);ne.useLayoutEffect(()=>r.subscribe(o),[r,o]);let l=ne.useMemo(()=>({createHref:r.createHref,encodeLocation:r.encodeLocation,go:h=>r.navigate(h),push:(h,d,p)=>r.navigate(h,{state:d,preventScrollReset:p==null?void 0:p.preventScrollReset}),replace:(h,d,p)=>r.navigate(h,{replace:!0,state:d,preventScrollReset:p==null?void 0:p.preventScrollReset})}),[r]),c=r.basename||"/",u=ne.useMemo(()=>({router:r,navigator:l,static:!1,basename:c}),[r,l,c]);return ne.createElement(ne.Fragment,null,ne.createElement(Ty.Provider,{value:u},ne.createElement(XS.Provider,{value:n},ne.createElement(cF,{basename:c,location:n.location,navigationType:n.historyAction,navigator:l},n.initialized?ne.createElement(oF,{routes:r.routes,state:n}):t))),null)}function oF(e){let{routes:t,state:r}=e;return Y9(t,void 0,r)}function lF(e){return X9(e.context)}function Ro(e){yt(!1)}function cF(e){let{basename:t="/",children:r=null,location:i,navigationType:n=Pr.Pop,navigator:s,static:a=!1}=e;nm()&&yt(!1);let o=t.replace(/^\/*/,"/"),l=ne.useMemo(()=>({basename:o,navigator:s,static:a}),[o,s,a]);typeof i=="string"&&(i=go(i));let{pathname:c="/",search:u="",hash:h="",state:d=null,key:p="default"}=i,f=ne.useMemo(()=>{let m=ad(c,o);return m==null?null:{location:{pathname:m,search:u,hash:h,state:d,key:p},navigationType:n}},[o,c,u,h,d,p,n]);return f==null?null:ne.createElement(Uc.Provider,{value:l},ne.createElement(Py.Provider,{children:r,value:f}))}new Promise(()=>{});function Xb(e,t){t===void 0&&(t=[]);let r=[];return ne.Children.forEach(e,(i,n)=>{if(!ne.isValidElement(i))return;let s=[...t,n];if(i.type===ne.Fragment){r.push.apply(r,Xb(i.props.children,s));return}i.type!==Ro&&yt(!1),!i.props.index||!i.props.children||yt(!1);let a={id:i.props.id||s.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(a.children=Xb(i.props.children,s)),r.push(a)}),r}function hF(e){let t={hasErrorBoundary:e.ErrorBoundary!=null||e.errorElement!=null};return e.Component&&Object.assign(t,{element:ne.createElement(e.Component),Component:void 0}),e.ErrorBoundary&&Object.assign(t,{errorElement:ne.createElement(e.ErrorBoundary),ErrorBoundary:void 0}),t}/**
 * React Router DOM v6.15.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Fu(){return Fu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},Fu.apply(this,arguments)}function EI(e,t){if(e==null)return{};var r={},i=Object.keys(e),n,s;for(s=0;s<i.length;s++)n=i[s],!(t.indexOf(n)>=0)&&(r[n]=e[n]);return r}function uF(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function dF(e,t){return e.button===0&&(!t||t==="_self")&&!uF(e)}const pF=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"],fF=["aria-current","caseSensitive","className","end","style","to","children"];function mF(e,t){return L9({basename:t==null?void 0:t.basename,future:Fu({},t==null?void 0:t.future,{v7_prependBasename:!0}),history:e9({window:t==null?void 0:t.window}),hydrationData:(t==null?void 0:t.hydrationData)||gF(),routes:e,mapRouteProperties:hF}).initialize()}function gF(){var e;let t=(e=window)==null?void 0:e.__staticRouterHydrationData;return t&&t.errors&&(t=Fu({},t,{errors:vF(t.errors)})),t}function vF(e){if(!e)return null;let t=Object.entries(e),r={};for(let[i,n]of t)if(n&&n.__type==="RouteErrorResponse")r[i]=new WS(n.status,n.statusText,n.data,n.internal===!0);else if(n&&n.__type==="Error"){if(n.__subType){let s=window[n.__subType];if(typeof s=="function")try{let a=new s(n.message);a.stack="",r[i]=a}catch{}}if(r[i]==null){let s=new Error(n.message);s.stack="",r[i]=s}}else r[i]=n;return r}const yF=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",xF=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Sp=ne.forwardRef(function(t,r){let{onClick:i,relative:n,reloadDocument:s,replace:a,state:o,target:l,to:c,preventScrollReset:u}=t,h=EI(t,pF),{basename:d}=ne.useContext(Uc),p,f=!1;if(typeof c=="string"&&xF.test(c)&&(p=c,yF))try{let y=new URL(window.location.href),x=c.startsWith("//")?new URL(y.protocol+c):new URL(c),w=ad(x.pathname,d);x.origin===y.origin&&w!=null?c=w+x.search+x.hash:f=!0}catch{}let m=H9(c,{relative:n}),g=wF(c,{replace:a,state:o,target:l,preventScrollReset:u,relative:n});function v(y){i&&i(y),y.defaultPrevented||g(y)}return ne.createElement("a",Fu({},h,{href:p||m,onClick:f||s?i:v,ref:r,target:l}))}),ys=ne.forwardRef(function(t,r){let{"aria-current":i="page",caseSensitive:n=!1,className:s="",end:a=!1,style:o,to:l,children:c}=t,u=EI(t,fF),h=YS(l,{relative:u.relative}),d=jc(),p=ne.useContext(XS),{navigator:f}=ne.useContext(Uc),m=f.encodeLocation?f.encodeLocation(h).pathname:h.pathname,g=d.pathname,v=p&&p.navigation&&p.navigation.location?p.navigation.location.pathname:null;n||(g=g.toLowerCase(),v=v?v.toLowerCase():null,m=m.toLowerCase());let y=g===m||!a&&g.startsWith(m)&&g.charAt(m.length)==="/",x=v!=null&&(v===m||!a&&v.startsWith(m)&&v.charAt(m.length)==="/"),w=y?i:void 0,b;typeof s=="function"?b=s({isActive:y,isPending:x}):b=[s,y?"active":null,x?"pending":null].filter(Boolean).join(" ");let _=typeof o=="function"?o({isActive:y,isPending:x}):o;return ne.createElement(Sp,Fu({},u,{"aria-current":w,className:b,ref:r,style:_,to:l}),typeof c=="function"?c({isActive:y,isPending:x}):c)});var CM;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher"})(CM||(CM={}));var MM;(function(e){e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(MM||(MM={}));function wF(e,t){let{target:r,replace:i,state:n,preventScrollReset:s,relative:a}=t===void 0?{}:t,o=G9(),l=jc(),c=YS(e,{relative:a});return ne.useCallback(u=>{if(dF(u,r)){u.preventDefault();let h=i!==void 0?i:Dc(l)===Dc(c);o(e,{replace:h,state:n,preventScrollReset:s,relative:a})}},[l,o,c,i,n,r,e,s,a])}const xs=({variant:e="default",size:t="sm",backgroundColor:r="primary-300",borderColor:i="primary-300",textColor:n="white",children:s,...a})=>{const{className:o}=a,l={variant:{default:"bg-primary-300 text-background-dark ring-1 ring-primary-300",outline:"bg-transparent text-primary-300 ring-1 ring-primary-300 hover:bg-primary-300/10",underline:""},size:{xs:"text-xs py-[0.4375rem] px-[.875rem]",sm:"text-sm py-[0.5rem] px-[1rem]",md:"text-md py-[0.6875rem] px-[1.375rem]",lg:"text-lg py-[1.1875rem] px-[2.375rem]",xl:"text-xl py-[1.594rem] px-[3.188rem]"},default:"rounded-full cursor-pointer transition-all hover:brightness-110 active:brightness-90"};return L.jsx("button",{className:`${l.variant[e]} ${l.size[t]} ${l.default} ${o||""}`,children:s})},bF=()=>{const e=ne.useRef(null),t=ne.useRef(null),[r,i]=ne.useState(!1);return ne.useEffect(()=>{window.innerWidth>640?i(!1):i(!0);const n=()=>{window.innerWidth>640?i(!1):i(!0)};return window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[]),ne.useEffect(()=>{const n=()=>{const s=document.querySelector(".navTrigger"),a=e.current,o=t.current;if(!a&&!o)return;const l=a.getBoundingClientRect(),c=s.getBoundingClientRect();if(l.bottom>=Math.floor(c.top)){if(a.classList.add("bg-background-dark"),!o)return;o.classList.add("max-w-[50rem]")}else{if(a.classList.remove("bg-background-dark"),!o)return;o.classList.remove("max-w-[50rem]")}};window.addEventListener("scroll",()=>{n()}),n()},[]),r?L.jsx(SF,{nav:e}):L.jsx(_F,{nav:e,cta:t})},_F=({nav:e,cta:t})=>L.jsxs("div",{ref:e,className:"fixed top-0 left-0 z-50 flex items-center justify-between w-full h-16 px-6 text-xs text-white",children:[L.jsx("img",{src:"./images/logo-1.png",className:"h-3/4",alt:""}),L.jsxs("div",{className:"flex items-center gap-8",children:[L.jsx(ys,{className:({isActive:r})=>r?"text-primary-300":"text-white transition-all hover:text-primary-300 active:brightness-90",to:"/dmrs-fe/",children:"Home"}),L.jsx(ys,{className:({isActive:r})=>r?"text-primary-300":"text-white transition-all hover:text-primary-300 active:brightness-90",to:"dmrs/australia",children:"DMRS Australia"}),L.jsx(ys,{className:({isActive:r})=>r?"text-primary-300":"text-white transition-all hover:text-primary-300 active:brightness-90",to:"dmrs/thailand",children:"DMRS Thailand"}),L.jsx(ys,{className:({isActive:r})=>r?"text-primary-300":"text-white transition-all hover:text-primary-300 active:brightness-90",to:"dmrs/vpn",children:"DMRS VPN"}),L.jsx(ys,{ref:t,to:"./contact",className:"overflow-hidden transition-all duration-1000 max-w-0 whitespace-nowrap",children:L.jsx(xs,{size:"xs",className:"m-1",children:"Get Started"})})]})]}),SF=({nav:e})=>L.jsxs("div",{ref:e,className:"fixed top-0 left-0 z-50 flex items-center justify-between w-full h-16 px-6 text-sm text-white bg-background-dark",children:[L.jsx("img",{src:"./images/logo-1.png",className:"h-3/4",alt:""}),L.jsx("button",{className:"text-lg",children:"="})]}),fu=({id:e="",name:t="",label:r="",value:i="",placeholder:n="",className:s="",onInput:a})=>L.jsxs("div",{className:"flex flex-col gap-1",children:[L.jsx("label",{className:"text-xs",htmlFor:e,children:r}),L.jsx("input",{type:"text",id:e,name:t,value:i,placeholder:n,onInput:a,className:`px-3 py-2 text-sm bg-transparent rounded-full ring-1 ring-white focus:outline-none placeholder:text-xs ${s}`})]}),AF=()=>{const e=jc(),[t,r]=ne.useState({name:"",email:"",message:""}),i=e.pathname,n=a=>{a.preventDefault()};console.log(i);const s=a=>{const o=a.target.name;r(l=>({...l,[o]:a.target.value}))};return L.jsxs("div",{className:"flex flex-col-reverse text-white min-h-[calc(100vh-3.9rem)] bg-background-dark p-5 py-10 gap-10 z-[40] overflow-hidden laptop:flex-row",children:[L.jsxs("div",{className:"flex flex-col flex-1 gap-8",children:[L.jsx("div",{className:"items-center hidden w-1/2 laptop:flex",children:L.jsx("img",{src:"./images/logo-1.png",alt:""})}),L.jsxs("div",{className:"flex flex-col h-full gap-2",children:[L.jsx("p",{className:"text-xs text-accent-400 laptop:text-sm",children:"Navigation"}),L.jsx(ys,{className:({isActive:a})=>a?"text-primary-300 text-sm laptop:text-base":"text-white transition-all duration-500 hover:text-primary-300 active:brightness-90 text-sm laptop:text-base hover:bg-white/20 w-full hover:px-3",to:"/dmrs-fe/",children:"Home"}),L.jsx(ys,{className:({isActive:a})=>a?"text-primary-300 text-sm laptop:text-base":"text-white transition-all duration-500 hover:text-primary-300 active:brightness-90 text-sm laptop:text-base hover:bg-white/20 w-full hover:px-3",to:"dmrs/thailand",children:"DMRS Thailand"}),L.jsx(ys,{className:({isActive:a})=>a?"text-primary-300 text-sm laptop:text-base":"text-white transition-all duration-500 hover:text-primary-300 active:brightness-90 text-sm laptop:text-base hover:bg-white/20 w-full hover:px-3",to:"dmrs/australia",children:"DMRS Australia"}),L.jsx(ys,{className:({isActive:a})=>a?"text-primary-300 text-sm laptop:text-base":"text-white transition-all duration-500 hover:text-primary-300 active:brightness-90 text-sm laptop:text-base hover:bg-white/20 w-full hover:px-3",to:"dmrs/vpn",children:"DMRS VPN"})]}),L.jsxs("div",{className:"flex items-end justify-between mt-10 text-xs whitespace-nowrap",children:[L.jsxs("div",{className:"flex flex-col gap-1",children:[L.jsx(ys,{className:({isActive:a})=>a?"text-primary-300":"text-white transition-all hover:text-primary-300 active:brightness-90",to:"dmrs/policy",children:"Privacy Policy"}),L.jsx("p",{className:"hidden",children:"|"}),L.jsx(ys,{className:({isActive:a})=>a?"text-primary-300":"text-white transition-all hover:text-primary-300 active:brightness-90",to:"dmrs/terms",children:"Terms & Conditions"})]}),L.jsx("p",{children:"c 2021 Yourintell.com"})]})]}),i!="/dmrs-fe/contact"?L.jsxs(L.Fragment,{children:[L.jsx("div",{className:"min-w-[1px] w-[1px] bg-white min-h-full"}),L.jsxs("div",{className:"flex flex-col flex-1 gap-8",children:[L.jsx("div",{className:"flex items-center justify-center w-1/2 laptop:hidden",children:L.jsx("img",{src:"./images/logo-1.png",alt:""})}),L.jsx("h2",{className:"text-2xl text-left text-accent-500",children:"CONTACT US"}),L.jsxs("form",{action:"#",className:"flex flex-col gap-8",onSubmit:n,children:[L.jsx(fu,{label:"Name",name:"name",placeholder:"Enter your name",onInput:s,value:t.name}),L.jsx(fu,{label:"Email Address",name:"email",placeholder:"Enter your email address",onInput:s,value:t.email}),L.jsx(fu,{label:"Message",name:"message",placeholder:"Leave us a message!",onInput:s,value:t.message}),L.jsx(xs,{size:"sm",variant:"outline",children:L.jsx("a",{href:"mailto:test@gmail.com",children:"Send us a message!"})})]})]})]}):L.jsx(L.Fragment,{})]})},CF=({children:e})=>{const t=jc();return ne.useEffect(()=>{window.scrollTo(0,0)},[t]),L.jsx(L.Fragment,{children:e})};function MF(){return L.jsx(CF,{children:L.jsxs("div",{className:"flex flex-col min-h-screen font-poppins",children:[L.jsx(bF,{}),L.jsx(lF,{}),L.jsx(AF,{})]})})}const QS=({children:e})=>L.jsxs("div",{className:"relative flex w-full pt-16 overflow-hidden bg-background-dark h-[90vh]",children:[L.jsx("div",{className:"absolute top-[-150%] left-[-60%] opacity-20 z-10 bg-gradient-radial from-primary-500 via-background-dark to-background-dark h-[300%] aspect-square rounded-full"}),L.jsx("div",{className:"absolute bottom-[-150%] right-[-60%] opacity-10 z-10 bg-gradient-radial from-accent-400 via-background-dark to-background-dark h-[300%] aspect-square rounded-full"}),L.jsx(L.Fragment,{children:e})]}),V1=({children:e})=>L.jsx("div",{className:"h-fit laptop:h-[calc(100vh-4rem)]",children:e}),EF=()=>{const e=["Intelligent Intelligence","Meaningful Investigations","Thoughtful Research"];ne.useState(e.length-1),ne.useRef(null);const[t,r]=ne.useState(0),i=ne.useRef(null);ne.useEffect(()=>(n(),i.current=setTimeout(()=>{r(s=>s===e.length-1?0:s+1)},2500),()=>{}),[t]);function n(){i.current&&clearTimeout(i.current)}return L.jsx("div",{className:"flex flex-col overflow-hidden transition-all max-h-[2.353rem] w-fit",children:L.jsx("div",{className:"whitespace-nowrap flex transition-all duration-1000 ease-in-out flex-col items-center z-10",style:{transform:`translateY(${-t*2.353}rem)`},children:e.map((s,a)=>L.jsx("p",{className:"text-md",children:s},a))})})};var TI={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},EM=Yn.createContext&&Yn.createContext(TI),hl=globalThis&&globalThis.__assign||function(){return hl=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},hl.apply(this,arguments)},TF=globalThis&&globalThis.__rest||function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r};function PI(e){return e&&e.map(function(t,r){return Yn.createElement(t.tag,hl({key:r},t.attr),PI(t.child))})}function KS(e){return function(t){return Yn.createElement(PF,hl({attr:hl({},e.attr)},t),PI(e.child))}}function PF(e){var t=function(r){var i=e.attr,n=e.size,s=e.title,a=TF(e,["attr","size","title"]),o=n||r.size||"1em",l;return r.className&&(l=r.className),e.className&&(l=(l?l+" ":"")+e.className),Yn.createElement("svg",hl({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,i,a,{className:l,style:hl(hl({color:e.color||r.color},r.style),e.style),height:o,width:o,xmlns:"http://www.w3.org/2000/svg"}),s&&Yn.createElement("title",null,s),e.children)};return EM!==void 0?Yn.createElement(EM.Consumer,null,function(r){return t(r)}):t(TI)}function DI(e){return KS({tag:"svg",attr:{viewBox:"0 0 32 32"},child:[{tag:"path",attr:{d:"M 16 3 C 8.832031 3 3 8.832031 3 16 C 3 23.167969 8.832031 29 16 29 C 23.167969 29 29 23.167969 29 16 C 29 8.832031 23.167969 3 16 3 Z M 16 5 C 22.085938 5 27 9.914063 27 16 C 27 22.085938 22.085938 27 16 27 C 9.914063 27 5 22.085938 5 16 C 5 9.914063 9.914063 5 16 5 Z M 16.71875 9.59375 L 15.28125 11 L 19.28125 15 L 9 15 L 9 17 L 19.28125 17 L 15.28125 21 L 16.71875 22.40625 L 23.125 16 Z"}}]})(e)}const LI=ne.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),Dy=ne.createContext({}),ZS=ne.createContext(null),Ly=typeof document<"u",II=Ly?ne.useLayoutEffect:ne.useEffect,OI=ne.createContext({strict:!1});function DF(e,t,r,i){const{visualElement:n}=ne.useContext(Dy),s=ne.useContext(OI),a=ne.useContext(ZS),o=ne.useContext(LI).reducedMotion,l=ne.useRef();i=i||s.renderer,!l.current&&i&&(l.current=i(e,{visualState:t,parent:n,props:r,presenceContext:a,blockInitialAnimation:a?a.initial===!1:!1,reducedMotionConfig:o}));const c=l.current;ne.useInsertionEffect(()=>{c&&c.update(r,a)});const u=ne.useRef(!!window.HandoffAppearAnimations);return II(()=>{c&&(c.render(),u.current&&c.animationState&&c.animationState.animateChanges())}),ne.useEffect(()=>{c&&(c.updateFeatures(),!u.current&&c.animationState&&c.animationState.animateChanges(),window.HandoffAppearAnimations=void 0,u.current=!1)}),c}function Qh(e){return typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function LF(e,t,r){return ne.useCallback(i=>{i&&e.mount&&e.mount(i),t&&(i?t.mount(i):t.unmount()),r&&(typeof r=="function"?r(i):Qh(r)&&(r.current=i))},[t])}function Lf(e){return typeof e=="string"||Array.isArray(e)}function Iy(e){return typeof e=="object"&&typeof e.start=="function"}const $S=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],JS=["initial",...$S];function Oy(e){return Iy(e.animate)||JS.some(t=>Lf(e[t]))}function RI(e){return!!(Oy(e)||e.variants)}function IF(e,t){if(Oy(e)){const{initial:r,animate:i}=e;return{initial:r===!1||Lf(r)?r:void 0,animate:Lf(i)?i:void 0}}return e.inherit!==!1?t:{}}function OF(e){const{initial:t,animate:r}=IF(e,ne.useContext(Dy));return ne.useMemo(()=>({initial:t,animate:r}),[TM(t),TM(r)])}function TM(e){return Array.isArray(e)?e.join(" "):e}const PM={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},If={};for(const e in PM)If[e]={isEnabled:t=>PM[e].some(r=>!!t[r])};function RF(e){for(const t in e)If[t]={...If[t],...e[t]}}const BI=ne.createContext({}),zI=ne.createContext({}),BF=Symbol.for("motionComponentSymbol");function zF({preloadedFeatures:e,createVisualElement:t,useRender:r,useVisualState:i,Component:n}){e&&RF(e);function s(o,l){let c;const u={...ne.useContext(LI),...o,layoutId:kF(o)},{isStatic:h}=u,d=OF(o),p=i(o,h);if(!h&&Ly){d.visualElement=DF(n,p,u,t);const f=ne.useContext(zI),m=ne.useContext(OI).strict;d.visualElement&&(c=d.visualElement.loadFeatures(u,m,e,f))}return ne.createElement(Dy.Provider,{value:d},c&&d.visualElement?ne.createElement(c,{visualElement:d.visualElement,...u}):null,r(n,o,LF(p,d.visualElement,l),p,h,d.visualElement))}const a=ne.forwardRef(s);return a[BF]=n,a}function kF({layoutId:e}){const t=ne.useContext(BI).id;return t&&e!==void 0?t+"-"+e:e}function NF(e){function t(i,n={}){return zF(e(i,n))}if(typeof Proxy>"u")return t;const r=new Map;return new Proxy(t,{get:(i,n)=>(r.has(n)||r.set(n,t(n)),r.get(n))})}const FF=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function e3(e){return typeof e!="string"||e.includes("-")?!1:!!(FF.indexOf(e)>-1||/[A-Z]/.test(e))}const l0={};function UF(e){Object.assign(l0,e)}const sm=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Vc=new Set(sm);function kI(e,{layout:t,layoutId:r}){return Vc.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!l0[e]||e==="opacity")}const sn=e=>!!(e&&e.getVelocity),jF={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},VF=sm.length;function HF(e,{enableHardwareAcceleration:t=!0,allowTransformNone:r=!0},i,n){let s="";for(let a=0;a<VF;a++){const o=sm[a];if(e[o]!==void 0){const l=jF[o]||o;s+=`${l}(${e[o]}) `}}return t&&!e.z&&(s+="translateZ(0)"),s=s.trim(),n?s=n(e,i?"":s):r&&i&&(s="none"),s}const NI=e=>t=>typeof t=="string"&&t.startsWith(e),FI=NI("--"),Yb=NI("var(--"),GF=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,WF=(e,t)=>t&&typeof e=="number"?t.transform(e):e,bl=(e,t,r)=>Math.min(Math.max(r,e),t),Hc={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Gp={...Hc,transform:e=>bl(0,1,e)},jm={...Hc,default:1},Wp=e=>Math.round(e*1e5)/1e5,Ry=/(-)?([\d]*\.?[\d])+/g,UI=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,qF=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function am(e){return typeof e=="string"}const om=e=>({test:t=>am(t)&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Bo=om("deg"),ha=om("%"),at=om("px"),XF=om("vh"),YF=om("vw"),DM={...ha,parse:e=>ha.parse(e)/100,transform:e=>ha.transform(e*100)},LM={...Hc,transform:Math.round},jI={borderWidth:at,borderTopWidth:at,borderRightWidth:at,borderBottomWidth:at,borderLeftWidth:at,borderRadius:at,radius:at,borderTopLeftRadius:at,borderTopRightRadius:at,borderBottomRightRadius:at,borderBottomLeftRadius:at,width:at,maxWidth:at,height:at,maxHeight:at,size:at,top:at,right:at,bottom:at,left:at,padding:at,paddingTop:at,paddingRight:at,paddingBottom:at,paddingLeft:at,margin:at,marginTop:at,marginRight:at,marginBottom:at,marginLeft:at,rotate:Bo,rotateX:Bo,rotateY:Bo,rotateZ:Bo,scale:jm,scaleX:jm,scaleY:jm,scaleZ:jm,skew:Bo,skewX:Bo,skewY:Bo,distance:at,translateX:at,translateY:at,translateZ:at,x:at,y:at,z:at,perspective:at,transformPerspective:at,opacity:Gp,originX:DM,originY:DM,originZ:at,zIndex:LM,fillOpacity:Gp,strokeOpacity:Gp,numOctaves:LM};function t3(e,t,r,i){const{style:n,vars:s,transform:a,transformOrigin:o}=e;let l=!1,c=!1,u=!0;for(const h in t){const d=t[h];if(FI(h)){s[h]=d;continue}const p=jI[h],f=WF(d,p);if(Vc.has(h)){if(l=!0,a[h]=f,!u)continue;d!==(p.default||0)&&(u=!1)}else h.startsWith("origin")?(c=!0,o[h]=f):n[h]=f}if(t.transform||(l||i?n.transform=HF(e.transform,r,u,i):n.transform&&(n.transform="none")),c){const{originX:h="50%",originY:d="50%",originZ:p=0}=o;n.transformOrigin=`${h} ${d} ${p}`}}const r3=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function VI(e,t,r){for(const i in t)!sn(t[i])&&!kI(i,r)&&(e[i]=t[i])}function QF({transformTemplate:e},t,r){return ne.useMemo(()=>{const i=r3();return t3(i,t,{enableHardwareAcceleration:!r},e),Object.assign({},i.vars,i.style)},[t])}function KF(e,t,r){const i=e.style||{},n={};return VI(n,i,e),Object.assign(n,QF(e,t,r)),e.transformValues?e.transformValues(n):n}function ZF(e,t,r){const i={},n=KF(e,t,r);return e.drag&&e.dragListener!==!1&&(i.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(i.tabIndex=0),i.style=n,i}const $F=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onLayoutAnimationStart","onLayoutAnimationComplete","onLayoutMeasure","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","ignoreStrict","viewport"]);function c0(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||$F.has(e)}let HI=e=>!c0(e);function JF(e){e&&(HI=t=>t.startsWith("on")?!c0(t):e(t))}try{JF(require("@emotion/is-prop-valid").default)}catch{}function eU(e,t,r){const i={};for(const n in e)n==="values"&&typeof e.values=="object"||(HI(n)||r===!0&&c0(n)||!t&&!c0(n)||e.draggable&&n.startsWith("onDrag"))&&(i[n]=e[n]);return i}function IM(e,t,r){return typeof e=="string"?e:at.transform(t+r*e)}function tU(e,t,r){const i=IM(t,e.x,e.width),n=IM(r,e.y,e.height);return`${i} ${n}`}const rU={offset:"stroke-dashoffset",array:"stroke-dasharray"},iU={offset:"strokeDashoffset",array:"strokeDasharray"};function nU(e,t,r=1,i=0,n=!0){e.pathLength=1;const s=n?rU:iU;e[s.offset]=at.transform(-i);const a=at.transform(t),o=at.transform(r);e[s.array]=`${a} ${o}`}function i3(e,{attrX:t,attrY:r,attrScale:i,originX:n,originY:s,pathLength:a,pathSpacing:o=1,pathOffset:l=0,...c},u,h,d){if(t3(e,c,u,d),h){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:p,style:f,dimensions:m}=e;p.transform&&(m&&(f.transform=p.transform),delete p.transform),m&&(n!==void 0||s!==void 0||f.transform)&&(f.transformOrigin=tU(m,n!==void 0?n:.5,s!==void 0?s:.5)),t!==void 0&&(p.x=t),r!==void 0&&(p.y=r),i!==void 0&&(p.scale=i),a!==void 0&&nU(p,a,o,l,!1)}const GI=()=>({...r3(),attrs:{}}),n3=e=>typeof e=="string"&&e.toLowerCase()==="svg";function sU(e,t,r,i){const n=ne.useMemo(()=>{const s=GI();return i3(s,t,{enableHardwareAcceleration:!1},n3(i),e.transformTemplate),{...s.attrs,style:{...s.style}}},[t]);if(e.style){const s={};VI(s,e.style,e),n.style={...s,...n.style}}return n}function aU(e=!1){return(r,i,n,{latestValues:s},a)=>{const l=(e3(r)?sU:ZF)(i,s,a,r),u={...eU(i,typeof r=="string",e),...l,ref:n},{children:h}=i,d=ne.useMemo(()=>sn(h)?h.get():h,[h]);return ne.createElement(r,{...u,children:d})}}const s3=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();function WI(e,{style:t,vars:r},i,n){Object.assign(e.style,t,n&&n.getProjectionStyles(i));for(const s in r)e.style.setProperty(s,r[s])}const qI=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function XI(e,t,r,i){WI(e,t,void 0,i);for(const n in t.attrs)e.setAttribute(qI.has(n)?n:s3(n),t.attrs[n])}function a3(e,t){const{style:r}=e,i={};for(const n in r)(sn(r[n])||t.style&&sn(t.style[n])||kI(n,e))&&(i[n]=r[n]);return i}function YI(e,t){const r=a3(e,t);for(const i in e)if(sn(e[i])||sn(t[i])){const n=sm.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[n]=e[i]}return r}function o3(e,t,r,i={},n={}){return typeof t=="function"&&(t=t(r!==void 0?r:e.custom,i,n)),typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"&&(t=t(r!==void 0?r:e.custom,i,n)),t}function QI(e){const t=ne.useRef(null);return t.current===null&&(t.current=e()),t.current}const h0=e=>Array.isArray(e),oU=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),lU=e=>h0(e)?e[e.length-1]||0:e;function bv(e){const t=sn(e)?e.get():e;return oU(t)?t.toValue():t}function cU({scrapeMotionValuesFromProps:e,createRenderState:t,onMount:r},i,n,s){const a={latestValues:hU(i,n,s,e),renderState:t()};return r&&(a.mount=o=>r(i,o,a)),a}const KI=e=>(t,r)=>{const i=ne.useContext(Dy),n=ne.useContext(ZS),s=()=>cU(e,t,i,n);return r?s():QI(s)};function hU(e,t,r,i){const n={},s=i(e,{});for(const d in s)n[d]=bv(s[d]);let{initial:a,animate:o}=e;const l=Oy(e),c=RI(e);t&&c&&!l&&e.inherit!==!1&&(a===void 0&&(a=t.initial),o===void 0&&(o=t.animate));let u=r?r.initial===!1:!1;u=u||a===!1;const h=u?o:a;return h&&typeof h!="boolean"&&!Iy(h)&&(Array.isArray(h)?h:[h]).forEach(p=>{const f=o3(e,p);if(!f)return;const{transitionEnd:m,transition:g,...v}=f;for(const y in v){let x=v[y];if(Array.isArray(x)){const w=u?x.length-1:0;x=x[w]}x!==null&&(n[y]=x)}for(const y in m)n[y]=m[y]}),n}const pr=e=>e;class OM{constructor(){this.order=[],this.scheduled=new Set}add(t){if(!this.scheduled.has(t))return this.scheduled.add(t),this.order.push(t),!0}remove(t){const r=this.order.indexOf(t);r!==-1&&(this.order.splice(r,1),this.scheduled.delete(t))}clear(){this.order.length=0,this.scheduled.clear()}}function uU(e){let t=new OM,r=new OM,i=0,n=!1,s=!1;const a=new WeakSet,o={schedule:(l,c=!1,u=!1)=>{const h=u&&n,d=h?t:r;return c&&a.add(l),d.add(l)&&h&&n&&(i=t.order.length),l},cancel:l=>{r.remove(l),a.delete(l)},process:l=>{if(n){s=!0;return}if(n=!0,[t,r]=[r,t],r.clear(),i=t.order.length,i)for(let c=0;c<i;c++){const u=t.order[c];u(l),a.has(u)&&(o.schedule(u),e())}n=!1,s&&(s=!1,o.process(l))}};return o}const Vm=["prepare","read","update","preRender","render","postRender"],dU=40;function pU(e,t){let r=!1,i=!0;const n={delta:0,timestamp:0,isProcessing:!1},s=Vm.reduce((h,d)=>(h[d]=uU(()=>r=!0),h),{}),a=h=>s[h].process(n),o=()=>{const h=performance.now();r=!1,n.delta=i?1e3/60:Math.max(Math.min(h-n.timestamp,dU),1),n.timestamp=h,n.isProcessing=!0,Vm.forEach(a),n.isProcessing=!1,r&&t&&(i=!1,e(o))},l=()=>{r=!0,i=!0,n.isProcessing||e(o)};return{schedule:Vm.reduce((h,d)=>{const p=s[d];return h[d]=(f,m=!1,g=!1)=>(r||l(),p.schedule(f,m,g)),h},{}),cancel:h=>Vm.forEach(d=>s[d].cancel(h)),state:n,steps:s}}const{schedule:Ft,cancel:pa,state:kr,steps:H1}=pU(typeof requestAnimationFrame<"u"?requestAnimationFrame:pr,!0),fU={useVisualState:KI({scrapeMotionValuesFromProps:YI,createRenderState:GI,onMount:(e,t,{renderState:r,latestValues:i})=>{Ft.read(()=>{try{r.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{r.dimensions={x:0,y:0,width:0,height:0}}}),Ft.render(()=>{i3(r,i,{enableHardwareAcceleration:!1},n3(t.tagName),e.transformTemplate),XI(t,r)})}})},mU={useVisualState:KI({scrapeMotionValuesFromProps:a3,createRenderState:r3})};function gU(e,{forwardMotionProps:t=!1},r,i){return{...e3(e)?fU:mU,preloadedFeatures:r,useRender:aU(t),createVisualElement:i,Component:e}}function Ka(e,t,r,i={passive:!0}){return e.addEventListener(t,r,i),()=>e.removeEventListener(t,r)}const ZI=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1;function By(e,t="page"){return{point:{x:e[t+"X"],y:e[t+"Y"]}}}const vU=e=>t=>ZI(t)&&e(t,By(t));function to(e,t,r,i){return Ka(e,t,vU(r),i)}const yU=(e,t)=>r=>t(e(r)),ul=(...e)=>e.reduce(yU);function $I(e){let t=null;return()=>{const r=()=>{t=null};return t===null?(t=e,r):!1}}const RM=$I("dragHorizontal"),BM=$I("dragVertical");function JI(e){let t=!1;if(e==="y")t=BM();else if(e==="x")t=RM();else{const r=RM(),i=BM();r&&i?t=()=>{r(),i()}:(r&&r(),i&&i())}return t}function eO(){const e=JI(!0);return e?(e(),!1):!0}class Dl{constructor(t){this.isMounted=!1,this.node=t}update(){}}function zM(e,t){const r="pointer"+(t?"enter":"leave"),i="onHover"+(t?"Start":"End"),n=(s,a)=>{if(s.type==="touch"||eO())return;const o=e.getProps();e.animationState&&o.whileHover&&e.animationState.setActive("whileHover",t),o[i]&&Ft.update(()=>o[i](s,a))};return to(e.current,r,n,{passive:!e.getProps()[i]})}class xU extends Dl{mount(){this.unmount=ul(zM(this.node,!0),zM(this.node,!1))}unmount(){}}class wU extends Dl{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=ul(Ka(this.node.current,"focus",()=>this.onFocus()),Ka(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const tO=(e,t)=>t?e===t?!0:tO(e,t.parentElement):!1;function G1(e,t){if(!t)return;const r=new PointerEvent("pointer"+e);t(r,By(r))}class bU extends Dl{constructor(){super(...arguments),this.removeStartListeners=pr,this.removeEndListeners=pr,this.removeAccessibleListeners=pr,this.startPointerPress=(t,r)=>{if(this.removeEndListeners(),this.isPressing)return;const i=this.node.getProps(),s=to(window,"pointerup",(o,l)=>{if(!this.checkPressEnd())return;const{onTap:c,onTapCancel:u}=this.node.getProps();Ft.update(()=>{tO(this.node.current,o.target)?c&&c(o,l):u&&u(o,l)})},{passive:!(i.onTap||i.onPointerUp)}),a=to(window,"pointercancel",(o,l)=>this.cancelPress(o,l),{passive:!(i.onTapCancel||i.onPointerCancel)});this.removeEndListeners=ul(s,a),this.startPress(t,r)},this.startAccessiblePress=()=>{const t=s=>{if(s.key!=="Enter"||this.isPressing)return;const a=o=>{o.key!=="Enter"||!this.checkPressEnd()||G1("up",(l,c)=>{const{onTap:u}=this.node.getProps();u&&Ft.update(()=>u(l,c))})};this.removeEndListeners(),this.removeEndListeners=Ka(this.node.current,"keyup",a),G1("down",(o,l)=>{this.startPress(o,l)})},r=Ka(this.node.current,"keydown",t),i=()=>{this.isPressing&&G1("cancel",(s,a)=>this.cancelPress(s,a))},n=Ka(this.node.current,"blur",i);this.removeAccessibleListeners=ul(r,n)}}startPress(t,r){this.isPressing=!0;const{onTapStart:i,whileTap:n}=this.node.getProps();n&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),i&&Ft.update(()=>i(t,r))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!eO()}cancelPress(t,r){if(!this.checkPressEnd())return;const{onTapCancel:i}=this.node.getProps();i&&Ft.update(()=>i(t,r))}mount(){const t=this.node.getProps(),r=to(this.node.current,"pointerdown",this.startPointerPress,{passive:!(t.onTapStart||t.onPointerStart)}),i=Ka(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=ul(r,i)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const Qb=new WeakMap,W1=new WeakMap,_U=e=>{const t=Qb.get(e.target);t&&t(e)},SU=e=>{e.forEach(_U)};function AU({root:e,...t}){const r=e||document;W1.has(r)||W1.set(r,{});const i=W1.get(r),n=JSON.stringify(t);return i[n]||(i[n]=new IntersectionObserver(SU,{root:e,...t})),i[n]}function CU(e,t,r){const i=AU(t);return Qb.set(e,r),i.observe(e),()=>{Qb.delete(e),i.unobserve(e)}}const MU={some:0,all:1};class EU extends Dl{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:i,amount:n="some",once:s}=t,a={root:r?r.current:void 0,rootMargin:i,threshold:typeof n=="number"?n:MU[n]},o=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,s&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:u,onViewportLeave:h}=this.node.getProps(),d=c?u:h;d&&d(l)};return CU(this.node.current,a,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(TU(t,r))&&this.startObserver()}unmount(){}}function TU({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const PU={inView:{Feature:EU},tap:{Feature:bU},focus:{Feature:wU},hover:{Feature:xU}};function rO(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let i=0;i<r;i++)if(t[i]!==e[i])return!1;return!0}function DU(e){const t={};return e.values.forEach((r,i)=>t[i]=r.get()),t}function LU(e){const t={};return e.values.forEach((r,i)=>t[i]=r.getVelocity()),t}function zy(e,t,r){const i=e.getProps();return o3(i,t,r!==void 0?r:i.custom,DU(e),LU(e))}const IU="framerAppearId",OU="data-"+s3(IU);let iO=pr,ky=pr;const dl=e=>e*1e3,ro=e=>e/1e3,RU={current:!1},nO=e=>Array.isArray(e)&&typeof e[0]=="number";function sO(e){return!!(!e||typeof e=="string"&&aO[e]||nO(e)||Array.isArray(e)&&e.every(sO))}const Ap=([e,t,r,i])=>`cubic-bezier(${e}, ${t}, ${r}, ${i})`,aO={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Ap([0,.65,.55,1]),circOut:Ap([.55,0,1,.45]),backIn:Ap([.31,.01,.66,-.59]),backOut:Ap([.33,1.53,.69,.99])};function oO(e){if(e)return nO(e)?Ap(e):Array.isArray(e)?e.map(oO):aO[e]}function BU(e,t,r,{delay:i=0,duration:n,repeat:s=0,repeatType:a="loop",ease:o,times:l}={}){const c={[t]:r};l&&(c.offset=l);const u=oO(o);return Array.isArray(u)&&(c.easing=u),e.animate(c,{delay:i,duration:n,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:s+1,direction:a==="reverse"?"alternate":"normal"})}function zU(e,{repeat:t,repeatType:r="loop"}){const i=t&&r!=="loop"&&t%2===1?0:e.length-1;return e[i]}const lO=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,kU=1e-7,NU=12;function FU(e,t,r,i,n){let s,a,o=0;do a=t+(r-t)/2,s=lO(a,i,n)-e,s>0?r=a:t=a;while(Math.abs(s)>kU&&++o<NU);return a}function lm(e,t,r,i){if(e===t&&r===i)return pr;const n=s=>FU(s,0,1,e,r);return s=>s===0||s===1?s:lO(n(s),t,i)}const UU=lm(.42,0,1,1),jU=lm(0,0,.58,1),cO=lm(.42,0,.58,1),VU=e=>Array.isArray(e)&&typeof e[0]!="number",hO=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,uO=e=>t=>1-e(1-t),dO=e=>1-Math.sin(Math.acos(e)),l3=uO(dO),HU=hO(l3),pO=lm(.33,1.53,.69,.99),c3=uO(pO),GU=hO(c3),WU=e=>(e*=2)<1?.5*c3(e):.5*(2-Math.pow(2,-10*(e-1))),qU={linear:pr,easeIn:UU,easeInOut:cO,easeOut:jU,circIn:dO,circInOut:HU,circOut:l3,backIn:c3,backInOut:GU,backOut:pO,anticipate:WU},kM=e=>{if(Array.isArray(e)){ky(e.length===4);const[t,r,i,n]=e;return lm(t,r,i,n)}else if(typeof e=="string")return qU[e];return e},h3=(e,t)=>r=>!!(am(r)&&qF.test(r)&&r.startsWith(e)||t&&Object.prototype.hasOwnProperty.call(r,t)),fO=(e,t,r)=>i=>{if(!am(i))return i;const[n,s,a,o]=i.match(Ry);return{[e]:parseFloat(n),[t]:parseFloat(s),[r]:parseFloat(a),alpha:o!==void 0?parseFloat(o):1}},XU=e=>bl(0,255,e),q1={...Hc,transform:e=>Math.round(XU(e))},hc={test:h3("rgb","red"),parse:fO("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:i=1})=>"rgba("+q1.transform(e)+", "+q1.transform(t)+", "+q1.transform(r)+", "+Wp(Gp.transform(i))+")"};function YU(e){let t="",r="",i="",n="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),i=e.substring(5,7),n=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),i=e.substring(3,4),n=e.substring(4,5),t+=t,r+=r,i+=i,n+=n),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(i,16),alpha:n?parseInt(n,16)/255:1}}const Kb={test:h3("#"),parse:YU,transform:hc.transform},Kh={test:h3("hsl","hue"),parse:fO("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:i=1})=>"hsla("+Math.round(e)+", "+ha.transform(Wp(t))+", "+ha.transform(Wp(r))+", "+Wp(Gp.transform(i))+")"},Pi={test:e=>hc.test(e)||Kb.test(e)||Kh.test(e),parse:e=>hc.test(e)?hc.parse(e):Kh.test(e)?Kh.parse(e):Kb.parse(e),transform:e=>am(e)?e:e.hasOwnProperty("red")?hc.transform(e):Kh.transform(e)},sr=(e,t,r)=>-r*e+r*t+e;function X1(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function QU({hue:e,saturation:t,lightness:r,alpha:i}){e/=360,t/=100,r/=100;let n=0,s=0,a=0;if(!t)n=s=a=r;else{const o=r<.5?r*(1+t):r+t-r*t,l=2*r-o;n=X1(l,o,e+1/3),s=X1(l,o,e),a=X1(l,o,e-1/3)}return{red:Math.round(n*255),green:Math.round(s*255),blue:Math.round(a*255),alpha:i}}const Y1=(e,t,r)=>{const i=e*e;return Math.sqrt(Math.max(0,r*(t*t-i)+i))},KU=[Kb,hc,Kh],ZU=e=>KU.find(t=>t.test(e));function NM(e){const t=ZU(e);let r=t.parse(e);return t===Kh&&(r=QU(r)),r}const mO=(e,t)=>{const r=NM(e),i=NM(t),n={...r};return s=>(n.red=Y1(r.red,i.red,s),n.green=Y1(r.green,i.green,s),n.blue=Y1(r.blue,i.blue,s),n.alpha=sr(r.alpha,i.alpha,s),hc.transform(n))};function $U(e){var t,r;return isNaN(e)&&am(e)&&(((t=e.match(Ry))===null||t===void 0?void 0:t.length)||0)+(((r=e.match(UI))===null||r===void 0?void 0:r.length)||0)>0}const gO={regex:GF,countKey:"Vars",token:"${v}",parse:pr},vO={regex:UI,countKey:"Colors",token:"${c}",parse:Pi.parse},yO={regex:Ry,countKey:"Numbers",token:"${n}",parse:Hc.parse};function Q1(e,{regex:t,countKey:r,token:i,parse:n}){const s=e.tokenised.match(t);s&&(e["num"+r]=s.length,e.tokenised=e.tokenised.replace(t,i),e.values.push(...s.map(n)))}function u0(e){const t=e.toString(),r={value:t,tokenised:t,values:[],numVars:0,numColors:0,numNumbers:0};return r.value.includes("var(--")&&Q1(r,gO),Q1(r,vO),Q1(r,yO),r}function xO(e){return u0(e).values}function wO(e){const{values:t,numColors:r,numVars:i,tokenised:n}=u0(e),s=t.length;return a=>{let o=n;for(let l=0;l<s;l++)l<i?o=o.replace(gO.token,a[l]):l<i+r?o=o.replace(vO.token,Pi.transform(a[l])):o=o.replace(yO.token,Wp(a[l]));return o}}const JU=e=>typeof e=="number"?0:e;function ej(e){const t=xO(e);return wO(e)(t.map(JU))}const _l={test:$U,parse:xO,createTransformer:wO,getAnimatableNone:ej},bO=(e,t)=>r=>`${r>0?t:e}`;function _O(e,t){return typeof e=="number"?r=>sr(e,t,r):Pi.test(e)?mO(e,t):e.startsWith("var(")?bO(e,t):AO(e,t)}const SO=(e,t)=>{const r=[...e],i=r.length,n=e.map((s,a)=>_O(s,t[a]));return s=>{for(let a=0;a<i;a++)r[a]=n[a](s);return r}},tj=(e,t)=>{const r={...e,...t},i={};for(const n in r)e[n]!==void 0&&t[n]!==void 0&&(i[n]=_O(e[n],t[n]));return n=>{for(const s in i)r[s]=i[s](n);return r}},AO=(e,t)=>{const r=_l.createTransformer(t),i=u0(e),n=u0(t);return i.numVars===n.numVars&&i.numColors===n.numColors&&i.numNumbers>=n.numNumbers?ul(SO(i.values,n.values),r):bO(e,t)},Uu=(e,t,r)=>{const i=t-e;return i===0?1:(r-e)/i},FM=(e,t)=>r=>sr(e,t,r);function rj(e){return typeof e=="number"?FM:typeof e=="string"?Pi.test(e)?mO:AO:Array.isArray(e)?SO:typeof e=="object"?tj:FM}function ij(e,t,r){const i=[],n=r||rj(e[0]),s=e.length-1;for(let a=0;a<s;a++){let o=n(e[a],e[a+1]);if(t){const l=Array.isArray(t)?t[a]||pr:t;o=ul(l,o)}i.push(o)}return i}function u3(e,t,{clamp:r=!0,ease:i,mixer:n}={}){const s=e.length;if(ky(s===t.length),s===1)return()=>t[0];e[0]>e[s-1]&&(e=[...e].reverse(),t=[...t].reverse());const a=ij(t,i,n),o=a.length,l=c=>{let u=0;if(o>1)for(;u<e.length-2&&!(c<e[u+1]);u++);const h=Uu(e[u],e[u+1],c);return a[u](h)};return r?c=>l(bl(e[0],e[s-1],c)):l}function nj(e,t){const r=e[e.length-1];for(let i=1;i<=t;i++){const n=Uu(0,t,i);e.push(sr(r,1,n))}}function CO(e){const t=[0];return nj(t,e.length-1),t}function sj(e,t){return e.map(r=>r*t)}function aj(e,t){return e.map(()=>t||cO).splice(0,e.length-1)}function d0({duration:e=300,keyframes:t,times:r,ease:i="easeInOut"}){const n=VU(i)?i.map(kM):kM(i),s={done:!1,value:t[0]},a=sj(r&&r.length===t.length?r:CO(t),e),o=u3(a,t,{ease:Array.isArray(n)?n:aj(t,n)});return{calculatedDuration:e,next:l=>(s.value=o(l),s.done=l>=e,s)}}function d3(e,t){return t?e*(1e3/t):0}const oj=5;function MO(e,t,r){const i=Math.max(t-oj,0);return d3(r-e(i),t-i)}const K1=.001,lj=.01,UM=10,cj=.05,hj=1;function uj({duration:e=800,bounce:t=.25,velocity:r=0,mass:i=1}){let n,s;iO(e<=dl(UM));let a=1-t;a=bl(cj,hj,a),e=bl(lj,UM,ro(e)),a<1?(n=c=>{const u=c*a,h=u*e,d=u-r,p=Zb(c,a),f=Math.exp(-h);return K1-d/p*f},s=c=>{const h=c*a*e,d=h*r+r,p=Math.pow(a,2)*Math.pow(c,2)*e,f=Math.exp(-h),m=Zb(Math.pow(c,2),a);return(-n(c)+K1>0?-1:1)*((d-p)*f)/m}):(n=c=>{const u=Math.exp(-c*e),h=(c-r)*e+1;return-K1+u*h},s=c=>{const u=Math.exp(-c*e),h=(r-c)*(e*e);return u*h});const o=5/e,l=pj(n,s,o);if(e=dl(e),isNaN(l))return{stiffness:100,damping:10,duration:e};{const c=Math.pow(l,2)*i;return{stiffness:c,damping:a*2*Math.sqrt(i*c),duration:e}}}const dj=12;function pj(e,t,r){let i=r;for(let n=1;n<dj;n++)i=i-e(i)/t(i);return i}function Zb(e,t){return e*Math.sqrt(1-t*t)}const fj=["duration","bounce"],mj=["stiffness","damping","mass"];function jM(e,t){return t.some(r=>e[r]!==void 0)}function gj(e){let t={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...e};if(!jM(e,mj)&&jM(e,fj)){const r=uj(e);t={...t,...r,velocity:0,mass:1},t.isResolvedFromDuration=!0}return t}function EO({keyframes:e,restDelta:t,restSpeed:r,...i}){const n=e[0],s=e[e.length-1],a={done:!1,value:n},{stiffness:o,damping:l,mass:c,velocity:u,duration:h,isResolvedFromDuration:d}=gj(i),p=u?-ro(u):0,f=l/(2*Math.sqrt(o*c)),m=s-n,g=ro(Math.sqrt(o/c)),v=Math.abs(m)<5;r||(r=v?.01:2),t||(t=v?.005:.5);let y;if(f<1){const x=Zb(g,f);y=w=>{const b=Math.exp(-f*g*w);return s-b*((p+f*g*m)/x*Math.sin(x*w)+m*Math.cos(x*w))}}else if(f===1)y=x=>s-Math.exp(-g*x)*(m+(p+g*m)*x);else{const x=g*Math.sqrt(f*f-1);y=w=>{const b=Math.exp(-f*g*w),_=Math.min(x*w,300);return s-b*((p+f*g*m)*Math.sinh(_)+x*m*Math.cosh(_))/x}}return{calculatedDuration:d&&h||null,next:x=>{const w=y(x);if(d)a.done=x>=h;else{let b=p;x!==0&&(f<1?b=MO(y,x,w):b=0);const _=Math.abs(b)<=r,A=Math.abs(s-w)<=t;a.done=_&&A}return a.value=a.done?s:w,a}}}function VM({keyframes:e,velocity:t=0,power:r=.8,timeConstant:i=325,bounceDamping:n=10,bounceStiffness:s=500,modifyTarget:a,min:o,max:l,restDelta:c=.5,restSpeed:u}){const h=e[0],d={done:!1,value:h},p=S=>o!==void 0&&S<o||l!==void 0&&S>l,f=S=>o===void 0?l:l===void 0||Math.abs(o-S)<Math.abs(l-S)?o:l;let m=r*t;const g=h+m,v=a===void 0?g:a(g);v!==g&&(m=v-h);const y=S=>-m*Math.exp(-S/i),x=S=>v+y(S),w=S=>{const C=y(S),M=x(S);d.done=Math.abs(C)<=c,d.value=d.done?v:M};let b,_;const A=S=>{p(d.value)&&(b=S,_=EO({keyframes:[d.value,f(d.value)],velocity:MO(x,S,d.value),damping:n,stiffness:s,restDelta:c,restSpeed:u}))};return A(0),{calculatedDuration:null,next:S=>{let C=!1;return!_&&b===void 0&&(C=!0,w(S),A(S)),b!==void 0&&S>b?_.next(S-b):(!C&&w(S),d)}}}const vj=e=>{const t=({timestamp:r})=>e(r);return{start:()=>Ft.update(t,!0),stop:()=>pa(t),now:()=>kr.isProcessing?kr.timestamp:performance.now()}},HM=2e4;function GM(e){let t=0;const r=50;let i=e.next(t);for(;!i.done&&t<HM;)t+=r,i=e.next(t);return t>=HM?1/0:t}const yj={decay:VM,inertia:VM,tween:d0,keyframes:d0,spring:EO};function p0({autoplay:e=!0,delay:t=0,driver:r=vj,keyframes:i,type:n="keyframes",repeat:s=0,repeatDelay:a=0,repeatType:o="loop",onPlay:l,onStop:c,onComplete:u,onUpdate:h,...d}){let p=1,f=!1,m,g;const v=()=>{g=new Promise(N=>{m=N})};v();let y;const x=yj[n]||d0;let w;x!==d0&&typeof i[0]!="number"&&(w=u3([0,100],i,{clamp:!1}),i=[0,100]);const b=x({...d,keyframes:i});let _;o==="mirror"&&(_=x({...d,keyframes:[...i].reverse(),velocity:-(d.velocity||0)}));let A="idle",S=null,C=null,M=null;b.calculatedDuration===null&&s&&(b.calculatedDuration=GM(b));const{calculatedDuration:T}=b;let P=1/0,D=1/0;T!==null&&(P=T+a,D=P*(s+1)-a);let I=0;const B=N=>{if(C===null)return;p>0&&(C=Math.min(C,N)),p<0&&(C=Math.min(N-D/p,C)),S!==null?I=S:I=Math.round(N-C)*p;const j=I-t*(p>=0?1:-1),K=p>=0?j<0:j>D;I=Math.max(j,0),A==="finished"&&S===null&&(I=D);let U=I,Y=b;if(s){const ee=I/P;let se=Math.floor(ee),ce=ee%1;!ce&&ee>=1&&(ce=1),ce===1&&se--,se=Math.min(se,s+1);const ue=!!(se%2);ue&&(o==="reverse"?(ce=1-ce,a&&(ce-=a/P)):o==="mirror"&&(Y=_));let ye=bl(0,1,ce);I>D&&(ye=o==="reverse"&&ue?1:0),U=ye*P}const V=K?{done:!1,value:i[0]}:Y.next(U);w&&(V.value=w(V.value));let{done:ie}=V;!K&&T!==null&&(ie=p>=0?I>=D:I<=0);const J=S===null&&(A==="finished"||A==="running"&&ie);return h&&h(V.value),J&&R(),V},X=()=>{y&&y.stop(),y=void 0},H=()=>{A="idle",X(),m(),v(),C=M=null},R=()=>{A="finished",u&&u(),X(),m()},q=()=>{if(f)return;y||(y=r(B));const N=y.now();l&&l(),S!==null?C=N-S:(!C||A==="finished")&&(C=N),A==="finished"&&v(),M=C,S=null,A="running",y.start()};e&&q();const F={then(N,j){return g.then(N,j)},get time(){return ro(I)},set time(N){N=dl(N),I=N,S!==null||!y||p===0?S=N:C=y.now()-N/p},get duration(){const N=b.calculatedDuration===null?GM(b):b.calculatedDuration;return ro(N)},get speed(){return p},set speed(N){N===p||!y||(p=N,F.time=ro(I))},get state(){return A},play:q,pause:()=>{A="paused",S=I},stop:()=>{f=!0,A!=="idle"&&(A="idle",c&&c(),H())},cancel:()=>{M!==null&&B(M),H()},complete:()=>{A="finished"},sample:N=>(C=0,B(N))};return F}function xj(e){let t;return()=>(t===void 0&&(t=e()),t)}const wj=xj(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),bj=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),Hm=10,_j=2e4,Sj=(e,t)=>t.type==="spring"||e==="backgroundColor"||!sO(t.ease);function Aj(e,t,{onUpdate:r,onComplete:i,...n}){if(!(wj()&&bj.has(t)&&!n.repeatDelay&&n.repeatType!=="mirror"&&n.damping!==0&&n.type!=="inertia"))return!1;let a=!1,o,l;const c=()=>{l=new Promise(y=>{o=y})};c();let{keyframes:u,duration:h=300,ease:d,times:p}=n;if(Sj(t,n)){const y=p0({...n,repeat:0,delay:0});let x={done:!1,value:u[0]};const w=[];let b=0;for(;!x.done&&b<_j;)x=y.sample(b),w.push(x.value),b+=Hm;p=void 0,u=w,h=b-Hm,d="linear"}const f=BU(e.owner.current,t,u,{...n,duration:h,ease:d,times:p});n.syncStart&&(f.startTime=kr.isProcessing?kr.timestamp:document.timeline?document.timeline.currentTime:performance.now());const m=()=>f.cancel(),g=()=>{Ft.update(m),o(),c()};return f.onfinish=()=>{e.set(zU(u,n)),i&&i(),g()},{then(y,x){return l.then(y,x)},attachTimeline(y){return f.timeline=y,f.onfinish=null,pr},get time(){return ro(f.currentTime||0)},set time(y){f.currentTime=dl(y)},get speed(){return f.playbackRate},set speed(y){f.playbackRate=y},get duration(){return ro(h)},play:()=>{a||(f.play(),pa(m))},pause:()=>f.pause(),stop:()=>{if(a=!0,f.playState==="idle")return;const{currentTime:y}=f;if(y){const x=p0({...n,autoplay:!1});e.setWithVelocity(x.sample(y-Hm).value,x.sample(y).value,Hm)}g()},complete:()=>f.finish(),cancel:g}}function Cj({keyframes:e,delay:t,onUpdate:r,onComplete:i}){const n=()=>(r&&r(e[e.length-1]),i&&i(),{time:0,speed:1,duration:0,play:pr,pause:pr,stop:pr,then:s=>(s(),Promise.resolve()),cancel:pr,complete:pr});return t?p0({keyframes:[0,1],duration:0,delay:t,onComplete:n}):n()}const Mj={type:"spring",stiffness:500,damping:25,restSpeed:10},Ej=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),Tj={type:"keyframes",duration:.8},Pj={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Dj=(e,{keyframes:t})=>t.length>2?Tj:Vc.has(e)?e.startsWith("scale")?Ej(t[1]):Mj:Pj,$b=(e,t)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(_l.test(t)||t==="0")&&!t.startsWith("url(")),Lj=new Set(["brightness","contrast","saturate","opacity"]);function Ij(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[i]=r.match(Ry)||[];if(!i)return e;const n=r.replace(i,"");let s=Lj.has(t)?1:0;return i!==r&&(s*=100),t+"("+s+n+")"}const Oj=/([a-z-]*)\(.*?\)/g,Jb={..._l,getAnimatableNone:e=>{const t=e.match(Oj);return t?t.map(Ij).join(" "):e}},Rj={...jI,color:Pi,backgroundColor:Pi,outlineColor:Pi,fill:Pi,stroke:Pi,borderColor:Pi,borderTopColor:Pi,borderRightColor:Pi,borderBottomColor:Pi,borderLeftColor:Pi,filter:Jb,WebkitFilter:Jb},p3=e=>Rj[e];function TO(e,t){let r=p3(e);return r!==Jb&&(r=_l),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const PO=e=>/^0[^.\s]+$/.test(e);function Bj(e){if(typeof e=="number")return e===0;if(e!==null)return e==="none"||e==="0"||PO(e)}function zj(e,t,r,i){const n=$b(t,r);let s;Array.isArray(r)?s=[...r]:s=[null,r];const a=i.from!==void 0?i.from:e.get();let o;const l=[];for(let c=0;c<s.length;c++)s[c]===null&&(s[c]=c===0?a:s[c-1]),Bj(s[c])&&l.push(c),typeof s[c]=="string"&&s[c]!=="none"&&s[c]!=="0"&&(o=s[c]);if(n&&l.length&&o)for(let c=0;c<l.length;c++){const u=l[c];s[u]=TO(t,o)}return s}function kj({when:e,delay:t,delayChildren:r,staggerChildren:i,staggerDirection:n,repeat:s,repeatType:a,repeatDelay:o,from:l,elapsed:c,...u}){return!!Object.keys(u).length}function DO(e,t){return e[t]||e.default||e}const f3=(e,t,r,i={})=>n=>{const s=DO(i,e)||{},a=s.delay||i.delay||0;let{elapsed:o=0}=i;o=o-dl(a);const l=zj(t,e,r,s),c=l[0],u=l[l.length-1],h=$b(e,c),d=$b(e,u);let p={keyframes:l,velocity:t.getVelocity(),ease:"easeOut",...s,delay:-o,onUpdate:f=>{t.set(f),s.onUpdate&&s.onUpdate(f)},onComplete:()=>{n(),s.onComplete&&s.onComplete()}};if(kj(s)||(p={...p,...Dj(e,p)}),p.duration&&(p.duration=dl(p.duration)),p.repeatDelay&&(p.repeatDelay=dl(p.repeatDelay)),!h||!d||RU.current||s.type===!1)return Cj(p);if(t.owner&&t.owner.current instanceof HTMLElement&&!t.owner.getProps().onUpdate){const f=Aj(t,e,p);if(f)return f}return p0(p)};function f0(e){return!!(sn(e)&&e.add)}const LO=e=>/^\-?\d*\.?\d+$/.test(e);function m3(e,t){e.indexOf(t)===-1&&e.push(t)}function g3(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}class v3{constructor(){this.subscriptions=[]}add(t){return m3(this.subscriptions,t),()=>g3(this.subscriptions,t)}notify(t,r,i){const n=this.subscriptions.length;if(n)if(n===1)this.subscriptions[0](t,r,i);else for(let s=0;s<n;s++){const a=this.subscriptions[s];a&&a(t,r,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Nj=e=>!isNaN(parseFloat(e));class Fj{constructor(t,r={}){this.version="10.16.4",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(i,n=!0)=>{this.prev=this.current,this.current=i;const{delta:s,timestamp:a}=kr;this.lastUpdated!==a&&(this.timeDelta=s,this.lastUpdated=a,Ft.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),n&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>Ft.postRender(this.velocityCheck),this.velocityCheck=({timestamp:i})=>{i!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=t,this.canTrackVelocity=Nj(this.current),this.owner=r.owner}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new v3);const i=this.events[t].add(r);return t==="change"?()=>{i(),Ft.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t,r=!0){!r||!this.passiveEffect?this.updateAndNotify(t,r):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,r,i){this.set(r),this.prev=t,this.timeDelta=i}jump(t){this.updateAndNotify(t),this.prev=t,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?d3(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function sa(e,t){return new Fj(e,t)}const IO=e=>t=>t.test(e),Uj={test:e=>e==="auto",parse:e=>e},OO=[Hc,at,ha,Bo,YF,XF,Uj],Fd=e=>OO.find(IO(e)),jj=[...OO,Pi,_l],Vj=e=>jj.find(IO(e));function Hj(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,sa(r))}function Gj(e,t){const r=zy(e,t);let{transitionEnd:i={},transition:n={},...s}=r?e.makeTargetAnimatable(r,!1):{};s={...s,...i};for(const a in s){const o=lU(s[a]);Hj(e,a,o)}}function Wj(e,t,r){var i,n;const s=Object.keys(t).filter(o=>!e.hasValue(o)),a=s.length;if(a)for(let o=0;o<a;o++){const l=s[o],c=t[l];let u=null;Array.isArray(c)&&(u=c[0]),u===null&&(u=(n=(i=r[l])!==null&&i!==void 0?i:e.readValue(l))!==null&&n!==void 0?n:t[l]),u!=null&&(typeof u=="string"&&(LO(u)||PO(u))?u=parseFloat(u):!Vj(u)&&_l.test(c)&&(u=TO(l,c)),e.addValue(l,sa(u,{owner:e})),r[l]===void 0&&(r[l]=u),u!==null&&e.setBaseTarget(l,u))}}function qj(e,t){return t?(t[e]||t.default||t).from:void 0}function Xj(e,t,r){const i={};for(const n in e){const s=qj(n,t);if(s!==void 0)i[n]=s;else{const a=r.getValue(n);a&&(i[n]=a.get())}}return i}function Yj({protectedKeys:e,needsAnimating:t},r){const i=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,i}function RO(e,t,{delay:r=0,transitionOverride:i,type:n}={}){let{transition:s=e.getDefaultTransition(),transitionEnd:a,...o}=e.makeTargetAnimatable(t);const l=e.getValue("willChange");i&&(s=i);const c=[],u=n&&e.animationState&&e.animationState.getState()[n];for(const h in o){const d=e.getValue(h),p=o[h];if(!d||p===void 0||u&&Yj(u,h))continue;const f={delay:r,elapsed:0,...s};if(window.HandoffAppearAnimations&&!d.hasAnimated){const g=e.getProps()[OU];g&&(f.elapsed=window.HandoffAppearAnimations(g,h,d,Ft),f.syncStart=!0)}d.start(f3(h,d,p,e.shouldReduceMotion&&Vc.has(h)?{type:!1}:f));const m=d.animation;f0(l)&&(l.add(h),m.then(()=>l.remove(h))),c.push(m)}return a&&Promise.all(c).then(()=>{a&&Gj(e,a)}),c}function e2(e,t,r={}){const i=zy(e,t,r.custom);let{transition:n=e.getDefaultTransition()||{}}=i||{};r.transitionOverride&&(n=r.transitionOverride);const s=i?()=>Promise.all(RO(e,i,r)):()=>Promise.resolve(),a=e.variantChildren&&e.variantChildren.size?(l=0)=>{const{delayChildren:c=0,staggerChildren:u,staggerDirection:h}=n;return Qj(e,t,c+l,u,h,r)}:()=>Promise.resolve(),{when:o}=n;if(o){const[l,c]=o==="beforeChildren"?[s,a]:[a,s];return l().then(()=>c())}else return Promise.all([s(),a(r.delay)])}function Qj(e,t,r=0,i=0,n=1,s){const a=[],o=(e.variantChildren.size-1)*i,l=n===1?(c=0)=>c*i:(c=0)=>o-c*i;return Array.from(e.variantChildren).sort(Kj).forEach((c,u)=>{c.notify("AnimationStart",t),a.push(e2(c,t,{...s,delay:r+l(u)}).then(()=>c.notify("AnimationComplete",t)))}),Promise.all(a)}function Kj(e,t){return e.sortNodePosition(t)}function Zj(e,t,r={}){e.notify("AnimationStart",t);let i;if(Array.isArray(t)){const n=t.map(s=>e2(e,s,r));i=Promise.all(n)}else if(typeof t=="string")i=e2(e,t,r);else{const n=typeof t=="function"?zy(e,t,r.custom):t;i=Promise.all(RO(e,n,r))}return i.then(()=>e.notify("AnimationComplete",t))}const $j=[...$S].reverse(),Jj=$S.length;function eV(e){return t=>Promise.all(t.map(({animation:r,options:i})=>Zj(e,r,i)))}function tV(e){let t=eV(e);const r=iV();let i=!0;const n=(l,c)=>{const u=zy(e,c);if(u){const{transition:h,transitionEnd:d,...p}=u;l={...l,...p,...d}}return l};function s(l){t=l(e)}function a(l,c){const u=e.getProps(),h=e.getVariantContext(!0)||{},d=[],p=new Set;let f={},m=1/0;for(let v=0;v<Jj;v++){const y=$j[v],x=r[y],w=u[y]!==void 0?u[y]:h[y],b=Lf(w),_=y===c?x.isActive:null;_===!1&&(m=v);let A=w===h[y]&&w!==u[y]&&b;if(A&&i&&e.manuallyAnimateOnMount&&(A=!1),x.protectedKeys={...f},!x.isActive&&_===null||!w&&!x.prevProp||Iy(w)||typeof w=="boolean")continue;const S=rV(x.prevProp,w);let C=S||y===c&&x.isActive&&!A&&b||v>m&&b;const M=Array.isArray(w)?w:[w];let T=M.reduce(n,{});_===!1&&(T={});const{prevResolvedValues:P={}}=x,D={...P,...T},I=B=>{C=!0,p.delete(B),x.needsAnimating[B]=!0};for(const B in D){const X=T[B],H=P[B];f.hasOwnProperty(B)||(X!==H?h0(X)&&h0(H)?!rO(X,H)||S?I(B):x.protectedKeys[B]=!0:X!==void 0?I(B):p.add(B):X!==void 0&&p.has(B)?I(B):x.protectedKeys[B]=!0)}x.prevProp=w,x.prevResolvedValues=T,x.isActive&&(f={...f,...T}),i&&e.blockInitialAnimation&&(C=!1),C&&!A&&d.push(...M.map(B=>({animation:B,options:{type:y,...l}})))}if(p.size){const v={};p.forEach(y=>{const x=e.getBaseTarget(y);x!==void 0&&(v[y]=x)}),d.push({animation:v})}let g=!!d.length;return i&&u.initial===!1&&!e.manuallyAnimateOnMount&&(g=!1),i=!1,g?t(d):Promise.resolve()}function o(l,c,u){var h;if(r[l].isActive===c)return Promise.resolve();(h=e.variantChildren)===null||h===void 0||h.forEach(p=>{var f;return(f=p.animationState)===null||f===void 0?void 0:f.setActive(l,c)}),r[l].isActive=c;const d=a(u,l);for(const p in r)r[p].protectedKeys={};return d}return{animateChanges:a,setActive:o,setAnimateFunction:s,getState:()=>r}}function rV(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!rO(t,e):!1}function kl(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function iV(){return{animate:kl(!0),whileInView:kl(),whileHover:kl(),whileTap:kl(),whileDrag:kl(),whileFocus:kl(),exit:kl()}}class nV extends Dl{constructor(t){super(t),t.animationState||(t.animationState=tV(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();this.unmount(),Iy(t)&&(this.unmount=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){}}let sV=0;class aV extends Dl{constructor(){super(...arguments),this.id=sV++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r,custom:i}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===n)return;const s=this.node.animationState.setActive("exit",!t,{custom:i??this.node.getProps().custom});r&&!t&&s.then(()=>r(this.id))}mount(){const{register:t}=this.node.presenceContext||{};t&&(this.unmount=t(this.id))}unmount(){}}const oV={animation:{Feature:nV},exit:{Feature:aV}},WM=(e,t)=>Math.abs(e-t);function lV(e,t){const r=WM(e.x,t.x),i=WM(e.y,t.y);return Math.sqrt(r**2+i**2)}class BO{constructor(t,r,{transformPagePoint:i}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const c=$1(this.lastMoveEventInfo,this.history),u=this.startEvent!==null,h=lV(c.offset,{x:0,y:0})>=3;if(!u&&!h)return;const{point:d}=c,{timestamp:p}=kr;this.history.push({...d,timestamp:p});const{onStart:f,onMove:m}=this.handlers;u||(f&&f(this.lastMoveEvent,c),this.startEvent=this.lastMoveEvent),m&&m(this.lastMoveEvent,c)},this.handlePointerMove=(c,u)=>{this.lastMoveEvent=c,this.lastMoveEventInfo=Z1(u,this.transformPagePoint),Ft.update(this.updatePoint,!0)},this.handlePointerUp=(c,u)=>{if(this.end(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const{onEnd:h,onSessionEnd:d}=this.handlers,p=$1(c.type==="pointercancel"?this.lastMoveEventInfo:Z1(u,this.transformPagePoint),this.history);this.startEvent&&h&&h(c,p),d&&d(c,p)},!ZI(t))return;this.handlers=r,this.transformPagePoint=i;const n=By(t),s=Z1(n,this.transformPagePoint),{point:a}=s,{timestamp:o}=kr;this.history=[{...a,timestamp:o}];const{onSessionStart:l}=r;l&&l(t,$1(s,this.history)),this.removeListeners=ul(to(window,"pointermove",this.handlePointerMove),to(window,"pointerup",this.handlePointerUp),to(window,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),pa(this.updatePoint)}}function Z1(e,t){return t?{point:t(e.point)}:e}function qM(e,t){return{x:e.x-t.x,y:e.y-t.y}}function $1({point:e},t){return{point:e,delta:qM(e,zO(t)),offset:qM(e,cV(t)),velocity:hV(t,.1)}}function cV(e){return e[0]}function zO(e){return e[e.length-1]}function hV(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,i=null;const n=zO(e);for(;r>=0&&(i=e[r],!(n.timestamp-i.timestamp>dl(t)));)r--;if(!i)return{x:0,y:0};const s=ro(n.timestamp-i.timestamp);if(s===0)return{x:0,y:0};const a={x:(n.x-i.x)/s,y:(n.y-i.y)/s};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}function Cn(e){return e.max-e.min}function t2(e,t=0,r=.01){return Math.abs(e-t)<=r}function XM(e,t,r,i=.5){e.origin=i,e.originPoint=sr(t.min,t.max,e.origin),e.scale=Cn(r)/Cn(t),(t2(e.scale,1,1e-4)||isNaN(e.scale))&&(e.scale=1),e.translate=sr(r.min,r.max,e.origin)-e.originPoint,(t2(e.translate)||isNaN(e.translate))&&(e.translate=0)}function qp(e,t,r,i){XM(e.x,t.x,r.x,i?i.originX:void 0),XM(e.y,t.y,r.y,i?i.originY:void 0)}function YM(e,t,r){e.min=r.min+t.min,e.max=e.min+Cn(t)}function uV(e,t,r){YM(e.x,t.x,r.x),YM(e.y,t.y,r.y)}function QM(e,t,r){e.min=t.min-r.min,e.max=e.min+Cn(t)}function Xp(e,t,r){QM(e.x,t.x,r.x),QM(e.y,t.y,r.y)}function dV(e,{min:t,max:r},i){return t!==void 0&&e<t?e=i?sr(t,e,i.min):Math.max(e,t):r!==void 0&&e>r&&(e=i?sr(r,e,i.max):Math.min(e,r)),e}function KM(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function pV(e,{top:t,left:r,bottom:i,right:n}){return{x:KM(e.x,r,n),y:KM(e.y,t,i)}}function ZM(e,t){let r=t.min-e.min,i=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,i]=[i,r]),{min:r,max:i}}function fV(e,t){return{x:ZM(e.x,t.x),y:ZM(e.y,t.y)}}function mV(e,t){let r=.5;const i=Cn(e),n=Cn(t);return n>i?r=Uu(t.min,t.max-i,e.min):i>n&&(r=Uu(e.min,e.max-n,t.min)),bl(0,1,r)}function gV(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const r2=.35;function vV(e=r2){return e===!1?e=0:e===!0&&(e=r2),{x:$M(e,"left","right"),y:$M(e,"top","bottom")}}function $M(e,t,r){return{min:JM(e,t),max:JM(e,r)}}function JM(e,t){return typeof e=="number"?e:e[t]||0}const eE=()=>({translate:0,scale:1,origin:0,originPoint:0}),Zh=()=>({x:eE(),y:eE()}),tE=()=>({min:0,max:0}),Tr=()=>({x:tE(),y:tE()});function Qs(e){return[e("x"),e("y")]}function kO({top:e,left:t,right:r,bottom:i}){return{x:{min:t,max:r},y:{min:e,max:i}}}function yV({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function xV(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),i=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:i.y,right:i.x}}function J1(e){return e===void 0||e===1}function i2({scale:e,scaleX:t,scaleY:r}){return!J1(e)||!J1(t)||!J1(r)}function Yl(e){return i2(e)||NO(e)||e.z||e.rotate||e.rotateX||e.rotateY}function NO(e){return rE(e.x)||rE(e.y)}function rE(e){return e&&e!=="0%"}function m0(e,t,r){const i=e-r,n=t*i;return r+n}function iE(e,t,r,i,n){return n!==void 0&&(e=m0(e,n,i)),m0(e,r,i)+t}function n2(e,t=0,r=1,i,n){e.min=iE(e.min,t,r,i,n),e.max=iE(e.max,t,r,i,n)}function FO(e,{x:t,y:r}){n2(e.x,t.translate,t.scale,t.originPoint),n2(e.y,r.translate,r.scale,r.originPoint)}function wV(e,t,r,i=!1){const n=r.length;if(!n)return;t.x=t.y=1;let s,a;for(let o=0;o<n;o++){s=r[o],a=s.projectionDelta;const l=s.instance;l&&l.style&&l.style.display==="contents"||(i&&s.options.layoutScroll&&s.scroll&&s!==s.root&&$h(e,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),a&&(t.x*=a.x.scale,t.y*=a.y.scale,FO(e,a)),i&&Yl(s.latestValues)&&$h(e,s.latestValues))}t.x=nE(t.x),t.y=nE(t.y)}function nE(e){return Number.isInteger(e)||e>1.0000000000001||e<.999999999999?e:1}function Fo(e,t){e.min=e.min+t,e.max=e.max+t}function sE(e,t,[r,i,n]){const s=t[n]!==void 0?t[n]:.5,a=sr(e.min,e.max,s);n2(e,t[r],t[i],a,t.scale)}const bV=["x","scaleX","originX"],_V=["y","scaleY","originY"];function $h(e,t){sE(e.x,t,bV),sE(e.y,t,_V)}function UO(e,t){return kO(xV(e.getBoundingClientRect(),t))}function SV(e,t,r){const i=UO(e,r),{scroll:n}=t;return n&&(Fo(i.x,n.offset.x),Fo(i.y,n.offset.y)),i}const AV=new WeakMap;class CV{constructor(t){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Tr(),this.visualElement=t}start(t,{snapToCursor:r=!1}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const n=l=>{this.stopAnimation(),r&&this.snapToCursor(By(l,"page").point)},s=(l,c)=>{const{drag:u,dragPropagation:h,onDragStart:d}=this.getProps();if(u&&!h&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=JI(u),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Qs(f=>{let m=this.getAxisMotionValue(f).get()||0;if(ha.test(m)){const{projection:g}=this.visualElement;if(g&&g.layout){const v=g.layout.layoutBox[f];v&&(m=Cn(v)*(parseFloat(m)/100))}}this.originPoint[f]=m}),d&&Ft.update(()=>d(l,c),!1,!0);const{animationState:p}=this.visualElement;p&&p.setActive("whileDrag",!0)},a=(l,c)=>{const{dragPropagation:u,dragDirectionLock:h,onDirectionLock:d,onDrag:p}=this.getProps();if(!u&&!this.openGlobalLock)return;const{offset:f}=c;if(h&&this.currentDirection===null){this.currentDirection=MV(f),this.currentDirection!==null&&d&&d(this.currentDirection);return}this.updateAxis("x",c.point,f),this.updateAxis("y",c.point,f),this.visualElement.render(),p&&p(l,c)},o=(l,c)=>this.stop(l,c);this.panSession=new BO(t,{onSessionStart:n,onStart:s,onMove:a,onSessionEnd:o},{transformPagePoint:this.visualElement.getTransformPagePoint()})}stop(t,r){const i=this.isDragging;if(this.cancel(),!i)return;const{velocity:n}=r;this.startAnimation(n);const{onDragEnd:s}=this.getProps();s&&Ft.update(()=>s(t,r))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:i}=this.getProps();!i&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,i){const{drag:n}=this.getProps();if(!i||!Gm(t,n,this.currentDirection))return;const s=this.getAxisMotionValue(t);let a=this.originPoint[t]+i[t];this.constraints&&this.constraints[t]&&(a=dV(a,this.constraints[t],this.elastic[t])),s.set(a)}resolveConstraints(){const{dragConstraints:t,dragElastic:r}=this.getProps(),{layout:i}=this.visualElement.projection||{},n=this.constraints;t&&Qh(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&i?this.constraints=pV(i.layoutBox,t):this.constraints=!1,this.elastic=vV(r),n!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&Qs(s=>{this.getAxisMotionValue(s)&&(this.constraints[s]=gV(i.layoutBox[s],this.constraints[s]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!Qh(t))return!1;const i=t.current,{projection:n}=this.visualElement;if(!n||!n.layout)return!1;const s=SV(i,n.root,this.visualElement.getTransformPagePoint());let a=fV(n.layout.layoutBox,s);if(r){const o=r(yV(a));this.hasMutatedConstraints=!!o,o&&(a=kO(o))}return a}startAnimation(t){const{drag:r,dragMomentum:i,dragElastic:n,dragTransition:s,dragSnapToOrigin:a,onDragTransitionEnd:o}=this.getProps(),l=this.constraints||{},c=Qs(u=>{if(!Gm(u,r,this.currentDirection))return;let h=l&&l[u]||{};a&&(h={min:0,max:0});const d=n?200:1e6,p=n?40:1e7,f={type:"inertia",velocity:i?t[u]:0,bounceStiffness:d,bounceDamping:p,timeConstant:750,restDelta:1,restSpeed:10,...s,...h};return this.startAxisValueAnimation(u,f)});return Promise.all(c).then(o)}startAxisValueAnimation(t,r){const i=this.getAxisMotionValue(t);return i.start(f3(t,i,0,r))}stopAnimation(){Qs(t=>this.getAxisMotionValue(t).stop())}getAxisMotionValue(t){const r="_drag"+t.toUpperCase(),i=this.visualElement.getProps(),n=i[r];return n||this.visualElement.getValue(t,(i.initial?i.initial[t]:void 0)||0)}snapToCursor(t){Qs(r=>{const{drag:i}=this.getProps();if(!Gm(r,i,this.currentDirection))return;const{projection:n}=this.visualElement,s=this.getAxisMotionValue(r);if(n&&n.layout){const{min:a,max:o}=n.layout.layoutBox[r];s.set(t[r]-sr(a,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:i}=this.visualElement;if(!Qh(r)||!i||!this.constraints)return;this.stopAnimation();const n={x:0,y:0};Qs(a=>{const o=this.getAxisMotionValue(a);if(o){const l=o.get();n[a]=mV({min:l,max:l},this.constraints[a])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),Qs(a=>{if(!Gm(a,t,null))return;const o=this.getAxisMotionValue(a),{min:l,max:c}=this.constraints[a];o.set(sr(l,c,n[a]))})}addListeners(){if(!this.visualElement.current)return;AV.set(this.visualElement,this);const t=this.visualElement.current,r=to(t,"pointerdown",l=>{const{drag:c,dragListener:u=!0}=this.getProps();c&&u&&this.start(l)}),i=()=>{const{dragConstraints:l}=this.getProps();Qh(l)&&(this.constraints=this.resolveRefConstraints())},{projection:n}=this.visualElement,s=n.addEventListener("measure",i);n&&!n.layout&&(n.root&&n.root.updateScroll(),n.updateLayout()),i();const a=Ka(window,"resize",()=>this.scalePositionWithinConstraints()),o=n.addEventListener("didUpdate",({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(Qs(u=>{const h=this.getAxisMotionValue(u);h&&(this.originPoint[u]+=l[u].translate,h.set(h.get()+l[u].translate))}),this.visualElement.render())});return()=>{a(),r(),s(),o&&o()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:i=!1,dragPropagation:n=!1,dragConstraints:s=!1,dragElastic:a=r2,dragMomentum:o=!0}=t;return{...t,drag:r,dragDirectionLock:i,dragPropagation:n,dragConstraints:s,dragElastic:a,dragMomentum:o}}}function Gm(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function MV(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class EV extends Dl{constructor(t){super(t),this.removeGroupControls=pr,this.removeListeners=pr,this.controls=new CV(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||pr}unmount(){this.removeGroupControls(),this.removeListeners()}}const aE=e=>(t,r)=>{e&&Ft.update(()=>e(t,r))};class TV extends Dl{constructor(){super(...arguments),this.removePointerDownListener=pr}onPointerDown(t){this.session=new BO(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint()})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:i,onPanEnd:n}=this.node.getProps();return{onSessionStart:aE(t),onStart:aE(r),onMove:i,onEnd:(s,a)=>{delete this.session,n&&Ft.update(()=>n(s,a))}}}mount(){this.removePointerDownListener=to(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function PV(){const e=ne.useContext(ZS);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:i}=e,n=ne.useId();return ne.useEffect(()=>i(n),[]),!t&&r?[!1,()=>r&&r(n)]:[!0]}const _v={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function oE(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const Ud={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(at.test(e))e=parseFloat(e);else return e;const r=oE(e,t.target.x),i=oE(e,t.target.y);return`${r}% ${i}%`}},DV={correct:(e,{treeScale:t,projectionDelta:r})=>{const i=e,n=_l.parse(e);if(n.length>5)return i;const s=_l.createTransformer(e),a=typeof n[0]!="number"?1:0,o=r.x.scale*t.x,l=r.y.scale*t.y;n[0+a]/=o,n[1+a]/=l;const c=sr(o,l,.5);return typeof n[2+a]=="number"&&(n[2+a]/=c),typeof n[3+a]=="number"&&(n[3+a]/=c),s(n)}};class LV extends Yn.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:i,layoutId:n}=this.props,{projection:s}=t;UF(IV),s&&(r.group&&r.group.add(s),i&&i.register&&n&&i.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),_v.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:i,drag:n,isPresent:s}=this.props,a=i.projection;return a&&(a.isPresent=s,n||t.layoutDependency!==r||r===void 0?a.willUpdate():this.safeToRemove(),t.isPresent!==s&&(s?a.promote():a.relegate()||Ft.postRender(()=>{const o=a.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),queueMicrotask(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:i}=this.props,{projection:n}=t;n&&(n.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(n),i&&i.deregister&&i.deregister(n))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function jO(e){const[t,r]=PV(),i=ne.useContext(BI);return Yn.createElement(LV,{...e,layoutGroup:i,switchLayoutGroup:ne.useContext(zI),isPresent:t,safeToRemove:r})}const IV={borderRadius:{...Ud,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Ud,borderTopRightRadius:Ud,borderBottomLeftRadius:Ud,borderBottomRightRadius:Ud,boxShadow:DV},VO=["TopLeft","TopRight","BottomLeft","BottomRight"],OV=VO.length,lE=e=>typeof e=="string"?parseFloat(e):e,cE=e=>typeof e=="number"||at.test(e);function RV(e,t,r,i,n,s){n?(e.opacity=sr(0,r.opacity!==void 0?r.opacity:1,BV(i)),e.opacityExit=sr(t.opacity!==void 0?t.opacity:1,0,zV(i))):s&&(e.opacity=sr(t.opacity!==void 0?t.opacity:1,r.opacity!==void 0?r.opacity:1,i));for(let a=0;a<OV;a++){const o=`border${VO[a]}Radius`;let l=hE(t,o),c=hE(r,o);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||cE(l)===cE(c)?(e[o]=Math.max(sr(lE(l),lE(c),i),0),(ha.test(c)||ha.test(l))&&(e[o]+="%")):e[o]=c}(t.rotate||r.rotate)&&(e.rotate=sr(t.rotate||0,r.rotate||0,i))}function hE(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const BV=HO(0,.5,l3),zV=HO(.5,.95,pr);function HO(e,t,r){return i=>i<e?0:i>t?1:r(Uu(e,t,i))}function uE(e,t){e.min=t.min,e.max=t.max}function Dn(e,t){uE(e.x,t.x),uE(e.y,t.y)}function dE(e,t,r,i,n){return e-=t,e=m0(e,1/r,i),n!==void 0&&(e=m0(e,1/n,i)),e}function kV(e,t=0,r=1,i=.5,n,s=e,a=e){if(ha.test(t)&&(t=parseFloat(t),t=sr(a.min,a.max,t/100)-a.min),typeof t!="number")return;let o=sr(s.min,s.max,i);e===s&&(o-=t),e.min=dE(e.min,t,r,o,n),e.max=dE(e.max,t,r,o,n)}function pE(e,t,[r,i,n],s,a){kV(e,t[r],t[i],t[n],t.scale,s,a)}const NV=["x","scaleX","originX"],FV=["y","scaleY","originY"];function fE(e,t,r,i){pE(e.x,t,NV,r?r.x:void 0,i?i.x:void 0),pE(e.y,t,FV,r?r.y:void 0,i?i.y:void 0)}function mE(e){return e.translate===0&&e.scale===1}function GO(e){return mE(e.x)&&mE(e.y)}function UV(e,t){return e.x.min===t.x.min&&e.x.max===t.x.max&&e.y.min===t.y.min&&e.y.max===t.y.max}function WO(e,t){return Math.round(e.x.min)===Math.round(t.x.min)&&Math.round(e.x.max)===Math.round(t.x.max)&&Math.round(e.y.min)===Math.round(t.y.min)&&Math.round(e.y.max)===Math.round(t.y.max)}function gE(e){return Cn(e.x)/Cn(e.y)}class jV{constructor(){this.members=[]}add(t){m3(this.members,t),t.scheduleRender()}remove(t){if(g3(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(n=>t===n);if(r===0)return!1;let i;for(let n=r;n>=0;n--){const s=this.members[n];if(s.isPresent!==!1){i=s;break}}return i?(this.promote(i),!0):!1}promote(t,r){const i=this.lead;if(t!==i&&(this.prevLead=i,this.lead=t,t.show(),i)){i.instance&&i.scheduleRender(),t.scheduleRender(),t.resumeFrom=i,r&&(t.resumeFrom.preserveOpacity=!0),i.snapshot&&(t.snapshot=i.snapshot,t.snapshot.latestValues=i.animationValues||i.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:n}=t.options;n===!1&&i.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:i}=t;r.onExitComplete&&r.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function vE(e,t,r){let i="";const n=e.x.translate/t.x,s=e.y.translate/t.y;if((n||s)&&(i=`translate3d(${n}px, ${s}px, 0) `),(t.x!==1||t.y!==1)&&(i+=`scale(${1/t.x}, ${1/t.y}) `),r){const{rotate:l,rotateX:c,rotateY:u}=r;l&&(i+=`rotate(${l}deg) `),c&&(i+=`rotateX(${c}deg) `),u&&(i+=`rotateY(${u}deg) `)}const a=e.x.scale*t.x,o=e.y.scale*t.y;return(a!==1||o!==1)&&(i+=`scale(${a}, ${o})`),i||"none"}const VV=(e,t)=>e.depth-t.depth;class HV{constructor(){this.children=[],this.isDirty=!1}add(t){m3(this.children,t),this.isDirty=!0}remove(t){g3(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(VV),this.isDirty=!1,this.children.forEach(t)}}function GV(e,t){const r=performance.now(),i=({timestamp:n})=>{const s=n-r;s>=t&&(pa(i),e(s-t))};return Ft.read(i,!0),()=>pa(i)}function WV(e){window.MotionDebug&&window.MotionDebug.record(e)}function qV(e){return e instanceof SVGElement&&e.tagName!=="svg"}function XV(e,t,r){const i=sn(e)?e:sa(e);return i.start(f3("",i,t,r)),i.animation}const yE=["","X","Y","Z"],xE=1e3;let YV=0;const Ql={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function qO({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:i,resetTransform:n}){return class{constructor(a={},o=t==null?void 0:t()){this.id=YV++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{Ql.totalNodes=Ql.resolvedTargetDeltas=Ql.recalculatedProjection=0,this.nodes.forEach(ZV),this.nodes.forEach(rH),this.nodes.forEach(iH),this.nodes.forEach($V),WV(Ql)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new HV)}addEventListener(a,o){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new v3),this.eventHandlers.get(a).add(o)}notifyListeners(a,...o){const l=this.eventHandlers.get(a);l&&l.notify(...o)}hasListeners(a){return this.eventHandlers.has(a)}mount(a,o=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=qV(a),this.instance=a;const{layoutId:l,layout:c,visualElement:u}=this.options;if(u&&!u.current&&u.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),o&&(c||l)&&(this.isLayoutDirty=!0),e){let h;const d=()=>this.root.updateBlockedByResize=!1;e(a,()=>{this.root.updateBlockedByResize=!0,h&&h(),h=GV(d,250),_v.hasAnimatedSinceResize&&(_v.hasAnimatedSinceResize=!1,this.nodes.forEach(bE))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&u&&(l||c)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:d,hasRelativeTargetChanged:p,layout:f})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const m=this.options.transition||u.getDefaultTransition()||lH,{onLayoutAnimationStart:g,onLayoutAnimationComplete:v}=u.getProps(),y=!this.targetLayout||!WO(this.targetLayout,f)||p,x=!d&&p;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||x||d&&(y||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(h,x);const w={...DO(m,"layout"),onPlay:g,onComplete:v};(u.shouldReduceMotion||this.options.layoutRoot)&&(w.delay=0,w.type=!1),this.startAnimation(w)}else d||bE(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=f})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,pa(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(nH),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const h=this.path[u];h.shouldResetTransform=!0,h.updateScroll("snapshot"),h.options.layoutRoot&&h.willUpdate(!1)}const{layoutId:o,layout:l}=this.options;if(o===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(wE);return}this.isUpdating||this.nodes.forEach(eH),this.isUpdating=!1,this.nodes.forEach(tH),this.nodes.forEach(QV),this.nodes.forEach(KV),this.clearAllSnapshots();const o=performance.now();kr.delta=bl(0,1e3/60,o-kr.timestamp),kr.timestamp=o,kr.isProcessing=!0,H1.update.process(kr),H1.preRender.process(kr),H1.render.process(kr),kr.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(JV),this.sharedNodes.forEach(sH)}scheduleUpdateProjection(){Ft.preRender(this.updateProjection,!1,!0)}scheduleCheckAfterUnmount(){Ft.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Tr(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let o=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(o=!1),o&&(this.scroll={animationId:this.root.animationId,phase:a,isRoot:i(this.instance),offset:r(this.instance)})}resetTransform(){if(!n)return;const a=this.isLayoutDirty||this.shouldResetTransform,o=this.projectionDelta&&!GO(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,u=c!==this.prevTransformTemplateValue;a&&(o||Yl(this.latestValues)||u)&&(n(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const o=this.measurePageBox();let l=this.removeElementScroll(o);return a&&(l=this.removeTransform(l)),cH(l),{animationId:this.root.animationId,measuredBox:o,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:a}=this.options;if(!a)return Tr();const o=a.measureViewportBox(),{scroll:l}=this.root;return l&&(Fo(o.x,l.offset.x),Fo(o.y,l.offset.y)),o}removeElementScroll(a){const o=Tr();Dn(o,a);for(let l=0;l<this.path.length;l++){const c=this.path[l],{scroll:u,options:h}=c;if(c!==this.root&&u&&h.layoutScroll){if(u.isRoot){Dn(o,a);const{scroll:d}=this.root;d&&(Fo(o.x,-d.offset.x),Fo(o.y,-d.offset.y))}Fo(o.x,u.offset.x),Fo(o.y,u.offset.y)}}return o}applyTransform(a,o=!1){const l=Tr();Dn(l,a);for(let c=0;c<this.path.length;c++){const u=this.path[c];!o&&u.options.layoutScroll&&u.scroll&&u!==u.root&&$h(l,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),Yl(u.latestValues)&&$h(l,u.latestValues)}return Yl(this.latestValues)&&$h(l,this.latestValues),l}removeTransform(a){const o=Tr();Dn(o,a);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!Yl(c.latestValues))continue;i2(c.latestValues)&&c.updateSnapshot();const u=Tr(),h=c.measurePageBox();Dn(u,h),fE(o,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,u)}return Yl(this.latestValues)&&fE(o,this.latestValues),o}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==kr.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var o;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==l;if(!(a||c&&this.isSharedProjectionDirty||this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:h,layoutId:d}=this.options;if(!(!this.layout||!(h||d))){if(this.resolvedRelativeTargetAt=kr.timestamp,!this.targetDelta&&!this.relativeTarget){const p=this.getClosestProjectingParent();p&&p.layout&&this.animationProgress!==1?(this.relativeParent=p,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Tr(),this.relativeTargetOrigin=Tr(),Xp(this.relativeTargetOrigin,this.layout.layoutBox,p.layout.layoutBox),Dn(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Tr(),this.targetWithTransforms=Tr()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),uV(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Dn(this.target,this.layout.layoutBox),FO(this.target,this.targetDelta)):Dn(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const p=this.getClosestProjectingParent();p&&!!p.resumingFrom==!!this.resumingFrom&&!p.options.layoutScroll&&p.target&&this.animationProgress!==1?(this.relativeParent=p,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Tr(),this.relativeTargetOrigin=Tr(),Xp(this.relativeTargetOrigin,this.target,p.target),Dn(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Ql.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||i2(this.parent.latestValues)||NO(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var a;const o=this.getLead(),l=!!this.resumingFrom||this!==o;let c=!0;if((this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===kr.timestamp&&(c=!1),c)return;const{layout:u,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||h))return;Dn(this.layoutCorrected,this.layout.layoutBox);const d=this.treeScale.x,p=this.treeScale.y;wV(this.layoutCorrected,this.treeScale,this.path,l),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox);const{target:f}=o;if(!f){this.projectionTransform&&(this.projectionDelta=Zh(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=Zh(),this.projectionDeltaWithTransform=Zh());const m=this.projectionTransform;qp(this.projectionDelta,this.layoutCorrected,f,this.latestValues),this.projectionTransform=vE(this.projectionDelta,this.treeScale),(this.projectionTransform!==m||this.treeScale.x!==d||this.treeScale.y!==p)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",f)),Ql.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),a){const o=this.getStack();o&&o.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(a,o=!1){const l=this.snapshot,c=l?l.latestValues:{},u={...this.latestValues},h=Zh();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const d=Tr(),p=l?l.source:void 0,f=this.layout?this.layout.source:void 0,m=p!==f,g=this.getStack(),v=!g||g.members.length<=1,y=!!(m&&!v&&this.options.crossfade===!0&&!this.path.some(oH));this.animationProgress=0;let x;this.mixTargetDelta=w=>{const b=w/1e3;_E(h.x,a.x,b),_E(h.y,a.y,b),this.setTargetDelta(h),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Xp(d,this.layout.layoutBox,this.relativeParent.layout.layoutBox),aH(this.relativeTarget,this.relativeTargetOrigin,d,b),x&&UV(this.relativeTarget,x)&&(this.isProjectionDirty=!1),x||(x=Tr()),Dn(x,this.relativeTarget)),m&&(this.animationValues=u,RV(u,c,this.latestValues,b,y,v)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=b},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(pa(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Ft.update(()=>{_v.hasAnimatedSinceResize=!0,this.currentAnimation=XV(0,xE,{...a,onUpdate:o=>{this.mixTargetDelta(o),a.onUpdate&&a.onUpdate(o)},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(xE),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:o,target:l,layout:c,latestValues:u}=a;if(!(!o||!l||!c)){if(this!==a&&this.layout&&c&&XO(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||Tr();const h=Cn(this.layout.layoutBox.x);l.x.min=a.target.x.min,l.x.max=l.x.min+h;const d=Cn(this.layout.layoutBox.y);l.y.min=a.target.y.min,l.y.max=l.y.min+d}Dn(o,l),$h(o,u),qp(this.projectionDeltaWithTransform,this.layoutCorrected,o,u)}}registerSharedNode(a,o){this.sharedNodes.has(a)||this.sharedNodes.set(a,new jV),this.sharedNodes.get(a).add(o);const c=o.options.initialPromotionConfig;o.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(o):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var a;const{layoutId:o}=this.options;return o?((a=this.getStack())===null||a===void 0?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:o}=this.options;return o?(a=this.getStack())===null||a===void 0?void 0:a.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:o,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),a&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetRotation(){const{visualElement:a}=this.options;if(!a)return;let o=!1;const{latestValues:l}=a;if((l.rotate||l.rotateX||l.rotateY||l.rotateZ)&&(o=!0),!o)return;const c={};for(let u=0;u<yE.length;u++){const h="rotate"+yE[u];l[h]&&(c[h]=l[h],a.setStaticValue(h,0))}a.render();for(const u in c)a.setStaticValue(u,c[u]);a.scheduleRender()}getProjectionStyles(a={}){var o,l;const c={};if(!this.instance||this.isSVG)return c;if(this.isVisible)c.visibility="";else return{visibility:"hidden"};const u=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,c.opacity="",c.pointerEvents=bv(a.pointerEvents)||"",c.transform=u?u(this.latestValues,""):"none",c;const h=this.getLead();if(!this.projectionDelta||!this.layout||!h.target){const m={};return this.options.layoutId&&(m.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,m.pointerEvents=bv(a.pointerEvents)||""),this.hasProjected&&!Yl(this.latestValues)&&(m.transform=u?u({},""):"none",this.hasProjected=!1),m}const d=h.animationValues||h.latestValues;this.applyTransformsToTarget(),c.transform=vE(this.projectionDeltaWithTransform,this.treeScale,d),u&&(c.transform=u(d,c.transform));const{x:p,y:f}=this.projectionDelta;c.transformOrigin=`${p.origin*100}% ${f.origin*100}% 0`,h.animationValues?c.opacity=h===this?(l=(o=d.opacity)!==null&&o!==void 0?o:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:d.opacityExit:c.opacity=h===this?d.opacity!==void 0?d.opacity:"":d.opacityExit!==void 0?d.opacityExit:0;for(const m in l0){if(d[m]===void 0)continue;const{correct:g,applyTo:v}=l0[m],y=c.transform==="none"?d[m]:g(d[m],h);if(v){const x=v.length;for(let w=0;w<x;w++)c[v[w]]=y}else c[m]=y}return this.options.layoutId&&(c.pointerEvents=h===this?bv(a.pointerEvents)||"":"none"),c}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var o;return(o=a.currentAnimation)===null||o===void 0?void 0:o.stop()}),this.root.nodes.forEach(wE),this.root.sharedNodes.clear()}}}function QV(e){e.updateLayout()}function KV(e){var t;const r=((t=e.resumeFrom)===null||t===void 0?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&r&&e.hasListeners("didUpdate")){const{layoutBox:i,measuredBox:n}=e.layout,{animationType:s}=e.options,a=r.source!==e.layout.source;s==="size"?Qs(h=>{const d=a?r.measuredBox[h]:r.layoutBox[h],p=Cn(d);d.min=i[h].min,d.max=d.min+p}):XO(s,r.layoutBox,i)&&Qs(h=>{const d=a?r.measuredBox[h]:r.layoutBox[h],p=Cn(i[h]);d.max=d.min+p,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[h].max=e.relativeTarget[h].min+p)});const o=Zh();qp(o,i,r.layoutBox);const l=Zh();a?qp(l,e.applyTransform(n,!0),r.measuredBox):qp(l,i,r.layoutBox);const c=!GO(o);let u=!1;if(!e.resumeFrom){const h=e.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:d,layout:p}=h;if(d&&p){const f=Tr();Xp(f,r.layoutBox,d.layoutBox);const m=Tr();Xp(m,i,p.layoutBox),WO(f,m)||(u=!0),h.options.layoutRoot&&(e.relativeTarget=m,e.relativeTargetOrigin=f,e.relativeParent=h)}}}e.notifyListeners("didUpdate",{layout:i,snapshot:r,delta:l,layoutDelta:o,hasLayoutChanged:c,hasRelativeTargetChanged:u})}else if(e.isLead()){const{onExitComplete:i}=e.options;i&&i()}e.options.transition=void 0}function ZV(e){Ql.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function $V(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function JV(e){e.clearSnapshot()}function wE(e){e.clearMeasurements()}function eH(e){e.isLayoutDirty=!1}function tH(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function bE(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function rH(e){e.resolveTargetDelta()}function iH(e){e.calcProjection()}function nH(e){e.resetRotation()}function sH(e){e.removeLeadSnapshot()}function _E(e,t,r){e.translate=sr(t.translate,0,r),e.scale=sr(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function SE(e,t,r,i){e.min=sr(t.min,r.min,i),e.max=sr(t.max,r.max,i)}function aH(e,t,r,i){SE(e.x,t.x,r.x,i),SE(e.y,t.y,r.y,i)}function oH(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const lH={duration:.45,ease:[.4,0,.1,1]},AE=e=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(e),CE=AE("applewebkit/")&&!AE("chrome/")?Math.round:pr;function ME(e){e.min=CE(e.min),e.max=CE(e.max)}function cH(e){ME(e.x),ME(e.y)}function XO(e,t,r){return e==="position"||e==="preserve-aspect"&&!t2(gE(t),gE(r),.2)}const hH=qO({attachResizeListener:(e,t)=>Ka(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),ex={current:void 0},YO=qO({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!ex.current){const e=new hH({});e.mount(window),e.setOptions({layoutScroll:!0}),ex.current=e}return ex.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),uH={pan:{Feature:TV},drag:{Feature:EV,ProjectionNode:YO,MeasureLayout:jO}},dH=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function pH(e){const t=dH.exec(e);if(!t)return[,];const[,r,i]=t;return[r,i]}function s2(e,t,r=1){const[i,n]=pH(e);if(!i)return;const s=window.getComputedStyle(t).getPropertyValue(i);if(s){const a=s.trim();return LO(a)?parseFloat(a):a}else return Yb(n)?s2(n,t,r+1):n}function fH(e,{...t},r){const i=e.current;if(!(i instanceof Element))return{target:t,transitionEnd:r};r&&(r={...r}),e.values.forEach(n=>{const s=n.get();if(!Yb(s))return;const a=s2(s,i);a&&n.set(a)});for(const n in t){const s=t[n];if(!Yb(s))continue;const a=s2(s,i);a&&(t[n]=a,r||(r={}),r[n]===void 0&&(r[n]=s))}return{target:t,transitionEnd:r}}const mH=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),QO=e=>mH.has(e),gH=e=>Object.keys(e).some(QO),EE=e=>e===Hc||e===at,TE=(e,t)=>parseFloat(e.split(", ")[t]),PE=(e,t)=>(r,{transform:i})=>{if(i==="none"||!i)return 0;const n=i.match(/^matrix3d\((.+)\)$/);if(n)return TE(n[1],t);{const s=i.match(/^matrix\((.+)\)$/);return s?TE(s[1],e):0}},vH=new Set(["x","y","z"]),yH=sm.filter(e=>!vH.has(e));function xH(e){const t=[];return yH.forEach(r=>{const i=e.getValue(r);i!==void 0&&(t.push([r,i.get()]),i.set(r.startsWith("scale")?1:0))}),t.length&&e.render(),t}const ju={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:PE(4,13),y:PE(5,14)};ju.translateX=ju.x;ju.translateY=ju.y;const wH=(e,t,r)=>{const i=t.measureViewportBox(),n=t.current,s=getComputedStyle(n),{display:a}=s,o={};a==="none"&&t.setStaticValue("display",e.display||"block"),r.forEach(c=>{o[c]=ju[c](i,s)}),t.render();const l=t.measureViewportBox();return r.forEach(c=>{const u=t.getValue(c);u&&u.jump(o[c]),e[c]=ju[c](l,s)}),e},bH=(e,t,r={},i={})=>{t={...t},i={...i};const n=Object.keys(t).filter(QO);let s=[],a=!1;const o=[];if(n.forEach(l=>{const c=e.getValue(l);if(!e.hasValue(l))return;let u=r[l],h=Fd(u);const d=t[l];let p;if(h0(d)){const f=d.length,m=d[0]===null?1:0;u=d[m],h=Fd(u);for(let g=m;g<f&&d[g]!==null;g++)p?ky(Fd(d[g])===p):p=Fd(d[g])}else p=Fd(d);if(h!==p)if(EE(h)&&EE(p)){const f=c.get();typeof f=="string"&&c.set(parseFloat(f)),typeof d=="string"?t[l]=parseFloat(d):Array.isArray(d)&&p===at&&(t[l]=d.map(parseFloat))}else h!=null&&h.transform&&(p!=null&&p.transform)&&(u===0||d===0)?u===0?c.set(p.transform(u)):t[l]=h.transform(d):(a||(s=xH(e),a=!0),o.push(l),i[l]=i[l]!==void 0?i[l]:t[l],c.jump(d))}),o.length){const l=o.indexOf("height")>=0?window.pageYOffset:null,c=wH(t,e,o);return s.length&&s.forEach(([u,h])=>{e.getValue(u).set(h)}),e.render(),Ly&&l!==null&&window.scrollTo({top:l}),{target:c,transitionEnd:i}}else return{target:t,transitionEnd:i}};function _H(e,t,r,i){return gH(t)?bH(e,t,r,i):{target:t,transitionEnd:i}}const SH=(e,t,r,i)=>{const n=fH(e,t,i);return t=n.target,i=n.transitionEnd,_H(e,t,r,i)},a2={current:null},KO={current:!1};function AH(){if(KO.current=!0,!!Ly)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>a2.current=e.matches;e.addListener(t),t()}else a2.current=!1}function CH(e,t,r){const{willChange:i}=t;for(const n in t){const s=t[n],a=r[n];if(sn(s))e.addValue(n,s),f0(i)&&i.add(n);else if(sn(a))e.addValue(n,sa(s,{owner:e})),f0(i)&&i.remove(n);else if(a!==s)if(e.hasValue(n)){const o=e.getValue(n);!o.hasAnimated&&o.set(s)}else{const o=e.getStaticValue(n);e.addValue(n,sa(o!==void 0?o:s,{owner:e}))}}for(const n in r)t[n]===void 0&&e.removeValue(n);return t}const DE=new WeakMap,ZO=Object.keys(If),MH=ZO.length,LE=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],EH=JS.length;class TH{constructor({parent:t,props:r,presenceContext:i,reducedMotionConfig:n,visualState:s},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>Ft.render(this.render,!1,!0);const{latestValues:o,renderState:l}=s;this.latestValues=o,this.baseTarget={...o},this.initialValues=r.initial?{...o}:{},this.renderState=l,this.parent=t,this.props=r,this.presenceContext=i,this.depth=t?t.depth+1:0,this.reducedMotionConfig=n,this.options=a,this.isControllingVariants=Oy(r),this.isVariantNode=RI(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:c,...u}=this.scrapeMotionValuesFromProps(r,{});for(const h in u){const d=u[h];o[h]!==void 0&&sn(d)&&(d.set(o[h],!1),f0(c)&&c.add(h))}}scrapeMotionValuesFromProps(t,r){return{}}mount(t){this.current=t,DE.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,i)=>this.bindToMotionValue(i,r)),KO.current||AH(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:a2.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){DE.delete(this.current),this.projection&&this.projection.unmount(),pa(this.notifyUpdate),pa(this.render),this.valueSubscriptions.forEach(t=>t()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features)this.features[t].unmount();this.current=null}bindToMotionValue(t,r){const i=Vc.has(t),n=r.on("change",a=>{this.latestValues[t]=a,this.props.onUpdate&&Ft.update(this.notifyUpdate,!1,!0),i&&this.projection&&(this.projection.isTransformDirty=!0)}),s=r.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(t,()=>{n(),s()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}loadFeatures({children:t,...r},i,n,s){let a,o;for(let l=0;l<MH;l++){const c=ZO[l],{isEnabled:u,Feature:h,ProjectionNode:d,MeasureLayout:p}=If[c];d&&(a=d),u(r)&&(!this.features[c]&&h&&(this.features[c]=new h(this)),p&&(o=p))}if(!this.projection&&a){this.projection=new a(this.latestValues,this.parent&&this.parent.projection);const{layoutId:l,layout:c,drag:u,dragConstraints:h,layoutScroll:d,layoutRoot:p}=r;this.projection.setOptions({layoutId:l,layout:c,alwaysMeasureLayout:!!u||h&&Qh(h),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof c=="string"?c:"both",initialPromotionConfig:s,layoutScroll:d,layoutRoot:p})}return o}updateFeatures(){for(const t in this.features){const r=this.features[t];r.isMounted?r.update():(r.mount(),r.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Tr()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}makeTargetAnimatable(t,r=!0){return this.makeTargetAnimatableFromInstance(t,this.props,r)}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let i=0;i<LE.length;i++){const n=LE[i];this.propEventSubscriptions[n]&&(this.propEventSubscriptions[n](),delete this.propEventSubscriptions[n]);const s=t["on"+n];s&&(this.propEventSubscriptions[n]=this.on(n,s))}this.prevMotionValues=CH(this,this.scrapeMotionValuesFromProps(t,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(t=!1){if(t)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const i=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(i.initial=this.props.initial),i}const r={};for(let i=0;i<EH;i++){const n=JS[i],s=this.props[n];(Lf(s)||s===!1)&&(r[n]=s)}return r}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){r!==this.values.get(t)&&(this.removeValue(t),this.bindToMotionValue(t,r)),this.values.set(t,r),this.latestValues[t]=r.get()}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let i=this.values.get(t);return i===void 0&&r!==void 0&&(i=sa(r,{owner:this}),this.addValue(t,i)),i}readValue(t){var r;return this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:(r=this.getBaseTargetFromProps(this.props,t))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,t,this.options)}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){var r;const{initial:i}=this.props,n=typeof i=="string"||typeof i=="object"?(r=o3(this.props,i))===null||r===void 0?void 0:r[t]:void 0;if(i&&n!==void 0)return n;const s=this.getBaseTargetFromProps(this.props,t);return s!==void 0&&!sn(s)?s:this.initialValues[t]!==void 0&&n===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new v3),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}}class $O extends TH{sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:i}){delete r[t],delete i[t]}makeTargetAnimatableFromInstance({transition:t,transitionEnd:r,...i},{transformValues:n},s){let a=Xj(i,t||{},this);if(n&&(r&&(r=n(r)),i&&(i=n(i)),a&&(a=n(a))),s){Wj(this,i,a);const o=SH(this,i,a,r);r=o.transitionEnd,i=o.target}return{transition:t,transitionEnd:r,...i}}}function PH(e){return window.getComputedStyle(e)}class DH extends $O{readValueFromInstance(t,r){if(Vc.has(r)){const i=p3(r);return i&&i.default||0}else{const i=PH(t),n=(FI(r)?i.getPropertyValue(r):i[r])||0;return typeof n=="string"?n.trim():n}}measureInstanceViewportBox(t,{transformPagePoint:r}){return UO(t,r)}build(t,r,i,n){t3(t,r,i,n.transformTemplate)}scrapeMotionValuesFromProps(t,r){return a3(t,r)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;sn(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}renderInstance(t,r,i,n){WI(t,r,i,n)}}class LH extends $O{constructor(){super(...arguments),this.isSVGTag=!1}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(Vc.has(r)){const i=p3(r);return i&&i.default||0}return r=qI.has(r)?r:s3(r),t.getAttribute(r)}measureInstanceViewportBox(){return Tr()}scrapeMotionValuesFromProps(t,r){return YI(t,r)}build(t,r,i,n){i3(t,r,i,this.isSVGTag,n.transformTemplate)}renderInstance(t,r,i,n){XI(t,r,i,n)}mount(t){this.isSVGTag=n3(t.tagName),super.mount(t)}}const IH=(e,t)=>e3(e)?new LH(t,{enableHardwareAcceleration:!1}):new DH(t,{enableHardwareAcceleration:!0}),OH={layout:{ProjectionNode:YO,MeasureLayout:jO}},RH={...oV,...PU,...uH,...OH},Hn=NF((e,t)=>gU(e,t,RH,IH));function BH(e,t,r){ne.useInsertionEffect(()=>e.on(t,r),[e,t,r])}function zH(e,t,r){var i;if(typeof e=="string"){let n=document;t&&(ky(!!t.current),n=t.current),r?((i=r[e])!==null&&i!==void 0||(r[e]=n.querySelectorAll(e)),e=r[e]):e=n.querySelectorAll(e)}else e instanceof Element&&(e=[e]);return Array.from(e||[])}const Sv=new WeakMap;let zo;function kH(e,t){if(t){const{inlineSize:r,blockSize:i}=t[0];return{width:r,height:i}}else return e instanceof SVGElement&&"getBBox"in e?e.getBBox():{width:e.offsetWidth,height:e.offsetHeight}}function NH({target:e,contentRect:t,borderBoxSize:r}){var i;(i=Sv.get(e))===null||i===void 0||i.forEach(n=>{n({target:e,contentSize:t,get size(){return kH(e,r)}})})}function FH(e){e.forEach(NH)}function UH(){typeof ResizeObserver>"u"||(zo=new ResizeObserver(FH))}function jH(e,t){zo||UH();const r=zH(e);return r.forEach(i=>{let n=Sv.get(i);n||(n=new Set,Sv.set(i,n)),n.add(t),zo==null||zo.observe(i)}),()=>{r.forEach(i=>{const n=Sv.get(i);n==null||n.delete(t),n!=null&&n.size||zo==null||zo.unobserve(i)})}}const Av=new Set;let Yp;function VH(){Yp=()=>{const e={width:window.innerWidth,height:window.innerHeight},t={target:window,size:e,contentSize:e};Av.forEach(r=>r(t))},window.addEventListener("resize",Yp)}function HH(e){return Av.add(e),Yp||VH(),()=>{Av.delete(e),!Av.size&&Yp&&(Yp=void 0)}}function GH(e,t){return typeof e=="function"?HH(e):jH(e,t)}const WH=50,IE=()=>({current:0,offset:[],progress:0,scrollLength:0,targetOffset:0,targetLength:0,containerLength:0,velocity:0}),qH=()=>({time:0,x:IE(),y:IE()}),XH={x:{length:"Width",position:"Left"},y:{length:"Height",position:"Top"}};function OE(e,t,r,i){const n=r[t],{length:s,position:a}=XH[t],o=n.current,l=r.time;n.current=e["scroll"+a],n.scrollLength=e["scroll"+s]-e["client"+s],n.offset.length=0,n.offset[0]=0,n.offset[1]=n.scrollLength,n.progress=Uu(0,n.scrollLength,n.current);const c=i-l;n.velocity=c>WH?0:d3(n.current-o,c)}function YH(e,t,r){OE(e,"x",t,r),OE(e,"y",t,r),t.time=r}function QH(e,t){const r={x:0,y:0};let i=e;for(;i&&i!==t;)if(i instanceof HTMLElement)r.x+=i.offsetLeft,r.y+=i.offsetTop,i=i.offsetParent;else if(i.tagName==="svg"){const n=i.getBoundingClientRect();i=i.parentElement;const s=i.getBoundingClientRect();r.x+=n.left-s.left,r.y+=n.top-s.top}else if(i instanceof SVGGraphicsElement){const{x:n,y:s}=i.getBBox();r.x+=n,r.y+=s;let a=null,o=i.parentNode;for(;!a;)o.tagName==="svg"&&(a=o),o=i.parentNode;i=a}else break;return r}const KH={Enter:[[0,1],[1,1]],Exit:[[0,0],[1,0]],Any:[[1,0],[0,1]],All:[[0,0],[1,1]]},o2={start:0,center:.5,end:1};function RE(e,t,r=0){let i=0;if(o2[e]!==void 0&&(e=o2[e]),typeof e=="string"){const n=parseFloat(e);e.endsWith("px")?i=n:e.endsWith("%")?e=n/100:e.endsWith("vw")?i=n/100*document.documentElement.clientWidth:e.endsWith("vh")?i=n/100*document.documentElement.clientHeight:e=n}return typeof e=="number"&&(i=t*e),r+i}const ZH=[0,0];function $H(e,t,r,i){let n=Array.isArray(e)?e:ZH,s=0,a=0;return typeof e=="number"?n=[e,e]:typeof e=="string"&&(e=e.trim(),e.includes(" ")?n=e.split(" "):n=[e,o2[e]?e:"0"]),s=RE(n[0],r,i),a=RE(n[1],t),s-a}const JH={x:0,y:0};function eG(e){return"getBBox"in e&&e.tagName!=="svg"?e.getBBox():{width:e.clientWidth,height:e.clientHeight}}function tG(e,t,r){let{offset:i=KH.All}=r;const{target:n=e,axis:s="y"}=r,a=s==="y"?"height":"width",o=n!==e?QH(n,e):JH,l=n===e?{width:e.scrollWidth,height:e.scrollHeight}:eG(n),c={width:e.clientWidth,height:e.clientHeight};t[s].offset.length=0;let u=!t[s].interpolate;const h=i.length;for(let d=0;d<h;d++){const p=$H(i[d],c[a],l[a],o[s]);!u&&p!==t[s].interpolatorOffsets[d]&&(u=!0),t[s].offset[d]=p}u&&(t[s].interpolate=u3(t[s].offset,CO(i)),t[s].interpolatorOffsets=[...t[s].offset]),t[s].progress=t[s].interpolate(t[s].current)}function rG(e,t=e,r){if(r.x.targetOffset=0,r.y.targetOffset=0,t!==e){let i=t;for(;i&&i!==e;)r.x.targetOffset+=i.offsetLeft,r.y.targetOffset+=i.offsetTop,i=i.offsetParent}r.x.targetLength=t===e?t.scrollWidth:t.clientWidth,r.y.targetLength=t===e?t.scrollHeight:t.clientHeight,r.x.containerLength=e.clientWidth,r.y.containerLength=e.clientHeight}function iG(e,t,r,i={}){return{measure:()=>rG(e,i.target,r),update:n=>{YH(e,r,n),(i.offset||i.target)&&tG(e,r,i)},notify:()=>t(r)}}const jd=new WeakMap,BE=new WeakMap,tx=new WeakMap,zE=e=>e===document.documentElement?window:e;function nG(e,{container:t=document.documentElement,...r}={}){let i=tx.get(t);i||(i=new Set,tx.set(t,i));const n=qH(),s=iG(t,e,n,r);if(i.add(s),!jd.has(t)){const o=()=>{for(const d of i)d.measure()},l=()=>{for(const d of i)d.update(kr.timestamp)},c=()=>{for(const d of i)d.notify()},u=()=>{Ft.read(o,!1,!0),Ft.update(l,!1,!0),Ft.update(c,!1,!0)};jd.set(t,u);const h=zE(t);window.addEventListener("resize",u,{passive:!0}),t!==document.documentElement&&BE.set(t,GH(t,u)),h.addEventListener("scroll",u,{passive:!0})}const a=jd.get(t);return Ft.read(a,!1,!0),()=>{var o;pa(a);const l=tx.get(t);if(!l||(l.delete(s),l.size))return;const c=jd.get(t);jd.delete(t),c&&(zE(t).removeEventListener("scroll",c),(o=BE.get(t))===null||o===void 0||o(),window.removeEventListener("resize",c))}}function kE(e,t){iO(!!(!t||t.current))}const sG=()=>({scrollX:sa(0),scrollY:sa(0),scrollXProgress:sa(0),scrollYProgress:sa(0)});function JO({container:e,target:t,layoutEffect:r=!0,...i}={}){const n=QI(sG);return(r?II:ne.useEffect)(()=>(kE("target",t),kE("container",e),nG(({x:a,y:o})=>{n.scrollX.set(a.current),n.scrollXProgress.set(a.progress),n.scrollY.set(o.current),n.scrollYProgress.set(o.progress)},{...i,container:(e==null?void 0:e.current)||void 0,target:(t==null?void 0:t.current)||void 0})),[e,t,JSON.stringify(i.offset)]),n}const aG={initial:{opacity:0,x:-20},animate:e=>({opacity:1,x:0,transition:{delay:e*.1,duration:.1}})},oG=({children:e,content:t,parentHover:r,active:i,handleSelectActive:n,className:s=null,index:a})=>L.jsxs(Hn.div,{variants:aG,initial:"initial",whileInView:"animate",viewport:{once:!0,margin:"100px"},custom:a,onClick:()=>n(t),className:`hover:pl-7 hover:grayscale-0 hover:opacity-100 hover:text-primary-300 hover:bg-black/5 text-background-dark gap-2 flex flex-col px-4 py-4 cursor-pointer transition-all duration-500 ${i?"pl-7 border-accent-400 text-accent-400":r?"grayscale text-background-dark opacity-50":"grayscale-0 text-background-dark opacity-100 border-black/20 "}`,children:[L.jsxs("div",{className:"flex items-center justify-between w-full",children:[L.jsx("h2",{className:`transition-[font-size] ${i?"text-sm desktop:text-base text-accent-400 font-medium pr-4 hd:text-md":"desktop:text-base hd:text-md"}`,children:t.name}),L.jsx(DI,{size:32,className:`transition-[transform] duration-700 ease-in-out ${i?"rotate-[90deg] text-accent-400":"rotate-0"}`})]}),L.jsx("div",{className:`overflow-hidden text-xs desktop:text-sm hd:text-base duration-1000 text-background-dark transition-[max-height] ease-in-out ${i?"max-h-[50rem]":"max-h-0"}`,children:t.content})]}),lG=()=>{const e=[{name:"Cyber Monitoring",content:"Cyber product monitoring by trained intelligence analysts"},{name:"Global Investigations",content:"Worldwide Intellectual Property investigations"},{name:"Undercover Operations",content:"Undercover operations worldwide"},{name:"Business Intelligence Background",content:"Business Intelligence background checks"},{name:"Research",content:"Thoughtful Online Research"},{name:"Risk Assessment",content:"Risk Management assessments"},{name:"Anonymous Hosting",content:"Anonymous domain name registration and hosting services"},{name:"VPN Access",content:"Anonymous VPN internet access for our clients and the industry"},{name:"Security Assessments",content:"Enhancing protective measures systematically."}],[t,r]=ne.useState(!1),[i,n]=ne.useState(e[0]),s=a=>{if(a.name===i.name)return;const o=e.findIndex(l=>l.name==a.name);n(e[o])};return L.jsx("div",{className:"z-10 flex-1",onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),children:L.jsx("div",{className:"flex flex-col",children:e.map((a,o)=>L.jsx(oG,{index:o,content:a,parentHover:t,active:a.name==(i==null?void 0:i.name),handleSelectActive:s},o))})})},eR=({cellCount:e=0,cellClass:t})=>{const r=new Array(e);return console.log(t),r.fill(null).map((i,n)=>L.jsx("div",{className:t},n))},cG=()=>{function e(i){i.classList.contains("active")||!i||(i.classList.add("fill"),setTimeout(()=>{i.classList.remove("fill")},Math.random()*2*5e3))}const t=new Array(28),r=ne.useRef([]);return ne.useEffect(()=>{const i=setInterval(()=>{const n=r.current[Math.floor(Math.random()*25)];e(n)},5e3);return()=>clearInterval(i)},[]),L.jsxs(L.Fragment,{children:[L.jsx("div",{className:"absolute w-full h-full bg-gradient-radial from-background-dark/20 to-background-dark z-[2]"}),L.jsx("div",{className:"absolute top-0 left-0 grid w-full h-full grid-cols-7 z-[1] ",children:t.fill(null).map((i,n)=>L.jsx("div",{ref:s=>r.current[n]=s,className:"block border border-background-light/5"},n))})]})};function hG(e){return KS({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144 143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79 47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z"}}]})(e)}function uG(e){return KS({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505.12019,19.09375c-1.18945-5.53125-6.65819-11-12.207-12.1875C460.716,0,435.507,0,410.40747,0,307.17523,0,245.26909,55.20312,199.05238,128H94.83772c-16.34763.01562-35.55658,11.875-42.88664,26.48438L2.51562,253.29688A28.4,28.4,0,0,0,0,264a24.00867,24.00867,0,0,0,24.00582,24H127.81618l-22.47457,22.46875c-11.36521,11.36133-12.99607,32.25781,0,45.25L156.24582,406.625c11.15623,11.1875,32.15619,13.15625,45.27726,0l22.47457-22.46875V488a24.00867,24.00867,0,0,0,24.00581,24,28.55934,28.55934,0,0,0,10.707-2.51562l98.72834-49.39063c14.62888-7.29687,26.50776-26.5,26.50776-42.85937V312.79688c72.59753-46.3125,128.03493-108.40626,128.03493-211.09376C512.07526,76.5,512.07526,51.29688,505.12019,19.09375ZM384.04033,168A40,40,0,1,1,424.05,128,40.02322,40.02322,0,0,1,384.04033,168Z"}}]})(e)}const dG="modulepreload",pG=function(e){return"/dmrs-fe/"+e},NE={},cm=function(t,r,i){if(!r||r.length===0)return t();const n=document.getElementsByTagName("link");return Promise.all(r.map(s=>{if(s=pG(s),s in NE)return;NE[s]=!0;const a=s.endsWith(".css"),o=a?'[rel="stylesheet"]':"";if(!!i)for(let u=n.length-1;u>=0;u--){const h=n[u];if(h.href===s&&(!a||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${o}`))return;const c=document.createElement("link");if(c.rel=a?"stylesheet":dG,a||(c.as="script",c.crossOrigin=""),c.href=s,document.head.appendChild(c),a)return new Promise((u,h)=>{c.addEventListener("load",u),c.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>t()).catch(s=>{const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=s,window.dispatchEvent(a),!a.defaultPrevented)throw s})};var fG=Object.create,y3=Object.defineProperty,mG=Object.getOwnPropertyDescriptor,gG=Object.getOwnPropertyNames,vG=Object.getPrototypeOf,yG=Object.prototype.hasOwnProperty,od=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),xG=(e,t)=>{for(var r in t)y3(e,r,{get:t[r],enumerable:!0})},wG=(e,t,r,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of gG(t))!yG.call(e,n)&&n!==r&&y3(e,n,{get:()=>t[n],enumerable:!(i=mG(t,n))||i.enumerable});return e},ld=(e,t,r)=>(r=e!=null?fG(vG(e)):{},wG(t||!e||!e.__esModule?y3(r,"default",{value:e,enumerable:!0}):r,e)),bG=od((e,t)=>{(function(r,i){typeof e=="object"?t.exports=i():typeof define=="function"&&define.amd?define(i):r.Alea=i()})(e,function(){return r.importState=function(n){var s=new r;return s.importState(n),s},r;function r(){return function(n){var s=0,a=0,o=0,l=1;n.length==0&&(n=[+new Date]);var c=i();s=c(" "),a=c(" "),o=c(" ");for(var u=0;u<n.length;u++)s-=c(n[u]),s<0&&(s+=1),a-=c(n[u]),a<0&&(a+=1),o-=c(n[u]),o<0&&(o+=1);c=null;var h=function(){var d=2091639*s+l*23283064365386963e-26;return s=a,a=o,o=d-(l=d|0)};return h.next=h,h.uint32=function(){return h()*4294967296},h.fract53=function(){return h()+(h()*2097152|0)*11102230246251565e-32},h.version="Alea 0.9",h.args=n,h.exportState=function(){return[s,a,o,l]},h.importState=function(d){s=+d[0]||0,a=+d[1]||0,o=+d[2]||0,l=+d[3]||0},h}(Array.prototype.slice.call(arguments))}function i(){var n=4022871197,s=function(a){a=a.toString();for(var o=0;o<a.length;o++){n+=a.charCodeAt(o);var l=.02519603282416938*n;n=l>>>0,l-=n,l*=n,n=l>>>0,l-=n,n+=l*4294967296}return(n>>>0)*23283064365386963e-26};return s.version="Mash 0.9",s}})}),tR=od((e,t)=>{(function(r,i){typeof e=="object"&&typeof t<"u"?i(e):typeof define=="function"&&define.amd?define(["exports"],i):i((r=typeof globalThis<"u"?globalThis:r||self).SVDJS={})})(e,function(r){r.SVD=function(i,n,s,a,o){if(n=n===void 0||n,s=s===void 0||s,o=1e-64/(a=a||Math.pow(2,-52)),!i)throw new TypeError("Matrix a is not defined");var l,c,u,h,d,p,f,m,g,v,y,x,w=i[0].length,b=i.length;if(b<w)throw new TypeError("Invalid matrix: m < n");for(var _=[],A=[],S=[],C=n==="f"?b:w,M=v=f=0;M<b;M++)A[M]=new Array(C).fill(0);for(M=0;M<w;M++)S[M]=new Array(w).fill(0);var T,P=new Array(w).fill(0);for(M=0;M<b;M++)for(l=0;l<w;l++)A[M][l]=i[M][l];for(M=0;M<w;M++){for(_[M]=f,g=0,u=M+1,l=M;l<b;l++)g+=Math.pow(A[l][M],2);if(g<o)f=0;else for(m=(p=A[M][M])*(f=p<0?Math.sqrt(g):-Math.sqrt(g))-g,A[M][M]=p-f,l=u;l<w;l++){for(g=0,c=M;c<b;c++)g+=A[c][M]*A[c][l];for(p=g/m,c=M;c<b;c++)A[c][l]=A[c][l]+p*A[c][M]}for(P[M]=f,g=0,l=u;l<w;l++)g+=Math.pow(A[M][l],2);if(g<o)f=0;else{for(m=(p=A[M][M+1])*(f=p<0?Math.sqrt(g):-Math.sqrt(g))-g,A[M][M+1]=p-f,l=u;l<w;l++)_[l]=A[M][l]/m;for(l=u;l<b;l++){for(g=0,c=u;c<w;c++)g+=A[l][c]*A[M][c];for(c=u;c<w;c++)A[l][c]=A[l][c]+g*_[c]}}v<(y=Math.abs(P[M])+Math.abs(_[M]))&&(v=y)}if(s)for(M=w-1;0<=M;M--){if(f!==0){for(m=A[M][M+1]*f,l=u;l<w;l++)S[l][M]=A[M][l]/m;for(l=u;l<w;l++){for(g=0,c=u;c<w;c++)g+=A[M][c]*S[c][l];for(c=u;c<w;c++)S[c][l]=S[c][l]+g*S[c][M]}}for(l=u;l<w;l++)S[M][l]=0,S[l][M]=0;S[M][M]=1,f=_[M],u=M}if(n){if(n==="f")for(M=w;M<b;M++){for(l=w;l<b;l++)A[M][l]=0;A[M][M]=1}for(M=w-1;0<=M;M--){for(u=M+1,f=P[M],l=u;l<C;l++)A[M][l]=0;if(f!==0){for(m=A[M][M]*f,l=u;l<C;l++){for(g=0,c=u;c<b;c++)g+=A[c][M]*A[c][l];for(p=g/m,c=M;c<b;c++)A[c][l]=A[c][l]+p*A[c][M]}for(l=M;l<b;l++)A[l][M]=A[l][M]/f}else for(l=M;l<b;l++)A[l][M]=0;A[M][M]=A[M][M]+1}}for(a*=v,c=w-1;0<=c;c--)for(var D=0;D<50;D++){for(T=!1,u=c;0<=u;u--){if(Math.abs(_[u])<=a){T=!0;break}if(Math.abs(P[u-1])<=a)break}if(!T){for(d=0,h=u-(g=1),M=u;M<c+1&&(p=g*_[M],_[M]=d*_[M],!(Math.abs(p)<=a));M++)if(f=P[M],P[M]=Math.sqrt(p*p+f*f),d=f/(m=P[M]),g=-p/m,n)for(l=0;l<b;l++)y=A[l][h],x=A[l][M],A[l][h]=y*d+x*g,A[l][M]=-y*g+x*d}if(x=P[c],u===c){if(x<0&&(P[c]=-x,s))for(l=0;l<w;l++)S[l][c]=-S[l][c];break}for(v=P[u],p=(((y=P[c-1])-x)*(y+x)+((f=_[c-1])-(m=_[c]))*(f+m))/(2*m*y),f=Math.sqrt(p*p+1),p=((v-x)*(v+x)+m*(y/(p<0?p-f:p+f)-m))/v,M=u+(g=d=1);M<c+1;M++){if(f=_[M],y=P[M],m=g*f,f*=d,x=Math.sqrt(p*p+m*m),p=v*(d=p/(_[M-1]=x))+f*(g=m/x),f=-v*g+f*d,m=y*g,y*=d,s)for(l=0;l<w;l++)v=S[l][M-1],x=S[l][M],S[l][M-1]=v*d+x*g,S[l][M]=-v*g+x*d;if(x=Math.sqrt(p*p+m*m),p=(d=p/(P[M-1]=x))*f+(g=m/x)*y,v=-g*f+d*y,n)for(l=0;l<b;l++)y=A[l][M-1],x=A[l][M],A[l][M-1]=y*d+x*g,A[l][M]=-y*g+x*d}_[u]=0,_[c]=p,P[c]=v}for(M=0;M<w;M++)P[M]<a&&(P[M]=0);return{u:A,q:P,v:S}},r.VERSION="1.1.1",Object.defineProperty(r,"__esModule",{value:!0})})}),_G=od((e,t)=>{(function(r,i){typeof e=="object"&&typeof t<"u"?t.exports=i():typeof define=="function"&&define.amd?define(i):(r=r||self,r.TinyQueue=i())})(e,function(){var r=function(n,s){if(n===void 0&&(n=[]),s===void 0&&(s=i),this.data=n,this.length=this.data.length,this.compare=s,this.length>0)for(var a=(this.length>>1)-1;a>=0;a--)this._down(a)};r.prototype.push=function(n){this.data.push(n),this.length++,this._up(this.length-1)},r.prototype.pop=function(){if(this.length!==0){var n=this.data[0],s=this.data.pop();return this.length--,this.length>0&&(this.data[0]=s,this._down(0)),n}},r.prototype.peek=function(){return this.data[0]},r.prototype._up=function(n){for(var s=this,a=s.data,o=s.compare,l=a[n];n>0;){var c=n-1>>1,u=a[c];if(o(l,u)>=0)break;a[n]=u,n=c}a[n]=l},r.prototype._down=function(n){for(var s=this,a=s.data,o=s.compare,l=this.length>>1,c=a[n];n<l;){var u=(n<<1)+1,h=a[u],d=u+1;if(d<this.length&&o(a[d],h)<0&&(u=d,h=a[d]),o(h,c)>=0)break;a[n]=h,n=u}a[n]=c};function i(n,s){return n<s?-1:n>s?1:0}return r})}),SG=od((e,t)=>{var r=_G();r.default&&(r=r.default),t.exports=i,t.exports.default=i;function i(c,u,h){u=u||1;for(var d,p,f,m,g=0;g<c[0].length;g++){var v=c[0][g];(!g||v[0]<d)&&(d=v[0]),(!g||v[1]<p)&&(p=v[1]),(!g||v[0]>f)&&(f=v[0]),(!g||v[1]>m)&&(m=v[1])}var y=f-d,x=m-p,w=Math.min(y,x),b=w/2;if(w===0){var _=[d,p];return _.distance=0,_}for(var A=new r(void 0,n),S=d;S<f;S+=w)for(var C=p;C<m;C+=w)A.push(new s(S+b,C+b,b,c));var M=o(c),T=new s(d+y/2,p+x/2,0,c);T.d>M.d&&(M=T);for(var P=A.length;A.length;){var D=A.pop();D.d>M.d&&(M=D,h&&console.log("found best %d after %d probes",Math.round(1e4*D.d)/1e4,P)),!(D.max-M.d<=u)&&(b=D.h/2,A.push(new s(D.x-b,D.y-b,b,c)),A.push(new s(D.x+b,D.y-b,b,c)),A.push(new s(D.x-b,D.y+b,b,c)),A.push(new s(D.x+b,D.y+b,b,c)),P+=4)}h&&(console.log("num probes: "+P),console.log("best distance: "+M.d));var I=[M.x,M.y];return I.distance=M.d,I}function n(c,u){return u.max-c.max}function s(c,u,h,d){this.x=c,this.y=u,this.h=h,this.d=a(c,u,d),this.max=this.d+this.h*Math.SQRT2}function a(c,u,h){for(var d=!1,p=1/0,f=0;f<h.length;f++)for(var m=h[f],g=0,v=m.length,y=v-1;g<v;y=g++){var x=m[g],w=m[y];x[1]>u!=w[1]>u&&c<(w[0]-x[0])*(u-x[1])/(w[1]-x[1])+x[0]&&(d=!d),p=Math.min(p,l(c,u,x,w))}return p===0?0:(d?1:-1)*Math.sqrt(p)}function o(c){for(var u=0,h=0,d=0,p=c[0],f=0,m=p.length,g=m-1;f<m;g=f++){var v=p[f],y=p[g],x=v[0]*y[1]-y[0]*v[1];h+=(v[0]+y[0])*x,d+=(v[1]+y[1])*x,u+=x*3}return u===0?new s(p[0][0],p[0][1],0,c):new s(h/u,d/u,0,c)}function l(c,u,h,d){var p=h[0],f=h[1],m=d[0]-p,g=d[1]-f;if(m!==0||g!==0){var v=((c-p)*m+(u-f)*g)/(m*m+g*g);v>1?(p=d[0],f=d[1]):v>0&&(p+=m*v,f+=g*v)}return m=c-p,g=u-f,m*m+g*g}}),AG=od(e=>{(function(){var t=function(){this.init()};t.prototype={init:function(){var h=this||r;return h._counter=1e3,h._html5AudioPool=[],h.html5PoolSize=10,h._codecs={},h._howls=[],h._muted=!1,h._volume=1,h._canPlayEvent="canplaythrough",h._navigator=typeof window<"u"&&window.navigator?window.navigator:null,h.masterGain=null,h.noAudio=!1,h.usingWebAudio=!0,h.autoSuspend=!0,h.ctx=null,h.autoUnlock=!0,h._setup(),h},volume:function(h){var d=this||r;if(h=parseFloat(h),d.ctx||u(),typeof h<"u"&&h>=0&&h<=1){if(d._volume=h,d._muted)return d;d.usingWebAudio&&d.masterGain.gain.setValueAtTime(h,r.ctx.currentTime);for(var p=0;p<d._howls.length;p++)if(!d._howls[p]._webAudio)for(var f=d._howls[p]._getSoundIds(),m=0;m<f.length;m++){var g=d._howls[p]._soundById(f[m]);g&&g._node&&(g._node.volume=g._volume*h)}return d}return d._volume},mute:function(h){var d=this||r;d.ctx||u(),d._muted=h,d.usingWebAudio&&d.masterGain.gain.setValueAtTime(h?0:d._volume,r.ctx.currentTime);for(var p=0;p<d._howls.length;p++)if(!d._howls[p]._webAudio)for(var f=d._howls[p]._getSoundIds(),m=0;m<f.length;m++){var g=d._howls[p]._soundById(f[m]);g&&g._node&&(g._node.muted=h?!0:g._muted)}return d},stop:function(){for(var h=this||r,d=0;d<h._howls.length;d++)h._howls[d].stop();return h},unload:function(){for(var h=this||r,d=h._howls.length-1;d>=0;d--)h._howls[d].unload();return h.usingWebAudio&&h.ctx&&typeof h.ctx.close<"u"&&(h.ctx.close(),h.ctx=null,u()),h},codecs:function(h){return(this||r)._codecs[h.replace(/^x-/,"")]},_setup:function(){var h=this||r;if(h.state=h.ctx&&h.ctx.state||"suspended",h._autoSuspend(),!h.usingWebAudio)if(typeof Audio<"u")try{var d=new Audio;typeof d.oncanplaythrough>"u"&&(h._canPlayEvent="canplay")}catch{h.noAudio=!0}else h.noAudio=!0;try{var d=new Audio;d.muted&&(h.noAudio=!0)}catch{}return h.noAudio||h._setupCodecs(),h},_setupCodecs:function(){var h=this||r,d=null;try{d=typeof Audio<"u"?new Audio:null}catch{return h}if(!d||typeof d.canPlayType!="function")return h;var p=d.canPlayType("audio/mpeg;").replace(/^no$/,""),f=h._navigator?h._navigator.userAgent:"",m=f.match(/OPR\/([0-6].)/g),g=m&&parseInt(m[0].split("/")[1],10)<33,v=f.indexOf("Safari")!==-1&&f.indexOf("Chrome")===-1,y=f.match(/Version\/(.*?) /),x=v&&y&&parseInt(y[1],10)<15;return h._codecs={mp3:!!(!g&&(p||d.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!p,opus:!!d.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!d.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!d.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(d.canPlayType('audio/wav; codecs="1"')||d.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!d.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!d.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(d.canPlayType("audio/x-m4a;")||d.canPlayType("audio/m4a;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(d.canPlayType("audio/x-m4b;")||d.canPlayType("audio/m4b;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(d.canPlayType("audio/x-mp4;")||d.canPlayType("audio/mp4;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!x&&d.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!x&&d.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!d.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(d.canPlayType("audio/x-flac;")||d.canPlayType("audio/flac;")).replace(/^no$/,"")},h},_unlockAudio:function(){var h=this||r;if(!(h._audioUnlocked||!h.ctx)){h._audioUnlocked=!1,h.autoUnlock=!1,!h._mobileUnloaded&&h.ctx.sampleRate!==44100&&(h._mobileUnloaded=!0,h.unload()),h._scratchBuffer=h.ctx.createBuffer(1,1,22050);var d=function(p){for(;h._html5AudioPool.length<h.html5PoolSize;)try{var f=new Audio;f._unlocked=!0,h._releaseHtml5Audio(f)}catch{h.noAudio=!0;break}for(var m=0;m<h._howls.length;m++)if(!h._howls[m]._webAudio)for(var g=h._howls[m]._getSoundIds(),v=0;v<g.length;v++){var y=h._howls[m]._soundById(g[v]);y&&y._node&&!y._node._unlocked&&(y._node._unlocked=!0,y._node.load())}h._autoResume();var x=h.ctx.createBufferSource();x.buffer=h._scratchBuffer,x.connect(h.ctx.destination),typeof x.start>"u"?x.noteOn(0):x.start(0),typeof h.ctx.resume=="function"&&h.ctx.resume(),x.onended=function(){x.disconnect(0),h._audioUnlocked=!0,document.removeEventListener("touchstart",d,!0),document.removeEventListener("touchend",d,!0),document.removeEventListener("click",d,!0),document.removeEventListener("keydown",d,!0);for(var w=0;w<h._howls.length;w++)h._howls[w]._emit("unlock")}};return document.addEventListener("touchstart",d,!0),document.addEventListener("touchend",d,!0),document.addEventListener("click",d,!0),document.addEventListener("keydown",d,!0),h}},_obtainHtml5Audio:function(){var h=this||r;if(h._html5AudioPool.length)return h._html5AudioPool.pop();var d=new Audio().play();return d&&typeof Promise<"u"&&(d instanceof Promise||typeof d.then=="function")&&d.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(h){var d=this||r;return h._unlocked&&d._html5AudioPool.push(h),d},_autoSuspend:function(){var h=this;if(!(!h.autoSuspend||!h.ctx||typeof h.ctx.suspend>"u"||!r.usingWebAudio)){for(var d=0;d<h._howls.length;d++)if(h._howls[d]._webAudio){for(var p=0;p<h._howls[d]._sounds.length;p++)if(!h._howls[d]._sounds[p]._paused)return h}return h._suspendTimer&&clearTimeout(h._suspendTimer),h._suspendTimer=setTimeout(function(){if(h.autoSuspend){h._suspendTimer=null,h.state="suspending";var f=function(){h.state="suspended",h._resumeAfterSuspend&&(delete h._resumeAfterSuspend,h._autoResume())};h.ctx.suspend().then(f,f)}},3e4),h}},_autoResume:function(){var h=this;if(!(!h.ctx||typeof h.ctx.resume>"u"||!r.usingWebAudio))return h.state==="running"&&h.ctx.state!=="interrupted"&&h._suspendTimer?(clearTimeout(h._suspendTimer),h._suspendTimer=null):h.state==="suspended"||h.state==="running"&&h.ctx.state==="interrupted"?(h.ctx.resume().then(function(){h.state="running";for(var d=0;d<h._howls.length;d++)h._howls[d]._emit("resume")}),h._suspendTimer&&(clearTimeout(h._suspendTimer),h._suspendTimer=null)):h.state==="suspending"&&(h._resumeAfterSuspend=!0),h}};var r=new t,i=function(h){var d=this;if(!h.src||h.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}d.init(h)};i.prototype={init:function(h){var d=this;return r.ctx||u(),d._autoplay=h.autoplay||!1,d._format=typeof h.format!="string"?h.format:[h.format],d._html5=h.html5||!1,d._muted=h.mute||!1,d._loop=h.loop||!1,d._pool=h.pool||5,d._preload=typeof h.preload=="boolean"||h.preload==="metadata"?h.preload:!0,d._rate=h.rate||1,d._sprite=h.sprite||{},d._src=typeof h.src!="string"?h.src:[h.src],d._volume=h.volume!==void 0?h.volume:1,d._xhr={method:h.xhr&&h.xhr.method?h.xhr.method:"GET",headers:h.xhr&&h.xhr.headers?h.xhr.headers:null,withCredentials:h.xhr&&h.xhr.withCredentials?h.xhr.withCredentials:!1},d._duration=0,d._state="unloaded",d._sounds=[],d._endTimers={},d._queue=[],d._playLock=!1,d._onend=h.onend?[{fn:h.onend}]:[],d._onfade=h.onfade?[{fn:h.onfade}]:[],d._onload=h.onload?[{fn:h.onload}]:[],d._onloaderror=h.onloaderror?[{fn:h.onloaderror}]:[],d._onplayerror=h.onplayerror?[{fn:h.onplayerror}]:[],d._onpause=h.onpause?[{fn:h.onpause}]:[],d._onplay=h.onplay?[{fn:h.onplay}]:[],d._onstop=h.onstop?[{fn:h.onstop}]:[],d._onmute=h.onmute?[{fn:h.onmute}]:[],d._onvolume=h.onvolume?[{fn:h.onvolume}]:[],d._onrate=h.onrate?[{fn:h.onrate}]:[],d._onseek=h.onseek?[{fn:h.onseek}]:[],d._onunlock=h.onunlock?[{fn:h.onunlock}]:[],d._onresume=[],d._webAudio=r.usingWebAudio&&!d._html5,typeof r.ctx<"u"&&r.ctx&&r.autoUnlock&&r._unlockAudio(),r._howls.push(d),d._autoplay&&d._queue.push({event:"play",action:function(){d.play()}}),d._preload&&d._preload!=="none"&&d.load(),d},load:function(){var h=this,d=null;if(r.noAudio){h._emit("loaderror",null,"No audio support.");return}typeof h._src=="string"&&(h._src=[h._src]);for(var p=0;p<h._src.length;p++){var f,m;if(h._format&&h._format[p])f=h._format[p];else{if(m=h._src[p],typeof m!="string"){h._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}f=/^data:audio\/([^;,]+);/i.exec(m),f||(f=/\.([^.]+)$/.exec(m.split("?",1)[0])),f&&(f=f[1].toLowerCase())}if(f||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),f&&r.codecs(f)){d=h._src[p];break}}if(!d){h._emit("loaderror",null,"No codec support for selected audio sources.");return}return h._src=d,h._state="loading",window.location.protocol==="https:"&&d.slice(0,5)==="http:"&&(h._html5=!0,h._webAudio=!1),new n(h),h._webAudio&&a(h),h},play:function(h,d){var p=this,f=null;if(typeof h=="number")f=h,h=null;else{if(typeof h=="string"&&p._state==="loaded"&&!p._sprite[h])return null;if(typeof h>"u"&&(h="__default",!p._playLock)){for(var m=0,g=0;g<p._sounds.length;g++)p._sounds[g]._paused&&!p._sounds[g]._ended&&(m++,f=p._sounds[g]._id);m===1?h=null:f=null}}var v=f?p._soundById(f):p._inactiveSound();if(!v)return null;if(f&&!h&&(h=v._sprite||"__default"),p._state!=="loaded"){v._sprite=h,v._ended=!1;var y=v._id;return p._queue.push({event:"play",action:function(){p.play(y)}}),y}if(f&&!v._paused)return d||p._loadQueue("play"),v._id;p._webAudio&&r._autoResume();var x=Math.max(0,v._seek>0?v._seek:p._sprite[h][0]/1e3),w=Math.max(0,(p._sprite[h][0]+p._sprite[h][1])/1e3-x),b=w*1e3/Math.abs(v._rate),_=p._sprite[h][0]/1e3,A=(p._sprite[h][0]+p._sprite[h][1])/1e3;v._sprite=h,v._ended=!1;var S=function(){v._paused=!1,v._seek=x,v._start=_,v._stop=A,v._loop=!!(v._loop||p._sprite[h][2])};if(x>=A){p._ended(v);return}var C=v._node;if(p._webAudio){var M=function(){p._playLock=!1,S(),p._refreshBuffer(v);var I=v._muted||p._muted?0:v._volume;C.gain.setValueAtTime(I,r.ctx.currentTime),v._playStart=r.ctx.currentTime,typeof C.bufferSource.start>"u"?v._loop?C.bufferSource.noteGrainOn(0,x,86400):C.bufferSource.noteGrainOn(0,x,w):v._loop?C.bufferSource.start(0,x,86400):C.bufferSource.start(0,x,w),b!==1/0&&(p._endTimers[v._id]=setTimeout(p._ended.bind(p,v),b)),d||setTimeout(function(){p._emit("play",v._id),p._loadQueue()},0)};r.state==="running"&&r.ctx.state!=="interrupted"?M():(p._playLock=!0,p.once("resume",M),p._clearTimer(v._id))}else{var T=function(){C.currentTime=x,C.muted=v._muted||p._muted||r._muted||C.muted,C.volume=v._volume*r.volume(),C.playbackRate=v._rate;try{var I=C.play();if(I&&typeof Promise<"u"&&(I instanceof Promise||typeof I.then=="function")?(p._playLock=!0,S(),I.then(function(){p._playLock=!1,C._unlocked=!0,d?p._loadQueue():p._emit("play",v._id)}).catch(function(){p._playLock=!1,p._emit("playerror",v._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),v._ended=!0,v._paused=!0})):d||(p._playLock=!1,S(),p._emit("play",v._id)),C.playbackRate=v._rate,C.paused){p._emit("playerror",v._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}h!=="__default"||v._loop?p._endTimers[v._id]=setTimeout(p._ended.bind(p,v),b):(p._endTimers[v._id]=function(){p._ended(v),C.removeEventListener("ended",p._endTimers[v._id],!1)},C.addEventListener("ended",p._endTimers[v._id],!1))}catch(B){p._emit("playerror",v._id,B)}};C.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(C.src=p._src,C.load());var P=window&&window.ejecta||!C.readyState&&r._navigator.isCocoonJS;if(C.readyState>=3||P)T();else{p._playLock=!0,p._state="loading";var D=function(){p._state="loaded",T(),C.removeEventListener(r._canPlayEvent,D,!1)};C.addEventListener(r._canPlayEvent,D,!1),p._clearTimer(v._id)}}return v._id},pause:function(h){var d=this;if(d._state!=="loaded"||d._playLock)return d._queue.push({event:"pause",action:function(){d.pause(h)}}),d;for(var p=d._getSoundIds(h),f=0;f<p.length;f++){d._clearTimer(p[f]);var m=d._soundById(p[f]);if(m&&!m._paused&&(m._seek=d.seek(p[f]),m._rateSeek=0,m._paused=!0,d._stopFade(p[f]),m._node))if(d._webAudio){if(!m._node.bufferSource)continue;typeof m._node.bufferSource.stop>"u"?m._node.bufferSource.noteOff(0):m._node.bufferSource.stop(0),d._cleanBuffer(m._node)}else(!isNaN(m._node.duration)||m._node.duration===1/0)&&m._node.pause();arguments[1]||d._emit("pause",m?m._id:null)}return d},stop:function(h,d){var p=this;if(p._state!=="loaded"||p._playLock)return p._queue.push({event:"stop",action:function(){p.stop(h)}}),p;for(var f=p._getSoundIds(h),m=0;m<f.length;m++){p._clearTimer(f[m]);var g=p._soundById(f[m]);g&&(g._seek=g._start||0,g._rateSeek=0,g._paused=!0,g._ended=!0,p._stopFade(f[m]),g._node&&(p._webAudio?g._node.bufferSource&&(typeof g._node.bufferSource.stop>"u"?g._node.bufferSource.noteOff(0):g._node.bufferSource.stop(0),p._cleanBuffer(g._node)):(!isNaN(g._node.duration)||g._node.duration===1/0)&&(g._node.currentTime=g._start||0,g._node.pause(),g._node.duration===1/0&&p._clearSound(g._node))),d||p._emit("stop",g._id))}return p},mute:function(h,d){var p=this;if(p._state!=="loaded"||p._playLock)return p._queue.push({event:"mute",action:function(){p.mute(h,d)}}),p;if(typeof d>"u")if(typeof h=="boolean")p._muted=h;else return p._muted;for(var f=p._getSoundIds(d),m=0;m<f.length;m++){var g=p._soundById(f[m]);g&&(g._muted=h,g._interval&&p._stopFade(g._id),p._webAudio&&g._node?g._node.gain.setValueAtTime(h?0:g._volume,r.ctx.currentTime):g._node&&(g._node.muted=r._muted?!0:h),p._emit("mute",g._id))}return p},volume:function(){var h=this,d=arguments,p,f;if(d.length===0)return h._volume;if(d.length===1||d.length===2&&typeof d[1]>"u"){var m=h._getSoundIds(),g=m.indexOf(d[0]);g>=0?f=parseInt(d[0],10):p=parseFloat(d[0])}else d.length>=2&&(p=parseFloat(d[0]),f=parseInt(d[1],10));var v;if(typeof p<"u"&&p>=0&&p<=1){if(h._state!=="loaded"||h._playLock)return h._queue.push({event:"volume",action:function(){h.volume.apply(h,d)}}),h;typeof f>"u"&&(h._volume=p),f=h._getSoundIds(f);for(var y=0;y<f.length;y++)v=h._soundById(f[y]),v&&(v._volume=p,d[2]||h._stopFade(f[y]),h._webAudio&&v._node&&!v._muted?v._node.gain.setValueAtTime(p,r.ctx.currentTime):v._node&&!v._muted&&(v._node.volume=p*r.volume()),h._emit("volume",v._id))}else return v=f?h._soundById(f):h._sounds[0],v?v._volume:0;return h},fade:function(h,d,p,f){var m=this;if(m._state!=="loaded"||m._playLock)return m._queue.push({event:"fade",action:function(){m.fade(h,d,p,f)}}),m;h=Math.min(Math.max(0,parseFloat(h)),1),d=Math.min(Math.max(0,parseFloat(d)),1),p=parseFloat(p),m.volume(h,f);for(var g=m._getSoundIds(f),v=0;v<g.length;v++){var y=m._soundById(g[v]);if(y){if(f||m._stopFade(g[v]),m._webAudio&&!y._muted){var x=r.ctx.currentTime,w=x+p/1e3;y._volume=h,y._node.gain.setValueAtTime(h,x),y._node.gain.linearRampToValueAtTime(d,w)}m._startFadeInterval(y,h,d,p,g[v],typeof f>"u")}}return m},_startFadeInterval:function(h,d,p,f,m,g){var v=this,y=d,x=p-d,w=Math.abs(x/.01),b=Math.max(4,w>0?f/w:f),_=Date.now();h._fadeTo=p,h._interval=setInterval(function(){var A=(Date.now()-_)/f;_=Date.now(),y+=x*A,y=Math.round(y*100)/100,x<0?y=Math.max(p,y):y=Math.min(p,y),v._webAudio?h._volume=y:v.volume(y,h._id,!0),g&&(v._volume=y),(p<d&&y<=p||p>d&&y>=p)&&(clearInterval(h._interval),h._interval=null,h._fadeTo=null,v.volume(p,h._id),v._emit("fade",h._id))},b)},_stopFade:function(h){var d=this,p=d._soundById(h);return p&&p._interval&&(d._webAudio&&p._node.gain.cancelScheduledValues(r.ctx.currentTime),clearInterval(p._interval),p._interval=null,d.volume(p._fadeTo,h),p._fadeTo=null,d._emit("fade",h)),d},loop:function(){var h=this,d=arguments,p,f,m;if(d.length===0)return h._loop;if(d.length===1)if(typeof d[0]=="boolean")p=d[0],h._loop=p;else return m=h._soundById(parseInt(d[0],10)),m?m._loop:!1;else d.length===2&&(p=d[0],f=parseInt(d[1],10));for(var g=h._getSoundIds(f),v=0;v<g.length;v++)m=h._soundById(g[v]),m&&(m._loop=p,h._webAudio&&m._node&&m._node.bufferSource&&(m._node.bufferSource.loop=p,p&&(m._node.bufferSource.loopStart=m._start||0,m._node.bufferSource.loopEnd=m._stop,h.playing(g[v])&&(h.pause(g[v],!0),h.play(g[v],!0)))));return h},rate:function(){var h=this,d=arguments,p,f;if(d.length===0)f=h._sounds[0]._id;else if(d.length===1){var m=h._getSoundIds(),g=m.indexOf(d[0]);g>=0?f=parseInt(d[0],10):p=parseFloat(d[0])}else d.length===2&&(p=parseFloat(d[0]),f=parseInt(d[1],10));var v;if(typeof p=="number"){if(h._state!=="loaded"||h._playLock)return h._queue.push({event:"rate",action:function(){h.rate.apply(h,d)}}),h;typeof f>"u"&&(h._rate=p),f=h._getSoundIds(f);for(var y=0;y<f.length;y++)if(v=h._soundById(f[y]),v){h.playing(f[y])&&(v._rateSeek=h.seek(f[y]),v._playStart=h._webAudio?r.ctx.currentTime:v._playStart),v._rate=p,h._webAudio&&v._node&&v._node.bufferSource?v._node.bufferSource.playbackRate.setValueAtTime(p,r.ctx.currentTime):v._node&&(v._node.playbackRate=p);var x=h.seek(f[y]),w=(h._sprite[v._sprite][0]+h._sprite[v._sprite][1])/1e3-x,b=w*1e3/Math.abs(v._rate);(h._endTimers[f[y]]||!v._paused)&&(h._clearTimer(f[y]),h._endTimers[f[y]]=setTimeout(h._ended.bind(h,v),b)),h._emit("rate",v._id)}}else return v=h._soundById(f),v?v._rate:h._rate;return h},seek:function(){var h=this,d=arguments,p,f;if(d.length===0)h._sounds.length&&(f=h._sounds[0]._id);else if(d.length===1){var m=h._getSoundIds(),g=m.indexOf(d[0]);g>=0?f=parseInt(d[0],10):h._sounds.length&&(f=h._sounds[0]._id,p=parseFloat(d[0]))}else d.length===2&&(p=parseFloat(d[0]),f=parseInt(d[1],10));if(typeof f>"u")return 0;if(typeof p=="number"&&(h._state!=="loaded"||h._playLock))return h._queue.push({event:"seek",action:function(){h.seek.apply(h,d)}}),h;var v=h._soundById(f);if(v)if(typeof p=="number"&&p>=0){var y=h.playing(f);y&&h.pause(f,!0),v._seek=p,v._ended=!1,h._clearTimer(f),!h._webAudio&&v._node&&!isNaN(v._node.duration)&&(v._node.currentTime=p);var x=function(){y&&h.play(f,!0),h._emit("seek",f)};if(y&&!h._webAudio){var w=function(){h._playLock?setTimeout(w,0):x()};setTimeout(w,0)}else x()}else if(h._webAudio){var b=h.playing(f)?r.ctx.currentTime-v._playStart:0,_=v._rateSeek?v._rateSeek-v._seek:0;return v._seek+(_+b*Math.abs(v._rate))}else return v._node.currentTime;return h},playing:function(h){var d=this;if(typeof h=="number"){var p=d._soundById(h);return p?!p._paused:!1}for(var f=0;f<d._sounds.length;f++)if(!d._sounds[f]._paused)return!0;return!1},duration:function(h){var d=this,p=d._duration,f=d._soundById(h);return f&&(p=d._sprite[f._sprite][1]/1e3),p},state:function(){return this._state},unload:function(){for(var h=this,d=h._sounds,p=0;p<d.length;p++)d[p]._paused||h.stop(d[p]._id),h._webAudio||(h._clearSound(d[p]._node),d[p]._node.removeEventListener("error",d[p]._errorFn,!1),d[p]._node.removeEventListener(r._canPlayEvent,d[p]._loadFn,!1),d[p]._node.removeEventListener("ended",d[p]._endFn,!1),r._releaseHtml5Audio(d[p]._node)),delete d[p]._node,h._clearTimer(d[p]._id);var f=r._howls.indexOf(h);f>=0&&r._howls.splice(f,1);var m=!0;for(p=0;p<r._howls.length;p++)if(r._howls[p]._src===h._src||h._src.indexOf(r._howls[p]._src)>=0){m=!1;break}return s&&m&&delete s[h._src],r.noAudio=!1,h._state="unloaded",h._sounds=[],h=null,null},on:function(h,d,p,f){var m=this,g=m["_on"+h];return typeof d=="function"&&g.push(f?{id:p,fn:d,once:f}:{id:p,fn:d}),m},off:function(h,d,p){var f=this,m=f["_on"+h],g=0;if(typeof d=="number"&&(p=d,d=null),d||p)for(g=0;g<m.length;g++){var v=p===m[g].id;if(d===m[g].fn&&v||!d&&v){m.splice(g,1);break}}else if(h)f["_on"+h]=[];else{var y=Object.keys(f);for(g=0;g<y.length;g++)y[g].indexOf("_on")===0&&Array.isArray(f[y[g]])&&(f[y[g]]=[])}return f},once:function(h,d,p){var f=this;return f.on(h,d,p,1),f},_emit:function(h,d,p){for(var f=this,m=f["_on"+h],g=m.length-1;g>=0;g--)(!m[g].id||m[g].id===d||h==="load")&&(setTimeout((function(v){v.call(this,d,p)}).bind(f,m[g].fn),0),m[g].once&&f.off(h,m[g].fn,m[g].id));return f._loadQueue(h),f},_loadQueue:function(h){var d=this;if(d._queue.length>0){var p=d._queue[0];p.event===h&&(d._queue.shift(),d._loadQueue()),h||p.action()}return d},_ended:function(h){var d=this,p=h._sprite;if(!d._webAudio&&h._node&&!h._node.paused&&!h._node.ended&&h._node.currentTime<h._stop)return setTimeout(d._ended.bind(d,h),100),d;var f=!!(h._loop||d._sprite[p][2]);if(d._emit("end",h._id),!d._webAudio&&f&&d.stop(h._id,!0).play(h._id),d._webAudio&&f){d._emit("play",h._id),h._seek=h._start||0,h._rateSeek=0,h._playStart=r.ctx.currentTime;var m=(h._stop-h._start)*1e3/Math.abs(h._rate);d._endTimers[h._id]=setTimeout(d._ended.bind(d,h),m)}return d._webAudio&&!f&&(h._paused=!0,h._ended=!0,h._seek=h._start||0,h._rateSeek=0,d._clearTimer(h._id),d._cleanBuffer(h._node),r._autoSuspend()),!d._webAudio&&!f&&d.stop(h._id,!0),d},_clearTimer:function(h){var d=this;if(d._endTimers[h]){if(typeof d._endTimers[h]!="function")clearTimeout(d._endTimers[h]);else{var p=d._soundById(h);p&&p._node&&p._node.removeEventListener("ended",d._endTimers[h],!1)}delete d._endTimers[h]}return d},_soundById:function(h){for(var d=this,p=0;p<d._sounds.length;p++)if(h===d._sounds[p]._id)return d._sounds[p];return null},_inactiveSound:function(){var h=this;h._drain();for(var d=0;d<h._sounds.length;d++)if(h._sounds[d]._ended)return h._sounds[d].reset();return new n(h)},_drain:function(){var h=this,d=h._pool,p=0,f=0;if(!(h._sounds.length<d)){for(f=0;f<h._sounds.length;f++)h._sounds[f]._ended&&p++;for(f=h._sounds.length-1;f>=0;f--){if(p<=d)return;h._sounds[f]._ended&&(h._webAudio&&h._sounds[f]._node&&h._sounds[f]._node.disconnect(0),h._sounds.splice(f,1),p--)}}},_getSoundIds:function(h){var d=this;if(typeof h>"u"){for(var p=[],f=0;f<d._sounds.length;f++)p.push(d._sounds[f]._id);return p}else return[h]},_refreshBuffer:function(h){var d=this;return h._node.bufferSource=r.ctx.createBufferSource(),h._node.bufferSource.buffer=s[d._src],h._panner?h._node.bufferSource.connect(h._panner):h._node.bufferSource.connect(h._node),h._node.bufferSource.loop=h._loop,h._loop&&(h._node.bufferSource.loopStart=h._start||0,h._node.bufferSource.loopEnd=h._stop||0),h._node.bufferSource.playbackRate.setValueAtTime(h._rate,r.ctx.currentTime),d},_cleanBuffer:function(h){var d=this,p=r._navigator&&r._navigator.vendor.indexOf("Apple")>=0;if(r._scratchBuffer&&h.bufferSource&&(h.bufferSource.onended=null,h.bufferSource.disconnect(0),p))try{h.bufferSource.buffer=r._scratchBuffer}catch{}return h.bufferSource=null,d},_clearSound:function(h){var d=/MSIE |Trident\//.test(r._navigator&&r._navigator.userAgent);d||(h.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var n=function(h){this._parent=h,this.init()};n.prototype={init:function(){var h=this,d=h._parent;return h._muted=d._muted,h._loop=d._loop,h._volume=d._volume,h._rate=d._rate,h._seek=0,h._paused=!0,h._ended=!0,h._sprite="__default",h._id=++r._counter,d._sounds.push(h),h.create(),h},create:function(){var h=this,d=h._parent,p=r._muted||h._muted||h._parent._muted?0:h._volume;return d._webAudio?(h._node=typeof r.ctx.createGain>"u"?r.ctx.createGainNode():r.ctx.createGain(),h._node.gain.setValueAtTime(p,r.ctx.currentTime),h._node.paused=!0,h._node.connect(r.masterGain)):r.noAudio||(h._node=r._obtainHtml5Audio(),h._errorFn=h._errorListener.bind(h),h._node.addEventListener("error",h._errorFn,!1),h._loadFn=h._loadListener.bind(h),h._node.addEventListener(r._canPlayEvent,h._loadFn,!1),h._endFn=h._endListener.bind(h),h._node.addEventListener("ended",h._endFn,!1),h._node.src=d._src,h._node.preload=d._preload===!0?"auto":d._preload,h._node.volume=p*r.volume(),h._node.load()),h},reset:function(){var h=this,d=h._parent;return h._muted=d._muted,h._loop=d._loop,h._volume=d._volume,h._rate=d._rate,h._seek=0,h._rateSeek=0,h._paused=!0,h._ended=!0,h._sprite="__default",h._id=++r._counter,h},_errorListener:function(){var h=this;h._parent._emit("loaderror",h._id,h._node.error?h._node.error.code:0),h._node.removeEventListener("error",h._errorFn,!1)},_loadListener:function(){var h=this,d=h._parent;d._duration=Math.ceil(h._node.duration*10)/10,Object.keys(d._sprite).length===0&&(d._sprite={__default:[0,d._duration*1e3]}),d._state!=="loaded"&&(d._state="loaded",d._emit("load"),d._loadQueue()),h._node.removeEventListener(r._canPlayEvent,h._loadFn,!1)},_endListener:function(){var h=this,d=h._parent;d._duration===1/0&&(d._duration=Math.ceil(h._node.duration*10)/10,d._sprite.__default[1]===1/0&&(d._sprite.__default[1]=d._duration*1e3),d._ended(h)),h._node.removeEventListener("ended",h._endFn,!1)}};var s={},a=function(h){var d=h._src;if(s[d]){h._duration=s[d].duration,c(h);return}if(/^data:[^;]+;base64,/.test(d)){for(var p=atob(d.split(",")[1]),f=new Uint8Array(p.length),m=0;m<p.length;++m)f[m]=p.charCodeAt(m);l(f.buffer,h)}else{var g=new XMLHttpRequest;g.open(h._xhr.method,d,!0),g.withCredentials=h._xhr.withCredentials,g.responseType="arraybuffer",h._xhr.headers&&Object.keys(h._xhr.headers).forEach(function(v){g.setRequestHeader(v,h._xhr.headers[v])}),g.onload=function(){var v=(g.status+"")[0];if(v!=="0"&&v!=="2"&&v!=="3"){h._emit("loaderror",null,"Failed loading audio file with status: "+g.status+".");return}l(g.response,h)},g.onerror=function(){h._webAudio&&(h._html5=!0,h._webAudio=!1,h._sounds=[],delete s[d],h.load())},o(g)}},o=function(h){try{h.send()}catch{h.onerror()}},l=function(h,d){var p=function(){d._emit("loaderror",null,"Decoding audio data failed.")},f=function(m){m&&d._sounds.length>0?(s[d._src]=m,c(d,m)):p()};typeof Promise<"u"&&r.ctx.decodeAudioData.length===1?r.ctx.decodeAudioData(h).then(f).catch(p):r.ctx.decodeAudioData(h,f,p)},c=function(h,d){d&&!h._duration&&(h._duration=d.duration),Object.keys(h._sprite).length===0&&(h._sprite={__default:[0,h._duration*1e3]}),h._state!=="loaded"&&(h._state="loaded",h._emit("load"),h._loadQueue())},u=function(){if(r.usingWebAudio){try{typeof AudioContext<"u"?r.ctx=new AudioContext:typeof webkitAudioContext<"u"?r.ctx=new webkitAudioContext:r.usingWebAudio=!1}catch{r.usingWebAudio=!1}r.ctx||(r.usingWebAudio=!1);var h=/iP(hone|od|ad)/.test(r._navigator&&r._navigator.platform),d=r._navigator&&r._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),p=d?parseInt(d[1],10):null;if(h&&p&&p<9){var f=/safari/.test(r._navigator&&r._navigator.userAgent.toLowerCase());r._navigator&&!f&&(r.usingWebAudio=!1)}r.usingWebAudio&&(r.masterGain=typeof r.ctx.createGain>"u"?r.ctx.createGainNode():r.ctx.createGain(),r.masterGain.gain.setValueAtTime(r._muted?0:r._volume,r.ctx.currentTime),r.masterGain.connect(r.ctx.destination)),r._setup()}};typeof define=="function"&&define.amd&&define([],function(){return{Howler:r,Howl:i}}),typeof e<"u"&&(e.Howler=r,e.Howl=i),typeof global<"u"?(global.HowlerGlobal=t,global.Howler=r,global.Howl=i,global.Sound=n):typeof window<"u"&&(window.HowlerGlobal=t,window.Howler=r,window.Howl=i,window.Sound=n)})(),function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(r){var i=this;if(!i.ctx||!i.ctx.listener)return i;for(var n=i._howls.length-1;n>=0;n--)i._howls[n].stereo(r);return i},HowlerGlobal.prototype.pos=function(r,i,n){var s=this;if(!s.ctx||!s.ctx.listener)return s;if(i=typeof i!="number"?s._pos[1]:i,n=typeof n!="number"?s._pos[2]:n,typeof r=="number")s._pos=[r,i,n],typeof s.ctx.listener.positionX<"u"?(s.ctx.listener.positionX.setTargetAtTime(s._pos[0],Howler.ctx.currentTime,.1),s.ctx.listener.positionY.setTargetAtTime(s._pos[1],Howler.ctx.currentTime,.1),s.ctx.listener.positionZ.setTargetAtTime(s._pos[2],Howler.ctx.currentTime,.1)):s.ctx.listener.setPosition(s._pos[0],s._pos[1],s._pos[2]);else return s._pos;return s},HowlerGlobal.prototype.orientation=function(r,i,n,s,a,o){var l=this;if(!l.ctx||!l.ctx.listener)return l;var c=l._orientation;if(i=typeof i!="number"?c[1]:i,n=typeof n!="number"?c[2]:n,s=typeof s!="number"?c[3]:s,a=typeof a!="number"?c[4]:a,o=typeof o!="number"?c[5]:o,typeof r=="number")l._orientation=[r,i,n,s,a,o],typeof l.ctx.listener.forwardX<"u"?(l.ctx.listener.forwardX.setTargetAtTime(r,Howler.ctx.currentTime,.1),l.ctx.listener.forwardY.setTargetAtTime(i,Howler.ctx.currentTime,.1),l.ctx.listener.forwardZ.setTargetAtTime(n,Howler.ctx.currentTime,.1),l.ctx.listener.upX.setTargetAtTime(s,Howler.ctx.currentTime,.1),l.ctx.listener.upY.setTargetAtTime(a,Howler.ctx.currentTime,.1),l.ctx.listener.upZ.setTargetAtTime(o,Howler.ctx.currentTime,.1)):l.ctx.listener.setOrientation(r,i,n,s,a,o);else return c;return l},Howl.prototype.init=function(r){return function(i){var n=this;return n._orientation=i.orientation||[1,0,0],n._stereo=i.stereo||null,n._pos=i.pos||null,n._pannerAttr={coneInnerAngle:typeof i.coneInnerAngle<"u"?i.coneInnerAngle:360,coneOuterAngle:typeof i.coneOuterAngle<"u"?i.coneOuterAngle:360,coneOuterGain:typeof i.coneOuterGain<"u"?i.coneOuterGain:0,distanceModel:typeof i.distanceModel<"u"?i.distanceModel:"inverse",maxDistance:typeof i.maxDistance<"u"?i.maxDistance:1e4,panningModel:typeof i.panningModel<"u"?i.panningModel:"HRTF",refDistance:typeof i.refDistance<"u"?i.refDistance:1,rolloffFactor:typeof i.rolloffFactor<"u"?i.rolloffFactor:1},n._onstereo=i.onstereo?[{fn:i.onstereo}]:[],n._onpos=i.onpos?[{fn:i.onpos}]:[],n._onorientation=i.onorientation?[{fn:i.onorientation}]:[],r.call(this,i)}}(Howl.prototype.init),Howl.prototype.stereo=function(r,i){var n=this;if(!n._webAudio)return n;if(n._state!=="loaded")return n._queue.push({event:"stereo",action:function(){n.stereo(r,i)}}),n;var s=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof i>"u")if(typeof r=="number")n._stereo=r,n._pos=[r,0,0];else return n._stereo;for(var a=n._getSoundIds(i),o=0;o<a.length;o++){var l=n._soundById(a[o]);if(l)if(typeof r=="number")l._stereo=r,l._pos=[r,0,0],l._node&&(l._pannerAttr.panningModel="equalpower",(!l._panner||!l._panner.pan)&&t(l,s),s==="spatial"?typeof l._panner.positionX<"u"?(l._panner.positionX.setValueAtTime(r,Howler.ctx.currentTime),l._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),l._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):l._panner.setPosition(r,0,0):l._panner.pan.setValueAtTime(r,Howler.ctx.currentTime)),n._emit("stereo",l._id);else return l._stereo}return n},Howl.prototype.pos=function(r,i,n,s){var a=this;if(!a._webAudio)return a;if(a._state!=="loaded")return a._queue.push({event:"pos",action:function(){a.pos(r,i,n,s)}}),a;if(i=typeof i!="number"?0:i,n=typeof n!="number"?-.5:n,typeof s>"u")if(typeof r=="number")a._pos=[r,i,n];else return a._pos;for(var o=a._getSoundIds(s),l=0;l<o.length;l++){var c=a._soundById(o[l]);if(c)if(typeof r=="number")c._pos=[r,i,n],c._node&&((!c._panner||c._panner.pan)&&t(c,"spatial"),typeof c._panner.positionX<"u"?(c._panner.positionX.setValueAtTime(r,Howler.ctx.currentTime),c._panner.positionY.setValueAtTime(i,Howler.ctx.currentTime),c._panner.positionZ.setValueAtTime(n,Howler.ctx.currentTime)):c._panner.setPosition(r,i,n)),a._emit("pos",c._id);else return c._pos}return a},Howl.prototype.orientation=function(r,i,n,s){var a=this;if(!a._webAudio)return a;if(a._state!=="loaded")return a._queue.push({event:"orientation",action:function(){a.orientation(r,i,n,s)}}),a;if(i=typeof i!="number"?a._orientation[1]:i,n=typeof n!="number"?a._orientation[2]:n,typeof s>"u")if(typeof r=="number")a._orientation=[r,i,n];else return a._orientation;for(var o=a._getSoundIds(s),l=0;l<o.length;l++){var c=a._soundById(o[l]);if(c)if(typeof r=="number")c._orientation=[r,i,n],c._node&&(c._panner||(c._pos||(c._pos=a._pos||[0,0,-.5]),t(c,"spatial")),typeof c._panner.orientationX<"u"?(c._panner.orientationX.setValueAtTime(r,Howler.ctx.currentTime),c._panner.orientationY.setValueAtTime(i,Howler.ctx.currentTime),c._panner.orientationZ.setValueAtTime(n,Howler.ctx.currentTime)):c._panner.setOrientation(r,i,n)),a._emit("orientation",c._id);else return c._orientation}return a},Howl.prototype.pannerAttr=function(){var r=this,i=arguments,n,s,a;if(!r._webAudio)return r;if(i.length===0)return r._pannerAttr;if(i.length===1)if(typeof i[0]=="object")n=i[0],typeof s>"u"&&(n.pannerAttr||(n.pannerAttr={coneInnerAngle:n.coneInnerAngle,coneOuterAngle:n.coneOuterAngle,coneOuterGain:n.coneOuterGain,distanceModel:n.distanceModel,maxDistance:n.maxDistance,refDistance:n.refDistance,rolloffFactor:n.rolloffFactor,panningModel:n.panningModel}),r._pannerAttr={coneInnerAngle:typeof n.pannerAttr.coneInnerAngle<"u"?n.pannerAttr.coneInnerAngle:r._coneInnerAngle,coneOuterAngle:typeof n.pannerAttr.coneOuterAngle<"u"?n.pannerAttr.coneOuterAngle:r._coneOuterAngle,coneOuterGain:typeof n.pannerAttr.coneOuterGain<"u"?n.pannerAttr.coneOuterGain:r._coneOuterGain,distanceModel:typeof n.pannerAttr.distanceModel<"u"?n.pannerAttr.distanceModel:r._distanceModel,maxDistance:typeof n.pannerAttr.maxDistance<"u"?n.pannerAttr.maxDistance:r._maxDistance,refDistance:typeof n.pannerAttr.refDistance<"u"?n.pannerAttr.refDistance:r._refDistance,rolloffFactor:typeof n.pannerAttr.rolloffFactor<"u"?n.pannerAttr.rolloffFactor:r._rolloffFactor,panningModel:typeof n.pannerAttr.panningModel<"u"?n.pannerAttr.panningModel:r._panningModel});else return a=r._soundById(parseInt(i[0],10)),a?a._pannerAttr:r._pannerAttr;else i.length===2&&(n=i[0],s=parseInt(i[1],10));for(var o=r._getSoundIds(s),l=0;l<o.length;l++)if(a=r._soundById(o[l]),a){var c=a._pannerAttr;c={coneInnerAngle:typeof n.coneInnerAngle<"u"?n.coneInnerAngle:c.coneInnerAngle,coneOuterAngle:typeof n.coneOuterAngle<"u"?n.coneOuterAngle:c.coneOuterAngle,coneOuterGain:typeof n.coneOuterGain<"u"?n.coneOuterGain:c.coneOuterGain,distanceModel:typeof n.distanceModel<"u"?n.distanceModel:c.distanceModel,maxDistance:typeof n.maxDistance<"u"?n.maxDistance:c.maxDistance,refDistance:typeof n.refDistance<"u"?n.refDistance:c.refDistance,rolloffFactor:typeof n.rolloffFactor<"u"?n.rolloffFactor:c.rolloffFactor,panningModel:typeof n.panningModel<"u"?n.panningModel:c.panningModel};var u=a._panner;u?(u.coneInnerAngle=c.coneInnerAngle,u.coneOuterAngle=c.coneOuterAngle,u.coneOuterGain=c.coneOuterGain,u.distanceModel=c.distanceModel,u.maxDistance=c.maxDistance,u.refDistance=c.refDistance,u.rolloffFactor=c.rolloffFactor,u.panningModel=c.panningModel):(a._pos||(a._pos=r._pos||[0,0,-.5]),t(a,"spatial"))}return r},Sound.prototype.init=function(r){return function(){var i=this,n=i._parent;i._orientation=n._orientation,i._stereo=n._stereo,i._pos=n._pos,i._pannerAttr=n._pannerAttr,r.call(this),i._stereo?n.stereo(i._stereo):i._pos&&n.pos(i._pos[0],i._pos[1],i._pos[2],i._id)}}(Sound.prototype.init),Sound.prototype.reset=function(r){return function(){var i=this,n=i._parent;return i._orientation=n._orientation,i._stereo=n._stereo,i._pos=n._pos,i._pannerAttr=n._pannerAttr,i._stereo?n.stereo(i._stereo):i._pos?n.pos(i._pos[0],i._pos[1],i._pos[2],i._id):i._panner&&(i._panner.disconnect(0),i._panner=void 0,n._refreshBuffer(i)),r.call(this)}}(Sound.prototype.reset);var t=function(r,i){i=i||"spatial",i==="spatial"?(r._panner=Howler.ctx.createPanner(),r._panner.coneInnerAngle=r._pannerAttr.coneInnerAngle,r._panner.coneOuterAngle=r._pannerAttr.coneOuterAngle,r._panner.coneOuterGain=r._pannerAttr.coneOuterGain,r._panner.distanceModel=r._pannerAttr.distanceModel,r._panner.maxDistance=r._pannerAttr.maxDistance,r._panner.refDistance=r._pannerAttr.refDistance,r._panner.rolloffFactor=r._pannerAttr.rolloffFactor,r._panner.panningModel=r._pannerAttr.panningModel,typeof r._panner.positionX<"u"?(r._panner.positionX.setValueAtTime(r._pos[0],Howler.ctx.currentTime),r._panner.positionY.setValueAtTime(r._pos[1],Howler.ctx.currentTime),r._panner.positionZ.setValueAtTime(r._pos[2],Howler.ctx.currentTime)):r._panner.setPosition(r._pos[0],r._pos[1],r._pos[2]),typeof r._panner.orientationX<"u"?(r._panner.orientationX.setValueAtTime(r._orientation[0],Howler.ctx.currentTime),r._panner.orientationY.setValueAtTime(r._orientation[1],Howler.ctx.currentTime),r._panner.orientationZ.setValueAtTime(r._orientation[2],Howler.ctx.currentTime)):r._panner.setOrientation(r._orientation[0],r._orientation[1],r._orientation[2])):(r._panner=Howler.ctx.createStereoPanner(),r._panner.pan.setValueAtTime(r._stereo,Howler.ctx.currentTime)),r._panner.connect(r._node),r._paused||r._parent.pause(r._id,!0).play(r._id,!0)}}()}),CG=od((e,t)=>{t.exports=function(r,i){for(var n=r.split("."),s=i.split("."),a=0;a<3;a++){var o=Number(n[a]),l=Number(s[a]);if(o>l)return 1;if(l>o)return-1;if(!isNaN(o)&&isNaN(l))return 1;if(isNaN(o)&&!isNaN(l))return-1}return 0}}),cd="149",Ln={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},MG=0,FE=1,EG=2,x3=1,TG=2,Cp=3,Ds=0,$r=1,yn=2,Ir=0,mu=1,UE=2,jE=3,VE=4,PG=5,Dh=100,DG=101,LG=102,HE=103,GE=104,IG=200,OG=201,RG=202,BG=203,rR=204,iR=205,zG=206,kG=207,NG=208,FG=209,UG=210,jG=0,VG=1,HG=2,l2=3,GG=4,WG=5,qG=6,XG=7,nR=0,YG=1,QG=2,io=0,KG=1,ZG=2,$G=3,JG=4,eW=5,sR=300,Lc=301,Ic=302,c2=303,h2=304,hm=306,Za=1e3,br=1001,u2=1002,Xt=1003,WE=1004,rx=1005,vt=1006,tW=1007,Vu=1008,Si=1009,rW=1010,iW=1011,aR=1012,nW=1013,Yo=1014,xn=1015,Hu=1016,sW=1017,aW=1018,yc=1020,oW=1021,Wn=1023,lW=1024,cW=1025,xc=1026,Oc=1027,hW=1028,uW=1029,oR=1030,dW=1031,pW=1033,ix=33776,nx=33777,sx=33778,ax=33779,qE=35840,XE=35841,YE=35842,QE=35843,fW=36196,KE=37492,ZE=37496,$E=37808,JE=37809,eT=37810,tT=37811,rT=37812,iT=37813,nT=37814,sT=37815,aT=37816,oT=37817,lT=37818,cT=37819,hT=37820,uT=37821,ox=36492,mW=36283,dT=36284,pT=36285,fT=36286,lR=2200,cR=2201,w3=2202,g0=2300,v0=2301,lx=2302,Jh=2400,eu=2401,y0=2402,b3=2500,gW=2501,fa=3e3,ut=3001,vo=3200,hR=3201,vW=0,yW=1,Ks="srgb",x0="srgb-linear",cx=7680,xW=519,d2=35044,mT="300 es",p2=1035,ui=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});let r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;let r=this._listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;let r=this._listeners[e];if(r!==void 0){let i=r.indexOf(t);i!==-1&&r.splice(i,1)}}dispatchEvent(e){if(this._listeners===void 0)return;let t=this._listeners[e.type];if(t!==void 0){e.target=this;let r=t.slice(0);for(let i=0,n=r.length;i<n;i++)r[i].call(this,e);e.target=null}}},mi=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],gT=1234567,Qp=Math.PI/180,Of=180/Math.PI;function Kn(){let e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(mi[e&255]+mi[e>>8&255]+mi[e>>16&255]+mi[e>>24&255]+"-"+mi[t&255]+mi[t>>8&255]+"-"+mi[t>>16&15|64]+mi[t>>24&255]+"-"+mi[r&63|128]+mi[r>>8&255]+"-"+mi[r>>16&255]+mi[r>>24&255]+mi[i&255]+mi[i>>8&255]+mi[i>>16&255]+mi[i>>24&255]).toLowerCase()}function Fr(e,t,r){return Math.max(t,Math.min(r,e))}function _3(e,t){return(e%t+t)%t}function wW(e,t,r,i,n){return i+(e-t)*(n-i)/(r-t)}function bW(e,t,r){return e!==t?(r-e)/(t-e):0}function Kp(e,t,r){return(1-r)*e+r*t}function _W(e,t,r,i){return Kp(e,t,1-Math.exp(-r*i))}function SW(e,t=1){return t-Math.abs(_3(e,t*2)-t)}function AW(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t),e*e*(3-2*e))}function CW(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t),e*e*e*(e*(e*6-15)+10))}function MW(e,t){return e+Math.floor(Math.random()*(t-e+1))}function EW(e,t){return e+Math.random()*(t-e)}function TW(e){return e*(.5-Math.random())}function PW(e){e!==void 0&&(gT=e);let t=gT+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}function DW(e){return e*Qp}function LW(e){return e*Of}function f2(e){return(e&e-1)===0&&e!==0}function uR(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function w0(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}function IW(e,t,r,i,n){let s=Math.cos,a=Math.sin,o=s(r/2),l=a(r/2),c=s((t+i)/2),u=a((t+i)/2),h=s((t-i)/2),d=a((t-i)/2),p=s((i-t)/2),f=a((i-t)/2);switch(n){case"XYX":e.set(o*u,l*h,l*d,o*c);break;case"YZY":e.set(l*d,o*u,l*h,o*c);break;case"ZXZ":e.set(l*h,l*d,o*u,o*c);break;case"XZX":e.set(o*u,l*f,l*p,o*c);break;case"YXY":e.set(l*p,o*u,l*f,o*c);break;case"ZYZ":e.set(l*f,l*p,o*u,o*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+n)}}function $a(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function qt(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return Math.round(e*65535);case Uint8Array:return Math.round(e*255);case Int16Array:return Math.round(e*32767);case Int8Array:return Math.round(e*127);default:throw new Error("Invalid component type.")}}var mt=Object.freeze({__proto__:null,DEG2RAD:Qp,RAD2DEG:Of,ceilPowerOfTwo:uR,clamp:Fr,damp:_W,degToRad:DW,denormalize:$a,euclideanModulo:_3,floorPowerOfTwo:w0,generateUUID:Kn,inverseLerp:bW,isPowerOfTwo:f2,lerp:Kp,mapLinear:wW,normalize:qt,pingpong:SW,radToDeg:LW,randFloat:EW,randFloatSpread:TW,randInt:MW,seededRandom:PW,setQuaternionFromProperEuler:IW,smootherstep:CW,smoothstep:AW}),W=class{constructor(e=0,t=0){W.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let t=this.x,r=this.y,i=e.elements;return this.x=i[0]*t+i[3]*r+i[6],this.y=i[1]*t+i[4]*r+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){let r=Math.cos(t),i=Math.sin(t),n=this.x-e.x,s=this.y-e.y;return this.x=n*r-s*i+e.x,this.y=n*i+s*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},Jr=class{constructor(){Jr.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,r,i,n,s,a,o,l){let c=this.elements;return c[0]=e,c[1]=i,c[2]=a,c[3]=t,c[4]=n,c[5]=o,c[6]=r,c[7]=s,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){let t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){let t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let r=e.elements,i=t.elements,n=this.elements,s=r[0],a=r[3],o=r[6],l=r[1],c=r[4],u=r[7],h=r[2],d=r[5],p=r[8],f=i[0],m=i[3],g=i[6],v=i[1],y=i[4],x=i[7],w=i[2],b=i[5],_=i[8];return n[0]=s*f+a*v+o*w,n[3]=s*m+a*y+o*b,n[6]=s*g+a*x+o*_,n[1]=l*f+c*v+u*w,n[4]=l*m+c*y+u*b,n[7]=l*g+c*x+u*_,n[2]=h*f+d*v+p*w,n[5]=h*m+d*y+p*b,n[8]=h*g+d*x+p*_,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){let e=this.elements,t=e[0],r=e[1],i=e[2],n=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8];return t*s*c-t*a*l-r*n*c+r*a*o+i*n*l-i*s*o}invert(){let e=this.elements,t=e[0],r=e[1],i=e[2],n=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8],u=c*s-a*l,h=a*o-c*n,d=l*n-s*o,p=t*u+r*h+i*d;if(p===0)return this.set(0,0,0,0,0,0,0,0,0);let f=1/p;return e[0]=u*f,e[1]=(i*l-c*r)*f,e[2]=(a*r-i*s)*f,e[3]=h*f,e[4]=(c*t-i*o)*f,e[5]=(i*n-a*t)*f,e[6]=d*f,e[7]=(r*o-l*t)*f,e[8]=(s*t-r*n)*f,this}transpose(){let e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){let t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,i,n,s,a){let o=Math.cos(n),l=Math.sin(n);return this.set(r*o,r*l,-r*(o*s+l*a)+s+e,-i*l,i*o,-i*(-l*s+o*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(hx.makeScale(e,t)),this}rotate(e){return this.premultiply(hx.makeRotation(-e)),this}translate(e,t){return this.premultiply(hx.makeTranslation(e,t)),this}makeTranslation(e,t){return this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){let t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,r,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){let t=this.elements,r=e.elements;for(let i=0;i<9;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){let r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}},hx=new Jr;function dR(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}var OW={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Wm(e,t){return new OW[e](t)}function b0(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function wc(e){return e<.04045?e*.0773993808:Math.pow(e*.9478672986+.0521327014,2.4)}function Cv(e){return e<.0031308?e*12.92:1.055*Math.pow(e,.41666)-.055}var ux={[Ks]:{[x0]:wc},[x0]:{[Ks]:Cv}},Ai={legacyMode:!0,get workingColorSpace(){return x0},set workingColorSpace(e){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(e,t,r){if(this.legacyMode||t===r||!t||!r)return e;if(ux[t]&&ux[t][r]!==void 0){let i=ux[t][r];return e.r=i(e.r),e.g=i(e.g),e.b=i(e.b),e}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(e,t){return this.convert(e,this.workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this.workingColorSpace)}},pR={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Or={r:0,g:0,b:0},as={h:0,s:0,l:0},qm={h:0,s:0,l:0};function dx(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*6*(2/3-r):e}function Xm(e,t){return t.r=e.r,t.g=e.g,t.b=e.b,t}var $e=class{constructor(t,r,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,r===void 0&&i===void 0?this.set(t):this.setRGB(t,r,i)}set(t){return t&&t.isColor?this.copy(t):typeof t=="number"?this.setHex(t):typeof t=="string"&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,r=Ks){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(t&255)/255,Ai.toWorkingColorSpace(this,r),this}setRGB(t,r,i,n=Ai.workingColorSpace){return this.r=t,this.g=r,this.b=i,Ai.toWorkingColorSpace(this,n),this}setHSL(t,r,i,n=Ai.workingColorSpace){if(t=_3(t,1),r=Fr(r,0,1),i=Fr(i,0,1),r===0)this.r=this.g=this.b=i;else{let s=i<=.5?i*(1+r):i+r-i*r,a=2*i-s;this.r=dx(a,s,t+1/3),this.g=dx(a,s,t),this.b=dx(a,s,t-1/3)}return Ai.toWorkingColorSpace(this,n),this}setStyle(t,r=Ks){function i(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let n;if(n=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let s,a=n[1],o=n[2];switch(a){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(s[1],10))/255,this.g=Math.min(255,parseInt(s[2],10))/255,this.b=Math.min(255,parseInt(s[3],10))/255,Ai.toWorkingColorSpace(this,r),i(s[4]),this;if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(s[1],10))/100,this.g=Math.min(100,parseInt(s[2],10))/100,this.b=Math.min(100,parseInt(s[3],10))/100,Ai.toWorkingColorSpace(this,r),i(s[4]),this;break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o)){let l=parseFloat(s[1])/360,c=parseFloat(s[2])/100,u=parseFloat(s[3])/100;return i(s[4]),this.setHSL(l,c,u,r)}break}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(t)){let s=n[1],a=s.length;if(a===3)return this.r=parseInt(s.charAt(0)+s.charAt(0),16)/255,this.g=parseInt(s.charAt(1)+s.charAt(1),16)/255,this.b=parseInt(s.charAt(2)+s.charAt(2),16)/255,Ai.toWorkingColorSpace(this,r),this;if(a===6)return this.r=parseInt(s.charAt(0)+s.charAt(1),16)/255,this.g=parseInt(s.charAt(2)+s.charAt(3),16)/255,this.b=parseInt(s.charAt(4)+s.charAt(5),16)/255,Ai.toWorkingColorSpace(this,r),this}return t&&t.length>0?this.setColorName(t,r):this}setColorName(t,r=Ks){let i=pR[t.toLowerCase()];return i!==void 0?this.setHex(i,r):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=wc(t.r),this.g=wc(t.g),this.b=wc(t.b),this}copyLinearToSRGB(t){return this.r=Cv(t.r),this.g=Cv(t.g),this.b=Cv(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=Ks){return Ai.fromWorkingColorSpace(Xm(this,Or),t),Fr(Or.r*255,0,255)<<16^Fr(Or.g*255,0,255)<<8^Fr(Or.b*255,0,255)<<0}getHexString(t=Ks){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,r=Ai.workingColorSpace){Ai.fromWorkingColorSpace(Xm(this,Or),r);let i=Or.r,n=Or.g,s=Or.b,a=Math.max(i,n,s),o=Math.min(i,n,s),l,c,u=(o+a)/2;if(o===a)l=0,c=0;else{let h=a-o;switch(c=u<=.5?h/(a+o):h/(2-a-o),a){case i:l=(n-s)/h+(n<s?6:0);break;case n:l=(s-i)/h+2;break;case s:l=(i-n)/h+4;break}l/=6}return t.h=l,t.s=c,t.l=u,t}getRGB(t,r=Ai.workingColorSpace){return Ai.fromWorkingColorSpace(Xm(this,Or),r),t.r=Or.r,t.g=Or.g,t.b=Or.b,t}getStyle(t=Ks){return Ai.fromWorkingColorSpace(Xm(this,Or),t),t!==Ks?`color(${t} ${Or.r} ${Or.g} ${Or.b})`:`rgb(${Or.r*255|0},${Or.g*255|0},${Or.b*255|0})`}offsetHSL(t,r,i){return this.getHSL(as),as.h+=t,as.s+=r,as.l+=i,this.setHSL(as.h,as.s,as.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,r){return this.r=t.r+r.r,this.g=t.g+r.g,this.b=t.b+r.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,r){return this.r+=(t.r-this.r)*r,this.g+=(t.g-this.g)*r,this.b+=(t.b-this.b)*r,this}lerpColors(t,r,i){return this.r=t.r+(r.r-t.r)*i,this.g=t.g+(r.g-t.g)*i,this.b=t.b+(r.b-t.b)*i,this}lerpHSL(t,r){this.getHSL(as),t.getHSL(qm);let i=Kp(as.h,qm.h,r),n=Kp(as.s,qm.s,r),s=Kp(as.l,qm.l,r);return this.setHSL(i,n,s),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,r=0){return this.r=t[r],this.g=t[r+1],this.b=t[r+2],this}toArray(t=[],r=0){return t[r]=this.r,t[r+1]=this.g,t[r+2]=this.b,t}fromBufferAttribute(t,r){return this.r=t.getX(r),this.g=t.getY(r),this.b=t.getZ(r),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};$e.NAMES=pR;var $c,fR=class{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{$c===void 0&&($c=b0("canvas")),$c.width=e.width,$c.height=e.height;let r=$c.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=$c}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){let t=b0("canvas");t.width=e.width,t.height=e.height;let r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);let i=r.getImageData(0,0,e.width,e.height),n=i.data;for(let s=0;s<n.length;s++)n[s]=wc(n[s]/255)*255;return r.putImageData(i,0,0),t}else if(e.data){let t=e.data.slice(0);for(let r=0;r<t.length;r++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[r]=Math.floor(wc(t[r]/255)*255):t[r]=wc(t[r]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}},mR=class{constructor(e=null){this.isSource=!0,this.uuid=Kn(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];let r={uuid:this.uuid,url:""},i=this.data;if(i!==null){let n;if(Array.isArray(i)){n=[];for(let s=0,a=i.length;s<a;s++)i[s].isDataTexture?n.push(px(i[s].image)):n.push(px(i[s]))}else n=px(i);r.url=n}return t||(e.images[this.uuid]=r),r}};function px(e){return typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap?fR.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var RW=0,jr=class extends ui{constructor(e=jr.DEFAULT_IMAGE,t=jr.DEFAULT_MAPPING,r=br,i=br,n=vt,s=Vu,a=Wn,o=Si,l=jr.DEFAULT_ANISOTROPY,c=fa){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:RW++}),this.uuid=Kn(),this.name="",this.source=new mR(e),this.mipmaps=[],this.mapping=t,this.wrapS=r,this.wrapT=i,this.magFilter=n,this.minFilter=s,this.anisotropy=l,this.format=a,this.internalFormat=null,this.type=o,this.offset=new W(0,0),this.repeat=new W(1,1),this.center=new W(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Jr,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];let r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),t||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==sR)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Za:e.x=e.x-Math.floor(e.x);break;case br:e.x=e.x<0?0:1;break;case u2:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Za:e.y=e.y-Math.floor(e.y);break;case br:e.y=e.y<0?0:1;break;case u2:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}};jr.DEFAULT_IMAGE=null;jr.DEFAULT_MAPPING=sR;jr.DEFAULT_ANISOTROPY=1;var dt=class{constructor(e=0,t=0,r=0,i=1){dt.prototype.isVector4=!0,this.x=e,this.y=t,this.z=r,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,i){return this.x=e,this.y=t,this.z=r,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let t=this.x,r=this.y,i=this.z,n=this.w,s=e.elements;return this.x=s[0]*t+s[4]*r+s[8]*i+s[12]*n,this.y=s[1]*t+s[5]*r+s[9]*i+s[13]*n,this.z=s[2]*t+s[6]*r+s[10]*i+s[14]*n,this.w=s[3]*t+s[7]*r+s[11]*i+s[15]*n,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,i,n,s=e.elements,a=s[0],o=s[4],l=s[8],c=s[1],u=s[5],h=s[9],d=s[2],p=s[6],f=s[10];if(Math.abs(o-c)<.01&&Math.abs(l-d)<.01&&Math.abs(h-p)<.01){if(Math.abs(o+c)<.1&&Math.abs(l+d)<.1&&Math.abs(h+p)<.1&&Math.abs(a+u+f-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;let g=(a+1)/2,v=(u+1)/2,y=(f+1)/2,x=(o+c)/4,w=(l+d)/4,b=(h+p)/4;return g>v&&g>y?g<.01?(r=0,i=.707106781,n=.707106781):(r=Math.sqrt(g),i=x/r,n=w/r):v>y?v<.01?(r=.707106781,i=0,n=.707106781):(i=Math.sqrt(v),r=x/i,n=b/i):y<.01?(r=.707106781,i=.707106781,n=0):(n=Math.sqrt(y),r=w/n,i=b/n),this.set(r,i,n,t),this}let m=Math.sqrt((p-h)*(p-h)+(l-d)*(l-d)+(c-o)*(c-o));return Math.abs(m)<.001&&(m=1),this.x=(p-h)/m,this.y=(l-d)/m,this.z=(c-o)/m,this.w=Math.acos((a+u+f-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},Ut=class extends ui{constructor(e=1,t=1,r={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new dt(0,0,e,t),this.scissorTest=!1,this.viewport=new dt(0,0,e,t);let i={width:e,height:t,depth:1};this.texture=new jr(i,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=r.generateMipmaps!==void 0?r.generateMipmaps:!1,this.texture.internalFormat=r.internalFormat!==void 0?r.internalFormat:null,this.texture.minFilter=r.minFilter!==void 0?r.minFilter:vt,this.depthBuffer=r.depthBuffer!==void 0?r.depthBuffer:!0,this.stencilBuffer=r.stencilBuffer!==void 0?r.stencilBuffer:!1,this.depthTexture=r.depthTexture!==void 0?r.depthTexture:null,this.samples=r.samples!==void 0?r.samples:0}setSize(e,t,r=1){(this.width!==e||this.height!==t||this.depth!==r)&&(this.width=e,this.height=t,this.depth=r,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=r,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;let t=Object.assign({},e.texture.image);return this.texture.source=new mR(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}},gR=class extends jr{constructor(e=null,t=1,r=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=Xt,this.minFilter=Xt,this.wrapR=br,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},BW=class extends jr{constructor(e=null,t=1,r=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=Xt,this.minFilter=Xt,this.wrapR=br,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},zW=class extends Ut{constructor(e=1,t=1,r=1,i={}){super(e,t,i),this.isWebGLMultipleRenderTargets=!0;let n=this.texture;this.texture=[];for(let s=0;s<r;s++)this.texture[s]=n.clone(),this.texture[s].isRenderTargetTexture=!0}setSize(e,t,r=1){if(this.width!==e||this.height!==t||this.depth!==r){this.width=e,this.height=t,this.depth=r;for(let i=0,n=this.texture.length;i<n;i++)this.texture[i].image.width=e,this.texture[i].image.height=t,this.texture[i].image.depth=r;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let t=0,r=e.texture.length;t<r;t++)this.texture[t]=e.texture[t].clone(),this.texture[t].isRenderTargetTexture=!0;return this}},ft=class{constructor(e=0,t=0,r=0,i=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=i}static slerpFlat(e,t,r,i,n,s,a){let o=r[i+0],l=r[i+1],c=r[i+2],u=r[i+3],h=n[s+0],d=n[s+1],p=n[s+2],f=n[s+3];if(a===0){e[t+0]=o,e[t+1]=l,e[t+2]=c,e[t+3]=u;return}if(a===1){e[t+0]=h,e[t+1]=d,e[t+2]=p,e[t+3]=f;return}if(u!==f||o!==h||l!==d||c!==p){let m=1-a,g=o*h+l*d+c*p+u*f,v=g>=0?1:-1,y=1-g*g;if(y>Number.EPSILON){let w=Math.sqrt(y),b=Math.atan2(w,g*v);m=Math.sin(m*b)/w,a=Math.sin(a*b)/w}let x=a*v;if(o=o*m+h*x,l=l*m+d*x,c=c*m+p*x,u=u*m+f*x,m===1-a){let w=1/Math.sqrt(o*o+l*l+c*c+u*u);o*=w,l*=w,c*=w,u*=w}}e[t]=o,e[t+1]=l,e[t+2]=c,e[t+3]=u}static multiplyQuaternionsFlat(e,t,r,i,n,s){let a=r[i],o=r[i+1],l=r[i+2],c=r[i+3],u=n[s],h=n[s+1],d=n[s+2],p=n[s+3];return e[t]=a*p+c*u+o*d-l*h,e[t+1]=o*p+c*h+l*u-a*d,e[t+2]=l*p+c*d+a*h-o*u,e[t+3]=c*p-a*u-o*h-l*d,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,i){return this._x=e,this._y=t,this._z=r,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){let r=e._x,i=e._y,n=e._z,s=e._order,a=Math.cos,o=Math.sin,l=a(r/2),c=a(i/2),u=a(n/2),h=o(r/2),d=o(i/2),p=o(n/2);switch(s){case"XYZ":this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p;break;case"YXZ":this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p;break;case"ZXY":this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p;break;case"ZYX":this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p;break;case"YZX":this._x=h*c*u+l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u-h*d*p;break;case"XZY":this._x=h*c*u-l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u+h*d*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){let r=t/2,i=Math.sin(r);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){let t=e.elements,r=t[0],i=t[4],n=t[8],s=t[1],a=t[5],o=t[9],l=t[2],c=t[6],u=t[10],h=r+a+u;if(h>0){let d=.5/Math.sqrt(h+1);this._w=.25/d,this._x=(c-o)*d,this._y=(n-l)*d,this._z=(s-i)*d}else if(r>a&&r>u){let d=2*Math.sqrt(1+r-a-u);this._w=(c-o)/d,this._x=.25*d,this._y=(i+s)/d,this._z=(n+l)/d}else if(a>u){let d=2*Math.sqrt(1+a-r-u);this._w=(n-l)/d,this._x=(i+s)/d,this._y=.25*d,this._z=(o+c)/d}else{let d=2*Math.sqrt(1+u-r-a);this._w=(s-i)/d,this._x=(n+l)/d,this._y=(o+c)/d,this._z=.25*d}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Fr(this.dot(e),-1,1)))}rotateTowards(e,t){let r=this.angleTo(e);if(r===0)return this;let i=Math.min(1,t/r);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){let r=e._x,i=e._y,n=e._z,s=e._w,a=t._x,o=t._y,l=t._z,c=t._w;return this._x=r*c+s*a+i*l-n*o,this._y=i*c+s*o+n*a-r*l,this._z=n*c+s*l+r*o-i*a,this._w=s*c-r*a-i*o-n*l,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);let r=this._x,i=this._y,n=this._z,s=this._w,a=s*e._w+r*e._x+i*e._y+n*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=s,this._x=r,this._y=i,this._z=n,this;let o=1-a*a;if(o<=Number.EPSILON){let d=1-t;return this._w=d*s+t*this._w,this._x=d*r+t*this._x,this._y=d*i+t*this._y,this._z=d*n+t*this._z,this.normalize(),this._onChangeCallback(),this}let l=Math.sqrt(o),c=Math.atan2(l,a),u=Math.sin((1-t)*c)/l,h=Math.sin(t*c)/l;return this._w=s*u+this._w*h,this._x=r*u+this._x*h,this._y=i*u+this._y*h,this._z=n*u+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){let e=Math.random(),t=Math.sqrt(1-e),r=Math.sqrt(e),i=2*Math.PI*Math.random(),n=2*Math.PI*Math.random();return this.set(t*Math.cos(i),r*Math.sin(n),r*Math.cos(n),t*Math.sin(i))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},E=class{constructor(e=0,t=0,r=0){E.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}set(e,t,r){return r===void 0&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(vT.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(vT.setFromAxisAngle(e,t))}applyMatrix3(e){let t=this.x,r=this.y,i=this.z,n=e.elements;return this.x=n[0]*t+n[3]*r+n[6]*i,this.y=n[1]*t+n[4]*r+n[7]*i,this.z=n[2]*t+n[5]*r+n[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let t=this.x,r=this.y,i=this.z,n=e.elements,s=1/(n[3]*t+n[7]*r+n[11]*i+n[15]);return this.x=(n[0]*t+n[4]*r+n[8]*i+n[12])*s,this.y=(n[1]*t+n[5]*r+n[9]*i+n[13])*s,this.z=(n[2]*t+n[6]*r+n[10]*i+n[14])*s,this}applyQuaternion(e){let t=this.x,r=this.y,i=this.z,n=e.x,s=e.y,a=e.z,o=e.w,l=o*t+s*i-a*r,c=o*r+a*t-n*i,u=o*i+n*r-s*t,h=-n*t-s*r-a*i;return this.x=l*o+h*-n+c*-a-u*-s,this.y=c*o+h*-s+u*-n-l*-a,this.z=u*o+h*-a+l*-s-c*-n,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let t=this.x,r=this.y,i=this.z,n=e.elements;return this.x=n[0]*t+n[4]*r+n[8]*i,this.y=n[1]*t+n[5]*r+n[9]*i,this.z=n[2]*t+n[6]*r+n[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){let r=e.x,i=e.y,n=e.z,s=t.x,a=t.y,o=t.z;return this.x=i*o-n*a,this.y=n*s-r*o,this.z=r*a-i*s,this}projectOnVector(e){let t=e.lengthSq();if(t===0)return this.set(0,0,0);let r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return fx.copy(this).projectOnVector(e),this.sub(fx)}reflect(e){return this.sub(fx.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;let r=this.dot(e)/t;return Math.acos(Fr(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,r=this.y-e.y,i=this.z-e.z;return t*t+r*r+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){let i=Math.sin(t)*e;return this.x=i*Math.sin(r),this.y=Math.cos(t)*e,this.z=i*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){let t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,r=Math.sqrt(1-e**2);return this.x=r*Math.cos(t),this.y=r*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}},fx=new E,vT=new ft,Ar=class{constructor(e=new E(1/0,1/0,1/0),t=new E(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,r=1/0,i=1/0,n=-1/0,s=-1/0,a=-1/0;for(let o=0,l=e.length;o<l;o+=3){let c=e[o],u=e[o+1],h=e[o+2];c<t&&(t=c),u<r&&(r=u),h<i&&(i=h),c>n&&(n=c),u>s&&(s=u),h>a&&(a=h)}return this.min.set(t,r,i),this.max.set(n,s,a),this}setFromBufferAttribute(e){let t=1/0,r=1/0,i=1/0,n=-1/0,s=-1/0,a=-1/0;for(let o=0,l=e.count;o<l;o++){let c=e.getX(o),u=e.getY(o),h=e.getZ(o);c<t&&(t=c),u<r&&(r=u),h<i&&(i=h),c>n&&(n=c),u>s&&(s=u),h>a&&(a=h)}return this.min.set(t,r,i),this.max.set(n,s,a),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let r=Nl.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);let r=e.geometry;if(r!==void 0)if(t&&r.attributes!=null&&r.attributes.position!==void 0){let n=r.attributes.position;for(let s=0,a=n.count;s<a;s++)Nl.fromBufferAttribute(n,s).applyMatrix4(e.matrixWorld),this.expandByPoint(Nl)}else r.boundingBox===null&&r.computeBoundingBox(),mx.copy(r.boundingBox),mx.applyMatrix4(e.matrixWorld),this.union(mx);let i=e.children;for(let n=0,s=i.length;n<s;n++)this.expandByObject(i[n],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Nl),Nl.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Vd),Ym.subVectors(this.max,Vd),Jc.subVectors(e.a,Vd),eh.subVectors(e.b,Vd),th.subVectors(e.c,Vd),wo.subVectors(eh,Jc),bo.subVectors(th,eh),Fl.subVectors(Jc,th);let t=[0,-wo.z,wo.y,0,-bo.z,bo.y,0,-Fl.z,Fl.y,wo.z,0,-wo.x,bo.z,0,-bo.x,Fl.z,0,-Fl.x,-wo.y,wo.x,0,-bo.y,bo.x,0,-Fl.y,Fl.x,0];return!gx(t,Jc,eh,th,Ym)||(t=[1,0,0,0,1,0,0,0,1],!gx(t,Jc,eh,th,Ym))?!1:(Qm.crossVectors(wo,bo),t=[Qm.x,Qm.y,Qm.z],gx(t,Jc,eh,th,Ym))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Nl.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=this.getSize(Nl).length()*.5,e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Aa[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Aa[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Aa[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Aa[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Aa[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Aa[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Aa[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Aa[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Aa),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},Aa=[new E,new E,new E,new E,new E,new E,new E,new E],Nl=new E,mx=new Ar,Jc=new E,eh=new E,th=new E,wo=new E,bo=new E,Fl=new E,Vd=new E,Ym=new E,Qm=new E,Ul=new E;function gx(e,t,r,i,n){for(let s=0,a=e.length-3;s<=a;s+=3){Ul.fromArray(e,s);let o=n.x*Math.abs(Ul.x)+n.y*Math.abs(Ul.y)+n.z*Math.abs(Ul.z),l=t.dot(Ul),c=r.dot(Ul),u=i.dot(Ul);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>o)return!1}return!0}var kW=new Ar,Hd=new E,vx=new E,Mn=class{constructor(e=new E,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){let r=this.center;t!==void 0?r.copy(t):kW.setFromPoints(e).getCenter(r);let i=0;for(let n=0,s=e.length;n<s;n++)i=Math.max(i,r.distanceToSquared(e[n]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){let t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){let r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Hd.subVectors(e,this.center);let t=Hd.lengthSq();if(t>this.radius*this.radius){let r=Math.sqrt(t),i=(r-this.radius)*.5;this.center.addScaledVector(Hd,i/r),this.radius+=i}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(vx.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Hd.copy(e.center).add(vx)),this.expandByPoint(Hd.copy(e.center).sub(vx))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}},Ca=new E,yx=new E,Km=new E,_o=new E,xx=new E,Zm=new E,wx=new E,hd=class{constructor(e=new E,t=new E(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Ca)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);let r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(r).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){let t=Ca.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Ca.copy(this.direction).multiplyScalar(t).add(this.origin),Ca.distanceToSquared(e))}distanceSqToSegment(e,t,r,i){yx.copy(e).add(t).multiplyScalar(.5),Km.copy(t).sub(e).normalize(),_o.copy(this.origin).sub(yx);let n=e.distanceTo(t)*.5,s=-this.direction.dot(Km),a=_o.dot(this.direction),o=-_o.dot(Km),l=_o.lengthSq(),c=Math.abs(1-s*s),u,h,d,p;if(c>0)if(u=s*o-a,h=s*a-o,p=n*c,u>=0)if(h>=-p)if(h<=p){let f=1/c;u*=f,h*=f,d=u*(u+s*h+2*a)+h*(s*u+h+2*o)+l}else h=n,u=Math.max(0,-(s*h+a)),d=-u*u+h*(h+2*o)+l;else h=-n,u=Math.max(0,-(s*h+a)),d=-u*u+h*(h+2*o)+l;else h<=-p?(u=Math.max(0,-(-s*n+a)),h=u>0?-n:Math.min(Math.max(-n,-o),n),d=-u*u+h*(h+2*o)+l):h<=p?(u=0,h=Math.min(Math.max(-n,-o),n),d=h*(h+2*o)+l):(u=Math.max(0,-(s*n+a)),h=u>0?n:Math.min(Math.max(-n,-o),n),d=-u*u+h*(h+2*o)+l);else h=s>0?-n:n,u=Math.max(0,-(s*h+a)),d=-u*u+h*(h+2*o)+l;return r&&r.copy(this.direction).multiplyScalar(u).add(this.origin),i&&i.copy(Km).multiplyScalar(h).add(yx),d}intersectSphere(e,t){Ca.subVectors(e.center,this.origin);let r=Ca.dot(this.direction),i=Ca.dot(Ca)-r*r,n=e.radius*e.radius;if(i>n)return null;let s=Math.sqrt(n-i),a=r-s,o=r+s;return a<0&&o<0?null:a<0?this.at(o,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){let t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;let r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){let r=this.distanceToPlane(e);return r===null?null:this.at(r,t)}intersectsPlane(e){let t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let r,i,n,s,a,o,l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,h=this.origin;return l>=0?(r=(e.min.x-h.x)*l,i=(e.max.x-h.x)*l):(r=(e.max.x-h.x)*l,i=(e.min.x-h.x)*l),c>=0?(n=(e.min.y-h.y)*c,s=(e.max.y-h.y)*c):(n=(e.max.y-h.y)*c,s=(e.min.y-h.y)*c),r>s||n>i||((n>r||isNaN(r))&&(r=n),(s<i||isNaN(i))&&(i=s),u>=0?(a=(e.min.z-h.z)*u,o=(e.max.z-h.z)*u):(a=(e.max.z-h.z)*u,o=(e.min.z-h.z)*u),r>o||a>i)||((a>r||r!==r)&&(r=a),(o<i||i!==i)&&(i=o),i<0)?null:this.at(r>=0?r:i,t)}intersectsBox(e){return this.intersectBox(e,Ca)!==null}intersectTriangle(e,t,r,i,n){xx.subVectors(t,e),Zm.subVectors(r,e),wx.crossVectors(xx,Zm);let s=this.direction.dot(wx),a;if(s>0){if(i)return null;a=1}else if(s<0)a=-1,s=-s;else return null;_o.subVectors(this.origin,e);let o=a*this.direction.dot(Zm.crossVectors(_o,Zm));if(o<0)return null;let l=a*this.direction.dot(xx.cross(_o));if(l<0||o+l>s)return null;let c=-a*_o.dot(wx);return c<0?null:this.at(c/s,n)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},_e=class{constructor(){_e.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,r,i,n,s,a,o,l,c,u,h,d,p,f,m){let g=this.elements;return g[0]=e,g[4]=t,g[8]=r,g[12]=i,g[1]=n,g[5]=s,g[9]=a,g[13]=o,g[2]=l,g[6]=c,g[10]=u,g[14]=h,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new _e().fromArray(this.elements)}copy(e){let t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){let t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){let t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){let t=this.elements,r=e.elements,i=1/rh.setFromMatrixColumn(e,0).length(),n=1/rh.setFromMatrixColumn(e,1).length(),s=1/rh.setFromMatrixColumn(e,2).length();return t[0]=r[0]*i,t[1]=r[1]*i,t[2]=r[2]*i,t[3]=0,t[4]=r[4]*n,t[5]=r[5]*n,t[6]=r[6]*n,t[7]=0,t[8]=r[8]*s,t[9]=r[9]*s,t[10]=r[10]*s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){let t=this.elements,r=e.x,i=e.y,n=e.z,s=Math.cos(r),a=Math.sin(r),o=Math.cos(i),l=Math.sin(i),c=Math.cos(n),u=Math.sin(n);if(e.order==="XYZ"){let h=s*c,d=s*u,p=a*c,f=a*u;t[0]=o*c,t[4]=-o*u,t[8]=l,t[1]=d+p*l,t[5]=h-f*l,t[9]=-a*o,t[2]=f-h*l,t[6]=p+d*l,t[10]=s*o}else if(e.order==="YXZ"){let h=o*c,d=o*u,p=l*c,f=l*u;t[0]=h+f*a,t[4]=p*a-d,t[8]=s*l,t[1]=s*u,t[5]=s*c,t[9]=-a,t[2]=d*a-p,t[6]=f+h*a,t[10]=s*o}else if(e.order==="ZXY"){let h=o*c,d=o*u,p=l*c,f=l*u;t[0]=h-f*a,t[4]=-s*u,t[8]=p+d*a,t[1]=d+p*a,t[5]=s*c,t[9]=f-h*a,t[2]=-s*l,t[6]=a,t[10]=s*o}else if(e.order==="ZYX"){let h=s*c,d=s*u,p=a*c,f=a*u;t[0]=o*c,t[4]=p*l-d,t[8]=h*l+f,t[1]=o*u,t[5]=f*l+h,t[9]=d*l-p,t[2]=-l,t[6]=a*o,t[10]=s*o}else if(e.order==="YZX"){let h=s*o,d=s*l,p=a*o,f=a*l;t[0]=o*c,t[4]=f-h*u,t[8]=p*u+d,t[1]=u,t[5]=s*c,t[9]=-a*c,t[2]=-l*c,t[6]=d*u+p,t[10]=h-f*u}else if(e.order==="XZY"){let h=s*o,d=s*l,p=a*o,f=a*l;t[0]=o*c,t[4]=-u,t[8]=l*c,t[1]=h*u+f,t[5]=s*c,t[9]=d*u-p,t[2]=p*u-d,t[6]=a*c,t[10]=f*u+h}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(NW,e,FW)}lookAt(e,t,r){let i=this.elements;return un.subVectors(e,t),un.lengthSq()===0&&(un.z=1),un.normalize(),So.crossVectors(r,un),So.lengthSq()===0&&(Math.abs(r.z)===1?un.x+=1e-4:un.z+=1e-4,un.normalize(),So.crossVectors(r,un)),So.normalize(),$m.crossVectors(un,So),i[0]=So.x,i[4]=$m.x,i[8]=un.x,i[1]=So.y,i[5]=$m.y,i[9]=un.y,i[2]=So.z,i[6]=$m.z,i[10]=un.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let r=e.elements,i=t.elements,n=this.elements,s=r[0],a=r[4],o=r[8],l=r[12],c=r[1],u=r[5],h=r[9],d=r[13],p=r[2],f=r[6],m=r[10],g=r[14],v=r[3],y=r[7],x=r[11],w=r[15],b=i[0],_=i[4],A=i[8],S=i[12],C=i[1],M=i[5],T=i[9],P=i[13],D=i[2],I=i[6],B=i[10],X=i[14],H=i[3],R=i[7],q=i[11],F=i[15];return n[0]=s*b+a*C+o*D+l*H,n[4]=s*_+a*M+o*I+l*R,n[8]=s*A+a*T+o*B+l*q,n[12]=s*S+a*P+o*X+l*F,n[1]=c*b+u*C+h*D+d*H,n[5]=c*_+u*M+h*I+d*R,n[9]=c*A+u*T+h*B+d*q,n[13]=c*S+u*P+h*X+d*F,n[2]=p*b+f*C+m*D+g*H,n[6]=p*_+f*M+m*I+g*R,n[10]=p*A+f*T+m*B+g*q,n[14]=p*S+f*P+m*X+g*F,n[3]=v*b+y*C+x*D+w*H,n[7]=v*_+y*M+x*I+w*R,n[11]=v*A+y*T+x*B+w*q,n[15]=v*S+y*P+x*X+w*F,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){let e=this.elements,t=e[0],r=e[4],i=e[8],n=e[12],s=e[1],a=e[5],o=e[9],l=e[13],c=e[2],u=e[6],h=e[10],d=e[14],p=e[3],f=e[7],m=e[11],g=e[15];return p*(+n*o*u-i*l*u-n*a*h+r*l*h+i*a*d-r*o*d)+f*(+t*o*d-t*l*h+n*s*h-i*s*d+i*l*c-n*o*c)+m*(+t*l*u-t*a*d-n*s*u+r*s*d+n*a*c-r*l*c)+g*(-i*a*c-t*o*u+t*a*h+i*s*u-r*s*h+r*o*c)}transpose(){let e=this.elements,t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){let i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=r),this}invert(){let e=this.elements,t=e[0],r=e[1],i=e[2],n=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11],p=e[12],f=e[13],m=e[14],g=e[15],v=u*m*l-f*h*l+f*o*d-a*m*d-u*o*g+a*h*g,y=p*h*l-c*m*l-p*o*d+s*m*d+c*o*g-s*h*g,x=c*f*l-p*u*l+p*a*d-s*f*d-c*a*g+s*u*g,w=p*u*o-c*f*o-p*a*h+s*f*h+c*a*m-s*u*m,b=t*v+r*y+i*x+n*w;if(b===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let _=1/b;return e[0]=v*_,e[1]=(f*h*n-u*m*n-f*i*d+r*m*d+u*i*g-r*h*g)*_,e[2]=(a*m*n-f*o*n+f*i*l-r*m*l-a*i*g+r*o*g)*_,e[3]=(u*o*n-a*h*n-u*i*l+r*h*l+a*i*d-r*o*d)*_,e[4]=y*_,e[5]=(c*m*n-p*h*n+p*i*d-t*m*d-c*i*g+t*h*g)*_,e[6]=(p*o*n-s*m*n-p*i*l+t*m*l+s*i*g-t*o*g)*_,e[7]=(s*h*n-c*o*n+c*i*l-t*h*l-s*i*d+t*o*d)*_,e[8]=x*_,e[9]=(p*u*n-c*f*n-p*r*d+t*f*d+c*r*g-t*u*g)*_,e[10]=(s*f*n-p*a*n+p*r*l-t*f*l-s*r*g+t*a*g)*_,e[11]=(c*a*n-s*u*n-c*r*l+t*u*l+s*r*d-t*a*d)*_,e[12]=w*_,e[13]=(c*f*i-p*u*i+p*r*h-t*f*h-c*r*m+t*u*m)*_,e[14]=(p*a*i-s*f*i-p*r*o+t*f*o+s*r*m-t*a*m)*_,e[15]=(s*u*i-c*a*i+c*r*o-t*u*o-s*r*h+t*a*h)*_,this}scale(e){let t=this.elements,r=e.x,i=e.y,n=e.z;return t[0]*=r,t[4]*=i,t[8]*=n,t[1]*=r,t[5]*=i,t[9]*=n,t[2]*=r,t[6]*=i,t[10]*=n,t[3]*=r,t[7]*=i,t[11]*=n,this}getMaxScaleOnAxis(){let e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,i))}makeTranslation(e,t,r){return this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){let t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){let t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){let t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){let r=Math.cos(t),i=Math.sin(t),n=1-r,s=e.x,a=e.y,o=e.z,l=n*s,c=n*a;return this.set(l*s+r,l*a-i*o,l*o+i*a,0,l*a+i*o,c*a+r,c*o-i*s,0,l*o-i*a,c*o+i*s,n*o*o+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,i,n,s){return this.set(1,r,n,0,e,1,s,0,t,i,1,0,0,0,0,1),this}compose(e,t,r){let i=this.elements,n=t._x,s=t._y,a=t._z,o=t._w,l=n+n,c=s+s,u=a+a,h=n*l,d=n*c,p=n*u,f=s*c,m=s*u,g=a*u,v=o*l,y=o*c,x=o*u,w=r.x,b=r.y,_=r.z;return i[0]=(1-(f+g))*w,i[1]=(d+x)*w,i[2]=(p-y)*w,i[3]=0,i[4]=(d-x)*b,i[5]=(1-(h+g))*b,i[6]=(m+v)*b,i[7]=0,i[8]=(p+y)*_,i[9]=(m-v)*_,i[10]=(1-(h+f))*_,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,r){let i=this.elements,n=rh.set(i[0],i[1],i[2]).length(),s=rh.set(i[4],i[5],i[6]).length(),a=rh.set(i[8],i[9],i[10]).length();this.determinant()<0&&(n=-n),e.x=i[12],e.y=i[13],e.z=i[14],os.copy(this);let o=1/n,l=1/s,c=1/a;return os.elements[0]*=o,os.elements[1]*=o,os.elements[2]*=o,os.elements[4]*=l,os.elements[5]*=l,os.elements[6]*=l,os.elements[8]*=c,os.elements[9]*=c,os.elements[10]*=c,t.setFromRotationMatrix(os),r.x=n,r.y=s,r.z=a,this}makePerspective(e,t,r,i,n,s){let a=this.elements,o=2*n/(t-e),l=2*n/(r-i),c=(t+e)/(t-e),u=(r+i)/(r-i),h=-(s+n)/(s-n),d=-2*s*n/(s-n);return a[0]=o,a[4]=0,a[8]=c,a[12]=0,a[1]=0,a[5]=l,a[9]=u,a[13]=0,a[2]=0,a[6]=0,a[10]=h,a[14]=d,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,r,i,n,s){let a=this.elements,o=1/(t-e),l=1/(r-i),c=1/(s-n),u=(t+e)*o,h=(r+i)*l,d=(s+n)*c;return a[0]=2*o,a[4]=0,a[8]=0,a[12]=-u,a[1]=0,a[5]=2*l,a[9]=0,a[13]=-h,a[2]=0,a[6]=0,a[10]=-2*c,a[14]=-d,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){let t=this.elements,r=e.elements;for(let i=0;i<16;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){let r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}},rh=new E,os=new _e,NW=new E(0,0,0),FW=new E(1,1,1),So=new E,$m=new E,un=new E,yT=new _e,xT=new ft,Zr=class{constructor(e=0,t=0,r=0,i=Zr.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=r,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,i=this._order){return this._x=e,this._y=t,this._z=r,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){let i=e.elements,n=i[0],s=i[4],a=i[8],o=i[1],l=i[5],c=i[9],u=i[2],h=i[6],d=i[10];switch(t){case"XYZ":this._y=Math.asin(Fr(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-s,n)):(this._x=Math.atan2(h,l),this._z=0);break;case"YXZ":this._x=Math.asin(-Fr(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(a,d),this._z=Math.atan2(o,l)):(this._y=Math.atan2(-u,n),this._z=0);break;case"ZXY":this._x=Math.asin(Fr(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-u,d),this._z=Math.atan2(-s,l)):(this._y=0,this._z=Math.atan2(o,n));break;case"ZYX":this._y=Math.asin(-Fr(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(h,d),this._z=Math.atan2(o,n)):(this._x=0,this._z=Math.atan2(-s,l));break;case"YZX":this._z=Math.asin(Fr(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-u,n)):(this._x=0,this._y=Math.atan2(a,d));break;case"XZY":this._z=Math.asin(-Fr(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(a,n)):(this._x=Math.atan2(-c,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return yT.makeRotationFromQuaternion(e),this.setFromRotationMatrix(yT,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return xT.setFromEuler(this),this.setFromQuaternion(xT,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};Zr.DEFAULT_ORDER="XYZ";var S3=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}},UW=0,wT=new E,ih=new ft,Ma=new _e,Jm=new E,Gd=new E,jW=new E,VW=new ft,bT=new E(1,0,0),_T=new E(0,1,0),ST=new E(0,0,1),HW={type:"added"},AT={type:"removed"},Vt=class extends ui{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:UW++}),this.uuid=Kn(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Vt.DEFAULT_UP.clone();let e=new E,t=new Zr,r=new ft,i=new E(1,1,1);function n(){r.setFromEuler(t,!1)}function s(){t.setFromQuaternion(r,void 0,!1)}t._onChange(n),r._onChange(s),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new _e},normalMatrix:{value:new Jr}}),this.matrix=new _e,this.matrixWorld=new _e,this.matrixAutoUpdate=Vt.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=Vt.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new S3,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return ih.setFromAxisAngle(e,t),this.quaternion.multiply(ih),this}rotateOnWorldAxis(e,t){return ih.setFromAxisAngle(e,t),this.quaternion.premultiply(ih),this}rotateX(e){return this.rotateOnAxis(bT,e)}rotateY(e){return this.rotateOnAxis(_T,e)}rotateZ(e){return this.rotateOnAxis(ST,e)}translateOnAxis(e,t){return wT.copy(e).applyQuaternion(this.quaternion),this.position.add(wT.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(bT,e)}translateY(e){return this.translateOnAxis(_T,e)}translateZ(e){return this.translateOnAxis(ST,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Ma.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?Jm.copy(e):Jm.set(e,t,r);let i=this.parent;this.updateWorldMatrix(!0,!1),Gd.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Ma.lookAt(Gd,Jm,this.up):Ma.lookAt(Jm,Gd,this.up),this.quaternion.setFromRotationMatrix(Ma),i&&(Ma.extractRotation(i.matrixWorld),ih.setFromRotationMatrix(Ma),this.quaternion.premultiply(ih.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(HW)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}let t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(AT)),this}removeFromParent(){let e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){let t=this.children[e];t.parent=null,t.dispatchEvent(AT)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),Ma.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Ma.multiply(e.parent.matrixWorld)),e.applyMatrix4(Ma),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,i=this.children.length;r<i;r++){let n=this.children[r].getObjectByProperty(e,t);if(n!==void 0)return n}}getObjectsByProperty(e,t){let r=[];this[e]===t&&r.push(this);for(let i=0,n=this.children.length;i<n;i++){let s=this.children[i].getObjectsByProperty(e,t);s.length>0&&(r=r.concat(s))}return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Gd,e,jW),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Gd,VW,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);let t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);let t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverseVisible(e)}traverseAncestors(e){let t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);let t=this.children;for(let r=0,i=t.length;r<i;r++){let n=t[r];(n.matrixWorldAutoUpdate===!0||e===!0)&&n.updateMatrixWorld(e)}}updateWorldMatrix(e,t){let r=this.parent;if(e===!0&&r!==null&&r.matrixWorldAutoUpdate===!0&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){let i=this.children;for(let n=0,s=i.length;n<s;n++){let a=i[n];a.matrixWorldAutoUpdate===!0&&a.updateWorldMatrix(!1,!0)}}}toJSON(e){let t=e===void 0||typeof e=="string",r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});let i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON()));function n(a,o){return a[o.uuid]===void 0&&(a[o.uuid]=o.toJSON(e)),o.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=n(e.geometries,this.geometry);let a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){let o=a.shapes;if(Array.isArray(o))for(let l=0,c=o.length;l<c;l++){let u=o[l];n(e.shapes,u)}else n(e.shapes,o)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(n(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let a=[];for(let o=0,l=this.material.length;o<l;o++)a.push(n(e.materials,this.material[o]));i.material=a}else i.material=n(e.materials,this.material);if(this.children.length>0){i.children=[];for(let a=0;a<this.children.length;a++)i.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let a=0;a<this.animations.length;a++){let o=this.animations[a];i.animations.push(n(e.animations,o))}}if(t){let a=s(e.geometries),o=s(e.materials),l=s(e.textures),c=s(e.images),u=s(e.shapes),h=s(e.skeletons),d=s(e.animations),p=s(e.nodes);a.length>0&&(r.geometries=a),o.length>0&&(r.materials=o),l.length>0&&(r.textures=l),c.length>0&&(r.images=c),u.length>0&&(r.shapes=u),h.length>0&&(r.skeletons=h),d.length>0&&(r.animations=d),p.length>0&&(r.nodes=p)}return r.object=i,r;function s(a){let o=[];for(let l in a){let c=a[l];delete c.metadata,o.push(c)}return o}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let r=0;r<e.children.length;r++){let i=e.children[r];this.add(i.clone())}return this}};Vt.DEFAULT_UP=new E(0,1,0);Vt.DEFAULT_MATRIX_AUTO_UPDATE=!0;Vt.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;var ls=new E,Ea=new E,bx=new E,Ta=new E,nh=new E,sh=new E,CT=new E,_x=new E,Sx=new E,Ax=new E,yi=class{constructor(e=new E,t=new E,r=new E){this.a=e,this.b=t,this.c=r}static getNormal(e,t,r,i){i.subVectors(r,t),ls.subVectors(e,t),i.cross(ls);let n=i.lengthSq();return n>0?i.multiplyScalar(1/Math.sqrt(n)):i.set(0,0,0)}static getBarycoord(e,t,r,i,n){ls.subVectors(i,t),Ea.subVectors(r,t),bx.subVectors(e,t);let s=ls.dot(ls),a=ls.dot(Ea),o=ls.dot(bx),l=Ea.dot(Ea),c=Ea.dot(bx),u=s*l-a*a;if(u===0)return n.set(-2,-1,-1);let h=1/u,d=(l*o-a*c)*h,p=(s*c-a*o)*h;return n.set(1-d-p,p,d)}static containsPoint(e,t,r,i){return this.getBarycoord(e,t,r,i,Ta),Ta.x>=0&&Ta.y>=0&&Ta.x+Ta.y<=1}static getUV(e,t,r,i,n,s,a,o){return this.getBarycoord(e,t,r,i,Ta),o.set(0,0),o.addScaledVector(n,Ta.x),o.addScaledVector(s,Ta.y),o.addScaledVector(a,Ta.z),o}static isFrontFacing(e,t,r,i){return ls.subVectors(r,t),Ea.subVectors(e,t),ls.cross(Ea).dot(i)<0}set(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this}setFromPointsAndIndices(e,t,r,i){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,r,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return ls.subVectors(this.c,this.b),Ea.subVectors(this.a,this.b),ls.cross(Ea).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return yi.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return yi.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,r,i,n){return yi.getUV(e,this.a,this.b,this.c,t,r,i,n)}containsPoint(e){return yi.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return yi.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){let r=this.a,i=this.b,n=this.c,s,a;nh.subVectors(i,r),sh.subVectors(n,r),_x.subVectors(e,r);let o=nh.dot(_x),l=sh.dot(_x);if(o<=0&&l<=0)return t.copy(r);Sx.subVectors(e,i);let c=nh.dot(Sx),u=sh.dot(Sx);if(c>=0&&u<=c)return t.copy(i);let h=o*u-c*l;if(h<=0&&o>=0&&c<=0)return s=o/(o-c),t.copy(r).addScaledVector(nh,s);Ax.subVectors(e,n);let d=nh.dot(Ax),p=sh.dot(Ax);if(p>=0&&d<=p)return t.copy(n);let f=d*l-o*p;if(f<=0&&l>=0&&p<=0)return a=l/(l-p),t.copy(r).addScaledVector(sh,a);let m=c*p-d*u;if(m<=0&&u-c>=0&&d-p>=0)return CT.subVectors(n,i),a=(u-c)/(u-c+(d-p)),t.copy(i).addScaledVector(CT,a);let g=1/(m+f+h);return s=f*g,a=h*g,t.copy(r).addScaledVector(nh,s).addScaledVector(sh,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}},GW=0,um=class extends ui{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:GW++}),this.uuid=Kn(),this.name="",this.type="Material",this.blending=mu,this.side=Ds,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=rR,this.blendDst=iR,this.blendEquation=Dh,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=l2,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=xW,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=cx,this.stencilZFail=cx,this.stencilZPass=cx,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(let t in e){let r=e[t];if(r===void 0){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}let i=this[t];if(i===void 0){console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.");continue}i&&i.isColor?i.set(r):i&&i.isVector3&&r&&r.isVector3?i.copy(r):this[t]=r}}toJSON(e){let t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});let r={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==mu&&(r.blending=this.blending),this.side!==Ds&&(r.side=this.side),this.vertexColors&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,r.colorWrite=this.colorWrite,r.stencilWrite=this.stencilWrite,r.stencilWriteMask=this.stencilWriteMask,r.stencilFunc=this.stencilFunc,r.stencilRef=this.stencilRef,r.stencilFuncMask=this.stencilFuncMask,r.stencilFail=this.stencilFail,r.stencilZFail=this.stencilZFail,r.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(r.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=this.premultipliedAlpha),this.forceSinglePass===!0&&(r.forceSinglePass=this.forceSinglePass),this.wireframe===!0&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=this.flatShading),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData);function i(n){let s=[];for(let a in n){let o=n[a];delete o.metadata,s.push(o)}return s}if(t){let n=i(e.textures),s=i(e.images);n.length>0&&(r.textures=n),s.length>0&&(r.images=s)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;let t=e.clippingPlanes,r=null;if(t!==null){let i=t.length;r=new Array(i);for(let n=0;n!==i;++n)r[n]=t[n].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}},dm=class extends um{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new $e(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=nR,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}},Mr=new E,eg=new W,nt=class{constructor(e,t,r=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=r,this.usage=d2,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let i=0,n=this.itemSize;i<n;i++)this.array[e+i]=t.array[r+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,r=this.count;t<r;t++)eg.fromBufferAttribute(this,t),eg.applyMatrix3(e),this.setXY(t,eg.x,eg.y);else if(this.itemSize===3)for(let t=0,r=this.count;t<r;t++)Mr.fromBufferAttribute(this,t),Mr.applyMatrix3(e),this.setXYZ(t,Mr.x,Mr.y,Mr.z);return this}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)Mr.fromBufferAttribute(this,t),Mr.applyMatrix4(e),this.setXYZ(t,Mr.x,Mr.y,Mr.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)Mr.fromBufferAttribute(this,t),Mr.applyNormalMatrix(e),this.setXYZ(t,Mr.x,Mr.y,Mr.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)Mr.fromBufferAttribute(this,t),Mr.transformDirection(e),this.setXYZ(t,Mr.x,Mr.y,Mr.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=$a(t,this.array)),t}setX(e,t){return this.normalized&&(t=qt(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=$a(t,this.array)),t}setY(e,t){return this.normalized&&(t=qt(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=$a(t,this.array)),t}setZ(e,t){return this.normalized&&(t=qt(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=$a(t,this.array)),t}setW(e,t){return this.normalized&&(t=qt(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=qt(t,this.array),r=qt(r,this.array)),this.array[e+0]=t,this.array[e+1]=r,this}setXYZ(e,t,r,i){return e*=this.itemSize,this.normalized&&(t=qt(t,this.array),r=qt(r,this.array),i=qt(i,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this}setXYZW(e,t,r,i,n){return e*=this.itemSize,this.normalized&&(t=qt(t,this.array),r=qt(r,this.array),i=qt(i,this.array),n=qt(n,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this.array[e+3]=n,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==d2&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}},vR=class extends nt{constructor(e,t,r){super(new Uint16Array(e),t,r)}},gu=class extends nt{constructor(e,t,r){super(new Uint32Array(e),t,r)}},Ne=class extends nt{constructor(e,t,r){super(new Float32Array(e),t,r)}},WW=0,In=new _e,Cx=new Vt,ah=new E,dn=new Ar,Wd=new Ar,Xr=new E,it=class extends ui{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:WW++}),this.uuid=Kn(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(dR(e)?gu:vR)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,r=0){this.groups.push({start:e,count:t,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){let t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);let r=this.attributes.normal;if(r!==void 0){let n=new Jr().getNormalMatrix(e);r.applyNormalMatrix(n),r.needsUpdate=!0}let i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(e),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return In.makeRotationFromQuaternion(e),this.applyMatrix4(In),this}rotateX(e){return In.makeRotationX(e),this.applyMatrix4(In),this}rotateY(e){return In.makeRotationY(e),this.applyMatrix4(In),this}rotateZ(e){return In.makeRotationZ(e),this.applyMatrix4(In),this}translate(e,t,r){return In.makeTranslation(e,t,r),this.applyMatrix4(In),this}scale(e,t,r){return In.makeScale(e,t,r),this.applyMatrix4(In),this}lookAt(e){return Cx.lookAt(e),Cx.updateMatrix(),this.applyMatrix4(Cx.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(ah).negate(),this.translate(ah.x,ah.y,ah.z),this}setFromPoints(e){let t=[];for(let r=0,i=e.length;r<i;r++){let n=e[r];t.push(n.x,n.y,n.z||0)}return this.setAttribute("position",new Ne(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Ar);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new E(-1/0,-1/0,-1/0),new E(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let r=0,i=t.length;r<i;r++){let n=t[r];dn.setFromBufferAttribute(n),this.morphTargetsRelative?(Xr.addVectors(this.boundingBox.min,dn.min),this.boundingBox.expandByPoint(Xr),Xr.addVectors(this.boundingBox.max,dn.max),this.boundingBox.expandByPoint(Xr)):(this.boundingBox.expandByPoint(dn.min),this.boundingBox.expandByPoint(dn.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Mn);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new E,1/0);return}if(e){let r=this.boundingSphere.center;if(dn.setFromBufferAttribute(e),t)for(let n=0,s=t.length;n<s;n++){let a=t[n];Wd.setFromBufferAttribute(a),this.morphTargetsRelative?(Xr.addVectors(dn.min,Wd.min),dn.expandByPoint(Xr),Xr.addVectors(dn.max,Wd.max),dn.expandByPoint(Xr)):(dn.expandByPoint(Wd.min),dn.expandByPoint(Wd.max))}dn.getCenter(r);let i=0;for(let n=0,s=e.count;n<s;n++)Xr.fromBufferAttribute(e,n),i=Math.max(i,r.distanceToSquared(Xr));if(t)for(let n=0,s=t.length;n<s;n++){let a=t[n],o=this.morphTargetsRelative;for(let l=0,c=a.count;l<c;l++)Xr.fromBufferAttribute(a,l),o&&(ah.fromBufferAttribute(e,l),Xr.add(ah)),i=Math.max(i,r.distanceToSquared(Xr))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let r=e.array,i=t.position.array,n=t.normal.array,s=t.uv.array,a=i.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new nt(new Float32Array(4*a),4));let o=this.getAttribute("tangent").array,l=[],c=[];for(let C=0;C<a;C++)l[C]=new E,c[C]=new E;let u=new E,h=new E,d=new E,p=new W,f=new W,m=new W,g=new E,v=new E;function y(C,M,T){u.fromArray(i,C*3),h.fromArray(i,M*3),d.fromArray(i,T*3),p.fromArray(s,C*2),f.fromArray(s,M*2),m.fromArray(s,T*2),h.sub(u),d.sub(u),f.sub(p),m.sub(p);let P=1/(f.x*m.y-m.x*f.y);!isFinite(P)||(g.copy(h).multiplyScalar(m.y).addScaledVector(d,-f.y).multiplyScalar(P),v.copy(d).multiplyScalar(f.x).addScaledVector(h,-m.x).multiplyScalar(P),l[C].add(g),l[M].add(g),l[T].add(g),c[C].add(v),c[M].add(v),c[T].add(v))}let x=this.groups;x.length===0&&(x=[{start:0,count:r.length}]);for(let C=0,M=x.length;C<M;++C){let T=x[C],P=T.start,D=T.count;for(let I=P,B=P+D;I<B;I+=3)y(r[I+0],r[I+1],r[I+2])}let w=new E,b=new E,_=new E,A=new E;function S(C){_.fromArray(n,C*3),A.copy(_);let M=l[C];w.copy(M),w.sub(_.multiplyScalar(_.dot(M))).normalize(),b.crossVectors(A,M);let T=b.dot(c[C])<0?-1:1;o[C*4]=w.x,o[C*4+1]=w.y,o[C*4+2]=w.z,o[C*4+3]=T}for(let C=0,M=x.length;C<M;++C){let T=x[C],P=T.start,D=T.count;for(let I=P,B=P+D;I<B;I+=3)S(r[I+0]),S(r[I+1]),S(r[I+2])}}computeVertexNormals(){let e=this.index,t=this.getAttribute("position");if(t!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new nt(new Float32Array(t.count*3),3),this.setAttribute("normal",r);else for(let h=0,d=r.count;h<d;h++)r.setXYZ(h,0,0,0);let i=new E,n=new E,s=new E,a=new E,o=new E,l=new E,c=new E,u=new E;if(e)for(let h=0,d=e.count;h<d;h+=3){let p=e.getX(h+0),f=e.getX(h+1),m=e.getX(h+2);i.fromBufferAttribute(t,p),n.fromBufferAttribute(t,f),s.fromBufferAttribute(t,m),c.subVectors(s,n),u.subVectors(i,n),c.cross(u),a.fromBufferAttribute(r,p),o.fromBufferAttribute(r,f),l.fromBufferAttribute(r,m),a.add(c),o.add(c),l.add(c),r.setXYZ(p,a.x,a.y,a.z),r.setXYZ(f,o.x,o.y,o.z),r.setXYZ(m,l.x,l.y,l.z)}else for(let h=0,d=t.count;h<d;h+=3)i.fromBufferAttribute(t,h+0),n.fromBufferAttribute(t,h+1),s.fromBufferAttribute(t,h+2),c.subVectors(s,n),u.subVectors(i,n),c.cross(u),r.setXYZ(h+0,c.x,c.y,c.z),r.setXYZ(h+1,c.x,c.y,c.z),r.setXYZ(h+2,c.x,c.y,c.z);this.normalizeNormals(),r.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){let e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)Xr.fromBufferAttribute(e,t),Xr.normalize(),e.setXYZ(t,Xr.x,Xr.y,Xr.z)}toNonIndexed(){function e(a,o){let l=a.array,c=a.itemSize,u=a.normalized,h=new l.constructor(o.length*c),d=0,p=0;for(let f=0,m=o.length;f<m;f++){a.isInterleavedBufferAttribute?d=o[f]*a.data.stride+a.offset:d=o[f]*c;for(let g=0;g<c;g++)h[p++]=l[d++]}return new nt(h,c,u)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let t=new it,r=this.index.array,i=this.attributes;for(let a in i){let o=i[a],l=e(o,r);t.setAttribute(a,l)}let n=this.morphAttributes;for(let a in n){let o=[],l=n[a];for(let c=0,u=l.length;c<u;c++){let h=l[c],d=e(h,r);o.push(d)}t.morphAttributes[a]=o}t.morphTargetsRelative=this.morphTargetsRelative;let s=this.groups;for(let a=0,o=s.length;a<o;a++){let l=s[a];t.addGroup(l.start,l.count,l.materialIndex)}return t}toJSON(){let e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){let o=this.parameters;for(let l in o)o[l]!==void 0&&(e[l]=o[l]);return e}e.data={attributes:{}};let t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});let r=this.attributes;for(let o in r){let l=r[o];e.data.attributes[o]=l.toJSON(e.data)}let i={},n=!1;for(let o in this.morphAttributes){let l=this.morphAttributes[o],c=[];for(let u=0,h=l.length;u<h;u++){let d=l[u];c.push(d.toJSON(e.data))}c.length>0&&(i[o]=c,n=!0)}n&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);let s=this.groups;s.length>0&&(e.data.groups=JSON.parse(JSON.stringify(s)));let a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let t={};this.name=e.name;let r=e.index;r!==null&&this.setIndex(r.clone(t));let i=e.attributes;for(let l in i){let c=i[l];this.setAttribute(l,c.clone(t))}let n=e.morphAttributes;for(let l in n){let c=[],u=n[l];for(let h=0,d=u.length;h<d;h++)c.push(u[h].clone(t));this.morphAttributes[l]=c}this.morphTargetsRelative=e.morphTargetsRelative;let s=e.groups;for(let l=0,c=s.length;l<c;l++){let u=s[l];this.addGroup(u.start,u.count,u.materialIndex)}let a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());let o=e.boundingSphere;return o!==null&&(this.boundingSphere=o.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,e.parameters!==void 0&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}},MT=new _e,oh=new hd,Mx=new Mn,qd=new E,Xd=new E,Yd=new E,Ex=new E,tg=new E,rg=new W,ig=new W,ng=new W,Tx=new E,sg=new E,Ki=class extends Vt{constructor(e=new it,t=new dm){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let r=e[t[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,n=r.length;i<n;i++){let s=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=i}}}}getVertexPosition(e,t){let r=this.geometry,i=r.attributes.position,n=r.morphAttributes.position,s=r.morphTargetsRelative;t.fromBufferAttribute(i,e);let a=this.morphTargetInfluences;if(n&&a){tg.set(0,0,0);for(let o=0,l=n.length;o<l;o++){let c=a[o],u=n[o];c!==0&&(Ex.fromBufferAttribute(u,e),s?tg.addScaledVector(Ex,c):tg.addScaledVector(Ex.sub(t),c))}t.add(tg)}return this.isSkinnedMesh&&this.boneTransform(e,t),t}raycast(e,t){let r=this.geometry,i=this.material,n=this.matrixWorld;if(i===void 0||(r.boundingSphere===null&&r.computeBoundingSphere(),Mx.copy(r.boundingSphere),Mx.applyMatrix4(n),e.ray.intersectsSphere(Mx)===!1)||(MT.copy(n).invert(),oh.copy(e.ray).applyMatrix4(MT),r.boundingBox!==null&&oh.intersectsBox(r.boundingBox)===!1))return;let s,a=r.index,o=r.attributes.position,l=r.attributes.uv,c=r.attributes.uv2,u=r.groups,h=r.drawRange;if(a!==null)if(Array.isArray(i))for(let d=0,p=u.length;d<p;d++){let f=u[d],m=i[f.materialIndex],g=Math.max(f.start,h.start),v=Math.min(a.count,Math.min(f.start+f.count,h.start+h.count));for(let y=g,x=v;y<x;y+=3){let w=a.getX(y),b=a.getX(y+1),_=a.getX(y+2);s=ag(this,m,e,oh,l,c,w,b,_),s&&(s.faceIndex=Math.floor(y/3),s.face.materialIndex=f.materialIndex,t.push(s))}}else{let d=Math.max(0,h.start),p=Math.min(a.count,h.start+h.count);for(let f=d,m=p;f<m;f+=3){let g=a.getX(f),v=a.getX(f+1),y=a.getX(f+2);s=ag(this,i,e,oh,l,c,g,v,y),s&&(s.faceIndex=Math.floor(f/3),t.push(s))}}else if(o!==void 0)if(Array.isArray(i))for(let d=0,p=u.length;d<p;d++){let f=u[d],m=i[f.materialIndex],g=Math.max(f.start,h.start),v=Math.min(o.count,Math.min(f.start+f.count,h.start+h.count));for(let y=g,x=v;y<x;y+=3){let w=y,b=y+1,_=y+2;s=ag(this,m,e,oh,l,c,w,b,_),s&&(s.faceIndex=Math.floor(y/3),s.face.materialIndex=f.materialIndex,t.push(s))}}else{let d=Math.max(0,h.start),p=Math.min(o.count,h.start+h.count);for(let f=d,m=p;f<m;f+=3){let g=f,v=f+1,y=f+2;s=ag(this,i,e,oh,l,c,g,v,y),s&&(s.faceIndex=Math.floor(f/3),t.push(s))}}}};function qW(e,t,r,i,n,s,a,o){let l;if(t.side===$r?l=i.intersectTriangle(a,s,n,!0,o):l=i.intersectTriangle(n,s,a,t.side===Ds,o),l===null)return null;sg.copy(o),sg.applyMatrix4(e.matrixWorld);let c=r.ray.origin.distanceTo(sg);return c<r.near||c>r.far?null:{distance:c,point:sg.clone(),object:e}}function ag(e,t,r,i,n,s,a,o,l){e.getVertexPosition(a,qd),e.getVertexPosition(o,Xd),e.getVertexPosition(l,Yd);let c=qW(e,t,r,i,qd,Xd,Yd,Tx);if(c){n&&(rg.fromBufferAttribute(n,a),ig.fromBufferAttribute(n,o),ng.fromBufferAttribute(n,l),c.uv=yi.getUV(Tx,qd,Xd,Yd,rg,ig,ng,new W)),s&&(rg.fromBufferAttribute(s,a),ig.fromBufferAttribute(s,o),ng.fromBufferAttribute(s,l),c.uv2=yi.getUV(Tx,qd,Xd,Yd,rg,ig,ng,new W));let u={a,b:o,c:l,normal:new E,materialIndex:0};yi.getNormal(qd,Xd,Yd,u.normal),c.face=u}return c}var ma=class extends it{constructor(e=1,t=1,r=1,i=1,n=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:i,heightSegments:n,depthSegments:s};let a=this;i=Math.floor(i),n=Math.floor(n),s=Math.floor(s);let o=[],l=[],c=[],u=[],h=0,d=0;p("z","y","x",-1,-1,r,t,e,s,n,0),p("z","y","x",1,-1,r,t,-e,s,n,1),p("x","z","y",1,1,e,r,t,i,s,2),p("x","z","y",1,-1,e,r,-t,i,s,3),p("x","y","z",1,-1,e,t,r,i,n,4),p("x","y","z",-1,-1,e,t,-r,i,n,5),this.setIndex(o),this.setAttribute("position",new Ne(l,3)),this.setAttribute("normal",new Ne(c,3)),this.setAttribute("uv",new Ne(u,2));function p(f,m,g,v,y,x,w,b,_,A,S){let C=x/_,M=w/A,T=x/2,P=w/2,D=b/2,I=_+1,B=A+1,X=0,H=0,R=new E;for(let q=0;q<B;q++){let F=q*M-P;for(let N=0;N<I;N++){let j=N*C-T;R[f]=j*v,R[m]=F*y,R[g]=D,l.push(R.x,R.y,R.z),R[f]=0,R[m]=0,R[g]=b>0?1:-1,c.push(R.x,R.y,R.z),u.push(N/_),u.push(1-q/A),X+=1}}for(let q=0;q<A;q++)for(let F=0;F<_;F++){let N=h+F+I*q,j=h+F+I*(q+1),K=h+(F+1)+I*(q+1),U=h+(F+1)+I*q;o.push(N,j,U),o.push(j,K,U),H+=6}a.addGroup(d,H,S),d+=H,h+=X}}static fromJSON(e){return new ma(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}};function Gu(e){let t={};for(let r in e){t[r]={};for(let i in e[r]){let n=e[r][i];n&&(n.isColor||n.isMatrix3||n.isMatrix4||n.isVector2||n.isVector3||n.isVector4||n.isTexture||n.isQuaternion)?t[r][i]=n.clone():Array.isArray(n)?t[r][i]=n.slice():t[r][i]=n}}return t}function Ti(e){let t={};for(let r=0;r<e.length;r++){let i=Gu(e[r]);for(let n in i)t[n]=i[n]}return t}function XW(e){let t=[];for(let r=0;r<e.length;r++)t.push(e[r].clone());return t}function yR(e){return e.getRenderTarget()===null&&e.outputEncoding===ut?Ks:x0}var ud={clone:Gu,merge:Ti},YW=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,QW=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,Yt=class extends um{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=YW,this.fragmentShader=QW,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Gu(e.uniforms),this.uniformsGroups=XW(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){let t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(let i in this.uniforms){let n=this.uniforms[i].value;n&&n.isTexture?t.uniforms[i]={type:"t",value:n.toJSON(e).uuid}:n&&n.isColor?t.uniforms[i]={type:"c",value:n.getHex()}:n&&n.isVector2?t.uniforms[i]={type:"v2",value:n.toArray()}:n&&n.isVector3?t.uniforms[i]={type:"v3",value:n.toArray()}:n&&n.isVector4?t.uniforms[i]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?t.uniforms[i]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?t.uniforms[i]={type:"m4",value:n.toArray()}:t.uniforms[i]={value:n}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;let r={};for(let i in this.extensions)this.extensions[i]===!0&&(r[i]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}},dd=class extends Vt{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new _e,this.projectionMatrix=new _e,this.projectionMatrixInverse=new _e}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}},vi=class extends dd{constructor(e=50,t=1,r=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){let t=.5*this.getFilmHeight()/e;this.fov=Of*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(Qp*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Of*2*Math.atan(Math.tan(Qp*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,r,i,n,s){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=n,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,t=e*Math.tan(Qp*.5*this.fov)/this.zoom,r=2*t,i=this.aspect*r,n=-.5*i,s=this.view;if(this.view!==null&&this.view.enabled){let o=s.fullWidth,l=s.fullHeight;n+=s.offsetX*i/o,t-=s.offsetY*r/l,i*=s.width/o,r*=s.height/l}let a=this.filmOffset;a!==0&&(n+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(n,n+i,t,t-r,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}},lh=-90,ch=1,KW=class extends Vt{constructor(e,t,r){super(),this.type="CubeCamera",this.renderTarget=r;let i=new vi(lh,ch,e,t);i.layers=this.layers,i.up.set(0,1,0),i.lookAt(1,0,0),this.add(i);let n=new vi(lh,ch,e,t);n.layers=this.layers,n.up.set(0,1,0),n.lookAt(-1,0,0),this.add(n);let s=new vi(lh,ch,e,t);s.layers=this.layers,s.up.set(0,0,-1),s.lookAt(0,1,0),this.add(s);let a=new vi(lh,ch,e,t);a.layers=this.layers,a.up.set(0,0,1),a.lookAt(0,-1,0),this.add(a);let o=new vi(lh,ch,e,t);o.layers=this.layers,o.up.set(0,1,0),o.lookAt(0,0,1),this.add(o);let l=new vi(lh,ch,e,t);l.layers=this.layers,l.up.set(0,1,0),l.lookAt(0,0,-1),this.add(l)}update(e,t){this.parent===null&&this.updateMatrixWorld();let r=this.renderTarget,[i,n,s,a,o,l]=this.children,c=e.getRenderTarget(),u=e.toneMapping,h=e.xr.enabled;e.toneMapping=io,e.xr.enabled=!1;let d=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0),e.render(t,i),e.setRenderTarget(r,1),e.render(t,n),e.setRenderTarget(r,2),e.render(t,s),e.setRenderTarget(r,3),e.render(t,a),e.setRenderTarget(r,4),e.render(t,o),r.texture.generateMipmaps=d,e.setRenderTarget(r,5),e.render(t,l),e.setRenderTarget(c),e.toneMapping=u,e.xr.enabled=h,r.texture.needsPMREMUpdate=!0}},A3=class extends jr{constructor(e,t,r,i,n,s,a,o,l,c){e=e!==void 0?e:[],t=t!==void 0?t:Lc,super(e,t,r,i,n,s,a,o,l,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}},ZW=class extends Ut{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;let r={width:e,height:e,depth:1},i=[r,r,r,r,r,r];this.texture=new A3(i,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:vt}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;let r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new ma(5,5,5),n=new Yt({name:"CubemapFromEquirect",uniforms:Gu(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:$r,blending:Ir});n.uniforms.tEquirect.value=t;let s=new Ki(i,n),a=t.minFilter;return t.minFilter===Vu&&(t.minFilter=vt),new KW(1,10,this).update(e,s),t.minFilter=a,s.geometry.dispose(),s.material.dispose(),this}clear(e,t,r,i){let n=e.getRenderTarget();for(let s=0;s<6;s++)e.setRenderTarget(this,s),e.clear(t,r,i);e.setRenderTarget(n)}},Px=new E,$W=new E,JW=new Jr,gn=class{constructor(e=new E(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,i){return this.normal.set(e,t,r),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){let i=Px.subVectors(r,t).cross($W.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){let r=e.delta(Px),i=this.normal.dot(r);if(i===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;let n=-(e.start.dot(this.normal)+this.constant)/i;return n<0||n>1?null:t.copy(r).multiplyScalar(n).add(e.start)}intersectsLine(e){let t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){let r=t||JW.getNormalMatrix(e),i=this.coplanarPoint(Px).applyMatrix4(e),n=this.normal.applyMatrix3(r).normalize();return this.constant=-i.dot(n),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}},hh=new Mn,og=new E,C3=class{constructor(e=new gn,t=new gn,r=new gn,i=new gn,n=new gn,s=new gn){this.planes=[e,t,r,i,n,s]}set(e,t,r,i,n,s){let a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(r),a[3].copy(i),a[4].copy(n),a[5].copy(s),this}copy(e){let t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e){let t=this.planes,r=e.elements,i=r[0],n=r[1],s=r[2],a=r[3],o=r[4],l=r[5],c=r[6],u=r[7],h=r[8],d=r[9],p=r[10],f=r[11],m=r[12],g=r[13],v=r[14],y=r[15];return t[0].setComponents(a-i,u-o,f-h,y-m).normalize(),t[1].setComponents(a+i,u+o,f+h,y+m).normalize(),t[2].setComponents(a+n,u+l,f+d,y+g).normalize(),t[3].setComponents(a-n,u-l,f-d,y-g).normalize(),t[4].setComponents(a-s,u-c,f-p,y-v).normalize(),t[5].setComponents(a+s,u+c,f+p,y+v).normalize(),this}intersectsObject(e){let t=e.geometry;return t.boundingSphere===null&&t.computeBoundingSphere(),hh.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(hh)}intersectsSprite(e){return hh.center.set(0,0,0),hh.radius=.7071067811865476,hh.applyMatrix4(e.matrixWorld),this.intersectsSphere(hh)}intersectsSphere(e){let t=this.planes,r=e.center,i=-e.radius;for(let n=0;n<6;n++)if(t[n].distanceToPoint(r)<i)return!1;return!0}intersectsBox(e){let t=this.planes;for(let r=0;r<6;r++){let i=t[r];if(og.x=i.normal.x>0?e.max.x:e.min.x,og.y=i.normal.y>0?e.max.y:e.min.y,og.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(og)<0)return!1}return!0}containsPoint(e){let t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}};function xR(){let e=null,t=!1,r=null,i=null;function n(s,a){r(s,a),i=e.requestAnimationFrame(n)}return{start:function(){t!==!0&&r!==null&&(i=e.requestAnimationFrame(n),t=!0)},stop:function(){e.cancelAnimationFrame(i),t=!1},setAnimationLoop:function(s){r=s},setContext:function(s){e=s}}}function eq(e,t){let r=t.isWebGL2,i=new WeakMap;function n(c,u){let h=c.array,d=c.usage,p=e.createBuffer();e.bindBuffer(u,p),e.bufferData(u,h,d),c.onUploadCallback();let f;if(h instanceof Float32Array)f=5126;else if(h instanceof Uint16Array)if(c.isFloat16BufferAttribute)if(r)f=5131;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else f=5123;else if(h instanceof Int16Array)f=5122;else if(h instanceof Uint32Array)f=5125;else if(h instanceof Int32Array)f=5124;else if(h instanceof Int8Array)f=5120;else if(h instanceof Uint8Array)f=5121;else if(h instanceof Uint8ClampedArray)f=5121;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+h);return{buffer:p,type:f,bytesPerElement:h.BYTES_PER_ELEMENT,version:c.version}}function s(c,u,h){let d=u.array,p=u.updateRange;e.bindBuffer(h,c),p.count===-1?e.bufferSubData(h,0,d):(r?e.bufferSubData(h,p.offset*d.BYTES_PER_ELEMENT,d,p.offset,p.count):e.bufferSubData(h,p.offset*d.BYTES_PER_ELEMENT,d.subarray(p.offset,p.offset+p.count)),p.count=-1),u.onUploadCallback()}function a(c){return c.isInterleavedBufferAttribute&&(c=c.data),i.get(c)}function o(c){c.isInterleavedBufferAttribute&&(c=c.data);let u=i.get(c);u&&(e.deleteBuffer(u.buffer),i.delete(c))}function l(c,u){if(c.isGLBufferAttribute){let d=i.get(c);(!d||d.version<c.version)&&i.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}c.isInterleavedBufferAttribute&&(c=c.data);let h=i.get(c);h===void 0?i.set(c,n(c,u)):h.version<c.version&&(s(h.buffer,c,u),h.version=c.version)}return{get:a,remove:o,update:l}}var Ny=class extends it{constructor(e=1,t=1,r=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:i};let n=e/2,s=t/2,a=Math.floor(r),o=Math.floor(i),l=a+1,c=o+1,u=e/a,h=t/o,d=[],p=[],f=[],m=[];for(let g=0;g<c;g++){let v=g*h-s;for(let y=0;y<l;y++){let x=y*u-n;p.push(x,-v,0),f.push(0,0,1),m.push(y/a),m.push(1-g/o)}}for(let g=0;g<o;g++)for(let v=0;v<a;v++){let y=v+l*g,x=v+l*(g+1),w=v+1+l*(g+1),b=v+1+l*g;d.push(y,x,b),d.push(x,w,b)}this.setIndex(d),this.setAttribute("position",new Ne(p,3)),this.setAttribute("normal",new Ne(f,3)),this.setAttribute("uv",new Ne(m,2))}static fromJSON(e){return new Ny(e.width,e.height,e.widthSegments,e.heightSegments)}},tq=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,rq=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,iq=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,nq=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,sq=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,aq=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,oq="vec3 transformed = vec3( position );",lq=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,cq=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
#ifdef USE_IRIDESCENCE
	vec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,hq=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,uq=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,dq=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,pq=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,fq=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,mq=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,gq=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,vq=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,yq=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,xq=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,wq=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,bq=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,_q=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Sq=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Aq=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,Cq=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,Mq=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,Eq="gl_FragColor = linearToOutputTexel( gl_FragColor );",Tq=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,Pq=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,Dq=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,Lq=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,Iq=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,Oq=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,Rq=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,Bq=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,zq=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,kq=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,Nq=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,Fq=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,Uq=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,jq=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,Vq=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,Hq=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,Gq=`#if defined( USE_ENVMAP )
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,Wq=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,qq=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,Xq=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,Yq=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,Qq=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,Kq=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	#ifdef USE_IRIDESCENCE
		reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );
	#else
		reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,Zq=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,$q=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,Jq=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,eX=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,tX=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,rX=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,iX=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,nX=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,sX=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,aX=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,oX=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,lX=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,cX=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,hX=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,uX=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,dX=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,pX=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,fX=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,mX=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,gX=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,vX=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,yX=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,xX=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,wX=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,bX=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,_X=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,SX=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,AX=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,CX=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,MX=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,EX=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,TX=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,PX=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,DX=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,LX=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,IX=`#if NUM_SPOT_LIGHT_COORDS > 0
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
  uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,OX=`#if NUM_SPOT_LIGHT_COORDS > 0
  uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,RX=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,BX=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,zX=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,kX=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,NX=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,FX=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,UX=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,jX=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,VX=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,HX=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,GX=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );
#endif`,WX=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef texture2DLodEXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,qX=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,XX=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,YX=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,QX=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,KX=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,ZX=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,$X=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,JX=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,eY=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,tY=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,rY=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,iY=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,nY=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,sY=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,aY=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,oY=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,lY=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,cY=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,hY=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,uY=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,dY=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,pY=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,fY=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,mY=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,gY=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vY=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,yY=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,xY=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,wY=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,bY=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,_Y=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,SY=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,AY=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,CY=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,MY=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,EY=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,TY=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,PY=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,DY=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,LY=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,IY=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,pt={alphamap_fragment:tq,alphamap_pars_fragment:rq,alphatest_fragment:iq,alphatest_pars_fragment:nq,aomap_fragment:sq,aomap_pars_fragment:aq,begin_vertex:oq,beginnormal_vertex:lq,bsdfs:cq,iridescence_fragment:hq,bumpmap_pars_fragment:uq,clipping_planes_fragment:dq,clipping_planes_pars_fragment:pq,clipping_planes_pars_vertex:fq,clipping_planes_vertex:mq,color_fragment:gq,color_pars_fragment:vq,color_pars_vertex:yq,color_vertex:xq,common:wq,cube_uv_reflection_fragment:bq,defaultnormal_vertex:_q,displacementmap_pars_vertex:Sq,displacementmap_vertex:Aq,emissivemap_fragment:Cq,emissivemap_pars_fragment:Mq,encodings_fragment:Eq,encodings_pars_fragment:Tq,envmap_fragment:Pq,envmap_common_pars_fragment:Dq,envmap_pars_fragment:Lq,envmap_pars_vertex:Iq,envmap_physical_pars_fragment:Gq,envmap_vertex:Oq,fog_vertex:Rq,fog_pars_vertex:Bq,fog_fragment:zq,fog_pars_fragment:kq,gradientmap_pars_fragment:Nq,lightmap_fragment:Fq,lightmap_pars_fragment:Uq,lights_lambert_fragment:jq,lights_lambert_pars_fragment:Vq,lights_pars_begin:Hq,lights_toon_fragment:Wq,lights_toon_pars_fragment:qq,lights_phong_fragment:Xq,lights_phong_pars_fragment:Yq,lights_physical_fragment:Qq,lights_physical_pars_fragment:Kq,lights_fragment_begin:Zq,lights_fragment_maps:$q,lights_fragment_end:Jq,logdepthbuf_fragment:eX,logdepthbuf_pars_fragment:tX,logdepthbuf_pars_vertex:rX,logdepthbuf_vertex:iX,map_fragment:nX,map_pars_fragment:sX,map_particle_fragment:aX,map_particle_pars_fragment:oX,metalnessmap_fragment:lX,metalnessmap_pars_fragment:cX,morphcolor_vertex:hX,morphnormal_vertex:uX,morphtarget_pars_vertex:dX,morphtarget_vertex:pX,normal_fragment_begin:fX,normal_fragment_maps:mX,normal_pars_fragment:gX,normal_pars_vertex:vX,normal_vertex:yX,normalmap_pars_fragment:xX,clearcoat_normal_fragment_begin:wX,clearcoat_normal_fragment_maps:bX,clearcoat_pars_fragment:_X,iridescence_pars_fragment:SX,output_fragment:AX,packing:CX,premultiplied_alpha_fragment:MX,project_vertex:EX,dithering_fragment:TX,dithering_pars_fragment:PX,roughnessmap_fragment:DX,roughnessmap_pars_fragment:LX,shadowmap_pars_fragment:IX,shadowmap_pars_vertex:OX,shadowmap_vertex:RX,shadowmask_pars_fragment:BX,skinbase_vertex:zX,skinning_pars_vertex:kX,skinning_vertex:NX,skinnormal_vertex:FX,specularmap_fragment:UX,specularmap_pars_fragment:jX,tonemapping_fragment:VX,tonemapping_pars_fragment:HX,transmission_fragment:GX,transmission_pars_fragment:WX,uv_pars_fragment:qX,uv_pars_vertex:XX,uv_vertex:YX,uv2_pars_fragment:QX,uv2_pars_vertex:KX,uv2_vertex:ZX,worldpos_vertex:$X,background_vert:JX,background_frag:eY,backgroundCube_vert:tY,backgroundCube_frag:rY,cube_vert:iY,cube_frag:nY,depth_vert:sY,depth_frag:aY,distanceRGBA_vert:oY,distanceRGBA_frag:lY,equirect_vert:cY,equirect_frag:hY,linedashed_vert:uY,linedashed_frag:dY,meshbasic_vert:pY,meshbasic_frag:fY,meshlambert_vert:mY,meshlambert_frag:gY,meshmatcap_vert:vY,meshmatcap_frag:yY,meshnormal_vert:xY,meshnormal_frag:wY,meshphong_vert:bY,meshphong_frag:_Y,meshphysical_vert:SY,meshphysical_frag:AY,meshtoon_vert:CY,meshtoon_frag:MY,points_vert:EY,points_frag:TY,shadow_vert:PY,shadow_frag:DY,sprite_vert:LY,sprite_frag:IY},Pe={common:{diffuse:{value:new $e(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Jr},uv2Transform:{value:new Jr},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new W(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new $e(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new $e(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Jr}},sprite:{diffuse:{value:new $e(16777215)},opacity:{value:1},center:{value:new W(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Jr}}},Zs={basic:{uniforms:Ti([Pe.common,Pe.specularmap,Pe.envmap,Pe.aomap,Pe.lightmap,Pe.fog]),vertexShader:pt.meshbasic_vert,fragmentShader:pt.meshbasic_frag},lambert:{uniforms:Ti([Pe.common,Pe.specularmap,Pe.envmap,Pe.aomap,Pe.lightmap,Pe.emissivemap,Pe.bumpmap,Pe.normalmap,Pe.displacementmap,Pe.fog,Pe.lights,{emissive:{value:new $e(0)}}]),vertexShader:pt.meshlambert_vert,fragmentShader:pt.meshlambert_frag},phong:{uniforms:Ti([Pe.common,Pe.specularmap,Pe.envmap,Pe.aomap,Pe.lightmap,Pe.emissivemap,Pe.bumpmap,Pe.normalmap,Pe.displacementmap,Pe.fog,Pe.lights,{emissive:{value:new $e(0)},specular:{value:new $e(1118481)},shininess:{value:30}}]),vertexShader:pt.meshphong_vert,fragmentShader:pt.meshphong_frag},standard:{uniforms:Ti([Pe.common,Pe.envmap,Pe.aomap,Pe.lightmap,Pe.emissivemap,Pe.bumpmap,Pe.normalmap,Pe.displacementmap,Pe.roughnessmap,Pe.metalnessmap,Pe.fog,Pe.lights,{emissive:{value:new $e(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:pt.meshphysical_vert,fragmentShader:pt.meshphysical_frag},toon:{uniforms:Ti([Pe.common,Pe.aomap,Pe.lightmap,Pe.emissivemap,Pe.bumpmap,Pe.normalmap,Pe.displacementmap,Pe.gradientmap,Pe.fog,Pe.lights,{emissive:{value:new $e(0)}}]),vertexShader:pt.meshtoon_vert,fragmentShader:pt.meshtoon_frag},matcap:{uniforms:Ti([Pe.common,Pe.bumpmap,Pe.normalmap,Pe.displacementmap,Pe.fog,{matcap:{value:null}}]),vertexShader:pt.meshmatcap_vert,fragmentShader:pt.meshmatcap_frag},points:{uniforms:Ti([Pe.points,Pe.fog]),vertexShader:pt.points_vert,fragmentShader:pt.points_frag},dashed:{uniforms:Ti([Pe.common,Pe.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:pt.linedashed_vert,fragmentShader:pt.linedashed_frag},depth:{uniforms:Ti([Pe.common,Pe.displacementmap]),vertexShader:pt.depth_vert,fragmentShader:pt.depth_frag},normal:{uniforms:Ti([Pe.common,Pe.bumpmap,Pe.normalmap,Pe.displacementmap,{opacity:{value:1}}]),vertexShader:pt.meshnormal_vert,fragmentShader:pt.meshnormal_frag},sprite:{uniforms:Ti([Pe.sprite,Pe.fog]),vertexShader:pt.sprite_vert,fragmentShader:pt.sprite_frag},background:{uniforms:{uvTransform:{value:new Jr},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:pt.background_vert,fragmentShader:pt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:pt.backgroundCube_vert,fragmentShader:pt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:pt.cube_vert,fragmentShader:pt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:pt.equirect_vert,fragmentShader:pt.equirect_frag},distanceRGBA:{uniforms:Ti([Pe.common,Pe.displacementmap,{referencePosition:{value:new E},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:pt.distanceRGBA_vert,fragmentShader:pt.distanceRGBA_frag},shadow:{uniforms:Ti([Pe.lights,Pe.fog,{color:{value:new $e(0)},opacity:{value:1}}]),vertexShader:pt.shadow_vert,fragmentShader:pt.shadow_frag}};Zs.physical={uniforms:Ti([Zs.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new W(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new $e(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new W},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new $e(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new $e(1,1,1)},specularColorMap:{value:null}}]),vertexShader:pt.meshphysical_vert,fragmentShader:pt.meshphysical_frag};var lg={r:0,b:0,g:0};function OY(e,t,r,i,n,s,a){let o=new $e(0),l=s===!0?0:1,c,u,h=null,d=0,p=null;function f(g,v){let y=!1,x=v.isScene===!0?v.background:null;x&&x.isTexture&&(x=(v.backgroundBlurriness>0?r:t).get(x));let w=e.xr,b=w.getSession&&w.getSession();b&&b.environmentBlendMode==="additive"&&(x=null),x===null?m(o,l):x&&x.isColor&&(m(x,1),y=!0),(e.autoClear||y)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),x&&(x.isCubeTexture||x.mapping===hm)?(u===void 0&&(u=new Ki(new ma(1,1,1),new Yt({name:"BackgroundCubeMaterial",uniforms:Gu(Zs.backgroundCube.uniforms),vertexShader:Zs.backgroundCube.vertexShader,fragmentShader:Zs.backgroundCube.fragmentShader,side:$r,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(_,A,S){this.matrixWorld.copyPosition(S.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(u)),u.material.uniforms.envMap.value=x,u.material.uniforms.flipEnvMap.value=x.isCubeTexture&&x.isRenderTargetTexture===!1?-1:1,u.material.uniforms.backgroundBlurriness.value=v.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,u.material.toneMapped=x.encoding!==ut,(h!==x||d!==x.version||p!==e.toneMapping)&&(u.material.needsUpdate=!0,h=x,d=x.version,p=e.toneMapping),u.layers.enableAll(),g.unshift(u,u.geometry,u.material,0,0,null)):x&&x.isTexture&&(c===void 0&&(c=new Ki(new Ny(2,2),new Yt({name:"BackgroundMaterial",uniforms:Gu(Zs.background.uniforms),vertexShader:Zs.background.vertexShader,fragmentShader:Zs.background.fragmentShader,side:Ds,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(c)),c.material.uniforms.t2D.value=x,c.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,c.material.toneMapped=x.encoding!==ut,x.matrixAutoUpdate===!0&&x.updateMatrix(),c.material.uniforms.uvTransform.value.copy(x.matrix),(h!==x||d!==x.version||p!==e.toneMapping)&&(c.material.needsUpdate=!0,h=x,d=x.version,p=e.toneMapping),c.layers.enableAll(),g.unshift(c,c.geometry,c.material,0,0,null))}function m(g,v){g.getRGB(lg,yR(e)),i.buffers.color.setClear(lg.r,lg.g,lg.b,v,a)}return{getClearColor:function(){return o},setClearColor:function(g,v=1){o.set(g),l=v,m(o,l)},getClearAlpha:function(){return l},setClearAlpha:function(g){l=g,m(o,l)},render:f}}function RY(e,t,r,i){let n=e.getParameter(34921),s=i.isWebGL2?null:t.get("OES_vertex_array_object"),a=i.isWebGL2||s!==null,o={},l=g(null),c=l,u=!1;function h(I,B,X,H,R){let q=!1;if(a){let F=m(H,X,B);c!==F&&(c=F,p(c.object)),q=v(I,H,X,R),q&&y(I,H,X,R)}else{let F=B.wireframe===!0;(c.geometry!==H.id||c.program!==X.id||c.wireframe!==F)&&(c.geometry=H.id,c.program=X.id,c.wireframe=F,q=!0)}R!==null&&r.update(R,34963),(q||u)&&(u=!1,S(I,B,X,H),R!==null&&e.bindBuffer(34963,r.get(R).buffer))}function d(){return i.isWebGL2?e.createVertexArray():s.createVertexArrayOES()}function p(I){return i.isWebGL2?e.bindVertexArray(I):s.bindVertexArrayOES(I)}function f(I){return i.isWebGL2?e.deleteVertexArray(I):s.deleteVertexArrayOES(I)}function m(I,B,X){let H=X.wireframe===!0,R=o[I.id];R===void 0&&(R={},o[I.id]=R);let q=R[B.id];q===void 0&&(q={},R[B.id]=q);let F=q[H];return F===void 0&&(F=g(d()),q[H]=F),F}function g(I){let B=[],X=[],H=[];for(let R=0;R<n;R++)B[R]=0,X[R]=0,H[R]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:B,enabledAttributes:X,attributeDivisors:H,object:I,attributes:{},index:null}}function v(I,B,X,H){let R=c.attributes,q=B.attributes,F=0,N=X.getAttributes();for(let j in N)if(N[j].location>=0){let K=R[j],U=q[j];if(U===void 0&&(j==="instanceMatrix"&&I.instanceMatrix&&(U=I.instanceMatrix),j==="instanceColor"&&I.instanceColor&&(U=I.instanceColor)),K===void 0||K.attribute!==U||U&&K.data!==U.data)return!0;F++}return c.attributesNum!==F||c.index!==H}function y(I,B,X,H){let R={},q=B.attributes,F=0,N=X.getAttributes();for(let j in N)if(N[j].location>=0){let K=q[j];K===void 0&&(j==="instanceMatrix"&&I.instanceMatrix&&(K=I.instanceMatrix),j==="instanceColor"&&I.instanceColor&&(K=I.instanceColor));let U={};U.attribute=K,K&&K.data&&(U.data=K.data),R[j]=U,F++}c.attributes=R,c.attributesNum=F,c.index=H}function x(){let I=c.newAttributes;for(let B=0,X=I.length;B<X;B++)I[B]=0}function w(I){b(I,0)}function b(I,B){let X=c.newAttributes,H=c.enabledAttributes,R=c.attributeDivisors;X[I]=1,H[I]===0&&(e.enableVertexAttribArray(I),H[I]=1),R[I]!==B&&((i.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](I,B),R[I]=B)}function _(){let I=c.newAttributes,B=c.enabledAttributes;for(let X=0,H=B.length;X<H;X++)B[X]!==I[X]&&(e.disableVertexAttribArray(X),B[X]=0)}function A(I,B,X,H,R,q){i.isWebGL2===!0&&(X===5124||X===5125)?e.vertexAttribIPointer(I,B,X,R,q):e.vertexAttribPointer(I,B,X,H,R,q)}function S(I,B,X,H){if(i.isWebGL2===!1&&(I.isInstancedMesh||H.isInstancedBufferGeometry)&&t.get("ANGLE_instanced_arrays")===null)return;x();let R=H.attributes,q=X.getAttributes(),F=B.defaultAttributeValues;for(let N in q){let j=q[N];if(j.location>=0){let K=R[N];if(K===void 0&&(N==="instanceMatrix"&&I.instanceMatrix&&(K=I.instanceMatrix),N==="instanceColor"&&I.instanceColor&&(K=I.instanceColor)),K!==void 0){let U=K.normalized,Y=K.itemSize,V=r.get(K);if(V===void 0)continue;let ie=V.buffer,J=V.type,ee=V.bytesPerElement;if(K.isInterleavedBufferAttribute){let se=K.data,ce=se.stride,ue=K.offset;if(se.isInstancedInterleavedBuffer){for(let ye=0;ye<j.locationSize;ye++)b(j.location+ye,se.meshPerAttribute);I.isInstancedMesh!==!0&&H._maxInstanceCount===void 0&&(H._maxInstanceCount=se.meshPerAttribute*se.count)}else for(let ye=0;ye<j.locationSize;ye++)w(j.location+ye);e.bindBuffer(34962,ie);for(let ye=0;ye<j.locationSize;ye++)A(j.location+ye,Y/j.locationSize,J,U,ce*ee,(ue+Y/j.locationSize*ye)*ee)}else{if(K.isInstancedBufferAttribute){for(let se=0;se<j.locationSize;se++)b(j.location+se,K.meshPerAttribute);I.isInstancedMesh!==!0&&H._maxInstanceCount===void 0&&(H._maxInstanceCount=K.meshPerAttribute*K.count)}else for(let se=0;se<j.locationSize;se++)w(j.location+se);e.bindBuffer(34962,ie);for(let se=0;se<j.locationSize;se++)A(j.location+se,Y/j.locationSize,J,U,Y*ee,Y/j.locationSize*se*ee)}}else if(F!==void 0){let U=F[N];if(U!==void 0)switch(U.length){case 2:e.vertexAttrib2fv(j.location,U);break;case 3:e.vertexAttrib3fv(j.location,U);break;case 4:e.vertexAttrib4fv(j.location,U);break;default:e.vertexAttrib1fv(j.location,U)}}}}_()}function C(){P();for(let I in o){let B=o[I];for(let X in B){let H=B[X];for(let R in H)f(H[R].object),delete H[R];delete B[X]}delete o[I]}}function M(I){if(o[I.id]===void 0)return;let B=o[I.id];for(let X in B){let H=B[X];for(let R in H)f(H[R].object),delete H[R];delete B[X]}delete o[I.id]}function T(I){for(let B in o){let X=o[B];if(X[I.id]===void 0)continue;let H=X[I.id];for(let R in H)f(H[R].object),delete H[R];delete X[I.id]}}function P(){D(),u=!0,c!==l&&(c=l,p(c.object))}function D(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:h,reset:P,resetDefaultState:D,dispose:C,releaseStatesOfGeometry:M,releaseStatesOfProgram:T,initAttributes:x,enableAttribute:w,disableUnusedAttributes:_}}function BY(e,t,r,i){let n=i.isWebGL2,s;function a(c){s=c}function o(c,u){e.drawArrays(s,c,u),r.update(u,s,1)}function l(c,u,h){if(h===0)return;let d,p;if(n)d=e,p="drawArraysInstanced";else if(d=t.get("ANGLE_instanced_arrays"),p="drawArraysInstancedANGLE",d===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}d[p](s,c,u,h),r.update(u,s,h)}this.setMode=a,this.render=o,this.renderInstances=l}function zY(e,t,r){let i;function n(){if(i!==void 0)return i;if(t.has("EXT_texture_filter_anisotropic")===!0){let A=t.get("EXT_texture_filter_anisotropic");i=e.getParameter(A.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function s(A){if(A==="highp"){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";A="mediump"}return A==="mediump"&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}let a=typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext,o=r.precision!==void 0?r.precision:"highp",l=s(o);l!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",l,"instead."),o=l);let c=a||t.has("WEBGL_draw_buffers"),u=r.logarithmicDepthBuffer===!0,h=e.getParameter(34930),d=e.getParameter(35660),p=e.getParameter(3379),f=e.getParameter(34076),m=e.getParameter(34921),g=e.getParameter(36347),v=e.getParameter(36348),y=e.getParameter(36349),x=d>0,w=a||t.has("OES_texture_float"),b=x&&w,_=a?e.getParameter(36183):0;return{isWebGL2:a,drawBuffers:c,getMaxAnisotropy:n,getMaxPrecision:s,precision:o,logarithmicDepthBuffer:u,maxTextures:h,maxVertexTextures:d,maxTextureSize:p,maxCubemapSize:f,maxAttributes:m,maxVertexUniforms:g,maxVaryings:v,maxFragmentUniforms:y,vertexTextures:x,floatFragmentTextures:w,floatVertexTextures:b,maxSamples:_}}function kY(e){let t=this,r=null,i=0,n=!1,s=!1,a=new gn,o=new Jr,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(h,d){let p=h.length!==0||d||i!==0||n;return n=d,i=h.length,p},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(h,d){r=u(h,d,0)},this.setState=function(h,d,p){let f=h.clippingPlanes,m=h.clipIntersection,g=h.clipShadows,v=e.get(h);if(!n||f===null||f.length===0||s&&!g)s?u(null):c();else{let y=s?0:i,x=y*4,w=v.clippingState||null;l.value=w,w=u(f,d,x,p);for(let b=0;b!==x;++b)w[b]=r[b];v.clippingState=w,this.numIntersection=m?this.numPlanes:0,this.numPlanes+=y}};function c(){l.value!==r&&(l.value=r,l.needsUpdate=i>0),t.numPlanes=i,t.numIntersection=0}function u(h,d,p,f){let m=h!==null?h.length:0,g=null;if(m!==0){if(g=l.value,f!==!0||g===null){let v=p+m*4,y=d.matrixWorldInverse;o.getNormalMatrix(y),(g===null||g.length<v)&&(g=new Float32Array(v));for(let x=0,w=p;x!==m;++x,w+=4)a.copy(h[x]).applyMatrix4(y,o),a.normal.toArray(g,w),g[w+3]=a.constant}l.value=g,l.needsUpdate=!0}return t.numPlanes=m,t.numIntersection=0,g}}function NY(e){let t=new WeakMap;function r(a,o){return o===c2?a.mapping=Lc:o===h2&&(a.mapping=Ic),a}function i(a){if(a&&a.isTexture&&a.isRenderTargetTexture===!1){let o=a.mapping;if(o===c2||o===h2)if(t.has(a)){let l=t.get(a).texture;return r(l,a.mapping)}else{let l=a.image;if(l&&l.height>0){let c=new ZW(l.height/2);return c.fromEquirectangularTexture(e,a),t.set(a,c),a.addEventListener("dispose",n),r(c.texture,a.mapping)}else return null}}return a}function n(a){let o=a.target;o.removeEventListener("dispose",n);let l=t.get(o);l!==void 0&&(t.delete(o),l.dispose())}function s(){t=new WeakMap}return{get:i,dispose:s}}var M3=class extends dd{constructor(e=-1,t=1,r=1,i=-1,n=.1,s=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=i,this.near=n,this.far=s,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,r,i,n,s){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=n,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,i=(this.top+this.bottom)/2,n=r-e,s=r+e,a=i+t,o=i-t;if(this.view!==null&&this.view.enabled){let l=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;n+=l*this.view.offsetX,s=n+l*this.view.width,a-=c*this.view.offsetY,o=a-c*this.view.height}this.projectionMatrix.makeOrthographic(n,s,a,o,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}},tu=4,ET=[.125,.215,.35,.446,.526,.582],ec=20,Dx=new M3,TT=new $e,Lx=null,Kl=(1+Math.sqrt(5))/2,uh=1/Kl,PT=[new E(1,1,1),new E(-1,1,1),new E(1,1,-1),new E(-1,1,-1),new E(0,Kl,uh),new E(0,Kl,-uh),new E(uh,0,Kl),new E(-uh,0,Kl),new E(Kl,uh,0),new E(-Kl,uh,0)],DT=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,r=.1,i=100){Lx=this._renderer.getRenderTarget(),this._setSize(256);let n=this._allocateTargets();return n.depthBuffer=!0,this._sceneToCubeUV(e,r,i,n),t>0&&this._blur(n,0,0,t),this._applyPMREM(n),this._cleanup(n),n}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=OT(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=IT(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Lx),e.scissorTest=!1,cg(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Lc||e.mapping===Ic?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),Lx=this._renderer.getRenderTarget();let r=t||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){let e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,r={magFilter:vt,minFilter:vt,generateMipmaps:!1,type:Hu,format:Wn,encoding:fa,depthBuffer:!1},i=LT(e,t,r);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=LT(e,t,r);let{_lodMax:n}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=FY(n)),this._blurMaterial=UY(n,e,t)}return i}_compileMaterial(e){let t=new Ki(this._lodPlanes[0],e);this._renderer.compile(t,Dx)}_sceneToCubeUV(e,t,r,i){let n=new vi(90,1,t,r),s=[1,-1,1,1,1,1],a=[1,1,1,-1,-1,-1],o=this._renderer,l=o.autoClear,c=o.toneMapping;o.getClearColor(TT),o.toneMapping=io,o.autoClear=!1;let u=new dm({name:"PMREM.Background",side:$r,depthWrite:!1,depthTest:!1}),h=new Ki(new ma,u),d=!1,p=e.background;p?p.isColor&&(u.color.copy(p),e.background=null,d=!0):(u.color.copy(TT),d=!0);for(let f=0;f<6;f++){let m=f%3;m===0?(n.up.set(0,s[f],0),n.lookAt(a[f],0,0)):m===1?(n.up.set(0,0,s[f]),n.lookAt(0,a[f],0)):(n.up.set(0,s[f],0),n.lookAt(0,0,a[f]));let g=this._cubeSize;cg(i,m*g,f>2?g:0,g,g),o.setRenderTarget(i),d&&o.render(h,n),o.render(e,n)}h.geometry.dispose(),h.material.dispose(),o.toneMapping=c,o.autoClear=l,e.background=p}_textureToCubeUV(e,t){let r=this._renderer,i=e.mapping===Lc||e.mapping===Ic;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=OT()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=IT());let n=i?this._cubemapMaterial:this._equirectMaterial,s=new Ki(this._lodPlanes[0],n),a=n.uniforms;a.envMap.value=e;let o=this._cubeSize;cg(t,0,0,3*o,2*o),r.setRenderTarget(t),r.render(s,Dx)}_applyPMREM(e){let t=this._renderer,r=t.autoClear;t.autoClear=!1;for(let i=1;i<this._lodPlanes.length;i++){let n=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]),s=PT[(i-1)%PT.length];this._blur(e,i-1,i,n,s)}t.autoClear=r}_blur(e,t,r,i,n){let s=this._pingPongRenderTarget;this._halfBlur(e,s,t,r,i,"latitudinal",n),this._halfBlur(s,e,r,r,i,"longitudinal",n)}_halfBlur(e,t,r,i,n,s,a){let o=this._renderer,l=this._blurMaterial;s!=="latitudinal"&&s!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");let c=3,u=new Ki(this._lodPlanes[i],l),h=l.uniforms,d=this._sizeLods[r]-1,p=isFinite(n)?Math.PI/(2*d):2*Math.PI/(2*ec-1),f=n/p,m=isFinite(n)?1+Math.floor(c*f):ec;m>ec&&console.warn(`sigmaRadians, ${n}, is too large and will clip, as it requested ${m} samples when the maximum is set to ${ec}`);let g=[],v=0;for(let _=0;_<ec;++_){let A=_/f,S=Math.exp(-A*A/2);g.push(S),_===0?v+=S:_<m&&(v+=2*S)}for(let _=0;_<g.length;_++)g[_]=g[_]/v;h.envMap.value=e.texture,h.samples.value=m,h.weights.value=g,h.latitudinal.value=s==="latitudinal",a&&(h.poleAxis.value=a);let{_lodMax:y}=this;h.dTheta.value=p,h.mipInt.value=y-r;let x=this._sizeLods[i],w=3*x*(i>y-tu?i-y+tu:0),b=4*(this._cubeSize-x);cg(t,w,b,3*x,2*x),o.setRenderTarget(t),o.render(u,Dx)}};function FY(e){let t=[],r=[],i=[],n=e,s=e-tu+1+ET.length;for(let a=0;a<s;a++){let o=Math.pow(2,n);r.push(o);let l=1/o;a>e-tu?l=ET[a-e+tu-1]:a===0&&(l=0),i.push(l);let c=1/(o-2),u=-c,h=1+c,d=[u,u,h,u,h,h,u,u,h,h,u,h],p=6,f=6,m=3,g=2,v=1,y=new Float32Array(m*f*p),x=new Float32Array(g*f*p),w=new Float32Array(v*f*p);for(let _=0;_<p;_++){let A=_%3*2/3-1,S=_>2?0:-1,C=[A,S,0,A+2/3,S,0,A+2/3,S+1,0,A,S,0,A+2/3,S+1,0,A,S+1,0];y.set(C,m*f*_),x.set(d,g*f*_);let M=[_,_,_,_,_,_];w.set(M,v*f*_)}let b=new it;b.setAttribute("position",new nt(y,m)),b.setAttribute("uv",new nt(x,g)),b.setAttribute("faceIndex",new nt(w,v)),t.push(b),n>tu&&n--}return{lodPlanes:t,sizeLods:r,sigmas:i}}function LT(e,t,r){let i=new Ut(e,t,r);return i.texture.mapping=hm,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function cg(e,t,r,i,n){e.viewport.set(t,r,i,n),e.scissor.set(t,r,i,n)}function UY(e,t,r){let i=new Float32Array(ec),n=new E(0,1,0);return new Yt({name:"SphericalGaussianBlur",defines:{n:ec,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/r,CUBEUV_MAX_MIP:`${e}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:n}},vertexShader:E3(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Ir,depthTest:!1,depthWrite:!1})}function IT(){return new Yt({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:E3(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Ir,depthTest:!1,depthWrite:!1})}function OT(){return new Yt({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:E3(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Ir,depthTest:!1,depthWrite:!1})}function E3(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function jY(e){let t=new WeakMap,r=null;function i(o){if(o&&o.isTexture){let l=o.mapping,c=l===c2||l===h2,u=l===Lc||l===Ic;if(c||u)if(o.isRenderTargetTexture&&o.needsPMREMUpdate===!0){o.needsPMREMUpdate=!1;let h=t.get(o);return r===null&&(r=new DT(e)),h=c?r.fromEquirectangular(o,h):r.fromCubemap(o,h),t.set(o,h),h.texture}else{if(t.has(o))return t.get(o).texture;{let h=o.image;if(c&&h&&h.height>0||u&&h&&n(h)){r===null&&(r=new DT(e));let d=c?r.fromEquirectangular(o):r.fromCubemap(o);return t.set(o,d),o.addEventListener("dispose",s),d.texture}else return null}}}return o}function n(o){let l=0,c=6;for(let u=0;u<c;u++)o[u]!==void 0&&l++;return l===c}function s(o){let l=o.target;l.removeEventListener("dispose",s);let c=t.get(l);c!==void 0&&(t.delete(l),c.dispose())}function a(){t=new WeakMap,r!==null&&(r.dispose(),r=null)}return{get:i,dispose:a}}function VY(e){let t={};function r(i){if(t[i]!==void 0)return t[i];let n;switch(i){case"WEBGL_depth_texture":n=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=e.getExtension(i)}return t[i]=n,n}return{has:function(i){return r(i)!==null},init:function(i){i.isWebGL2?r("EXT_color_buffer_float"):(r("WEBGL_depth_texture"),r("OES_texture_float"),r("OES_texture_half_float"),r("OES_texture_half_float_linear"),r("OES_standard_derivatives"),r("OES_element_index_uint"),r("OES_vertex_array_object"),r("ANGLE_instanced_arrays")),r("OES_texture_float_linear"),r("EXT_color_buffer_half_float"),r("WEBGL_multisampled_render_to_texture")},get:function(i){let n=r(i);return n===null&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),n}}}function HY(e,t,r,i){let n={},s=new WeakMap;function a(h){let d=h.target;d.index!==null&&t.remove(d.index);for(let f in d.attributes)t.remove(d.attributes[f]);d.removeEventListener("dispose",a),delete n[d.id];let p=s.get(d);p&&(t.remove(p),s.delete(d)),i.releaseStatesOfGeometry(d),d.isInstancedBufferGeometry===!0&&delete d._maxInstanceCount,r.memory.geometries--}function o(h,d){return n[d.id]===!0||(d.addEventListener("dispose",a),n[d.id]=!0,r.memory.geometries++),d}function l(h){let d=h.attributes;for(let f in d)t.update(d[f],34962);let p=h.morphAttributes;for(let f in p){let m=p[f];for(let g=0,v=m.length;g<v;g++)t.update(m[g],34962)}}function c(h){let d=[],p=h.index,f=h.attributes.position,m=0;if(p!==null){let y=p.array;m=p.version;for(let x=0,w=y.length;x<w;x+=3){let b=y[x+0],_=y[x+1],A=y[x+2];d.push(b,_,_,A,A,b)}}else{let y=f.array;m=f.version;for(let x=0,w=y.length/3-1;x<w;x+=3){let b=x+0,_=x+1,A=x+2;d.push(b,_,_,A,A,b)}}let g=new(dR(d)?gu:vR)(d,1);g.version=m;let v=s.get(h);v&&t.remove(v),s.set(h,g)}function u(h){let d=s.get(h);if(d){let p=h.index;p!==null&&d.version<p.version&&c(h)}else c(h);return s.get(h)}return{get:o,update:l,getWireframeAttribute:u}}function GY(e,t,r,i){let n=i.isWebGL2,s;function a(d){s=d}let o,l;function c(d){o=d.type,l=d.bytesPerElement}function u(d,p){e.drawElements(s,p,o,d*l),r.update(p,s,1)}function h(d,p,f){if(f===0)return;let m,g;if(n)m=e,g="drawElementsInstanced";else if(m=t.get("ANGLE_instanced_arrays"),g="drawElementsInstancedANGLE",m===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}m[g](s,p,o,d*l,f),r.update(p,s,f)}this.setMode=a,this.setIndex=c,this.render=u,this.renderInstances=h}function WY(e){let t={geometries:0,textures:0},r={frame:0,calls:0,triangles:0,points:0,lines:0};function i(s,a,o){switch(r.calls++,a){case 4:r.triangles+=o*(s/3);break;case 1:r.lines+=o*(s/2);break;case 3:r.lines+=o*(s-1);break;case 2:r.lines+=o*s;break;case 0:r.points+=o*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",a);break}}function n(){r.frame++,r.calls=0,r.triangles=0,r.points=0,r.lines=0}return{memory:t,render:r,programs:null,autoReset:!0,reset:n,update:i}}function qY(e,t){return e[0]-t[0]}function XY(e,t){return Math.abs(t[1])-Math.abs(e[1])}function YY(e,t,r){let i={},n=new Float32Array(8),s=new WeakMap,a=new dt,o=[];for(let c=0;c<8;c++)o[c]=[c,0];function l(c,u,h,d){let p=c.morphTargetInfluences;if(t.isWebGL2===!0){let f=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,m=f!==void 0?f.length:0,g=s.get(u);if(g===void 0||g.count!==m){let x=function(){I.dispose(),s.delete(u),u.removeEventListener("dispose",x)};g!==void 0&&g.texture.dispose();let w=u.morphAttributes.position!==void 0,b=u.morphAttributes.normal!==void 0,_=u.morphAttributes.color!==void 0,A=u.morphAttributes.position||[],S=u.morphAttributes.normal||[],C=u.morphAttributes.color||[],M=0;w===!0&&(M=1),b===!0&&(M=2),_===!0&&(M=3);let T=u.attributes.position.count*M,P=1;T>t.maxTextureSize&&(P=Math.ceil(T/t.maxTextureSize),T=t.maxTextureSize);let D=new Float32Array(T*P*4*m),I=new gR(D,T,P,m);I.type=xn,I.needsUpdate=!0;let B=M*4;for(let X=0;X<m;X++){let H=A[X],R=S[X],q=C[X],F=T*P*4*X;for(let N=0;N<H.count;N++){let j=N*B;w===!0&&(a.fromBufferAttribute(H,N),D[F+j+0]=a.x,D[F+j+1]=a.y,D[F+j+2]=a.z,D[F+j+3]=0),b===!0&&(a.fromBufferAttribute(R,N),D[F+j+4]=a.x,D[F+j+5]=a.y,D[F+j+6]=a.z,D[F+j+7]=0),_===!0&&(a.fromBufferAttribute(q,N),D[F+j+8]=a.x,D[F+j+9]=a.y,D[F+j+10]=a.z,D[F+j+11]=q.itemSize===4?a.w:1)}}g={count:m,texture:I,size:new W(T,P)},s.set(u,g),u.addEventListener("dispose",x)}let v=0;for(let x=0;x<p.length;x++)v+=p[x];let y=u.morphTargetsRelative?1:1-v;d.getUniforms().setValue(e,"morphTargetBaseInfluence",y),d.getUniforms().setValue(e,"morphTargetInfluences",p),d.getUniforms().setValue(e,"morphTargetsTexture",g.texture,r),d.getUniforms().setValue(e,"morphTargetsTextureSize",g.size)}else{let f=p===void 0?0:p.length,m=i[u.id];if(m===void 0||m.length!==f){m=[];for(let w=0;w<f;w++)m[w]=[w,0];i[u.id]=m}for(let w=0;w<f;w++){let b=m[w];b[0]=w,b[1]=p[w]}m.sort(XY);for(let w=0;w<8;w++)w<f&&m[w][1]?(o[w][0]=m[w][0],o[w][1]=m[w][1]):(o[w][0]=Number.MAX_SAFE_INTEGER,o[w][1]=0);o.sort(qY);let g=u.morphAttributes.position,v=u.morphAttributes.normal,y=0;for(let w=0;w<8;w++){let b=o[w],_=b[0],A=b[1];_!==Number.MAX_SAFE_INTEGER&&A?(g&&u.getAttribute("morphTarget"+w)!==g[_]&&u.setAttribute("morphTarget"+w,g[_]),v&&u.getAttribute("morphNormal"+w)!==v[_]&&u.setAttribute("morphNormal"+w,v[_]),n[w]=A,y+=A):(g&&u.hasAttribute("morphTarget"+w)===!0&&u.deleteAttribute("morphTarget"+w),v&&u.hasAttribute("morphNormal"+w)===!0&&u.deleteAttribute("morphNormal"+w),n[w]=0)}let x=u.morphTargetsRelative?1:1-y;d.getUniforms().setValue(e,"morphTargetBaseInfluence",x),d.getUniforms().setValue(e,"morphTargetInfluences",n)}}return{update:l}}function QY(e,t,r,i){let n=new WeakMap;function s(l){let c=i.render.frame,u=l.geometry,h=t.get(l,u);return n.get(h)!==c&&(t.update(h),n.set(h,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",o)===!1&&l.addEventListener("dispose",o),r.update(l.instanceMatrix,34962),l.instanceColor!==null&&r.update(l.instanceColor,34962)),h}function a(){n=new WeakMap}function o(l){let c=l.target;c.removeEventListener("dispose",o),r.remove(c.instanceMatrix),c.instanceColor!==null&&r.remove(c.instanceColor)}return{update:s,dispose:a}}var wR=new jr,bR=new gR,_R=new BW,SR=new A3,RT=[],BT=[],zT=new Float32Array(16),kT=new Float32Array(9),NT=new Float32Array(4);function pd(e,t,r){let i=e[0];if(i<=0||i>0)return e;let n=t*r,s=RT[n];if(s===void 0&&(s=new Float32Array(n),RT[n]=s),t!==0){i.toArray(s,0);for(let a=1,o=0;a!==t;++a)o+=r,e[a].toArray(s,o)}return s}function Hr(e,t){if(e.length!==t.length)return!1;for(let r=0,i=e.length;r<i;r++)if(e[r]!==t[r])return!1;return!0}function Gr(e,t){for(let r=0,i=t.length;r<i;r++)e[r]=t[r]}function Fy(e,t){let r=BT[t];r===void 0&&(r=new Int32Array(t),BT[t]=r);for(let i=0;i!==t;++i)r[i]=e.allocateTextureUnit();return r}function KY(e,t){let r=this.cache;r[0]!==t&&(e.uniform1f(this.addr,t),r[0]=t)}function ZY(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y)&&(e.uniform2f(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(Hr(r,t))return;e.uniform2fv(this.addr,t),Gr(r,t)}}function $Y(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z)&&(e.uniform3f(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else if(t.r!==void 0)(r[0]!==t.r||r[1]!==t.g||r[2]!==t.b)&&(e.uniform3f(this.addr,t.r,t.g,t.b),r[0]=t.r,r[1]=t.g,r[2]=t.b);else{if(Hr(r,t))return;e.uniform3fv(this.addr,t),Gr(r,t)}}function JY(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z||r[3]!==t.w)&&(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(Hr(r,t))return;e.uniform4fv(this.addr,t),Gr(r,t)}}function eQ(e,t){let r=this.cache,i=t.elements;if(i===void 0){if(Hr(r,t))return;e.uniformMatrix2fv(this.addr,!1,t),Gr(r,t)}else{if(Hr(r,i))return;NT.set(i),e.uniformMatrix2fv(this.addr,!1,NT),Gr(r,i)}}function tQ(e,t){let r=this.cache,i=t.elements;if(i===void 0){if(Hr(r,t))return;e.uniformMatrix3fv(this.addr,!1,t),Gr(r,t)}else{if(Hr(r,i))return;kT.set(i),e.uniformMatrix3fv(this.addr,!1,kT),Gr(r,i)}}function rQ(e,t){let r=this.cache,i=t.elements;if(i===void 0){if(Hr(r,t))return;e.uniformMatrix4fv(this.addr,!1,t),Gr(r,t)}else{if(Hr(r,i))return;zT.set(i),e.uniformMatrix4fv(this.addr,!1,zT),Gr(r,i)}}function iQ(e,t){let r=this.cache;r[0]!==t&&(e.uniform1i(this.addr,t),r[0]=t)}function nQ(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y)&&(e.uniform2i(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(Hr(r,t))return;e.uniform2iv(this.addr,t),Gr(r,t)}}function sQ(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z)&&(e.uniform3i(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else{if(Hr(r,t))return;e.uniform3iv(this.addr,t),Gr(r,t)}}function aQ(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z||r[3]!==t.w)&&(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(Hr(r,t))return;e.uniform4iv(this.addr,t),Gr(r,t)}}function oQ(e,t){let r=this.cache;r[0]!==t&&(e.uniform1ui(this.addr,t),r[0]=t)}function lQ(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y)&&(e.uniform2ui(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(Hr(r,t))return;e.uniform2uiv(this.addr,t),Gr(r,t)}}function cQ(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z)&&(e.uniform3ui(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else{if(Hr(r,t))return;e.uniform3uiv(this.addr,t),Gr(r,t)}}function hQ(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z||r[3]!==t.w)&&(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(Hr(r,t))return;e.uniform4uiv(this.addr,t),Gr(r,t)}}function uQ(e,t,r){let i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(e.uniform1i(this.addr,n),i[0]=n),r.setTexture2D(t||wR,n)}function dQ(e,t,r){let i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(e.uniform1i(this.addr,n),i[0]=n),r.setTexture3D(t||_R,n)}function pQ(e,t,r){let i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(e.uniform1i(this.addr,n),i[0]=n),r.setTextureCube(t||SR,n)}function fQ(e,t,r){let i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(e.uniform1i(this.addr,n),i[0]=n),r.setTexture2DArray(t||bR,n)}function mQ(e){switch(e){case 5126:return KY;case 35664:return ZY;case 35665:return $Y;case 35666:return JY;case 35674:return eQ;case 35675:return tQ;case 35676:return rQ;case 5124:case 35670:return iQ;case 35667:case 35671:return nQ;case 35668:case 35672:return sQ;case 35669:case 35673:return aQ;case 5125:return oQ;case 36294:return lQ;case 36295:return cQ;case 36296:return hQ;case 35678:case 36198:case 36298:case 36306:case 35682:return uQ;case 35679:case 36299:case 36307:return dQ;case 35680:case 36300:case 36308:case 36293:return pQ;case 36289:case 36303:case 36311:case 36292:return fQ}}function gQ(e,t){e.uniform1fv(this.addr,t)}function vQ(e,t){let r=pd(t,this.size,2);e.uniform2fv(this.addr,r)}function yQ(e,t){let r=pd(t,this.size,3);e.uniform3fv(this.addr,r)}function xQ(e,t){let r=pd(t,this.size,4);e.uniform4fv(this.addr,r)}function wQ(e,t){let r=pd(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,r)}function bQ(e,t){let r=pd(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,r)}function _Q(e,t){let r=pd(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,r)}function SQ(e,t){e.uniform1iv(this.addr,t)}function AQ(e,t){e.uniform2iv(this.addr,t)}function CQ(e,t){e.uniform3iv(this.addr,t)}function MQ(e,t){e.uniform4iv(this.addr,t)}function EQ(e,t){e.uniform1uiv(this.addr,t)}function TQ(e,t){e.uniform2uiv(this.addr,t)}function PQ(e,t){e.uniform3uiv(this.addr,t)}function DQ(e,t){e.uniform4uiv(this.addr,t)}function LQ(e,t,r){let i=this.cache,n=t.length,s=Fy(r,n);Hr(i,s)||(e.uniform1iv(this.addr,s),Gr(i,s));for(let a=0;a!==n;++a)r.setTexture2D(t[a]||wR,s[a])}function IQ(e,t,r){let i=this.cache,n=t.length,s=Fy(r,n);Hr(i,s)||(e.uniform1iv(this.addr,s),Gr(i,s));for(let a=0;a!==n;++a)r.setTexture3D(t[a]||_R,s[a])}function OQ(e,t,r){let i=this.cache,n=t.length,s=Fy(r,n);Hr(i,s)||(e.uniform1iv(this.addr,s),Gr(i,s));for(let a=0;a!==n;++a)r.setTextureCube(t[a]||SR,s[a])}function RQ(e,t,r){let i=this.cache,n=t.length,s=Fy(r,n);Hr(i,s)||(e.uniform1iv(this.addr,s),Gr(i,s));for(let a=0;a!==n;++a)r.setTexture2DArray(t[a]||bR,s[a])}function BQ(e){switch(e){case 5126:return gQ;case 35664:return vQ;case 35665:return yQ;case 35666:return xQ;case 35674:return wQ;case 35675:return bQ;case 35676:return _Q;case 5124:case 35670:return SQ;case 35667:case 35671:return AQ;case 35668:case 35672:return CQ;case 35669:case 35673:return MQ;case 5125:return EQ;case 36294:return TQ;case 36295:return PQ;case 36296:return DQ;case 35678:case 36198:case 36298:case 36306:case 35682:return LQ;case 35679:case 36299:case 36307:return IQ;case 35680:case 36300:case 36308:case 36293:return OQ;case 36289:case 36303:case 36311:case 36292:return RQ}}var zQ=class{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.setValue=mQ(t.type)}},kQ=class{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.size=t.size,this.setValue=BQ(t.type)}},NQ=class{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,r){let i=this.seq;for(let n=0,s=i.length;n!==s;++n){let a=i[n];a.setValue(e,t[a.id],r)}}},Ix=/(\w+)(\])?(\[|\.)?/g;function FT(e,t){e.seq.push(t),e.map[t.id]=t}function FQ(e,t,r){let i=e.name,n=i.length;for(Ix.lastIndex=0;;){let s=Ix.exec(i),a=Ix.lastIndex,o=s[1],l=s[2]==="]",c=s[3];if(l&&(o=o|0),c===void 0||c==="["&&a+2===n){FT(r,c===void 0?new zQ(o,e,t):new kQ(o,e,t));break}else{let u=r.map[o];u===void 0&&(u=new NQ(o),FT(r,u)),r=u}}}var Mv=class{constructor(e,t){this.seq=[],this.map={};let r=e.getProgramParameter(t,35718);for(let i=0;i<r;++i){let n=e.getActiveUniform(t,i),s=e.getUniformLocation(t,n.name);FQ(n,s,this)}}setValue(e,t,r,i){let n=this.map[t];n!==void 0&&n.setValue(e,r,i)}setOptional(e,t,r){let i=t[r];i!==void 0&&this.setValue(e,r,i)}static upload(e,t,r,i){for(let n=0,s=t.length;n!==s;++n){let a=t[n],o=r[a.id];o.needsUpdate!==!1&&a.setValue(e,o.value,i)}}static seqWithValue(e,t){let r=[];for(let i=0,n=e.length;i!==n;++i){let s=e[i];s.id in t&&r.push(s)}return r}};function UT(e,t,r){let i=e.createShader(t);return e.shaderSource(i,r),e.compileShader(i),i}var UQ=0;function jQ(e,t){let r=e.split(`
`),i=[],n=Math.max(t-6,0),s=Math.min(t+6,r.length);for(let a=n;a<s;a++){let o=a+1;i.push(`${o===t?">":" "} ${o}: ${r[a]}`)}return i.join(`
`)}function VQ(e){switch(e){case fa:return["Linear","( value )"];case ut:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"]}}function jT(e,t,r){let i=e.getShaderParameter(t,35713),n=e.getShaderInfoLog(t).trim();if(i&&n==="")return"";let s=/ERROR: 0:(\d+)/.exec(n);if(s){let a=parseInt(s[1]);return r.toUpperCase()+`

`+n+`

`+jQ(e.getShaderSource(t),a)}else return n}function HQ(e,t){let r=VQ(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+r[0]+r[1]+"; }"}function GQ(e,t){let r;switch(t){case KG:r="Linear";break;case ZG:r="Reinhard";break;case $G:r="OptimizedCineon";break;case JG:r="ACESFilmic";break;case eW:r="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),r="Linear"}return"vec3 "+e+"( vec3 color ) { return "+r+"ToneMapping( color ); }"}function WQ(e){return[e.extensionDerivatives||e.envMapCubeUVHeight||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||e.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap||e.transmission)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Mp).join(`
`)}function qQ(e){let t=[];for(let r in e){let i=e[r];i!==!1&&t.push("#define "+r+" "+i)}return t.join(`
`)}function XQ(e,t){let r={},i=e.getProgramParameter(t,35721);for(let n=0;n<i;n++){let s=e.getActiveAttrib(t,n),a=s.name,o=1;s.type===35674&&(o=2),s.type===35675&&(o=3),s.type===35676&&(o=4),r[a]={type:s.type,location:e.getAttribLocation(t,a),locationSize:o}}return r}function Mp(e){return e!==""}function VT(e,t){let r=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,r).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function HT(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var YQ=/^[ \t]*#include +<([\w\d./]+)>/gm;function m2(e){return e.replace(YQ,QQ)}function QQ(e,t){let r=pt[t];if(r===void 0)throw new Error("Can not resolve #include <"+t+">");return m2(r)}var KQ=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function GT(e){return e.replace(KQ,ZQ)}function ZQ(e,t,r,i){let n="";for(let s=parseInt(t);s<parseInt(r);s++)n+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return n}function WT(e){let t="precision "+e.precision+` float;
precision `+e.precision+" int;";return e.precision==="highp"?t+=`
#define HIGH_PRECISION`:e.precision==="mediump"?t+=`
#define MEDIUM_PRECISION`:e.precision==="lowp"&&(t+=`
#define LOW_PRECISION`),t}function $Q(e){let t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===x3?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===TG?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===Cp&&(t="SHADOWMAP_TYPE_VSM"),t}function JQ(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case Lc:case Ic:t="ENVMAP_TYPE_CUBE";break;case hm:t="ENVMAP_TYPE_CUBE_UV";break}return t}function eK(e){let t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case Ic:t="ENVMAP_MODE_REFRACTION";break}return t}function tK(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case nR:t="ENVMAP_BLENDING_MULTIPLY";break;case YG:t="ENVMAP_BLENDING_MIX";break;case QG:t="ENVMAP_BLENDING_ADD";break}return t}function rK(e){let t=e.envMapCubeUVHeight;if(t===null)return null;let r=Math.log2(t)-2,i=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,r),7*16)),texelHeight:i,maxMip:r}}function iK(e,t,r,i){let n=e.getContext(),s=r.defines,a=r.vertexShader,o=r.fragmentShader,l=$Q(r),c=JQ(r),u=eK(r),h=tK(r),d=rK(r),p=r.isWebGL2?"":WQ(r),f=qQ(s),m=n.createProgram(),g,v,y=r.glslVersion?"#version "+r.glslVersion+`
`:"";r.isRawShaderMaterial?(g=[f].filter(Mp).join(`
`),g.length>0&&(g+=`
`),v=[p,f].filter(Mp).join(`
`),v.length>0&&(v+=`
`)):(g=[WT(r),"#define SHADER_NAME "+r.shaderName,f,r.instancing?"#define USE_INSTANCING":"",r.instancingColor?"#define USE_INSTANCING_COLOR":"",r.supportsVertexTextures?"#define VERTEX_TEXTURES":"",r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+u:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",r.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",r.displacementMap&&r.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",r.specularColorMap?"#define USE_SPECULARCOLORMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.sheenColorMap?"#define USE_SHEENCOLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.flatShading?"#define FLAT_SHADED":"",r.skinning?"#define USE_SKINNING":"",r.morphTargets?"#define USE_MORPHTARGETS":"",r.morphNormals&&r.flatShading===!1?"#define USE_MORPHNORMALS":"",r.morphColors&&r.isWebGL2?"#define USE_MORPHCOLORS":"",r.morphTargetsCount>0&&r.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",r.morphTargetsCount>0&&r.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+r.morphTextureStride:"",r.morphTargetsCount>0&&r.isWebGL2?"#define MORPHTARGETS_COUNT "+r.morphTargetsCount:"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+l:"",r.sizeAttenuation?"#define USE_SIZEATTENUATION":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Mp).join(`
`),v=[p,WT(r),"#define SHADER_NAME "+r.shaderName,f,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.matcap?"#define USE_MATCAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+c:"",r.envMap?"#define "+u:"",r.envMap?"#define "+h:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoat?"#define USE_CLEARCOAT":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.iridescence?"#define USE_IRIDESCENCE":"",r.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",r.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",r.specularColorMap?"#define USE_SPECULARCOLORMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.alphaTest?"#define USE_ALPHATEST":"",r.sheen?"#define USE_SHEEN":"",r.sheenColorMap?"#define USE_SHEENCOLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors||r.instancingColor?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.gradientMap?"#define USE_GRADIENTMAP":"",r.flatShading?"#define FLAT_SHADED":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+l:"",r.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",r.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",r.toneMapping!==io?"#define TONE_MAPPING":"",r.toneMapping!==io?pt.tonemapping_pars_fragment:"",r.toneMapping!==io?GQ("toneMapping",r.toneMapping):"",r.dithering?"#define DITHERING":"",r.opaque?"#define OPAQUE":"",pt.encodings_pars_fragment,HQ("linearToOutputTexel",r.outputEncoding),r.useDepthPacking?"#define DEPTH_PACKING "+r.depthPacking:"",`
`].filter(Mp).join(`
`)),a=m2(a),a=VT(a,r),a=HT(a,r),o=m2(o),o=VT(o,r),o=HT(o,r),a=GT(a),o=GT(o),r.isWebGL2&&r.isRawShaderMaterial!==!0&&(y=`#version 300 es
`,g=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+g,v=["#define varying in",r.glslVersion===mT?"":"layout(location = 0) out highp vec4 pc_fragColor;",r.glslVersion===mT?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+v);let x=y+g+a,w=y+v+o,b=UT(n,35633,x),_=UT(n,35632,w);if(n.attachShader(m,b),n.attachShader(m,_),r.index0AttributeName!==void 0?n.bindAttribLocation(m,0,r.index0AttributeName):r.morphTargets===!0&&n.bindAttribLocation(m,0,"position"),n.linkProgram(m),e.debug.checkShaderErrors){let C=n.getProgramInfoLog(m).trim(),M=n.getShaderInfoLog(b).trim(),T=n.getShaderInfoLog(_).trim(),P=!0,D=!0;if(n.getProgramParameter(m,35714)===!1){P=!1;let I=jT(n,b,"vertex"),B=jT(n,_,"fragment");console.error("THREE.WebGLProgram: Shader Error "+n.getError()+" - VALIDATE_STATUS "+n.getProgramParameter(m,35715)+`

Program Info Log: `+C+`
`+I+`
`+B)}else C!==""?console.warn("THREE.WebGLProgram: Program Info Log:",C):(M===""||T==="")&&(D=!1);D&&(this.diagnostics={runnable:P,programLog:C,vertexShader:{log:M,prefix:g},fragmentShader:{log:T,prefix:v}})}n.deleteShader(b),n.deleteShader(_);let A;this.getUniforms=function(){return A===void 0&&(A=new Mv(n,m)),A};let S;return this.getAttributes=function(){return S===void 0&&(S=XQ(n,m)),S},this.destroy=function(){i.releaseStatesOfProgram(this),n.deleteProgram(m),this.program=void 0},this.name=r.shaderName,this.id=UQ++,this.cacheKey=t,this.usedTimes=1,this.program=m,this.vertexShader=b,this.fragmentShader=_,this}var nK=0,sK=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){let t=e.vertexShader,r=e.fragmentShader,i=this._getShaderStage(t),n=this._getShaderStage(r),s=this._getShaderCacheForMaterial(e);return s.has(i)===!1&&(s.add(i),i.usedTimes++),s.has(n)===!1&&(s.add(n),n.usedTimes++),this}remove(e){let t=this.materialCache.get(e);for(let r of t)r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){let t=this.materialCache,r=t.get(e);return r===void 0&&(r=new Set,t.set(e,r)),r}_getShaderStage(e){let t=this.shaderCache,r=t.get(e);return r===void 0&&(r=new aK(e),t.set(e,r)),r}},aK=class{constructor(e){this.id=nK++,this.code=e,this.usedTimes=0}};function oK(e,t,r,i,n,s,a){let o=new S3,l=new sK,c=[],u=n.isWebGL2,h=n.logarithmicDepthBuffer,d=n.vertexTextures,p=n.precision,f={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function m(S,C,M,T,P){let D=T.fog,I=P.geometry,B=S.isMeshStandardMaterial?T.environment:null,X=(S.isMeshStandardMaterial?r:t).get(S.envMap||B),H=X&&X.mapping===hm?X.image.height:null,R=f[S.type];S.precision!==null&&(p=n.getMaxPrecision(S.precision),p!==S.precision&&console.warn("THREE.WebGLProgram.getParameters:",S.precision,"not supported, using",p,"instead."));let q=I.morphAttributes.position||I.morphAttributes.normal||I.morphAttributes.color,F=q!==void 0?q.length:0,N=0;I.morphAttributes.position!==void 0&&(N=1),I.morphAttributes.normal!==void 0&&(N=2),I.morphAttributes.color!==void 0&&(N=3);let j,K,U,Y;if(R){let se=Zs[R];j=se.vertexShader,K=se.fragmentShader}else j=S.vertexShader,K=S.fragmentShader,l.update(S),U=l.getVertexShaderID(S),Y=l.getFragmentShaderID(S);let V=e.getRenderTarget(),ie=S.alphaTest>0,J=S.clearcoat>0,ee=S.iridescence>0;return{isWebGL2:u,shaderID:R,shaderName:S.type,vertexShader:j,fragmentShader:K,defines:S.defines,customVertexShaderID:U,customFragmentShaderID:Y,isRawShaderMaterial:S.isRawShaderMaterial===!0,glslVersion:S.glslVersion,precision:p,instancing:P.isInstancedMesh===!0,instancingColor:P.isInstancedMesh===!0&&P.instanceColor!==null,supportsVertexTextures:d,outputEncoding:V===null?e.outputEncoding:V.isXRRenderTarget===!0?V.texture.encoding:fa,map:!!S.map,matcap:!!S.matcap,envMap:!!X,envMapMode:X&&X.mapping,envMapCubeUVHeight:H,lightMap:!!S.lightMap,aoMap:!!S.aoMap,emissiveMap:!!S.emissiveMap,bumpMap:!!S.bumpMap,normalMap:!!S.normalMap,objectSpaceNormalMap:S.normalMapType===yW,tangentSpaceNormalMap:S.normalMapType===vW,decodeVideoTexture:!!S.map&&S.map.isVideoTexture===!0&&S.map.encoding===ut,clearcoat:J,clearcoatMap:J&&!!S.clearcoatMap,clearcoatRoughnessMap:J&&!!S.clearcoatRoughnessMap,clearcoatNormalMap:J&&!!S.clearcoatNormalMap,iridescence:ee,iridescenceMap:ee&&!!S.iridescenceMap,iridescenceThicknessMap:ee&&!!S.iridescenceThicknessMap,displacementMap:!!S.displacementMap,roughnessMap:!!S.roughnessMap,metalnessMap:!!S.metalnessMap,specularMap:!!S.specularMap,specularIntensityMap:!!S.specularIntensityMap,specularColorMap:!!S.specularColorMap,opaque:S.transparent===!1&&S.blending===mu,alphaMap:!!S.alphaMap,alphaTest:ie,gradientMap:!!S.gradientMap,sheen:S.sheen>0,sheenColorMap:!!S.sheenColorMap,sheenRoughnessMap:!!S.sheenRoughnessMap,transmission:S.transmission>0,transmissionMap:!!S.transmissionMap,thicknessMap:!!S.thicknessMap,combine:S.combine,vertexTangents:!!S.normalMap&&!!I.attributes.tangent,vertexColors:S.vertexColors,vertexAlphas:S.vertexColors===!0&&!!I.attributes.color&&I.attributes.color.itemSize===4,vertexUvs:!!S.map||!!S.bumpMap||!!S.normalMap||!!S.specularMap||!!S.alphaMap||!!S.emissiveMap||!!S.roughnessMap||!!S.metalnessMap||!!S.clearcoatMap||!!S.clearcoatRoughnessMap||!!S.clearcoatNormalMap||!!S.iridescenceMap||!!S.iridescenceThicknessMap||!!S.displacementMap||!!S.transmissionMap||!!S.thicknessMap||!!S.specularIntensityMap||!!S.specularColorMap||!!S.sheenColorMap||!!S.sheenRoughnessMap,uvsVertexOnly:!(S.map||S.bumpMap||S.normalMap||S.specularMap||S.alphaMap||S.emissiveMap||S.roughnessMap||S.metalnessMap||S.clearcoatNormalMap||S.iridescenceMap||S.iridescenceThicknessMap||S.transmission>0||S.transmissionMap||S.thicknessMap||S.specularIntensityMap||S.specularColorMap||S.sheen>0||S.sheenColorMap||S.sheenRoughnessMap)&&!!S.displacementMap,fog:!!D,useFog:S.fog===!0,fogExp2:D&&D.isFogExp2,flatShading:!!S.flatShading,sizeAttenuation:S.sizeAttenuation,logarithmicDepthBuffer:h,skinning:P.isSkinnedMesh===!0,morphTargets:I.morphAttributes.position!==void 0,morphNormals:I.morphAttributes.normal!==void 0,morphColors:I.morphAttributes.color!==void 0,morphTargetsCount:F,morphTextureStride:N,numDirLights:C.directional.length,numPointLights:C.point.length,numSpotLights:C.spot.length,numSpotLightMaps:C.spotLightMap.length,numRectAreaLights:C.rectArea.length,numHemiLights:C.hemi.length,numDirLightShadows:C.directionalShadowMap.length,numPointLightShadows:C.pointShadowMap.length,numSpotLightShadows:C.spotShadowMap.length,numSpotLightShadowsWithMaps:C.numSpotLightShadowsWithMaps,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:S.dithering,shadowMapEnabled:e.shadowMap.enabled&&M.length>0,shadowMapType:e.shadowMap.type,toneMapping:S.toneMapped?e.toneMapping:io,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:S.premultipliedAlpha,doubleSided:S.side===yn,flipSided:S.side===$r,useDepthPacking:!!S.depthPacking,depthPacking:S.depthPacking||0,index0AttributeName:S.index0AttributeName,extensionDerivatives:S.extensions&&S.extensions.derivatives,extensionFragDepth:S.extensions&&S.extensions.fragDepth,extensionDrawBuffers:S.extensions&&S.extensions.drawBuffers,extensionShaderTextureLOD:S.extensions&&S.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||i.has("EXT_shader_texture_lod"),customProgramCacheKey:S.customProgramCacheKey()}}function g(S){let C=[];if(S.shaderID?C.push(S.shaderID):(C.push(S.customVertexShaderID),C.push(S.customFragmentShaderID)),S.defines!==void 0)for(let M in S.defines)C.push(M),C.push(S.defines[M]);return S.isRawShaderMaterial===!1&&(v(C,S),y(C,S),C.push(e.outputEncoding)),C.push(S.customProgramCacheKey),C.join()}function v(S,C){S.push(C.precision),S.push(C.outputEncoding),S.push(C.envMapMode),S.push(C.envMapCubeUVHeight),S.push(C.combine),S.push(C.vertexUvs),S.push(C.fogExp2),S.push(C.sizeAttenuation),S.push(C.morphTargetsCount),S.push(C.morphAttributeCount),S.push(C.numDirLights),S.push(C.numPointLights),S.push(C.numSpotLights),S.push(C.numSpotLightMaps),S.push(C.numHemiLights),S.push(C.numRectAreaLights),S.push(C.numDirLightShadows),S.push(C.numPointLightShadows),S.push(C.numSpotLightShadows),S.push(C.numSpotLightShadowsWithMaps),S.push(C.shadowMapType),S.push(C.toneMapping),S.push(C.numClippingPlanes),S.push(C.numClipIntersection),S.push(C.depthPacking)}function y(S,C){o.disableAll(),C.isWebGL2&&o.enable(0),C.supportsVertexTextures&&o.enable(1),C.instancing&&o.enable(2),C.instancingColor&&o.enable(3),C.map&&o.enable(4),C.matcap&&o.enable(5),C.envMap&&o.enable(6),C.lightMap&&o.enable(7),C.aoMap&&o.enable(8),C.emissiveMap&&o.enable(9),C.bumpMap&&o.enable(10),C.normalMap&&o.enable(11),C.objectSpaceNormalMap&&o.enable(12),C.tangentSpaceNormalMap&&o.enable(13),C.clearcoat&&o.enable(14),C.clearcoatMap&&o.enable(15),C.clearcoatRoughnessMap&&o.enable(16),C.clearcoatNormalMap&&o.enable(17),C.iridescence&&o.enable(18),C.iridescenceMap&&o.enable(19),C.iridescenceThicknessMap&&o.enable(20),C.displacementMap&&o.enable(21),C.specularMap&&o.enable(22),C.roughnessMap&&o.enable(23),C.metalnessMap&&o.enable(24),C.gradientMap&&o.enable(25),C.alphaMap&&o.enable(26),C.alphaTest&&o.enable(27),C.vertexColors&&o.enable(28),C.vertexAlphas&&o.enable(29),C.vertexUvs&&o.enable(30),C.vertexTangents&&o.enable(31),C.uvsVertexOnly&&o.enable(32),S.push(o.mask),o.disableAll(),C.fog&&o.enable(0),C.useFog&&o.enable(1),C.flatShading&&o.enable(2),C.logarithmicDepthBuffer&&o.enable(3),C.skinning&&o.enable(4),C.morphTargets&&o.enable(5),C.morphNormals&&o.enable(6),C.morphColors&&o.enable(7),C.premultipliedAlpha&&o.enable(8),C.shadowMapEnabled&&o.enable(9),C.physicallyCorrectLights&&o.enable(10),C.doubleSided&&o.enable(11),C.flipSided&&o.enable(12),C.useDepthPacking&&o.enable(13),C.dithering&&o.enable(14),C.specularIntensityMap&&o.enable(15),C.specularColorMap&&o.enable(16),C.transmission&&o.enable(17),C.transmissionMap&&o.enable(18),C.thicknessMap&&o.enable(19),C.sheen&&o.enable(20),C.sheenColorMap&&o.enable(21),C.sheenRoughnessMap&&o.enable(22),C.decodeVideoTexture&&o.enable(23),C.opaque&&o.enable(24),S.push(o.mask)}function x(S){let C=f[S.type],M;if(C){let T=Zs[C];M=ud.clone(T.uniforms)}else M=S.uniforms;return M}function w(S,C){let M;for(let T=0,P=c.length;T<P;T++){let D=c[T];if(D.cacheKey===C){M=D,++M.usedTimes;break}}return M===void 0&&(M=new iK(e,C,S,s),c.push(M)),M}function b(S){if(--S.usedTimes===0){let C=c.indexOf(S);c[C]=c[c.length-1],c.pop(),S.destroy()}}function _(S){l.remove(S)}function A(){l.dispose()}return{getParameters:m,getProgramCacheKey:g,getUniforms:x,acquireProgram:w,releaseProgram:b,releaseShaderCache:_,programs:c,dispose:A}}function lK(){let e=new WeakMap;function t(s){let a=e.get(s);return a===void 0&&(a={},e.set(s,a)),a}function r(s){e.delete(s)}function i(s,a,o){e.get(s)[a]=o}function n(){e=new WeakMap}return{get:t,remove:r,update:i,dispose:n}}function cK(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function qT(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function XT(){let e=[],t=0,r=[],i=[],n=[];function s(){t=0,r.length=0,i.length=0,n.length=0}function a(h,d,p,f,m,g){let v=e[t];return v===void 0?(v={id:h.id,object:h,geometry:d,material:p,groupOrder:f,renderOrder:h.renderOrder,z:m,group:g},e[t]=v):(v.id=h.id,v.object=h,v.geometry=d,v.material=p,v.groupOrder=f,v.renderOrder=h.renderOrder,v.z=m,v.group=g),t++,v}function o(h,d,p,f,m,g){let v=a(h,d,p,f,m,g);p.transmission>0?i.push(v):p.transparent===!0?n.push(v):r.push(v)}function l(h,d,p,f,m,g){let v=a(h,d,p,f,m,g);p.transmission>0?i.unshift(v):p.transparent===!0?n.unshift(v):r.unshift(v)}function c(h,d){r.length>1&&r.sort(h||cK),i.length>1&&i.sort(d||qT),n.length>1&&n.sort(d||qT)}function u(){for(let h=t,d=e.length;h<d;h++){let p=e[h];if(p.id===null)break;p.id=null,p.object=null,p.geometry=null,p.material=null,p.group=null}}return{opaque:r,transmissive:i,transparent:n,init:s,push:o,unshift:l,finish:u,sort:c}}function hK(){let e=new WeakMap;function t(i,n){let s=e.get(i),a;return s===void 0?(a=new XT,e.set(i,[a])):n>=s.length?(a=new XT,s.push(a)):a=s[n],a}function r(){e=new WeakMap}return{get:t,dispose:r}}function uK(){let e={};return{get:function(t){if(e[t.id]!==void 0)return e[t.id];let r;switch(t.type){case"DirectionalLight":r={direction:new E,color:new $e};break;case"SpotLight":r={position:new E,direction:new E,color:new $e,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":r={position:new E,color:new $e,distance:0,decay:0};break;case"HemisphereLight":r={direction:new E,skyColor:new $e,groundColor:new $e};break;case"RectAreaLight":r={color:new $e,position:new E,halfWidth:new E,halfHeight:new E};break}return e[t.id]=r,r}}}function dK(){let e={};return{get:function(t){if(e[t.id]!==void 0)return e[t.id];let r;switch(t.type){case"DirectionalLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new W};break;case"SpotLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new W};break;case"PointLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new W,shadowCameraNear:1,shadowCameraFar:1e3};break}return e[t.id]=r,r}}}var pK=0;function fK(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function mK(e,t){let r=new uK,i=dK(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let u=0;u<9;u++)n.probe.push(new E);let s=new E,a=new _e,o=new _e;function l(u,h){let d=0,p=0,f=0;for(let T=0;T<9;T++)n.probe[T].set(0,0,0);let m=0,g=0,v=0,y=0,x=0,w=0,b=0,_=0,A=0,S=0;u.sort(fK);let C=h!==!0?Math.PI:1;for(let T=0,P=u.length;T<P;T++){let D=u[T],I=D.color,B=D.intensity,X=D.distance,H=D.shadow&&D.shadow.map?D.shadow.map.texture:null;if(D.isAmbientLight)d+=I.r*B*C,p+=I.g*B*C,f+=I.b*B*C;else if(D.isLightProbe)for(let R=0;R<9;R++)n.probe[R].addScaledVector(D.sh.coefficients[R],B);else if(D.isDirectionalLight){let R=r.get(D);if(R.color.copy(D.color).multiplyScalar(D.intensity*C),D.castShadow){let q=D.shadow,F=i.get(D);F.shadowBias=q.bias,F.shadowNormalBias=q.normalBias,F.shadowRadius=q.radius,F.shadowMapSize=q.mapSize,n.directionalShadow[m]=F,n.directionalShadowMap[m]=H,n.directionalShadowMatrix[m]=D.shadow.matrix,w++}n.directional[m]=R,m++}else if(D.isSpotLight){let R=r.get(D);R.position.setFromMatrixPosition(D.matrixWorld),R.color.copy(I).multiplyScalar(B*C),R.distance=X,R.coneCos=Math.cos(D.angle),R.penumbraCos=Math.cos(D.angle*(1-D.penumbra)),R.decay=D.decay,n.spot[v]=R;let q=D.shadow;if(D.map&&(n.spotLightMap[A]=D.map,A++,q.updateMatrices(D),D.castShadow&&S++),n.spotLightMatrix[v]=q.matrix,D.castShadow){let F=i.get(D);F.shadowBias=q.bias,F.shadowNormalBias=q.normalBias,F.shadowRadius=q.radius,F.shadowMapSize=q.mapSize,n.spotShadow[v]=F,n.spotShadowMap[v]=H,_++}v++}else if(D.isRectAreaLight){let R=r.get(D);R.color.copy(I).multiplyScalar(B),R.halfWidth.set(D.width*.5,0,0),R.halfHeight.set(0,D.height*.5,0),n.rectArea[y]=R,y++}else if(D.isPointLight){let R=r.get(D);if(R.color.copy(D.color).multiplyScalar(D.intensity*C),R.distance=D.distance,R.decay=D.decay,D.castShadow){let q=D.shadow,F=i.get(D);F.shadowBias=q.bias,F.shadowNormalBias=q.normalBias,F.shadowRadius=q.radius,F.shadowMapSize=q.mapSize,F.shadowCameraNear=q.camera.near,F.shadowCameraFar=q.camera.far,n.pointShadow[g]=F,n.pointShadowMap[g]=H,n.pointShadowMatrix[g]=D.shadow.matrix,b++}n.point[g]=R,g++}else if(D.isHemisphereLight){let R=r.get(D);R.skyColor.copy(D.color).multiplyScalar(B*C),R.groundColor.copy(D.groundColor).multiplyScalar(B*C),n.hemi[x]=R,x++}}y>0&&(t.isWebGL2||e.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=Pe.LTC_FLOAT_1,n.rectAreaLTC2=Pe.LTC_FLOAT_2):e.has("OES_texture_half_float_linear")===!0?(n.rectAreaLTC1=Pe.LTC_HALF_1,n.rectAreaLTC2=Pe.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),n.ambient[0]=d,n.ambient[1]=p,n.ambient[2]=f;let M=n.hash;(M.directionalLength!==m||M.pointLength!==g||M.spotLength!==v||M.rectAreaLength!==y||M.hemiLength!==x||M.numDirectionalShadows!==w||M.numPointShadows!==b||M.numSpotShadows!==_||M.numSpotMaps!==A)&&(n.directional.length=m,n.spot.length=v,n.rectArea.length=y,n.point.length=g,n.hemi.length=x,n.directionalShadow.length=w,n.directionalShadowMap.length=w,n.pointShadow.length=b,n.pointShadowMap.length=b,n.spotShadow.length=_,n.spotShadowMap.length=_,n.directionalShadowMatrix.length=w,n.pointShadowMatrix.length=b,n.spotLightMatrix.length=_+A-S,n.spotLightMap.length=A,n.numSpotLightShadowsWithMaps=S,M.directionalLength=m,M.pointLength=g,M.spotLength=v,M.rectAreaLength=y,M.hemiLength=x,M.numDirectionalShadows=w,M.numPointShadows=b,M.numSpotShadows=_,M.numSpotMaps=A,n.version=pK++)}function c(u,h){let d=0,p=0,f=0,m=0,g=0,v=h.matrixWorldInverse;for(let y=0,x=u.length;y<x;y++){let w=u[y];if(w.isDirectionalLight){let b=n.directional[d];b.direction.setFromMatrixPosition(w.matrixWorld),s.setFromMatrixPosition(w.target.matrixWorld),b.direction.sub(s),b.direction.transformDirection(v),d++}else if(w.isSpotLight){let b=n.spot[f];b.position.setFromMatrixPosition(w.matrixWorld),b.position.applyMatrix4(v),b.direction.setFromMatrixPosition(w.matrixWorld),s.setFromMatrixPosition(w.target.matrixWorld),b.direction.sub(s),b.direction.transformDirection(v),f++}else if(w.isRectAreaLight){let b=n.rectArea[m];b.position.setFromMatrixPosition(w.matrixWorld),b.position.applyMatrix4(v),o.identity(),a.copy(w.matrixWorld),a.premultiply(v),o.extractRotation(a),b.halfWidth.set(w.width*.5,0,0),b.halfHeight.set(0,w.height*.5,0),b.halfWidth.applyMatrix4(o),b.halfHeight.applyMatrix4(o),m++}else if(w.isPointLight){let b=n.point[p];b.position.setFromMatrixPosition(w.matrixWorld),b.position.applyMatrix4(v),p++}else if(w.isHemisphereLight){let b=n.hemi[g];b.direction.setFromMatrixPosition(w.matrixWorld),b.direction.transformDirection(v),g++}}}return{setup:l,setupView:c,state:n}}function YT(e,t){let r=new mK(e,t),i=[],n=[];function s(){i.length=0,n.length=0}function a(u){i.push(u)}function o(u){n.push(u)}function l(u){r.setup(i,u)}function c(u){r.setupView(i,u)}return{init:s,state:{lightsArray:i,shadowsArray:n,lights:r},setupLights:l,setupLightsView:c,pushLight:a,pushShadow:o}}function gK(e,t){let r=new WeakMap;function i(s,a=0){let o=r.get(s),l;return o===void 0?(l=new YT(e,t),r.set(s,[l])):a>=o.length?(l=new YT(e,t),o.push(l)):l=o[a],l}function n(){r=new WeakMap}return{get:i,dispose:n}}var AR=class extends um{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=vo,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}},vK=class extends um{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new E,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}},yK=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,xK=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function wK(e,t,r){let i=new C3,n=new W,s=new W,a=new dt,o=new AR({depthPacking:hR}),l=new vK,c={},u=r.maxTextureSize,h={[Ds]:$r,[$r]:Ds,[yn]:yn},d=new Yt({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new W},radius:{value:4}},vertexShader:yK,fragmentShader:xK}),p=d.clone();p.defines.HORIZONTAL_PASS=1;let f=new it;f.setAttribute("position",new nt(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let m=new Ki(f,d),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=x3,this.render=function(w,b,_){if(g.enabled===!1||g.autoUpdate===!1&&g.needsUpdate===!1||w.length===0)return;let A=e.getRenderTarget(),S=e.getActiveCubeFace(),C=e.getActiveMipmapLevel(),M=e.state;M.setBlending(Ir),M.buffers.color.setClear(1,1,1,1),M.buffers.depth.setTest(!0),M.setScissorTest(!1);for(let T=0,P=w.length;T<P;T++){let D=w[T],I=D.shadow;if(I===void 0){console.warn("THREE.WebGLShadowMap:",D,"has no shadow.");continue}if(I.autoUpdate===!1&&I.needsUpdate===!1)continue;n.copy(I.mapSize);let B=I.getFrameExtents();if(n.multiply(B),s.copy(I.mapSize),(n.x>u||n.y>u)&&(n.x>u&&(s.x=Math.floor(u/B.x),n.x=s.x*B.x,I.mapSize.x=s.x),n.y>u&&(s.y=Math.floor(u/B.y),n.y=s.y*B.y,I.mapSize.y=s.y)),I.map===null){let H=this.type!==Cp?{minFilter:Xt,magFilter:Xt}:{};I.map=new Ut(n.x,n.y,H),I.map.texture.name=D.name+".shadowMap",I.camera.updateProjectionMatrix()}e.setRenderTarget(I.map),e.clear();let X=I.getViewportCount();for(let H=0;H<X;H++){let R=I.getViewport(H);a.set(s.x*R.x,s.y*R.y,s.x*R.z,s.y*R.w),M.viewport(a),I.updateMatrices(D,H),i=I.getFrustum(),x(b,_,I.camera,D,this.type)}I.isPointLightShadow!==!0&&this.type===Cp&&v(I,_),I.needsUpdate=!1}g.needsUpdate=!1,e.setRenderTarget(A,S,C)};function v(w,b){let _=t.update(m);d.defines.VSM_SAMPLES!==w.blurSamples&&(d.defines.VSM_SAMPLES=w.blurSamples,p.defines.VSM_SAMPLES=w.blurSamples,d.needsUpdate=!0,p.needsUpdate=!0),w.mapPass===null&&(w.mapPass=new Ut(n.x,n.y)),d.uniforms.shadow_pass.value=w.map.texture,d.uniforms.resolution.value=w.mapSize,d.uniforms.radius.value=w.radius,e.setRenderTarget(w.mapPass),e.clear(),e.renderBufferDirect(b,null,_,d,m,null),p.uniforms.shadow_pass.value=w.mapPass.texture,p.uniforms.resolution.value=w.mapSize,p.uniforms.radius.value=w.radius,e.setRenderTarget(w.map),e.clear(),e.renderBufferDirect(b,null,_,p,m,null)}function y(w,b,_,A,S,C){let M=null,T=_.isPointLight===!0?w.customDistanceMaterial:w.customDepthMaterial;if(T!==void 0)M=T;else if(M=_.isPointLight===!0?l:o,e.localClippingEnabled&&b.clipShadows===!0&&Array.isArray(b.clippingPlanes)&&b.clippingPlanes.length!==0||b.displacementMap&&b.displacementScale!==0||b.alphaMap&&b.alphaTest>0||b.map&&b.alphaTest>0){let P=M.uuid,D=b.uuid,I=c[P];I===void 0&&(I={},c[P]=I);let B=I[D];B===void 0&&(B=M.clone(),I[D]=B),M=B}return M.visible=b.visible,M.wireframe=b.wireframe,C===Cp?M.side=b.shadowSide!==null?b.shadowSide:b.side:M.side=b.shadowSide!==null?b.shadowSide:h[b.side],M.alphaMap=b.alphaMap,M.alphaTest=b.alphaTest,M.map=b.map,M.clipShadows=b.clipShadows,M.clippingPlanes=b.clippingPlanes,M.clipIntersection=b.clipIntersection,M.displacementMap=b.displacementMap,M.displacementScale=b.displacementScale,M.displacementBias=b.displacementBias,M.wireframeLinewidth=b.wireframeLinewidth,M.linewidth=b.linewidth,_.isPointLight===!0&&M.isMeshDistanceMaterial===!0&&(M.referencePosition.setFromMatrixPosition(_.matrixWorld),M.nearDistance=A,M.farDistance=S),M}function x(w,b,_,A,S){if(w.visible===!1)return;if(w.layers.test(b.layers)&&(w.isMesh||w.isLine||w.isPoints)&&(w.castShadow||w.receiveShadow&&S===Cp)&&(!w.frustumCulled||i.intersectsObject(w))){w.modelViewMatrix.multiplyMatrices(_.matrixWorldInverse,w.matrixWorld);let M=t.update(w),T=w.material;if(Array.isArray(T)){let P=M.groups;for(let D=0,I=P.length;D<I;D++){let B=P[D],X=T[B.materialIndex];if(X&&X.visible){let H=y(w,X,A,_.near,_.far,S);e.renderBufferDirect(_,null,M,H,w,B)}}}else if(T.visible){let P=y(w,T,A,_.near,_.far,S);e.renderBufferDirect(_,null,M,P,w,null)}}let C=w.children;for(let M=0,T=C.length;M<T;M++)x(C[M],b,_,A,S)}}function bK(e,t,r){let i=r.isWebGL2;function n(){let G=!1,te=new dt,ae=null,me=new dt(0,0,0,0);return{setMask:function(Le){ae!==Le&&!G&&(e.colorMask(Le,Le,Le,Le),ae=Le)},setLocked:function(Le){G=Le},setClear:function(Le,Je,ot,bt,Qt){Qt===!0&&(Le*=bt,Je*=bt,ot*=bt),te.set(Le,Je,ot,bt),me.equals(te)===!1&&(e.clearColor(Le,Je,ot,bt),me.copy(te))},reset:function(){G=!1,ae=null,me.set(-1,0,0,0)}}}function s(){let G=!1,te=null,ae=null,me=null;return{setTest:function(Le){Le?ie(2929):J(2929)},setMask:function(Le){te!==Le&&!G&&(e.depthMask(Le),te=Le)},setFunc:function(Le){if(ae!==Le){switch(Le){case jG:e.depthFunc(512);break;case VG:e.depthFunc(519);break;case HG:e.depthFunc(513);break;case l2:e.depthFunc(515);break;case GG:e.depthFunc(514);break;case WG:e.depthFunc(518);break;case qG:e.depthFunc(516);break;case XG:e.depthFunc(517);break;default:e.depthFunc(515)}ae=Le}},setLocked:function(Le){G=Le},setClear:function(Le){me!==Le&&(e.clearDepth(Le),me=Le)},reset:function(){G=!1,te=null,ae=null,me=null}}}function a(){let G=!1,te=null,ae=null,me=null,Le=null,Je=null,ot=null,bt=null,Qt=null;return{setTest:function(Lt){G||(Lt?ie(2960):J(2960))},setMask:function(Lt){te!==Lt&&!G&&(e.stencilMask(Lt),te=Lt)},setFunc:function(Lt,ii,qr){(ae!==Lt||me!==ii||Le!==qr)&&(e.stencilFunc(Lt,ii,qr),ae=Lt,me=ii,Le=qr)},setOp:function(Lt,ii,qr){(Je!==Lt||ot!==ii||bt!==qr)&&(e.stencilOp(Lt,ii,qr),Je=Lt,ot=ii,bt=qr)},setLocked:function(Lt){G=Lt},setClear:function(Lt){Qt!==Lt&&(e.clearStencil(Lt),Qt=Lt)},reset:function(){G=!1,te=null,ae=null,me=null,Le=null,Je=null,ot=null,bt=null,Qt=null}}}let o=new n,l=new s,c=new a,u=new WeakMap,h=new WeakMap,d={},p={},f=new WeakMap,m=[],g=null,v=!1,y=null,x=null,w=null,b=null,_=null,A=null,S=null,C=!1,M=null,T=null,P=null,D=null,I=null,B=e.getParameter(35661),X=!1,H=0,R=e.getParameter(7938);R.indexOf("WebGL")!==-1?(H=parseFloat(/^WebGL (\d)/.exec(R)[1]),X=H>=1):R.indexOf("OpenGL ES")!==-1&&(H=parseFloat(/^OpenGL ES (\d)/.exec(R)[1]),X=H>=2);let q=null,F={},N=e.getParameter(3088),j=e.getParameter(2978),K=new dt().fromArray(N),U=new dt().fromArray(j);function Y(G,te,ae){let me=new Uint8Array(4),Le=e.createTexture();e.bindTexture(G,Le),e.texParameteri(G,10241,9728),e.texParameteri(G,10240,9728);for(let Je=0;Je<ae;Je++)e.texImage2D(te+Je,0,6408,1,1,0,6408,5121,me);return Le}let V={};V[3553]=Y(3553,3553,1),V[34067]=Y(34067,34069,6),o.setClear(0,0,0,1),l.setClear(1),c.setClear(0),ie(2929),l.setFunc(l2),ke(!1),Oe(FE),ie(2884),Re(Ir);function ie(G){d[G]!==!0&&(e.enable(G),d[G]=!0)}function J(G){d[G]!==!1&&(e.disable(G),d[G]=!1)}function ee(G,te){return p[G]!==te?(e.bindFramebuffer(G,te),p[G]=te,i&&(G===36009&&(p[36160]=te),G===36160&&(p[36009]=te)),!0):!1}function se(G,te){let ae=m,me=!1;if(G)if(ae=f.get(te),ae===void 0&&(ae=[],f.set(te,ae)),G.isWebGLMultipleRenderTargets){let Le=G.texture;if(ae.length!==Le.length||ae[0]!==36064){for(let Je=0,ot=Le.length;Je<ot;Je++)ae[Je]=36064+Je;ae.length=Le.length,me=!0}}else ae[0]!==36064&&(ae[0]=36064,me=!0);else ae[0]!==1029&&(ae[0]=1029,me=!0);me&&(r.isWebGL2?e.drawBuffers(ae):t.get("WEBGL_draw_buffers").drawBuffersWEBGL(ae))}function ce(G){return g!==G?(e.useProgram(G),g=G,!0):!1}let ue={[Dh]:32774,[DG]:32778,[LG]:32779};if(i)ue[HE]=32775,ue[GE]=32776;else{let G=t.get("EXT_blend_minmax");G!==null&&(ue[HE]=G.MIN_EXT,ue[GE]=G.MAX_EXT)}let ye={[IG]:0,[OG]:1,[RG]:768,[rR]:770,[UG]:776,[NG]:774,[zG]:772,[BG]:769,[iR]:771,[FG]:775,[kG]:773};function Re(G,te,ae,me,Le,Je,ot,bt){if(G===Ir){v===!0&&(J(3042),v=!1);return}if(v===!1&&(ie(3042),v=!0),G!==PG){if(G!==y||bt!==C){if((x!==Dh||_!==Dh)&&(e.blendEquation(32774),x=Dh,_=Dh),bt)switch(G){case mu:e.blendFuncSeparate(1,771,1,771);break;case UE:e.blendFunc(1,1);break;case jE:e.blendFuncSeparate(0,769,0,1);break;case VE:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",G);break}else switch(G){case mu:e.blendFuncSeparate(770,771,1,771);break;case UE:e.blendFunc(770,1);break;case jE:e.blendFuncSeparate(0,769,0,1);break;case VE:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",G);break}w=null,b=null,A=null,S=null,y=G,C=bt}return}Le=Le||te,Je=Je||ae,ot=ot||me,(te!==x||Le!==_)&&(e.blendEquationSeparate(ue[te],ue[Le]),x=te,_=Le),(ae!==w||me!==b||Je!==A||ot!==S)&&(e.blendFuncSeparate(ye[ae],ye[me],ye[Je],ye[ot]),w=ae,b=me,A=Je,S=ot),y=G,C=!1}function Se(G,te){G.side===yn?J(2884):ie(2884);let ae=G.side===$r;te&&(ae=!ae),ke(ae),G.blending===mu&&G.transparent===!1?Re(Ir):Re(G.blending,G.blendEquation,G.blendSrc,G.blendDst,G.blendEquationAlpha,G.blendSrcAlpha,G.blendDstAlpha,G.premultipliedAlpha),l.setFunc(G.depthFunc),l.setTest(G.depthTest),l.setMask(G.depthWrite),o.setMask(G.colorWrite);let me=G.stencilWrite;c.setTest(me),me&&(c.setMask(G.stencilWriteMask),c.setFunc(G.stencilFunc,G.stencilRef,G.stencilFuncMask),c.setOp(G.stencilFail,G.stencilZFail,G.stencilZPass)),Ae(G.polygonOffset,G.polygonOffsetFactor,G.polygonOffsetUnits),G.alphaToCoverage===!0?ie(32926):J(32926)}function ke(G){M!==G&&(G?e.frontFace(2304):e.frontFace(2305),M=G)}function Oe(G){G!==MG?(ie(2884),G!==T&&(G===FE?e.cullFace(1029):G===EG?e.cullFace(1028):e.cullFace(1032))):J(2884),T=G}function Ce(G){G!==P&&(X&&e.lineWidth(G),P=G)}function Ae(G,te,ae){G?(ie(32823),(D!==te||I!==ae)&&(e.polygonOffset(te,ae),D=te,I=ae)):J(32823)}function je(G){G?ie(3089):J(3089)}function We(G){G===void 0&&(G=33984+B-1),q!==G&&(e.activeTexture(G),q=G)}function k(G,te,ae){ae===void 0&&(q===null?ae=33984+B-1:ae=q);let me=F[ae];me===void 0&&(me={type:void 0,texture:void 0},F[ae]=me),(me.type!==G||me.texture!==te)&&(q!==ae&&(e.activeTexture(ae),q=ae),e.bindTexture(G,te||V[G]),me.type=G,me.texture=te)}function O(){let G=F[q];G!==void 0&&G.type!==void 0&&(e.bindTexture(G.type,null),G.type=void 0,G.texture=void 0)}function oe(){try{e.compressedTexImage2D.apply(e,arguments)}catch(G){console.error("THREE.WebGLState:",G)}}function be(){try{e.compressedTexImage3D.apply(e,arguments)}catch(G){console.error("THREE.WebGLState:",G)}}function xe(){try{e.texSubImage2D.apply(e,arguments)}catch(G){console.error("THREE.WebGLState:",G)}}function Te(){try{e.texSubImage3D.apply(e,arguments)}catch(G){console.error("THREE.WebGLState:",G)}}function Ge(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(G){console.error("THREE.WebGLState:",G)}}function Ie(){try{e.compressedTexSubImage3D.apply(e,arguments)}catch(G){console.error("THREE.WebGLState:",G)}}function pe(){try{e.texStorage2D.apply(e,arguments)}catch(G){console.error("THREE.WebGLState:",G)}}function Ve(){try{e.texStorage3D.apply(e,arguments)}catch(G){console.error("THREE.WebGLState:",G)}}function qe(){try{e.texImage2D.apply(e,arguments)}catch(G){console.error("THREE.WebGLState:",G)}}function Xe(){try{e.texImage3D.apply(e,arguments)}catch(G){console.error("THREE.WebGLState:",G)}}function Q(G){K.equals(G)===!1&&(e.scissor(G.x,G.y,G.z,G.w),K.copy(G))}function $(G){U.equals(G)===!1&&(e.viewport(G.x,G.y,G.z,G.w),U.copy(G))}function de(G,te){let ae=h.get(te);ae===void 0&&(ae=new WeakMap,h.set(te,ae));let me=ae.get(G);me===void 0&&(me=e.getUniformBlockIndex(te,G.name),ae.set(G,me))}function Ee(G,te){let ae=h.get(te).get(G);u.get(te)!==ae&&(e.uniformBlockBinding(te,ae,G.__bindingPointIndex),u.set(te,ae))}function He(){e.disable(3042),e.disable(2884),e.disable(2929),e.disable(32823),e.disable(3089),e.disable(2960),e.disable(32926),e.blendEquation(32774),e.blendFunc(1,0),e.blendFuncSeparate(1,0,1,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(513),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(519,0,4294967295),e.stencilOp(7680,7680,7680),e.clearStencil(0),e.cullFace(1029),e.frontFace(2305),e.polygonOffset(0,0),e.activeTexture(33984),e.bindFramebuffer(36160,null),i===!0&&(e.bindFramebuffer(36009,null),e.bindFramebuffer(36008,null)),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),d={},q=null,F={},p={},f=new WeakMap,m=[],g=null,v=!1,y=null,x=null,w=null,b=null,_=null,A=null,S=null,C=!1,M=null,T=null,P=null,D=null,I=null,K.set(0,0,e.canvas.width,e.canvas.height),U.set(0,0,e.canvas.width,e.canvas.height),o.reset(),l.reset(),c.reset()}return{buffers:{color:o,depth:l,stencil:c},enable:ie,disable:J,bindFramebuffer:ee,drawBuffers:se,useProgram:ce,setBlending:Re,setMaterial:Se,setFlipSided:ke,setCullFace:Oe,setLineWidth:Ce,setPolygonOffset:Ae,setScissorTest:je,activeTexture:We,bindTexture:k,unbindTexture:O,compressedTexImage2D:oe,compressedTexImage3D:be,texImage2D:qe,texImage3D:Xe,updateUBOMapping:de,uniformBlockBinding:Ee,texStorage2D:pe,texStorage3D:Ve,texSubImage2D:xe,texSubImage3D:Te,compressedTexSubImage2D:Ge,compressedTexSubImage3D:Ie,scissor:Q,viewport:$,reset:He}}function _K(e,t,r,i,n,s,a){let o=n.isWebGL2,l=n.maxTextures,c=n.maxCubemapSize,u=n.maxTextureSize,h=n.maxSamples,d=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,p=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),f=new WeakMap,m,g=new WeakMap,v=!1;try{v=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function y(k,O){return v?new OffscreenCanvas(k,O):b0("canvas")}function x(k,O,oe,be){let xe=1;if((k.width>be||k.height>be)&&(xe=be/Math.max(k.width,k.height)),xe<1||O===!0)if(typeof HTMLImageElement<"u"&&k instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&k instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&k instanceof ImageBitmap){let Te=O?w0:Math.floor,Ge=Te(xe*k.width),Ie=Te(xe*k.height);m===void 0&&(m=y(Ge,Ie));let pe=oe?y(Ge,Ie):m;return pe.width=Ge,pe.height=Ie,pe.getContext("2d").drawImage(k,0,0,Ge,Ie),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+k.width+"x"+k.height+") to ("+Ge+"x"+Ie+")."),pe}else return"data"in k&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+k.width+"x"+k.height+")."),k;return k}function w(k){return f2(k.width)&&f2(k.height)}function b(k){return o?!1:k.wrapS!==br||k.wrapT!==br||k.minFilter!==Xt&&k.minFilter!==vt}function _(k,O){return k.generateMipmaps&&O&&k.minFilter!==Xt&&k.minFilter!==vt}function A(k){e.generateMipmap(k)}function S(k,O,oe,be,xe=!1){if(o===!1)return O;if(k!==null){if(e[k]!==void 0)return e[k];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+k+"'")}let Te=O;return O===6403&&(oe===5126&&(Te=33326),oe===5131&&(Te=33325),oe===5121&&(Te=33321)),O===33319&&(oe===5126&&(Te=33328),oe===5131&&(Te=33327),oe===5121&&(Te=33323)),O===6408&&(oe===5126&&(Te=34836),oe===5131&&(Te=34842),oe===5121&&(Te=be===ut&&xe===!1?35907:32856),oe===32819&&(Te=32854),oe===32820&&(Te=32855)),(Te===33325||Te===33326||Te===33327||Te===33328||Te===34842||Te===34836)&&t.get("EXT_color_buffer_float"),Te}function C(k,O,oe){return _(k,oe)===!0||k.isFramebufferTexture&&k.minFilter!==Xt&&k.minFilter!==vt?Math.log2(Math.max(O.width,O.height))+1:k.mipmaps!==void 0&&k.mipmaps.length>0?k.mipmaps.length:k.isCompressedTexture&&Array.isArray(k.image)?O.mipmaps.length:1}function M(k){return k===Xt||k===WE||k===rx?9728:9729}function T(k){let O=k.target;O.removeEventListener("dispose",T),D(O),O.isVideoTexture&&f.delete(O)}function P(k){let O=k.target;O.removeEventListener("dispose",P),B(O)}function D(k){let O=i.get(k);if(O.__webglInit===void 0)return;let oe=k.source,be=g.get(oe);if(be){let xe=be[O.__cacheKey];xe.usedTimes--,xe.usedTimes===0&&I(k),Object.keys(be).length===0&&g.delete(oe)}i.remove(k)}function I(k){let O=i.get(k);e.deleteTexture(O.__webglTexture);let oe=k.source,be=g.get(oe);delete be[O.__cacheKey],a.memory.textures--}function B(k){let O=k.texture,oe=i.get(k),be=i.get(O);if(be.__webglTexture!==void 0&&(e.deleteTexture(be.__webglTexture),a.memory.textures--),k.depthTexture&&k.depthTexture.dispose(),k.isWebGLCubeRenderTarget)for(let xe=0;xe<6;xe++)e.deleteFramebuffer(oe.__webglFramebuffer[xe]),oe.__webglDepthbuffer&&e.deleteRenderbuffer(oe.__webglDepthbuffer[xe]);else{if(e.deleteFramebuffer(oe.__webglFramebuffer),oe.__webglDepthbuffer&&e.deleteRenderbuffer(oe.__webglDepthbuffer),oe.__webglMultisampledFramebuffer&&e.deleteFramebuffer(oe.__webglMultisampledFramebuffer),oe.__webglColorRenderbuffer)for(let xe=0;xe<oe.__webglColorRenderbuffer.length;xe++)oe.__webglColorRenderbuffer[xe]&&e.deleteRenderbuffer(oe.__webglColorRenderbuffer[xe]);oe.__webglDepthRenderbuffer&&e.deleteRenderbuffer(oe.__webglDepthRenderbuffer)}if(k.isWebGLMultipleRenderTargets)for(let xe=0,Te=O.length;xe<Te;xe++){let Ge=i.get(O[xe]);Ge.__webglTexture&&(e.deleteTexture(Ge.__webglTexture),a.memory.textures--),i.remove(O[xe])}i.remove(O),i.remove(k)}let X=0;function H(){X=0}function R(){let k=X;return k>=l&&console.warn("THREE.WebGLTextures: Trying to use "+k+" texture units while this GPU supports only "+l),X+=1,k}function q(k){let O=[];return O.push(k.wrapS),O.push(k.wrapT),O.push(k.wrapR||0),O.push(k.magFilter),O.push(k.minFilter),O.push(k.anisotropy),O.push(k.internalFormat),O.push(k.format),O.push(k.type),O.push(k.generateMipmaps),O.push(k.premultiplyAlpha),O.push(k.flipY),O.push(k.unpackAlignment),O.push(k.encoding),O.join()}function F(k,O){let oe=i.get(k);if(k.isVideoTexture&&je(k),k.isRenderTargetTexture===!1&&k.version>0&&oe.__version!==k.version){let be=k.image;if(be===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(be.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{J(oe,k,O);return}}r.bindTexture(3553,oe.__webglTexture,33984+O)}function N(k,O){let oe=i.get(k);if(k.version>0&&oe.__version!==k.version){J(oe,k,O);return}r.bindTexture(35866,oe.__webglTexture,33984+O)}function j(k,O){let oe=i.get(k);if(k.version>0&&oe.__version!==k.version){J(oe,k,O);return}r.bindTexture(32879,oe.__webglTexture,33984+O)}function K(k,O){let oe=i.get(k);if(k.version>0&&oe.__version!==k.version){ee(oe,k,O);return}r.bindTexture(34067,oe.__webglTexture,33984+O)}let U={[Za]:10497,[br]:33071,[u2]:33648},Y={[Xt]:9728,[WE]:9984,[rx]:9986,[vt]:9729,[tW]:9985,[Vu]:9987};function V(k,O,oe){if(oe?(e.texParameteri(k,10242,U[O.wrapS]),e.texParameteri(k,10243,U[O.wrapT]),(k===32879||k===35866)&&e.texParameteri(k,32882,U[O.wrapR]),e.texParameteri(k,10240,Y[O.magFilter]),e.texParameteri(k,10241,Y[O.minFilter])):(e.texParameteri(k,10242,33071),e.texParameteri(k,10243,33071),(k===32879||k===35866)&&e.texParameteri(k,32882,33071),(O.wrapS!==br||O.wrapT!==br)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(k,10240,M(O.magFilter)),e.texParameteri(k,10241,M(O.minFilter)),O.minFilter!==Xt&&O.minFilter!==vt&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),t.has("EXT_texture_filter_anisotropic")===!0){let be=t.get("EXT_texture_filter_anisotropic");if(O.magFilter===Xt||O.minFilter!==rx&&O.minFilter!==Vu||O.type===xn&&t.has("OES_texture_float_linear")===!1||o===!1&&O.type===Hu&&t.has("OES_texture_half_float_linear")===!1)return;(O.anisotropy>1||i.get(O).__currentAnisotropy)&&(e.texParameterf(k,be.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(O.anisotropy,n.getMaxAnisotropy())),i.get(O).__currentAnisotropy=O.anisotropy)}}function ie(k,O){let oe=!1;k.__webglInit===void 0&&(k.__webglInit=!0,O.addEventListener("dispose",T));let be=O.source,xe=g.get(be);xe===void 0&&(xe={},g.set(be,xe));let Te=q(O);if(Te!==k.__cacheKey){xe[Te]===void 0&&(xe[Te]={texture:e.createTexture(),usedTimes:0},a.memory.textures++,oe=!0),xe[Te].usedTimes++;let Ge=xe[k.__cacheKey];Ge!==void 0&&(xe[k.__cacheKey].usedTimes--,Ge.usedTimes===0&&I(O)),k.__cacheKey=Te,k.__webglTexture=xe[Te].texture}return oe}function J(k,O,oe){let be=3553;(O.isDataArrayTexture||O.isCompressedArrayTexture)&&(be=35866),O.isData3DTexture&&(be=32879);let xe=ie(k,O),Te=O.source;r.bindTexture(be,k.__webglTexture,33984+oe);let Ge=i.get(Te);if(Te.version!==Ge.__version||xe===!0){r.activeTexture(33984+oe),e.pixelStorei(37440,O.flipY),e.pixelStorei(37441,O.premultiplyAlpha),e.pixelStorei(3317,O.unpackAlignment),e.pixelStorei(37443,0);let Ie=b(O)&&w(O.image)===!1,pe=x(O.image,Ie,!1,u);pe=We(O,pe);let Ve=w(pe)||o,qe=s.convert(O.format,O.encoding),Xe=s.convert(O.type),Q=S(O.internalFormat,qe,Xe,O.encoding,O.isVideoTexture);V(be,O,Ve);let $,de=O.mipmaps,Ee=o&&O.isVideoTexture!==!0,He=Ge.__version===void 0||xe===!0,G=C(O,pe,Ve);if(O.isDepthTexture)Q=6402,o?O.type===xn?Q=36012:O.type===Yo?Q=33190:O.type===yc?Q=35056:Q=33189:O.type===xn&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),O.format===xc&&Q===6402&&O.type!==aR&&O.type!==Yo&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),O.type=Yo,Xe=s.convert(O.type)),O.format===Oc&&Q===6402&&(Q=34041,O.type!==yc&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),O.type=yc,Xe=s.convert(O.type))),He&&(Ee?r.texStorage2D(3553,1,Q,pe.width,pe.height):r.texImage2D(3553,0,Q,pe.width,pe.height,0,qe,Xe,null));else if(O.isDataTexture)if(de.length>0&&Ve){Ee&&He&&r.texStorage2D(3553,G,Q,de[0].width,de[0].height);for(let te=0,ae=de.length;te<ae;te++)$=de[te],Ee?r.texSubImage2D(3553,te,0,0,$.width,$.height,qe,Xe,$.data):r.texImage2D(3553,te,Q,$.width,$.height,0,qe,Xe,$.data);O.generateMipmaps=!1}else Ee?(He&&r.texStorage2D(3553,G,Q,pe.width,pe.height),r.texSubImage2D(3553,0,0,0,pe.width,pe.height,qe,Xe,pe.data)):r.texImage2D(3553,0,Q,pe.width,pe.height,0,qe,Xe,pe.data);else if(O.isCompressedTexture)if(O.isCompressedArrayTexture){Ee&&He&&r.texStorage3D(35866,G,Q,de[0].width,de[0].height,pe.depth);for(let te=0,ae=de.length;te<ae;te++)$=de[te],O.format!==Wn?qe!==null?Ee?r.compressedTexSubImage3D(35866,te,0,0,0,$.width,$.height,pe.depth,qe,$.data,0,0):r.compressedTexImage3D(35866,te,Q,$.width,$.height,pe.depth,0,$.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ee?r.texSubImage3D(35866,te,0,0,0,$.width,$.height,pe.depth,qe,Xe,$.data):r.texImage3D(35866,te,Q,$.width,$.height,pe.depth,0,qe,Xe,$.data)}else{Ee&&He&&r.texStorage2D(3553,G,Q,de[0].width,de[0].height);for(let te=0,ae=de.length;te<ae;te++)$=de[te],O.format!==Wn?qe!==null?Ee?r.compressedTexSubImage2D(3553,te,0,0,$.width,$.height,qe,$.data):r.compressedTexImage2D(3553,te,Q,$.width,$.height,0,$.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ee?r.texSubImage2D(3553,te,0,0,$.width,$.height,qe,Xe,$.data):r.texImage2D(3553,te,Q,$.width,$.height,0,qe,Xe,$.data)}else if(O.isDataArrayTexture)Ee?(He&&r.texStorage3D(35866,G,Q,pe.width,pe.height,pe.depth),r.texSubImage3D(35866,0,0,0,0,pe.width,pe.height,pe.depth,qe,Xe,pe.data)):r.texImage3D(35866,0,Q,pe.width,pe.height,pe.depth,0,qe,Xe,pe.data);else if(O.isData3DTexture)Ee?(He&&r.texStorage3D(32879,G,Q,pe.width,pe.height,pe.depth),r.texSubImage3D(32879,0,0,0,0,pe.width,pe.height,pe.depth,qe,Xe,pe.data)):r.texImage3D(32879,0,Q,pe.width,pe.height,pe.depth,0,qe,Xe,pe.data);else if(O.isFramebufferTexture){if(He)if(Ee)r.texStorage2D(3553,G,Q,pe.width,pe.height);else{let te=pe.width,ae=pe.height;for(let me=0;me<G;me++)r.texImage2D(3553,me,Q,te,ae,0,qe,Xe,null),te>>=1,ae>>=1}}else if(de.length>0&&Ve){Ee&&He&&r.texStorage2D(3553,G,Q,de[0].width,de[0].height);for(let te=0,ae=de.length;te<ae;te++)$=de[te],Ee?r.texSubImage2D(3553,te,0,0,qe,Xe,$):r.texImage2D(3553,te,Q,qe,Xe,$);O.generateMipmaps=!1}else Ee?(He&&r.texStorage2D(3553,G,Q,pe.width,pe.height),r.texSubImage2D(3553,0,0,0,qe,Xe,pe)):r.texImage2D(3553,0,Q,qe,Xe,pe);_(O,Ve)&&A(be),Ge.__version=Te.version,O.onUpdate&&O.onUpdate(O)}k.__version=O.version}function ee(k,O,oe){if(O.image.length!==6)return;let be=ie(k,O),xe=O.source;r.bindTexture(34067,k.__webglTexture,33984+oe);let Te=i.get(xe);if(xe.version!==Te.__version||be===!0){r.activeTexture(33984+oe),e.pixelStorei(37440,O.flipY),e.pixelStorei(37441,O.premultiplyAlpha),e.pixelStorei(3317,O.unpackAlignment),e.pixelStorei(37443,0);let Ge=O.isCompressedTexture||O.image[0].isCompressedTexture,Ie=O.image[0]&&O.image[0].isDataTexture,pe=[];for(let te=0;te<6;te++)!Ge&&!Ie?pe[te]=x(O.image[te],!1,!0,c):pe[te]=Ie?O.image[te].image:O.image[te],pe[te]=We(O,pe[te]);let Ve=pe[0],qe=w(Ve)||o,Xe=s.convert(O.format,O.encoding),Q=s.convert(O.type),$=S(O.internalFormat,Xe,Q,O.encoding),de=o&&O.isVideoTexture!==!0,Ee=Te.__version===void 0||be===!0,He=C(O,Ve,qe);V(34067,O,qe);let G;if(Ge){de&&Ee&&r.texStorage2D(34067,He,$,Ve.width,Ve.height);for(let te=0;te<6;te++){G=pe[te].mipmaps;for(let ae=0;ae<G.length;ae++){let me=G[ae];O.format!==Wn?Xe!==null?de?r.compressedTexSubImage2D(34069+te,ae,0,0,me.width,me.height,Xe,me.data):r.compressedTexImage2D(34069+te,ae,$,me.width,me.height,0,me.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):de?r.texSubImage2D(34069+te,ae,0,0,me.width,me.height,Xe,Q,me.data):r.texImage2D(34069+te,ae,$,me.width,me.height,0,Xe,Q,me.data)}}}else{G=O.mipmaps,de&&Ee&&(G.length>0&&He++,r.texStorage2D(34067,He,$,pe[0].width,pe[0].height));for(let te=0;te<6;te++)if(Ie){de?r.texSubImage2D(34069+te,0,0,0,pe[te].width,pe[te].height,Xe,Q,pe[te].data):r.texImage2D(34069+te,0,$,pe[te].width,pe[te].height,0,Xe,Q,pe[te].data);for(let ae=0;ae<G.length;ae++){let me=G[ae].image[te].image;de?r.texSubImage2D(34069+te,ae+1,0,0,me.width,me.height,Xe,Q,me.data):r.texImage2D(34069+te,ae+1,$,me.width,me.height,0,Xe,Q,me.data)}}else{de?r.texSubImage2D(34069+te,0,0,0,Xe,Q,pe[te]):r.texImage2D(34069+te,0,$,Xe,Q,pe[te]);for(let ae=0;ae<G.length;ae++){let me=G[ae];de?r.texSubImage2D(34069+te,ae+1,0,0,Xe,Q,me.image[te]):r.texImage2D(34069+te,ae+1,$,Xe,Q,me.image[te])}}}_(O,qe)&&A(34067),Te.__version=xe.version,O.onUpdate&&O.onUpdate(O)}k.__version=O.version}function se(k,O,oe,be,xe){let Te=s.convert(oe.format,oe.encoding),Ge=s.convert(oe.type),Ie=S(oe.internalFormat,Te,Ge,oe.encoding);i.get(O).__hasExternalTextures||(xe===32879||xe===35866?r.texImage3D(xe,0,Ie,O.width,O.height,O.depth,0,Te,Ge,null):r.texImage2D(xe,0,Ie,O.width,O.height,0,Te,Ge,null)),r.bindFramebuffer(36160,k),Ae(O)?d.framebufferTexture2DMultisampleEXT(36160,be,xe,i.get(oe).__webglTexture,0,Ce(O)):(xe===3553||xe>=34069&&xe<=34074)&&e.framebufferTexture2D(36160,be,xe,i.get(oe).__webglTexture,0),r.bindFramebuffer(36160,null)}function ce(k,O,oe){if(e.bindRenderbuffer(36161,k),O.depthBuffer&&!O.stencilBuffer){let be=33189;if(oe||Ae(O)){let xe=O.depthTexture;xe&&xe.isDepthTexture&&(xe.type===xn?be=36012:xe.type===Yo&&(be=33190));let Te=Ce(O);Ae(O)?d.renderbufferStorageMultisampleEXT(36161,Te,be,O.width,O.height):e.renderbufferStorageMultisample(36161,Te,be,O.width,O.height)}else e.renderbufferStorage(36161,be,O.width,O.height);e.framebufferRenderbuffer(36160,36096,36161,k)}else if(O.depthBuffer&&O.stencilBuffer){let be=Ce(O);oe&&Ae(O)===!1?e.renderbufferStorageMultisample(36161,be,35056,O.width,O.height):Ae(O)?d.renderbufferStorageMultisampleEXT(36161,be,35056,O.width,O.height):e.renderbufferStorage(36161,34041,O.width,O.height),e.framebufferRenderbuffer(36160,33306,36161,k)}else{let be=O.isWebGLMultipleRenderTargets===!0?O.texture:[O.texture];for(let xe=0;xe<be.length;xe++){let Te=be[xe],Ge=s.convert(Te.format,Te.encoding),Ie=s.convert(Te.type),pe=S(Te.internalFormat,Ge,Ie,Te.encoding),Ve=Ce(O);oe&&Ae(O)===!1?e.renderbufferStorageMultisample(36161,Ve,pe,O.width,O.height):Ae(O)?d.renderbufferStorageMultisampleEXT(36161,Ve,pe,O.width,O.height):e.renderbufferStorage(36161,pe,O.width,O.height)}}e.bindRenderbuffer(36161,null)}function ue(k,O){if(O&&O.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(r.bindFramebuffer(36160,k),!(O.depthTexture&&O.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(O.depthTexture).__webglTexture||O.depthTexture.image.width!==O.width||O.depthTexture.image.height!==O.height)&&(O.depthTexture.image.width=O.width,O.depthTexture.image.height=O.height,O.depthTexture.needsUpdate=!0),F(O.depthTexture,0);let oe=i.get(O.depthTexture).__webglTexture,be=Ce(O);if(O.depthTexture.format===xc)Ae(O)?d.framebufferTexture2DMultisampleEXT(36160,36096,3553,oe,0,be):e.framebufferTexture2D(36160,36096,3553,oe,0);else if(O.depthTexture.format===Oc)Ae(O)?d.framebufferTexture2DMultisampleEXT(36160,33306,3553,oe,0,be):e.framebufferTexture2D(36160,33306,3553,oe,0);else throw new Error("Unknown depthTexture format")}function ye(k){let O=i.get(k),oe=k.isWebGLCubeRenderTarget===!0;if(k.depthTexture&&!O.__autoAllocateDepthBuffer){if(oe)throw new Error("target.depthTexture not supported in Cube render targets");ue(O.__webglFramebuffer,k)}else if(oe){O.__webglDepthbuffer=[];for(let be=0;be<6;be++)r.bindFramebuffer(36160,O.__webglFramebuffer[be]),O.__webglDepthbuffer[be]=e.createRenderbuffer(),ce(O.__webglDepthbuffer[be],k,!1)}else r.bindFramebuffer(36160,O.__webglFramebuffer),O.__webglDepthbuffer=e.createRenderbuffer(),ce(O.__webglDepthbuffer,k,!1);r.bindFramebuffer(36160,null)}function Re(k,O,oe){let be=i.get(k);O!==void 0&&se(be.__webglFramebuffer,k,k.texture,36064,3553),oe!==void 0&&ye(k)}function Se(k){let O=k.texture,oe=i.get(k),be=i.get(O);k.addEventListener("dispose",P),k.isWebGLMultipleRenderTargets!==!0&&(be.__webglTexture===void 0&&(be.__webglTexture=e.createTexture()),be.__version=O.version,a.memory.textures++);let xe=k.isWebGLCubeRenderTarget===!0,Te=k.isWebGLMultipleRenderTargets===!0,Ge=w(k)||o;if(xe){oe.__webglFramebuffer=[];for(let Ie=0;Ie<6;Ie++)oe.__webglFramebuffer[Ie]=e.createFramebuffer()}else{if(oe.__webglFramebuffer=e.createFramebuffer(),Te)if(n.drawBuffers){let Ie=k.texture;for(let pe=0,Ve=Ie.length;pe<Ve;pe++){let qe=i.get(Ie[pe]);qe.__webglTexture===void 0&&(qe.__webglTexture=e.createTexture(),a.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(o&&k.samples>0&&Ae(k)===!1){let Ie=Te?O:[O];oe.__webglMultisampledFramebuffer=e.createFramebuffer(),oe.__webglColorRenderbuffer=[],r.bindFramebuffer(36160,oe.__webglMultisampledFramebuffer);for(let pe=0;pe<Ie.length;pe++){let Ve=Ie[pe];oe.__webglColorRenderbuffer[pe]=e.createRenderbuffer(),e.bindRenderbuffer(36161,oe.__webglColorRenderbuffer[pe]);let qe=s.convert(Ve.format,Ve.encoding),Xe=s.convert(Ve.type),Q=S(Ve.internalFormat,qe,Xe,Ve.encoding,k.isXRRenderTarget===!0),$=Ce(k);e.renderbufferStorageMultisample(36161,$,Q,k.width,k.height),e.framebufferRenderbuffer(36160,36064+pe,36161,oe.__webglColorRenderbuffer[pe])}e.bindRenderbuffer(36161,null),k.depthBuffer&&(oe.__webglDepthRenderbuffer=e.createRenderbuffer(),ce(oe.__webglDepthRenderbuffer,k,!0)),r.bindFramebuffer(36160,null)}}if(xe){r.bindTexture(34067,be.__webglTexture),V(34067,O,Ge);for(let Ie=0;Ie<6;Ie++)se(oe.__webglFramebuffer[Ie],k,O,36064,34069+Ie);_(O,Ge)&&A(34067),r.unbindTexture()}else if(Te){let Ie=k.texture;for(let pe=0,Ve=Ie.length;pe<Ve;pe++){let qe=Ie[pe],Xe=i.get(qe);r.bindTexture(3553,Xe.__webglTexture),V(3553,qe,Ge),se(oe.__webglFramebuffer,k,qe,36064+pe,3553),_(qe,Ge)&&A(3553)}r.unbindTexture()}else{let Ie=3553;(k.isWebGL3DRenderTarget||k.isWebGLArrayRenderTarget)&&(o?Ie=k.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),r.bindTexture(Ie,be.__webglTexture),V(Ie,O,Ge),se(oe.__webglFramebuffer,k,O,36064,Ie),_(O,Ge)&&A(Ie),r.unbindTexture()}k.depthBuffer&&ye(k)}function ke(k){let O=w(k)||o,oe=k.isWebGLMultipleRenderTargets===!0?k.texture:[k.texture];for(let be=0,xe=oe.length;be<xe;be++){let Te=oe[be];if(_(Te,O)){let Ge=k.isWebGLCubeRenderTarget?34067:3553,Ie=i.get(Te).__webglTexture;r.bindTexture(Ge,Ie),A(Ge),r.unbindTexture()}}}function Oe(k){if(o&&k.samples>0&&Ae(k)===!1){let O=k.isWebGLMultipleRenderTargets?k.texture:[k.texture],oe=k.width,be=k.height,xe=16384,Te=[],Ge=k.stencilBuffer?33306:36096,Ie=i.get(k),pe=k.isWebGLMultipleRenderTargets===!0;if(pe)for(let Ve=0;Ve<O.length;Ve++)r.bindFramebuffer(36160,Ie.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064+Ve,36161,null),r.bindFramebuffer(36160,Ie.__webglFramebuffer),e.framebufferTexture2D(36009,36064+Ve,3553,null,0);r.bindFramebuffer(36008,Ie.__webglMultisampledFramebuffer),r.bindFramebuffer(36009,Ie.__webglFramebuffer);for(let Ve=0;Ve<O.length;Ve++){Te.push(36064+Ve),k.depthBuffer&&Te.push(Ge);let qe=Ie.__ignoreDepthValues!==void 0?Ie.__ignoreDepthValues:!1;if(qe===!1&&(k.depthBuffer&&(xe|=256),k.stencilBuffer&&(xe|=1024)),pe&&e.framebufferRenderbuffer(36008,36064,36161,Ie.__webglColorRenderbuffer[Ve]),qe===!0&&(e.invalidateFramebuffer(36008,[Ge]),e.invalidateFramebuffer(36009,[Ge])),pe){let Xe=i.get(O[Ve]).__webglTexture;e.framebufferTexture2D(36009,36064,3553,Xe,0)}e.blitFramebuffer(0,0,oe,be,0,0,oe,be,xe,9728),p&&e.invalidateFramebuffer(36008,Te)}if(r.bindFramebuffer(36008,null),r.bindFramebuffer(36009,null),pe)for(let Ve=0;Ve<O.length;Ve++){r.bindFramebuffer(36160,Ie.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064+Ve,36161,Ie.__webglColorRenderbuffer[Ve]);let qe=i.get(O[Ve]).__webglTexture;r.bindFramebuffer(36160,Ie.__webglFramebuffer),e.framebufferTexture2D(36009,36064+Ve,3553,qe,0)}r.bindFramebuffer(36009,Ie.__webglMultisampledFramebuffer)}}function Ce(k){return Math.min(h,k.samples)}function Ae(k){let O=i.get(k);return o&&k.samples>0&&t.has("WEBGL_multisampled_render_to_texture")===!0&&O.__useRenderToTexture!==!1}function je(k){let O=a.render.frame;f.get(k)!==O&&(f.set(k,O),k.update())}function We(k,O){let oe=k.encoding,be=k.format,xe=k.type;return k.isCompressedTexture===!0||k.isVideoTexture===!0||k.format===p2||oe!==fa&&(oe===ut?o===!1?t.has("EXT_sRGB")===!0&&be===Wn?(k.format=p2,k.minFilter=vt,k.generateMipmaps=!1):O=fR.sRGBToLinear(O):(be!==Wn||xe!==Si)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",oe)),O}this.allocateTextureUnit=R,this.resetTextureUnits=H,this.setTexture2D=F,this.setTexture2DArray=N,this.setTexture3D=j,this.setTextureCube=K,this.rebindTextures=Re,this.setupRenderTarget=Se,this.updateRenderTargetMipmap=ke,this.updateMultisampleRenderTarget=Oe,this.setupDepthRenderbuffer=ye,this.setupFrameBufferTexture=se,this.useMultisampledRTT=Ae}function SK(e,t,r){let i=r.isWebGL2;function n(s,a=null){let o;if(s===Si)return 5121;if(s===sW)return 32819;if(s===aW)return 32820;if(s===rW)return 5120;if(s===iW)return 5122;if(s===aR)return 5123;if(s===nW)return 5124;if(s===Yo)return 5125;if(s===xn)return 5126;if(s===Hu)return i?5131:(o=t.get("OES_texture_half_float"),o!==null?o.HALF_FLOAT_OES:null);if(s===oW)return 6406;if(s===Wn)return 6408;if(s===lW)return 6409;if(s===cW)return 6410;if(s===xc)return 6402;if(s===Oc)return 34041;if(s===p2)return o=t.get("EXT_sRGB"),o!==null?o.SRGB_ALPHA_EXT:null;if(s===hW)return 6403;if(s===uW)return 36244;if(s===oR)return 33319;if(s===dW)return 33320;if(s===pW)return 36249;if(s===ix||s===nx||s===sx||s===ax)if(a===ut)if(o=t.get("WEBGL_compressed_texture_s3tc_srgb"),o!==null){if(s===ix)return o.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===nx)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===sx)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===ax)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(o=t.get("WEBGL_compressed_texture_s3tc"),o!==null){if(s===ix)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===nx)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===sx)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===ax)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===qE||s===XE||s===YE||s===QE)if(o=t.get("WEBGL_compressed_texture_pvrtc"),o!==null){if(s===qE)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===XE)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===YE)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===QE)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===fW)return o=t.get("WEBGL_compressed_texture_etc1"),o!==null?o.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===KE||s===ZE)if(o=t.get("WEBGL_compressed_texture_etc"),o!==null){if(s===KE)return a===ut?o.COMPRESSED_SRGB8_ETC2:o.COMPRESSED_RGB8_ETC2;if(s===ZE)return a===ut?o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:o.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===$E||s===JE||s===eT||s===tT||s===rT||s===iT||s===nT||s===sT||s===aT||s===oT||s===lT||s===cT||s===hT||s===uT)if(o=t.get("WEBGL_compressed_texture_astc"),o!==null){if(s===$E)return a===ut?o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:o.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===JE)return a===ut?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:o.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===eT)return a===ut?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:o.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===tT)return a===ut?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:o.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===rT)return a===ut?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:o.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===iT)return a===ut?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:o.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===nT)return a===ut?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:o.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===sT)return a===ut?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:o.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===aT)return a===ut?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:o.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===oT)return a===ut?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:o.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===lT)return a===ut?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:o.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===cT)return a===ut?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:o.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===hT)return a===ut?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:o.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===uT)return a===ut?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:o.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===ox)if(o=t.get("EXT_texture_compression_bptc"),o!==null){if(s===ox)return a===ut?o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:o.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(s===mW||s===dT||s===pT||s===fT)if(o=t.get("EXT_texture_compression_rgtc"),o!==null){if(s===ox)return o.COMPRESSED_RED_RGTC1_EXT;if(s===dT)return o.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===pT)return o.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===fT)return o.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===yc?i?34042:(o=t.get("WEBGL_depth_texture"),o!==null?o.UNSIGNED_INT_24_8_WEBGL:null):e[s]!==void 0?e[s]:null}return{convert:n}}var AK=class extends vi{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}},ru=class extends Vt{constructor(){super(),this.isGroup=!0,this.type="Group"}},CK={type:"move"},Ox=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new ru,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new ru,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new E,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new E),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new ru,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new E,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new E),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){let t=this._hand;if(t)for(let r of e.hand.values())this._getHandJoint(t,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,r){let i=null,n=null,s=null,a=this._targetRay,o=this._grip,l=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(l&&e.hand){s=!0;for(let f of e.hand.values()){let m=t.getJointPose(f,r),g=this._getHandJoint(l,f);m!==null&&(g.matrix.fromArray(m.transform.matrix),g.matrix.decompose(g.position,g.rotation,g.scale),g.jointRadius=m.radius),g.visible=m!==null}let c=l.joints["index-finger-tip"],u=l.joints["thumb-tip"],h=c.position.distanceTo(u.position),d=.02,p=.005;l.inputState.pinching&&h>d+p?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&h<=d-p&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else o!==null&&e.gripSpace&&(n=t.getPose(e.gripSpace,r),n!==null&&(o.matrix.fromArray(n.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),n.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(n.linearVelocity)):o.hasLinearVelocity=!1,n.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(n.angularVelocity)):o.hasAngularVelocity=!1));a!==null&&(i=t.getPose(e.targetRaySpace,r),i===null&&n!==null&&(i=n),i!==null&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),i.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(i.linearVelocity)):a.hasLinearVelocity=!1,i.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(i.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(CK)))}return a!==null&&(a.visible=i!==null),o!==null&&(o.visible=n!==null),l!==null&&(l.visible=s!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){let r=new ru;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[t.jointName]=r,e.add(r)}return e.joints[t.jointName]}},Wu=class extends jr{constructor(e,t,r,i,n,s,a,o,l,c){if(c=c!==void 0?c:xc,c!==xc&&c!==Oc)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");r===void 0&&c===xc&&(r=Yo),r===void 0&&c===Oc&&(r=yc),super(null,i,n,s,a,o,c,r,l),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=a!==void 0?a:Xt,this.minFilter=o!==void 0?o:Xt,this.flipY=!1,this.generateMipmaps=!1}},MK=class extends ui{constructor(e,t){super();let r=this,i=null,n=1,s=null,a="local-floor",o=1,l=null,c=null,u=null,h=null,d=null,p=null,f=t.getContextAttributes(),m=null,g=null,v=[],y=[],x=new Set,w=new Map,b=new vi;b.layers.enable(1),b.viewport=new dt;let _=new vi;_.layers.enable(2),_.viewport=new dt;let A=[b,_],S=new AK;S.layers.enable(1),S.layers.enable(2);let C=null,M=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(N){let j=v[N];return j===void 0&&(j=new Ox,v[N]=j),j.getTargetRaySpace()},this.getControllerGrip=function(N){let j=v[N];return j===void 0&&(j=new Ox,v[N]=j),j.getGripSpace()},this.getHand=function(N){let j=v[N];return j===void 0&&(j=new Ox,v[N]=j),j.getHandSpace()};function T(N){let j=y.indexOf(N.inputSource);if(j===-1)return;let K=v[j];K!==void 0&&K.dispatchEvent({type:N.type,data:N.inputSource})}function P(){i.removeEventListener("select",T),i.removeEventListener("selectstart",T),i.removeEventListener("selectend",T),i.removeEventListener("squeeze",T),i.removeEventListener("squeezestart",T),i.removeEventListener("squeezeend",T),i.removeEventListener("end",P),i.removeEventListener("inputsourceschange",D);for(let N=0;N<v.length;N++){let j=y[N];j!==null&&(y[N]=null,v[N].disconnect(j))}C=null,M=null,e.setRenderTarget(m),d=null,h=null,u=null,i=null,g=null,F.stop(),r.isPresenting=!1,r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(N){n=N,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(N){a=N,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||s},this.setReferenceSpace=function(N){l=N},this.getBaseLayer=function(){return h!==null?h:d},this.getBinding=function(){return u},this.getFrame=function(){return p},this.getSession=function(){return i},this.setSession=async function(N){if(i=N,i!==null){if(m=e.getRenderTarget(),i.addEventListener("select",T),i.addEventListener("selectstart",T),i.addEventListener("selectend",T),i.addEventListener("squeeze",T),i.addEventListener("squeezestart",T),i.addEventListener("squeezeend",T),i.addEventListener("end",P),i.addEventListener("inputsourceschange",D),f.xrCompatible!==!0&&await t.makeXRCompatible(),i.renderState.layers===void 0||e.capabilities.isWebGL2===!1){let j={antialias:i.renderState.layers===void 0?f.antialias:!0,alpha:f.alpha,depth:f.depth,stencil:f.stencil,framebufferScaleFactor:n};d=new XRWebGLLayer(i,t,j),i.updateRenderState({baseLayer:d}),g=new Ut(d.framebufferWidth,d.framebufferHeight,{format:Wn,type:Si,encoding:e.outputEncoding,stencilBuffer:f.stencil})}else{let j=null,K=null,U=null;f.depth&&(U=f.stencil?35056:33190,j=f.stencil?Oc:xc,K=f.stencil?yc:Yo);let Y={colorFormat:32856,depthFormat:U,scaleFactor:n};u=new XRWebGLBinding(i,t),h=u.createProjectionLayer(Y),i.updateRenderState({layers:[h]}),g=new Ut(h.textureWidth,h.textureHeight,{format:Wn,type:Si,depthTexture:new Wu(h.textureWidth,h.textureHeight,K,void 0,void 0,void 0,void 0,void 0,void 0,j),stencilBuffer:f.stencil,encoding:e.outputEncoding,samples:f.antialias?4:0});let V=e.properties.get(g);V.__ignoreDepthValues=h.ignoreDepthValues}g.isXRRenderTarget=!0,this.setFoveation(o),l=null,s=await i.requestReferenceSpace(a),F.setContext(i),F.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}};function D(N){for(let j=0;j<N.removed.length;j++){let K=N.removed[j],U=y.indexOf(K);U>=0&&(y[U]=null,v[U].disconnect(K))}for(let j=0;j<N.added.length;j++){let K=N.added[j],U=y.indexOf(K);if(U===-1){for(let V=0;V<v.length;V++)if(V>=y.length){y.push(K),U=V;break}else if(y[V]===null){y[V]=K,U=V;break}if(U===-1)break}let Y=v[U];Y&&Y.connect(K)}}let I=new E,B=new E;function X(N,j,K){I.setFromMatrixPosition(j.matrixWorld),B.setFromMatrixPosition(K.matrixWorld);let U=I.distanceTo(B),Y=j.projectionMatrix.elements,V=K.projectionMatrix.elements,ie=Y[14]/(Y[10]-1),J=Y[14]/(Y[10]+1),ee=(Y[9]+1)/Y[5],se=(Y[9]-1)/Y[5],ce=(Y[8]-1)/Y[0],ue=(V[8]+1)/V[0],ye=ie*ce,Re=ie*ue,Se=U/(-ce+ue),ke=Se*-ce;j.matrixWorld.decompose(N.position,N.quaternion,N.scale),N.translateX(ke),N.translateZ(Se),N.matrixWorld.compose(N.position,N.quaternion,N.scale),N.matrixWorldInverse.copy(N.matrixWorld).invert();let Oe=ie+Se,Ce=J+Se,Ae=ye-ke,je=Re+(U-ke),We=ee*J/Ce*Oe,k=se*J/Ce*Oe;N.projectionMatrix.makePerspective(Ae,je,We,k,Oe,Ce)}function H(N,j){j===null?N.matrixWorld.copy(N.matrix):N.matrixWorld.multiplyMatrices(j.matrixWorld,N.matrix),N.matrixWorldInverse.copy(N.matrixWorld).invert()}this.updateCamera=function(N){if(i===null)return;S.near=_.near=b.near=N.near,S.far=_.far=b.far=N.far,(C!==S.near||M!==S.far)&&(i.updateRenderState({depthNear:S.near,depthFar:S.far}),C=S.near,M=S.far);let j=N.parent,K=S.cameras;H(S,j);for(let Y=0;Y<K.length;Y++)H(K[Y],j);S.matrixWorld.decompose(S.position,S.quaternion,S.scale),N.matrix.copy(S.matrix),N.matrix.decompose(N.position,N.quaternion,N.scale);let U=N.children;for(let Y=0,V=U.length;Y<V;Y++)U[Y].updateMatrixWorld(!0);K.length===2?X(S,b,_):S.projectionMatrix.copy(b.projectionMatrix)},this.getCamera=function(){return S},this.getFoveation=function(){if(!(h===null&&d===null))return o},this.setFoveation=function(N){o=N,h!==null&&(h.fixedFoveation=N),d!==null&&d.fixedFoveation!==void 0&&(d.fixedFoveation=N)},this.getPlanes=function(){return x};let R=null;function q(N,j){if(c=j.getViewerPose(l||s),p=j,c!==null){let K=c.views;d!==null&&(e.setRenderTargetFramebuffer(g,d.framebuffer),e.setRenderTarget(g));let U=!1;K.length!==S.cameras.length&&(S.cameras.length=0,U=!0);for(let Y=0;Y<K.length;Y++){let V=K[Y],ie=null;if(d!==null)ie=d.getViewport(V);else{let ee=u.getViewSubImage(h,V);ie=ee.viewport,Y===0&&(e.setRenderTargetTextures(g,ee.colorTexture,h.ignoreDepthValues?void 0:ee.depthStencilTexture),e.setRenderTarget(g))}let J=A[Y];J===void 0&&(J=new vi,J.layers.enable(Y),J.viewport=new dt,A[Y]=J),J.matrix.fromArray(V.transform.matrix),J.projectionMatrix.fromArray(V.projectionMatrix),J.viewport.set(ie.x,ie.y,ie.width,ie.height),Y===0&&S.matrix.copy(J.matrix),U===!0&&S.cameras.push(J)}}for(let K=0;K<v.length;K++){let U=y[K],Y=v[K];U!==null&&Y!==void 0&&Y.update(U,j,l||s)}if(R&&R(N,j),j.detectedPlanes){r.dispatchEvent({type:"planesdetected",data:j.detectedPlanes});let K=null;for(let U of x)j.detectedPlanes.has(U)||(K===null&&(K=[]),K.push(U));if(K!==null)for(let U of K)x.delete(U),w.delete(U),r.dispatchEvent({type:"planeremoved",data:U});for(let U of j.detectedPlanes)if(!x.has(U))x.add(U),w.set(U,j.lastChangedTime),r.dispatchEvent({type:"planeadded",data:U});else{let Y=w.get(U);U.lastChangedTime>Y&&(w.set(U,U.lastChangedTime),r.dispatchEvent({type:"planechanged",data:U}))}}p=null}let F=new xR;F.setAnimationLoop(q),this.setAnimationLoop=function(N){R=N},this.dispose=function(){}}};function EK(e,t){function r(m,g){g.color.getRGB(m.fogColor.value,yR(e)),g.isFog?(m.fogNear.value=g.near,m.fogFar.value=g.far):g.isFogExp2&&(m.fogDensity.value=g.density)}function i(m,g,v,y,x){g.isMeshBasicMaterial||g.isMeshLambertMaterial?n(m,g):g.isMeshToonMaterial?(n(m,g),u(m,g)):g.isMeshPhongMaterial?(n(m,g),c(m,g)):g.isMeshStandardMaterial?(n(m,g),h(m,g),g.isMeshPhysicalMaterial&&d(m,g,x)):g.isMeshMatcapMaterial?(n(m,g),p(m,g)):g.isMeshDepthMaterial?n(m,g):g.isMeshDistanceMaterial?(n(m,g),f(m,g)):g.isMeshNormalMaterial?n(m,g):g.isLineBasicMaterial?(s(m,g),g.isLineDashedMaterial&&a(m,g)):g.isPointsMaterial?o(m,g,v,y):g.isSpriteMaterial?l(m,g):g.isShadowMaterial?(m.color.value.copy(g.color),m.opacity.value=g.opacity):g.isShaderMaterial&&(g.uniformsNeedUpdate=!1)}function n(m,g){m.opacity.value=g.opacity,g.color&&m.diffuse.value.copy(g.color),g.emissive&&m.emissive.value.copy(g.emissive).multiplyScalar(g.emissiveIntensity),g.map&&(m.map.value=g.map),g.alphaMap&&(m.alphaMap.value=g.alphaMap),g.bumpMap&&(m.bumpMap.value=g.bumpMap,m.bumpScale.value=g.bumpScale,g.side===$r&&(m.bumpScale.value*=-1)),g.displacementMap&&(m.displacementMap.value=g.displacementMap,m.displacementScale.value=g.displacementScale,m.displacementBias.value=g.displacementBias),g.emissiveMap&&(m.emissiveMap.value=g.emissiveMap),g.normalMap&&(m.normalMap.value=g.normalMap,m.normalScale.value.copy(g.normalScale),g.side===$r&&m.normalScale.value.negate()),g.specularMap&&(m.specularMap.value=g.specularMap),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest);let v=t.get(g).envMap;if(v&&(m.envMap.value=v,m.flipEnvMap.value=v.isCubeTexture&&v.isRenderTargetTexture===!1?-1:1,m.reflectivity.value=g.reflectivity,m.ior.value=g.ior,m.refractionRatio.value=g.refractionRatio),g.lightMap){m.lightMap.value=g.lightMap;let w=e.physicallyCorrectLights!==!0?Math.PI:1;m.lightMapIntensity.value=g.lightMapIntensity*w}g.aoMap&&(m.aoMap.value=g.aoMap,m.aoMapIntensity.value=g.aoMapIntensity);let y;g.map?y=g.map:g.specularMap?y=g.specularMap:g.displacementMap?y=g.displacementMap:g.normalMap?y=g.normalMap:g.bumpMap?y=g.bumpMap:g.roughnessMap?y=g.roughnessMap:g.metalnessMap?y=g.metalnessMap:g.alphaMap?y=g.alphaMap:g.emissiveMap?y=g.emissiveMap:g.clearcoatMap?y=g.clearcoatMap:g.clearcoatNormalMap?y=g.clearcoatNormalMap:g.clearcoatRoughnessMap?y=g.clearcoatRoughnessMap:g.iridescenceMap?y=g.iridescenceMap:g.iridescenceThicknessMap?y=g.iridescenceThicknessMap:g.specularIntensityMap?y=g.specularIntensityMap:g.specularColorMap?y=g.specularColorMap:g.transmissionMap?y=g.transmissionMap:g.thicknessMap?y=g.thicknessMap:g.sheenColorMap?y=g.sheenColorMap:g.sheenRoughnessMap&&(y=g.sheenRoughnessMap),y!==void 0&&(y.isWebGLRenderTarget&&(y=y.texture),y.matrixAutoUpdate===!0&&y.updateMatrix(),m.uvTransform.value.copy(y.matrix));let x;g.aoMap?x=g.aoMap:g.lightMap&&(x=g.lightMap),x!==void 0&&(x.isWebGLRenderTarget&&(x=x.texture),x.matrixAutoUpdate===!0&&x.updateMatrix(),m.uv2Transform.value.copy(x.matrix))}function s(m,g){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity}function a(m,g){m.dashSize.value=g.dashSize,m.totalSize.value=g.dashSize+g.gapSize,m.scale.value=g.scale}function o(m,g,v,y){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity,m.size.value=g.size*v,m.scale.value=y*.5,g.map&&(m.map.value=g.map),g.alphaMap&&(m.alphaMap.value=g.alphaMap),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest);let x;g.map?x=g.map:g.alphaMap&&(x=g.alphaMap),x!==void 0&&(x.matrixAutoUpdate===!0&&x.updateMatrix(),m.uvTransform.value.copy(x.matrix))}function l(m,g){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity,m.rotation.value=g.rotation,g.map&&(m.map.value=g.map),g.alphaMap&&(m.alphaMap.value=g.alphaMap),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest);let v;g.map?v=g.map:g.alphaMap&&(v=g.alphaMap),v!==void 0&&(v.matrixAutoUpdate===!0&&v.updateMatrix(),m.uvTransform.value.copy(v.matrix))}function c(m,g){m.specular.value.copy(g.specular),m.shininess.value=Math.max(g.shininess,1e-4)}function u(m,g){g.gradientMap&&(m.gradientMap.value=g.gradientMap)}function h(m,g){m.roughness.value=g.roughness,m.metalness.value=g.metalness,g.roughnessMap&&(m.roughnessMap.value=g.roughnessMap),g.metalnessMap&&(m.metalnessMap.value=g.metalnessMap),t.get(g).envMap&&(m.envMapIntensity.value=g.envMapIntensity)}function d(m,g,v){m.ior.value=g.ior,g.sheen>0&&(m.sheenColor.value.copy(g.sheenColor).multiplyScalar(g.sheen),m.sheenRoughness.value=g.sheenRoughness,g.sheenColorMap&&(m.sheenColorMap.value=g.sheenColorMap),g.sheenRoughnessMap&&(m.sheenRoughnessMap.value=g.sheenRoughnessMap)),g.clearcoat>0&&(m.clearcoat.value=g.clearcoat,m.clearcoatRoughness.value=g.clearcoatRoughness,g.clearcoatMap&&(m.clearcoatMap.value=g.clearcoatMap),g.clearcoatRoughnessMap&&(m.clearcoatRoughnessMap.value=g.clearcoatRoughnessMap),g.clearcoatNormalMap&&(m.clearcoatNormalScale.value.copy(g.clearcoatNormalScale),m.clearcoatNormalMap.value=g.clearcoatNormalMap,g.side===$r&&m.clearcoatNormalScale.value.negate())),g.iridescence>0&&(m.iridescence.value=g.iridescence,m.iridescenceIOR.value=g.iridescenceIOR,m.iridescenceThicknessMinimum.value=g.iridescenceThicknessRange[0],m.iridescenceThicknessMaximum.value=g.iridescenceThicknessRange[1],g.iridescenceMap&&(m.iridescenceMap.value=g.iridescenceMap),g.iridescenceThicknessMap&&(m.iridescenceThicknessMap.value=g.iridescenceThicknessMap)),g.transmission>0&&(m.transmission.value=g.transmission,m.transmissionSamplerMap.value=v.texture,m.transmissionSamplerSize.value.set(v.width,v.height),g.transmissionMap&&(m.transmissionMap.value=g.transmissionMap),m.thickness.value=g.thickness,g.thicknessMap&&(m.thicknessMap.value=g.thicknessMap),m.attenuationDistance.value=g.attenuationDistance,m.attenuationColor.value.copy(g.attenuationColor)),m.specularIntensity.value=g.specularIntensity,m.specularColor.value.copy(g.specularColor),g.specularIntensityMap&&(m.specularIntensityMap.value=g.specularIntensityMap),g.specularColorMap&&(m.specularColorMap.value=g.specularColorMap)}function p(m,g){g.matcap&&(m.matcap.value=g.matcap)}function f(m,g){m.referencePosition.value.copy(g.referencePosition),m.nearDistance.value=g.nearDistance,m.farDistance.value=g.farDistance}return{refreshFogUniforms:r,refreshMaterialUniforms:i}}function TK(e,t,r,i){let n={},s={},a=[],o=r.isWebGL2?e.getParameter(35375):0;function l(y,x){let w=x.program;i.uniformBlockBinding(y,w)}function c(y,x){let w=n[y.id];w===void 0&&(f(y),w=u(y),n[y.id]=w,y.addEventListener("dispose",g));let b=x.program;i.updateUBOMapping(y,b);let _=t.render.frame;s[y.id]!==_&&(d(y),s[y.id]=_)}function u(y){let x=h();y.__bindingPointIndex=x;let w=e.createBuffer(),b=y.__size,_=y.usage;return e.bindBuffer(35345,w),e.bufferData(35345,b,_),e.bindBuffer(35345,null),e.bindBufferBase(35345,x,w),w}function h(){for(let y=0;y<o;y++)if(a.indexOf(y)===-1)return a.push(y),y;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function d(y){let x=n[y.id],w=y.uniforms,b=y.__cache;e.bindBuffer(35345,x);for(let _=0,A=w.length;_<A;_++){let S=w[_];if(p(S,_,b)===!0){let C=S.__offset,M=Array.isArray(S.value)?S.value:[S.value],T=0;for(let P=0;P<M.length;P++){let D=M[P],I=m(D);typeof D=="number"?(S.__data[0]=D,e.bufferSubData(35345,C+T,S.__data)):D.isMatrix3?(S.__data[0]=D.elements[0],S.__data[1]=D.elements[1],S.__data[2]=D.elements[2],S.__data[3]=D.elements[0],S.__data[4]=D.elements[3],S.__data[5]=D.elements[4],S.__data[6]=D.elements[5],S.__data[7]=D.elements[0],S.__data[8]=D.elements[6],S.__data[9]=D.elements[7],S.__data[10]=D.elements[8],S.__data[11]=D.elements[0]):(D.toArray(S.__data,T),T+=I.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(35345,C,S.__data)}}e.bindBuffer(35345,null)}function p(y,x,w){let b=y.value;if(w[x]===void 0){if(typeof b=="number")w[x]=b;else{let _=Array.isArray(b)?b:[b],A=[];for(let S=0;S<_.length;S++)A.push(_[S].clone());w[x]=A}return!0}else if(typeof b=="number"){if(w[x]!==b)return w[x]=b,!0}else{let _=Array.isArray(w[x])?w[x]:[w[x]],A=Array.isArray(b)?b:[b];for(let S=0;S<_.length;S++){let C=_[S];if(C.equals(A[S])===!1)return C.copy(A[S]),!0}}return!1}function f(y){let x=y.uniforms,w=0,b=16,_=0;for(let A=0,S=x.length;A<S;A++){let C=x[A],M={boundary:0,storage:0},T=Array.isArray(C.value)?C.value:[C.value];for(let P=0,D=T.length;P<D;P++){let I=T[P],B=m(I);M.boundary+=B.boundary,M.storage+=B.storage}if(C.__data=new Float32Array(M.storage/Float32Array.BYTES_PER_ELEMENT),C.__offset=w,A>0){_=w%b;let P=b-_;_!==0&&P-M.boundary<0&&(w+=b-_,C.__offset=w)}w+=M.storage}return _=w%b,_>0&&(w+=b-_),y.__size=w,y.__cache={},this}function m(y){let x={boundary:0,storage:0};return typeof y=="number"?(x.boundary=4,x.storage=4):y.isVector2?(x.boundary=8,x.storage=8):y.isVector3||y.isColor?(x.boundary=16,x.storage=12):y.isVector4?(x.boundary=16,x.storage=16):y.isMatrix3?(x.boundary=48,x.storage=48):y.isMatrix4?(x.boundary=64,x.storage=64):y.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",y),x}function g(y){let x=y.target;x.removeEventListener("dispose",g);let w=a.indexOf(x.__bindingPointIndex);a.splice(w,1),e.deleteBuffer(n[x.id]),delete n[x.id],delete s[x.id]}function v(){for(let y in n)e.deleteBuffer(n[y]);a=[],n={},s={}}return{bind:l,update:c,dispose:v}}function PK(){let e=b0("canvas");return e.style.display="block",e}function CR(e={}){this.isWebGLRenderer=!0;let t=e.canvas!==void 0?e.canvas:PK(),r=e.context!==void 0?e.context:null,i=e.depth!==void 0?e.depth:!0,n=e.stencil!==void 0?e.stencil:!0,s=e.antialias!==void 0?e.antialias:!1,a=e.premultipliedAlpha!==void 0?e.premultipliedAlpha:!0,o=e.preserveDrawingBuffer!==void 0?e.preserveDrawingBuffer:!1,l=e.powerPreference!==void 0?e.powerPreference:"default",c=e.failIfMajorPerformanceCaveat!==void 0?e.failIfMajorPerformanceCaveat:!1,u;r!==null?u=r.getContextAttributes().alpha:u=e.alpha!==void 0?e.alpha:!1;let h=null,d=null,p=[],f=[];this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=fa,this.physicallyCorrectLights=!1,this.toneMapping=io,this.toneMappingExposure=1;let m=this,g=!1,v=0,y=0,x=null,w=-1,b=null,_=new dt,A=new dt,S=null,C=t.width,M=t.height,T=1,P=null,D=null,I=new dt(0,0,C,M),B=new dt(0,0,C,M),X=!1,H=new C3,R=!1,q=!1,F=null,N=new _e,j=new W,K=new E,U={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Y(){return x===null?T:1}let V=r;function ie(z,le){for(let ge=0;ge<z.length;ge++){let Z=z[ge],fe=t.getContext(Z,le);if(fe!==null)return fe}return null}try{let z={alpha:!0,depth:i,stencil:n,antialias:s,premultipliedAlpha:a,preserveDrawingBuffer:o,powerPreference:l,failIfMajorPerformanceCaveat:c};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${cd}`),t.addEventListener("webglcontextlost",Q,!1),t.addEventListener("webglcontextrestored",$,!1),t.addEventListener("webglcontextcreationerror",de,!1),V===null){let le=["webgl2","webgl","experimental-webgl"];if(m.isWebGL1Renderer===!0&&le.shift(),V=ie(le,z),V===null)throw ie(le)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}V.getShaderPrecisionFormat===void 0&&(V.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(z){throw console.error("THREE.WebGLRenderer: "+z.message),z}let J,ee,se,ce,ue,ye,Re,Se,ke,Oe,Ce,Ae,je,We,k,O,oe,be,xe,Te,Ge,Ie,pe,Ve;function qe(){J=new VY(V),ee=new zY(V,J,e),J.init(ee),Ie=new SK(V,J,ee),se=new bK(V,J,ee),ce=new WY,ue=new lK,ye=new _K(V,J,se,ue,ee,Ie,ce),Re=new NY(m),Se=new jY(m),ke=new eq(V,ee),pe=new RY(V,J,ke,ee),Oe=new HY(V,ke,ce,pe),Ce=new QY(V,Oe,ke,ce),xe=new YY(V,ee,ye),O=new kY(ue),Ae=new oK(m,Re,Se,J,ee,pe,O),je=new EK(m,ue),We=new hK,k=new gK(J,ee),be=new OY(m,Re,Se,se,Ce,u,a),oe=new wK(m,Ce,ee),Ve=new TK(V,ce,ee,se),Te=new BY(V,J,ce,ee),Ge=new GY(V,J,ce,ee),ce.programs=Ae.programs,m.capabilities=ee,m.extensions=J,m.properties=ue,m.renderLists=We,m.shadowMap=oe,m.state=se,m.info=ce}qe();let Xe=new MK(m,V);this.xr=Xe,this.getContext=function(){return V},this.getContextAttributes=function(){return V.getContextAttributes()},this.forceContextLoss=function(){let z=J.get("WEBGL_lose_context");z&&z.loseContext()},this.forceContextRestore=function(){let z=J.get("WEBGL_lose_context");z&&z.restoreContext()},this.getPixelRatio=function(){return T},this.setPixelRatio=function(z){z!==void 0&&(T=z,this.setSize(C,M,!1))},this.getSize=function(z){return z.set(C,M)},this.setSize=function(z,le,ge){if(Xe.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}C=z,M=le,t.width=Math.floor(z*T),t.height=Math.floor(le*T),ge!==!1&&(t.style.width=z+"px",t.style.height=le+"px"),this.setViewport(0,0,z,le)},this.getDrawingBufferSize=function(z){return z.set(C*T,M*T).floor()},this.setDrawingBufferSize=function(z,le,ge){C=z,M=le,T=ge,t.width=Math.floor(z*ge),t.height=Math.floor(le*ge),this.setViewport(0,0,z,le)},this.getCurrentViewport=function(z){return z.copy(_)},this.getViewport=function(z){return z.copy(I)},this.setViewport=function(z,le,ge,Z){z.isVector4?I.set(z.x,z.y,z.z,z.w):I.set(z,le,ge,Z),se.viewport(_.copy(I).multiplyScalar(T).floor())},this.getScissor=function(z){return z.copy(B)},this.setScissor=function(z,le,ge,Z){z.isVector4?B.set(z.x,z.y,z.z,z.w):B.set(z,le,ge,Z),se.scissor(A.copy(B).multiplyScalar(T).floor())},this.getScissorTest=function(){return X},this.setScissorTest=function(z){se.setScissorTest(X=z)},this.setOpaqueSort=function(z){P=z},this.setTransparentSort=function(z){D=z},this.getClearColor=function(z){return z.copy(be.getClearColor())},this.setClearColor=function(){be.setClearColor.apply(be,arguments)},this.getClearAlpha=function(){return be.getClearAlpha()},this.setClearAlpha=function(){be.setClearAlpha.apply(be,arguments)},this.clear=function(z=!0,le=!0,ge=!0){let Z=0;z&&(Z|=16384),le&&(Z|=256),ge&&(Z|=1024),V.clear(Z)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Q,!1),t.removeEventListener("webglcontextrestored",$,!1),t.removeEventListener("webglcontextcreationerror",de,!1),We.dispose(),k.dispose(),ue.dispose(),Re.dispose(),Se.dispose(),Ce.dispose(),pe.dispose(),Ve.dispose(),Ae.dispose(),Xe.dispose(),Xe.removeEventListener("sessionstart",me),Xe.removeEventListener("sessionend",Le),F&&(F.dispose(),F=null),Je.stop()};function Q(z){z.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),g=!0}function $(){console.log("THREE.WebGLRenderer: Context Restored."),g=!1;let z=ce.autoReset,le=oe.enabled,ge=oe.autoUpdate,Z=oe.needsUpdate,fe=oe.type;qe(),ce.autoReset=z,oe.enabled=le,oe.autoUpdate=ge,oe.needsUpdate=Z,oe.type=fe}function de(z){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",z.statusMessage)}function Ee(z){let le=z.target;le.removeEventListener("dispose",Ee),He(le)}function He(z){G(z),ue.remove(z)}function G(z){let le=ue.get(z).programs;le!==void 0&&(le.forEach(function(ge){Ae.releaseProgram(ge)}),z.isShaderMaterial&&Ae.releaseShaderCache(z))}this.renderBufferDirect=function(z,le,ge,Z,fe,Fe){le===null&&(le=U);let lt=fe.isMesh&&fe.matrixWorld.determinant()<0,Ye=is(z,le,ge,Z,fe);se.setMaterial(Z,lt);let gt=ge.index,Rt=1;Z.wireframe===!0&&(gt=Oe.getWireframeAttribute(ge),Rt=2);let Et=ge.drawRange,Tt=ge.attributes.position,di=Et.start*Rt,cn=(Et.start+Et.count)*Rt;Fe!==null&&(di=Math.max(di,Fe.start*Rt),cn=Math.min(cn,(Fe.start+Fe.count)*Rt)),gt!==null?(di=Math.max(di,0),cn=Math.min(cn,gt.count)):Tt!=null&&(di=Math.max(di,0),cn=Math.min(cn,Tt.count));let Sa=cn-di;if(Sa<0||Sa===1/0)return;pe.setup(fe,Z,Ye,ge,gt);let Rl,Cr=Te;if(gt!==null&&(Rl=ke.get(gt),Cr=Ge,Cr.setIndex(Rl)),fe.isMesh)Z.wireframe===!0?(se.setLineWidth(Z.wireframeLinewidth*Y()),Cr.setMode(1)):Cr.setMode(4);else if(fe.isLine){let Pt=Z.linewidth;Pt===void 0&&(Pt=1),se.setLineWidth(Pt*Y()),fe.isLineSegments?Cr.setMode(1):fe.isLineLoop?Cr.setMode(2):Cr.setMode(3)}else fe.isPoints?Cr.setMode(0):fe.isSprite&&Cr.setMode(4);if(fe.isInstancedMesh)Cr.renderInstances(di,Sa,fe.count);else if(ge.isInstancedBufferGeometry){let Pt=ge._maxInstanceCount!==void 0?ge._maxInstanceCount:1/0,c1=Math.min(ge.instanceCount,Pt);Cr.renderInstances(di,Sa,c1)}else Cr.render(di,Sa)},this.compile=function(z,le){function ge(Z,fe,Fe){Z.transparent===!0&&Z.side===yn&&Z.forceSinglePass===!1?(Z.side=$r,Z.needsUpdate=!0,qr(Z,fe,Fe),Z.side=Ds,Z.needsUpdate=!0,qr(Z,fe,Fe),Z.side=yn):qr(Z,fe,Fe)}d=k.get(z),d.init(),f.push(d),z.traverseVisible(function(Z){Z.isLight&&Z.layers.test(le.layers)&&(d.pushLight(Z),Z.castShadow&&d.pushShadow(Z))}),d.setupLights(m.physicallyCorrectLights),z.traverse(function(Z){let fe=Z.material;if(fe)if(Array.isArray(fe))for(let Fe=0;Fe<fe.length;Fe++){let lt=fe[Fe];ge(lt,z,Z)}else ge(fe,z,Z)}),f.pop(),d=null};let te=null;function ae(z){te&&te(z)}function me(){Je.stop()}function Le(){Je.start()}let Je=new xR;Je.setAnimationLoop(ae),typeof self<"u"&&Je.setContext(self),this.setAnimationLoop=function(z){te=z,Xe.setAnimationLoop(z),z===null?Je.stop():Je.start()},Xe.addEventListener("sessionstart",me),Xe.addEventListener("sessionend",Le),this.render=function(z,le){if(le!==void 0&&le.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(g===!0)return;z.matrixWorldAutoUpdate===!0&&z.updateMatrixWorld(),le.parent===null&&le.matrixWorldAutoUpdate===!0&&le.updateMatrixWorld(),Xe.enabled===!0&&Xe.isPresenting===!0&&(Xe.cameraAutoUpdate===!0&&Xe.updateCamera(le),le=Xe.getCamera()),z.isScene===!0&&z.onBeforeRender(m,z,le,x),d=k.get(z,f.length),d.init(),f.push(d),N.multiplyMatrices(le.projectionMatrix,le.matrixWorldInverse),H.setFromProjectionMatrix(N),q=this.localClippingEnabled,R=O.init(this.clippingPlanes,q),h=We.get(z,p.length),h.init(),p.push(h),ot(z,le,0,m.sortObjects),h.finish(),m.sortObjects===!0&&h.sort(P,D),R===!0&&O.beginShadows();let ge=d.state.shadowsArray;if(oe.render(ge,z,le),R===!0&&O.endShadows(),this.info.autoReset===!0&&this.info.reset(),be.render(h,z),d.setupLights(m.physicallyCorrectLights),le.isArrayCamera){let Z=le.cameras;for(let fe=0,Fe=Z.length;fe<Fe;fe++){let lt=Z[fe];bt(h,z,lt,lt.viewport)}}else bt(h,z,le);x!==null&&(ye.updateMultisampleRenderTarget(x),ye.updateRenderTargetMipmap(x)),z.isScene===!0&&z.onAfterRender(m,z,le),pe.resetDefaultState(),w=-1,b=null,f.pop(),f.length>0?d=f[f.length-1]:d=null,p.pop(),p.length>0?h=p[p.length-1]:h=null};function ot(z,le,ge,Z){if(z.visible===!1)return;if(z.layers.test(le.layers)){if(z.isGroup)ge=z.renderOrder;else if(z.isLOD)z.autoUpdate===!0&&z.update(le);else if(z.isLight)d.pushLight(z),z.castShadow&&d.pushShadow(z);else if(z.isSprite){if(!z.frustumCulled||H.intersectsSprite(z)){Z&&K.setFromMatrixPosition(z.matrixWorld).applyMatrix4(N);let Fe=Ce.update(z),lt=z.material;lt.visible&&h.push(z,Fe,lt,ge,K.z,null)}}else if((z.isMesh||z.isLine||z.isPoints)&&(z.isSkinnedMesh&&z.skeleton.frame!==ce.render.frame&&(z.skeleton.update(),z.skeleton.frame=ce.render.frame),!z.frustumCulled||H.intersectsObject(z))){Z&&K.setFromMatrixPosition(z.matrixWorld).applyMatrix4(N);let Fe=Ce.update(z),lt=z.material;if(Array.isArray(lt)){let Ye=Fe.groups;for(let gt=0,Rt=Ye.length;gt<Rt;gt++){let Et=Ye[gt],Tt=lt[Et.materialIndex];Tt&&Tt.visible&&h.push(z,Fe,Tt,ge,K.z,Et)}}else lt.visible&&h.push(z,Fe,lt,ge,K.z,null)}}let fe=z.children;for(let Fe=0,lt=fe.length;Fe<lt;Fe++)ot(fe[Fe],le,ge,Z)}function bt(z,le,ge,Z){let fe=z.opaque,Fe=z.transmissive,lt=z.transparent;d.setupLightsView(ge),R===!0&&O.setGlobalState(m.clippingPlanes,ge),Fe.length>0&&Qt(fe,le,ge),Z&&se.viewport(_.copy(Z)),fe.length>0&&Lt(fe,le,ge),Fe.length>0&&Lt(Fe,le,ge),lt.length>0&&Lt(lt,le,ge),se.buffers.depth.setTest(!0),se.buffers.depth.setMask(!0),se.buffers.color.setMask(!0),se.setPolygonOffset(!1)}function Qt(z,le,ge){let Z=ee.isWebGL2;F===null&&(F=new Ut(1,1,{generateMipmaps:!0,type:J.has("EXT_color_buffer_half_float")?Hu:Si,minFilter:Vu,samples:Z&&s===!0?4:0})),m.getDrawingBufferSize(j),Z?F.setSize(j.x,j.y):F.setSize(w0(j.x),w0(j.y));let fe=m.getRenderTarget();m.setRenderTarget(F),m.clear();let Fe=m.toneMapping;m.toneMapping=io,Lt(z,le,ge),m.toneMapping=Fe,ye.updateMultisampleRenderTarget(F),ye.updateRenderTargetMipmap(F),m.setRenderTarget(fe)}function Lt(z,le,ge){let Z=le.isScene===!0?le.overrideMaterial:null;for(let fe=0,Fe=z.length;fe<Fe;fe++){let lt=z[fe],Ye=lt.object,gt=lt.geometry,Rt=Z===null?lt.material:Z,Et=lt.group;Ye.layers.test(ge.layers)&&ii(Ye,le,ge,gt,Rt,Et)}}function ii(z,le,ge,Z,fe,Fe){z.onBeforeRender(m,le,ge,Z,fe,Fe),z.modelViewMatrix.multiplyMatrices(ge.matrixWorldInverse,z.matrixWorld),z.normalMatrix.getNormalMatrix(z.modelViewMatrix),fe.onBeforeRender(m,le,ge,Z,z,Fe),fe.transparent===!0&&fe.side===yn&&fe.forceSinglePass===!1?(fe.side=$r,fe.needsUpdate=!0,m.renderBufferDirect(ge,le,Z,fe,z,Fe),fe.side=Ds,fe.needsUpdate=!0,m.renderBufferDirect(ge,le,Z,fe,z,Fe),fe.side=yn):m.renderBufferDirect(ge,le,Z,fe,z,Fe),z.onAfterRender(m,le,ge,Z,fe,Fe)}function qr(z,le,ge){le.isScene!==!0&&(le=U);let Z=ue.get(z),fe=d.state.lights,Fe=d.state.shadowsArray,lt=fe.state.version,Ye=Ae.getParameters(z,fe.state,Fe,le,ge),gt=Ae.getProgramCacheKey(Ye),Rt=Z.programs;Z.environment=z.isMeshStandardMaterial?le.environment:null,Z.fog=le.fog,Z.envMap=(z.isMeshStandardMaterial?Se:Re).get(z.envMap||Z.environment),Rt===void 0&&(z.addEventListener("dispose",Ee),Rt=new Map,Z.programs=Rt);let Et=Rt.get(gt);if(Et!==void 0){if(Z.currentProgram===Et&&Z.lightsStateVersion===lt)return Qc(z,Ye),Et}else Ye.uniforms=Ae.getUniforms(z),z.onBuild(ge,Ye,m),z.onBeforeCompile(Ye,m),Et=Ae.acquireProgram(Ye,gt),Rt.set(gt,Et),Z.uniforms=Ye.uniforms;let Tt=Z.uniforms;(!z.isShaderMaterial&&!z.isRawShaderMaterial||z.clipping===!0)&&(Tt.clippingPlanes=O.uniform),Qc(z,Ye),Z.needsLights=Kc(z),Z.lightsStateVersion=lt,Z.needsLights&&(Tt.ambientLightColor.value=fe.state.ambient,Tt.lightProbe.value=fe.state.probe,Tt.directionalLights.value=fe.state.directional,Tt.directionalLightShadows.value=fe.state.directionalShadow,Tt.spotLights.value=fe.state.spot,Tt.spotLightShadows.value=fe.state.spotShadow,Tt.rectAreaLights.value=fe.state.rectArea,Tt.ltc_1.value=fe.state.rectAreaLTC1,Tt.ltc_2.value=fe.state.rectAreaLTC2,Tt.pointLights.value=fe.state.point,Tt.pointLightShadows.value=fe.state.pointShadow,Tt.hemisphereLights.value=fe.state.hemi,Tt.directionalShadowMap.value=fe.state.directionalShadowMap,Tt.directionalShadowMatrix.value=fe.state.directionalShadowMatrix,Tt.spotShadowMap.value=fe.state.spotShadowMap,Tt.spotLightMatrix.value=fe.state.spotLightMatrix,Tt.spotLightMap.value=fe.state.spotLightMap,Tt.pointShadowMap.value=fe.state.pointShadowMap,Tt.pointShadowMatrix.value=fe.state.pointShadowMatrix);let di=Et.getUniforms(),cn=Mv.seqWithValue(di.seq,Tt);return Z.currentProgram=Et,Z.uniformsList=cn,Et}function Qc(z,le){let ge=ue.get(z);ge.outputEncoding=le.outputEncoding,ge.instancing=le.instancing,ge.skinning=le.skinning,ge.morphTargets=le.morphTargets,ge.morphNormals=le.morphNormals,ge.morphColors=le.morphColors,ge.morphTargetsCount=le.morphTargetsCount,ge.numClippingPlanes=le.numClippingPlanes,ge.numIntersection=le.numClipIntersection,ge.vertexAlphas=le.vertexAlphas,ge.vertexTangents=le.vertexTangents,ge.toneMapping=le.toneMapping}function is(z,le,ge,Z,fe){le.isScene!==!0&&(le=U),ye.resetTextureUnits();let Fe=le.fog,lt=Z.isMeshStandardMaterial?le.environment:null,Ye=x===null?m.outputEncoding:x.isXRRenderTarget===!0?x.texture.encoding:fa,gt=(Z.isMeshStandardMaterial?Se:Re).get(Z.envMap||lt),Rt=Z.vertexColors===!0&&!!ge.attributes.color&&ge.attributes.color.itemSize===4,Et=!!Z.normalMap&&!!ge.attributes.tangent,Tt=!!ge.morphAttributes.position,di=!!ge.morphAttributes.normal,cn=!!ge.morphAttributes.color,Sa=Z.toneMapped?m.toneMapping:io,Rl=ge.morphAttributes.position||ge.morphAttributes.normal||ge.morphAttributes.color,Cr=Rl!==void 0?Rl.length:0,Pt=ue.get(Z),c1=d.state.lights;if(R===!0&&(q===!0||z!==b)){let hn=z===b&&Z.id===w;O.setState(Z,z,hn)}let h1=!1;Z.version===Pt.__version?(Pt.needsLights&&Pt.lightsStateVersion!==c1.state.version||Pt.outputEncoding!==Ye||fe.isInstancedMesh&&Pt.instancing===!1||!fe.isInstancedMesh&&Pt.instancing===!0||fe.isSkinnedMesh&&Pt.skinning===!1||!fe.isSkinnedMesh&&Pt.skinning===!0||Pt.envMap!==gt||Z.fog===!0&&Pt.fog!==Fe||Pt.numClippingPlanes!==void 0&&(Pt.numClippingPlanes!==O.numPlanes||Pt.numIntersection!==O.numIntersection)||Pt.vertexAlphas!==Rt||Pt.vertexTangents!==Et||Pt.morphTargets!==Tt||Pt.morphNormals!==di||Pt.morphColors!==cn||Pt.toneMapping!==Sa||ee.isWebGL2===!0&&Pt.morphTargetsCount!==Cr)&&(h1=!0):(h1=!0,Pt.__version=Z.version);let Bl=Pt.currentProgram;h1===!0&&(Bl=qr(Z,le,fe));let JA=!1,Md=!1,u1=!1,ni=Bl.getUniforms(),zl=Pt.uniforms;if(se.useProgram(Bl.program)&&(JA=!0,Md=!0,u1=!0),Z.id!==w&&(w=Z.id,Md=!0),JA||b!==z){if(ni.setValue(V,"projectionMatrix",z.projectionMatrix),ee.logarithmicDepthBuffer&&ni.setValue(V,"logDepthBufFC",2/(Math.log(z.far+1)/Math.LN2)),b!==z&&(b=z,Md=!0,u1=!0),Z.isShaderMaterial||Z.isMeshPhongMaterial||Z.isMeshToonMaterial||Z.isMeshStandardMaterial||Z.envMap){let hn=ni.map.cameraPosition;hn!==void 0&&hn.setValue(V,K.setFromMatrixPosition(z.matrixWorld))}(Z.isMeshPhongMaterial||Z.isMeshToonMaterial||Z.isMeshLambertMaterial||Z.isMeshBasicMaterial||Z.isMeshStandardMaterial||Z.isShaderMaterial)&&ni.setValue(V,"isOrthographic",z.isOrthographicCamera===!0),(Z.isMeshPhongMaterial||Z.isMeshToonMaterial||Z.isMeshLambertMaterial||Z.isMeshBasicMaterial||Z.isMeshStandardMaterial||Z.isShaderMaterial||Z.isShadowMaterial||fe.isSkinnedMesh)&&ni.setValue(V,"viewMatrix",z.matrixWorldInverse)}if(fe.isSkinnedMesh){ni.setOptional(V,fe,"bindMatrix"),ni.setOptional(V,fe,"bindMatrixInverse");let hn=fe.skeleton;hn&&(ee.floatVertexTextures?(hn.boneTexture===null&&hn.computeBoneTexture(),ni.setValue(V,"boneTexture",hn.boneTexture,ye),ni.setValue(V,"boneTextureSize",hn.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}let d1=ge.morphAttributes;if((d1.position!==void 0||d1.normal!==void 0||d1.color!==void 0&&ee.isWebGL2===!0)&&xe.update(fe,ge,Z,Bl),(Md||Pt.receiveShadow!==fe.receiveShadow)&&(Pt.receiveShadow=fe.receiveShadow,ni.setValue(V,"receiveShadow",fe.receiveShadow)),Z.isMeshGouraudMaterial&&Z.envMap!==null&&(zl.envMap.value=gt,zl.flipEnvMap.value=gt.isCubeTexture&&gt.isRenderTargetTexture===!1?-1:1),Md&&(ni.setValue(V,"toneMappingExposure",m.toneMappingExposure),Pt.needsLights&&ns(zl,u1),Fe&&Z.fog===!0&&je.refreshFogUniforms(zl,Fe),je.refreshMaterialUniforms(zl,Z,T,M,F),Mv.upload(V,Pt.uniformsList,zl,ye)),Z.isShaderMaterial&&Z.uniformsNeedUpdate===!0&&(Mv.upload(V,Pt.uniformsList,zl,ye),Z.uniformsNeedUpdate=!1),Z.isSpriteMaterial&&ni.setValue(V,"center",fe.center),ni.setValue(V,"modelViewMatrix",fe.modelViewMatrix),ni.setValue(V,"normalMatrix",fe.normalMatrix),ni.setValue(V,"modelMatrix",fe.matrixWorld),fe.previousModelViewMatrix&&ni.setValue(V,"previousModelViewMatrix",fe.previousModelViewMatrix),z.previousProjectionMatrix&&ni.setValue(V,"previousProjectionMatrix",z.previousProjectionMatrix),Z.isShaderMaterial||Z.isRawShaderMaterial){let hn=Z.uniformsGroups;for(let p1=0,A8=hn.length;p1<A8;p1++)if(ee.isWebGL2){let eC=hn[p1];Ve.update(eC,Bl),Ve.bind(eC,Bl)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Bl}function ns(z,le){z.ambientLightColor.needsUpdate=le,z.lightProbe.needsUpdate=le,z.directionalLights.needsUpdate=le,z.directionalLightShadows.needsUpdate=le,z.pointLights.needsUpdate=le,z.pointLightShadows.needsUpdate=le,z.spotLights.needsUpdate=le,z.spotLightShadows.needsUpdate=le,z.rectAreaLights.needsUpdate=le,z.hemisphereLights.needsUpdate=le}function Kc(z){return z.isMeshLambertMaterial||z.isMeshToonMaterial||z.isMeshPhongMaterial||z.isMeshStandardMaterial||z.isShadowMaterial||z.isShaderMaterial&&z.lights===!0}this.getActiveCubeFace=function(){return v},this.getActiveMipmapLevel=function(){return y},this.getRenderTarget=function(){return x},this.setRenderTargetTextures=function(z,le,ge){ue.get(z.texture).__webglTexture=le,ue.get(z.depthTexture).__webglTexture=ge;let Z=ue.get(z);Z.__hasExternalTextures=!0,Z.__hasExternalTextures&&(Z.__autoAllocateDepthBuffer=ge===void 0,Z.__autoAllocateDepthBuffer||J.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Z.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(z,le){let ge=ue.get(z);ge.__webglFramebuffer=le,ge.__useDefaultFramebuffer=le===void 0},this.setRenderTarget=function(z,le=0,ge=0){x=z,v=le,y=ge;let Z=!0,fe=null,Fe=!1,lt=!1;if(z){let Ye=ue.get(z);Ye.__useDefaultFramebuffer!==void 0?(se.bindFramebuffer(36160,null),Z=!1):Ye.__webglFramebuffer===void 0?ye.setupRenderTarget(z):Ye.__hasExternalTextures&&ye.rebindTextures(z,ue.get(z.texture).__webglTexture,ue.get(z.depthTexture).__webglTexture);let gt=z.texture;(gt.isData3DTexture||gt.isDataArrayTexture||gt.isCompressedArrayTexture)&&(lt=!0);let Rt=ue.get(z).__webglFramebuffer;z.isWebGLCubeRenderTarget?(fe=Rt[le],Fe=!0):ee.isWebGL2&&z.samples>0&&ye.useMultisampledRTT(z)===!1?fe=ue.get(z).__webglMultisampledFramebuffer:fe=Rt,_.copy(z.viewport),A.copy(z.scissor),S=z.scissorTest}else _.copy(I).multiplyScalar(T).floor(),A.copy(B).multiplyScalar(T).floor(),S=X;if(se.bindFramebuffer(36160,fe)&&ee.drawBuffers&&Z&&se.drawBuffers(z,fe),se.viewport(_),se.scissor(A),se.setScissorTest(S),Fe){let Ye=ue.get(z.texture);V.framebufferTexture2D(36160,36064,34069+le,Ye.__webglTexture,ge)}else if(lt){let Ye=ue.get(z.texture),gt=le||0;V.framebufferTextureLayer(36160,36064,Ye.__webglTexture,ge||0,gt)}w=-1},this.readRenderTargetPixels=function(z,le,ge,Z,fe,Fe,lt){if(!(z&&z.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Ye=ue.get(z).__webglFramebuffer;if(z.isWebGLCubeRenderTarget&&lt!==void 0&&(Ye=Ye[lt]),Ye){se.bindFramebuffer(36160,Ye);try{let gt=z.texture,Rt=gt.format,Et=gt.type;if(Rt!==Wn&&Ie.convert(Rt)!==V.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}let Tt=Et===Hu&&(J.has("EXT_color_buffer_half_float")||ee.isWebGL2&&J.has("EXT_color_buffer_float"));if(Et!==Si&&Ie.convert(Et)!==V.getParameter(35738)&&!(Et===xn&&(ee.isWebGL2||J.has("OES_texture_float")||J.has("WEBGL_color_buffer_float")))&&!Tt){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}le>=0&&le<=z.width-Z&&ge>=0&&ge<=z.height-fe&&V.readPixels(le,ge,Z,fe,Ie.convert(Rt),Ie.convert(Et),Fe)}finally{let gt=x!==null?ue.get(x).__webglFramebuffer:null;se.bindFramebuffer(36160,gt)}}},this.copyFramebufferToTexture=function(z,le,ge=0){let Z=Math.pow(2,-ge),fe=Math.floor(le.image.width*Z),Fe=Math.floor(le.image.height*Z);ye.setTexture2D(le,0),V.copyTexSubImage2D(3553,ge,0,0,z.x,z.y,fe,Fe),se.unbindTexture()},this.copyTextureToTexture=function(z,le,ge,Z=0){let fe=le.image.width,Fe=le.image.height,lt=Ie.convert(ge.format),Ye=Ie.convert(ge.type);ye.setTexture2D(ge,0),V.pixelStorei(37440,ge.flipY),V.pixelStorei(37441,ge.premultiplyAlpha),V.pixelStorei(3317,ge.unpackAlignment),le.isDataTexture?V.texSubImage2D(3553,Z,z.x,z.y,fe,Fe,lt,Ye,le.image.data):le.isCompressedTexture?V.compressedTexSubImage2D(3553,Z,z.x,z.y,le.mipmaps[0].width,le.mipmaps[0].height,lt,le.mipmaps[0].data):V.texSubImage2D(3553,Z,z.x,z.y,lt,Ye,le.image),Z===0&&ge.generateMipmaps&&V.generateMipmap(3553),se.unbindTexture()},this.copyTextureToTexture3D=function(z,le,ge,Z,fe=0){if(m.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}let Fe=z.max.x-z.min.x+1,lt=z.max.y-z.min.y+1,Ye=z.max.z-z.min.z+1,gt=Ie.convert(Z.format),Rt=Ie.convert(Z.type),Et;if(Z.isData3DTexture)ye.setTexture3D(Z,0),Et=32879;else if(Z.isDataArrayTexture)ye.setTexture2DArray(Z,0),Et=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}V.pixelStorei(37440,Z.flipY),V.pixelStorei(37441,Z.premultiplyAlpha),V.pixelStorei(3317,Z.unpackAlignment);let Tt=V.getParameter(3314),di=V.getParameter(32878),cn=V.getParameter(3316),Sa=V.getParameter(3315),Rl=V.getParameter(32877),Cr=ge.isCompressedTexture?ge.mipmaps[0]:ge.image;V.pixelStorei(3314,Cr.width),V.pixelStorei(32878,Cr.height),V.pixelStorei(3316,z.min.x),V.pixelStorei(3315,z.min.y),V.pixelStorei(32877,z.min.z),ge.isDataTexture||ge.isData3DTexture?V.texSubImage3D(Et,fe,le.x,le.y,le.z,Fe,lt,Ye,gt,Rt,Cr.data):ge.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),V.compressedTexSubImage3D(Et,fe,le.x,le.y,le.z,Fe,lt,Ye,gt,Cr.data)):V.texSubImage3D(Et,fe,le.x,le.y,le.z,Fe,lt,Ye,gt,Rt,Cr),V.pixelStorei(3314,Tt),V.pixelStorei(32878,di),V.pixelStorei(3316,cn),V.pixelStorei(3315,Sa),V.pixelStorei(32877,Rl),fe===0&&Z.generateMipmaps&&V.generateMipmap(Et),se.unbindTexture()},this.initTexture=function(z){z.isCubeTexture?ye.setTextureCube(z,0):z.isData3DTexture?ye.setTexture3D(z,0):z.isDataArrayTexture||z.isCompressedArrayTexture?ye.setTexture2DArray(z,0):ye.setTexture2D(z,0),se.unbindTexture()},this.resetState=function(){v=0,y=0,x=null,se.reset(),pe.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}var DK=class extends CR{};DK.prototype.isWebGL1Renderer=!0;var MR=class{constructor(e,t=1,r=1e3){this.isFog=!0,this.name="",this.color=new $e(e),this.near=t,this.far=r}clone(){return new MR(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}},pl=class extends Vt{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){let t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}},LK=class{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=d2,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Kn()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,r){e*=this.stride,r*=t.stride;for(let i=0,n=this.stride;i<n;i++)this.array[e+i]=t.array[r+i];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Kn()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(t,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Kn()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}},Ci=new E,g2=class{constructor(e,t,r,i=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=r,this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,r=this.data.count;t<r;t++)Ci.fromBufferAttribute(this,t),Ci.applyMatrix4(e),this.setXYZ(t,Ci.x,Ci.y,Ci.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)Ci.fromBufferAttribute(this,t),Ci.applyNormalMatrix(e),this.setXYZ(t,Ci.x,Ci.y,Ci.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)Ci.fromBufferAttribute(this,t),Ci.transformDirection(e),this.setXYZ(t,Ci.x,Ci.y,Ci.z);return this}setX(e,t){return this.normalized&&(t=qt(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=qt(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=qt(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=qt(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=$a(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=$a(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=$a(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=$a(t,this.array)),t}setXY(e,t,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=qt(t,this.array),r=qt(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this}setXYZ(e,t,r,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=qt(t,this.array),r=qt(r,this.array),i=qt(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this}setXYZW(e,t,r,i,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=qt(t,this.array),r=qt(r,this.array),i=qt(i,this.array),n=qt(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this.data.array[e+3]=n,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");let t=[];for(let r=0;r<this.count;r++){let i=r*this.data.stride+this.offset;for(let n=0;n<this.itemSize;n++)t.push(this.data.array[i+n])}return new nt(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new g2(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");let t=[];for(let r=0;r<this.count;r++){let i=r*this.data.stride+this.offset;for(let n=0;n<this.itemSize;n++)t.push(this.data.array[i+n])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}},ER=class extends Vt{constructor(){super(),this.isBone=!0,this.type="Bone"}},_0=class extends jr{constructor(e=null,t=1,r=1,i,n,s,a,o,l=Xt,c=Xt,u,h){super(null,s,a,o,l,c,i,n,u,h),this.isDataTexture=!0,this.image={data:e,width:t,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},QT=new _e,IK=new _e,T3=class{constructor(e=[],t=[]){this.uuid=Kn(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){let e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let r=0,i=this.bones.length;r<i;r++)this.boneInverses.push(new _e)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){let r=new _e;this.bones[e]&&r.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(r)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){let r=this.bones[e];r&&r.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){let r=this.bones[e];r&&(r.parent&&r.parent.isBone?(r.matrix.copy(r.parent.matrixWorld).invert(),r.matrix.multiply(r.matrixWorld)):r.matrix.copy(r.matrixWorld),r.matrix.decompose(r.position,r.quaternion,r.scale))}}update(){let e=this.bones,t=this.boneInverses,r=this.boneMatrices,i=this.boneTexture;for(let n=0,s=e.length;n<s;n++){let a=e[n]?e[n].matrixWorld:IK;QT.multiplyMatrices(a,t[n]),QT.toArray(r,n*16)}i!==null&&(i.needsUpdate=!0)}clone(){return new T3(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=uR(e),e=Math.max(e,4);let t=new Float32Array(e*e*4);t.set(this.boneMatrices);let r=new _0(t,e,e,Wn,xn);return r.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=r,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,r=this.bones.length;t<r;t++){let i=this.bones[t];if(i.name===e)return i}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let r=0,i=e.bones.length;r<i;r++){let n=e.bones[r],s=t[n];s===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",n),s=new ER),this.bones.push(s),this.boneInverses.push(new _e().fromArray(e.boneInverses[r]))}return this.init(),this}toJSON(){let e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;let t=this.bones,r=this.boneInverses;for(let i=0,n=t.length;i<n;i++){let s=t[i];e.bones.push(s.uuid);let a=r[i];e.boneInverses.push(a.toArray())}return e}},OK=class extends nt{constructor(e,t,r,i=1){super(e,t,r),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){let e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}},Ll=class extends um{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new $e(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}},KT=new E,ZT=new E,$T=new _e,Rx=new hd,hg=new Mn,S0=class extends Vt{constructor(e=new it,t=new Ll){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,r=[0];for(let i=1,n=t.count;i<n;i++)KT.fromBufferAttribute(t,i-1),ZT.fromBufferAttribute(t,i),r[i]=r[i-1],r[i]+=KT.distanceTo(ZT);e.setAttribute("lineDistance",new Ne(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){let r=this.geometry,i=this.matrixWorld,n=e.params.Line.threshold,s=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),hg.copy(r.boundingSphere),hg.applyMatrix4(i),hg.radius+=n,e.ray.intersectsSphere(hg)===!1)return;$T.copy(i).invert(),Rx.copy(e.ray).applyMatrix4($T);let a=n/((this.scale.x+this.scale.y+this.scale.z)/3),o=a*a,l=new E,c=new E,u=new E,h=new E,d=this.isLineSegments?2:1,p=r.index,f=r.attributes.position;if(p!==null){let m=Math.max(0,s.start),g=Math.min(p.count,s.start+s.count);for(let v=m,y=g-1;v<y;v+=d){let x=p.getX(v),w=p.getX(v+1);if(l.fromBufferAttribute(f,x),c.fromBufferAttribute(f,w),Rx.distanceSqToSegment(l,c,h,u)>o)continue;h.applyMatrix4(this.matrixWorld);let b=e.ray.origin.distanceTo(h);b<e.near||b>e.far||t.push({distance:b,point:u.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}else{let m=Math.max(0,s.start),g=Math.min(f.count,s.start+s.count);for(let v=m,y=g-1;v<y;v+=d){if(l.fromBufferAttribute(f,v),c.fromBufferAttribute(f,v+1),Rx.distanceSqToSegment(l,c,h,u)>o)continue;h.applyMatrix4(this.matrixWorld);let x=e.ray.origin.distanceTo(h);x<e.near||x>e.far||t.push({distance:x,point:u.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let r=e[t[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,n=r.length;i<n;i++){let s=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=i}}}}},JT=new E,eP=new E,pm=class extends S0{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,r=[];for(let i=0,n=t.count;i<n;i+=2)JT.fromBufferAttribute(t,i),eP.fromBufferAttribute(t,i+1),r[i]=i===0?0:r[i-1],r[i+1]=r[i]+JT.distanceTo(eP);e.setAttribute("lineDistance",new Ne(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}},RK=class extends jr{constructor(e,t,r,i,n,s,a,o,l){super(e,t,r,i,n,s,a,o,l),this.isVideoTexture=!0,this.minFilter=s!==void 0?s:vt,this.magFilter=n!==void 0?n:vt,this.generateMipmaps=!1;let c=this;function u(){c.needsUpdate=!0,e.requestVideoFrameCallback(u)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(u)}clone(){return new this.constructor(this.image).copy(this)}update(){let e=this.image;!("requestVideoFrameCallback"in e)&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}},xa=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){let r=this.getUtoTmapping(e);return this.getPoint(r,t)}getPoints(e=5){let t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return t}getSpacedPoints(e=5){let t=[];for(let r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t}getLength(){let e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let t=[],r,i=this.getPoint(0),n=0;t.push(0);for(let s=1;s<=e;s++)r=this.getPoint(s/e),n+=r.distanceTo(i),t.push(n),i=r;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){let r=this.getLengths(),i=0,n=r.length,s;t?s=t:s=e*r[n-1];let a=0,o=n-1,l;for(;a<=o;)if(i=Math.floor(a+(o-a)/2),l=r[i]-s,l<0)a=i+1;else if(l>0)o=i-1;else{o=i;break}if(i=o,r[i]===s)return i/(n-1);let c=r[i],u=r[i+1]-c,h=(s-c)/u;return(i+h)/(n-1)}getTangent(e,t){let r=e-1e-4,i=e+1e-4;r<0&&(r=0),i>1&&(i=1);let n=this.getPoint(r),s=this.getPoint(i),a=t||(n.isVector2?new W:new E);return a.copy(s).sub(n).normalize(),a}getTangentAt(e,t){let r=this.getUtoTmapping(e);return this.getTangent(r,t)}computeFrenetFrames(e,t){let r=new E,i=[],n=[],s=[],a=new E,o=new _e;for(let d=0;d<=e;d++){let p=d/e;i[d]=this.getTangentAt(p,new E)}n[0]=new E,s[0]=new E;let l=Number.MAX_VALUE,c=Math.abs(i[0].x),u=Math.abs(i[0].y),h=Math.abs(i[0].z);c<=l&&(l=c,r.set(1,0,0)),u<=l&&(l=u,r.set(0,1,0)),h<=l&&r.set(0,0,1),a.crossVectors(i[0],r).normalize(),n[0].crossVectors(i[0],a),s[0].crossVectors(i[0],n[0]);for(let d=1;d<=e;d++){if(n[d]=n[d-1].clone(),s[d]=s[d-1].clone(),a.crossVectors(i[d-1],i[d]),a.length()>Number.EPSILON){a.normalize();let p=Math.acos(Fr(i[d-1].dot(i[d]),-1,1));n[d].applyMatrix4(o.makeRotationAxis(a,p))}s[d].crossVectors(i[d],n[d])}if(t===!0){let d=Math.acos(Fr(n[0].dot(n[e]),-1,1));d/=e,i[0].dot(a.crossVectors(n[0],n[e]))>0&&(d=-d);for(let p=1;p<=e;p++)n[p].applyMatrix4(o.makeRotationAxis(i[p],d*p)),s[p].crossVectors(i[p],n[p])}return{tangents:i,normals:n,binormals:s}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){let e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}},Uy=class extends xa{constructor(e=0,t=0,r=1,i=1,n=0,s=Math.PI*2,a=!1,o=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=r,this.yRadius=i,this.aStartAngle=n,this.aEndAngle=s,this.aClockwise=a,this.aRotation=o}getPoint(e,t){let r=t||new W,i=Math.PI*2,n=this.aEndAngle-this.aStartAngle,s=Math.abs(n)<Number.EPSILON;for(;n<0;)n+=i;for(;n>i;)n-=i;n<Number.EPSILON&&(s?n=0:n=i),this.aClockwise===!0&&!s&&(n===i?n=-i:n=n-i);let a=this.aStartAngle+e*n,o=this.aX+this.xRadius*Math.cos(a),l=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){let c=Math.cos(this.aRotation),u=Math.sin(this.aRotation),h=o-this.aX,d=l-this.aY;o=h*c-d*u+this.aX,l=h*u+d*c+this.aY}return r.set(o,l)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){let e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}},BK=class extends Uy{constructor(e,t,r,i,n,s){super(e,t,r,r,i,n,s),this.isArcCurve=!0,this.type="ArcCurve"}};function P3(){let e=0,t=0,r=0,i=0;function n(s,a,o,l){e=s,t=o,r=-3*s+3*a-2*o-l,i=2*s-2*a+o+l}return{initCatmullRom:function(s,a,o,l,c){n(a,o,c*(o-s),c*(l-a))},initNonuniformCatmullRom:function(s,a,o,l,c,u,h){let d=(a-s)/c-(o-s)/(c+u)+(o-a)/u,p=(o-a)/u-(l-a)/(u+h)+(l-o)/h;d*=u,p*=u,n(a,o,d,p)},calc:function(s){let a=s*s,o=a*s;return e+t*s+r*a+i*o}}}var ug=new E,Bx=new P3,zx=new P3,kx=new P3,zK=class extends xa{constructor(e=[],t=!1,r="centripetal",i=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=r,this.tension=i}getPoint(e,t=new E){let r=t,i=this.points,n=i.length,s=(n-(this.closed?0:1))*e,a=Math.floor(s),o=s-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/n)+1)*n:o===0&&a===n-1&&(a=n-2,o=1);let l,c;this.closed||a>0?l=i[(a-1)%n]:(ug.subVectors(i[0],i[1]).add(i[0]),l=ug);let u=i[a%n],h=i[(a+1)%n];if(this.closed||a+2<n?c=i[(a+2)%n]:(ug.subVectors(i[n-1],i[n-2]).add(i[n-1]),c=ug),this.curveType==="centripetal"||this.curveType==="chordal"){let d=this.curveType==="chordal"?.5:.25,p=Math.pow(l.distanceToSquared(u),d),f=Math.pow(u.distanceToSquared(h),d),m=Math.pow(h.distanceToSquared(c),d);f<1e-4&&(f=1),p<1e-4&&(p=f),m<1e-4&&(m=f),Bx.initNonuniformCatmullRom(l.x,u.x,h.x,c.x,p,f,m),zx.initNonuniformCatmullRom(l.y,u.y,h.y,c.y,p,f,m),kx.initNonuniformCatmullRom(l.z,u.z,h.z,c.z,p,f,m)}else this.curveType==="catmullrom"&&(Bx.initCatmullRom(l.x,u.x,h.x,c.x,this.tension),zx.initCatmullRom(l.y,u.y,h.y,c.y,this.tension),kx.initCatmullRom(l.z,u.z,h.z,c.z,this.tension));return r.set(Bx.calc(o),zx.calc(o),kx.calc(o)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){let i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let i=e.points[t];this.points.push(new E().fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}};function tP(e,t,r,i,n){let s=(i-t)*.5,a=(n-r)*.5,o=e*e,l=e*o;return(2*r-2*i+s+a)*l+(-3*r+3*i-2*s-a)*o+s*e+r}function kK(e,t){let r=1-e;return r*r*t}function NK(e,t){return 2*(1-e)*e*t}function FK(e,t){return e*e*t}function Zp(e,t,r,i){return kK(e,t)+NK(e,r)+FK(e,i)}function UK(e,t){let r=1-e;return r*r*r*t}function jK(e,t){let r=1-e;return 3*r*r*e*t}function VK(e,t){return 3*(1-e)*e*e*t}function HK(e,t){return e*e*e*t}function $p(e,t,r,i,n){return UK(e,t)+jK(e,r)+VK(e,i)+HK(e,n)}var bs=class extends xa{constructor(t=new W,r=new W,i=new W,n=new W){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=t,this.v1=r,this.v2=i,this.v3=n}getPoint(t,r=new W){let i=r,n=this.v0,s=this.v1,a=this.v2,o=this.v3;return i.set($p(t,n.x,s.x,a.x,o.x),$p(t,n.y,s.y,a.y,o.y)),i}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){let t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}},Ev=class extends xa{constructor(e=new E,t=new E,r=new E,i=new E){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=r,this.v3=i}getPoint(e,t=new E){let r=t,i=this.v0,n=this.v1,s=this.v2,a=this.v3;return r.set($p(e,i.x,n.x,s.x,a.x),$p(e,i.y,n.y,s.y,a.y),$p(e,i.z,n.z,s.z,a.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},Ts=class extends xa{constructor(t=new W,r=new W){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=t,this.v2=r}getPoint(t,r=new W){let i=r;return t===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(t).add(this.v1)),i}getPointAt(t,r){return this.getPoint(t,r)}getTangent(t,r){let i=r||new W;return i.copy(this.v2).sub(this.v1).normalize(),i}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){let t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}},TR=class extends xa{constructor(e=new E,t=new E){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new E){let r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},Sl=class extends xa{constructor(e=new W,t=new W,r=new W){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new W){let r=t,i=this.v0,n=this.v1,s=this.v2;return r.set(Zp(e,i.x,n.x,s.x),Zp(e,i.y,n.y,s.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},GK=class extends xa{constructor(e=new E,t=new E,r=new E){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new E){let r=t,i=this.v0,n=this.v1,s=this.v2;return r.set(Zp(e,i.x,n.x,s.x),Zp(e,i.y,n.y,s.y),Zp(e,i.z,n.z,s.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},D3=class extends xa{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new W){let r=t,i=this.points,n=(i.length-1)*e,s=Math.floor(n),a=n-s,o=i[s===0?s:s-1],l=i[s],c=i[s>i.length-2?i.length-1:s+1],u=i[s>i.length-3?i.length-1:s+2];return r.set(tP(a,o.x,l.x,c.x,u.x),tP(a,o.y,l.y,c.y,u.y)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let i=e.points[t];this.points.push(i.clone())}return this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){let i=this.points[t];e.points.push(i.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let i=e.points[t];this.points.push(new W().fromArray(i))}return this}},WK=Object.freeze({__proto__:null,ArcCurve:BK,CatmullRomCurve3:zK,CubicBezierCurve:bs,CubicBezierCurve3:Ev,EllipseCurve:Uy,LineCurve:Ts,LineCurve3:TR,QuadraticBezierCurve:Sl,QuadraticBezierCurve3:GK,SplineCurve:D3}),PR=class extends xa{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){let e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Ts(t,e))}getPoint(e,t){let r=e*this.getLength(),i=this.getCurveLengths(),n=0;for(;n<i.length;){if(i[n]>=r){let s=i[n]-r,a=this.curves[n],o=a.getLength(),l=o===0?0:1-s/o;return a.getPointAt(l,t)}n++}return null}getLength(){let e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let e=[],t=0;for(let r=0,i=this.curves.length;r<i;r++)t+=this.curves[r].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){let t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){let t=[],r;for(let i=0,n=this.curves;i<n.length;i++){let s=n[i],a=s.isEllipseCurve?e*2:s.isLineCurve||s.isLineCurve3?1:s.isSplineCurve?e*s.points.length:e,o=s.getPoints(a);for(let l=0;l<o.length;l++){let c=o[l];r&&r.equals(c)||(t.push(c),r=c)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){let i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}toJSON(){let e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,r=this.curves.length;t<r;t++){let i=this.curves[t];e.curves.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){let i=e.curves[t];this.curves.push(new WK[i.type]().fromJSON(i))}return this}},A0=class extends PR{constructor(e){super(),this.type="Path",this.currentPoint=new W,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){let r=new Ts(this.currentPoint.clone(),new W(e,t));return this.curves.push(r),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,r,i){let n=new Sl(this.currentPoint.clone(),new W(e,t),new W(r,i));return this.curves.push(n),this.currentPoint.set(r,i),this}bezierCurveTo(e,t,r,i,n,s){let a=new bs(this.currentPoint.clone(),new W(e,t),new W(r,i),new W(n,s));return this.curves.push(a),this.currentPoint.set(n,s),this}splineThru(e){let t=[this.currentPoint.clone()].concat(e),r=new D3(t);return this.curves.push(r),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,r,i,n,s){let a=this.currentPoint.x,o=this.currentPoint.y;return this.absarc(e+a,t+o,r,i,n,s),this}absarc(e,t,r,i,n,s){return this.absellipse(e,t,r,r,i,n,s),this}ellipse(e,t,r,i,n,s,a,o){let l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+l,t+c,r,i,n,s,a,o),this}absellipse(e,t,r,i,n,s,a,o){let l=new Uy(e,t,r,i,n,s,a,o);if(this.curves.length>0){let u=l.getPoint(0);u.equals(this.currentPoint)||this.lineTo(u.x,u.y)}this.curves.push(l);let c=l.getPoint(1);return this.currentPoint.copy(c),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){let e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}},DR=class extends it{constructor(e=[new W(0,-.5),new W(.5,0),new W(0,.5)],t=12,r=0,i=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:i},t=Math.floor(t),i=Fr(i,0,Math.PI*2);let n=[],s=[],a=[],o=[],l=[],c=1/t,u=new E,h=new W,d=new E,p=new E,f=new E,m=0,g=0;for(let v=0;v<=e.length-1;v++)switch(v){case 0:m=e[v+1].x-e[v].x,g=e[v+1].y-e[v].y,d.x=g*1,d.y=-m,d.z=g*0,f.copy(d),d.normalize(),o.push(d.x,d.y,d.z);break;case e.length-1:o.push(f.x,f.y,f.z);break;default:m=e[v+1].x-e[v].x,g=e[v+1].y-e[v].y,d.x=g*1,d.y=-m,d.z=g*0,p.copy(d),d.x+=f.x,d.y+=f.y,d.z+=f.z,d.normalize(),o.push(d.x,d.y,d.z),f.copy(p)}for(let v=0;v<=t;v++){let y=r+v*c*i,x=Math.sin(y),w=Math.cos(y);for(let b=0;b<=e.length-1;b++){u.x=e[b].x*x,u.y=e[b].y,u.z=e[b].x*w,s.push(u.x,u.y,u.z),h.x=v/t,h.y=b/(e.length-1),a.push(h.x,h.y);let _=o[3*b+0]*x,A=o[3*b+1],S=o[3*b+0]*w;l.push(_,A,S)}}for(let v=0;v<t;v++)for(let y=0;y<e.length-1;y++){let x=y+v*e.length,w=x,b=x+e.length,_=x+e.length+1,A=x+1;n.push(w,b,A),n.push(_,A,b)}this.setIndex(n),this.setAttribute("position",new Ne(s,3)),this.setAttribute("uv",new Ne(a,2)),this.setAttribute("normal",new Ne(l,3))}static fromJSON(e){return new DR(e.points,e.segments,e.phiStart,e.phiLength)}},L3=class extends it{constructor(e=1,t=1,r=1,i=32,n=1,s=!1,a=0,o=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:i,heightSegments:n,openEnded:s,thetaStart:a,thetaLength:o};let l=this;i=Math.floor(i),n=Math.floor(n);let c=[],u=[],h=[],d=[],p=0,f=[],m=r/2,g=0;v(),s===!1&&(e>0&&y(!0),t>0&&y(!1)),this.setIndex(c),this.setAttribute("position",new Ne(u,3)),this.setAttribute("normal",new Ne(h,3)),this.setAttribute("uv",new Ne(d,2));function v(){let x=new E,w=new E,b=0,_=(t-e)/r;for(let A=0;A<=n;A++){let S=[],C=A/n,M=C*(t-e)+e;for(let T=0;T<=i;T++){let P=T/i,D=P*o+a,I=Math.sin(D),B=Math.cos(D);w.x=M*I,w.y=-C*r+m,w.z=M*B,u.push(w.x,w.y,w.z),x.set(I,_,B).normalize(),h.push(x.x,x.y,x.z),d.push(P,1-C),S.push(p++)}f.push(S)}for(let A=0;A<i;A++)for(let S=0;S<n;S++){let C=f[S][A],M=f[S+1][A],T=f[S+1][A+1],P=f[S][A+1];c.push(C,M,P),c.push(M,T,P),b+=6}l.addGroup(g,b,0),g+=b}function y(x){let w=p,b=new W,_=new E,A=0,S=x===!0?e:t,C=x===!0?1:-1;for(let T=1;T<=i;T++)u.push(0,m*C,0),h.push(0,C,0),d.push(.5,.5),p++;let M=p;for(let T=0;T<=i;T++){let P=T/i*o+a,D=Math.cos(P),I=Math.sin(P);_.x=S*I,_.y=m*C,_.z=S*D,u.push(_.x,_.y,_.z),h.push(0,C,0),b.x=D*.5+.5,b.y=I*.5*C+.5,d.push(b.x,b.y),p++}for(let T=0;T<i;T++){let P=w+T,D=M+T;x===!0?c.push(D,D+1,P):c.push(D+1,D,P),A+=3}l.addGroup(g,A,x===!0?1:2),g+=A}}static fromJSON(e){return new L3(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}},LR=class extends L3{constructor(e=1,t=1,r=32,i=1,n=!1,s=0,a=Math.PI*2){super(0,e,t,r,i,n,s,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:i,openEnded:n,thetaStart:s,thetaLength:a}}static fromJSON(e){return new LR(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}},I3=class extends it{constructor(e=[],t=[],r=1,i=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:i};let n=[],s=[];a(i),l(r),c(),this.setAttribute("position",new Ne(n,3)),this.setAttribute("normal",new Ne(n.slice(),3)),this.setAttribute("uv",new Ne(s,2)),i===0?this.computeVertexNormals():this.normalizeNormals();function a(v){let y=new E,x=new E,w=new E;for(let b=0;b<t.length;b+=3)d(t[b+0],y),d(t[b+1],x),d(t[b+2],w),o(y,x,w,v)}function o(v,y,x,w){let b=w+1,_=[];for(let A=0;A<=b;A++){_[A]=[];let S=v.clone().lerp(x,A/b),C=y.clone().lerp(x,A/b),M=b-A;for(let T=0;T<=M;T++)T===0&&A===b?_[A][T]=S:_[A][T]=S.clone().lerp(C,T/M)}for(let A=0;A<b;A++)for(let S=0;S<2*(b-A)-1;S++){let C=Math.floor(S/2);S%2===0?(h(_[A][C+1]),h(_[A+1][C]),h(_[A][C])):(h(_[A][C+1]),h(_[A+1][C+1]),h(_[A+1][C]))}}function l(v){let y=new E;for(let x=0;x<n.length;x+=3)y.x=n[x+0],y.y=n[x+1],y.z=n[x+2],y.normalize().multiplyScalar(v),n[x+0]=y.x,n[x+1]=y.y,n[x+2]=y.z}function c(){let v=new E;for(let y=0;y<n.length;y+=3){v.x=n[y+0],v.y=n[y+1],v.z=n[y+2];let x=m(v)/2/Math.PI+.5,w=g(v)/Math.PI+.5;s.push(x,1-w)}p(),u()}function u(){for(let v=0;v<s.length;v+=6){let y=s[v+0],x=s[v+2],w=s[v+4],b=Math.max(y,x,w),_=Math.min(y,x,w);b>.9&&_<.1&&(y<.2&&(s[v+0]+=1),x<.2&&(s[v+2]+=1),w<.2&&(s[v+4]+=1))}}function h(v){n.push(v.x,v.y,v.z)}function d(v,y){let x=v*3;y.x=e[x+0],y.y=e[x+1],y.z=e[x+2]}function p(){let v=new E,y=new E,x=new E,w=new E,b=new W,_=new W,A=new W;for(let S=0,C=0;S<n.length;S+=9,C+=6){v.set(n[S+0],n[S+1],n[S+2]),y.set(n[S+3],n[S+4],n[S+5]),x.set(n[S+6],n[S+7],n[S+8]),b.set(s[C+0],s[C+1]),_.set(s[C+2],s[C+3]),A.set(s[C+4],s[C+5]),w.copy(v).add(y).add(x).divideScalar(3);let M=m(w);f(b,C+0,v,M),f(_,C+2,y,M),f(A,C+4,x,M)}}function f(v,y,x,w){w<0&&v.x===1&&(s[y]=v.x-1),x.x===0&&x.z===0&&(s[y]=w/2/Math.PI+.5)}function m(v){return Math.atan2(v.z,-v.x)}function g(v){return Math.atan2(-v.y,Math.sqrt(v.x*v.x+v.z*v.z))}}static fromJSON(e){return new I3(e.vertices,e.indices,e.radius,e.details)}},IR=class extends I3{constructor(e=1,t=0){let r=(1+Math.sqrt(5))/2,i=1/r,n=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-r,0,-i,r,0,i,-r,0,i,r,-i,-r,0,-i,r,0,i,-r,0,i,r,0,-r,0,-i,r,0,-i,-r,0,i,r,0,i],s=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(n,s,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new IR(e.radius,e.detail)}},C0=class extends A0{constructor(e){super(e),this.uuid=Kn(),this.type="Shape",this.holes=[]}getPointsHoles(e){let t=[];for(let r=0,i=this.holes.length;r<i;r++)t[r]=this.holes[r].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){let i=e.holes[t];this.holes.push(i.clone())}return this}toJSON(){let e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,r=this.holes.length;t<r;t++){let i=this.holes[t];e.holes.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){let i=e.holes[t];this.holes.push(new A0().fromJSON(i))}return this}},qK={triangulate:function(e,t,r=2){let i=t&&t.length,n=i?t[0]*r:e.length,s=OR(e,0,n,r,!0),a=[];if(!s||s.next===s.prev)return a;let o,l,c,u,h,d,p;if(i&&(s=ZK(e,t,s,r)),e.length>80*r){o=c=e[0],l=u=e[1];for(let f=r;f<n;f+=r)h=e[f],d=e[f+1],h<o&&(o=h),d<l&&(l=d),h>c&&(c=h),d>u&&(u=d);p=Math.max(c-o,u-l),p=p!==0?32767/p:0}return Rf(s,a,r,o,l,p,0),a}};function OR(e,t,r,i,n){let s,a;if(n===lZ(e,t,r,i)>0)for(s=t;s<r;s+=i)a=rP(s,e[s],e[s+1],a);else for(s=r-i;s>=t;s-=i)a=rP(s,e[s],e[s+1],a);return a&&jy(a,a.next)&&(zf(a),a=a.next),a}function Rc(e,t){if(!e)return e;t||(t=e);let r=e,i;do if(i=!1,!r.steiner&&(jy(r,r.next)||ar(r.prev,r,r.next)===0)){if(zf(r),r=t=r.prev,r===r.next)break;i=!0}else r=r.next;while(i||r!==t);return t}function Rf(e,t,r,i,n,s,a){if(!e)return;!a&&s&&rZ(e,i,n,s);let o=e,l,c;for(;e.prev!==e.next;){if(l=e.prev,c=e.next,s?YK(e,i,n,s):XK(e)){t.push(l.i/r|0),t.push(e.i/r|0),t.push(c.i/r|0),zf(e),e=c.next,o=c.next;continue}if(e=c,e===o){a?a===1?(e=QK(Rc(e),t,r),Rf(e,t,r,i,n,s,2)):a===2&&KK(e,t,r,i,n,s):Rf(Rc(e),t,r,i,n,s,1);break}}}function XK(e){let t=e.prev,r=e,i=e.next;if(ar(t,r,i)>=0)return!1;let n=t.x,s=r.x,a=i.x,o=t.y,l=r.y,c=i.y,u=n<s?n<a?n:a:s<a?s:a,h=o<l?o<c?o:c:l<c?l:c,d=n>s?n>a?n:a:s>a?s:a,p=o>l?o>c?o:c:l>c?l:c,f=i.next;for(;f!==t;){if(f.x>=u&&f.x<=d&&f.y>=h&&f.y<=p&&iu(n,o,s,l,a,c,f.x,f.y)&&ar(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function YK(e,t,r,i){let n=e.prev,s=e,a=e.next;if(ar(n,s,a)>=0)return!1;let o=n.x,l=s.x,c=a.x,u=n.y,h=s.y,d=a.y,p=o<l?o<c?o:c:l<c?l:c,f=u<h?u<d?u:d:h<d?h:d,m=o>l?o>c?o:c:l>c?l:c,g=u>h?u>d?u:d:h>d?h:d,v=v2(p,f,t,r,i),y=v2(m,g,t,r,i),x=e.prevZ,w=e.nextZ;for(;x&&x.z>=v&&w&&w.z<=y;){if(x.x>=p&&x.x<=m&&x.y>=f&&x.y<=g&&x!==n&&x!==a&&iu(o,u,l,h,c,d,x.x,x.y)&&ar(x.prev,x,x.next)>=0||(x=x.prevZ,w.x>=p&&w.x<=m&&w.y>=f&&w.y<=g&&w!==n&&w!==a&&iu(o,u,l,h,c,d,w.x,w.y)&&ar(w.prev,w,w.next)>=0))return!1;w=w.nextZ}for(;x&&x.z>=v;){if(x.x>=p&&x.x<=m&&x.y>=f&&x.y<=g&&x!==n&&x!==a&&iu(o,u,l,h,c,d,x.x,x.y)&&ar(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;w&&w.z<=y;){if(w.x>=p&&w.x<=m&&w.y>=f&&w.y<=g&&w!==n&&w!==a&&iu(o,u,l,h,c,d,w.x,w.y)&&ar(w.prev,w,w.next)>=0)return!1;w=w.nextZ}return!0}function QK(e,t,r){let i=e;do{let n=i.prev,s=i.next.next;!jy(n,s)&&RR(n,i,i.next,s)&&Bf(n,s)&&Bf(s,n)&&(t.push(n.i/r|0),t.push(i.i/r|0),t.push(s.i/r|0),zf(i),zf(i.next),i=e=s),i=i.next}while(i!==e);return Rc(i)}function KK(e,t,r,i,n,s){let a=e;do{let o=a.next.next;for(;o!==a.prev;){if(a.i!==o.i&&sZ(a,o)){let l=BR(a,o);a=Rc(a,a.next),l=Rc(l,l.next),Rf(a,t,r,i,n,s,0),Rf(l,t,r,i,n,s,0);return}o=o.next}a=a.next}while(a!==e)}function ZK(e,t,r,i){let n=[],s,a,o,l,c;for(s=0,a=t.length;s<a;s++)o=t[s]*i,l=s<a-1?t[s+1]*i:e.length,c=OR(e,o,l,i,!1),c===c.next&&(c.steiner=!0),n.push(nZ(c));for(n.sort($K),s=0;s<n.length;s++)r=JK(n[s],r);return r}function $K(e,t){return e.x-t.x}function JK(e,t){let r=eZ(e,t);if(!r)return t;let i=BR(r,e);return Rc(i,i.next),Rc(r,r.next)}function eZ(e,t){let r=t,i=-1/0,n,s=e.x,a=e.y;do{if(a<=r.y&&a>=r.next.y&&r.next.y!==r.y){let d=r.x+(a-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(d<=s&&d>i&&(i=d,n=r.x<r.next.x?r:r.next,d===s))return n}r=r.next}while(r!==t);if(!n)return null;let o=n,l=n.x,c=n.y,u=1/0,h;r=n;do s>=r.x&&r.x>=l&&s!==r.x&&iu(a<c?s:i,a,l,c,a<c?i:s,a,r.x,r.y)&&(h=Math.abs(a-r.y)/(s-r.x),Bf(r,e)&&(h<u||h===u&&(r.x>n.x||r.x===n.x&&tZ(n,r)))&&(n=r,u=h)),r=r.next;while(r!==o);return n}function tZ(e,t){return ar(e.prev,e,t.prev)<0&&ar(t.next,e,e.next)<0}function rZ(e,t,r,i){let n=e;do n.z===0&&(n.z=v2(n.x,n.y,t,r,i)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==e);n.prevZ.nextZ=null,n.prevZ=null,iZ(n)}function iZ(e){let t,r,i,n,s,a,o,l,c=1;do{for(r=e,e=null,s=null,a=0;r;){for(a++,i=r,o=0,t=0;t<c&&(o++,i=i.nextZ,!!i);t++);for(l=c;o>0||l>0&&i;)o!==0&&(l===0||!i||r.z<=i.z)?(n=r,r=r.nextZ,o--):(n=i,i=i.nextZ,l--),s?s.nextZ=n:e=n,n.prevZ=s,s=n;r=i}s.nextZ=null,c*=2}while(a>1);return e}function v2(e,t,r,i,n){return e=(e-r)*n|0,t=(t-i)*n|0,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function nZ(e){let t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e);return r}function iu(e,t,r,i,n,s,a,o){return(n-a)*(t-o)>=(e-a)*(s-o)&&(e-a)*(i-o)>=(r-a)*(t-o)&&(r-a)*(s-o)>=(n-a)*(i-o)}function sZ(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!aZ(e,t)&&(Bf(e,t)&&Bf(t,e)&&oZ(e,t)&&(ar(e.prev,e,t.prev)||ar(e,t.prev,t))||jy(e,t)&&ar(e.prev,e,e.next)>0&&ar(t.prev,t,t.next)>0)}function ar(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function jy(e,t){return e.x===t.x&&e.y===t.y}function RR(e,t,r,i){let n=pg(ar(e,t,r)),s=pg(ar(e,t,i)),a=pg(ar(r,i,e)),o=pg(ar(r,i,t));return!!(n!==s&&a!==o||n===0&&dg(e,r,t)||s===0&&dg(e,i,t)||a===0&&dg(r,e,i)||o===0&&dg(r,t,i))}function dg(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function pg(e){return e>0?1:e<0?-1:0}function aZ(e,t){let r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&RR(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}function Bf(e,t){return ar(e.prev,e,e.next)<0?ar(e,t,e.next)>=0&&ar(e,e.prev,t)>=0:ar(e,t,e.prev)<0||ar(e,e.next,t)<0}function oZ(e,t){let r=e,i=!1,n=(e.x+t.x)/2,s=(e.y+t.y)/2;do r.y>s!=r.next.y>s&&r.next.y!==r.y&&n<(r.next.x-r.x)*(s-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next;while(r!==e);return i}function BR(e,t){let r=new y2(e.i,e.x,e.y),i=new y2(t.i,t.x,t.y),n=e.next,s=t.prev;return e.next=t,t.prev=e,r.next=n,n.prev=r,i.next=r,r.prev=i,s.next=i,i.prev=s,i}function rP(e,t,r,i){let n=new y2(e,t,r);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function zf(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function y2(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function lZ(e,t,r,i){let n=0;for(let s=t,a=r-i;s<r;s+=i)n+=(e[a]-e[s])*(e[s+1]+e[a+1]),a=s;return n}var zR=class{static area(e){let t=e.length,r=0;for(let i=t-1,n=0;n<t;i=n++)r+=e[i].x*e[n].y-e[n].x*e[i].y;return r*.5}static isClockWise(e){return zR.area(e)<0}static triangulateShape(e,t){let r=[],i=[],n=[];iP(e),nP(r,e);let s=e.length;t.forEach(iP);for(let o=0;o<t.length;o++)i.push(s),s+=t[o].length,nP(r,t[o]);let a=qK.triangulate(r,i);for(let o=0;o<a.length;o+=3)n.push(a.slice(o,o+3));return n}};function iP(e){let t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function nP(e,t){for(let r=0;r<t.length;r++)e.push(t[r].x),e.push(t[r].y)}var kR=class extends I3{constructor(e=1,t=0){let r=(1+Math.sqrt(5))/2,i=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],n=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(i,n,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new kR(e.radius,e.detail)}},O3=class extends it{constructor(e=1,t=32,r=16,i=0,n=Math.PI*2,s=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:i,phiLength:n,thetaStart:s,thetaLength:a},t=Math.max(3,Math.floor(t)),r=Math.max(2,Math.floor(r));let o=Math.min(s+a,Math.PI),l=0,c=[],u=new E,h=new E,d=[],p=[],f=[],m=[];for(let g=0;g<=r;g++){let v=[],y=g/r,x=0;g==0&&s==0?x=.5/t:g==r&&o==Math.PI&&(x=-.5/t);for(let w=0;w<=t;w++){let b=w/t;u.x=-e*Math.cos(i+b*n)*Math.sin(s+y*a),u.y=e*Math.cos(s+y*a),u.z=e*Math.sin(i+b*n)*Math.sin(s+y*a),p.push(u.x,u.y,u.z),h.copy(u).normalize(),f.push(h.x,h.y,h.z),m.push(b+x,1-y),v.push(l++)}c.push(v)}for(let g=0;g<r;g++)for(let v=0;v<t;v++){let y=c[g][v+1],x=c[g][v],w=c[g+1][v],b=c[g+1][v+1];(g!==0||s>0)&&d.push(y,x,b),(g!==r-1||o<Math.PI)&&d.push(x,w,b)}this.setIndex(d),this.setAttribute("position",new Ne(p,3)),this.setAttribute("normal",new Ne(f,3)),this.setAttribute("uv",new Ne(m,2))}static fromJSON(e){return new O3(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}},NR=class extends it{constructor(e=1,t=.4,r=64,i=8,n=2,s=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:i,p:n,q:s},r=Math.floor(r),i=Math.floor(i);let a=[],o=[],l=[],c=[],u=new E,h=new E,d=new E,p=new E,f=new E,m=new E,g=new E;for(let y=0;y<=r;++y){let x=y/r*n*Math.PI*2;v(x,n,s,e,d),v(x+.01,n,s,e,p),m.subVectors(p,d),g.addVectors(p,d),f.crossVectors(m,g),g.crossVectors(f,m),f.normalize(),g.normalize();for(let w=0;w<=i;++w){let b=w/i*Math.PI*2,_=-t*Math.cos(b),A=t*Math.sin(b);u.x=d.x+(_*g.x+A*f.x),u.y=d.y+(_*g.y+A*f.y),u.z=d.z+(_*g.z+A*f.z),o.push(u.x,u.y,u.z),h.subVectors(u,d).normalize(),l.push(h.x,h.y,h.z),c.push(y/r),c.push(w/i)}}for(let y=1;y<=r;y++)for(let x=1;x<=i;x++){let w=(i+1)*(y-1)+(x-1),b=(i+1)*y+(x-1),_=(i+1)*y+x,A=(i+1)*(y-1)+x;a.push(w,b,A),a.push(b,_,A)}this.setIndex(a),this.setAttribute("position",new Ne(o,3)),this.setAttribute("normal",new Ne(l,3)),this.setAttribute("uv",new Ne(c,2));function v(y,x,w,b,_){let A=Math.cos(y),S=Math.sin(y),C=w/x*y,M=Math.cos(C);_.x=b*(2+M)*.5*A,_.y=b*(2+M)*S*.5,_.z=b*Math.sin(C)*.5}}static fromJSON(e){return new NR(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}};function Ao(e,t,r){return FR(e)?new e.constructor(e.subarray(t,r!==void 0?r:e.length)):e.slice(t,r)}function fg(e,t,r){return!e||!r&&e.constructor===t?e:typeof t.BYTES_PER_ELEMENT=="number"?new t(e):Array.prototype.slice.call(e)}function FR(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function cZ(e){function t(n,s){return e[n]-e[s]}let r=e.length,i=new Array(r);for(let n=0;n!==r;++n)i[n]=n;return i.sort(t),i}function sP(e,t,r){let i=e.length,n=new e.constructor(i);for(let s=0,a=0;a!==i;++s){let o=r[s]*t;for(let l=0;l!==t;++l)n[a++]=e[o+l]}return n}function UR(e,t,r,i){let n=1,s=e[0];for(;s!==void 0&&s[i]===void 0;)s=e[n++];if(s===void 0)return;let a=s[i];if(a!==void 0)if(Array.isArray(a))do a=s[i],a!==void 0&&(t.push(s.time),r.push.apply(r,a)),s=e[n++];while(s!==void 0);else if(a.toArray!==void 0)do a=s[i],a!==void 0&&(t.push(s.time),a.toArray(r,r.length)),s=e[n++];while(s!==void 0);else do a=s[i],a!==void 0&&(t.push(s.time),r.push(a)),s=e[n++];while(s!==void 0)}var Vy=class{constructor(e,t,r,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new t.constructor(r),this.sampleValues=t,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(e){let t=this.parameterPositions,r=this._cachedIndex,i=t[r],n=t[r-1];e:{t:{let s;r:{i:if(!(e<i)){for(let a=r+2;;){if(i===void 0){if(e<n)break i;return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}if(r===a)break;if(n=i,i=t[++r],e<i)break t}s=t.length;break r}if(!(e>=n)){let a=t[1];e<a&&(r=2,n=a);for(let o=r-2;;){if(n===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===o)break;if(i=n,n=t[--r-1],e>=n)break t}s=r,r=0;break r}break e}for(;r<s;){let a=r+s>>>1;e<t[a]?s=a:r=a+1}if(i=t[r],n=t[r-1],n===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===void 0)return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}this._cachedIndex=r,this.intervalChanged_(r,n,i)}return this.interpolate_(r,n,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){let t=this.resultBuffer,r=this.sampleValues,i=this.valueSize,n=e*i;for(let s=0;s!==i;++s)t[s]=r[n+s];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}},hZ=class extends Vy{constructor(e,t,r,i){super(e,t,r,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Jh,endingEnd:Jh}}intervalChanged_(e,t,r){let i=this.parameterPositions,n=e-2,s=e+1,a=i[n],o=i[s];if(a===void 0)switch(this.getSettings_().endingStart){case eu:n=e,a=2*t-r;break;case y0:n=i.length-2,a=t+i[n]-i[n+1];break;default:n=e,a=r}if(o===void 0)switch(this.getSettings_().endingEnd){case eu:s=e,o=2*r-t;break;case y0:s=1,o=r+i[1]-i[0];break;default:s=e-1,o=t}let l=(r-t)*.5,c=this.valueSize;this._weightPrev=l/(t-a),this._weightNext=l/(o-r),this._offsetPrev=n*c,this._offsetNext=s*c}interpolate_(e,t,r,i){let n=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=e*a,l=o-a,c=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,d=this._weightNext,p=(r-t)/(i-t),f=p*p,m=f*p,g=-h*m+2*h*f-h*p,v=(1+h)*m+(-1.5-2*h)*f+(-.5+h)*p+1,y=(-1-d)*m+(1.5+d)*f+.5*p,x=d*m-d*f;for(let w=0;w!==a;++w)n[w]=g*s[c+w]+v*s[l+w]+y*s[o+w]+x*s[u+w];return n}},jR=class extends Vy{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e,t,r,i){let n=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=e*a,l=o-a,c=(r-t)/(i-t),u=1-c;for(let h=0;h!==a;++h)n[h]=s[l+h]*u+s[o+h]*c;return n}},uZ=class extends Vy{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e){return this.copySampleValue_(e-1)}},wa=class{constructor(e,t,r,i){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=fg(t,this.TimeBufferType),this.values=fg(r,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){let t=e.constructor,r;if(t.toJSON!==this.toJSON)r=t.toJSON(e);else{r={name:e.name,times:fg(e.times,Array),values:fg(e.values,Array)};let i=e.getInterpolation();i!==e.DefaultInterpolation&&(r.interpolation=i)}return r.type=e.ValueTypeName,r}InterpolantFactoryMethodDiscrete(e){return new uZ(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new jR(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new hZ(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case g0:t=this.InterpolantFactoryMethodDiscrete;break;case v0:t=this.InterpolantFactoryMethodLinear;break;case lx:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){let r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(r);return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return g0;case this.InterpolantFactoryMethodLinear:return v0;case this.InterpolantFactoryMethodSmooth:return lx}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){let t=this.times;for(let r=0,i=t.length;r!==i;++r)t[r]+=e}return this}scale(e){if(e!==1){let t=this.times;for(let r=0,i=t.length;r!==i;++r)t[r]*=e}return this}trim(e,t){let r=this.times,i=r.length,n=0,s=i-1;for(;n!==i&&r[n]<e;)++n;for(;s!==-1&&r[s]>t;)--s;if(++s,n!==0||s!==i){n>=s&&(s=Math.max(s,1),n=s-1);let a=this.getValueSize();this.times=Ao(r,n,s),this.values=Ao(this.values,n*a,s*a)}return this}validate(){let e=!0,t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);let r=this.times,i=this.values,n=r.length;n===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let s=null;for(let a=0;a!==n;a++){let o=r[a];if(typeof o=="number"&&isNaN(o)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,o),e=!1;break}if(s!==null&&s>o){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,o,s),e=!1;break}s=o}if(i!==void 0&&FR(i))for(let a=0,o=i.length;a!==o;++a){let l=i[a];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,l),e=!1;break}}return e}optimize(){let e=Ao(this.times),t=Ao(this.values),r=this.getValueSize(),i=this.getInterpolation()===lx,n=e.length-1,s=1;for(let a=1;a<n;++a){let o=!1,l=e[a],c=e[a+1];if(l!==c&&(a!==1||l!==e[0]))if(i)o=!0;else{let u=a*r,h=u-r,d=u+r;for(let p=0;p!==r;++p){let f=t[u+p];if(f!==t[h+p]||f!==t[d+p]){o=!0;break}}}if(o){if(a!==s){e[s]=e[a];let u=a*r,h=s*r;for(let d=0;d!==r;++d)t[h+d]=t[u+d]}++s}}if(n>0){e[s]=e[n];for(let a=n*r,o=s*r,l=0;l!==r;++l)t[o+l]=t[a+l];++s}return s!==e.length?(this.times=Ao(e,0,s),this.values=Ao(t,0,s*r)):(this.times=e,this.values=t),this}clone(){let e=Ao(this.times,0),t=Ao(this.values,0),r=this.constructor,i=new r(this.name,e,t);return i.createInterpolant=this.createInterpolant,i}};wa.prototype.TimeBufferType=Float32Array;wa.prototype.ValueBufferType=Float32Array;wa.prototype.DefaultInterpolation=v0;var fd=class extends wa{};fd.prototype.ValueTypeName="bool";fd.prototype.ValueBufferType=Array;fd.prototype.DefaultInterpolation=g0;fd.prototype.InterpolantFactoryMethodLinear=void 0;fd.prototype.InterpolantFactoryMethodSmooth=void 0;var VR=class extends wa{};VR.prototype.ValueTypeName="color";var M0=class extends wa{};M0.prototype.ValueTypeName="number";var dZ=class extends Vy{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e,t,r,i){let n=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=(r-t)/(i-t),l=e*a;for(let c=l+a;l!==c;l+=4)ft.slerpFlat(n,0,s,l-a,s,l,o);return n}},fm=class extends wa{InterpolantFactoryMethodLinear(e){return new dZ(this.times,this.values,this.getValueSize(),e)}};fm.prototype.ValueTypeName="quaternion";fm.prototype.DefaultInterpolation=v0;fm.prototype.InterpolantFactoryMethodSmooth=void 0;var md=class extends wa{};md.prototype.ValueTypeName="string";md.prototype.ValueBufferType=Array;md.prototype.DefaultInterpolation=g0;md.prototype.InterpolantFactoryMethodLinear=void 0;md.prototype.InterpolantFactoryMethodSmooth=void 0;var E0=class extends wa{};E0.prototype.ValueTypeName="vector";var x2=class{constructor(e,t=-1,r,i=b3){this.name=e,this.tracks=r,this.duration=t,this.blendMode=i,this.uuid=Kn(),this.duration<0&&this.resetDuration()}static parse(e){let t=[],r=e.tracks,i=1/(e.fps||1);for(let s=0,a=r.length;s!==a;++s)t.push(fZ(r[s]).scale(i));let n=new this(e.name,e.duration,t,e.blendMode);return n.uuid=e.uuid,n}static toJSON(e){let t=[],r=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let n=0,s=r.length;n!==s;++n)t.push(wa.toJSON(r[n]));return i}static CreateFromMorphTargetSequence(e,t,r,i){let n=t.length,s=[];for(let a=0;a<n;a++){let o=[],l=[];o.push((a+n-1)%n,a,(a+1)%n),l.push(0,1,0);let c=cZ(o);o=sP(o,1,c),l=sP(l,1,c),!i&&o[0]===0&&(o.push(n),l.push(l[0])),s.push(new M0(".morphTargetInfluences["+t[a].name+"]",o,l).scale(1/r))}return new this(e,-1,s)}static findByName(e,t){let r=e;if(!Array.isArray(e)){let i=e;r=i.geometry&&i.geometry.animations||i.animations}for(let i=0;i<r.length;i++)if(r[i].name===t)return r[i];return null}static CreateClipsFromMorphTargetSequences(e,t,r){let i={},n=/^([\w-]*?)([\d]+)$/;for(let a=0,o=e.length;a<o;a++){let l=e[a],c=l.name.match(n);if(c&&c.length>1){let u=c[1],h=i[u];h||(i[u]=h=[]),h.push(l)}}let s=[];for(let a in i)s.push(this.CreateFromMorphTargetSequence(a,i[a],t,r));return s}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;let r=function(c,u,h,d,p){if(h.length!==0){let f=[],m=[];UR(h,f,m,d),f.length!==0&&p.push(new c(u,f,m))}},i=[],n=e.name||"default",s=e.fps||30,a=e.blendMode,o=e.length||-1,l=e.hierarchy||[];for(let c=0;c<l.length;c++){let u=l[c].keys;if(!(!u||u.length===0))if(u[0].morphTargets){let h={},d;for(d=0;d<u.length;d++)if(u[d].morphTargets)for(let p=0;p<u[d].morphTargets.length;p++)h[u[d].morphTargets[p]]=-1;for(let p in h){let f=[],m=[];for(let g=0;g!==u[d].morphTargets.length;++g){let v=u[d];f.push(v.time),m.push(v.morphTarget===p?1:0)}i.push(new M0(".morphTargetInfluence["+p+"]",f,m))}o=h.length*s}else{let h=".bones["+t[c].name+"]";r(E0,h+".position",u,"pos",i),r(fm,h+".quaternion",u,"rot",i),r(E0,h+".scale",u,"scl",i)}}return i.length===0?null:new this(n,o,i,a)}resetDuration(){let e=this.tracks,t=0;for(let r=0,i=e.length;r!==i;++r){let n=this.tracks[r];t=Math.max(t,n.times[n.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){let e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}};function pZ(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return M0;case"vector":case"vector2":case"vector3":case"vector4":return E0;case"color":return VR;case"quaternion":return fm;case"bool":case"boolean":return fd;case"string":return md}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}function fZ(e){if(e.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");let t=pZ(e.type);if(e.times===void 0){let r=[],i=[];UR(e.keys,r,i,"value"),e.times=r,e.values=i}return t.parse!==void 0?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}var aP={enabled:!1,files:{},add:function(e,t){this.enabled!==!1&&(this.files[e]=t)},get:function(e){if(this.enabled!==!1)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}},HR=class{constructor(e,t,r){let i=this,n=!1,s=0,a=0,o,l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(c){a++,n===!1&&i.onStart!==void 0&&i.onStart(c,s,a),n=!0},this.itemEnd=function(c){s++,i.onProgress!==void 0&&i.onProgress(c,s,a),s===a&&(n=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(c){i.onError!==void 0&&i.onError(c)},this.resolveURL=function(c){return o?o(c):c},this.setURLModifier=function(c){return o=c,this},this.addHandler=function(c,u){return l.push(c,u),this},this.removeHandler=function(c){let u=l.indexOf(c);return u!==-1&&l.splice(u,2),this},this.getHandler=function(c){for(let u=0,h=l.length;u<h;u+=2){let d=l[u],p=l[u+1];if(d.global&&(d.lastIndex=0),d.test(c))return p}return null}}},mZ=new HR,R3=class{constructor(e){this.manager=e!==void 0?e:mZ,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){let r=this;return new Promise(function(i,n){r.load(e,i,t,n)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}},Pa={},gZ=class extends Error{constructor(e,t){super(e),this.response=t}},w2=class extends R3{constructor(e){super(e)}load(e,t,r,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let n=aP.get(e);if(n!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(n),this.manager.itemEnd(e)},0),n;if(Pa[e]!==void 0){Pa[e].push({onLoad:t,onProgress:r,onError:i});return}Pa[e]=[],Pa[e].push({onLoad:t,onProgress:r,onError:i});let s=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,o=this.responseType;fetch(s).then(l=>{if(l.status===200||l.status===0){if(l.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||l.body===void 0||l.body.getReader===void 0)return l;let c=Pa[e],u=l.body.getReader(),h=l.headers.get("Content-Length")||l.headers.get("X-File-Size"),d=h?parseInt(h):0,p=d!==0,f=0,m=new ReadableStream({start(g){v();function v(){u.read().then(({done:y,value:x})=>{if(y)g.close();else{f+=x.byteLength;let w=new ProgressEvent("progress",{lengthComputable:p,loaded:f,total:d});for(let b=0,_=c.length;b<_;b++){let A=c[b];A.onProgress&&A.onProgress(w)}g.enqueue(x),v()}})}}});return new Response(m)}else throw new gZ(`fetch for "${l.url}" responded with ${l.status}: ${l.statusText}`,l)}).then(l=>{switch(o){case"arraybuffer":return l.arrayBuffer();case"blob":return l.blob();case"document":return l.text().then(c=>new DOMParser().parseFromString(c,a));case"json":return l.json();default:if(a===void 0)return l.text();{let c=/charset="?([^;"\s]*)"?/i.exec(a),u=c&&c[1]?c[1].toLowerCase():void 0,h=new TextDecoder(u);return l.arrayBuffer().then(d=>h.decode(d))}}}).then(l=>{aP.add(e,l);let c=Pa[e];delete Pa[e];for(let u=0,h=c.length;u<h;u++){let d=c[u];d.onLoad&&d.onLoad(l)}}).catch(l=>{let c=Pa[e];if(c===void 0)throw this.manager.itemError(e),l;delete Pa[e];for(let u=0,h=c.length;u<h;u++){let d=c[u];d.onError&&d.onError(l)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}},mm=class extends Vt{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new $e(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){let t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}},vZ=class extends mm{constructor(e,t,r){super(e,r),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Vt.DEFAULT_UP),this.updateMatrix(),this.groundColor=new $e(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}},Nx=new _e,oP=new E,lP=new E,B3=class{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new W(512,512),this.map=null,this.mapPass=null,this.matrix=new _e,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new C3,this._frameExtents=new W(1,1),this._viewportCount=1,this._viewports=[new dt(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){let t=this.camera,r=this.matrix;oP.setFromMatrixPosition(e.matrixWorld),t.position.copy(oP),lP.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(lP),t.updateMatrixWorld(),Nx.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Nx),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(Nx)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}},yZ=class extends B3{constructor(){super(new vi(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){let t=this.camera,r=Of*2*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,n=e.distance||t.far;(r!==t.fov||i!==t.aspect||n!==t.far)&&(t.fov=r,t.aspect=i,t.far=n,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}},xZ=class extends mm{constructor(e,t,r=0,i=Math.PI/3,n=0,s=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Vt.DEFAULT_UP),this.updateMatrix(),this.target=new Vt,this.distance=r,this.angle=i,this.penumbra=n,this.decay=s,this.map=null,this.shadow=new yZ}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},cP=new _e,Qd=new E,Fx=new E,wZ=class extends B3{constructor(){super(new vi(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new W(4,2),this._viewportCount=6,this._viewports=[new dt(2,1,1,1),new dt(0,1,1,1),new dt(3,1,1,1),new dt(1,1,1,1),new dt(3,0,1,1),new dt(1,0,1,1)],this._cubeDirections=[new E(1,0,0),new E(-1,0,0),new E(0,0,1),new E(0,0,-1),new E(0,1,0),new E(0,-1,0)],this._cubeUps=[new E(0,1,0),new E(0,1,0),new E(0,1,0),new E(0,1,0),new E(0,0,1),new E(0,0,-1)]}updateMatrices(e,t=0){let r=this.camera,i=this.matrix,n=e.distance||r.far;n!==r.far&&(r.far=n,r.updateProjectionMatrix()),Qd.setFromMatrixPosition(e.matrixWorld),r.position.copy(Qd),Fx.copy(r.position),Fx.add(this._cubeDirections[t]),r.up.copy(this._cubeUps[t]),r.lookAt(Fx),r.updateMatrixWorld(),i.makeTranslation(-Qd.x,-Qd.y,-Qd.z),cP.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(cP)}},bZ=class extends mm{constructor(e,t,r=0,i=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=r,this.decay=i,this.shadow=new wZ}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}},_Z=class extends B3{constructor(){super(new M3(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}},SZ=class extends mm{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Vt.DEFAULT_UP),this.updateMatrix(),this.target=new Vt,this.shadow=new _Z}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},AZ=class extends it{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){let e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}},GR=class extends R3{constructor(e){super(e)}load(e,t,r,i){let n=this,s=new w2(n.manager);s.setPath(n.path),s.setRequestHeader(n.requestHeader),s.setWithCredentials(n.withCredentials),s.load(e,function(a){try{t(n.parse(JSON.parse(a)))}catch(o){i?i(o):console.error(o),n.manager.itemError(e)}},r,i)}parse(e){let t={},r={};function i(h,d){if(t[d]!==void 0)return t[d];let p=h.interleavedBuffers[d],f=n(h,p.buffer),m=Wm(p.type,f),g=new LK(m,p.stride);return g.uuid=p.uuid,t[d]=g,g}function n(h,d){if(r[d]!==void 0)return r[d];let p=h.arrayBuffers[d],f=new Uint32Array(p).buffer;return r[d]=f,f}let s=e.isInstancedBufferGeometry?new AZ:new it,a=e.data.index;if(a!==void 0){let h=Wm(a.type,a.array);s.setIndex(new nt(h,1))}let o=e.data.attributes;for(let h in o){let d=o[h],p;if(d.isInterleavedBufferAttribute){let f=i(e.data,d.data);p=new g2(f,d.itemSize,d.offset,d.normalized)}else{let f=Wm(d.type,d.array),m=d.isInstancedBufferAttribute?OK:nt;p=new m(f,d.itemSize,d.normalized)}d.name!==void 0&&(p.name=d.name),d.usage!==void 0&&p.setUsage(d.usage),d.updateRange!==void 0&&(p.updateRange.offset=d.updateRange.offset,p.updateRange.count=d.updateRange.count),s.setAttribute(h,p)}let l=e.data.morphAttributes;if(l)for(let h in l){let d=l[h],p=[];for(let f=0,m=d.length;f<m;f++){let g=d[f],v;if(g.isInterleavedBufferAttribute){let y=i(e.data,g.data);v=new g2(y,g.itemSize,g.offset,g.normalized)}else{let y=Wm(g.type,g.array);v=new nt(y,g.itemSize,g.normalized)}g.name!==void 0&&(v.name=g.name),p.push(v)}s.morphAttributes[h]=p}e.data.morphTargetsRelative&&(s.morphTargetsRelative=!0);let c=e.data.groups||e.data.drawcalls||e.data.offsets;if(c!==void 0)for(let h=0,d=c.length;h!==d;++h){let p=c[h];s.addGroup(p.start,p.count,p.materialIndex)}let u=e.data.boundingSphere;if(u!==void 0){let h=new E;u.center!==void 0&&h.fromArray(u.center),s.boundingSphere=new Mn(h,u.radius)}return e.name&&(s.name=e.name),e.userData&&(s.userData=e.userData),s}},CZ=class{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=hP(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let t=hP();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}};function hP(){return(typeof performance>"u"?Date:performance).now()}var MZ=class{constructor(e,t,r){this.binding=e,this.valueSize=r;let i,n,s;switch(t){case"quaternion":i=this._slerp,n=this._slerpAdditive,s=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(r*6),this._workIndex=5;break;case"string":case"bool":i=this._select,n=this._select,s=this._setAdditiveIdentityOther,this.buffer=new Array(r*5);break;default:i=this._lerp,n=this._lerpAdditive,s=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(r*5)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=n,this._setIdentity=s,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){let r=this.buffer,i=this.valueSize,n=e*i+i,s=this.cumulativeWeight;if(s===0){for(let a=0;a!==i;++a)r[n+a]=r[a];s=t}else{s+=t;let a=t/s;this._mixBufferRegion(r,n,0,a,i)}this.cumulativeWeight=s}accumulateAdditive(e){let t=this.buffer,r=this.valueSize,i=r*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,i,0,e,r),this.cumulativeWeightAdditive+=e}apply(e){let t=this.valueSize,r=this.buffer,i=e*t+t,n=this.cumulativeWeight,s=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,n<1){let o=t*this._origIndex;this._mixBufferRegion(r,i,o,1-n,t)}s>0&&this._mixBufferRegionAdditive(r,i,this._addIndex*t,1,t);for(let o=t,l=t+t;o!==l;++o)if(r[o]!==r[o+t]){a.setValue(r,i);break}}saveOriginalState(){let e=this.binding,t=this.buffer,r=this.valueSize,i=r*this._origIndex;e.getValue(t,i);for(let n=r,s=i;n!==s;++n)t[n]=t[i+n%r];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){let e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){let e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let r=e;r<t;r++)this.buffer[r]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){let e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let r=0;r<this.valueSize;r++)this.buffer[t+r]=this.buffer[e+r]}_select(e,t,r,i,n){if(i>=.5)for(let s=0;s!==n;++s)e[t+s]=e[r+s]}_slerp(e,t,r,i){ft.slerpFlat(e,t,e,t,e,r,i)}_slerpAdditive(e,t,r,i,n){let s=this._workIndex*n;ft.multiplyQuaternionsFlat(e,s,e,t,e,r),ft.slerpFlat(e,t,e,t,e,s,i)}_lerp(e,t,r,i,n){let s=1-i;for(let a=0;a!==n;++a){let o=t+a;e[o]=e[o]*s+e[r+a]*i}}_lerpAdditive(e,t,r,i,n){for(let s=0;s!==n;++s){let a=t+s;e[a]=e[a]+e[r+s]*i}}},z3="\\[\\]\\.:\\/",EZ=new RegExp("["+z3+"]","g"),k3="[^"+z3+"]",TZ="[^"+z3.replace("\\.","")+"]",PZ=/((?:WC+[\/:])*)/.source.replace("WC",k3),DZ=/(WCOD+)?/.source.replace("WCOD",TZ),LZ=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",k3),IZ=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",k3),OZ=new RegExp("^"+PZ+DZ+LZ+IZ+"$"),RZ=["material","materials","bones","map"],BZ=class{constructor(e,t,r){let i=r||Gt.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();let r=this._targetGroup.nCachedObjects_,i=this._bindings[r];i!==void 0&&i.getValue(e,t)}setValue(e,t){let r=this._bindings;for(let i=this._targetGroup.nCachedObjects_,n=r.length;i!==n;++i)r[i].setValue(e,t)}bind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()}unbind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}},Gt=class{constructor(e,t,r){this.path=t,this.parsedPath=r||Gt.parseTrackName(t),this.node=Gt.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,r){return e&&e.isAnimationObjectGroup?new Gt.Composite(e,t,r):new Gt(e,t,r)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(EZ,"")}static parseTrackName(e){let t=OZ.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);let r={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=r.nodeName&&r.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){let n=r.nodeName.substring(i+1);RZ.indexOf(n)!==-1&&(r.nodeName=r.nodeName.substring(0,i),r.objectName=n)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){let r=e.skeleton.getBoneByName(t);if(r!==void 0)return r}if(e.children){let r=function(n){for(let s=0;s<n.length;s++){let a=n[s];if(a.name===t||a.uuid===t)return a;let o=r(a.children);if(o)return o}return null},i=r(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){let r=this.resolvedProperty;for(let i=0,n=r.length;i!==n;++i)e[t++]=r[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){let r=this.resolvedProperty;for(let i=0,n=r.length;i!==n;++i)r[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){let r=this.resolvedProperty;for(let i=0,n=r.length;i!==n;++i)r[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){let r=this.resolvedProperty;for(let i=0,n=r.length;i!==n;++i)r[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node,t=this.parsedPath,r=t.objectName,i=t.propertyName,n=t.propertyIndex;if(e||(e=Gt.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(r){let l=t.objectIndex;switch(r){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let c=0;c<e.length;c++)if(e[c].name===l){l=c;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[r]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[r]}if(l!==void 0){if(e[l]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[l]}}let s=e[i];if(s===void 0){let l=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+l+"."+i+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let o=this.BindingType.Direct;if(n!==void 0){if(i==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[n]!==void 0&&(n=e.morphTargetDictionary[n])}o=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=n}else s.fromArray!==void 0&&s.toArray!==void 0?(o=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(o=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=i;this.getValue=this.GetterByBindingType[o],this.setValue=this.SetterByBindingTypeAndVersioning[o][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}};Gt.Composite=BZ;Gt.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Gt.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Gt.prototype.GetterByBindingType=[Gt.prototype._getValue_direct,Gt.prototype._getValue_array,Gt.prototype._getValue_arrayElement,Gt.prototype._getValue_toArray];Gt.prototype.SetterByBindingTypeAndVersioning=[[Gt.prototype._setValue_direct,Gt.prototype._setValue_direct_setNeedsUpdate,Gt.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Gt.prototype._setValue_array,Gt.prototype._setValue_array_setNeedsUpdate,Gt.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Gt.prototype._setValue_arrayElement,Gt.prototype._setValue_arrayElement_setNeedsUpdate,Gt.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Gt.prototype._setValue_fromArray,Gt.prototype._setValue_fromArray_setNeedsUpdate,Gt.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var zZ=class{constructor(e,t,r=null,i=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=r,this.blendMode=i;let n=t.tracks,s=n.length,a=new Array(s),o={endingStart:Jh,endingEnd:Jh};for(let l=0;l!==s;++l){let c=n[l].createInterpolant(null);a[l]=c,c.settings=o}this._interpolantSettings=o,this._interpolants=a,this._propertyBindings=new Array(s),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=cR,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,r){if(e.fadeOut(t),this.fadeIn(t),r){let i=this._clip.duration,n=e._clip.duration,s=n/i,a=i/n;e.warp(1,s,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,r){return e.crossFadeFrom(this,t,r)}stopFading(){let e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,r){let i=this._mixer,n=i.time,s=this.timeScale,a=this._timeScaleInterpolant;a===null&&(a=i._lendControlInterpolant(),this._timeScaleInterpolant=a);let o=a.parameterPositions,l=a.sampleValues;return o[0]=n,o[1]=n+r,l[0]=e/s,l[1]=t/s,this}stopWarping(){let e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,r,i){if(!this.enabled){this._updateWeight(e);return}let n=this._startTime;if(n!==null){let o=(e-n)*r;o<0||r===0?t=0:(this._startTime=null,t=r*o)}t*=this._updateTimeScale(e);let s=this._updateTime(t),a=this._updateWeight(e);if(a>0){let o=this._interpolants,l=this._propertyBindings;switch(this.blendMode){case gW:for(let c=0,u=o.length;c!==u;++c)o[c].evaluate(s),l[c].accumulateAdditive(a);break;case b3:default:for(let c=0,u=o.length;c!==u;++c)o[c].evaluate(s),l[c].accumulate(i,a)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;let r=this._weightInterpolant;if(r!==null){let i=r.evaluate(e)[0];t*=i,e>r.parameterPositions[1]&&(this.stopFading(),i===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;let r=this._timeScaleInterpolant;if(r!==null){let i=r.evaluate(e)[0];t*=i,e>r.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){let t=this._clip.duration,r=this.loop,i=this.time+e,n=this._loopCount,s=r===w3;if(e===0)return n===-1?i:s&&(n&1)===1?t-i:i;if(r===lR){n===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=t)i=t;else if(i<0)i=0;else{this.time=i;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(n===-1&&(e>=0?(n=0,this._setEndings(!0,this.repetitions===0,s)):this._setEndings(this.repetitions===0,!0,s)),i>=t||i<0){let a=Math.floor(i/t);i-=t*a,n+=Math.abs(a);let o=this.repetitions-n;if(o<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=e>0?t:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(o===1){let l=e<0;this._setEndings(l,!l,s)}else this._setEndings(!1,!1,s);this._loopCount=n,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=i;if(s&&(n&1)===1)return t-i}return i}_setEndings(e,t,r){let i=this._interpolantSettings;r?(i.endingStart=eu,i.endingEnd=eu):(e?i.endingStart=this.zeroSlopeAtStart?eu:Jh:i.endingStart=y0,t?i.endingEnd=this.zeroSlopeAtEnd?eu:Jh:i.endingEnd=y0)}_scheduleFading(e,t,r){let i=this._mixer,n=i.time,s=this._weightInterpolant;s===null&&(s=i._lendControlInterpolant(),this._weightInterpolant=s);let a=s.parameterPositions,o=s.sampleValues;return a[0]=n,o[0]=t,a[1]=n+e,o[1]=r,this}},kZ=new Float32Array(1),NZ=class extends ui{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){let r=e._localRoot||this._root,i=e._clip.tracks,n=i.length,s=e._propertyBindings,a=e._interpolants,o=r.uuid,l=this._bindingsByRootAndName,c=l[o];c===void 0&&(c={},l[o]=c);for(let u=0;u!==n;++u){let h=i[u],d=h.name,p=c[d];if(p!==void 0)++p.referenceCount,s[u]=p;else{if(p=s[u],p!==void 0){p._cacheIndex===null&&(++p.referenceCount,this._addInactiveBinding(p,o,d));continue}let f=t&&t._propertyBindings[u].binding.parsedPath;p=new MZ(Gt.create(r,d,f),h.ValueTypeName,h.getValueSize()),++p.referenceCount,this._addInactiveBinding(p,o,d),s[u]=p}a[u].resultBuffer=p.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){let r=(e._localRoot||this._root).uuid,i=e._clip.uuid,n=this._actionsByClip[i];this._bindAction(e,n&&n.knownActions[0]),this._addInactiveAction(e,i,r)}let t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){let n=t[r];n.useCount++===0&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){let t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){let n=t[r];--n.useCount===0&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;let e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){let t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,r){let i=this._actions,n=this._actionsByClip,s=n[t];if(s===void 0)s={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,n[t]=s;else{let a=s.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=i.length,i.push(e),s.actionByRoot[r]=e}_removeInactiveAction(e){let t=this._actions,r=t[t.length-1],i=e._cacheIndex;r._cacheIndex=i,t[i]=r,t.pop(),e._cacheIndex=null;let n=e._clip.uuid,s=this._actionsByClip,a=s[n],o=a.knownActions,l=o[o.length-1],c=e._byClipCacheIndex;l._byClipCacheIndex=c,o[c]=l,o.pop(),e._byClipCacheIndex=null;let u=a.actionByRoot,h=(e._localRoot||this._root).uuid;delete u[h],o.length===0&&delete s[n],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){let t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){let n=t[r];--n.referenceCount===0&&this._removeInactiveBinding(n)}}_lendAction(e){let t=this._actions,r=e._cacheIndex,i=this._nActiveActions++,n=t[i];e._cacheIndex=i,t[i]=e,n._cacheIndex=r,t[r]=n}_takeBackAction(e){let t=this._actions,r=e._cacheIndex,i=--this._nActiveActions,n=t[i];e._cacheIndex=i,t[i]=e,n._cacheIndex=r,t[r]=n}_addInactiveBinding(e,t,r){let i=this._bindingsByRootAndName,n=this._bindings,s=i[t];s===void 0&&(s={},i[t]=s),s[r]=e,e._cacheIndex=n.length,n.push(e)}_removeInactiveBinding(e){let t=this._bindings,r=e.binding,i=r.rootNode.uuid,n=r.path,s=this._bindingsByRootAndName,a=s[i],o=t[t.length-1],l=e._cacheIndex;o._cacheIndex=l,t[l]=o,t.pop(),delete a[n],Object.keys(a).length===0&&delete s[i]}_lendBinding(e){let t=this._bindings,r=e._cacheIndex,i=this._nActiveBindings++,n=t[i];e._cacheIndex=i,t[i]=e,n._cacheIndex=r,t[r]=n}_takeBackBinding(e){let t=this._bindings,r=e._cacheIndex,i=--this._nActiveBindings,n=t[i];e._cacheIndex=i,t[i]=e,n._cacheIndex=r,t[r]=n}_lendControlInterpolant(){let e=this._controlInterpolants,t=this._nActiveControlInterpolants++,r=e[t];return r===void 0&&(r=new jR(new Float32Array(2),new Float32Array(2),1,kZ),r.__cacheIndex=t,e[t]=r),r}_takeBackControlInterpolant(e){let t=this._controlInterpolants,r=e.__cacheIndex,i=--this._nActiveControlInterpolants,n=t[i];e.__cacheIndex=i,t[i]=e,n.__cacheIndex=r,t[r]=n}clipAction(e,t,r){let i=t||this._root,n=i.uuid,s=typeof e=="string"?x2.findByName(i,e):e,a=s!==null?s.uuid:e,o=this._actionsByClip[a],l=null;if(r===void 0&&(s!==null?r=s.blendMode:r=b3),o!==void 0){let u=o.actionByRoot[n];if(u!==void 0&&u.blendMode===r)return u;l=o.knownActions[0],s===null&&(s=l._clip)}if(s===null)return null;let c=new zZ(this,s,t,r);return this._bindAction(c,l),this._addInactiveAction(c,a,n),c}existingAction(e,t){let r=t||this._root,i=r.uuid,n=typeof e=="string"?x2.findByName(r,e):e,s=n?n.uuid:e,a=this._actionsByClip[s];return a!==void 0&&a.actionByRoot[i]||null}stopAllAction(){let e=this._actions,t=this._nActiveActions;for(let r=t-1;r>=0;--r)e[r].stop();return this}update(e){e*=this.timeScale;let t=this._actions,r=this._nActiveActions,i=this.time+=e,n=Math.sign(e),s=this._accuIndex^=1;for(let l=0;l!==r;++l)t[l]._update(i,e,n,s);let a=this._bindings,o=this._nActiveBindings;for(let l=0;l!==o;++l)a[l].apply(s);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){let t=this._actions,r=e.uuid,i=this._actionsByClip,n=i[r];if(n!==void 0){let s=n.knownActions;for(let a=0,o=s.length;a!==o;++a){let l=s[a];this._deactivateAction(l);let c=l._cacheIndex,u=t[t.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,u._cacheIndex=c,t[c]=u,t.pop(),this._removeInactiveBindingsForAction(l)}delete i[r]}}uncacheRoot(e){let t=e.uuid,r=this._actionsByClip;for(let s in r){let a=r[s].actionByRoot,o=a[t];o!==void 0&&(this._deactivateAction(o),this._removeInactiveAction(o))}let i=this._bindingsByRootAndName,n=i[t];if(n!==void 0)for(let s in n){let a=n[s];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){let r=this.existingAction(e,t);r!==null&&(this._deactivateAction(r),this._removeInactiveAction(r))}},we=class{constructor(e){this.value=e}clone(){return new we(this.value.clone===void 0?this.value:this.value.clone())}},WR=class{constructor(e,t,r=0,i=1/0){this.ray=new hd(e,t),this.near=r,this.far=i,this.camera=null,this.layers=new S3,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,r=[]){return b2(e,this,r,t),r.sort(uP),r}intersectObjects(e,t=!0,r=[]){for(let i=0,n=e.length;i<n;i++)b2(e[i],this,r,t);return r.sort(uP),r}};function uP(e,t){return e.distance-t.distance}function b2(e,t,r,i){if(e.layers.test(t.layers)&&e.raycast(t,r),i===!0){let n=e.children;for(let s=0,a=n.length;s<a;s++)b2(n[s],t,r,!0)}}var dP=class{constructor(e=1,t=0,r=0){return this.radius=e,this.phi=t,this.theta=r,this}set(e,t,r){return this.radius=e,this.phi=t,this.theta=r,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+t*t+r*r),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(Fr(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}},pP=new W,FZ=class{constructor(e=new W(1/0,1/0),t=new W(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let r=pP.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return pP.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},fP=new E,mg=new E,Zn=class{constructor(e=new E,t=new E){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){fP.subVectors(e,this.start),mg.subVectors(this.end,this.start);let r=mg.dot(mg),i=mg.dot(fP)/r;return t&&(i=Fr(i,0,1)),i}closestPointToPoint(e,t,r){let i=this.closestPointToPointParameter(e,t);return this.delta(r).multiplyScalar(i).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}},mP=new E,UZ=class extends Vt{constructor(e,t){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";let r=new it,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let s=0,a=1,o=32;s<o;s++,a++){let l=s/o*Math.PI*2,c=a/o*Math.PI*2;i.push(Math.cos(l),Math.sin(l),1,Math.cos(c),Math.sin(c),1)}r.setAttribute("position",new Ne(i,3));let n=new Ll({fog:!1,toneMapped:!1});this.cone=new pm(r,n),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);let e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),mP.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(mP),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}},jZ=class extends Ki{constructor(e,t,r){let i=new O3(t,4,2),n=new dm({wireframe:!0,fog:!1,toneMapped:!1});super(i,n),this.light=e,this.color=r,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}},gP=new E,gg=new E,vP=new E,VZ=class extends Vt{constructor(e,t,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="DirectionalLightHelper",t===void 0&&(t=1);let i=new it;i.setAttribute("position",new Ne([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));let n=new Ll({fog:!1,toneMapped:!1});this.lightPlane=new S0(i,n),this.add(this.lightPlane),i=new it,i.setAttribute("position",new Ne([0,0,0,0,0,1],3)),this.targetLine=new S0(i,n),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),gP.setFromMatrixPosition(this.light.matrixWorld),gg.setFromMatrixPosition(this.light.target.matrixWorld),vP.subVectors(gg,gP),this.lightPlane.lookAt(gg),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(gg),this.targetLine.scale.z=vP.length()}},vg=new E,cr=new dd,T0=class extends pm{constructor(e){let t=new it,r=new Ll({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],n=[],s={};a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4");function a(p,f){o(p),o(f)}function o(p){i.push(0,0,0),n.push(0,0,0),s[p]===void 0&&(s[p]=[]),s[p].push(i.length/3-1)}t.setAttribute("position",new Ne(i,3)),t.setAttribute("color",new Ne(n,3)),super(t,r),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update();let l=new $e(16755200),c=new $e(16711680),u=new $e(43775),h=new $e(16777215),d=new $e(3355443);this.setColors(l,c,u,h,d)}setColors(e,t,r,i,n){let s=this.geometry.getAttribute("color");s.setXYZ(0,e.r,e.g,e.b),s.setXYZ(1,e.r,e.g,e.b),s.setXYZ(2,e.r,e.g,e.b),s.setXYZ(3,e.r,e.g,e.b),s.setXYZ(4,e.r,e.g,e.b),s.setXYZ(5,e.r,e.g,e.b),s.setXYZ(6,e.r,e.g,e.b),s.setXYZ(7,e.r,e.g,e.b),s.setXYZ(8,e.r,e.g,e.b),s.setXYZ(9,e.r,e.g,e.b),s.setXYZ(10,e.r,e.g,e.b),s.setXYZ(11,e.r,e.g,e.b),s.setXYZ(12,e.r,e.g,e.b),s.setXYZ(13,e.r,e.g,e.b),s.setXYZ(14,e.r,e.g,e.b),s.setXYZ(15,e.r,e.g,e.b),s.setXYZ(16,e.r,e.g,e.b),s.setXYZ(17,e.r,e.g,e.b),s.setXYZ(18,e.r,e.g,e.b),s.setXYZ(19,e.r,e.g,e.b),s.setXYZ(20,e.r,e.g,e.b),s.setXYZ(21,e.r,e.g,e.b),s.setXYZ(22,e.r,e.g,e.b),s.setXYZ(23,e.r,e.g,e.b),s.setXYZ(24,t.r,t.g,t.b),s.setXYZ(25,t.r,t.g,t.b),s.setXYZ(26,t.r,t.g,t.b),s.setXYZ(27,t.r,t.g,t.b),s.setXYZ(28,t.r,t.g,t.b),s.setXYZ(29,t.r,t.g,t.b),s.setXYZ(30,t.r,t.g,t.b),s.setXYZ(31,t.r,t.g,t.b),s.setXYZ(32,r.r,r.g,r.b),s.setXYZ(33,r.r,r.g,r.b),s.setXYZ(34,r.r,r.g,r.b),s.setXYZ(35,r.r,r.g,r.b),s.setXYZ(36,r.r,r.g,r.b),s.setXYZ(37,r.r,r.g,r.b),s.setXYZ(38,i.r,i.g,i.b),s.setXYZ(39,i.r,i.g,i.b),s.setXYZ(40,n.r,n.g,n.b),s.setXYZ(41,n.r,n.g,n.b),s.setXYZ(42,n.r,n.g,n.b),s.setXYZ(43,n.r,n.g,n.b),s.setXYZ(44,n.r,n.g,n.b),s.setXYZ(45,n.r,n.g,n.b),s.setXYZ(46,n.r,n.g,n.b),s.setXYZ(47,n.r,n.g,n.b),s.setXYZ(48,n.r,n.g,n.b),s.setXYZ(49,n.r,n.g,n.b),s.needsUpdate=!0}update(){let e=this.geometry,t=this.pointMap,r=1,i=1;cr.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),gr("c",t,e,cr,0,0,-1),gr("t",t,e,cr,0,0,1),gr("n1",t,e,cr,-r,-i,-1),gr("n2",t,e,cr,r,-i,-1),gr("n3",t,e,cr,-r,i,-1),gr("n4",t,e,cr,r,i,-1),gr("f1",t,e,cr,-r,-i,1),gr("f2",t,e,cr,r,-i,1),gr("f3",t,e,cr,-r,i,1),gr("f4",t,e,cr,r,i,1),gr("u1",t,e,cr,r*.7,i*1.1,-1),gr("u2",t,e,cr,-r*.7,i*1.1,-1),gr("u3",t,e,cr,0,i*2,-1),gr("cf1",t,e,cr,-r,0,1),gr("cf2",t,e,cr,r,0,1),gr("cf3",t,e,cr,0,-i,1),gr("cf4",t,e,cr,0,i,1),gr("cn1",t,e,cr,-r,0,-1),gr("cn2",t,e,cr,r,0,-1),gr("cn3",t,e,cr,0,-i,-1),gr("cn4",t,e,cr,0,i,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function gr(e,t,r,i,n,s,a){vg.set(n,s,a).unproject(i);let o=t[e];if(o!==void 0){let l=r.getAttribute("position");for(let c=0,u=o.length;c<u;c++)l.setXYZ(o[c],vg.x,vg.y,vg.z)}}var P0=class extends pm{constructor(e,t=16776960){let r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],n=new it;n.setIndex(new nt(r,1)),n.setAttribute("position",new Ne(i,3)),super(n,new Ll({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){let t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}},HZ=class extends pm{constructor(e=1){let t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],i=new it;i.setAttribute("position",new Ne(t,3)),i.setAttribute("color",new Ne(r,3));let n=new Ll({vertexColors:!0,toneMapped:!1});super(i,n),this.type="AxesHelper"}setColors(e,t,r){let i=new $e,n=this.geometry.attributes.color.array;return i.set(e),i.toArray(n,0),i.toArray(n,3),i.set(t),i.toArray(n,6),i.toArray(n,9),i.set(r),i.toArray(n,12),i.toArray(n,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}};typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:cd}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=cd);var Kd=".",N3=Symbol("target"),qR=Symbol("unsubscribe");function _2(e){return e instanceof Date||e instanceof Set||e instanceof Map||e instanceof WeakSet||e instanceof WeakMap||ArrayBuffer.isView(e)}function GZ(e){return(typeof e=="object"?e===null:typeof e!="function")||e instanceof RegExp}var ta=Array.isArray;function F3(e){return typeof e=="symbol"}var WZ={after:(e,t)=>ta(e)?e.slice(t.length):t===""?e:e.slice(t.length+1),concat:(e,t)=>ta(e)?(e=[...e],t&&e.push(t),e):t&&t.toString!==void 0?(e!==""&&(e+=Kd),F3(t)?e+t.toString():e+t):e,initial:e=>{if(ta(e))return e.slice(0,-1);if(e==="")return e;let t=e.lastIndexOf(Kd);return t===-1?"":e.slice(0,t)},last:e=>{if(ta(e))return e[e.length-1]||"";if(e==="")return e;let t=e.lastIndexOf(Kd);return t===-1?e:e.slice(t+1)},walk:(e,t)=>{if(ta(e))for(let r of e)t(r);else if(e!==""){let r=0,i=e.indexOf(Kd);if(i===-1)t(e);else for(;r<e.length;)i===-1&&(i=e.length),t(e.slice(r,i)),r=i+1,i=e.indexOf(Kd,r)}},get(e,t){return this.walk(t,r=>{e&&(e=e[r])}),e}},Fn=WZ;function qZ(e){return typeof e=="object"&&typeof e.next=="function"}function XZ(e,t,r,i,n){let s=e.next;if(t.name==="entries")e.next=function(){let a=s.call(this);return a.done===!1&&(a.value[0]=n(a.value[0],t,a.value[0],i),a.value[1]=n(a.value[1],t,a.value[0],i)),a};else if(t.name==="values"){let a=r[N3].keys();e.next=function(){let o=s.call(this);return o.done===!1&&(o.value=n(o.value,t,a.next().value,i)),o}}else e.next=function(){let a=s.call(this);return a.done===!1&&(a.value=n(a.value,t,a.value,i)),a};return e}function yP(e,t,r){return e.isUnsubscribed||t.ignoreSymbols&&F3(r)||t.ignoreUnderscores&&r.charAt(0)==="_"||"ignoreKeys"in t&&t.ignoreKeys.includes(r)}var YZ=class{constructor(e){this._equals=e,this._proxyCache=new WeakMap,this._pathCache=new WeakMap,this.isUnsubscribed=!1}_getDescriptorCache(){return this._descriptorCache===void 0&&(this._descriptorCache=new WeakMap),this._descriptorCache}_getProperties(e){let t=this._getDescriptorCache(),r=t.get(e);return r===void 0&&(r={},t.set(e,r)),r}_getOwnPropertyDescriptor(e,t){if(this.isUnsubscribed)return Reflect.getOwnPropertyDescriptor(e,t);let r=this._getProperties(e),i=r[t];return i===void 0&&(i=Reflect.getOwnPropertyDescriptor(e,t),r[t]=i),i}getProxy(e,t,r,i){if(this.isUnsubscribed)return e;let n=e[i],s=n||e;this._pathCache.set(s,t);let a=this._proxyCache.get(s);return a===void 0&&(a=n===void 0?new Proxy(e,r):e,this._proxyCache.set(s,a)),a}getPath(e){return this.isUnsubscribed?void 0:this._pathCache.get(e)}isDetached(e,t){return!Object.is(e,Fn.get(t,this.getPath(e)))}defineProperty(e,t,r){return Reflect.defineProperty(e,t,r)?(this.isUnsubscribed||(this._getProperties(e)[t]=r),!0):!1}setProperty(e,t,r,i,n){if(!this._equals(n,r)||!(t in e)){let s=this._getOwnPropertyDescriptor(e,t);return s!==void 0&&"set"in s?Reflect.set(e,t,r,i):Reflect.set(e,t,r)}return!0}deleteProperty(e,t,r){if(Reflect.deleteProperty(e,t)){if(!this.isUnsubscribed){let i=this._getDescriptorCache().get(e);i&&(delete i[t],this._pathCache.delete(r))}return!0}return!1}isSameDescriptor(e,t,r){let i=this._getOwnPropertyDescriptor(t,r);return e!==void 0&&i!==void 0&&Object.is(e.value,i.value)&&(e.writable||!1)===(i.writable||!1)&&(e.enumerable||!1)===(i.enumerable||!1)&&(e.configurable||!1)===(i.configurable||!1)&&e.get===i.get&&e.set===i.set}isGetInvariant(e,t){let r=this._getOwnPropertyDescriptor(e,t);return r!==void 0&&r.configurable!==!0&&r.writable!==!0}unsubscribe(){this._descriptorCache=null,this._pathCache=null,this._proxyCache=null,this.isUnsubscribed=!0}};function S2(e){return toString.call(e)==="[object Object]"}function yg(){return!0}function dh(e,t){return e.length!==t.length||e.some((r,i)=>t[i]!==r)}var XR=new Set(["hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),QZ=new Set(["concat","includes","indexOf","join","keys","lastIndexOf"]),YR={push:yg,pop:yg,shift:yg,unshift:yg,copyWithin:dh,reverse:dh,sort:dh,splice:dh,flat:dh,fill:dh},KZ=new Set([...XR,...QZ,...Object.keys(YR)]);function xg(e,t){if(e.size!==t.size)return!0;for(let r of e)if(!t.has(r))return!0;return!1}var QR=["keys","values","entries"],KR=new Set(["has","toString"]),ZR={add:xg,clear:xg,delete:xg,forEach:xg},ZZ=new Set([...KR,...Object.keys(ZR),...QR]);function wg(e,t){if(e.size!==t.size)return!0;let r;for(let[i,n]of e)if(r=t.get(i),r!==n||r===void 0&&!t.has(i))return!0;return!1}var $Z=new Set([...KR,"get"]),$R={set:wg,clear:wg,delete:wg,forEach:wg},JZ=new Set([...$Z,...Object.keys($R),...QR]),Al=class{constructor(e,t,r,i){this._path=t,this._isChanged=!1,this._clonedCache=new Set,this._hasOnValidate=i,this._changes=i?[]:null,this.clone=t===void 0?e:this._shallowClone(e)}static isHandledMethod(e){return XR.has(e)}_shallowClone(e){let t=e;if(S2(e))t={...e};else if(ta(e))t=[...e];else if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set([...e].map(r=>this._shallowClone(r)));else if(e instanceof Map){t=new Map;for(let[r,i]of e.entries())t.set(r,this._shallowClone(i))}return this._clonedCache.add(t),t}preferredThisArg(e,t,r,i){return e?(ta(i)?this._onIsChanged=YR[t]:i instanceof Set?this._onIsChanged=ZR[t]:i instanceof Map&&(this._onIsChanged=$R[t]),i):r}update(e,t,r){let i=Fn.after(e,this._path);if(t!=="length"){let n=this.clone;Fn.walk(i,s=>{n&&n[s]&&(this._clonedCache.has(n[s])||(n[s]=this._shallowClone(n[s])),n=n[s])}),this._hasOnValidate&&this._changes.push({path:i,property:t,previous:r}),n&&n[t]&&(n[t]=r)}this._isChanged=!0}undo(e){let t;for(let r=this._changes.length-1;r!==-1;r--)t=this._changes[r],Fn.get(e,t.path)[t.property]=t.previous}isChanged(e){return this._onIsChanged===void 0?this._isChanged:this._onIsChanged(this.clone,e)}},xP=class extends Al{static isHandledMethod(e){return KZ.has(e)}},e$=class extends Al{undo(e){e.setTime(this.clone.getTime())}isChanged(e,t){return!t(this.clone.valueOf(),e.valueOf())}},wP=class extends Al{static isHandledMethod(e){return ZZ.has(e)}undo(e){for(let t of this.clone)e.add(t);for(let t of e)this.clone.has(t)||e.delete(t)}},bP=class extends Al{static isHandledMethod(e){return JZ.has(e)}undo(e){for(let[t,r]of this.clone.entries())e.set(t,r);for(let t of e.keys())this.clone.has(t)||e.delete(t)}},t$=class extends Al{constructor(e,t,r,i){super(void 0,t,r,i),this._arg1=r[0],this._weakValue=e.has(this._arg1)}isChanged(e){return this._weakValue!==e.has(this._arg1)}undo(e){this._weakValue&&!e.has(this._arg1)?e.add(this._arg1):e.delete(this._arg1)}},r$=class extends Al{constructor(e,t,r,i){super(void 0,t,r,i),this._weakKey=r[0],this._weakHas=e.has(this._weakKey),this._weakValue=e.get(this._weakKey)}isChanged(e){return this._weakValue!==e.get(this._weakKey)}undo(e){let t=e.has(this._weakKey);this._weakHas&&!t?e.set(this._weakKey,this._weakValue):!this._weakHas&&t?e.delete(this._weakKey):this._weakValue!==e.get(this._weakKey)&&e.set(this._weakKey,this._weakValue)}},Lh=class{constructor(e){this._stack=[],this._hasOnValidate=e}static isHandledType(e){return S2(e)||ta(e)||_2(e)}static isHandledMethod(e,t){return S2(e)?Al.isHandledMethod(t):ta(e)?xP.isHandledMethod(t):e instanceof Set?wP.isHandledMethod(t):e instanceof Map?bP.isHandledMethod(t):_2(e)}get isCloning(){return this._stack.length>0}start(e,t,r){let i=Al;ta(e)?i=xP:e instanceof Date?i=e$:e instanceof Set?i=wP:e instanceof Map?i=bP:e instanceof WeakSet?i=t$:e instanceof WeakMap&&(i=r$),this._stack.push(new i(e,t,r,this._hasOnValidate))}update(e,t,r){this._stack[this._stack.length-1].update(e,t,r)}preferredThisArg(e,t,r){let{name:i}=e,n=Lh.isHandledMethod(r,i);return this._stack[this._stack.length-1].preferredThisArg(n,i,t,r)}isChanged(e,t,r){return this._stack[this._stack.length-1].isChanged(e,t,r)}undo(e){this._previousClone!==void 0&&this._previousClone.undo(e)}stop(){return this._previousClone=this._stack.pop(),this._previousClone.clone}},i$={equals:Object.is,isShallow:!1,pathAsArray:!1,ignoreSymbols:!1,ignoreUnderscores:!1,ignoreDetached:!1,details:!1},U3=(e,t,r={})=>{r={...i$,...r};let i=Symbol("ProxyTarget"),{equals:n,isShallow:s,ignoreDetached:a,details:o}=r,l=new YZ(n),c=typeof r.onValidate=="function",u=new Lh(c),h=(y,x,w,b,_)=>!c||u.isCloning||r.onValidate(Fn.concat(l.getPath(y),x),w,b,_)===!0,d=(y,x,w,b)=>{!yP(l,r,x)&&!(a&&l.isDetached(y,e))&&p(l.getPath(y),x,w,b)},p=(y,x,w,b,_)=>{u.isCloning?u.update(y,x,b):t(Fn.concat(y,x),w,b,_)},f=y=>y&&(y[i]||y),m=(y,x,w,b)=>GZ(y)||w==="constructor"||s&&!Lh.isHandledMethod(x,w)||yP(l,r,w)||l.isGetInvariant(x,w)||a&&l.isDetached(x,e)?y:(b===void 0&&(b=l.getPath(x)),l.getProxy(y,Fn.concat(b,w),g,i)),g={get(y,x,w){if(F3(x)){if(x===i||x===N3)return y;if(x===qR&&!l.isUnsubscribed&&l.getPath(y).length===0)return l.unsubscribe(),y}let b=_2(y)?Reflect.get(y,x):Reflect.get(y,x,w);return m(b,y,x)},set(y,x,w,b){w=f(w);let _=y[i]||y,A=_[x];if(n(A,w)&&x in y)return!0;let S=h(y,x,w,A);return S&&l.setProperty(_,x,w,b,A)?(d(y,x,y[x],A),!0):!S},defineProperty(y,x,w){if(!l.isSameDescriptor(w,y,x)){let b=y[x];h(y,x,w.value,b)&&l.defineProperty(y,x,w,b)&&d(y,x,w.value,b)}return!0},deleteProperty(y,x){if(!Reflect.has(y,x))return!0;let w=Reflect.get(y,x),b=h(y,x,void 0,w);return b&&l.deleteProperty(y,x,w)?(d(y,x,void 0,w),!0):!b},apply(y,x,w){let b=x[i]||x;if(l.isUnsubscribed)return Reflect.apply(y,b,w);if((o===!1||o!==!0&&!o.includes(y.name))&&Lh.isHandledType(b)){let _=Fn.initial(l.getPath(y)),A=Lh.isHandledMethod(b,y.name);u.start(b,_,w);let S=Reflect.apply(y,u.preferredThisArg(y,x,b),A?w.map(T=>f(T)):w),C=u.isChanged(b,n),M=u.stop();if(Lh.isHandledType(S)&&A&&(x instanceof Map&&y.name==="get"&&(_=Fn.concat(_,w[0])),S=l.getProxy(S,_,g)),C){let T={name:y.name,args:w,result:S},P=u.isCloning?Fn.initial(_):_,D=u.isCloning?Fn.last(_):"";h(Fn.get(e,P),D,b,M,T)?p(P,D,b,M,T):u.undo(b)}return(x instanceof Map||x instanceof Set)&&qZ(S)?XZ(S,y,x,_,m):S}return Reflect.apply(y,x,w)}},v=l.getProxy(e,r.pathAsArray?[]:"",g);return t=t.bind(v),c&&(r.onValidate=r.onValidate.bind(v)),v};U3.target=e=>e&&e[N3]||e;U3.unsubscribe=e=>e[qR]||e;var _P=U3,n$=typeof global=="object"&&global&&global.Object===Object&&global,JR=n$,s$=typeof self=="object"&&self&&self.Object===Object&&self,a$=JR||s$||Function("return this")(),Is=a$,o$=Is.Symbol,ts=o$,eB=Object.prototype,l$=eB.hasOwnProperty,c$=eB.toString,Zd=ts?ts.toStringTag:void 0;function h$(e){var t=l$.call(e,Zd),r=e[Zd];try{e[Zd]=void 0;var i=!0}catch{}var n=c$.call(e);return i&&(t?e[Zd]=r:delete e[Zd]),n}var u$=h$,d$=Object.prototype,p$=d$.toString;function f$(e){return p$.call(e)}var m$=f$,g$="[object Null]",v$="[object Undefined]",SP=ts?ts.toStringTag:void 0;function y$(e){return e==null?e===void 0?v$:g$:SP&&SP in Object(e)?u$(e):m$(e)}var Gc=y$;function x$(e){return e!=null&&typeof e=="object"}var uo=x$,w$="[object Symbol]";function b$(e){return typeof e=="symbol"||uo(e)&&Gc(e)==w$}var Hy=b$;function _$(e,t){for(var r=-1,i=e==null?0:e.length,n=Array(i);++r<i;)n[r]=t(e[r],r,e);return n}var tB=_$,S$=Array.isArray,ga=S$,A$=1/0,AP=ts?ts.prototype:void 0,CP=AP?AP.toString:void 0;function rB(e){if(typeof e=="string")return e;if(ga(e))return tB(e,rB)+"";if(Hy(e))return CP?CP.call(e):"";var t=e+"";return t=="0"&&1/e==-A$?"-0":t}var C$=rB,M$=/\s/;function E$(e){for(var t=e.length;t--&&M$.test(e.charAt(t)););return t}var T$=E$,P$=/^\s+/;function D$(e){return e&&e.slice(0,T$(e)+1).replace(P$,"")}var L$=D$;function I$(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Ls=I$,MP=0/0,O$=/^[-+]0x[0-9a-f]+$/i,R$=/^0b[01]+$/i,B$=/^0o[0-7]+$/i,z$=parseInt;function k$(e){if(typeof e=="number")return e;if(Hy(e))return MP;if(Ls(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Ls(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=L$(e);var r=R$.test(e);return r||B$.test(e)?z$(e.slice(2),r?2:8):O$.test(e)?MP:+e}var EP=k$;function N$(e){return e}var F$=N$,U$="[object AsyncFunction]",j$="[object Function]",V$="[object GeneratorFunction]",H$="[object Proxy]";function G$(e){if(!Ls(e))return!1;var t=Gc(e);return t==j$||t==V$||t==U$||t==H$}var iB=G$,W$=Is["__core-js_shared__"],Ux=W$,TP=function(){var e=/[^.]+$/.exec(Ux&&Ux.keys&&Ux.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function q$(e){return!!TP&&TP in e}var X$=q$,Y$=Function.prototype,Q$=Y$.toString;function K$(e){if(e!=null){try{return Q$.call(e)}catch{}try{return e+""}catch{}}return""}var Wc=K$,Z$=/[\\^$.*+?()[\]{}|]/g,$$=/^\[object .+?Constructor\]$/,J$=Function.prototype,eJ=Object.prototype,tJ=J$.toString,rJ=eJ.hasOwnProperty,iJ=RegExp("^"+tJ.call(rJ).replace(Z$,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function nJ(e){if(!Ls(e)||X$(e))return!1;var t=iB(e)?iJ:$$;return t.test(Wc(e))}var sJ=nJ;function aJ(e,t){return e==null?void 0:e[t]}var oJ=aJ;function lJ(e,t){var r=oJ(e,t);return sJ(r)?r:void 0}var qc=lJ,cJ=qc(Is,"WeakMap"),A2=cJ,PP=Object.create,hJ=function(){function e(){}return function(t){if(!Ls(t))return{};if(PP)return PP(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),uJ=hJ;function dJ(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var pJ=dJ;function fJ(e,t){var r=-1,i=e.length;for(t||(t=Array(i));++r<i;)t[r]=e[r];return t}var mJ=fJ,gJ=800,vJ=16,yJ=Date.now;function xJ(e){var t=0,r=0;return function(){var i=yJ(),n=vJ-(i-r);if(r=i,n>0){if(++t>=gJ)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var wJ=xJ;function bJ(e){return function(){return e}}var _J=bJ,SJ=function(){try{var e=qc(Object,"defineProperty");return e({},"",{}),e}catch{}}(),D0=SJ,AJ=D0?function(e,t){return D0(e,"toString",{configurable:!0,enumerable:!1,value:_J(t),writable:!0})}:F$,CJ=AJ,MJ=wJ(CJ),EJ=MJ;function TJ(e,t){for(var r=-1,i=e==null?0:e.length;++r<i&&t(e[r],r,e)!==!1;);return e}var PJ=TJ,DJ=9007199254740991,LJ=/^(?:0|[1-9]\d*)$/;function IJ(e,t){var r=typeof e;return t=t??DJ,!!t&&(r=="number"||r!="symbol"&&LJ.test(e))&&e>-1&&e%1==0&&e<t}var j3=IJ;function OJ(e,t,r){t=="__proto__"&&D0?D0(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var nB=OJ;function RJ(e,t){return e===t||e!==e&&t!==t}var V3=RJ,BJ=Object.prototype,zJ=BJ.hasOwnProperty;function kJ(e,t,r){var i=e[t];(!(zJ.call(e,t)&&V3(i,r))||r===void 0&&!(t in e))&&nB(e,t,r)}var H3=kJ;function NJ(e,t,r,i){var n=!r;r||(r={});for(var s=-1,a=t.length;++s<a;){var o=t[s],l=i?i(r[o],e[o],o,r,e):void 0;l===void 0&&(l=e[o]),n?nB(r,o,l):H3(r,o,l)}return r}var gm=NJ,DP=Math.max;function FJ(e,t,r){return t=DP(t===void 0?e.length-1:t,0),function(){for(var i=arguments,n=-1,s=DP(i.length-t,0),a=Array(s);++n<s;)a[n]=i[t+n];n=-1;for(var o=Array(t+1);++n<t;)o[n]=i[n];return o[t]=r(a),pJ(e,this,o)}}var UJ=FJ,jJ=9007199254740991;function VJ(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=jJ}var G3=VJ;function HJ(e){return e!=null&&G3(e.length)&&!iB(e)}var sB=HJ,GJ=Object.prototype;function WJ(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||GJ;return e===r}var W3=WJ;function qJ(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}var XJ=qJ,YJ="[object Arguments]";function QJ(e){return uo(e)&&Gc(e)==YJ}var LP=QJ,aB=Object.prototype,KJ=aB.hasOwnProperty,ZJ=aB.propertyIsEnumerable,$J=LP(function(){return arguments}())?LP:function(e){return uo(e)&&KJ.call(e,"callee")&&!ZJ.call(e,"callee")},q3=$J;function JJ(){return!1}var eee=JJ,oB=typeof bn=="object"&&bn&&!bn.nodeType&&bn,IP=oB&&typeof _n=="object"&&_n&&!_n.nodeType&&_n,tee=IP&&IP.exports===oB,OP=tee?Is.Buffer:void 0,ree=OP?OP.isBuffer:void 0,iee=ree||eee,L0=iee,nee="[object Arguments]",see="[object Array]",aee="[object Boolean]",oee="[object Date]",lee="[object Error]",cee="[object Function]",hee="[object Map]",uee="[object Number]",dee="[object Object]",pee="[object RegExp]",fee="[object Set]",mee="[object String]",gee="[object WeakMap]",vee="[object ArrayBuffer]",yee="[object DataView]",xee="[object Float32Array]",wee="[object Float64Array]",bee="[object Int8Array]",_ee="[object Int16Array]",See="[object Int32Array]",Aee="[object Uint8Array]",Cee="[object Uint8ClampedArray]",Mee="[object Uint16Array]",Eee="[object Uint32Array]",er={};er[xee]=er[wee]=er[bee]=er[_ee]=er[See]=er[Aee]=er[Cee]=er[Mee]=er[Eee]=!0;er[nee]=er[see]=er[vee]=er[aee]=er[yee]=er[oee]=er[lee]=er[cee]=er[hee]=er[uee]=er[dee]=er[pee]=er[fee]=er[mee]=er[gee]=!1;function Tee(e){return uo(e)&&G3(e.length)&&!!er[Gc(e)]}var Pee=Tee;function Dee(e){return function(t){return e(t)}}var X3=Dee,lB=typeof bn=="object"&&bn&&!bn.nodeType&&bn,Jp=lB&&typeof _n=="object"&&_n&&!_n.nodeType&&_n,Lee=Jp&&Jp.exports===lB,jx=Lee&&JR.process,Iee=function(){try{var e=Jp&&Jp.require&&Jp.require("util").types;return e||jx&&jx.binding&&jx.binding("util")}catch{}}(),qu=Iee,RP=qu&&qu.isTypedArray,Oee=RP?X3(RP):Pee,cB=Oee,Ree=Object.prototype,Bee=Ree.hasOwnProperty;function zee(e,t){var r=ga(e),i=!r&&q3(e),n=!r&&!i&&L0(e),s=!r&&!i&&!n&&cB(e),a=r||i||n||s,o=a?XJ(e.length,String):[],l=o.length;for(var c in e)(t||Bee.call(e,c))&&!(a&&(c=="length"||n&&(c=="offset"||c=="parent")||s&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||j3(c,l)))&&o.push(c);return o}var hB=zee;function kee(e,t){return function(r){return e(t(r))}}var uB=kee,Nee=uB(Object.keys,Object),Fee=Nee,Uee=Object.prototype,jee=Uee.hasOwnProperty;function Vee(e){if(!W3(e))return Fee(e);var t=[];for(var r in Object(e))jee.call(e,r)&&r!="constructor"&&t.push(r);return t}var Hee=Vee;function Gee(e){return sB(e)?hB(e):Hee(e)}var Y3=Gee;function Wee(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}var qee=Wee,Xee=Object.prototype,Yee=Xee.hasOwnProperty;function Qee(e){if(!Ls(e))return qee(e);var t=W3(e),r=[];for(var i in e)i=="constructor"&&(t||!Yee.call(e,i))||r.push(i);return r}var Kee=Qee;function Zee(e){return sB(e)?hB(e,!0):Kee(e)}var Q3=Zee,$ee=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Jee=/^\w*$/;function ete(e,t){if(ga(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||Hy(e)?!0:Jee.test(e)||!$ee.test(e)||t!=null&&e in Object(t)}var tte=ete,rte=qc(Object,"create"),kf=rte;function ite(){this.__data__=kf?kf(null):{},this.size=0}var nte=ite;function ste(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var ate=ste,ote="__lodash_hash_undefined__",lte=Object.prototype,cte=lte.hasOwnProperty;function hte(e){var t=this.__data__;if(kf){var r=t[e];return r===ote?void 0:r}return cte.call(t,e)?t[e]:void 0}var ute=hte,dte=Object.prototype,pte=dte.hasOwnProperty;function fte(e){var t=this.__data__;return kf?t[e]!==void 0:pte.call(t,e)}var mte=fte,gte="__lodash_hash_undefined__";function vte(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=kf&&t===void 0?gte:t,this}var yte=vte;function gd(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}gd.prototype.clear=nte;gd.prototype.delete=ate;gd.prototype.get=ute;gd.prototype.has=mte;gd.prototype.set=yte;var BP=gd;function xte(){this.__data__=[],this.size=0}var wte=xte;function bte(e,t){for(var r=e.length;r--;)if(V3(e[r][0],t))return r;return-1}var Gy=bte,_te=Array.prototype,Ste=_te.splice;function Ate(e){var t=this.__data__,r=Gy(t,e);if(r<0)return!1;var i=t.length-1;return r==i?t.pop():Ste.call(t,r,1),--this.size,!0}var Cte=Ate;function Mte(e){var t=this.__data__,r=Gy(t,e);return r<0?void 0:t[r][1]}var Ete=Mte;function Tte(e){return Gy(this.__data__,e)>-1}var Pte=Tte;function Dte(e,t){var r=this.__data__,i=Gy(r,e);return i<0?(++this.size,r.push([e,t])):r[i][1]=t,this}var Lte=Dte;function vd(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}vd.prototype.clear=wte;vd.prototype.delete=Cte;vd.prototype.get=Ete;vd.prototype.has=Pte;vd.prototype.set=Lte;var Wy=vd,Ite=qc(Is,"Map"),Nf=Ite;function Ote(){this.size=0,this.__data__={hash:new BP,map:new(Nf||Wy),string:new BP}}var Rte=Ote;function Bte(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var zte=Bte;function kte(e,t){var r=e.__data__;return zte(t)?r[typeof t=="string"?"string":"hash"]:r.map}var qy=kte;function Nte(e){var t=qy(this,e).delete(e);return this.size-=t?1:0,t}var Fte=Nte;function Ute(e){return qy(this,e).get(e)}var jte=Ute;function Vte(e){return qy(this,e).has(e)}var Hte=Vte;function Gte(e,t){var r=qy(this,e),i=r.size;return r.set(e,t),this.size+=r.size==i?0:1,this}var Wte=Gte;function yd(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}yd.prototype.clear=Rte;yd.prototype.delete=Fte;yd.prototype.get=jte;yd.prototype.has=Hte;yd.prototype.set=Wte;var Xy=yd,qte="Expected a function";function K3(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(qte);var r=function(){var i=arguments,n=t?t.apply(this,i):i[0],s=r.cache;if(s.has(n))return s.get(n);var a=e.apply(this,i);return r.cache=s.set(n,a)||s,a};return r.cache=new(K3.Cache||Xy),r}K3.Cache=Xy;var Xte=K3,Yte=500;function Qte(e){var t=Xte(e,function(i){return r.size===Yte&&r.clear(),i}),r=t.cache;return t}var Kte=Qte,Zte=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,$te=/\\(\\)?/g,Jte=Kte(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(Zte,function(r,i,n,s){t.push(n?s.replace($te,"$1"):i||r)}),t}),ere=Jte;function tre(e){return e==null?"":C$(e)}var rre=tre;function ire(e,t){return ga(e)?e:tte(e,t)?[e]:ere(rre(e))}var xd=ire,nre=1/0;function sre(e){if(typeof e=="string"||Hy(e))return e;var t=e+"";return t=="0"&&1/e==-nre?"-0":t}var Yy=sre;function are(e,t){t=xd(t,e);for(var r=0,i=t.length;e!=null&&r<i;)e=e[Yy(t[r++])];return r&&r==i?e:void 0}var dB=are;function ore(e,t){for(var r=-1,i=t.length,n=e.length;++r<i;)e[n+r]=t[r];return e}var Z3=ore,zP=ts?ts.isConcatSpreadable:void 0;function lre(e){return ga(e)||q3(e)||!!(zP&&e&&e[zP])}var cre=lre;function pB(e,t,r,i,n){var s=-1,a=e.length;for(r||(r=cre),n||(n=[]);++s<a;){var o=e[s];t>0&&r(o)?t>1?pB(o,t-1,r,i,n):Z3(n,o):i||(n[n.length]=o)}return n}var hre=pB;function ure(e){var t=e==null?0:e.length;return t?hre(e,1):[]}var dre=ure;function pre(e){return EJ(UJ(e,void 0,dre),e+"")}var fB=pre,fre=uB(Object.getPrototypeOf,Object),$3=fre,mre="[object Object]",gre=Function.prototype,vre=Object.prototype,mB=gre.toString,yre=vre.hasOwnProperty,xre=mB.call(Object);function wre(e){if(!uo(e)||Gc(e)!=mre)return!1;var t=$3(e);if(t===null)return!0;var r=yre.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&mB.call(r)==xre}var bre=wre;function _re(e,t,r){var i=-1,n=e.length;t<0&&(t=-t>n?0:n+t),r=r>n?n:r,r<0&&(r+=n),n=t>r?0:r-t>>>0,t>>>=0;for(var s=Array(n);++i<n;)s[i]=e[i+t];return s}var Sre=_re;function Are(){this.__data__=new Wy,this.size=0}var Cre=Are;function Mre(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var Ere=Mre;function Tre(e){return this.__data__.get(e)}var Pre=Tre;function Dre(e){return this.__data__.has(e)}var Lre=Dre,Ire=200;function Ore(e,t){var r=this.__data__;if(r instanceof Wy){var i=r.__data__;if(!Nf||i.length<Ire-1)return i.push([e,t]),this.size=++r.size,this;r=this.__data__=new Xy(i)}return r.set(e,t),this.size=r.size,this}var Rre=Ore;function wd(e){var t=this.__data__=new Wy(e);this.size=t.size}wd.prototype.clear=Cre;wd.prototype.delete=Ere;wd.prototype.get=Pre;wd.prototype.has=Lre;wd.prototype.set=Rre;var Tv=wd;function Bre(e,t){return e&&gm(t,Y3(t),e)}var zre=Bre;function kre(e,t){return e&&gm(t,Q3(t),e)}var Nre=kre,gB=typeof bn=="object"&&bn&&!bn.nodeType&&bn,kP=gB&&typeof _n=="object"&&_n&&!_n.nodeType&&_n,Fre=kP&&kP.exports===gB,NP=Fre?Is.Buffer:void 0,FP=NP?NP.allocUnsafe:void 0;function Ure(e,t){if(t)return e.slice();var r=e.length,i=FP?FP(r):new e.constructor(r);return e.copy(i),i}var jre=Ure;function Vre(e,t){for(var r=-1,i=e==null?0:e.length,n=0,s=[];++r<i;){var a=e[r];t(a,r,e)&&(s[n++]=a)}return s}var Hre=Vre;function Gre(){return[]}var vB=Gre,Wre=Object.prototype,qre=Wre.propertyIsEnumerable,UP=Object.getOwnPropertySymbols,Xre=UP?function(e){return e==null?[]:(e=Object(e),Hre(UP(e),function(t){return qre.call(e,t)}))}:vB,J3=Xre;function Yre(e,t){return gm(e,J3(e),t)}var Qre=Yre,Kre=Object.getOwnPropertySymbols,Zre=Kre?function(e){for(var t=[];e;)Z3(t,J3(e)),e=$3(e);return t}:vB,yB=Zre;function $re(e,t){return gm(e,yB(e),t)}var Jre=$re;function eie(e,t,r){var i=t(e);return ga(e)?i:Z3(i,r(e))}var xB=eie;function tie(e){return xB(e,Y3,J3)}var C2=tie;function rie(e){return xB(e,Q3,yB)}var wB=rie,iie=qc(Is,"DataView"),M2=iie,nie=qc(Is,"Promise"),E2=nie,sie=qc(Is,"Set"),T2=sie,jP="[object Map]",aie="[object Object]",VP="[object Promise]",HP="[object Set]",GP="[object WeakMap]",WP="[object DataView]",oie=Wc(M2),lie=Wc(Nf),cie=Wc(E2),hie=Wc(T2),uie=Wc(A2),Zl=Gc;(M2&&Zl(new M2(new ArrayBuffer(1)))!=WP||Nf&&Zl(new Nf)!=jP||E2&&Zl(E2.resolve())!=VP||T2&&Zl(new T2)!=HP||A2&&Zl(new A2)!=GP)&&(Zl=function(e){var t=Gc(e),r=t==aie?e.constructor:void 0,i=r?Wc(r):"";if(i)switch(i){case oie:return WP;case lie:return jP;case cie:return VP;case hie:return HP;case uie:return GP}return t});var Ff=Zl,die=Object.prototype,pie=die.hasOwnProperty;function fie(e){var t=e.length,r=new e.constructor(t);return t&&typeof e[0]=="string"&&pie.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var mie=fie,gie=Is.Uint8Array,I0=gie;function vie(e){var t=new e.constructor(e.byteLength);return new I0(t).set(new I0(e)),t}var eA=vie;function yie(e,t){var r=t?eA(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}var xie=yie,wie=/\w*$/;function bie(e){var t=new e.constructor(e.source,wie.exec(e));return t.lastIndex=e.lastIndex,t}var _ie=bie,qP=ts?ts.prototype:void 0,XP=qP?qP.valueOf:void 0;function Sie(e){return XP?Object(XP.call(e)):{}}var Aie=Sie;function Cie(e,t){var r=t?eA(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var Mie=Cie,Eie="[object Boolean]",Tie="[object Date]",Pie="[object Map]",Die="[object Number]",Lie="[object RegExp]",Iie="[object Set]",Oie="[object String]",Rie="[object Symbol]",Bie="[object ArrayBuffer]",zie="[object DataView]",kie="[object Float32Array]",Nie="[object Float64Array]",Fie="[object Int8Array]",Uie="[object Int16Array]",jie="[object Int32Array]",Vie="[object Uint8Array]",Hie="[object Uint8ClampedArray]",Gie="[object Uint16Array]",Wie="[object Uint32Array]";function qie(e,t,r){var i=e.constructor;switch(t){case Bie:return eA(e);case Eie:case Tie:return new i(+e);case zie:return xie(e,r);case kie:case Nie:case Fie:case Uie:case jie:case Vie:case Hie:case Gie:case Wie:return Mie(e,r);case Pie:return new i;case Die:case Oie:return new i(e);case Lie:return _ie(e);case Iie:return new i;case Rie:return Aie(e)}}var Xie=qie;function Yie(e){return typeof e.constructor=="function"&&!W3(e)?uJ($3(e)):{}}var Qie=Yie,Kie="[object Map]";function Zie(e){return uo(e)&&Ff(e)==Kie}var $ie=Zie,YP=qu&&qu.isMap,Jie=YP?X3(YP):$ie,ene=Jie,tne="[object Set]";function rne(e){return uo(e)&&Ff(e)==tne}var ine=rne,QP=qu&&qu.isSet,nne=QP?X3(QP):ine,sne=nne,ane=1,one=2,lne=4,bB="[object Arguments]",cne="[object Array]",hne="[object Boolean]",une="[object Date]",dne="[object Error]",_B="[object Function]",pne="[object GeneratorFunction]",fne="[object Map]",mne="[object Number]",SB="[object Object]",gne="[object RegExp]",vne="[object Set]",yne="[object String]",xne="[object Symbol]",wne="[object WeakMap]",bne="[object ArrayBuffer]",_ne="[object DataView]",Sne="[object Float32Array]",Ane="[object Float64Array]",Cne="[object Int8Array]",Mne="[object Int16Array]",Ene="[object Int32Array]",Tne="[object Uint8Array]",Pne="[object Uint8ClampedArray]",Dne="[object Uint16Array]",Lne="[object Uint32Array]",Kt={};Kt[bB]=Kt[cne]=Kt[bne]=Kt[_ne]=Kt[hne]=Kt[une]=Kt[Sne]=Kt[Ane]=Kt[Cne]=Kt[Mne]=Kt[Ene]=Kt[fne]=Kt[mne]=Kt[SB]=Kt[gne]=Kt[vne]=Kt[yne]=Kt[xne]=Kt[Tne]=Kt[Pne]=Kt[Dne]=Kt[Lne]=!0;Kt[dne]=Kt[_B]=Kt[wne]=!1;function Pv(e,t,r,i,n,s){var a,o=t&ane,l=t&one,c=t&lne;if(r&&(a=n?r(e,i,n,s):r(e)),a!==void 0)return a;if(!Ls(e))return e;var u=ga(e);if(u){if(a=mie(e),!o)return mJ(e,a)}else{var h=Ff(e),d=h==_B||h==pne;if(L0(e))return jre(e,o);if(h==SB||h==bB||d&&!n){if(a=l||d?{}:Qie(e),!o)return l?Jre(e,Nre(a,e)):Qre(e,zre(a,e))}else{if(!Kt[h])return n?e:{};a=Xie(e,h,o)}}s||(s=new Tv);var p=s.get(e);if(p)return p;s.set(e,a),sne(e)?e.forEach(function(g){a.add(Pv(g,t,r,g,e,s))}):ene(e)&&e.forEach(function(g,v){a.set(v,Pv(g,t,r,v,e,s))});var f=c?l?wB:C2:l?Q3:Y3,m=u?void 0:f(e);return PJ(m||e,function(g,v){m&&(v=g,g=e[v]),H3(a,v,Pv(g,t,r,v,e,s))}),a}var AB=Pv,Ine=1,One=4;function Rne(e){return AB(e,Ine|One)}var Qy=Rne,Bne="__lodash_hash_undefined__";function zne(e){return this.__data__.set(e,Bne),this}var kne=zne;function Nne(e){return this.__data__.has(e)}var Fne=Nne;function O0(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new Xy;++t<r;)this.add(e[t])}O0.prototype.add=O0.prototype.push=kne;O0.prototype.has=Fne;var Une=O0;function jne(e,t){for(var r=-1,i=e==null?0:e.length;++r<i;)if(t(e[r],r,e))return!0;return!1}var Vne=jne;function Hne(e,t){return e.has(t)}var Gne=Hne,Wne=1,qne=2;function Xne(e,t,r,i,n,s){var a=r&Wne,o=e.length,l=t.length;if(o!=l&&!(a&&l>o))return!1;var c=s.get(e),u=s.get(t);if(c&&u)return c==t&&u==e;var h=-1,d=!0,p=r&qne?new Une:void 0;for(s.set(e,t),s.set(t,e);++h<o;){var f=e[h],m=t[h];if(i)var g=a?i(m,f,h,t,e,s):i(f,m,h,e,t,s);if(g!==void 0){if(g)continue;d=!1;break}if(p){if(!Vne(t,function(v,y){if(!Gne(p,y)&&(f===v||n(f,v,r,i,s)))return p.push(y)})){d=!1;break}}else if(!(f===m||n(f,m,r,i,s))){d=!1;break}}return s.delete(e),s.delete(t),d}var CB=Xne;function Yne(e){var t=-1,r=Array(e.size);return e.forEach(function(i,n){r[++t]=[n,i]}),r}var Qne=Yne;function Kne(e){var t=-1,r=Array(e.size);return e.forEach(function(i){r[++t]=i}),r}var Zne=Kne,$ne=1,Jne=2,ese="[object Boolean]",tse="[object Date]",rse="[object Error]",ise="[object Map]",nse="[object Number]",sse="[object RegExp]",ase="[object Set]",ose="[object String]",lse="[object Symbol]",cse="[object ArrayBuffer]",hse="[object DataView]",KP=ts?ts.prototype:void 0,Vx=KP?KP.valueOf:void 0;function use(e,t,r,i,n,s,a){switch(r){case hse:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case cse:return!(e.byteLength!=t.byteLength||!s(new I0(e),new I0(t)));case ese:case tse:case nse:return V3(+e,+t);case rse:return e.name==t.name&&e.message==t.message;case sse:case ose:return e==t+"";case ise:var o=Qne;case ase:var l=i&$ne;if(o||(o=Zne),e.size!=t.size&&!l)return!1;var c=a.get(e);if(c)return c==t;i|=Jne,a.set(e,t);var u=CB(o(e),o(t),i,n,s,a);return a.delete(e),u;case lse:if(Vx)return Vx.call(e)==Vx.call(t)}return!1}var dse=use,pse=1,fse=Object.prototype,mse=fse.hasOwnProperty;function gse(e,t,r,i,n,s){var a=r&pse,o=C2(e),l=o.length,c=C2(t),u=c.length;if(l!=u&&!a)return!1;for(var h=l;h--;){var d=o[h];if(!(a?d in t:mse.call(t,d)))return!1}var p=s.get(e),f=s.get(t);if(p&&f)return p==t&&f==e;var m=!0;s.set(e,t),s.set(t,e);for(var g=a;++h<l;){d=o[h];var v=e[d],y=t[d];if(i)var x=a?i(y,v,d,t,e,s):i(v,y,d,e,t,s);if(!(x===void 0?v===y||n(v,y,r,i,s):x)){m=!1;break}g||(g=d=="constructor")}if(m&&!g){var w=e.constructor,b=t.constructor;w!=b&&"constructor"in e&&"constructor"in t&&!(typeof w=="function"&&w instanceof w&&typeof b=="function"&&b instanceof b)&&(m=!1)}return s.delete(e),s.delete(t),m}var vse=gse,yse=1,ZP="[object Arguments]",$P="[object Array]",bg="[object Object]",xse=Object.prototype,JP=xse.hasOwnProperty;function wse(e,t,r,i,n,s){var a=ga(e),o=ga(t),l=a?$P:Ff(e),c=o?$P:Ff(t);l=l==ZP?bg:l,c=c==ZP?bg:c;var u=l==bg,h=c==bg,d=l==c;if(d&&L0(e)){if(!L0(t))return!1;a=!0,u=!1}if(d&&!u)return s||(s=new Tv),a||cB(e)?CB(e,t,r,i,n,s):dse(e,t,l,r,i,n,s);if(!(r&yse)){var p=u&&JP.call(e,"__wrapped__"),f=h&&JP.call(t,"__wrapped__");if(p||f){var m=p?e.value():e,g=f?t.value():t;return s||(s=new Tv),n(m,g,r,i,s)}}return d?(s||(s=new Tv),vse(e,t,r,i,n,s)):!1}var bse=wse;function MB(e,t,r,i,n){return e===t?!0:e==null||t==null||!uo(e)&&!uo(t)?e!==e&&t!==t:bse(e,t,r,i,MB,n)}var _se=MB;function Sse(e,t){return e!=null&&t in Object(e)}var Ase=Sse;function Cse(e,t,r){t=xd(t,e);for(var i=-1,n=t.length,s=!1;++i<n;){var a=Yy(t[i]);if(!(s=e!=null&&r(e,a)))break;e=e[a]}return s||++i!=n?s:(n=e==null?0:e.length,!!n&&G3(n)&&j3(a,n)&&(ga(e)||q3(e)))}var Mse=Cse;function Ese(e,t){return e!=null&&Mse(e,t,Ase)}var Tse=Ese,Pse=function(){return Is.Date.now()},Hx=Pse,Dse="Expected a function",Lse=Math.max,Ise=Math.min;function Ose(e,t,r){var i,n,s,a,o,l,c=0,u=!1,h=!1,d=!0;if(typeof e!="function")throw new TypeError(Dse);t=EP(t)||0,Ls(r)&&(u=!!r.leading,h="maxWait"in r,s=h?Lse(EP(r.maxWait)||0,t):s,d="trailing"in r?!!r.trailing:d);function p(_){var A=i,S=n;return i=n=void 0,c=_,a=e.apply(S,A),a}function f(_){return c=_,o=setTimeout(v,t),u?p(_):a}function m(_){var A=_-l,S=_-c,C=t-A;return h?Ise(C,s-S):C}function g(_){var A=_-l,S=_-c;return l===void 0||A>=t||A<0||h&&S>=s}function v(){var _=Hx();if(g(_))return y(_);o=setTimeout(v,m(_))}function y(_){return o=void 0,d&&i?p(_):(i=n=void 0,a)}function x(){o!==void 0&&clearTimeout(o),c=0,i=l=n=o=void 0}function w(){return o===void 0?a:y(Hx())}function b(){var _=Hx(),A=g(_);if(i=arguments,n=this,l=_,A){if(o===void 0)return f(l);if(h)return clearTimeout(o),o=setTimeout(v,t),p(l)}return o===void 0&&(o=setTimeout(v,t)),a}return b.cancel=x,b.flush=w,b}var tA=Ose;function Rse(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var Bse=Rse;function zse(e,t){return t.length<2?e:dB(e,Sre(t,0,-1))}var kse=zse;function Nse(e,t){return _se(e,t)}var rA=Nse;function Fse(e,t){return t=xd(t,e),e=kse(e,t),e==null||delete e[Yy(Bse(t))]}var Use=Fse;function jse(e){return bre(e)?void 0:e}var Vse=jse,Hse=1,Gse=2,Wse=4,qse=fB(function(e,t){var r={};if(e==null)return r;var i=!1;t=tB(t,function(s){return s=xd(s,e),i||(i=s.length>1),s}),gm(e,wB(e),r),i&&(r=AB(r,Hse|Gse|Wse,Vse));for(var n=t.length;n--;)Use(r,t[n]);return r}),P2=qse;function Xse(e,t,r,i){if(!Ls(e))return e;t=xd(t,e);for(var n=-1,s=t.length,a=s-1,o=e;o!=null&&++n<s;){var l=Yy(t[n]),c=r;if(l==="__proto__"||l==="constructor"||l==="prototype")return e;if(n!=a){var u=o[l];c=i?i(u,l,o):void 0,c===void 0&&(c=Ls(u)?u:j3(t[n+1])?[]:{})}H3(o,l,c),o=o[l]}return e}var Yse=Xse;function Qse(e,t,r){for(var i=-1,n=t.length,s={};++i<n;){var a=t[i],o=dB(e,a);r(o,a)&&Yse(s,xd(a,e),o)}return s}var Kse=Qse;function Zse(e,t){return Kse(e,t,function(r,i){return Tse(e,i)})}var $se=Zse,Jse=fB(function(e,t){return e==null?{}:$se(e,t)}),no=Jse,eae="Expected a function";function tae(e,t,r){var i=!0,n=!0;if(typeof e!="function")throw new TypeError(eae);return Ls(r)&&(i="leading"in r?!!r.leading:i,n="trailing"in r?!!r.trailing:n),tA(e,t,{leading:i,maxWait:t,trailing:n})}var rae=tae;function iae(e){for(let t of Object.keys(e))e[t]===void 0&&delete e[t];return e}function Bc(e,t){return Object.setPrototypeOf(e,t),e}var nae=()=>typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().includes(" electron/"),sae=()=>typeof window>"u"?!1:window.navigator.platform.toUpperCase().includes("MAC"),aae=()=>typeof window>"u"?!1:/iPad|iPhone|iPod/.test(window.navigator.userAgent)||Ky&&"ontouchend"in document,oae=()=>typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1,lae=()=>typeof window>"u"?!1:"ontouchstart"in window||navigator.maxTouchPoints>0,cae=()=>{if(typeof window>"u")return!1;let e=navigator.userAgent,t=navigator.vendor;return/Safari/i.test(e)&&/Apple Computer/.test(t)},hae=()=>{if(typeof window>"u")return null;let e=navigator.userAgent.match(/Version\/(\d+\.\d)/);return e&&e[1]},uae=()=>{if(typeof window>"u")return;let e=new URLSearchParams(window.location.search).get("desktop-app-version");return e?(window.localStorage.setItem("desktop-app-version",e),e):window.localStorage.getItem("desktop-app-version")??"0.0.6"},dae=nae();dae&&uae();var Ky=sae(),EB=aae(),pae=oae(),wn=lae(),e4=cae(),t4=Number(hae());function TB(e){return Array.isArray(e)?e:[e]}function fae(e,t){let r=0;for(;r<e.length&&r<t.length;){if(e[r]<t[r])return-1;if(e[r]>t[r])return 1;r+=1}return r!==t.length?-1:r!==e.length?1:0}function _g(e){return Ky?e.metaKey:e.ctrlKey}var et=[],R0={},Ep={},Dv={};function PB(e){et.includes(e)||et.push(e)}function vu(e){delete R0[e.pointerId];for(let t=0;t<et.length;t++)if(et[t].pointerId===e.pointerId){et.splice(t,1);break}}function mae(){et.splice(0,et.length)}function B0(e){if(e.pointerType!=="touch")return;let t=R0[e.pointerId];t===void 0&&(t={x:0,y:0},R0[e.pointerId]=t),t.x=e.pageX,t.y=e.pageY}function Gx(e){let t=e.pointerId===et[0].pointerId?et[1]:et[0];return R0[t.pointerId]}function DB(e){Ep[e.key]=!0,Dv[e.key]=Dv[e.key]===void 0?1:Dv[e.key]+1}function LB(e){if(Ky&&Ep.Meta)for(let t in Ep)Ep[t]=!1;else Ep[e.key]=!1;Dv={}}function gae(e){e.addEventListener("pointerdown",PB,!0),e.addEventListener("pointerdown",B0,!0),e.addEventListener("pointermove",B0,!0),e.addEventListener("pointerup",vu,!0),e.addEventListener("pointercancel",vu,!0),e.addEventListener("pointerleave",vu,!0),window.addEventListener("keydown",DB,!0),window.addEventListener("keyup",LB,!0)}function vae(e){e.removeEventListener("pointerdown",PB,!0),e.removeEventListener("pointerdown",B0,!0),e.removeEventListener("pointermove",B0,!0),e.removeEventListener("pointerup",vu,!0),e.removeEventListener("pointercancel",vu,!0),e.removeEventListener("pointerleave",vu,!0),window.removeEventListener("keydown",DB,!0),window.removeEventListener("keyup",LB,!0)}var IB,yae=new Promise(e=>{IB=e}),Sg;function xae(){if(Sg)return Sg;async function e(){let t="https://unpkg.com/@splinetool/navmesh-wasm@0.9.450/build",r=cm(()=>import("./navmesh-0b92f809.js"),[]),[i,n]=await Promise.all([r,fetch(`${t}/navmesh.wasm`).then(o=>o.arrayBuffer())]),s=i.default,a=await s({wasmBinary:n});IB(a)}return Sg=e(),Sg}var OB,wae=new Promise(e=>{OB=e}),Ag;function bae(){if(Ag)return Ag;async function e(){let t=await cm(()=>import("./physics-dee4de67.js"),[]);await t.init(),OB(t)}return Ag=e(),Ag}var wt=class{modifyById(e,t){let r=this;if(r[e]===void 0)throw new Error("not expected");{let i={...r,[e]:t};return Object.setPrototypeOf(i,wt.prototype),i}}add(e,t){var r;return((r=this.runOp({type:1,id:e,data:t}))==null?void 0:r.data)??this}runOp(e){let t=this;if(e.type===1){let r=t[e.id],i;r===void 0?i={type:2,id:e.id}:i={type:1,id:e.id,data:r};let{id:n,data:s}=e,a={...t,[n]:s};return Object.setPrototypeOf(a,wt.prototype),{data:a,actual:e,reverse:i}}else if(e.type===2){let{id:r}=e,i=t[r];if(i===void 0)return null;{let n={...t};return Object.setPrototypeOf(n,wt.prototype),delete n[r],{data:n,actual:e,reverse:{type:1,id:r,data:i}}}}return null}};function iA(e){if(e.deepFreeze!==void 0){e.deepFreeze(e);return}let t=Object.getOwnPropertyNames(e);for(let r of t){let i=e[r];i&&typeof i=="object"&&iA(i)}return Object.freeze(e)}function _ae(e,t){let r=0;for(;r<e.length&&r<t.length;){if(e[r]<t[r])return-1;if(e[r]>t[r])return 1;r+=1}return r!==t.length?-1:r!==e.length?1:0}var RB=class extends Error{};function Wx(e){let t={...e};return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),t}function Qo(e,t,r){if(e===void 0?t===void 0?(e=0,t=10):e=t-10:t===void 0&&(t=e+10),e>t){let s=e;e=t,t=s}let i=[],n=1/(r+1);for(let s=0;s<r;s++){let a=e+(t-e)*(s+.75+Math.random()*.5)*n;i.push(a)}return i}function nA(e){return e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Float32Array||e instanceof Float64Array}function Sae(){return typeof process<"u"}function BB(e,t){for(let r of e)t(r.id,r.data)!==!0&&BB(r.children,t)}function zB(e,t){if(t(e.id,e.data)!==!0)for(let r of e.children)zB(r,t)}var rn=class extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,rn.prototype)}deepFreeze(){let e=0;for(;e<this.length;)iA(this[e]),e++}fillCaches0(e,t){this.objCaches.set(e.id,e),this.parentCaches.set(e.id,t);for(let r of e.children)this.fillCaches0(r,e.id)}fillCaches(){if(this.objCaches===void 0){this.objCaches=new Map,this.parentCaches=new Map;for(let e of this)this.fillCaches0(e,null)}}randomId(){this.fillCaches();let e=Array.from(this.objCaches.keys());if(e.length!==0)return e[Math.max(0,Math.floor(Math.random()*e.length)-1)]}nonExistOrDescendantOf(e,t){if(!this.has(e))return!0;for(;e;){let r=this.parent(e);if(r===t)return!0;e=r}return!1}rootAcestor(e){for(;e;){let t=this.parent(e);if(t)e=t;else return e}return e}isDescendantOf(e,t){for(;e;){let r=this.parent(e);if(r===t)return!0;e=r}return!1}data(e){var t;return(t=this.get(e))==null?void 0:t.data}has(e){return this.childrenOf(e)!==void 0}get(e){return this.fillCaches(),this.objCaches.get(e)}childrenOf(e){var t;return e===null?this:(t=this.get(e))==null?void 0:t.children}traverseFrom(e,t){if(e===null)this.traverse(t);else{let r=this.get(e);r&&zB(r,t)}}traverse(e){BB(this,e)}totalSize(){return this.fillCaches(),this.objCaches.size}parent(e){return this.fillCaches(),this.parentCaches.get(e)}childrenArray(e){return e===null?this:this.get(e).children}modifyById(e,t){if(this.get(e)===void 0)throw new Error("not expected");{let r=this.parent(e),i=this.childrenArray(r),n=i.findIndex(a=>a.id===e);if(n<0)throw new Error("not expected");let s=i[n];return i=[...i],i[n]={...s,data:t},this.modifyArrayBy(r,i)}}modifyArrayBy(e,t){let r=e,i=t;for(;r!==null;){let s=i,a=r;if(r=this.parent(r),r===void 0)throw new Error;i=this.childrenArray(r);let o=i.findIndex(l=>l.id===a);if(o<0)throw new Error;i=[...i],i[o]={...i[o],children:s}}Object.setPrototypeOf(i,rn.prototype);let n=i;return n.fillCaches(),n}runOp(e){switch(e.type){case 7:return this.addOp(e);case 8:return this.deleteOp(e);case 9:return this.moveOp(e)}return null}checkDuplicatedIdRec({id:e,children:t}){if(this.get(e)!==void 0)return!0;for(let r of t)if(this.checkDuplicatedIdRec(r))return!0;return!1}addOp(e){let{parent:t,fi:r,id:i,data:n,children:s}=e;if(t!==null&&this.get(t)===void 0||this.checkDuplicatedIdRec(e))return null;{let a=t,o=this.childrenArray(a),l={fi:r,id:i,data:n,children:s};return o=[...o,l],o.sort((c,u)=>c.fi-u.fi),e.localIndex=o.indexOf(l),{data:this.modifyArrayBy(a,o),actual:e,reverse:{type:8,id:i}}}}deleteOp(e){let{id:t}=e;if(this.get(t)===null)return null;{let r=this.parent(t);if(r===void 0)return null;let i=this.childrenArray(r),n=i.findIndex(a=>a.id===t);e.localIndex=n,i=[...i];let s=i.splice(n,1)[0];return{data:this.modifyArrayBy(r,i),actual:e,reverse:{type:7,...s,parent:r}}}}moveOp(e){let{parent:t,fi:r,id:i}=e;if(t!==null&&this.get(t)===void 0)return this.deleteOp({type:8,id:i});if(t!==null){let h=t;for(;h!==null;){if(h===void 0)throw new Error;if(h===i)throw new RB("cyclic tree");h=this.parent(h)}}let n=this.parent(i);if(n===void 0)return null;let s=n,a=this.childrenArray(n),o=a.findIndex(h=>h.id===i);a=[...a];let l=a.splice(o,1)[0],c=this.modifyArrayBy(n,a);n=t,a=c.childrenArray(n);let u=l.fi;return l={...l,fi:r},a=[...a,l],a.sort((h,d)=>h.fi-d.fi),e.localIndex=a.indexOf(l),c=c.modifyArrayBy(n,a),{data:c,actual:e,reverse:{type:9,parent:s,fi:u,id:i}}}previous(e,t){if(t===null){let i=this.childrenArray(e);return i.length===0?null:i[i.length-1].id}let r=null;for(let i of this.childrenArray(e)){if(i.id===t)return r;r=i.id}return null}traverseSortNext(e){let t=this.parent(e);if(t!==void 0){let r=this.childrenArray(t),i=r.findIndex(n=>n.id===e)+1;if(i<r.length)return r[i].id;if(t)return this.traverseSortNext(t)}}sortNext(e){let t=this.childrenArray(e);return t.length>0?t[0].id:this.traverseSortNext(e)}traverseSortPrevious(e){let t=this.childrenArray(e);return t.length>0?this.traverseSortPrevious(t[t.length-1].id):e}sortPrevious(e){let t=this.parent(e);if(t!==void 0){let r=this.childrenArray(t),i=r.findIndex(n=>n.id===e)-1;return i>=0?this.traverseSortPrevious(r[i].id):t}}getAllSorted(e){let t=[];for(let r of e){let i=this.getWithSortKey(r.id);i!==void 0&&t.push({...r,...i})}t.sort((r,i)=>_ae(r.sortKey,i.sortKey));for(let r of t)delete r.sortKey;return t}getWithSortKey(e){var t=e;let r=[],i=this.get(t),n=i;if(i!==void 0){for(;t;)r.splice(0,0,i.fi),t=this.parent(t),t!==null&&(i=this.get(t));return{...n,sortKey:r}}}insertBeforeHelper(e,t,r){return this.insertAfterHelper(e,this.previous(e,t),r)}insertAfterHelper(e,t,r){let i=this.childrenArray(e);if(t===null){if(i.length===0)return Qo(0,r,r);{let n=i[0].fi;return Qo(n-r,n,r)}}else{let n=this.get(t);if(n===void 0||this.parent(t)!==e)throw new Error("illegal args");let s=i.find(a=>a.fi>n.fi);if(s===void 0){let a=i[i.length-1].fi;return Qo(a,a+r,r)}else return Qo(n.fi,s.fi,r)}}},z0;(e=>{function t(r,i){if(i.type!==0)return null;if(Array.isArray(r)){let n=i.props,s={},a=[...r],o=!1;if(n)for(let l of Object.keys(n)){let c=parseInt(l);if(isNaN(c))throw new Error("wrong index");s[l]=a[c],a[c]=n[l],o=!0}return o?{data:a,actual:i,reverse:{type:0,props:s}}:null}else{let n=i.props,s={},a={...r},o=!1;if(n)for(let l of Object.keys(n)){s[l]=a[l];let c=n[l];c===void 0?delete a[l]:a[l]=c,o=!0}return o?{data:a,actual:i,reverse:{type:0,props:s}}:null}}e.runOp=t})(z0||(z0={}));var st=class extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,st.prototype)}deepFreeze(){let e=0;for(;e<this.length;)iA(this[e]),e++}fillCaches0(e){this.objCaches.set(e.id,e)}fillCaches(){if(this.objCaches===void 0){this.objCaches=new Map,Object.getOwnPropertyDescriptor(this,"objCaches").enumerable=!1;for(let e of this)this.fillCaches0(e)}}randomId(){this.fillCaches();let e=Array.from(this.objCaches.keys());if(e.length!==0)return e[Math.max(0,Math.floor(Math.random()*e.length)-1)]}data(e){var t;return(t=this.get(e))==null?void 0:t.data}get(e){return this.fillCaches(),this.objCaches.get(e)}modifyById(e,t){if(this.get(e)===void 0)throw new Error("not expected");{let r=this,i=r.findIndex(s=>s.id===e);if(i<0)throw new Error("not expected");let n=r[i];return r=[...r],r[i]={...n,data:t},this.modifyArrayBy(r)}}modifyArrayBy(e){Object.setPrototypeOf(e,st.prototype);let t=e;return Sae()||t.fillCaches(),t}runOp(e){switch(e.type){case 4:return this.addOp(e);case 5:return this.deleteOp(e);case 6:return this.moveOp(e)}return null}addOp(e){let{fi:t,id:r,data:i}=e,n=this,s={fi:t,id:r,data:i};return n=[...n,s],n.sort((a,o)=>a.fi-o.fi),e.localIndex=n.indexOf(s),{data:this.modifyArrayBy(n),actual:e,reverse:{type:5,id:r}}}deleteOp(e){let{id:t}=e,r=this,i=r.findIndex(s=>s.id===t);if(i===-1)return null;e.localIndex=i,r=[...r];let n=r.splice(i,1)[0];return{data:this.modifyArrayBy(r),actual:e,reverse:{type:4,...n}}}moveOp(e){let{fi:t,id:r}=e,i=this;i=[...i];let n=i.findIndex(o=>o.id===r);if(n===-1)return null;let s=i[n].fi,a={...i[n],fi:t};return i[n]=a,i.sort((o,l)=>o.fi-l.fi),e.localIndex=i.indexOf(a),{data:this.modifyArrayBy(i),actual:e,reverse:{type:6,fi:s,id:r}}}previous(e){if(e===null)return this.length===0?null:this[this.length-1].id;let t=null;for(let r of this){if(r.id===e)return t;t=r.id}return null}insertBeforeHelper(e,t){return this.insertAfterHelper(this.previous(e),t)}insertAfterHelper(e,t){let r=this;if(e===null){if(r.length===0)return Qo(0,t,t);{let i=r[0].fi;return Qo(i-t,i,t)}}else{let i=this.get(e);if(i===void 0)throw new Error("illegal args");let n=r.find(s=>s.fi>i.fi);if(n===void 0){let s=r[r.length-1].fi;return Qo(s,s+t,t)}else return Qo(i.fi,n.fi,t)}}};function Xu(e){return e&&typeof e=="object"&&e instanceof Vr}var Vr=class{unusedFunOverridesTable(e){}runOp(e){let t=[],r=this,i=0,n={};for(;i<e.path.length;){if(t.push(r),r=r===void 0?void 0:r[e.path[i]],r!==void 0&&!Xu(r))return null;i+=1}r=r?Wx(r):new Vr;for(let[o,l]of Object.entries(e.props)){let c=r[o];n[o]=c,l===void 0?delete r[o]:r[o]=l}for(;i>0;){if(Object.keys(r).length===0){let o=t[i-1];o&&(r=Wx(o),delete r[e.path[i-1]])}else{let o=t[i-1];if(o){let l=Wx(o);l[e.path[i-1]]=r,r=l}else{let l=new Vr;l[e.path[i-1]]=r,r=l}}i-=1}let s=Object.setPrototypeOf(r,Vr.prototype),a={...e,props:n};return{data:s,actual:e,reverse:a}}},fl;(e=>{function t(n,s){return Uf(n,s)??n}e.apply=t;function r(n,s){return aA(n,s)}e.merge=r;function i(n,s){let a=0,o=s.path,l=n;for(;a<o.length&&l!==void 0;){if(l=ua.zoomOnce(l,o[a]),l===void 0)return s;if(!Xu(l))return;a+=1}if(l===void 0)return s;if(Xu(l))if(s.type===0){let c={...s.props};for(let u of Object.keys(l))delete c[u];return{...s,props:c}}else if(s.type===1||s.type===4||s.type===7){let c=sA([s],l);return c?(console.log(c),c):s}else return s}e.filterOp=i})(fl||(fl={}));function sA(e,t){if(t===void 0)return;let r=!1,i=e.map(n=>{let s=n.id,a=Uf(n.data,t[s]);if(r=r||a!==void 0,a===void 0&&(a=n.data),n.children){let o=sA(n.children,t);return o!==void 0?r=!0:o=n.children,{...n,id:s,data:a,children:o}}else return{...n,id:s,data:a}});if(r)return i}function Aae(e,t){if(t===void 0)return;let r=!1,i=e.map(n=>{let s=n.id,a=Uf(n.data,t[s]);return r=r||a!==void 0,a===void 0&&(a=n.data),{...n,id:s,data:a}});if(r)return Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i}function Uf(e,t){if(!Xu(t))return t;if(e instanceof rn){let r=sA(e,t);return r!==void 0&&Object.setPrototypeOf(r,Object.getPrototypeOf(e)),r}else{if(e instanceof st)return Aae(e,t);if(Array.isArray(e)){let r=!1,i=e.map((n,s)=>{let a=Uf(n,t[s]);return r=r||a!==void 0,a===void 0&&(a=n),a});return r?(Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i):void 0}else{if(e instanceof Vr)return aA(e,t);if(e&&typeof e=="object"){let r={},i=!1;for(let[n,s]of Object.entries(e)){let a=Uf(s,t[n]);i=i||a!==void 0,a===void 0&&(a=s),r[n]=a}return i?(Object.setPrototypeOf(r,Object.getPrototypeOf(e)),r):void 0}}}}function aA(e,t){if(e===void 0)return t;if(t===void 0)return e;if(!Xu(t))return t;if(!Xu(e))return fl.apply(e,t);let r=new Set;for(let n of Object.keys(e))r.add(n);for(let n of Object.keys(t))r.add(n);let i=new Vr;for(let n of r){let s=aA(e===void 0?void 0:e[n],t===void 0?void 0:t[n]);i[n]=s}return i}function Cae(e,t){let r={cur:[],result:[],len:0};return e=jf(e,t,r)??e,[e,r.result]}function k0(e,t){return e===null?null:(e.cur[e.len]=t,e.len+=1,e)}function N0(e){e&&(e.len-=1)}function Mae(e){if(e===null)return null;e.result.push(e.cur.slice(0,e.len))}function kB(e,t,r){let i=!1,n=e.map(s=>{let a=s.id,o=t[a];if(o!==void 0&&typeof o=="string"&&(i=!0,a=o,r!==null))throw new Error("not supported");let l=jf(s.data,t,k0(r,a));N0(r),i=i||l!==void 0,l===void 0&&(l=s.data);let c=kB(s.children,t,r);return c!==void 0?i=!0:c=s.children,{...s,id:a,data:l,children:c}});if(i)return n}function Eae(e,t,r){let i=!1,n=e.map(s=>{let a=s.id,o=t[a];if(o!==void 0&&typeof o=="string"&&(i=!0,a=o,r!==null))throw new Error("not supported");let l=jf(s.data,t,k0(r,a));return N0(r),i=i||l!==void 0,l===void 0&&(l=s.data),{...s,id:a,data:l}});if(i)return Object.setPrototypeOf(n,Object.getPrototypeOf(e)),n}function jf(e,t,r){if(e instanceof rn){let i=kB(e,t,r);return i!==void 0&&Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i}else{if(e instanceof st)return Eae(e,t,r);if(Array.isArray(e)){let i=!1,n=e.map((s,a)=>{let o=jf(s,t,k0(r,a));return N0(r),i=i||o!==void 0,o===void 0&&(o=s),o});return i?(Object.setPrototypeOf(n,Object.getPrototypeOf(e)),n):void 0}else if(e&&typeof e=="object"&&!nA(e)){let i={},n=!1;for(let[s,a]of Object.entries(e))if(s!=="name"&&s!=="text"){let o=t[s];if(typeof o=="string"){if(r!==null)throw new Error("not supported");n=!0,s=o}let l=jf(a,t,k0(r,s));N0(r),n=n||l!==void 0,l===void 0&&(l=a),i[s]=l}else i[s]=a;return n?(Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i):void 0}else if(typeof e=="string"){let i=t[e];return i!==void 0&&Mae(r),i}else return}}var D2;(e=>{function t(r,i){let n=ua.zoom(i,r.path);if(typeof n=="object"){let s={};for(let a of Object.keys(r.props))s[a]=n[a];return{...r,props:s}}else return{...r,props:{}}}e.replaceProps=t})(D2||(D2={}));var Ri;(e=>{function t(l,c){return{...l,path:l.path.slice(c)}}e.drop=t;function r(l,c){var u;return((u=i(l,c))==null?void 0:u.data)??l}e.applySimple=r;function i(l,c){var d,p;let u=c.path;for(var h=[];;){let f;if(l instanceof Vr&&c.type===0&&(f=l.runOp({...c,path:u.slice(h.length)}),f===null&&(f=void 0)),f===void 0&&h.length===u.length&&(l instanceof rn||l instanceof st||l instanceof wt?f=l.runOp(c):f=z0.runOp(l,c)),f!==void 0)if(f!==null){let v=f.data;for(let y=h.length-1;y>=0;y--){let x=u[y],w=h[y];if(w instanceof rn){if(typeof x=="number")throw new Error("illegal arg");v=w.modifyById(x,v)}else if(w instanceof st){if(typeof x=="number")throw new Error("illegal arg");v=w.modifyById(x,v)}else if(w instanceof wt){if(typeof x=="number")throw new Error("illegal arg");v=w.modifyById(x,v)}else if(w instanceof Vr){let b={...w,[x]:v};v=Object.setPrototypeOf(b,Vr.prototype)}else if(typeof w=="object")if(Array.isArray(w)){if(typeof x=="string"&&(x=parseInt(x),isNaN(x)))throw new Error("Invalid path");let b=v;v=[...w],v[x]=b}else v={...w,[x]:v};else return null}return{data:v,actual:{...f.actual,path:u},reverse:{...f.reverse,path:u}}}else return null;let m=u[h.length],g;if(l instanceof rn){if(typeof m=="number")throw new Error("");g=(d=l.get(m))==null?void 0:d.data}else if(l instanceof st){if(typeof m=="number")throw new Error("");g=(p=l.get(m))==null?void 0:p.data}else l!==null&&(g=l[m]);if(g!==void 0)h.push(l),l=g;else return null}}e.apply=i;function n(l,c){for(let u=0;u<l.length&&u<c.length;u++)if(l[u]!==c[u])return!0;return!1}e.pathDisjoint=n;function s(l,c){if(l.length!==c.length)return!1;for(let u=0;u<l.length;u++)if(l[u]!==c[u])return!1;return!0}e.pathEq=s;function a(l,c){return n(l.path,c.path)}e.commutative=a;function o(l,c){return l.type===0&&c.type===0&&s(l.path,c.path)?Object.keys(l.props).every(u=>c.props[u]!==void 0):!1}e.subsumed=o})(Ri||(Ri={}));var L2;(e=>{function t(){return[]}e.empty=t;function r(c,u){let h=[];for(let d of c){let[p,...f]=d.path;p===u&&h.push({...d,path:f})}return h}e.removePrefix=r;function i(c,u){return c.map(h=>({...h,path:[u,...h.path]}))}e.addPrefix=i;function n(c,u){return[...c,...u]}e.concat=n;function s(c,u){return[...c.filter(h=>!u.some(d=>Ri.subsumed(h,d))),...u]}e.compress=s;function a(c,u){return c.every(h=>u.every(d=>Ri.commutative(h,d)))}e.commutative=a;function o(c,u){for(let h of u){let d=l(c,h);d!==null&&(c=d.data)}return c}e.applyAll=o;function l(c,u){var h=c;let d=[],p=[];for(let f of u)try{if(f.type===3){let m=ua.zoom(h,[...f.path,f.id]),g=Ri.apply(h,{...f,type:2});if(g!==null){h=g.data;let[v,y]=Cae(h,{[f.id]:m});h=v;for(let x of y){let w=x[x.length-1];x.splice(x.length-1,1),d.push({type:0,path:x,props:{[w]:m}}),p.push({type:0,path:x,props:{[w]:f.id}})}p.push(g.reverse),d.push(g.actual)}}else{let m=Ri.apply(h,f);m!==null&&(d.push(m.actual),h=m.data,p.push(m.reverse))}}catch(m){if(m instanceof RB)return null;throw m}return{data:h,actual:d,reverse:p.reverse()}}e.apply=l})(L2||(L2={}));var NB=Symbol(),Tae=Symbol(),Zy=Symbol(),vm=class{reportOp(e,t,r=[]){let i=this;if(t===null)return;i._current=t.data;let n=r;for(;!(i instanceof UB);){let s=i._path,a=i._current;if(s!==""&&n.splice(0,0,s),i=i._parent,i===null)return;i.update(s,a)}i.push(n,e,t.actual,t.reverse)}deleteChildren(e){if(this._children){let t=this._children[e];if(t){let r=t[Zy];r&&r(),delete this._children[e]}}}},Pae=class extends vm{constructor(e,t,r){super(),this._parent=e,this._path=t,this._current=r}update(e,t){if(Array.isArray(this._current)){if(typeof e=="string"&&(e=parseInt(e),isNaN(e)))throw new Error("Invalid path");this._current=[...this._current],this._current[e]=t}else this._current={...this._current,[e]:t}}runOp(e){this.reportOp(e,z0.runOp(this._current,e),e.path)}},Dae=class extends vm{constructor(e,t,r){super(),this._parent=e,this._path=t,this._current=r}update(e,t){this._current={...this._current,[e]:t},Object.setPrototypeOf(this._current,wt.prototype)}runOp(e){this.reportOp(e,this._current.runOp(e))}},FB={get(e,t){if(t===Zy)return()=>{e._parent=null};if(t===NB)return e._current;if(t===Tae)return e;let{_current:r,_children:i}=e;if(t==="push"&&Array.isArray(r))throw new Error("not supported to expand array");let n=i===void 0?void 0:i[t];if(n!==void 0)return n;let s=r[t],a=$y(e,t,s);return a!==s?(i===void 0&&(i={},e._children=i),i[t]=a,a):s},has(e,t){return t in e._current},ownKeys(e){return Reflect.ownKeys(e._current)},defineProperty(){throw Error("not supported")},getPrototypeOf(e){return Object.getPrototypeOf(e._current)},setPrototypeOf(){throw Error("not supported")},getOwnPropertyDescriptor(e,t){let r=e._current,i=Reflect.getOwnPropertyDescriptor(r,t);return i&&{writable:!0,configurable:!0,enumerable:i.enumerable,value:r[t]}}},Lae={...FB,set(e,t,r){let i={type:0,props:{[t]:ti(r)??r}};return e.deleteChildren(t),e.runOp(i),!0},deleteProperty(e,t){let r={type:0,props:{[t]:void 0}};return e.deleteChildren(t),e.runOp(r),!0}},Iae={...FB,set(e,t,r){return r===void 0?this.deleteProperty(e,t):(e.deleteChildren(t),e.runOp({type:1,id:t,data:r})),!0},deleteProperty(e,t){return e.runOp({type:2,id:t}),!0}},oA=class extends vm{constructor(e,t,r){super(),this._children={},this._parent=e,this._path=t,this._current=r,this[Zy]=()=>{this._parent=null}}unproxy(){return this._current}update(e,t){this._current=this._current.modifyById(e,t)}runOp(e){this.reportOp(e,this._current.runOp(e))}randomId(){return this._current.randomId()}isDescendantOf(e,t){return this._current.isDescendantOf(e,t)}childrenOf(e){return this._current.childrenOf(e)}traverse(e){return this._current.traverse(e)}get(e){return this._current.get(e)}parent(e){return this._current.parent(e)}traverse(e){this._current.traverse((t,r)=>{e(t,this.data(t))})}data(e){var a;let{_current:t,_children:r}=this,i=r===void 0?void 0:r[e];if(i!==void 0)return i;let n=(a=t.get(e))==null?void 0:a.data,s=$y(this,e,n);return s!==n?(r===void 0&&(r={},this._children=r),r[e]=s,s):n}add(e,t,r,i,n){this.runOp({type:7,parent:e,fi:t,id:r,data:i,children:n})}move(e,t,r){this.runOp({type:9,parent:e,fi:t,id:r})}insertAfter(e,t,r){let i=this._current.insertAfterHelper(e,t,r.length);for(let n=0;n<r.length;n++){let s=r[n];this.add(e,i[n],s.id,s.data,s.children)}}insertBefore(e,t,r){let i=this._current.insertBeforeHelper(e,t,r.length);for(let n=0;n<r.length;n++){let s=r[n];this.add(e,i[n],s.id,s.data,s.children)}}moveAfter(e,t,r){let i=this._current.insertAfterHelper(e,t,r.length);for(let n=0;n<r.length;n++){let s=r[n];this.move(e,i[n],s)}}moveBefore(e,t,r){let i=this._current.insertBeforeHelper(e,t,r.length);for(let n=0;n<r.length;n++){let s=r[n];this.move(e,i[n],s)}}delete(e){this.deleteChildren(e),this.runOp({type:8,id:e})}sortNext(e){return this._current.sortNext(e)}sortPrevious(e){return this._current.sortPrevious(e)}getAllSorted(e){return this._current.getAllSorted(e)}},lA=class extends vm{constructor(e,t,r){super(),this._children={},this._parent=e,this._path=t,this._current=r,this[Zy]=()=>{this._parent=null}}unproxy(){return this._current}get length(){return this._current.length}forEach(e){let t=this.length;for(let r=0;r<t;r++){let i=this._current[r].id,n=this._current[r].fi;e(this.data(this._current[r].id),i,n)}}find(e){let t=this.length;for(let r=0;r<t;r++){let i=this._current[r].id;if(e(this.data(i),i))return this.get(i)}}update(e,t){this._current=this._current.modifyById(e,t)}randomId(){return this._current.randomId()}get(e){return{...this._current.get(e),data:this.data(e)}}data(e){var a;let{_current:t,_children:r}=this,i=r===void 0?void 0:r[e];if(i!==void 0)return i;let n=(a=t.get(e))==null?void 0:a.data,s=$y(this,e,n);return s!==n?(r===void 0&&(r={},this._children=r),r[e]=s,s):n}runOp(e){this.reportOp(e,this._current.runOp(e))}add(e,t,r){this.runOp({type:4,fi:e,id:t,data:r})}move(e,t){this.runOp({type:6,fi:e,id:t})}insertAfter(e,t){let r=this._current.insertAfterHelper(e,t.length);for(let i=0;i<t.length;i++){let n=t[i];this.add(r[i],n.id,n.data)}}insertBefore(e,t){let r=this._current.insertBeforeHelper(e,t.length);for(let i=0;i<t.length;i++){let n=t[i];this.add(r[i],n.id,n.data)}}moveAfter(e,t){let r=this._current.insertAfterHelper(e,t.length);for(let i=0;i<t.length;i++){let n=t[i];this.move(r[i],n)}}moveBefore(e,t){let r=this._current.insertBeforeHelper(e,t.length);for(let i=0;i<t.length;i++){let n=t[i];this.move(r[i],n)}}delete(e){this.deleteChildren(e),this.runOp({type:5,id:e})}};function qx(e,t,r){if(e.length>0){let i=e[e.length-1];if(i.type===0&&t.type===0&&ua.equal(i.path,r)){Object.assign(i.props,t.props);return}}e.push({...t,path:r})}var UB=class extends vm{constructor(e){super(),this.ts=[],this.actual=[],this.reverse=[],this._current=e}update(e,t){if(e!=="")throw new Error("");this._current=t}push(e,t,r,i){qx(this.ts,t,e),qx(this.actual,r,e),qx(this.reverse,i,e)}result(){return{data:this._current,ts:this.ts,actual:this.actual,reverse:this.reverse.reverse()}}};function $y(e,t,r){return r instanceof rn?new oA(e,t,r):r instanceof st?new lA(e,t,r):r instanceof wt?new Proxy(new Dae(e,t,r),Iae):r!==null&&typeof r=="object"?nA(r)?r:new Proxy(new Pae(e,t,r),Lae):r}function jB(e){let t=new UB(e);return[$y(t,"",e),t]}function Vf(e,t){let[r,i]=jB(e);return t(r),i.result()}function ti(e){return e instanceof oA||e instanceof lA?e._current:e!==null&&typeof e=="object"?e[NB]:e}var ua;(e=>{function t(s,a){if(a.length===s.length)for(var o=0;o<s.length;){if(s[o]!==a[o])return!1;o+=1}else return!1;return!0}e.equal=t;function r(s,a,o){let l=n(o,s);if(l!==void 0&&typeof l=="object"&&l!==null){let c={...a};return Object.keys(l).forEach(u=>{delete c[u]}),c}else return a}e.removeOverridden=r;function i(s,a){if((s instanceof rn||s instanceof oA)&&typeof a=="string"||(s instanceof st||s instanceof lA)&&typeof a=="string")return s.data(a);if(typeof a=="number"&&Array.isArray(s)||typeof a=="string"&&typeof s=="object"&&s!==null)return s[a]}e.zoomOnce=i;function n(s,a,o=0){for(;o<a.length&&s!==void 0;)s=i(s,a[o]),o+=1;return s}e.zoom=n})(ua||(ua={}));function Oae(e,t){let r=[];if(t.length===e.length)for(var i=0;i<e.length;){if(t[i]==="*")r.push(e[i]);else if(e[i]!==t[i])return null;i+=1}else return null;return r}function qn(e,t){let r=[];if(t.length<=e.length)for(var i=0;i<t.length;){if(t[i]==="*")r.push(e[i]);else if(e[i]!==t[i])return null;i+=1}else return null;return r}var VB=class{},r4=class extends VB{constructor(e){super(),this.id=e}},i4=class extends VB{constructor(e){super(),this.data=e}},I2;try{I2=new TextDecoder}catch{}var ze,ml,re=0,Xi={},It,Ko,Un=0,ra=0,mn,so,Fi=[],Bt,n4={useRecords:!1,mapsAsObjects:!0},HB=class{},GB=new HB;GB.name="MessagePack 0xC1";var Yu=!1,F0=class{constructor(e){e&&(e.useRecords===!1&&e.mapsAsObjects===void 0&&(e.mapsAsObjects=!0),e.structures?e.structures.sharedLength=e.structures.length:e.getStructures&&((e.structures=[]).uninitialized=!0,e.structures.sharedLength=0)),Object.assign(this,e)}unpack(e,t){if(ze)return KB(()=>(R2(),this?this.unpack(e,t):F0.prototype.unpack.call(n4,e,t)));ml=t>-1?t:e.length,re=0,ra=0,Ko=null,mn=null,ze=e;try{Bt=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(r){throw ze=null,e instanceof Uint8Array?r:new Error("Source must be a Uint8Array or Buffer but was a "+(e&&typeof e=="object"?e.constructor.name:typeof e))}if(this instanceof F0){if(Xi=this,this.structures)return It=this.structures,Cg();(!It||It.length>0)&&(It=[])}else Xi=n4,(!It||It.length>0)&&(It=[]);return Cg()}unpackMultiple(e,t){let r,i=0;try{Yu=!0;let n=e.length,s=this?this.unpack(e,n):e1.unpack(e,n);if(t){for(t(s);re<n;)if(i=re,t(Cg())===!1)return}else{for(r=[s];re<n;)i=re,r.push(Cg());return r}}catch(n){throw n.lastPosition=i,n.values=r,n}finally{Yu=!1,R2()}}_mergeStructures(e,t){e=e||[];for(let r=0,i=e.length;r<i;r++){let n=e[r];n&&(n.isShared=!0,r>=32&&(n.highByte=r-32>>5))}e.sharedLength=e.length;for(let r in t||[])if(r>=0){let i=e[r],n=t[r];n&&(i&&((e.restoreStructures||(e.restoreStructures=[]))[r]=i),e[r]=n)}return this.structures=e}decode(e,t){return this.unpack(e,t)}};function Cg(){try{if(!Xi.trusted&&!Yu){let t=It.sharedLength||0;t<It.length&&(It.length=t)}let e=dr();if(re==ml)It.restoreStructures&&s4(),It=null,ze=null,so&&(so=null);else if(re>ml){let t=new Error("Unexpected end of MessagePack data");throw t.incomplete=!0,t}else if(!Yu)throw new Error("Data read, but end of buffer not reached");return e}catch(e){throw It.restoreStructures&&s4(),R2(),(e instanceof RangeError||e.message.startsWith("Unexpected end of buffer"))&&(e.incomplete=!0),e}}function s4(){for(let e in It.restoreStructures)It[e]=It.restoreStructures[e];It.restoreStructures=null}function dr(){let e=ze[re++];if(e<160)if(e<128){if(e<64)return e;{let t=It[e&63]||Xi.getStructures&&WB()[e&63];return t?(t.read||(t.read=cA(t,e&63)),t.read()):e}}else if(e<144)if(e-=128,Xi.mapsAsObjects){let t={};for(let r=0;r<e;r++)t[XB()]=dr();return t}else{let t=new Map;for(let r=0;r<e;r++)t.set(dr(),dr());return t}else{e-=144;let t=new Array(e);for(let r=0;r<e;r++)t[r]=dr();return t}else if(e<192){let t=e-160;if(ra>=re)return Ko.slice(re-Un,(re+=t)-Un);if(ra==0&&ml<140){let r=t<16?hA(t):qB(t);if(r!=null)return r}return O2(t)}else{let t;switch(e){case 192:return null;case 193:return mn?(t=dr(),t>0?mn[1].slice(mn.position1,mn.position1+=t):mn[0].slice(mn.position0,mn.position0-=t)):GB;case 194:return!1;case 195:return!0;case 196:return Xx(ze[re++]);case 197:return t=Bt.getUint16(re),re+=2,Xx(t);case 198:return t=Bt.getUint32(re),re+=4,Xx(t);case 199:return jl(ze[re++]);case 200:return t=Bt.getUint16(re),re+=2,jl(t);case 201:return t=Bt.getUint32(re),re+=4,jl(t);case 202:if(t=Bt.getFloat32(re),Xi.useFloat32>2){let r=uA[(ze[re]&127)<<1|ze[re+1]>>7];return re+=4,(r*t+(t>0?.5:-.5)>>0)/r}return re+=4,t;case 203:return t=Bt.getFloat64(re),re+=8,t;case 204:return ze[re++];case 205:return t=Bt.getUint16(re),re+=2,t;case 206:return t=Bt.getUint32(re),re+=4,t;case 207:return Xi.int64AsNumber?(t=Bt.getUint32(re)*4294967296,t+=Bt.getUint32(re+4)):t=Bt.getBigUint64(re),re+=8,t;case 208:return Bt.getInt8(re++);case 209:return t=Bt.getInt16(re),re+=2,t;case 210:return t=Bt.getInt32(re),re+=4,t;case 211:return Xi.int64AsNumber?(t=Bt.getInt32(re)*4294967296,t+=Bt.getUint32(re+4)):t=Bt.getBigInt64(re),re+=8,t;case 212:if(t=ze[re++],t==114)return h4(ze[re++]&63);{let r=Fi[t];if(r)return r.read?(re++,r.read(dr())):r.noBuffer?(re++,r()):r(ze.subarray(re,++re));throw new Error("Unknown extension "+t)}case 213:return t=ze[re],t==114?(re++,h4(ze[re++]&63,ze[re++])):jl(2);case 214:return jl(4);case 215:return jl(8);case 216:return jl(16);case 217:return t=ze[re++],ra>=re?Ko.slice(re-Un,(re+=t)-Un):Bae(t);case 218:return t=Bt.getUint16(re),re+=2,ra>=re?Ko.slice(re-Un,(re+=t)-Un):zae(t);case 219:return t=Bt.getUint32(re),re+=4,ra>=re?Ko.slice(re-Un,(re+=t)-Un):kae(t);case 220:return t=Bt.getUint16(re),re+=2,o4(t);case 221:return t=Bt.getUint32(re),re+=4,o4(t);case 222:return t=Bt.getUint16(re),re+=2,l4(t);case 223:return t=Bt.getUint32(re),re+=4,l4(t);default:if(e>=224)return e-256;if(e===void 0){let r=new Error("Unexpected end of MessagePack data");throw r.incomplete=!0,r}throw new Error("Unknown MessagePack token "+e)}}}var Rae=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function cA(e,t){function r(){if(r.count++>2){let n=e.read=new Function("r","return function(){return {"+e.map(s=>Rae.test(s)?s+":r()":"["+JSON.stringify(s)+"]:r()").join(",")+"}}")(dr);return e.highByte===0&&(e.read=a4(t,e.read)),n()}let i={};for(let n=0,s=e.length;n<s;n++){let a=e[n];i[a]=dr()}return i}return r.count=0,e.highByte===0?a4(t,r):r}var a4=(e,t)=>function(){let r=ze[re++];if(r===0)return t();let i=e<32?-(e+(r<<5)):e+(r<<5),n=It[i]||WB()[i];if(!n)throw new Error("Record id is not defined for "+i);return n.read||(n.read=cA(n,e)),n.read()};function WB(){let e=KB(()=>(ze=null,Xi.getStructures()));return It=Xi._mergeStructures(e,It)}var O2=Jy,Bae=Jy,zae=Jy,kae=Jy;function Jy(e){let t;if(e<16&&(t=hA(e)))return t;if(e>64&&I2)return I2.decode(ze.subarray(re,re+=e));let r=re+e,i=[];for(t="";re<r;){let n=ze[re++];if(!(n&128))i.push(n);else if((n&224)===192){let s=ze[re++]&63;i.push((n&31)<<6|s)}else if((n&240)===224){let s=ze[re++]&63,a=ze[re++]&63;i.push((n&31)<<12|s<<6|a)}else if((n&248)===240){let s=ze[re++]&63,a=ze[re++]&63,o=ze[re++]&63,l=(n&7)<<18|s<<12|a<<6|o;l>65535&&(l-=65536,i.push(l>>>10&1023|55296),l=56320|l&1023),i.push(l)}else i.push(n);i.length>=4096&&(t+=Qr.apply(String,i),i.length=0)}return i.length>0&&(t+=Qr.apply(String,i)),t}function o4(e){let t=new Array(e);for(let r=0;r<e;r++)t[r]=dr();return t}function l4(e){if(Xi.mapsAsObjects){let t={};for(let r=0;r<e;r++)t[XB()]=dr();return t}else{let t=new Map;for(let r=0;r<e;r++)t.set(dr(),dr());return t}}var Qr=String.fromCharCode;function qB(e){let t=re,r=new Array(e);for(let i=0;i<e;i++){let n=ze[re++];if((n&128)>0){re=t;return}r[i]=n}return Qr.apply(String,r)}function hA(e){if(e<4)if(e<2){if(e===0)return"";{let t=ze[re++];if((t&128)>1){re-=1;return}return Qr(t)}}else{let t=ze[re++],r=ze[re++];if((t&128)>0||(r&128)>0){re-=2;return}if(e<3)return Qr(t,r);let i=ze[re++];if((i&128)>0){re-=3;return}return Qr(t,r,i)}else{let t=ze[re++],r=ze[re++],i=ze[re++],n=ze[re++];if((t&128)>0||(r&128)>0||(i&128)>0||(n&128)>0){re-=4;return}if(e<6){if(e===4)return Qr(t,r,i,n);{let s=ze[re++];if((s&128)>0){re-=5;return}return Qr(t,r,i,n,s)}}else if(e<8){let s=ze[re++],a=ze[re++];if((s&128)>0||(a&128)>0){re-=6;return}if(e<7)return Qr(t,r,i,n,s,a);let o=ze[re++];if((o&128)>0){re-=7;return}return Qr(t,r,i,n,s,a,o)}else{let s=ze[re++],a=ze[re++],o=ze[re++],l=ze[re++];if((s&128)>0||(a&128)>0||(o&128)>0||(l&128)>0){re-=8;return}if(e<10){if(e===8)return Qr(t,r,i,n,s,a,o,l);{let c=ze[re++];if((c&128)>0){re-=9;return}return Qr(t,r,i,n,s,a,o,l,c)}}else if(e<12){let c=ze[re++],u=ze[re++];if((c&128)>0||(u&128)>0){re-=10;return}if(e<11)return Qr(t,r,i,n,s,a,o,l,c,u);let h=ze[re++];if((h&128)>0){re-=11;return}return Qr(t,r,i,n,s,a,o,l,c,u,h)}else{let c=ze[re++],u=ze[re++],h=ze[re++],d=ze[re++];if((c&128)>0||(u&128)>0||(h&128)>0||(d&128)>0){re-=12;return}if(e<14){if(e===12)return Qr(t,r,i,n,s,a,o,l,c,u,h,d);{let p=ze[re++];if((p&128)>0){re-=13;return}return Qr(t,r,i,n,s,a,o,l,c,u,h,d,p)}}else{let p=ze[re++],f=ze[re++];if((p&128)>0||(f&128)>0){re-=14;return}if(e<15)return Qr(t,r,i,n,s,a,o,l,c,u,h,d,p,f);let m=ze[re++];if((m&128)>0){re-=15;return}return Qr(t,r,i,n,s,a,o,l,c,u,h,d,p,f,m)}}}}}function Xx(e){return Xi.copyBuffers?Uint8Array.prototype.slice.call(ze,re,re+=e):ze.subarray(re,re+=e)}function jl(e){let t=ze[re++];if(Fi[t])return Fi[t](ze.subarray(re,re+=e));throw new Error("Unknown extension type "+t)}var c4=new Array(4096);function XB(){let e=ze[re++];if(e>=160&&e<192){if(e=e-160,ra>=re)return Ko.slice(re-Un,(re+=e)-Un);if(!(ra==0&&ml<180))return O2(e)}else return re--,dr();let t=(e<<5^(e>1?Bt.getUint16(re):e>0?ze[re]:0))&4095,r=c4[t],i=re,n=re+e-3,s,a=0;if(r&&r.bytes==e){for(;i<n;){if(s=Bt.getUint32(i),s!=r[a++]){i=1879048192;break}i+=4}for(n+=3;i<n;)if(s=ze[i++],s!=r[a++]){i=1879048192;break}if(i===n)return re=i,r.string;n-=3,i=re}for(r=[],c4[t]=r,r.bytes=e;i<n;)s=Bt.getUint32(i),r.push(s),i+=4;for(n+=3;i<n;)s=ze[i++],r.push(s);let o=e<16?hA(e):qB(e);return o!=null?r.string=o:r.string=O2(e)}var h4=(e,t)=>{var r=dr();let i=e;t!==void 0&&(e=e<32?-((t<<5)+e):(t<<5)+e,r.highByte=t);let n=It[e];return n&&n.isShared&&((It.restoreStructures||(It.restoreStructures=[]))[e]=n),It[e]=r,r.read=cA(r,i),r.read()},YB=typeof self=="object"?self:global;Fi[0]=()=>{};Fi[0].noBuffer=!0;Fi[101]=()=>{let e=dr();return(YB[e[0]]||Error)(e[1])};Fi[105]=e=>{let t=Bt.getUint32(re-4);so||(so=new Map);let r=ze[re],i;r>=144&&r<160||r==220||r==221?i=[]:i={};let n={target:i};so.set(t,n);let s=dr();return n.used?Object.assign(i,s):(n.target=s,s)};Fi[112]=e=>{let t=Bt.getUint32(re-4),r=so.get(t);return r.used=!0,r.target};Fi[115]=()=>new Set(dr());var QB=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(e=>e+"Array");Fi[116]=e=>{let t=e[0],r=QB[t];if(!r)throw new Error("Could not find typed array for code "+t);return new YB[r](Uint8Array.prototype.slice.call(e,1).buffer)};Fi[120]=()=>{let e=dr();return new RegExp(e[0],e[1])};Fi[98]=e=>{let t=(e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3],r=re;re+=t-4,mn=[dr(),dr()],mn.position0=0,mn.position1=0;let i=re;re=r;try{return dr()}finally{re=i}};Fi[255]=e=>e.length==4?new Date((e[0]*16777216+(e[1]<<16)+(e[2]<<8)+e[3])*1e3):e.length==8?new Date(((e[0]<<22)+(e[1]<<14)+(e[2]<<6)+(e[3]>>2))/1e6+((e[3]&3)*4294967296+e[4]*16777216+(e[5]<<16)+(e[6]<<8)+e[7])*1e3):e.length==12?new Date(((e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3])/1e6+((e[4]&128?-281474976710656:0)+e[6]*1099511627776+e[7]*4294967296+e[8]*16777216+(e[9]<<16)+(e[10]<<8)+e[11])*1e3):new Date("invalid");function KB(e){let t=ml,r=re,i=Un,n=ra,s=Ko,a=so,o=mn,l=new Uint8Array(ze.slice(0,ml)),c=It,u=It.slice(0,It.length),h=Xi,d=Yu,p=e();return ml=t,re=r,Un=i,ra=n,Ko=s,so=a,mn=o,ze=l,Yu=d,It=c,It.splice(0,It.length,...u),Xi=h,Bt=new DataView(ze.buffer,ze.byteOffset,ze.byteLength),p}function R2(){ze=null,so=null,It=null}function Nae(e){e.unpack?Fi[e.type]=e.unpack:Fi[e.type]=e}var uA=new Array(147);for(let e=0;e<256;e++)uA[e]=+("1e"+Math.floor(45.15-e*.30103));var e1=new F0({useRecords:!1});e1.unpack;e1.unpackMultiple;e1.unpack;var Fae=new Float32Array(1);new Uint8Array(Fae.buffer,0,4);var Lv;try{Lv=new TextEncoder}catch{}var U0,dA,t1=typeof Buffer<"u",Yx=t1?Buffer.allocUnsafeSlow:Uint8Array,ZB=t1?Buffer:Uint8Array,u4=t1?4294967296:2144337920,ve,vr,he=0,Bs,zs=null,Uae=/[\u0080-\uFFFF]/,$d=Symbol("record-id"),$B=class extends F0{constructor(e){super(e),this.offset=0;let t,r,i,n,s,a=0,o=ZB.prototype.utf8Write?function(_,A,S){return ve.utf8Write(_,A,S)}:Lv&&Lv.encodeInto?function(_,A){return Lv.encodeInto(_,ve.subarray(A)).written}:!1,l=this;e||(e={});let c=e&&e.sequential,u=e.structures||e.saveStructures,h=e.maxSharedStructures;if(h==null&&(h=u?32:0),h>8160)throw new Error("Maximum maxSharedStructure is 8160");let d=e.maxOwnStructures;d==null&&(d=u?32:64),c&&!e.saveStructures&&(this.structures=[]);let p=h>32||d+h>64,f=h+64,m=h+d+64;if(m>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let g=[],v=0,y=0;this.pack=this.encode=function(_,A){if(ve||(ve=new Yx(8192),vr=new DataView(ve.buffer,0,8192),he=0),Bs=ve.length-10,Bs-he<2048?(ve=new Yx(ve.length),vr=new DataView(ve.buffer,0,ve.length),Bs=ve.length-10,he=0):he=he+7&2147483640,t=he,s=l.structuredClone?new Map:null,l.bundleStrings?(zs=["",""],ve[he++]=214,ve[he++]=98,zs.position=he-t,he+=4):zs=null,r=l.structures,r){r.uninitialized&&(r=l._mergeStructures(l.getStructures()));let S=r.sharedLength||0;if(S>h)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+r.sharedLength);if(!r.transitions){r.transitions=Object.create(null);for(let C=0;C<S;C++){let M=r[C];if(!M)continue;let T,P=r.transitions;for(let D=0,I=M.length;D<I;D++){let B=M[D];T=P[B],T||(T=P[B]=Object.create(null)),P=T}P[$d]=C+64}a=S}c||(r.nextId=S+64)}i&&(i=!1),n=r||[];try{if(x(_),zs){vr.setUint32(zs.position+t,he-zs.position-t);let S=zs;zs=null,x(S[0]),x(S[1])}if(l.offset=he,s&&s.idsToInsert){he+=s.idsToInsert.length*6,he>Bs&&b(he),l.offset=he;let S=Vae(ve.subarray(t,he),s.idsToInsert);return s=null,S}return A&Hae?(ve.start=t,ve.end=he,ve):ve.subarray(t,he)}finally{if(r){if(y<10&&y++,v>1e4)r.transitions=null,y=0,v=0,g.length>0&&(g=[]);else if(g.length>0&&!c){for(let S=0,C=g.length;S<C;S++)g[S][$d]=0;g=[]}if(i&&l.saveStructures){let S=r.sharedLength||h;r.length>S&&(r=r.slice(0,S));let C=ve.subarray(t,he);return l.saveStructures(r,a)===!1?(l._mergeStructures(l.getStructures()),l.pack(_)):(a=S,C)}}A&Gae&&(he=t)}};let x=_=>{he>Bs&&(ve=b(he));var A=typeof _,S;if(A==="string"){let C=_.length;if(zs&&C>=8&&C<4096){let P=Uae.test(_);zs[P?0:1]+=_,ve[he++]=193,x(P?-C:C);return}let M;C<32?M=1:C<256?M=2:C<65536?M=3:M=5;let T=C*3;if(he+T>Bs&&(ve=b(he+T)),C<64||!o){let P,D,I,B=he+M;for(P=0;P<C;P++)D=_.charCodeAt(P),D<128?ve[B++]=D:D<2048?(ve[B++]=D>>6|192,ve[B++]=D&63|128):(D&64512)===55296&&((I=_.charCodeAt(P+1))&64512)===56320?(D=65536+((D&1023)<<10)+(I&1023),P++,ve[B++]=D>>18|240,ve[B++]=D>>12&63|128,ve[B++]=D>>6&63|128,ve[B++]=D&63|128):(ve[B++]=D>>12|224,ve[B++]=D>>6&63|128,ve[B++]=D&63|128);S=B-he-M}else S=o(_,he+M,T);S<32?ve[he++]=160|S:S<256?(M<2&&ve.copyWithin(he+2,he+1,he+1+S),ve[he++]=217,ve[he++]=S):S<65536?(M<3&&ve.copyWithin(he+3,he+2,he+2+S),ve[he++]=218,ve[he++]=S>>8,ve[he++]=S&255):(M<5&&ve.copyWithin(he+5,he+3,he+3+S),ve[he++]=219,vr.setUint32(he,S),he+=4),he+=S}else if(A==="number")if(_>>>0===_)_<64?ve[he++]=_:_<256?(ve[he++]=204,ve[he++]=_):_<65536?(ve[he++]=205,ve[he++]=_>>8,ve[he++]=_&255):(ve[he++]=206,vr.setUint32(he,_),he+=4);else if(_>>0===_)_>=-32?ve[he++]=256+_:_>=-128?(ve[he++]=208,ve[he++]=_+256):_>=-32768?(ve[he++]=209,vr.setInt16(he,_),he+=2):(ve[he++]=210,vr.setInt32(he,_),he+=4);else{let C;if((C=this.useFloat32)>0&&_<4294967296&&_>=-2147483648){ve[he++]=202,vr.setFloat32(he,_);let M;if(C<4||(M=_*uA[(ve[he]&127)<<1|ve[he+1]>>7])>>0===M){he+=4;return}else he--}ve[he++]=203,vr.setFloat64(he,_),he+=8}else if(A==="object")if(!_)ve[he++]=192;else{if(s){let M=s.get(_);if(M){if(!M.id){let T=s.idsToInsert||(s.idsToInsert=[]);M.id=T.push(M)}ve[he++]=214,ve[he++]=112,vr.setUint32(he,M.id),he+=4;return}else s.set(_,{offset:he-t})}let C=_.constructor;if(C===Object)w(_,!0);else if(C===Array){S=_.length,S<16?ve[he++]=144|S:S<65536?(ve[he++]=220,ve[he++]=S>>8,ve[he++]=S&255):(ve[he++]=221,vr.setUint32(he,S),he+=4);for(let M=0;M<S;M++)x(_[M])}else if(C===Map){S=_.size,S<16?ve[he++]=128|S:S<65536?(ve[he++]=222,ve[he++]=S>>8,ve[he++]=S&255):(ve[he++]=223,vr.setUint32(he,S),he+=4);for(let[M,T]of _)x(M),x(T)}else{for(let M=0,T=U0.length;M<T;M++){let P=dA[M];if(_ instanceof P){let D=U0[M];if(D.write){D.type&&(ve[he++]=212,ve[he++]=D.type,ve[he++]=0),x(D.write.call(this,_));return}let I=ve,B=vr,X=he;ve=null;let H;try{H=D.pack.call(this,_,R=>(ve=I,I=null,he+=R,he>Bs&&b(he),{target:ve,targetView:vr,position:he-R}),x)}finally{I&&(ve=I,vr=B,he=X,Bs=ve.length-10)}H&&(H.length+he>Bs&&b(H.length+he),he=jae(H,ve,he,D.type));return}}w(_,!_.hasOwnProperty)}}else if(A==="boolean")ve[he++]=_?195:194;else if(A==="bigint"){if(_<BigInt(1)<<BigInt(63)&&_>=-(BigInt(1)<<BigInt(63)))ve[he++]=211,vr.setBigInt64(he,_);else if(_<BigInt(1)<<BigInt(64)&&_>0)ve[he++]=207,vr.setBigUint64(he,_);else if(this.largeBigIntToFloat)ve[he++]=203,vr.setFloat64(he,Number(_));else throw new RangeError(_+" was too large to fit in MessagePack 64-bit integer format, set largeBigIntToFloat to convert to float-64");he+=8}else if(A==="undefined")this.encodeUndefinedAsNil?ve[he++]=192:(ve[he++]=212,ve[he++]=0,ve[he++]=0);else if(A==="function")x(this.writeFunction&&this.writeFunction());else throw new Error("Unknown type: "+A)},w=this.useRecords===!1?this.variableMapSize?_=>{let A=Object.keys(_),S=A.length;S<16?ve[he++]=128|S:S<65536?(ve[he++]=222,ve[he++]=S>>8,ve[he++]=S&255):(ve[he++]=223,vr.setUint32(he,S),he+=4);let C;for(let M=0;M<S;M++)x(C=A[M]),x(_[C])}:(_,A)=>{ve[he++]=222;let S=he-t;he+=2;let C=0;for(let M in _)(A||_.hasOwnProperty(M))&&(x(M),x(_[M]),C++);ve[S+++t]=C>>8,ve[S+t]=C&255}:_=>{let A=Object.keys(_),S,C=n.transitions||(n.transitions=Object.create(null)),M=0;for(let P=0,D=A.length;P<D;P++){let I=A[P];S=C[I],S||(S=C[I]=Object.create(null),M++),C=S}let T=C[$d];if(T)T>=96&&p?(ve[he++]=((T-=96)&31)+96,ve[he++]=T>>5):ve[he++]=T;else{T=n.nextId,T||(T=64),T<f&&this.shouldShareStructure&&!this.shouldShareStructure(A)?(T=n.nextOwnId,T<m||(T=f),n.nextOwnId=T+1):(T>=m&&(T=f),n.nextId=T+1);let P=A.highByte=T>=96&&p?T-96>>5:-1;C[$d]=T,n[T-64]=A,T<f?(A.isShared=!0,n.sharedLength=T-63,i=!0,P>=0?(ve[he++]=(T&31)+96,ve[he++]=P):ve[he++]=T):(P>=0?(ve[he++]=213,ve[he++]=114,ve[he++]=(T&31)+96,ve[he++]=P):(ve[he++]=212,ve[he++]=114,ve[he++]=T),M&&(v+=y*M),g.length>=d&&(g.shift()[$d]=0),g.push(C),x(A))}for(let P=0,D=A.length;P<D;P++)x(_[A[P]])},b=_=>{let A;if(_>16777216){if(_-t>u4)throw new Error("Packed buffer would be larger than maximum buffer size");A=Math.min(u4,Math.round(Math.max((_-t)*(_>67108864?1.25:2),4194304)/4096)*4096)}else A=(Math.max(_-t<<2,ve.length-1)>>12)+1<<12;let S=new Yx(A);return vr=new DataView(S.buffer,0,A),ve.copy?ve.copy(S,0,t,_):S.set(ve.slice(t,_)),he-=t,t=0,Bs=S.length-10,ve=S}}useBuffer(e){ve=e,vr=new DataView(ve.buffer,ve.byteOffset,ve.byteLength),he=0}};dA=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,HB];U0=[{pack(e,t,r){let i=e.getTime()/1e3;if((this.useTimestamp32||e.getMilliseconds()===0)&&i>=0&&i<4294967296){let{target:n,targetView:s,position:a}=t(6);n[a++]=214,n[a++]=255,s.setUint32(a,i)}else if(i>0&&i<17179869184){let{target:n,targetView:s,position:a}=t(10);n[a++]=215,n[a++]=255,s.setUint32(a,e.getMilliseconds()*4e6+(i/1e3/4294967296>>0)),s.setUint32(a+4,i)}else if(isNaN(i)){if(this.onInvalidDate)return t(0),r(this.onInvalidDate());let{target:n,targetView:s,position:a}=t(3);n[a++]=212,n[a++]=255,n[a++]=255}else{let{target:n,targetView:s,position:a}=t(15);n[a++]=199,n[a++]=12,n[a++]=255,s.setUint32(a,e.getMilliseconds()*1e6),s.setBigInt64(a+4,BigInt(Math.floor(i)))}}},{pack(e,t,r){let i=Array.from(e),{target:n,position:s}=t(this.structuredClone?3:0);this.structuredClone&&(n[s++]=212,n[s++]=115,n[s++]=0),r(i)}},{pack(e,t,r){let{target:i,position:n}=t(this.structuredClone?3:0);this.structuredClone&&(i[n++]=212,i[n++]=101,i[n++]=0),r([e.name,e.message])}},{pack(e,t,r){let{target:i,position:n}=t(this.structuredClone?3:0);this.structuredClone&&(i[n++]=212,i[n++]=120,i[n++]=0),r([e.source,e.flags])}},{pack(e,t){this.structuredClone?d4(e,16,t):p4(t1?Buffer.from(e):new Uint8Array(e),t)}},{pack(e,t){let r=e.constructor;r!==ZB&&this.structuredClone?d4(e,QB.indexOf(r.name),t):p4(e,t)}},{pack(e,t){let{target:r,position:i}=t(1);r[i]=193}}];function d4(e,t,r,i){let n=e.byteLength;if(n+1<256){var{target:s,position:a}=r(4+n);s[a++]=199,s[a++]=n+1}else if(n+1<65536){var{target:s,position:a}=r(5+n);s[a++]=200,s[a++]=n+1>>8,s[a++]=n+1&255}else{var{target:s,position:a,targetView:o}=r(7+n);s[a++]=201,o.setUint32(a,n+1),a+=4}s[a++]=116,s[a++]=t,s.set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),a)}function p4(e,t){let r=e.byteLength;var i,n;if(r<256){var{target:i,position:n}=t(r+2);i[n++]=196,i[n++]=r}else if(r<65536){var{target:i,position:n}=t(r+3);i[n++]=197,i[n++]=r>>8,i[n++]=r&255}else{var{target:i,position:n,targetView:s}=t(r+5);i[n++]=198,s.setUint32(n,r),n+=4}i.set(e,n)}function jae(e,t,r,i){let n=e.length;switch(n){case 1:t[r++]=212;break;case 2:t[r++]=213;break;case 4:t[r++]=214;break;case 8:t[r++]=215;break;case 16:t[r++]=216;break;default:n<256?(t[r++]=199,t[r++]=n):n<65536?(t[r++]=200,t[r++]=n>>8,t[r++]=n&255):(t[r++]=201,t[r++]=n>>24,t[r++]=n>>16&255,t[r++]=n>>8&255,t[r++]=n&255)}return t[r++]=i,t.set(e,r),r+=n,r}function Vae(e,t){let r,i=t.length*6,n=e.length-i;for(t.sort((s,a)=>s.offset>a.offset?1:-1);r=t.pop();){let s=r.offset,a=r.id;e.copyWithin(s+i,s,n),i-=6;let o=s+i;e[o++]=214,e[o++]=105,e[o++]=a>>24,e[o++]=a>>16&255,e[o++]=a>>8&255,e[o++]=a&255,n=s}return e}function bd(e){if(e.Class){if(!e.pack&&!e.write)throw new Error("Extension has no pack or write function");if(e.pack&&!e.type)throw new Error("Extension has no type (numeric code to identify the extension)");dA.unshift(e.Class),U0.unshift(e)}Nae(e)}var JB=new $B({useRecords:!1});JB.pack;JB.pack;var Hae=512,Gae=1024,f4=new $B({structuredClone:!0});bd({Class:wt.prototype.constructor,type:1,write(e){return{...e}},read(e){return Object.setPrototypeOf(e,wt.prototype),e}});bd({Class:st.prototype.constructor,type:2,write(e){return[...e]},read(e){return Object.setPrototypeOf(e,st.prototype),e}});bd({Class:rn.prototype.constructor,type:3,write(e){return[...e]},read(e){return Object.setPrototypeOf(e,rn.prototype),e}});bd({Class:r4.prototype.constructor,type:4,write(e){return e.id},read(e){return new r4(e)}});bd({Class:i4.prototype.constructor,type:5,write(e){return e.data},read(e){return new i4(e)}});bd({Class:Vr.prototype.constructor,type:6,write(e){return{...e}},read(e){return Object.setPrototypeOf(e,Vr.prototype),e}});function Wae(e){var t=0;if(e.length===0)return t;for(let r=0;r<e.length;r++){let i=e[r];t=(t<<5)-t+i,t=t&t}return t}function B2(e){if(nA(e))return e;if(Array.isArray(e))return e.map(B2);if(typeof e=="object"&&e!==null){let t={};for(let r of Object.keys(e).sort())t[r]=B2(e[r]);return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),t}else return e}var z2;(e=>{function t(n){return f4.pack(n)}e.serialize=t;function r(n){return f4.unpack(n)}e.deserialize=r;function i(n){return Wae(t(B2(n))).toString()}e.checksum=i})(z2||(z2={}));var ks={LookAt:[],Follow:["Create"],DragDrop:["Transition","Animation","Audio","Create"],MouseHover:["Transition","Animation","Create","Destroy","SwitchCamera","SceneTransition"],Scroll:["Transition","Animation","Create"],Start:["Transition","Animation","Audio","Video","Create","Destroy","SwitchCamera","SceneTransition"],Conditional:["Transition","Animation","Audio","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset"],MouseDown:["Transition","Animation","Audio","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset"],MouseUp:["Transition","Animation","Audio","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset"],MousePress:["Transition","Animation","Audio","Video","Link","Create","SwitchCamera","SceneTransition","Reset"],KeyDown:["Transition","Animation","Audio","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset"],KeyUp:["Transition","Animation","Audio","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset"],KeyPress:["Transition","Animation","Audio","Video","Link","Create","SwitchCamera","Reset"],GameControl:["Transition","Animation","Audio","Video","Create"],Collision:["Transition","Animation","Audio","Video","Create","Destroy","Reset"],Trigger:["Transition","Audio","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset"],Resize:["Transition","Animation","Audio","Video","Create","Destroy","SwitchCamera","SceneTransition","Reset"]},m4;(e=>{function t(i){return i.type==="MouseDown"||i.type==="MouseUp"||i.type==="MousePress"||i.type==="KeyDown"||i.type==="KeyUp"||i.type==="KeyPress"}e.is=t;function r(i){return i==="MouseDown"||i==="MouseUp"||i==="MousePress"?{type:i,mode:"Object",disabled:!1,toggle:!1,actions:new st}:{type:i,disabled:!1,key:void 0,toggle:!1,actions:new st}}e.defaultData=r})(m4||(m4={}));var j0;(e=>{function t(r){return{type:"Property",value:[r??null,"position","x"]}}e.propertyDefaultData=t,e.valueDefaultData={type:"Literal",value:0}})(j0||(j0={}));var k2;(e=>{function t(n){return{type:"Comparison",operator:"==",lOperand:j0.propertyDefaultData(n),rOperand:{...j0.valueDefaultData}}}e.comparisonDefaultData=t;function r(n){return{type:"Distance",toObject:n??null,fromObject:n??null,distance:200}}e.distanceDefaultData=r;function i(n,s){return{type:"State",object:n??null,state:s??null}}e.stateDefaultData=i})(k2||(k2={}));var g4;(e=>{function t(i){return i.type==="Conditional"}e.is=t;function r(i){return{type:"Conditional",disabled:!1,inActions:new st,outActions:new st,condition:k2.distanceDefaultData(i)}}e.defaultData=r})(g4||(g4={}));var v4;(e=>e.defaultData={type:"DragDrop",cursor:"hand",disabled:!1,dampingFactor:1,objects:[],snapTo:"center",snapSurfaceMode:"bbox",snapSurfaceOffset:0,dropOn:"all",autoOrient:!0,dropDestinations:[],plane:"adaptive",planeMode:"locked",referenceFrame:"global",limits:[-1/0,1/0,-1/0,1/0,-1/0,1/0],drop:!1,resetOnSnapFail:!1,snapSpeed:20,resetSpeed:20,dragDropActions:{drag:new st,drop:new st}})(v4||(v4={}));var N2;(e=>e.defaultData={type:"Follow",disabled:!1,maxDelta:0,dampingFactor:1,target:"cursor",plane:"custom",resetOnPointerLeave:!0,resetAfterDistanceLimit:!0,enabledTranslation:[!0,!0,!0],limitDistanceEnabled:!1,limitDistance:1e3,snapDelay:0,resetSpeed:5,actions:new st})(N2||(N2={}));var F2;(e=>e.defaultData={type:"LookAt",disabled:!1,distance:1e3,dampingFactor:1,target:"cursor",tilt:"up",axis:"z",plane:"custom",resetOnPointerLeave:!0,resetAfterDistanceLimit:!0,enabledRotation:[!0,!0,!0],limitDistanceEnabled:!1,limitDistance:1e3,snapDelay:0,resetSpeed:5})(F2||(F2={}));var y4;(e=>{function t(i){return i.type==="MouseHover"}e.is=t;function r(){return{type:"MouseHover",disabled:!1,actions:new st}}e.defaultData=r})(y4||(y4={}));var x4;(e=>{function t(i){return i.type==="Scroll"}e.is=t;function r(){return{type:"Scroll",disabled:!1,steps:100,trigger:"load",startFrom:"enter",enterAnchor:"top",startOffset:0,endAfter:400,actions:new st}}e.defaultData=r})(x4||(x4={}));var w4;(e=>{function t(i){return i.type==="Start"}e.is=t;function r(){return{type:"Start",disabled:!1,actions:new st}}e.defaultData=r})(w4||(w4={}));var b4;(e=>{function t(i){return i.type==="Collision"}e.is=t;function r(){return{type:"Collision",disabled:!1,toggle:!1,target:"character",actions:new st}}e.defaultData=r})(b4||(b4={}));var _4;(e=>{function t(i){return i.type==="Trigger"}e.is=t;function r(i,n){return{type:"Trigger",disabled:!1,toggle:!1,target:"all",triggeringObjects:[],actions:new st,triggerZone:"box",position:n.toArray(),rotation:[0,0,0],size:i.toArray(),radius:i.length()/2,helperVisible:!0}}e.defaultData=r})(_4||(_4={}));var U2;(e=>{e.defaultSizes={mobile:[480,480],tablet:[768,768],desktop:[1200,1200],custom:[769,1200]};function t(a){return a.type==="Resize"}e.is=t;function r(a){return typeof a=="string"?a:"custom"}e.sizeToDevice=r;function i(a){return typeof a=="string"?[...e.defaultSizes[a]]:[...a]}e.deviceToSize=i;function n(){let a={size:"mobile",operator:"<",actions:new st},o={size:"tablet",operator:"<",actions:new st},l={size:[...e.defaultSizes.custom],operator:"<>",actions:new st},c=new st;return c.push({id:mt.generateUUID(),fi:0,data:a},{id:mt.generateUUID(),fi:1,data:o},{id:mt.generateUUID(),fi:2,data:l}),{type:"Resize",disabled:!1,orientation:"horizontal",breakpoints:c}}e.defaultData=n;function s(){return{size:[...e.defaultSizes.custom],operator:"<>",actions:new st}}e.defaultBreakpointData=s})(U2||(U2={}));var _d="personal camera",ef="a218fcc3-276b-49b9-b485-49037fd14f5f",qae=2960946,rs=5526619,nu;(e=>{function t(i,n){return i[0]===n[0]&&i[1]===n[1]}e.isEqual=t;function r(i,n,s){return[i[0]+(n[0]-i[0])*s,i[1]+(n[1]-i[1])*s]}e.lerp=r})(nu||(nu={}));var bc;(e=>{function t(l,c){return l[0]===c[0]&&l[1]===c[1]&&l[2]===c[2]}e.isEqual=t;function r(l,c){return[l[0]+c[0],l[1]+c[1],l[2]+c[2]]}e.add=r;function i(l,c){return[l[0]-c[0],l[1]-c[1],l[2]-c[2]]}e.sub=i;function n(l,c){return[l[0]/c[0],l[1]/c[1],l[2]/c[2]]}e.div=n;function s(l,c){return[l[0]*c[0],l[1]*c[1],l[2]*c[2]]}e.mul=s;function a(l,c){return Math.hypot(l[0]-c[0],l[1]-c[1],l[2]-c[2])}e.dist=a;function o(l,c,u){return[l[0]+(c[0]-l[0])*u,l[1]+(c[1]-l[1])*u,l[2]+(c[2]-l[2])*u]}e.lerp=o})(bc||(bc={}));var V0;(e=>{function t(i,n){return i[0]===n[0]&&i[1]===n[1]&&i[2]===n[2]&&i[3]===n[3]}e.isEqual=t;function r(i,n,s){return[i[0]+(n[0]-i[0])*s,i[1]+(n[1]-i[1])*s,i[2]+(n[2]-i[2])*s,i[3]+(n[3]-i[3])*s]}e.lerp=r})(V0||(V0={}));var Qu;(e=>{e.identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function t(n,s){for(let a=0;a<16;a++)if(n[a]!==s[a])return!1;return!0}e.isEqual=t;function r(n){return n??e.identity}e.simplify=r;function i(n,s){let a=s.slice(0);for(var o=0,l=s.length;o<l;o+=3){let c=n[3]*s[o]+n[7]*s[o+1]+n[11]*s[o+2]+n[15];a[o]=(n[0]*s[o]+n[4]*s[o+1]+n[8]*s[o+2]+n[12])/c,a[o+1]=(n[1]*s[o]+n[5]*s[o+1]+n[9]*s[o+2]+n[13])/c,a[o+2]=(n[2]*s[o]+n[6]*s[o+1]+n[10]*s[o+2]+n[14])/c}return a}e.applyMatrix4=i})(Qu||(Qu={}));var Li;(e=>{function t(l){return typeof l=="object"&&typeof l.r=="number"&&typeof l.g=="number"&&typeof l.b=="number"}e.isRGB=t,e.white={r:1,g:1,b:1},e.red={r:1,g:0,b:0},e.black={r:0,g:0,b:0};function r(l){return{r:Math.round(l.r*255),g:Math.round(l.g*255),b:Math.round(l.b*255),a:1}}e.toRgb255a1=r;function i(l){return{r:l.r,g:l.g,b:l.b}}e.clone=i;function n(l){return l=Math.floor(l),{r:(l>>16&255)/255,g:(l>>8&255)/255,b:(l&255)/255}}e.fromHex=n;function s(l){return Math.round(l.r*255)*65536+Math.round(l.g*255)*256+Math.round(l.b*255)}e.toHex=s;function a(l,c){return l.r===c.r&&l.g===c.g&&l.b===c.b}e.equals=a;function o(l,c,u){return{r:l.r+(c.r-l.r)*u,g:l.g+(c.g-l.g)*u,b:l.b+(c.b-l.b)*u}}e.lerp=o})(Li||(Li={}));var _s;(e=>{e.white={...Li.white,a:1},e.transparent={...Li.white,a:0};function t(a){return{r:a[0],g:a[1],b:a[2],a:a[3]}}e.from0to1=t;function r(a,o){return{...Li.fromHex(a),a:o}}e.fromHexAndA=r;function i(a){return{r:Math.round(a.r*255),g:Math.round(a.g*255),b:Math.round(a.b*255),a:a.a}}e.toRgb255a1=i;function n(a,o){return Li.equals(a,o)&&a.a===o.a}e.equals=n;function s(a,o,l){return{r:a.r+(o.r-a.r)*l,g:a.g+(o.g-a.g)*l,b:a.b+(o.b-a.b)*l,a:a.a+(o.a-a.a)*l}}e.lerp=s})(_s||(_s={}));var j2;(e=>e.identity={position:[0,0,0],rotation:[0,0,0],scale:[1,1,1]})(j2||(j2={}));var S4;(e=>e.defaultData={mass:1,stiffness:80,damping:10,velocity:0})(S4||(S4={}));var A4;(e=>e.defaultData={control1:[.5,0],control2:[.5,1]})(A4||(A4={}));var Uo;(e=>(e.linear=[0,0,1,1],e.ease=[.25,.1,.25,1],e.easeIn=[.42,0,1,1],e.easeOut=[0,0,.58,1],e.easeInOut=[.42,0,.58,1]))(Uo||(Uo={}));var zc;(e=>{e.all=["PerspectiveCamera","OrthographicCamera"];function t(r){return e.all.includes(r)}e.is=t})(zc||(zc={}));var Ku;(e=>{e.DefaultUp=[0,1,0],e.DefaultTargetOffset=1e3,e.defaultData={far:1e5,type:"OrthographicCamera",perspective:{near:70,fov:45,zoom:1},orthographic:{near:-1e5,zoom:1},up:e.DefaultUp,isUpVectorFlipped:!1,targetOffset:e.DefaultTargetOffset};function t(r){return r.type==="PerspectiveCamera"?r.perspective.zoom:r.orthographic.zoom}e.getZoom=t})(Ku||(Ku={}));var Zo;(e=>{function t(i,n=.1){return{disabled:!1,type:"linear",hideBase:!1,count:3,radial:{radius:Math.max(i[0],i[1])*2,start:0,end:360,alignment:!1,axis:"y",scale:[1,1,1],rotation:[0,0,0],position:[0,0,0]},toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},linear:{scale:[1,1,1],rotation:[0,0,0],position:[i[0]+i[0]*n,0,0]},grid:{count:[2,2,2],size:i.map(s=>s*(1+n)),useCenter:!0},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}}}e.defaultData=t;function r(i,n){let s={...i};if(ez.forEach(a=>{Object.assign(s,{[a]:n[a]??i[a]})}),s.radial={...i.radial},n.radial){let a=i.radial,o=n.radial;tz.forEach(l=>{Object.assign(s.radial,{[l]:o[l]??a[l]})})}if(s.linear={...i.linear},n.linear){let a=i.linear,o=n.linear;rz.forEach(l=>{Object.assign(s.linear,{[l]:o[l]??a[l]})})}if(s.grid={...i.grid},n.grid){let a=i.grid,o=n.grid;iz.forEach(l=>{Object.assign(s.grid,{[l]:o[l]??a[l]})})}if(s.toObject={...i.toObject},n.toObject){let a=i.toObject,o=n.toObject;nz.forEach(l=>{Object.assign(s.toObject,{[l]:o[l]??a[l]})})}if(s.randomnessObject={...i.randomnessObject},n.randomnessObject){let a=i.randomnessObject,o=n.randomnessObject;sz.forEach(l=>{Object.assign(s.randomnessObject,{[l]:o[l]??a[l]})})}return s}e.merge=r})(Zo||(Zo={}));var V2;(e=>{e.defaultData={radial:{},linear:{},grid:{},toObject:{},randomnessObject:{}};let t=["radial","linear","grid","toObject","randomnessObject"];function r(i,n){let s=[];i.count!==void 0&&s.push({type:0,path:n,props:{count:i.count}});for(let a of t){let o=i[a];o&&Object.keys(o).length>0&&s.push({type:0,path:[...n,a],props:o})}return s}e.toOps=r})(V2||(V2={}));var ez=["count"],tz=["radius","start","end","position","scale","rotation"],rz=["position","scale","rotation"],iz=["count","size"],nz=["count","position","scale","rotation"],sz=["strength","scale","rotation","position","movement","seed","freqScale"],H2;(e=>{e.all=["PointLight","SpotLight","DirectionalLight","HemisphereLight"];function t(r){return e.all.includes(r)}e.is=t})(H2||(H2={}));var G2;(e=>{function t(i){return r(i)}e.defaultData=t;function r(i){if(i==="PointLight")return{type:i,color:_s.white,intensity:1,distance:2e3,decay:1,shadows:!0,shadowResolution:1024,shadowRadius:1,penumbraSize:.5,depth:1e5};if(i==="SpotLight")return{type:i,color:_s.white,intensity:1,distance:2e3,decay:1,shadows:!0,penumbra:0,angle:30/180*Math.PI,depth:1e5,penumbraSize:.5,shadowResolution:1024,shadowRadius:1};if(i==="DirectionalLight")return{type:i,color:_s.white,intensity:1,shadows:!0,size:2e3,depth:1e5,penumbraSize:.5,shadowResolution:1024,shadowRadius:1};throw new Error("not implemented")}})(G2||(G2={}));var Zu;(e=>e.defaultData={enabled:"visibility",fusedBody:!0,rigidBody:"positioned",density:1,pointMass:0,gravityScale:1,friction:.5,damping:0,restitution:.2,colliderType:"convex",enabledRotation:[!0,!0,!0],enabledTranslation:[!0,!0,!0]})(Zu||(Zu={}));var W2;(e=>{e.defaultData={castShadow:!0,receiveShadow:!0};function t(r,i){return r.castShadow===i.castShadow&&r.receiveShadow===i.receiveShadow}e.equals=t})(W2||(W2={}));var q2;(e=>{e.defaultData={flatShading:!1,wireframe:!1,side:0};function t(r,i){return r.flatShading===i.flatShading&&r.side===i.side&&r.wireframe===i.wireframe}e.equals=t})(q2||(q2={}));var X2;(e=>e.defaultData={...q2.defaultData,...W2.defaultData})(X2||(X2={}));var C4;(e=>{function t(r,i){var s,a;let n=[];if("material"in r){let o=typeof r.material=="string"?i.materials[r.material]??((s=i.lib.materials[r.material])==null?void 0:s.asset):r.material;o&&n.push(o)}else if("materials"in r)for(let o of r.materials){let l=typeof o=="string"?i.materials[o]??((a=i.lib.materials[o])==null?void 0:a.asset):o;l&&n.push(l)}return n}e.getMaterialData=t})(C4||(C4={}));var H0;(e=>(e.defaultVideo={data:"",thumb:"/_assets/_videos/catThumb.png",type:"video",name:"Cat video"},e.maxSize=3e7))(H0||(H0={}));var M4;(e=>{function t(r){return r==="texture"||r==="video"||r==="color"||r==="depth"||r==="normal"||r==="gradient"||r==="noise"||r==="fresnel"||r==="rainbow"||r==="toon"||r==="outline"||r==="transmission"||r==="matcap"||r==="displace"||r==="pattern"||r==="light"}e.is=t})(M4||(M4={}));function Xae(e){return e.type!=="displace"}var E4;(e=>{function t(r){return r==="phong"||r==="toon"||r==="lambert"||r==="physical"}e.is=t})(E4||(E4={}));var az=["mode","gradientType","noiseType","displacementType","projection","cnormal","crop","axis","side"],Yae=["wrapping","image","video","name"],Wi;(e=>{function t(s,a){let{texture:o,...l}=a;if(Object.assign(s,l),o){let c=s.texture;c&&Object.assign(c,o)}}e.patch=t;function r(s,a){return s==="light"&&a?i(a):n(s)}e.defaultData=r;function i(s){let a={mode:0,isMask:!1,visible:!0,bumpMap:void 0,bumpMapIntensity:5,roughnessMap:void 0,alphaOverride:1};switch(s){case"phong":return{...a,category:"phong",specular:{r:.2,g:.2,b:.2},shininess:5,type:"light",visible:!0,mode:0,occlusion:!0,alpha:.6};case"toon":return{...a,category:"toon",specular:{r:.2,g:.2,b:.2},shininess:10,type:"light",alpha:1};case"lambert":return{...a,category:"lambert",emissive:{r:0,g:0,b:0},type:"light",alpha:1,visible:!0,mode:0,occlusion:!0};case"physical":return{...a,category:"physical",roughness:.2,metalness:.2,reflectivity:.2,type:"light",alpha:1,visible:!0,mode:0,occlusion:!0}}}function n(s){let a={alpha:1,mode:0,isMask:!1,visible:!0};switch(s){case"texture":return{...a,type:"texture",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{image:"image_0",wrapping:1e3,repeat:[1,1],offset:[0,0]},crop:!1};case"video":return{...a,type:"video",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{video:H0.defaultVideo,wrapping:1001,repeat:[1,1],offset:[0,0]},crop:!1};case"color":return{...a,type:"color",color:Li.fromHex(rs)};case"depth":return{...a,type:"depth",gradientType:1,smooth:!1,isVector:!0,isWorldSpace:!1,origin:[0,0,0],direction:[1,0,0],colors:[[1,1,1,1],[0,0,0,1]],steps:[0,1],near:50,far:200};case"normal":return{...a,type:"normal",cnormal:[1,1,1]};case"gradient":return{...a,type:"gradient",gradientType:0,smooth:!1,colors:[[0,0,0,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,1,1,1,1,1,1,1,1,1],num:2,angle:0,offset:[0,0],morph:[0,0]};case"noise":return{...a,type:"noise",size:[100,100,100],noiseType:0,scale:1,move:1,colorA:{...Li.fromHex(6710886),a:1},colorB:{...Li.fromHex(6710886),a:1},colorC:{...Li.fromHex(16777215),a:1},colorD:{...Li.fromHex(16777215),a:1},distortion:[1,1],fA:[1.7,9.2],fB:[8.3,2.8],voronoiStyle:0,highCut:1,lowCut:0,smoothness:.3,seed:0,quality:1};case"fresnel":return{...a,type:"fresnel",color:_s.fromHexAndA(16777215,1),bias:.1,scale:1,intensity:2,factor:1};case"rainbow":return{...a,type:"rainbow",filmThickness:30,movement:0,wavelengths:[0,0,0],noiseStrength:0,noiseScale:1,offset:[0,0,0]};case"toon":return{...a,type:"toon",positioning:2,colors:[[0,0,0,1],[.5,.5,.5,1],[.5,.5,.5,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,.475,.525,1,1,1,1,1,1,1],num:4,source:[0,1e3,0],isWorldSpace:!0,noiseStrength:0,noiseScale:1,shadowColor:_s.fromHexAndA(0,0),offset:[0,0,0]};case"outline":return{...a,type:"outline",outlineColor:_s.fromHexAndA(0,1),contourColor:_s.fromHexAndA(0,1),outlineWidth:2,contourWidth:5,outlineThreshold:.4,contourThreshold:0,outlineSmoothing:0,contourFrequency:10,contourDirection:[0,1,0],positionalLines:!1,compensation:!0};case"matcap":return{...a,type:"matcap",texture:{image:"matcap_0",wrapping:1001,repeat:[1,1],offset:[0,0]}};case"transmission":return{...a,type:"transmission",thickness:10,ior:1.5,roughness:1};case"displace":return{visible:!0,type:"displace",displacementType:"noise",noiseType:0,scale:10,movement:1,offset:[0,0,0],intensity:8,voronoiStyle:0,smoothness:.3,seed:0,highCut:1,lowCut:0,quality:1};case"pattern":return{...a,type:"pattern",style:0,projection:0,axis:"y",blending:0,offset:[0,0],colorA:{...Li.fromHex(0),a:1},colorB:{...Li.fromHex(16777215),a:1},frequency:[10,10],size:.5,variation:0,smoothness:.5,zigzag:0,rotation:0,vertical:[0,1],horizontal:[0,1],sides:6}}}})(Wi||(Wi={}));var wi;(e=>{function t(c){return!c.layers.some(u=>u.data.type==="texture"&&u.data.projection!==0||u.data.type==="depth"&&!u.data.isWorldSpace||u.data.type==="noise"||u.data.type==="displace")}e.isMergable=t;function r(c){let u="";return c.layers.forEach(h=>{Object.entries(h.data).forEach(([d,p])=>{u+=`${d}${p}`,Array.isArray(p)?p.forEach(f=>u+=`${f}`):typeof p=="object"?Object.values(p).forEach(f=>{typeof f=="number"?u+=`${f.toFixed(4)}`:u+=`${f}`}):u+=`${p}`})}),u}e.getHash=r;function i(){return{layers:new st}}e.defaultEmptyData=i;function n(c="layer1",u="layer2"){return a("phong",c,u)}e.defaultData=n;function s(c,u){return{...c,name:u}}e.withName=s;function a(c,u="layer1",h="layer2"){let d=new st;return d.push({fi:0,data:Wi.defaultData("light",c),id:u}),d.push({fi:1,data:Wi.defaultData("color"),id:h}),{layers:d}}e.defaultTwoLayerData=a;function o(c,u="phong",h="layer1",d="layer2"){let p=Wi.defaultData("texture");Object.assign(p.texture,{image:c});let f=new st;return f.push({fi:0,data:p,id:h}),f.push({fi:1,data:Wi.defaultData("light",u),id:d}),{layers:f}}e.defaultTwoLayerTextureData=o;function l(c,u="phong",h="layer1",d="layer2"){let p=Wi.defaultData("video");Object.assign(p.texture,{video:c});let f=new st;return f.push({fi:0,data:p,id:h}),f.push({fi:1,data:Wi.defaultData("light",u),id:d}),{layers:f}}e.defaultTwoLayerVideoTextureData=l})(wi||(wi={}));var G0;(e=>{function t(){return{points:new st,roundness:0,shapeHoles:[],isClosed:!1}}e.defaultData=t})(G0||(G0={}));var W0;(e=>{function t(){return{points:new st,lastInsertionPlane:null,subdivisions:12,isClosed:!1}}e.defaultData=t})(W0||(W0={}));var oz={type:"Ellipse",width:50,height:50,spikes:16,angle:360,innerRadius:0},Y2;(e=>{function t(r,i){let n={...r};return cz.forEach(s=>{Object.assign(n,{[s]:i[s]??r[s]})}),n}e.merge=t})(Y2||(Y2={}));var lz={shape:oz,depth:1,offset:0,bevel:50,bevelSides:6,angle:0,twist:0,startScale:1,endScale:1,capType:"flat"},cz=["depth","offset","angle","twist","startScale","endScale"],q0;(e=>{function t(i){return i==="PolygonGeometry"||i==="RectangleGeometry"||i==="StarGeometry"||i==="TriangleGeometry"||i==="EllipseGeometry"}e.is2DParametricMesh=t;function r(i){return i==="PolygonGeometry"||i==="PolygonGeometry"||i==="RectangleGeometry"||i==="StarGeometry"||i==="TriangleGeometry"||i==="EllipseGeometry"||i==="PathGeometry"||i==="VectorGeometry"||i==="ConeGeometry"||i==="CubeGeometry"||i==="CylinderGeometry"||i==="DodecahedronGeometry"||i==="HelixGeometry"||i==="IcosahedronGeometry"||i==="LatheGeometry"||i==="PyramidGeometry"||i==="SphereGeometry"||i==="PlaneGeometry"||i==="BackdropGeometry"||i==="TorusGeometry"||i==="TorusKnotGeometry"||i==="BooleanGeometry"||i==="TextGeometry"}e.isParametricMesh=r})(q0||(q0={}));var Q2;(e=>{function t(r,i){let n={...r};return Object.assign(n,i),n.type==="PathGeometry"&&"extrusion"in i&&i.extrusion&&(n.extrusion={...r.extrusion},Object.assign(n.extrusion,Y2.merge(n.extrusion,i.extrusion))),n}e.merge=t})(Q2||(Q2={}));var yu;(e=>{function t(r){if(r==="RectangleGeometry")return{width:320,height:320,type:r,cornerRadius:[0,0,0,0],cornerType:0,depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if(r==="PathGeometry")return{type:r,width:1,height:1,depth:1,path:W0.defaultData(),extrusion:lz};if(r==="VectorGeometry")return{width:1,height:1,type:r,subdivisions:12,shape:G0.defaultData(),depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if(r==="BooleanGeometry")return{type:r,operation:2,width:0,height:0,depth:0,phongAngle:35};if(r==="TextGeometry")return{type:r,width:100,height:100,depth:0,horizontalAlign:1,verticalAlign:1,fontSize:16,lineHeight:1.2,letterSpacing:0,text:"",textTransform:1,font:"Roboto_regular",extrudeBevelSize:0,extrudeBevelSegments:1};if(r==="SphereGeometry")return{type:"SphereGeometry",width:100,height:100,depth:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:Math.PI};throw new Error("not implemented")}e.defaultData=t})(yu||(yu={}));var T4=["width","height","depth"],K2;(e=>e.defaultData={enabled:!1,useBackgroundColor:!1,color:Li.white,near:.1,far:2e3})(K2||(K2={}));var X0;(e=>{let t={opacity:1,blendFunction:13,enabled:!1};e.defaultData={enabled:!1,pixelation:{...t,blendFunction:16,granularity:15},bloom:{...t,blendFunction:16,intensity:1,blurScale:1,luminanceThreshold:.25,luminanceSmoothing:.025,kernelSize:3},chromaticAberration:{...t,offset:[2,2]},vignette:{...t,darkness:1,offset:0},hueSaturation:{...t,hue:3,saturation:0},brightnessContrast:{...t,brightness:.25,contrast:0},depthOfField:{...t,focalLength:2,focusDistance:2,bokehScale:2},noise:{...t,blendFunction:16}}})(X0||(X0={}));var Z2;(e=>e.defaultData={softShadowQuality:"low"})(Z2||(Z2={}));var $2;(e=>e.defaultData={enabled:!0,color:{r:.8274509803921568,g:.8274509803921568,b:.8274509803921568},intensity:.75})($2||($2={}));var J2;(e=>e.defaultData={occlusion:!1,aoFullRes:!1,radius:256,bias:.5,aoColor:{r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}})(J2||(J2={}));var $u;(e=>e.defaultData={usePhysics:!1,gravity:-10})($u||($u={}));var e_;(e=>e.defaultData={playCamera:_d,gameControlObject:null})(e_||(e_={}));var t_;(e=>e.defaultData={backgroundColor:_s.fromHexAndA(qae,1),postprocessing:X0.defaultData,fog:K2.defaultData,globalPhysics:$u.defaultData,ambient:$2.defaultData,ao:J2.defaultData,shadow:Z2.defaultData,publish:e_.defaultData})(t_||(t_={}));var P4;(e=>{function t(i){return i==="Component"||i==="Instance"}e.isComponentRelated=t;function r(i){return i==="Empty"||i==="Instance"}e.isEmptyOrComponent=r})(P4||(P4={}));var Ju;(e=>{e.identity={...j2.identity,hiddenMatrix:Qu.identity};function t(n){return{position:n.position,rotation:n.rotation,scale:n.scale,hiddenMatrix:n.hiddenMatrix}}e.fromObject=t;function r(n,s){return{position:(s==null?void 0:s.position)||n.position,rotation:(s==null?void 0:s.rotation)||n.rotation,scale:(s==null?void 0:s.scale)||n.scale,hiddenMatrix:(s==null?void 0:s.hiddenMatrix)||n.hiddenMatrix}}e.merge=r;function i(n,s){return iae({position:bc.isEqual(n.position,s.position)?void 0:s.position,rotation:bc.isEqual(n.rotation,s.rotation)?void 0:s.rotation,scale:bc.isEqual(n.scale,s.scale)?null:s.scale,hiddenMatrix:Qu.isEqual(n.hiddenMatrix,s.hiddenMatrix)?void 0:s.hiddenMatrix})}e.diff=i})(Ju||(Ju={}));var Ni;(e=>e.defaultData={states:new st,events:new st,visible:!0,raycastLock:!1,physics:Zu.defaultData,pathSnapping:{pathId:null,slide:0,offset:0,orientation:"tangential"},...Ju.identity,cloner:null})(Ni||(Ni={}));var r_;(e=>e.defaultData={type:"Empty",...Ni.defaultData})(r_||(r_={}));var D4;(e=>e.defaultData={type:"Component",...Ni.defaultData})(D4||(D4={}));var xu;(e=>e.defaultData={type:"Mesh",...Ni.defaultData,...X2.defaultData})(xu||(xu={}));var Hf;(e=>e.defaultData={...Ni.defaultData,...Ju.identity,position:[0,0,Ku.DefaultTargetOffset],...Ku.defaultData})(Hf||(Hf={}));var i_;(e=>{function t(r){return{...Ni.defaultData,...G2.defaultData(r)}}e.defaultData=t,e.defaultDirectionalLightData={...e.defaultData("DirectionalLight"),position:[200,300,300],name:"Directional Light",intensity:.7}})(i_||(i_={}));var Y0;(e=>{function t(i,n,s=0){for(;s<n.length;){let a=i?i[n[s]]:void 0;if(n.length===s+1)return a;if(a)i=a.descendants,s+=1;else return}}e.resolveWithDes=t;function r(i,n,s=0){let a=t(i,n,s);if(a){let o=Object.keys(a);if(o.length===1&&o[0]==="descendants")return}return a}e.resolve=r})(Y0||(Y0={}));var $o;(e=>{e.rootOverrideProps=["physics","events"],e.compositeNonOptionalOverrideProps=["geometry"],e.compositeEntireOverrideOverrideProps=["material"];function t(i,n){return{...Ni.defaultData,...n,component:i,overrides:new Vr,physics:void 0,events:void 0,type:"Instance"}}e.ofComponent=t;function r(i){let n=Ju.fromObject(i.data);return t(i.id,n)}e.fromComponentData=r})($o||($o={}));var ed;(e=>e.defaultData={type:"Page",...Ni.defaultData,physics:{...Zu.defaultData,fusedBody:!1},...t_.defaultData,camera:Hf.defaultData})(ed||(ed={}));var n_;(e=>(e.defaultCamera={position:[0,0,1e3],scale:[1,1,1],rotation:[0,0,0],hiddenMatrix:Qu.identity,name:"Play Camera",visible:!0,raycastLock:!1,physics:Zu.defaultData,states:new st,events:new st,cloner:null,pathSnapping:{pathId:null,orientation:"tangential",slide:0,offset:0},...Ku.defaultData},e.KeysByResetCategory={States:["states"],Events:["events"],Material:["material","materials"],Geometry:["geometry"],Position:["position"],Rotation:["rotation"],Scale:["scale"],Transform:["position","scale","rotation","hiddenMatrix"],Name:["name"],Visibility:["visible","raycastLock","flatShading","wireframe","side"],Shadows:["castShadow","receiveShadow"],Cloner:["cloner"],Physics:["physics"]},e.defaultMeshObject={name:"Rectangle",...Ni.defaultData,...xu.defaultData,geometry:yu.defaultData("RectangleGeometry"),material:wi.defaultTwoLayerData("phong","layer1","layer2")},e.defaultBooleanObject={name:"Boolean",...Ni.defaultData,...xu.defaultData,geometry:yu.defaultData("BooleanGeometry"),material:wi.defaultTwoLayerData("phong","layer1","layer2")},e.defaultTextObject={name:"Text",...Ni.defaultData,...xu.defaultData,geometry:yu.defaultData("TextGeometry"),material:wi.defaultTwoLayerData("phong","layer1","layer2")}))(n_||(n_={}));var uc;(e=>{function t(s,a){let o={name:a};return s.type==="Mesh"?(o.geometry={},"material"in s&&(o.material={layers:new Vr}),"materials"in s&&(o.materials=s.materials.map(l=>({layers:new Vr})))):zc.is(s.type)&&(o.perspective={},o.orthographic={}),o}e.newEmpty=t;function r(s,a){if(a===void 0)return s;let o={...s};return"material"in o&&"material"in a&&a.material&&(o.material=Vf(o.material,l=>{if(typeof l!="string")for(let[c,u]of Object.entries(a.material.layers)){let h=l.layers.data(c);h&&Wi.patch(h,u)}}).data),o.materials&&a.materials&&(o.materials=Vf(o.materials,l=>{var c,u;for(let h=0;h<o.materials.length;h++){let d=a.materials[h];if(typeof d!="string")for(let[p,f]of Object.entries(d.layers)){let m=(u=(c=l[h])==null?void 0:c.layers)==null?void 0:u.data(p);m&&Wi.patch(m,f)}}}).data),o}function i(s,a){let o,l=[],c={orthographic:0,perspective:0,geometry:0};function u(h,d){for(let[p,f]of Object.entries(d.layers)){let{texture:m,...g}=f;if(m!==void 0&&Object.keys(m).length>0){let v={path:[...h,"layers",p,"texture"],props:m,type:0};l.push(v)}if(Object.keys(g).length>0){let v={path:[...h,"layers",p],props:g,type:0};l.push(v)}}}for(let[h,d]of Object.entries(a))if(h!=="name")if(h==="cloner")l.push(...V2.toOps(d,["cloner"]));else if(h==="pathSnapping")l.push({path:[h],props:{slide:d.slide,offset:d.offset},type:0});else if(h==="material")u(["material"],d);else if(h==="materials")for(let[p,f]of Object.entries(d))u(["materials",p],f);else if(c[h]===0){if(h==="geometry"&&d.extrusion!==void 0){let p={path:[h,"extrusion"],props:d.extrusion,type:0};l.push(p),d={...d},delete d.extrusion}if(Object.keys(d).length>0){let p={path:[h],props:d,type:0};l.push(p)}}else o===void 0&&(o={path:[],props:{},type:0},l.push(o)),o.props[h]=d;return l}e.toOps=i;function n(s,a){var l,c,u,h,d,p;if(a===void 0)return s;let o={...s};if(Object.assign(o,Ju.merge(o,a)),Object.assign(o,{pathSnapping:Object.assign({},o.pathSnapping,{slide:((l=a.pathSnapping)==null?void 0:l.slide)??((c=o.pathSnapping)==null?void 0:c.slide)??0,offset:((u=a.pathSnapping)==null?void 0:u.offset)??((h=o.pathSnapping)==null?void 0:h.offset)??0})}),zc.is(s.type)){o.orthographic={...o.orthographic},o.perspective={...o.perspective};let f=a;((d=f.orthographic)==null?void 0:d.zoom)!==void 0&&(o.orthographic.zoom=f.orthographic.zoom),((p=f.perspective)==null?void 0:p.zoom)!==void 0&&(o.perspective.zoom=f.perspective.zoom),f.isUpVectorFlipped!==void 0&&(o.isUpVectorFlipped=f.isUpVectorFlipped),f.targetOffset!==void 0&&(o.targetOffset=f.targetOffset)}else if(s.type==="Mesh")"geometry"in a&&Object.assign(o,{geometry:Q2.merge(o.geometry,a.geometry)}),(a.material||a.materials)&&(o=r(o,a)),o.cloner&&"cloner"in a&&Object.assign(o,{cloner:Zo.merge(o.cloner,a.cloner)});else if(s.type==="Empty")o.cloner&&"cloner"in a&&Object.assign(o,{cloner:Zo.merge(o.cloner,a.cloner)});else if(H2.is(s.type)){let f=a;f.intensity!==void 0&&(o.intensity=f.intensity),f.color!==void 0&&(typeof f.color=="string"?o.color=f.color:o.color=Li.clone(f.color))}return o}e.patch=n})(uc||(uc={}));var Q0;(e=>e.defaultData={enablePan:!0,enableZoom:!0,enableRotate:!0,enableDamping:!0,rotationLimitsMode:0,rotationVerticalOffset:{min:Math.PI/4,max:Math.PI/4},rotationHorizontalOffset:{min:Math.PI/4,max:Math.PI/4},rotationSoftLimit:2,panLimitsMode:0,panVerticalOffset:{min:250,max:250},panHorizontalOffset:{min:250,max:250},panSoftLimit:2,zoomLimitsEnabled:!1,zoomLimits:{min:.1,max:2},autoRotate:!1,autoRotateSpeed:2,autoRotateClockwise:!0,hoverRotatePanMode:0,hoverRotatePanStrength:20,isTouchZoom:!0,orbitTouches:2,panTouches:3,resetHoverEffectOnPointerLeave:!0})(Q0||(Q0={}));var _c;(e=>e.defaultData={orbitControls:Q0.defaultData,playPage:ef,withBackground:!0,preventScroll:!1,preventTouchScroll:!1,hideCursor:!1,mouseEventTarget:"canvas",joystickSizeAndXYOffset:Array(12).fill(0).map((t,r)=>{let i=0,n=0;return r<5?n=-30:r<10&&(n=30),r===0||r===10||r===5?i=30:(r===4||r===11||r===9)&&(i=-30),[120,[i,n],"show"]}),settings:{image:{format:"jpg",ratio:1},video:{format:"mp4",imageFormat:"jpg",fps:30,mbps:80,ratio:Math.max(1,typeof window<"u"?Math.floor(window.devicePixelRatio):1),stopMode:"manual",duration:5e3},web:{logo:!0,compress:!0,preset:1,preload:!0,hint:!1}},stopRaycast:!0,hdTransmission:!1})(_c||(_c={}));var s_;(e=>e.defaultData={id:"basic",label:"Basic",style:"None",prompt:""})(s_||(s_={}));var a_;(e=>e.defaultData={weather:0,shadows:0,lightOrigin:0,temperature:0,sun:0,camera:0,environment:0,particles:0,nature:0,floor:0})(a_||(a_={}));var wu;(e=>(e.defaultData=()=>({mode:"line-art-both",prompt:"",negativePrompt:"",style:{...s_.defaultData},isRandomSeed:!0,seed:e.generateSeed(),guessMode:!1,advanced:!1,steps:20,guidanceScale:7.5,controlNetScale:1,modifiers:a_.defaultData}),e.generateSeed=()=>Math.round(Math.random()*1e5)))(wu||(wu={}));var Gf;(e=>{function t(i){return i.find(n=>n.data.type==="Page"&&n.data.globalPhysics.usePhysics)!==void 0}e.physicsEnabled=t;function r(i,n,s){i.scene.objects.traverseFrom(n,(a,o)=>{var l;if(o.type==="Instance"){let c=(l=$0.getComponentData(i,o.component))==null?void 0:l.data;c&&s(a,o,c.events)}else s(a,o,o.events)})}e.traverseModuleInstances=r})(Gf||(Gf={}));var bu;(e=>{e.TRASH_CAN_ID="830a2708-8ed9-49cf-a68e-085299892222";function t(n={withLight:!0,withSquare:!0}){let s=[],a=n_.defaultMeshObject;n.withLight===!0&&s.push({fi:-1,data:i_.defaultDirectionalLightData,id:"830a2708-8ed9-49cf-a68e-085299899103",children:[]}),n.withSquare===!0&&s.push({fi:1,id:"7ba78968-2a55-48f2-b14c-5191da3e075e",data:a,children:[]});let o=new rn;return o.push({fi:1,id:ef,data:{...ed.defaultData,name:"Scene 1"},children:s}),o}e.defaultData={objects:t(),publish:_c.defaultData,styles:wu.defaultData()},e.emptyDataWithoutPage=function(){return{objects:new rn,publish:_c.defaultData,styles:wu.defaultData()}},e.emptyDataWithPage=function(n){return{objects:t(n),publish:_c.defaultData,styles:wu.defaultData()}};function r(n){return{...e.defaultData,objects:Bc(n,rn.prototype)}}e.withObjs=r;function i(n,s){return r([{id:n,data:s,children:[],fi:0}])}e.withObj=i})(bu||(bu={}));var tf;(e=>e.defaultData={preset:"fullscreen",allowResponsive:!1,size:[512,512],coords:[0,0],sceneScale:1,color:{r:0,g:0,b:0,a:.5}})(tf||(tf={}));var K0;(e=>e.emptyImage={data:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVQYV2NgYAAAAAMAAWgmWQ0AAAAASUVORK5CYII=",name:"empty"})(K0||(K0={}));var o_;(e=>e.all=["images","videos","colors","audios","fonts","materials"])(o_||(o_={}));var L4;(e=>e.all=[...o_.all,"components"])(L4||(L4={}));var I4;(e=>{function t(){return{images:new wt,videos:new wt,colors:new wt,audios:new wt,fonts:new wt,materials:new wt,components:new wt}}e.defaultData=t})(I4||(I4={}));var Wf;(e=>{function t(){return{images:new wt,videos:new wt,colors:new wt,audios:new wt,fonts:new wt,materials:new wt,components:new wt}}e.defaultData=t})(Wf||(Wf={}));var Ga;(e=>{function t(){let n={};return n["89b10010-844c-11ec-a8a3-0242ac120002"]={r:.5,g:.5,b:.5,a:1,name:"Default Color"},Bc(n,wt.prototype)}e.defaultColors=t;function r(n){let s={};return n!=null&&n.withAITexture&&(s["a1b10010-844c-a8a3-11ec-0242ac2011ec"]={...K0.emptyImage,name:"AI generated image"}),Bc(s,wt.prototype)}e.defaultImages=r;function i(){return{catelogs:new wt,materials:new wt,images:new wt,videos:new wt,colors:new wt,audios:new wt,fonts:new wt,lib:Wf.defaultData()}}e.emptyData=i})(Ga||(Ga={}));var l_;(e=>e.list=["idle","move","jump","run"])(l_||(l_={}));var Z0;(e=>(e.defaultColliderData={type:"capsule",height:200,radius:50,position:[0,0,0],rotation:[0,0,0]},e.defaultDataThirdPerson={moveMode:"walk",forwardDirection:"+z",speedTranslate:1e3,speedRotate:100,runMultiplier:2,rotationMode:"normal",rotBy:"keys",rotByTouch:"drag",delayPos:[.3,.3],delayRot:[.3,.3],keyAssignments:[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX","▲"],["rotPosY","◀"],["rotNegX","▼"],["rotNegY","▶"],["jump","Space"],["run","⇧"],["none","Ctrl"]],touchControl:!0,joystickPosLoc:5,joystickRotLoc:11,jumpTouchButtonLoc:9,collider:e.defaultColliderData,colliderHelperVisible:!0,collisionEnabled:!0,jumpPower:100,resetYPosition:3e3,alignToGround:!1,autoOrientMove:!0,orientWith:"camera",orientMode:"radial",delayPosCamera:.3,delayRotCamera:.3,camera:"",cameraXAxis:"Limit",cameraYAxis:"Free",cameraRotXLimits:[0,Math.PI/2],cameraRotYLimits:[-Math.PI/2,Math.PI/2],gameActions:{idle:new st,move:new st,jump:new st,run:new st},navmesh:{enabled:!1,ch:6,cs:6,walkableClimb:5,walkableHeight:1,walkableRadius:0,zones:"all",objects:[],helperVisible:!0,destinationHelperRadius:0,destinationHelperColor:_s.fromHexAndA(3728051,1)}}))(Z0||(Z0={}));function O4(e){e.layers.forEach(t=>{if(t.type==="depth"&&t.colorA!==void 0){let r=t.colorA,i=t.colorB,n=[[r.r,r.g,r.b,r.a],[i.r,i.g,i.b,i.a]],s=[0,1];for(let o=2;o<10;o++)n.push(n[1]),s.push(1);let a={...no(ti(t),"type","visible","isVector","isWorldSpace","origin","alpha","mode"),near:Math.max(0,t.near),far:Math.max(0,t.far),colors:n,steps:s,num:2,direction:[1,0,0],smooth:!1,gradientType:1};Object.assign(t,a)}else if(t.type==="depth"&&t.gradientType===1&&(t.near<0||t.far<0)){let r={...ti(t),near:Math.max(t.near,0),far:Math.max(t.far,0)};Object.assign(t,r)}})}function Ho(e,t){Object.values(e.shared.materials).forEach(r=>t(r))}function Go(e,t){e.scene.objects.traverse((r,i)=>{"materials"in i?i.materials.forEach((n,s)=>{n===void 0&&(i.materials[s]=wi.defaultData(),n=i.materials[s]),typeof n!="string"&&t(n)}):"material"in i?typeof i.material!="string"&&(i.material===void 0&&(i.material=wi.defaultData()),t(i.material)):i.type==="Mesh"&&(i.material===void 0&&(i.material=wi.defaultData()),t(i.material)),"overrides"in i&&Object.values(i.overrides).forEach(n=>{n.material&&typeof n.material!="string"&&t(n.material)})})}function Qae(e){Object.assign(e.scene.publish,{orbitControls:{...Q0.defaultData,...ti(e.scene.publish.orbitControls)}})}function Kae(e){Object.assign(e.scene.publish.settings,{video:{..._c.defaultData.settings.video,...ti(e.scene.publish.settings.video)}})}function Zae(e){function t(r){if(r.layers){for(let i of Object.values(r.layers))if(i){for(let[n,s]of Object.entries(i))if((az.includes(n)||typeof s=="boolean")&&delete i[n],n==="texture")for(let[a,o]of Object.entries(s))(Yae.includes(a)||typeof o=="boolean")&&delete s[a]}}}e.scene.objects.traverse((r,i)=>{i.states.forEach(n=>{let s=n;s.material?t(s.material):s.materials&&s.materials.forEach(a=>{t(a)})})})}function $ae(e){e.scene.publish.withBackground=!0}function Jae(e){e.scene.publish.settings.web={compress:!0,preload:!0,preset:1,logo:!0,hint:!1}}function eoe(e){e.scene.objects.traverse((t,r)=>{let i=r.cloner;i&&(i.radial.scale=i.radial.scale.map(n=>n+1),i.linear.scale=i.linear.scale.map(n=>n+1))})}function toe(e){e.scene.objects.traverse((t,r)=>{let i=r.geometry;i&&(i.type==="DodecahedronGeometry"||i.type==="IcosahedronGeometry")&&(i.detail=Math.round(i.detail))})}function roe(e){e.scene.objects.traverse((t,r)=>{let i=e.scene.objects.unproxy().parent(t);if(i){let n=ti(e.scene.objects.data(i));n&&n.type==="Mesh"&&n.geometry.type==="BooleanGeometry"&&r.type==="Mesh"&&(r.visible=ti(r).booleanExclude!==!0)}})}function ioe(e){e.scene.objects.traverse((t,r)=>{if(r.type==="Mesh"){let i=r;r.geometry.type==="NonParametricGeometry"?i.material!==void 0&&delete i.material:i.materials!==void 0&&delete i.materials}})}function noe(e){function t(i){Object.setPrototypeOf(i,Vr.prototype),i.texture&&Object.setPrototypeOf(i.texture,Vr.prototype)}function r(i){Object.setPrototypeOf(i,Vr.prototype);for(let n in i)t(i[n])}e.scene.objects.traverse((i,n)=>{n.states.forEach(s=>{let a=s;if(a.material){let o=ti(a.material).layers;r(o),a.material.layers=o}if(a.materials)for(let o=0;o<a.materials.length;o++){let l=a.materials[o],c=ti(l).layers;r(c),l.layers=c}})})}function R4(e){e.layers===void 0&&Object.assign(e,wi.defaultTwoLayerData("lambert"))}function Qx(e){!e.layers||e.layers.forEach(t=>{if(t.type==="depth"&&t.colors.length===10){let r=[...t.colors];r.push(t.colors[9]);let i=[...t.steps];i.push(t.steps[9]);let n={...ti(t),colors:r,steps:i};Object.assign(t,n)}})}function soe(e){e.scene.objects.traverse((t,r)=>{r.type==="Mesh"&&(r.geometry.type==="BooleanGeometry"||r.geometry.type==="SubdivGeometry")&&(r.geometry.phongAngle=35)})}function B4(e){e.scene.objects.traverse((t,r)=>{"materials"in r?r.materials.forEach(i=>{typeof i!="string"&&Qx(i)}):"material"in r&&typeof r.material!="string"&&Qx(r.material)}),Object.values(e.shared.materials).forEach(t=>Qx(t))}function aoe(e){e.scene.environment.ambientLight.softShadows=!1,e.scene.environment.ambientLight.softShadowQuality="low",e.scene.objects.traverse((t,r)=>{(r.type==="DirectionalLight"||r.type==="SpotLight")&&(r.shadowResolution=1024,r.shadowRadius=1,r.depth=1e5)}),e.shared.penumbraSize=new Array(5).fill(.5)}function ooe(e){e.shared.audios=Bc({},wt.prototype)}function loe(e){e.shared.videos=Bc({},wt.prototype)}function coe(e){let t=e.shared.materials;Object.entries(t).forEach(([r,i])=>{if(!i.layers){let n={name:"Untitled Material",layers:[{fi:0,data:{type:"light",category:"phong",alpha:.6,visible:!0,mode:0,specular:{r:.2,g:.2,b:.2},shininess:5},id:"layer1"},{fi:1,data:{type:"color",alpha:1,visible:!0,mode:0,color:{r:.2823529411764706,g:.2823529411764706,b:.30196078431372547}},id:"layer2"}]};Object.assign(t,{[r]:n})}})}function hoe(e){Object.entries(ti(e.shared.images)).filter(t=>t[1].asset===!1).map(t=>t[0]).forEach(t=>{delete e.shared.images[t]}),Object.entries(ti(e.shared.audios)).filter(t=>t[1].asset===!1).map(t=>t[0]).forEach(t=>{delete e.shared.audios[t]})}function uoe(e){e.scene.publish.settings.web.preload=!1}function z4(e){e.layers&&e.layers.forEach(t=>{t.type==="depth"&&t.num!==void 0&&(t.colors=t.colors.slice(0,t.num),t.steps=t.steps.slice(0,t.num),delete t.num)})}function k4(e){e.layers&&e.layers.forEach(t=>{Xae(t)&&t.isMask===void 0&&(t.isMask=!1),(t.type==="texture"||t.type==="video")&&t.blending===void 0&&(t.blending=0),(t.type==="noise"||t.type==="displace"&&t.displacementType==="noise")&&(t.voronoiStyle===void 0&&(t.voronoiStyle=0),t.highCut===void 0&&(t.highCut=1),t.lowCut===void 0&&(t.lowCut=0),t.smoothness===void 0&&(t.smoothness=.3),t.seed===void 0&&(t.seed=0),t.quality===void 0&&(t.quality=1))})}function doe(e){e.shared.fonts=Bc({},wt.prototype)}function poe(e){return e.replace(".typeface","").replace(/optimer/gi,"open sans").replace("space_mono","space mono").replace(/alma_mono/gi,"varela round").replace(/droid_sans_mono/gi,"noto sans mono").replace(/droid_sans|gentilis|gnomon_(simple|foreground)|helvetiker/gi,"roboto").replace(/droid_serif/gi,"roboto slab").replace("_sans"," sans").replace("crimson_text","crimson text").replace("medium_medium","medium").replace("fatface_fatface","fatface").replace("100hairline","thin").replace("200thin","extralight").replace("300light","light").replace("500medium","medium").replace("600semi","semibold").replace("800heavy","extrabold").replace("900black","black").replace(/bodoni_(11|16|24|36|48|72|96)([^_])/gi,"bodoni_$1_$2").replace(/bodoni_(11|16|24|36|48|72|96)/gi,"bodoni moda").replace(/(thin|hairline)(_regular)?/gi,"100").replace(/(extra|ultra)light(_regular)?/gi,"200").replace(/light(_regular)?/gi,"300").replace(/_book|_normal|_roman/gi,"_regular").replace(/medium(_regular)?/gi,"500").replace(/(semi|demi)bold(_regular)?/gi,"600").replace(/(extra|ultra)bold(_regular)?/gi,"800").replace(/bold(_regular)?/gi,"700").replace(/(black|heavy|fatface)(_regular)?/gi,"900").replace(/([1-9]00)_italic/gi,"$1italic").replace(/regularitalic/gi,"italic").replace(/regularitalic/gi,"italic").split(" ").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}function foe(e){let t=[];e.scene.objects.traverse((r,i)=>{let n=i;if(n.type==="TextFrame"){let s=wi.defaultTwoLayerData("phong"),a=typeof n.color=="string"?e.shared.colors[n.color]:n.color;s.layers[1].data.color={r:a.r,g:a.g,b:a.b},s.layers[1].data.alpha=n.alpha;let o=poe(n.font);e.shared.fonts[o]===void 0&&(e.shared.fonts[o]={name:o});let l={name:n.name,...Ni.defaultData,...xu.defaultData,flatShading:!1,wireframe:!1,geometry:{...yu.defaultData("TextGeometry"),width:n.width,height:n.height,font:o,depth:0,horizontalAlign:n.horizontalAlign,verticalAlign:n.verticalAlign,fontSize:n.fontSize*1.40625,lineHeight:n.lineHeight/1.40625,letterSpacing:n.letterSpacing-1,text:n.text,textTransform:n.textTransform,extrudeBevelSize:0,extrudeBevelSegments:1},material:s,states:ti(n.states),events:ti(n.events),visible:n.visible,raycastLock:n.raycastLock,position:n.position,rotation:n.rotation,scale:n.scale,hiddenMatrix:n.hiddenMatrix},c=ti(e.scene.objects).parent(r);e.scene.objects.insertAfter(c??null,r,[{id:r+"new",data:l,children:[]}]),t.push(r)}}),t.forEach(r=>{e.scene.objects.delete(r)})}function moe(e){let t={0:"MouseDown",1:"MouseUp",2:"MouseHover",5:"KeyDown",6:"KeyUp",7:"Start",9:"LookAt",10:"Follow",11:"Scroll",12:"Audio",13:"GameControl"};e.scene.objects.traverse((r,i)=>{i.events.forEach(n=>{if(t[Number(n.type)])if(Object.assign(n,{type:t[Number(n.type)]}),n.type==="Audio"&&"audioEvent"in n&&(Object.assign(n,{playAudio:n.audioEvent}),delete n.audioEvent),n.type==="GameControl")Object.assign(n,{gameActions:{idle:new st,move:new st,jump:new st}});else{let s=new st;Object.assign(n,{actions:s}),(n.type==="MouseDown"||n.type==="MouseUp"||n.type==="KeyDown"||n.type==="KeyUp")&&"url"in n&&s.push({fi:0,id:mt.generateUUID(),data:{type:"Link",url:n.url,delay:0}}),"targets"in n&&(n.targets.forEach((a,o,l)=>{let c={state:void 0,repeat:0,delay:0,delayDirection:void 0,direction:"normal",duration:0,easing:4},u={easing:a.easing,duration:a.duration};a.easing===6?Object.assign(u,no(a,"mass","stiffness","damping","velocity")):a.easing===5&&Object.assign(u,{control1:{...a.control1},control2:{...a.control2}});let h={repeat:a.repeat?-1:0,delay:a.delay,delayDirection:a.delayDirection,direction:a.cycle&&a.rewind?"pingpong-rewind":a.cycle?"pingpong":"normal"},d={state:a.state,...h,...u},p={allowSlerp:!0,type:"Transition",object:a.object,repeat:0,delay:0,delayDirection:void 0,direction:"normal",tweens:new st({fi:0,id:mt.generateUUID(),data:c},{fi:1,id:mt.generateUUID(),data:d})};s.push({fi:l,id:o,data:p})}),delete n.targets)}})})}function goe(e){e.scene.objects.traverse((t,r)=>{function i(n,s){var l;let a=new st,o=[];if(r.events.forEach((c,u,h)=>{if(c.type==="Audio"&&c.trigger===s){let d;o.push(u),c.interaction==="play"?d={...no(c,"interaction","audio","delay","volume","loop"),triggerAfter:"after"in c?c.after:void 0,toggle:"after"in c?c.toggle:void 0,type:"Audio"}:(c.interaction==="pause"||c.interaction==="stop")&&(d={...no(c,"interaction","delay","object","playAudio"),type:"Audio"}),d&&a.push({fi:h,id:u,data:d})}}),o.forEach(c=>r.events.delete(c)),a.length){let c=(l=r.events.find(u=>u.type===n))==null?void 0:l.data;c?"actions"in c&&c.actions.insertBefore(null,a):r.events.insertBefore(null,[{id:mt.generateUUID(),data:{type:n,actions:a}}])}}i("Start","start"),i("MouseDown","mouseDown"),i("MouseUp","mouseUp"),i("KeyDown","keyDown"),i("KeyUp","keyUp")})}function N4(e){var r;let t=(r=e.layers.find(i=>i.type==="light"))==null?void 0:r.data;if((t==null?void 0:t.category)==="basic"){let i=Wi.defaultData("light","phong"),n=t;Object.assign(n,i),n.visible=!1}}function F4(e){Ho(e,N4),Go(e,N4)}function voe(e){e.scene.objects.traverse((t,r)=>{r.type==="Mesh"&&r.geometry.type==="SubdivGeometry"&&(r.geometry.scaleBaked||(r.geometry.scaleBaked=[1,1,1]))})}function yoe(e){e.scene.objects.traverse((t,r)=>{(r.type==="Empty"||r.type==="Mesh")&&r.cloner&&!r.cloner.randomnessObject&&!r.cloner.toObject&&!r.cloner.randomness&&(r.cloner={...r.cloner,toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}})})}function xoe(e){e.scene.objects.traverse((t,r)=>{r.type==="Mesh"&&r.geometry.type==="NonParametricGeometry"&&!("material"in r)&&!("materials"in r)&&(r.material=wi.defaultTwoLayerData("phong"))})}function woe(e){e.scene.publish.orbitControls.autoZoom===void 0&&(e.scene.publish.orbitControls.autoZoom=!1),e.scene.objects.traverse((t,r)=>{(r.type==="OrthographicCamera"||r.type==="PerspectiveCamera")&&(r.orthographic.autoZoom===void 0&&(r.orthographic.autoZoom=!1),r.orthographic.autoZoomFrustumSize===void 0&&(r.orthographic.autoZoomFrustumSize=790))})}function boe(e){e.scene.objects.traverse((t,r)=>{r.pathSnapping===void 0&&(r.pathSnapping={pathId:null,slide:0,offset:0,orientation:"tangential"}),r.pathSnapping.offset===void 0&&(r.pathSnapping.offset=0)})}function _oe(e){e.scene.publish.mouseEventTarget===void 0&&(e.scene.publish.mouseEventTarget="canvas"),e.scene.publish.settings.web.hint===void 0&&(e.scene.publish.settings.web.hint=!1)}function Soe(e){let{video:t}=e.scene.publish.settings;t.format==="gif"&&t.fps>48&&(t.fps=15)}function Aoe(e){e.scene.objects.traverse((t,r)=>{r.events.forEach(i=>{i.type==="GameControl"&&(i.resetYPosition=Math.abs(i.resetYPosition-r.position[1]))})})}function Coe(e){let t=e.scene.environment.usePhysics;e.scene.objects.traverse((r,i)=>{t&&i.physics===null?i.collision=!1:i.collision="visibility"})}function Moe(e){e.scene.objects.traverse((t,r)=>{r.events.forEach(i=>{i.type==="GameControl"&&(i.navmesh=Z0.defaultDataThirdPerson.navmesh)})})}function Eoe(e){e.scene.styles||(e.scene.styles=wu.defaultData())}function U4(e){e.layers.forEach(t=>{t.type==="light"&&t.category!=="toon"&&t.occlusion===void 0&&(t.occlusion=!0)})}function Toe(e){e.scene.environment.ambientLight.occlusion===void 0&&(e.scene.environment.ambientLight.occlusion=!1),e.scene.environment.ambientLight.aoFullRes===void 0&&(e.scene.environment.ambientLight.aoFullRes=!1),e.scene.environment.ambientLight.radius===void 0&&(e.scene.environment.ambientLight.radius=256),e.scene.environment.ambientLight.bias===void 0&&(e.scene.environment.ambientLight.bias=.5),e.scene.environment.ambientLight.aoColor===void 0&&(e.scene.environment.ambientLight.aoColor={r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}),Go(e,U4),Ho(e,U4)}function Poe(e){e.scene.objects.traverse((t,r)=>{r.events.forEach(i=>{i.type==="GameControl"&&Object.assign(i.gameActions,{run:new st})})})}function Doe(e){e.scene.objects.traverse((t,r)=>{r.events.forEach(i=>{i.type==="GameControl"&&(i.keyAssignments=[...i.keyAssignments,["run","⇧"],["none","Ctrl"]])})})}function j4(e){e.layers&&e.layers.forEach(t=>{t.type==="light"&&t.bumpMapIntensity===void 0&&(t.bumpMapIntensity=5)})}function Loe(e,t){if(t<1&&(Go(e,O4),Ho(e,O4),e.schema=1),t<2&&(Qae(e),e.schema=2),t<3&&(Zae(e),e.schema=3),t<4&&($ae(e),e.schema=4),t<5&&(Jae(e),e.schema=5),t<6&&(eoe(e),e.schema=6),t<7&&(toe(e),e.schema=7),t<8&&(e.schema=8),t<9&&(B4(e),e.schema=9),t<10&&(soe(e),e.schema=10),t<11&&(aoe(e),e.schema=11),t<12&&(B4(e),e.schema=12),t<13&&(ooe(e),e.schema=13),t<14&&(coe(e),e.schema=14),t<15&&(hoe(e),e.schema=15),t<16&&(uoe(e),e.schema=16),t<17&&(Go(e,z4),Ho(e,z4),e.schema=17),t<18&&(Go(e,R4),Ho(e,R4),e.schema=18),t<19&&(Kae(e),e.schema=19),t<20&&(doe(e),foe(e),e.schema=20),t<21&&(moe(e),goe(e),e.schema=21),t<22&&(F4(e),e.schema=22),t<23&&(voe(e),e.schema=23),t<24&&(yoe(e),e.schema=24),(t<25||e.shared.videos===void 0)&&(loe(e),t<25&&(e.schema=25)),t<26&&(roe(e),e.schema=26),t<27&&(ioe(e),e.schema=27),t<28&&(F4(e),e.schema=28),t<29&&(noe(e),e.schema=29),t<30&&(xoe(e),e.schema=30),t<31&&(woe(e),e.schema=31),t<33&&(boe(e),e.schema=33),t<34&&(_oe(e),e.schema=34),t<35&&(Soe(e),e.schema=35),t<36&&(Aoe(e),e.schema=36),t<37&&(Coe(e),e.schema=37),t<38&&(Go(e,k4),Ho(e,k4),e.schema=38),t<39&&(Moe(e),e.schema=39),t<40&&(Eoe(e),e.schema=40),t<41&&(Toe(e),e.schema=41),t<42&&(Poe(e),e.schema=42),t<43&&(Doe(e),e.schema=43),t<99){Go(e,j4),Ho(e,j4),e.scene.publish.playCamera===null&&(e.scene.publish.playCamera=_d);let r=ti(e.scene.objects),i=e.scene.objects;e.scene.publish.playPage=ef,i.insertBefore(null,null,[{id:ef,data:{...ed.defaultData,backgroundColor:e.scene.backgroundColor,fog:e.scene.fog,postprocessing:e.scene.postprocessing,ao:no(e.scene.environment.ambientLight,"occlusion","aoFullRes","radius","bias","aoColor"),publish:{playCamera:e.scene.publish.playCamera,gameControlObject:e.scene.publish.gameControlObject},shadow:no(e.scene.environment.ambientLight,"softShadowQuality"),globalPhysics:{...$u.defaultData,...no(e.scene.environment,"usePhysics","gravity")},camera:ti(e.scene.ownerCamera)??ed.defaultData.camera,name:"Scene"},children:[]}]);for(let a of r)a.id!==bu.TRASH_CAN_ID&&i.move(ef,a.fi,a.id);let n=0,s=0;e.shared.penumbraSize&&e.scene.objects.traverse((a,o)=>{o.type==="DirectionalLight"?(o.penumbraSize=e.shared.penumbraSize[Math.min(n,2)],n+=1):o.type==="SpotLight"&&(o.penumbraSize=e.shared.penumbraSize[3+Math.min(s,1)],s+=1),(o.physics===void 0||o.physics===null)&&o.type!=="Instance"&&(o.physics={},Object.assign(o.physics,Zu.defaultData)),o.physics!==void 0&&o.physics!==null&&(o.physics.enabled=o.collision??"visibility",delete o.collision)}),e.schema=99}}function V4(e){e.layers&&e.layers.forEach(t=>{t.type==="light"&&t.alphaOverride===void 0&&(t.alphaOverride=1)})}function Ioe(e){e.scene.objects.traverse((t,r)=>{let i=r.geometry;i&&i.type==="PathGeometry"&&(i.extrusion.capType="flat",i.extrusion.bevel=50,i.extrusion.bevelSides=6,i.extrusion.shape.type==="Custom"&&(i.extrusion.shape.shapeQuality="low"))})}var tc=104;function hz(e){let t=e.schema??0;t!==tc&&(console.warn("updating from ",t,"to ",tc),Loe(e,t),t<100&&(e.scene.publish.joystickSizeAndXYOffset===void 0&&(e.scene.publish.joystickSizeAndXYOffset=_c.defaultData.joystickSizeAndXYOffset),e.schema=100),t<101&&(Go(e,V4),Ho(e,V4),e.schema=101),t<102&&(Ioe(e),e.schema=102),t<104&&(e.shared.catelogs=new wt,e.shared.lib=Wf.defaultData(),e.schema=104))}var $0;(e=>{e.defaultData={schema:tc,scene:bu.defaultData,frames:new wt().add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",tf.defaultData),shared:{...Ga.emptyData(),colors:Ga.defaultColors()}},e.emptyDataForImports=function(n){let s=bu.emptyDataWithPage(n);return{schema:tc,scene:s,frames:new wt().add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",tf.defaultData),shared:{...Ga.emptyData(),colors:Ga.defaultColors(),images:Ga.defaultImages(n)}}},e.emptyData=function(){return{schema:tc,scene:bu.emptyDataWithPage(),frames:new wt().add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",tf.defaultData),shared:Ga.emptyData()}},e.collabHelper={...L2,updateSchema(n){return(n.schema??0)<tc?Vf(n,hz):(n.schema??0)-tc}};function t(n){let s=e.collabHelper.updateSchema(n);return typeof s=="number"?s===0?n:null:s.data}e.updateSchemaDirectly=t;function r(n){return{...n,shared:{...n.shared,lib:Wf.defaultData()}}}e.withoutLib=r;function i(n,s){let a=n.scene.objects.get(s);if(a&&a.data.type==="Component")return a;{let o=n.shared.lib.components[s];if(o)return o.asset}}e.getComponentData=i})($0||($0={}));function dc(e,t=!1){let r=e[0].index!==null,i=new Set(Object.keys(e[0].attributes)),n=new Set(Object.keys(e[0].morphAttributes)),s={},a={},o=e[0].morphTargetsRelative,l=new it,c=0;for(let u=0;u<e.length;++u){let h=e[u],d=0;if(r!==(h.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(let p in h.attributes){if(!i.has(p))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+'. All geometries must have compatible attributes; make sure "'+p+'" attribute exists among all geometries, or in none of them.'),null;s[p]===void 0&&(s[p]=[]),s[p].push(h.attributes[p]),d++}if(d!==i.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". Make sure all geometries have the same number of attributes."),null;if(o!==h.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(let p in h.morphAttributes){if(!n.has(p))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+".  .morphAttributes must be consistent throughout all geometries."),null;a[p]===void 0&&(a[p]=[]),a[p].push(h.morphAttributes[p])}if(t){let p;if(r)p=h.index.count;else if(h.attributes.position!==void 0)p=h.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". The geometry must have either an index or a position attribute"),null;l.addGroup(c,p,u),c+=p}}if(r){let u=0,h=[];for(let d=0;d<e.length;++d){let p=e[d].index;for(let f=0;f<p.count;++f)h.push(p.getX(f)+u);u+=e[d].attributes.position.count}l.setIndex(h)}for(let u in s){let h=H4(s[u]);if(!h)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+u+" attribute."),null;l.setAttribute(u,h)}for(let u in a){let h=a[u][0].length;if(h===0)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[u]=[];for(let d=0;d<h;++d){let p=[];for(let m=0;m<a[u].length;++m)p.push(a[u][m][d]);let f=H4(p);if(!f)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+u+" morphAttribute."),null;l.morphAttributes[u].push(f)}}return l}function H4(e){let t,r,i,n=0;for(let o=0;o<e.length;++o){let l=e[o];if(l.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(t===void 0&&(t=l.array.constructor),t!==l.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(r===void 0&&(r=l.itemSize),r!==l.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(i===void 0&&(i=l.normalized),i!==l.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;n+=l.array.length}let s=new t(n),a=0;for(let o=0;o<e.length;++o)s.set(e[o].array,a),a+=e[o].array.length;return new nt(s,r,i)}var Ooe=Math.pow(2,-24),Mg=class{constructor(){}};function ia(e,t,r){return r.min.x=t[e],r.min.y=t[e+1],r.min.z=t[e+2],r.max.x=t[e+3],r.max.y=t[e+4],r.max.z=t[e+5],r}function G4(e){let t=-1,r=-1/0;for(let i=0;i<3;i++){let n=e[i+3]-e[i];n>r&&(r=n,t=i)}return t}function W4(e,t){t.set(e)}function q4(e,t,r){let i,n;for(let s=0;s<3;s++){let a=s+3;i=e[s],n=t[s],r[s]=i<n?i:n,i=e[a],n=t[a],r[a]=i>n?i:n}}function Eg(e,t,r){for(let i=0;i<3;i++){let n=t[e+2*i],s=t[e+2*i+1],a=n-s,o=n+s;a<r[i]&&(r[i]=a),o>r[i+3]&&(r[i+3]=o)}}function Jd(e){let t=e[3]-e[0],r=e[4]-e[1],i=e[5]-e[2];return 2*(t*r+r*i+i*t)}function Roe(e,t){if(!e.index){let r=e.attributes.position.count,i=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,n;r>65535?n=new Uint32Array(new i(4*r)):n=new Uint16Array(new i(2*r)),e.setIndex(new nt(n,1));for(let s=0;s<r;s++)n[s]=s}}function Boe(e){if(!e.groups||!e.groups.length)return[{offset:0,count:e.index.count/3}];let t=[],r=new Set;for(let n of e.groups)r.add(n.start),r.add(n.start+n.count);let i=Array.from(r.values()).sort((n,s)=>n-s);for(let n=0;n<i.length-1;n++){let s=i[n],a=i[n+1];t.push({offset:s/3,count:(a-s)/3})}return t}function Kx(e,t,r,i,n=null){let s=1/0,a=1/0,o=1/0,l=-1/0,c=-1/0,u=-1/0,h=1/0,d=1/0,p=1/0,f=-1/0,m=-1/0,g=-1/0,v=n!==null;for(let y=t*6,x=(t+r)*6;y<x;y+=6){let w=e[y+0],b=e[y+1],_=w-b,A=w+b;_<s&&(s=_),A>l&&(l=A),v&&w<h&&(h=w),v&&w>f&&(f=w);let S=e[y+2],C=e[y+3],M=S-C,T=S+C;M<a&&(a=M),T>c&&(c=T),v&&S<d&&(d=S),v&&S>m&&(m=S);let P=e[y+4],D=e[y+5],I=P-D,B=P+D;I<o&&(o=I),B>u&&(u=B),v&&P<p&&(p=P),v&&P>g&&(g=P)}i[0]=s,i[1]=a,i[2]=o,i[3]=l,i[4]=c,i[5]=u,v&&(n[0]=h,n[1]=d,n[2]=p,n[3]=f,n[4]=m,n[5]=g)}function zoe(e,t,r,i){let n=1/0,s=1/0,a=1/0,o=-1/0,l=-1/0,c=-1/0;for(let u=t*6,h=(t+r)*6;u<h;u+=6){let d=e[u+0];d<n&&(n=d),d>o&&(o=d);let p=e[u+2];p<s&&(s=p),p>l&&(l=p);let f=e[u+4];f<a&&(a=f),f>c&&(c=f)}i[0]=n,i[1]=s,i[2]=a,i[3]=o,i[4]=l,i[5]=c}function koe(e,t,r,i,n){let s=r,a=r+i-1,o=n.pos,l=n.axis*2;for(;;){for(;s<=a&&t[s*6+l]<o;)s++;for(;s<=a&&t[a*6+l]>=o;)a--;if(s<a){for(let c=0;c<3;c++){let u=e[s*3+c];e[s*3+c]=e[a*3+c],e[a*3+c]=u;let h=t[s*6+c*2+0];t[s*6+c*2+0]=t[a*6+c*2+0],t[a*6+c*2+0]=h;let d=t[s*6+c*2+1];t[s*6+c*2+1]=t[a*6+c*2+1],t[a*6+c*2+1]=d}s++,a--}else return s}}var za=32,Noe=(e,t)=>e.candidate-t.candidate,Co=new Array(za).fill().map(()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0})),Tg=new Float32Array(6);function Foe(e,t,r,i,n,s){let a=-1,o=0;if(s===0)a=G4(t),a!==-1&&(o=(t[a]+t[a+3])/2);else if(s===1)a=G4(e),a!==-1&&(o=Uoe(r,i,n,a));else if(s===2){let l=Jd(e),c=1.25*n,u=i*6,h=(i+n)*6;for(let d=0;d<3;d++){let p=t[d],f=(t[d+3]-p)/za;if(n<za/4){let m=[...Co];m.length=n;let g=0;for(let y=u;y<h;y+=6,g++){let x=m[g];x.candidate=r[y+2*d],x.count=0;let{bounds:w,leftCacheBounds:b,rightCacheBounds:_}=x;for(let A=0;A<3;A++)_[A]=1/0,_[A+3]=-1/0,b[A]=1/0,b[A+3]=-1/0,w[A]=1/0,w[A+3]=-1/0;Eg(y,r,w)}m.sort(Noe);let v=n;for(let y=0;y<v;y++){let x=m[y];for(;y+1<v&&m[y+1].candidate===x.candidate;)m.splice(y+1,1),v--}for(let y=u;y<h;y+=6){let x=r[y+2*d];for(let w=0;w<v;w++){let b=m[w];x>=b.candidate?Eg(y,r,b.rightCacheBounds):(Eg(y,r,b.leftCacheBounds),b.count++)}}for(let y=0;y<v;y++){let x=m[y],w=x.count,b=n-x.count,_=x.leftCacheBounds,A=x.rightCacheBounds,S=0;w!==0&&(S=Jd(_)/l);let C=0;b!==0&&(C=Jd(A)/l);let M=1+1.25*(S*w+C*b);M<c&&(a=d,c=M,o=x.candidate)}}else{for(let v=0;v<za;v++){let y=Co[v];y.count=0,y.candidate=p+f+v*f;let x=y.bounds;for(let w=0;w<3;w++)x[w]=1/0,x[w+3]=-1/0}for(let v=u;v<h;v+=6){let y=~~((r[v+2*d]-p)/f);y>=za&&(y=za-1);let x=Co[y];x.count++,Eg(v,r,x.bounds)}let m=Co[za-1];W4(m.bounds,m.rightCacheBounds);for(let v=za-2;v>=0;v--){let y=Co[v],x=Co[v+1];q4(y.bounds,x.rightCacheBounds,y.rightCacheBounds)}let g=0;for(let v=0;v<za-1;v++){let y=Co[v],x=y.count,w=y.bounds,b=Co[v+1].rightCacheBounds;x!==0&&(g===0?W4(w,Tg):q4(w,Tg,Tg)),g+=x;let _=0,A=0;g!==0&&(_=Jd(Tg)/l);let S=n-g;S!==0&&(A=Jd(b)/l);let C=1+1.25*(_*g+A*S);C<c&&(a=d,c=C,o=y.candidate)}}}}else console.warn(`MeshBVH: Invalid build strategy value ${s} used.`);return{axis:a,pos:o}}function Uoe(e,t,r,i){let n=0;for(let s=t,a=t+r;s<a;s++)n+=e[s*6+i*2];return n/r}function joe(e,t){let r=e.attributes.position,i=e.index.array,n=i.length/3,s=new Float32Array(n*6),a=r.normalized,o=r.array,l=r.offset||0,c=3;r.isInterleavedBufferAttribute&&(c=r.data.stride);let u=["getX","getY","getZ"];for(let h=0;h<n;h++){let d=h*3,p=h*6,f,m,g;a?(f=i[d+0],m=i[d+1],g=i[d+2]):(f=i[d+0]*c+l,m=i[d+1]*c+l,g=i[d+2]*c+l);for(let v=0;v<3;v++){let y,x,w;a?(y=r[u[v]](f),x=r[u[v]](m),w=r[u[v]](g)):(y=o[f+v],x=o[m+v],w=o[g+v]);let b=y;x<b&&(b=x),w<b&&(b=w);let _=y;x>_&&(_=x),w>_&&(_=w);let A=(_-b)/2,S=v*2;s[p+S+0]=b+A,s[p+S+1]=A+(Math.abs(b)+A)*Ooe,b<t[v]&&(t[v]=b),_>t[v+3]&&(t[v+3]=_)}}return s}function Voe(e,t){function r(v){d&&d(v/p)}function i(v,y,x,w=null,b=0){if(!f&&b>=l&&(f=!0,c&&(console.warn(`MeshBVH: Max depth of ${l} reached when generating BVH. Consider increasing maxDepth.`),console.warn(e))),x<=u||b>=l)return r(y+x),v.offset=y,v.count=x,v;let _=Foe(v.boundingData,w,a,y,x,h);if(_.axis===-1)return r(y+x),v.offset=y,v.count=x,v;let A=koe(o,a,y,x,_);if(A===y||A===y+x)r(y+x),v.offset=y,v.count=x;else{v.splitAxis=_.axis;let S=new Mg,C=y,M=A-y;v.left=S,S.boundingData=new Float32Array(6),Kx(a,C,M,S.boundingData,s),i(S,C,M,s,b+1);let T=new Mg,P=A,D=x-M;v.right=T,T.boundingData=new Float32Array(6),Kx(a,P,D,T.boundingData,s),i(T,P,D,s,b+1)}return v}Roe(e,t);let n=new Float32Array(6),s=new Float32Array(6),a=joe(e,n),o=e.index.array,l=t.maxDepth,c=t.verbose,u=t.maxLeafTris,h=t.strategy,d=t.onProgress,p=e.index.count/3,f=!1,m=[],g=Boe(e);if(g.length===1){let v=g[0],y=new Mg;y.boundingData=n,zoe(a,v.offset,v.count,s),i(y,v.offset,v.count,s),m.push(y)}else for(let v of g){let y=new Mg;y.boundingData=new Float32Array(6),Kx(a,v.offset,v.count,y.boundingData,s),i(y,v.offset,v.count,s),m.push(y)}return m}function Hoe(e,t){let r=Voe(e,t),i,n,s,a=[],o=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;for(let u=0;u<r.length;u++){let h=r[u],d=l(h),p=new o(32*d);i=new Float32Array(p),n=new Uint32Array(p),s=new Uint16Array(p),c(0,h),a.push(p)}return a;function l(u){return u.count?1:1+l(u.left)+l(u.right)}function c(u,h){let d=u/4,p=u/2,f=!!h.count,m=h.boundingData;for(let g=0;g<6;g++)i[d+g]=m[g];if(f){let g=h.offset,v=h.count;return n[d+6]=g,s[p+14]=v,s[p+15]=65535,u+32}else{let g=h.left,v=h.right,y=h.splitAxis,x;if(x=c(u+32,g),x/4>Math.pow(2,32))throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return n[d+6]=x/4,x=c(x,v),n[d+7]=y,x}}}var po=class{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(t,r){let i=1/0,n=-1/0;for(let s=0,a=t.length;s<a;s++){let o=t[s][r];i=o<i?o:i,n=o>n?o:n}this.min=i,this.max=n}setFromPoints(t,r){let i=1/0,n=-1/0;for(let s=0,a=r.length;s<a;s++){let o=r[s],l=t.dot(o);i=l<i?l:i,n=l>n?l:n}this.min=i,this.max=n}isSeparated(t){return this.min>t.max||t.min>this.max}};po.prototype.setFromBox=function(){let e=new E;return function(t,r){let i=r.min,n=r.max,s=1/0,a=-1/0;for(let o=0;o<=1;o++)for(let l=0;l<=1;l++)for(let c=0;c<=1;c++){e.x=i.x*o+n.x*(1-o),e.y=i.y*l+n.y*(1-l),e.z=i.z*c+n.z*(1-c);let u=t.dot(e);s=Math.min(u,s),a=Math.max(u,a)}this.min=s,this.max=a}}();var Goe=function(){let e=new E,t=new E,r=new E;return function(i,n,s){let a=i.start,o=e,l=n.start,c=t;r.subVectors(a,l),e.subVectors(i.end,i.start),t.subVectors(n.end,n.start);let u=r.dot(c),h=c.dot(o),d=c.dot(c),p=r.dot(o),f=o.dot(o)*d-h*h,m,g;f!==0?m=(u*h-p*d)/f:m=0,g=(u+m*h)/d,s.x=m,s.y=g}}(),pA=function(){let e=new W,t=new E,r=new E;return function(i,n,s,a){Goe(i,n,e);let o=e.x,l=e.y;if(o>=0&&o<=1&&l>=0&&l<=1){i.at(o,s),n.at(l,a);return}else if(o>=0&&o<=1){l<0?n.at(0,a):n.at(1,a),i.closestPointToPoint(a,!0,s);return}else if(l>=0&&l<=1){o<0?i.at(0,s):i.at(1,s),n.closestPointToPoint(s,!0,a);return}else{let c;o<0?c=i.start:c=i.end;let u;l<0?u=n.start:u=n.end;let h=t,d=r;if(i.closestPointToPoint(u,!0,t),n.closestPointToPoint(c,!0,r),h.distanceToSquared(u)<=d.distanceToSquared(c)){s.copy(h),a.copy(u);return}else{s.copy(c),a.copy(d);return}}}}(),Woe=function(){let e=new E,t=new E,r=new gn,i=new Zn;return function(n,s){let{radius:a,center:o}=n,{a:l,b:c,c:u}=s;if(i.start=l,i.end=c,i.closestPointToPoint(o,!0,e).distanceTo(o)<=a||(i.start=l,i.end=u,i.closestPointToPoint(o,!0,e).distanceTo(o)<=a)||(i.start=c,i.end=u,i.closestPointToPoint(o,!0,e).distanceTo(o)<=a))return!0;let h=s.getPlane(r);if(Math.abs(h.distanceToPoint(o))<=a){let d=h.projectPoint(o,t);if(s.containsPoint(d))return!0}return!1}}(),qoe=1e-15;function ph(e){return Math.abs(e)<qoe}var fo=class extends yi{constructor(...e){super(...e),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map(()=>new E),this.satBounds=new Array(4).fill().map(()=>new po),this.points=[this.a,this.b,this.c],this.sphere=new Mn,this.plane=new gn,this.needsUpdate=!0}intersectsSphere(e){return Woe(e,this)}update(){let e=this.a,t=this.b,r=this.c,i=this.points,n=this.satAxes,s=this.satBounds,a=n[0],o=s[0];this.getNormal(a),o.setFromPoints(a,i);let l=n[1],c=s[1];l.subVectors(e,t),c.setFromPoints(l,i);let u=n[2],h=s[2];u.subVectors(t,r),h.setFromPoints(u,i);let d=n[3],p=s[3];d.subVectors(r,e),p.setFromPoints(d,i),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(a,e),this.needsUpdate=!1}};fo.prototype.closestPointToSegment=function(){let e=new E,t=new E,r=new Zn;return function(i,n=null,s=null){let{start:a,end:o}=i,l=this.points,c,u=1/0;for(let h=0;h<3;h++){let d=(h+1)%3;r.start.copy(l[h]),r.end.copy(l[d]),pA(r,i,e,t),c=e.distanceToSquared(t),c<u&&(u=c,n&&n.copy(e),s&&s.copy(t))}return this.closestPointToPoint(a,e),c=a.distanceToSquared(e),c<u&&(u=c,n&&n.copy(e),s&&s.copy(a)),this.closestPointToPoint(o,e),c=o.distanceToSquared(e),c<u&&(u=c,n&&n.copy(e),s&&s.copy(o)),Math.sqrt(u)}}();fo.prototype.intersectsTriangle=function(){let e=new fo,t=new Array(3),r=new Array(3),i=new po,n=new po,s=new E,a=new E,o=new E,l=new E,c=new Zn,u=new Zn,h=new Zn;return function(d,p=null,f=!1){this.needsUpdate&&this.update(),d.isExtendedTriangle?d.needsUpdate&&d.update():(e.copy(d),e.update(),d=e);let m=this.plane,g=d.plane;if(Math.abs(m.normal.dot(g.normal))>1-1e-10){let v=this.satBounds,y=this.satAxes;r[0]=d.a,r[1]=d.b,r[2]=d.c;for(let b=0;b<4;b++){let _=v[b],A=y[b];if(i.setFromPoints(A,r),_.isSeparated(i))return!1}let x=d.satBounds,w=d.satAxes;t[0]=this.a,t[1]=this.b,t[2]=this.c;for(let b=0;b<4;b++){let _=x[b],A=w[b];if(i.setFromPoints(A,t),_.isSeparated(i))return!1}for(let b=0;b<4;b++){let _=y[b];for(let A=0;A<4;A++){let S=w[A];if(s.crossVectors(_,S),i.setFromPoints(s,t),n.setFromPoints(s,r),i.isSeparated(n))return!1}}return p&&(f||console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),p.start.set(0,0,0),p.end.set(0,0,0)),!0}else{let v=this.points,y=!1,x=0;for(let D=0;D<3;D++){let I=v[D],B=v[(D+1)%3];c.start.copy(I),c.end.copy(B),c.delta(a);let X=y?u.start:u.end,H=ph(g.distanceToPoint(I));if(ph(g.normal.dot(a))&&H){u.copy(c),x=2;break}if((g.intersectLine(c,X)||H)&&!ph(X.distanceTo(B))){if(x++,y)break;y=!0}}if(x===1&&d.containsPoint(u.end))return p&&(p.start.copy(u.end),p.end.copy(u.end)),!0;if(x!==2)return!1;let w=d.points,b=!1,_=0;for(let D=0;D<3;D++){let I=w[D],B=w[(D+1)%3];c.start.copy(I),c.end.copy(B),c.delta(o);let X=b?h.start:h.end,H=ph(m.distanceToPoint(I));if(ph(m.normal.dot(o))&&H){h.copy(c),_=2;break}if((m.intersectLine(c,X)||H)&&!ph(X.distanceTo(B))){if(_++,b)break;b=!0}}if(_===1&&this.containsPoint(h.end))return p&&(p.start.copy(h.end),p.end.copy(h.end)),!0;if(_!==2)return!1;if(u.delta(a),h.delta(o),a.dot(o)<0){let D=h.start;h.start=h.end,h.end=D}let A=u.start.dot(a),S=u.end.dot(a),C=h.start.dot(a),M=h.end.dot(a),T=S<C,P=A<M;return A!==M&&C!==S&&T===P?!1:(p&&(l.subVectors(u.start,h.start),l.dot(a)>0?p.start.copy(u.start):p.start.copy(h.start),l.subVectors(u.end,h.end),l.dot(a)<0?p.end.copy(u.end):p.end.copy(h.end)),!0)}}}();fo.prototype.distanceToPoint=function(){let e=new E;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}();fo.prototype.distanceToTriangle=function(){let e=new E,t=new E,r=["a","b","c"],i=new Zn,n=new Zn;return function(s,a=null,o=null){let l=a||o?i:null;if(this.intersectsTriangle(s,l))return(a||o)&&(a&&l.getCenter(a),o&&l.getCenter(o)),0;let c=1/0;for(let u=0;u<3;u++){let h,d=r[u],p=s[d];this.closestPointToPoint(p,e),h=p.distanceToSquared(e),h<c&&(c=h,a&&a.copy(e),o&&o.copy(p));let f=this[d];s.closestPointToPoint(f,e),h=f.distanceToSquared(e),h<c&&(c=h,a&&a.copy(f),o&&o.copy(e))}for(let u=0;u<3;u++){let h=r[u],d=r[(u+1)%3];i.set(this[h],this[d]);for(let p=0;p<3;p++){let f=r[p],m=r[(p+1)%3];n.set(s[f],s[m]),pA(i,n,e,t);let g=e.distanceToSquared(t);g<c&&(c=g,a&&a.copy(e),o&&o.copy(t))}}return Math.sqrt(c)}}();var va=class{constructor(e,t,r){this.isOrientedBox=!0,this.min=new E,this.max=new E,this.matrix=new _e,this.invMatrix=new _e,this.points=new Array(8).fill().map(()=>new E),this.satAxes=new Array(3).fill().map(()=>new E),this.satBounds=new Array(3).fill().map(()=>new po),this.alignedSatBounds=new Array(3).fill().map(()=>new po),this.needsUpdate=!1,e&&this.min.copy(e),t&&this.max.copy(t),r&&this.matrix.copy(r)}set(e,t,r){this.min.copy(e),this.max.copy(t),this.matrix.copy(r),this.needsUpdate=!0}copy(e){this.min.copy(e.min),this.max.copy(e.max),this.matrix.copy(e.matrix),this.needsUpdate=!0}};va.prototype.update=function(){return function(){let e=this.matrix,t=this.min,r=this.max,i=this.points;for(let l=0;l<=1;l++)for(let c=0;c<=1;c++)for(let u=0;u<=1;u++){let h=1*l|2*c|4*u,d=i[h];d.x=l?r.x:t.x,d.y=c?r.y:t.y,d.z=u?r.z:t.z,d.applyMatrix4(e)}let n=this.satBounds,s=this.satAxes,a=i[0];for(let l=0;l<3;l++){let c=s[l],u=n[l],h=1<<l,d=i[h];c.subVectors(a,d),u.setFromPoints(c,i)}let o=this.alignedSatBounds;o[0].setFromPointsField(i,"x"),o[1].setFromPointsField(i,"y"),o[2].setFromPointsField(i,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1}}();va.prototype.intersectsBox=function(){let e=new po;return function(t){this.needsUpdate&&this.update();let r=t.min,i=t.max,n=this.satBounds,s=this.satAxes,a=this.alignedSatBounds;if(e.min=r.x,e.max=i.x,a[0].isSeparated(e)||(e.min=r.y,e.max=i.y,a[1].isSeparated(e))||(e.min=r.z,e.max=i.z,a[2].isSeparated(e)))return!1;for(let o=0;o<3;o++){let l=s[o],c=n[o];if(e.setFromBox(l,t),c.isSeparated(e))return!1}return!0}}();va.prototype.intersectsTriangle=function(){let e=new fo,t=new Array(3),r=new po,i=new po,n=new E;return function(s){this.needsUpdate&&this.update(),s.isExtendedTriangle?s.needsUpdate&&s.update():(e.copy(s),e.update(),s=e);let a=this.satBounds,o=this.satAxes;t[0]=s.a,t[1]=s.b,t[2]=s.c;for(let h=0;h<3;h++){let d=a[h],p=o[h];if(r.setFromPoints(p,t),d.isSeparated(r))return!1}let l=s.satBounds,c=s.satAxes,u=this.points;for(let h=0;h<3;h++){let d=l[h],p=c[h];if(r.setFromPoints(p,u),d.isSeparated(r))return!1}for(let h=0;h<3;h++){let d=o[h];for(let p=0;p<4;p++){let f=c[p];if(n.crossVectors(d,f),r.setFromPoints(n,t),i.setFromPoints(n,u),r.isSeparated(i))return!1}}return!0}}();va.prototype.closestPointToPoint=function(){return function(e,t){return this.needsUpdate&&this.update(),t.copy(e).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),t}}();va.prototype.distanceToPoint=function(){let e=new E;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}();va.prototype.distanceToBox=function(){let e=["x","y","z"],t=new Array(12).fill().map(()=>new Zn),r=new Array(12).fill().map(()=>new Zn),i=new E,n=new E;return function(s,a=0,o=null,l=null){if(this.needsUpdate&&this.update(),this.intersectsBox(s))return(o||l)&&(s.getCenter(n),this.closestPointToPoint(n,i),s.closestPointToPoint(i,n),o&&o.copy(i),l&&l.copy(n)),0;let c=a*a,u=s.min,h=s.max,d=this.points,p=1/0;for(let m=0;m<8;m++){let g=d[m];n.copy(g).clamp(u,h);let v=g.distanceToSquared(n);if(v<p&&(p=v,o&&o.copy(g),l&&l.copy(n),v<c))return Math.sqrt(v)}let f=0;for(let m=0;m<3;m++)for(let g=0;g<=1;g++)for(let v=0;v<=1;v++){let y=(m+1)%3,x=(m+2)%3,w=g<<y|v<<x,b=1<<m|g<<y|v<<x,_=d[w],A=d[b];t[f].set(_,A);let S=e[m],C=e[y],M=e[x],T=r[f],P=T.start,D=T.end;P[S]=u[S],P[C]=g?u[C]:h[C],P[M]=v?u[M]:h[C],D[S]=h[S],D[C]=g?u[C]:h[C],D[M]=v?u[M]:h[C],f++}for(let m=0;m<=1;m++)for(let g=0;g<=1;g++)for(let v=0;v<=1;v++){n.x=m?h.x:u.x,n.y=g?h.y:u.y,n.z=v?h.z:u.z,this.closestPointToPoint(n,i);let y=n.distanceToSquared(i);if(y<p&&(p=y,o&&o.copy(i),l&&l.copy(n),y<c))return Math.sqrt(y)}for(let m=0;m<12;m++){let g=t[m];for(let v=0;v<12;v++){let y=r[v];pA(g,y,i,n);let x=i.distanceToSquared(n);if(x<p&&(p=x,o&&o.copy(i),l&&l.copy(n),x<c))return Math.sqrt(x)}}return Math.sqrt(p)}}();var fh=new E,mh=new E,gh=new E,Pg=new W,Dg=new W,Lg=new W,X4=new E,Y4=new E,Q4=new E,Ig=new E;function Xoe(e,t,r,i,n,s){let a;return s===$r?a=e.intersectTriangle(i,r,t,!0,n):a=e.intersectTriangle(t,r,i,s!==yn,n),a===null?null:{distance:e.origin.distanceTo(n),point:n.clone()}}function Yoe(e,t,r,i,n,s,a,o,l){fh.fromBufferAttribute(t,s),mh.fromBufferAttribute(t,a),gh.fromBufferAttribute(t,o);let c=Xoe(e,fh,mh,gh,Ig,l);if(c){i&&(Pg.fromBufferAttribute(i,s),Dg.fromBufferAttribute(i,a),Lg.fromBufferAttribute(i,o),c.uv=yi.getInterpolation(Ig,fh,mh,gh,Pg,Dg,Lg,new W)),n&&(Pg.fromBufferAttribute(n,s),Dg.fromBufferAttribute(n,a),Lg.fromBufferAttribute(n,o),c.uv1=yi.getInterpolation(Ig,fh,mh,gh,Pg,Dg,Lg,new W)),r&&(X4.fromBufferAttribute(r,s),Y4.fromBufferAttribute(r,a),Q4.fromBufferAttribute(r,o),c.normal=yi.getInterpolation(Ig,fh,mh,gh,X4,Y4,Q4,new E),c.normal.dot(e.direction)>0&&c.normal.multiplyScalar(-1));let u={a:s,b:a,c:o,normal:new E,materialIndex:0};yi.getNormal(fh,mh,gh,u.normal),c.face=u,c.faceIndex=s}return c}function uz(e,t,r,i,n){let s=i*3,a=e.index.getX(s),o=e.index.getX(s+1),l=e.index.getX(s+2),{position:c,normal:u,uv:h,uv1:d}=e.attributes,p=Yoe(r,c,u,h,d,a,o,l,t);return p?(p.faceIndex=i,n&&n.push(p),p):null}function Qoe(e,t,r,i,n,s){for(let a=i,o=i+n;a<o;a++)uz(e,t,r,a,s)}function Koe(e,t,r,i,n){let s=1/0,a=null;for(let o=i,l=i+n;o<l;o++){let c=uz(e,t,r,o);c&&c.distance<s&&(a=c,s=c.distance)}return a}function $s(e,t,r,i){let n=e.a,s=e.b,a=e.c,o=t,l=t+1,c=t+2;r&&(o=r.getX(t),l=r.getX(t+1),c=r.getX(t+2)),n.x=i.getX(o),n.y=i.getY(o),n.z=i.getZ(o),s.x=i.getX(l),s.y=i.getY(l),s.z=i.getZ(l),a.x=i.getX(c),a.y=i.getY(c),a.z=i.getZ(c)}function K4(e,t,r,i,n,s,a){let o=r.index,l=r.attributes.position;for(let c=e,u=t+e;c<u;c++)if($s(a,c*3,o,l),a.needsUpdate=!0,i(a,c,n,s))return!0;return!1}var dz=class{constructor(e){this._getNewPrimitive=e,this._primitives=[]}getPrimitive(){let e=this._primitives;return e.length===0?this._getNewPrimitive():e.pop()}releasePrimitive(e){this._primitives.push(e)}};function Wo(e,t){return t[e+15]===65535}function _u(e,t){return t[e+6]}function qf(e,t){return t[e+14]}function Xf(e){return e+8}function Yf(e,t){return t[e+6]}function Zoe(e,t){return t[e+7]}var su=new Ar,J0=new E,$oe=["x","y","z"];function c_(e,t,r,i,n){let s=e*2,a=Sd,o=gl,l=vl;if(Wo(s,o)){let c=_u(e,l),u=qf(s,o);Qoe(t,r,i,c,u,n)}else{let c=Xf(e);ey(c,a,i,J0)&&c_(c,t,r,i,n);let u=Yf(e,l);ey(u,a,i,J0)&&c_(u,t,r,i,n)}}function h_(e,t,r,i){let n=e*2,s=Sd,a=gl,o=vl;if(Wo(n,a)){let l=_u(e,o),c=qf(n,a);return Koe(t,r,i,l,c)}else{let l=Zoe(e,o),c=$oe[l],u=i.direction[c]>=0,h,d;u?(h=Xf(e),d=Yf(e,o)):(h=Yf(e,o),d=Xf(e));let p=ey(h,s,i,J0)?h_(h,t,r,i):null;if(p){let m=p.point[c];if(u?m<=s[d+l]:m>=s[d+l+3])return p}let f=ey(d,s,i,J0)?h_(d,t,r,i):null;return p&&f?p.distance<=f.distance?p:f:p||f||null}}var Joe=function(){let e,t,r=[],i=new dz(()=>new Ar);return function(...s){e=i.getPrimitive(),t=i.getPrimitive(),r.push(e,t);let a=n(...s);i.releasePrimitive(e),i.releasePrimitive(t),r.pop(),r.pop();let o=r.length;return o>0&&(t=r[o-1],e=r[o-2]),a};function n(s,a,o,l,c=null,u=0,h=0){function d(y){let x=y*2,w=gl,b=vl;for(;!Wo(x,w);)y=Xf(y),x=y*2;return _u(y,b)}function p(y){let x=y*2,w=gl,b=vl;for(;!Wo(x,w);)y=Yf(y,b),x=y*2;return _u(y,b)+qf(x,w)}let f=s*2,m=Sd,g=gl,v=vl;if(Wo(f,g)){let y=_u(s,v),x=qf(f,g);return ia(s,m,e),l(y,x,!1,h,u+s,e)}else{let y=Xf(s),x=Yf(s,v),w=y,b=x,_,A,S,C;if(c&&(S=e,C=t,ia(w,m,S),ia(b,m,C),_=c(S),A=c(C),A<_)){w=x,b=y;let X=_;_=A,A=X,S=C}S||(S=e,ia(w,m,S));let M=Wo(w*2,g),T=o(S,M,_,h+1,u+w),P;if(T===2){let X=d(w),H=p(w)-X;P=l(X,H,!0,h+1,u+w,S)}else P=T&&n(w,a,o,l,c,u,h+1);if(P)return!0;C=t,ia(b,m,C);let D=Wo(b*2,g),I=o(C,D,A,h+1,u+b),B;if(I===2){let X=d(b),H=p(b)-X;B=l(X,H,!0,h+1,u+b,C)}else B=I&&n(b,a,o,l,c,u,h+1);return!!B}}}(),ele=function(){let e=new fo,t=new fo,r=new _e,i=new va,n=new va;return function s(a,o,l,c,u=null){let h=a*2,d=Sd,p=gl,f=vl;if(u===null&&(l.boundingBox||l.computeBoundingBox(),i.set(l.boundingBox.min,l.boundingBox.max,c),u=i),Wo(h,p)){let m=o,g=m.index,v=m.attributes.position,y=l.index,x=l.attributes.position,w=_u(a,f),b=qf(h,p);if(r.copy(c).invert(),l.boundsTree)return ia(a,d,n),n.matrix.copy(r),n.needsUpdate=!0,l.boundsTree.shapecast({intersectsBounds:_=>n.intersectsBox(_),intersectsTriangle:_=>{_.a.applyMatrix4(c),_.b.applyMatrix4(c),_.c.applyMatrix4(c),_.needsUpdate=!0;for(let A=w*3,S=(b+w)*3;A<S;A+=3)if($s(t,A,g,v),t.needsUpdate=!0,_.intersectsTriangle(t))return!0;return!1}});for(let _=w*3,A=b+w*3;_<A;_+=3){$s(e,_,g,v),e.a.applyMatrix4(r),e.b.applyMatrix4(r),e.c.applyMatrix4(r),e.needsUpdate=!0;for(let S=0,C=y.count;S<C;S+=3)if($s(t,S,y,x),t.needsUpdate=!0,e.intersectsTriangle(t))return!0}}else{let m=a+8,g=f[a+6];return ia(m,d,su),!!(u.intersectsBox(su)&&s(m,o,l,c,u)||(ia(g,d,su),u.intersectsBox(su)&&s(g,o,l,c,u)))}}}();function ey(e,t,r,i){return ia(e,t,su),r.intersectBox(su,i)}var u_=[],Iv,Sd,gl,vl;function Tp(e){Iv&&u_.push(Iv),Iv=e,Sd=new Float32Array(e),gl=new Uint16Array(e),vl=new Uint32Array(e)}function Og(){Iv=null,Sd=null,gl=null,vl=null,u_.length&&Tp(u_.pop())}var Zx=Symbol("skip tree generation"),$x=new Ar,Jx=new Ar,vh=new _e,Vl=new va,ep=new va,tp=new E,Rg=new E,tle=new E,rle=new E,ile=new E,Z4=new Ar,Ns=new dz(()=>new fo),rf=class{static serialize(e,t={}){if(t.isBufferGeometry)return console.warn("MeshBVH.serialize: The arguments for the function have changed. See documentation for new signature."),rf.serialize(arguments[0],{cloneBuffers:arguments[2]===void 0?!0:arguments[2]});t={cloneBuffers:!0,...t};let r=e.geometry,i=e._roots,n=r.getIndex(),s;return t.cloneBuffers?s={roots:i.map(a=>a.slice()),index:n.array.slice()}:s={roots:i,index:n.array},s}static deserialize(e,t,r={}){if(typeof r=="boolean")return console.warn("MeshBVH.deserialize: The arguments for the function have changed. See documentation for new signature."),rf.deserialize(arguments[0],arguments[1],{setIndex:arguments[2]===void 0?!0:arguments[2]});r={setIndex:!0,...r};let{index:i,roots:n}=e,s=new rf(t,{...r,[Zx]:!0});if(s._roots=n,r.setIndex){let a=t.getIndex();if(a===null){let o=new nt(e.index,1,!1);t.setIndex(o)}else a.array!==i&&(a.array.set(i),a.needsUpdate=!0)}return s}constructor(e,t={}){if(e.isBufferGeometry){if(e.index&&e.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.")}else throw new Error("MeshBVH: Only BufferGeometries are supported.");if(t=Object.assign({strategy:0,maxDepth:40,maxLeafTris:10,verbose:!0,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,[Zx]:!1},t),t.useSharedArrayBuffer&&typeof SharedArrayBuffer>"u")throw new Error("MeshBVH: SharedArrayBuffer is not available.");this._roots=null,t[Zx]||(this._roots=Hoe(e,t),!e.boundingBox&&t.setBoundingBox&&(e.boundingBox=this.getBoundingBox(new Ar))),this.geometry=e}refit(e=null){e&&Array.isArray(e)&&(e=new Set(e));let t=this.geometry,r=t.index.array,i=t.attributes.position,n,s,a,o,l=0,c=this._roots;for(let h=0,d=c.length;h<d;h++)n=c[h],s=new Uint32Array(n),a=new Uint16Array(n),o=new Float32Array(n),u(0,l),l+=n.byteLength;function u(h,d,p=!1){let f=h*2;if(a[f+15]===65535){let m=s[h+6],g=a[f+14],v=1/0,y=1/0,x=1/0,w=-1/0,b=-1/0,_=-1/0;for(let A=3*m,S=3*(m+g);A<S;A++){let C=r[A],M=i.getX(C),T=i.getY(C),P=i.getZ(C);M<v&&(v=M),M>w&&(w=M),T<y&&(y=T),T>b&&(b=T),P<x&&(x=P),P>_&&(_=P)}return o[h+0]!==v||o[h+1]!==y||o[h+2]!==x||o[h+3]!==w||o[h+4]!==b||o[h+5]!==_?(o[h+0]=v,o[h+1]=y,o[h+2]=x,o[h+3]=w,o[h+4]=b,o[h+5]=_,!0):!1}else{let m=h+8,g=s[h+6],v=m+d,y=g+d,x=p,w=!1,b=!1;e?x||(w=e.has(v),b=e.has(y),x=!w&&!b):(w=!0,b=!0);let _=x||w,A=x||b,S=!1;_&&(S=u(m,d,x));let C=!1;A&&(C=u(g,d,x));let M=S||C;if(M)for(let T=0;T<3;T++){let P=m+T,D=g+T,I=o[P],B=o[P+3],X=o[D],H=o[D+3];o[h+T]=I<X?I:X,o[h+T+3]=B>H?B:H}return M}}}traverse(e,t=0){let r=this._roots[t],i=new Uint32Array(r),n=new Uint16Array(r);s(0);function s(a,o=0){let l=a*2,c=n[l+15]===65535;if(c){let u=i[a+6],h=n[l+14];e(o,c,new Float32Array(r,a*4,6),u,h)}else{let u=a+8,h=i[a+6],d=i[a+7];e(o,c,new Float32Array(r,a*4,6),d)||(s(u,o+1),s(h,o+1))}}}raycast(e,t=Ds){let r=this._roots,i=this.geometry,n=[],s=t.isMaterial,a=Array.isArray(t),o=i.groups,l=s?t.side:t;for(let c=0,u=r.length;c<u;c++){let h=a?t[o[c].materialIndex].side:l,d=n.length;if(Tp(r[c]),c_(0,i,h,e,n),Og(),a){let p=o[c].materialIndex;for(let f=d,m=n.length;f<m;f++)n[f].face.materialIndex=p}}return n}raycastFirst(e,t=Ds){let r=this._roots,i=this.geometry,n=t.isMaterial,s=Array.isArray(t),a=null,o=i.groups,l=n?t.side:t;for(let c=0,u=r.length;c<u;c++){let h=s?t[o[c].materialIndex].side:l;Tp(r[c]);let d=h_(0,i,h,e);Og(),d!=null&&(a==null||d.distance<a.distance)&&(a=d,s&&(d.face.materialIndex=o[c].materialIndex))}return a}intersectsGeometry(e,t){let r=this.geometry,i=!1;for(let n of this._roots)if(Tp(n),i=ele(0,r,e,t),Og(),i)break;return i}shapecast(e,t,r){let i=this.geometry;if(e instanceof Function){if(t){let h=t;t=(d,p,f,m)=>{let g=p*3;return h(d,g,g+1,g+2,f,m)}}e={boundsTraverseOrder:r,intersectsBounds:e,intersectsTriangle:t,intersectsRange:null},console.warn("MeshBVH: Shapecast function signature has changed and now takes an object of callbacks as a second argument. See docs for new signature.")}let n=Ns.getPrimitive(),{boundsTraverseOrder:s,intersectsBounds:a,intersectsRange:o,intersectsTriangle:l}=e;if(o&&l){let h=o;o=(d,p,f,m,g)=>h(d,p,f,m,g)?!0:K4(d,p,i,l,f,m,n)}else o||(l?o=(h,d,p,f)=>K4(h,d,i,l,p,f,n):o=(h,d,p)=>p);let c=!1,u=0;for(let h of this._roots){if(Tp(h),c=Joe(0,i,a,o,s,u),Og(),c)break;u+=h.byteLength}return Ns.releasePrimitive(n),c}bvhcast(e,t,r){let{intersectsRanges:i,intersectsTriangles:n}=r,s=this.geometry.index,a=this.geometry.attributes.position,o=e.geometry.index,l=e.geometry.attributes.position;vh.copy(t).invert();let c=Ns.getPrimitive(),u=Ns.getPrimitive();if(n){let d=function(p,f,m,g,v,y,x,w){for(let b=m,_=m+g;b<_;b++){$s(u,b*3,o,l),u.a.applyMatrix4(t),u.b.applyMatrix4(t),u.c.applyMatrix4(t),u.needsUpdate=!0;for(let A=p,S=p+f;A<S;A++)if($s(c,A*3,s,a),c.needsUpdate=!0,n(c,u,A,b,v,y,x,w))return!0}return!1};if(i){let p=i;i=function(f,m,g,v,y,x,w,b){return p(f,m,g,v,y,x,w,b)?!0:d(f,m,g,v,y,x,w,b)}}else i=d}e.getBoundingBox(Jx),Jx.applyMatrix4(t);let h=this.shapecast({intersectsBounds:d=>Jx.intersectsBox(d),intersectsRange:(d,p,f,m,g,v)=>($x.copy(v),$x.applyMatrix4(vh),e.shapecast({intersectsBounds:y=>$x.intersectsBox(y),intersectsRange:(y,x,w,b,_)=>i(d,p,y,x,m,g,b,_)}))});return Ns.releasePrimitive(c),Ns.releasePrimitive(u),h}intersectsBox(e,t){return Vl.set(e.min,e.max,t),Vl.needsUpdate=!0,this.shapecast({intersectsBounds:r=>Vl.intersectsBox(r),intersectsTriangle:r=>Vl.intersectsTriangle(r)})}intersectsSphere(e){return this.shapecast({intersectsBounds:t=>e.intersectsBox(t),intersectsTriangle:t=>t.intersectsSphere(e)})}closestPointToGeometry(e,t,r={},i={},n=0,s=1/0){e.boundingBox||e.computeBoundingBox(),Vl.set(e.boundingBox.min,e.boundingBox.max,t),Vl.needsUpdate=!0;let a=this.geometry,o=a.attributes.position,l=a.index,c=e.attributes.position,u=e.index,h=Ns.getPrimitive(),d=Ns.getPrimitive(),p=Rg,f=tle,m=null,g=null;i&&(m=rle,g=ile);let v=1/0,y=null,x=null;return vh.copy(t).invert(),ep.matrix.copy(vh),this.shapecast({boundsTraverseOrder:w=>Vl.distanceToBox(w),intersectsBounds:(w,b,_)=>_<v&&_<s?(b&&(ep.min.copy(w.min),ep.max.copy(w.max),ep.needsUpdate=!0),!0):!1,intersectsRange:(w,b)=>{if(e.boundsTree)return e.boundsTree.shapecast({boundsTraverseOrder:_=>ep.distanceToBox(_),intersectsBounds:(_,A,S)=>S<v&&S<s,intersectsRange:(_,A)=>{for(let S=_*3,C=(_+A)*3;S<C;S+=3){$s(d,S,u,c),d.a.applyMatrix4(t),d.b.applyMatrix4(t),d.c.applyMatrix4(t),d.needsUpdate=!0;for(let M=w*3,T=(w+b)*3;M<T;M+=3){$s(h,M,l,o),h.needsUpdate=!0;let P=h.distanceToTriangle(d,p,m);if(P<v&&(f.copy(p),g&&g.copy(m),v=P,y=M/3,x=S/3),P<n)return!0}}}});{let _=u?u.count:c.count;for(let A=0,S=_;A<S;A+=3){$s(d,A,u,c),d.a.applyMatrix4(t),d.b.applyMatrix4(t),d.c.applyMatrix4(t),d.needsUpdate=!0;for(let C=w*3,M=(w+b)*3;C<M;C+=3){$s(h,C,l,o),h.needsUpdate=!0;let T=h.distanceToTriangle(d,p,m);if(T<v&&(f.copy(p),g&&g.copy(m),v=T,y=C/3,x=A/3),T<n)return!0}}}}}),Ns.releasePrimitive(h),Ns.releasePrimitive(d),v===1/0?null:(r.point?r.point.copy(f):r.point=f.clone(),r.distance=v,r.faceIndex=y,i&&(i.point?i.point.copy(g):i.point=g.clone(),i.point.applyMatrix4(vh),f.applyMatrix4(vh),i.distance=f.sub(i.point).length(),i.faceIndex=x),r)}closestPointToPoint(e,t={},r=0,i=1/0){let n=r*r,s=i*i,a=1/0,o=null;if(this.shapecast({boundsTraverseOrder:c=>(tp.copy(e).clamp(c.min,c.max),tp.distanceToSquared(e)),intersectsBounds:(c,u,h)=>h<a&&h<s,intersectsTriangle:(c,u)=>{c.closestPointToPoint(e,tp);let h=e.distanceToSquared(tp);return h<a&&(Rg.copy(tp),a=h,o=u),h<n}}),a===1/0)return null;let l=Math.sqrt(a);return t.point?t.point.copy(Rg):t.point=Rg.clone(),t.distance=l,t.faceIndex=o,t}getBoundingBox(e){return e.makeEmpty(),this._roots.forEach(t=>{ia(0,new Float32Array(t),Z4),e.union(Z4)}),e}},rp=ld(bG()),nle=.5*(Math.sqrt(3)-1),ip=(3-Math.sqrt(3))/6,sle=1/3,Fs=1/6,nf=e=>Math.floor(e)|0,$4=new Float64Array([1,1,-1,1,1,-1,-1,-1,1,0,-1,0,1,0,-1,0,0,1,0,-1,0,1,0,-1]),ew=new Float64Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]);function tw(e=Math.random){let t=pz(e),r=new Float64Array(t).map(n=>$4[n%12*2]),i=new Float64Array(t).map(n=>$4[n%12*2+1]);return function(n,s){let a=0,o=0,l=0,c=(n+s)*nle,u=nf(n+c),h=nf(s+c),d=(u+h)*ip,p=u-d,f=h-d,m=n-p,g=s-f,v,y;m>g?(v=1,y=0):(v=0,y=1);let x=m-v+ip,w=g-y+ip,b=m-1+2*ip,_=g-1+2*ip,A=u&255,S=h&255,C=.5-m*m-g*g;if(C>=0){let P=A+t[S],D=r[P],I=i[P];C*=C,a=C*C*(D*m+I*g)}let M=.5-x*x-w*w;if(M>=0){let P=A+v+t[S+y],D=r[P],I=i[P];M*=M,o=M*M*(D*x+I*w)}let T=.5-b*b-_*_;if(T>=0){let P=A+1+t[S+1],D=r[P],I=i[P];T*=T,l=T*T*(D*b+I*_)}return 70*(a+o+l)}}function ale(e=Math.random){let t=pz(e),r=new Float64Array(t).map(s=>ew[s%12*3]),i=new Float64Array(t).map(s=>ew[s%12*3+1]),n=new Float64Array(t).map(s=>ew[s%12*3+2]);return function(s,a,o){let l,c,u,h,d=(s+a+o)*sle,p=nf(s+d),f=nf(a+d),m=nf(o+d),g=(p+f+m)*Fs,v=p-g,y=f-g,x=m-g,w=s-v,b=a-y,_=o-x,A,S,C,M,T,P;w>=b?b>=_?(A=1,S=0,C=0,M=1,T=1,P=0):w>=_?(A=1,S=0,C=0,M=1,T=0,P=1):(A=0,S=0,C=1,M=1,T=0,P=1):b<_?(A=0,S=0,C=1,M=0,T=1,P=1):w<_?(A=0,S=1,C=0,M=0,T=1,P=1):(A=0,S=1,C=0,M=1,T=1,P=0);let D=w-A+Fs,I=b-S+Fs,B=_-C+Fs,X=w-M+2*Fs,H=b-T+2*Fs,R=_-P+2*Fs,q=w-1+3*Fs,F=b-1+3*Fs,N=_-1+3*Fs,j=p&255,K=f&255,U=m&255,Y=.6-w*w-b*b-_*_;if(Y<0)l=0;else{let ee=j+t[K+t[U]];Y*=Y,l=Y*Y*(r[ee]*w+i[ee]*b+n[ee]*_)}let V=.6-D*D-I*I-B*B;if(V<0)c=0;else{let ee=j+A+t[K+S+t[U+C]];V*=V,c=V*V*(r[ee]*D+i[ee]*I+n[ee]*B)}let ie=.6-X*X-H*H-R*R;if(ie<0)u=0;else{let ee=j+M+t[K+T+t[U+P]];ie*=ie,u=ie*ie*(r[ee]*X+i[ee]*H+n[ee]*R)}let J=.6-q*q-F*F-N*N;if(J<0)h=0;else{let ee=j+1+t[K+1+t[U+1]];J*=J,h=J*J*(r[ee]*q+i[ee]*F+n[ee]*N)}return 32*(l+c+u+h)}}function pz(e){let t=new Uint8Array(512);for(let r=0;r<512/2;r++)t[r]=r;for(let r=0;r<512/2-1;r++){let i=r+~~(e()*(256-r)),n=t[r];t[r]=t[i],t[i]=n}for(let r=256;r<512;r++)t[r]=t[r-256];return t}var cs=new yi,ole=class{constructor(e){this.weightAttribute=null;let t=e.geometry;if(!t.isBufferGeometry||t.attributes.position.itemSize!==3)throw new Error("THREE.MeshSurfaceSampler: Requires BufferGeometry triangle mesh.");t.index&&(t=t.toNonIndexed()),this.geometry=t,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.distribution=null}build(){let e=this.positionAttribute,t=new Float32Array(e.count/3);for(let i=0;i<e.count;i+=3){let n=1;cs.a.fromBufferAttribute(e,i),cs.b.fromBufferAttribute(e,i+1),cs.c.fromBufferAttribute(e,i+2),n*=cs.getArea(),t[i/3]=n}this.distribution=new Float32Array(e.count/3);let r=0;for(let i=0;i<t.length;i++)r+=t[i],this.distribution[i]=r;return this}setRandomGenerator(e){return this.randomFunction=e,this}sample(e,t){if(this.distribution){let r=this.distribution[this.distribution.length-1],i=this.binarySearch(this.randomFunction()*r);return this.sampleFace(i,e,t)}}binarySearch(e){if(!this.distribution)return 0;let t=this.distribution,r=0,i=t.length-1,n=-1;for(;r<=i;){let s=Math.ceil((r+i)/2);if(s===0||t[s-1]<=e&&t[s]>e){n=s;break}else e<t[s]?i=s-1:r=s+1}return n}sampleFace(e,t,r){let i=this.randomFunction(),n=this.randomFunction();return i+n>1&&(i=1-i,n=1-n),cs.a.fromBufferAttribute(this.positionAttribute,e*3),cs.b.fromBufferAttribute(this.positionAttribute,e*3+1),cs.c.fromBufferAttribute(this.positionAttribute,e*3+2),t.set(0,0,0).addScaledVector(cs.a,i).addScaledVector(cs.b,n).addScaledVector(cs.c,1-(i+n)),cs.getNormal(r),this}},lle=ld(tR()),cle=new _e,hle=new _e,ule=new _e,Qf;(e=>{function t(r){return r&&r.__isSPEObject}e.is=t})(Qf||(Qf={}));var fA=e=>class extends e{constructor(){super(...arguments),this.previousModelViewMatrix=new _e,this.copyPreviousMatrix=!0,this.hiddenMatrix=new _e,this.matrixWorldRigid=new _e,this.shearScale=new _e,this.shearScaleInv=new _e}get __isSPEObject(){return!0}isDescendantOf(t){t instanceof Vt&&(t=t.uuid);let r=this;for(;r.parent;){if(r.parent.uuid===t)return!0;r=r.parent}return!1}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,t=!0);for(let r of this.children)r.updateMatrixWorld(t)}updateWorldMatrix(t,r){let i=this.parent;if(t&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),r)for(let n of this.children)n.updateWorldMatrix(!1,!0)}traverseChildren(t,r=0){for(let i of this.children)Qf.is(i)&&i.traverseObject(t,r+1)}traverseObject(t,r=0){if(t(this,r)!==!0)for(let i of this.children)Qf.is(i)&&i.traverseObject(t,r+1)}updateMatrixWorldSVD(){let t=this.matrixWorld.elements,r=[[t[0],t[4],t[8]],[t[1],t[5],t[9]],[t[2],t[6],t[10]]],{u:i,v:n,q:s}=(0,lle.SVD)(r),a=cle.set(i[0][0],i[0][1],i[0][2],0,i[1][0],i[1][1],i[1][2],0,i[2][0],i[2][1],i[2][2],0,0,0,0,1),o=hle.set(n[0][0],n[0][1],n[0][2],0,n[1][0],n[1][1],n[1][2],0,n[2][0],n[2][1],n[2][2],0,0,0,0,1),l=ule.copy(o).transpose();this.shearScale.makeScale(s[0],s[1],s[2]).multiply(l).premultiply(o),this.shearScaleInv.copy(this.shearScale).invert(),this.matrixWorldRigid.multiplyMatrices(a,l).copyPosition(this.matrixWorld),s.every(c=>Math.abs(s[0]-c)<.01)?this.hasNonUniformScale=!1:this.hasNonUniformScale=!0}attach(t,r){this.updateWorldMatrix(!0,!1);let i=new _e().copy(this.matrixWorld).invert();return t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),i.multiply(t.parent.matrixWorld)),"hiddenMatrix"in t&&t.hiddenMatrix instanceof _e?t.hiddenMatrix.premultiply(i):t.applyMatrix4(i),t.updateWorldMatrix(!1,!1),this.add(t),r!==void 0&&(this.children.pop(),this.children.splice(r,0,t)),this}copy(t,r=!1){return super.copy(t,r),this.hasNonUniformScale=t.hasNonUniformScale,this}onAfterRender(t,r,i,n,s,a){this.copyPreviousMatrix&&this.previousModelViewMatrix.copy(this.modelViewMatrix)}},dle=class extends fA(Vt){},ple=e=>e.type==="Mesh",xi=class extends dle{constructor(e){super(),this.object=e,this.matrixAutoUpdate=!1,this.hasNonUniformScale=e.hasNonUniformScale}raycast(e,t){}expand(){let e=0,t=this.object.entityChildren(e);for(;t;){let r=this.children[e];(r==null?void 0:r.object)!==t&&(r&&this.remove(r),r=new xi(t),this.add(r),this.children.splice(e,0,this.children.pop()),r.matrixWorldNeedsUpdate=!0,r.matrixAutoUpdate=!1,r.matrix=t.matrix,r.hiddenMatrix=t.hiddenMatrix),r.expand(),e+=1,t=this.object.entityChildren(e)}for(;this.children.length>e;)this.remove(this.children[e])}get visible(){var e;return this.playModeVisible!==void 0?this.playModeVisible:this.object.visible||this.object.dataPatched.visible&&((e=this.object.dataPatched.cloner)==null?void 0:e.hideBase)===!0}set visible(e){}get castShadow(){return this.object.castShadow}set castShadow(e){}get receiveShadow(){return this.object.receiveShadow}set receiveShadow(e){}get isMesh(){return ple(this.object)}get isLight(){return this.object.isLight}get layers(){return this.object.layers}set layers(e){}get isCamera(){return!1}get geometry(){if(this.object.geometry)return this.object.geometry}get material(){if(this.object.material)return this.object.material}},rc=new E,ic=new E,Su=new _e,fz=[new E(-1,1,1),new E(-1,-1,1),new E(1,-1,1),new E(1,1,1),new E(-1,1,-1),new E(-1,-1,-1),new E(1,-1,-1),new E(1,1,-1)],fle=[[0,3],[1,2],[5,6],[4,7],[0,1],[3,2],[7,6],[4,5],[0,4],[1,5],[2,6],[3,7]],mle=[[0,2],[7,5],[4,1],[3,6],[4,3],[1,6]],J4=(e,t,r)=>{e.updateEntityBoxSize(rc,ic),Su.copy(t).multiply(e.matrixWorld),ic.x===0&&ic.y===0&&ic.z===0?r.push(new E(rc.x,rc.y,rc.z).applyMatrix4(Su)):fz.forEach(i=>{r.push(i.clone().multiply(ic).add(rc).applyMatrix4(Su))})},eD=class extends Ar{constructor(){super(...arguments),this.matrix=new _e,this.vertices=[],this.faces=[],this.edges=[],this.centerEdges=[]}copy(e){return super.copy(e),this.matrix.copy(e.matrix),this.vertices=e.vertices.map(t=>t.clone()),this.faces=e.faces.map(t=>t.clone()),this.edges=e.edges.map(t=>t.clone()),this.centerEdges=e.centerEdges.map(t=>t.clone()),this}setFromObjectSize(e,t=!1){e.updateWorldMatrix(!1,t),this.makeEmpty(),this.matrix.copy(e.matrixWorld);let r=new _e().copy(e.matrixWorld).invert();return this.expandByObjectSize(e,r,t)}expandByObjectSize(e,t,r=!1){let i=[];return r===!0?e.traverseEntity(n=>{if(n.visible||n.cloner&&n.data.visible){if(!("geometry"in n)){i.push(new E);return}J4(n,t,i)}}):J4(e,t,i),this.setFromPoints(i)}getCenter(e){return e=super.getCenter(e),e.applyMatrix4(this.matrix),e}getPositionToCenter(e){return e=super.getCenter(e),e.applyMatrix4(Su.copy(this.matrix).setPosition(0,0,0)),e}computeVertices(){this.getSize(ic).multiplyScalar(.5),this.getCenter(rc),Su.copy(this.matrix).setPosition(rc),this.vertices=fz.map(e=>e.clone().multiply(ic).applyMatrix4(Su))}computeEdges(){this.vertices.length>0&&this.computeVertices(),this.edges=fle.map(([e,t])=>new Zn(this.vertices[e],this.vertices[t])),this.centerEdges=this.edges.map(e=>e.getCenter(new E))}computeFaces(){this.vertices.length>0&&this.computeVertices(),this.faces=mle.map(([e,t])=>this.vertices[e].clone().add(this.vertices[t]).multiplyScalar(.5))}},Jo={Cloner:()=>{},changeEntityProptotype:()=>{},createEntity:()=>{}},gle=class extends PR{constructor(){super()}getPoints(e=12){let t=[],r,i=this.getCurveLengths(),n=i[i.length-1]/i.length;for(let s=0,a=this.curves;s<a.length;s++){let o=a[s],l=s===0?i[s]:i[s]-i[s-1],c=Math.ceil(e*l/n),u=o.getPoints(c);for(let h=0;h<u.length;h++){let d=u[h];r&&r.equals(d)||(t.push(d),r=d)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}},d_=.001;function p_(e,t,r){return t.clone().sub(e).cross(t.clone().sub(r)).length()<=d_}function rw(e,t){let r=new E(...e.position),i=new E(...e.controlNext.position),n=new E(...t.controlPrevious.position),s=new E(...t.position);return p_(r,i,s)&&p_(r,n,s)}function mz(e){let t=e.points.map(u=>new E(...u.data.position)),r=[e.points[0]],i=new E(...r[0].data.position);for(let u=0;u<e.points.length-1;u++)p_(i,t[u],t[u+1])||(r.push(e.points[u]),i=t[u]);r.push(e.points[e.points.length-1]);let n=e.isClosed,s=r.length-(n?0:1),a=r.length,o=[];for(let u=0;u<a;u++){let h=r[u].data,d=new E(...h.position),p=new E(...h.controlPrevious.position),f=new E(...h.controlNext.position),m={position:d,baseRoundness:h.roundness,controlPrevious:p,controlNext:f};if(h.roundness===0||!e.isClosed&&(u===0||u===a-1)){o[u]={...m,removedLength:0};continue}let g=n&&u==0?a-1:u-1,v=n&&u==a-1?0:u+1,y=r[g].data,x=r[v].data,w=new E(...y.position),b=new E(...x.position),_=w.clone().sub(d).normalize(),A=b.clone().sub(d).normalize();Object.assign(m,{prevDir:_,nextDir:A});let S=rw(y,h),C=rw(h,x);if(!S||!C)o[u]={...m,removedLength:0};else{let M=_.clone().add(A).normalize(),T=M.clone().cross(_).length()/_.dot(M);o[u]={...m,tan:T,removedLength:h.roundness/T}}}for(let u=0;u<s;u++){let h=u,d=n&&u===a-1?0:u+1,p=o[h],f=o[d];if(p.removedLength!==0||f.removedLength!==0){let m=p.position.distanceTo(f.position);p.removedLength=Math.min(p.removedLength,m/2),f.removedLength=Math.min(f.removedLength,m/2)}}let l=[];for(let u=0;u<s;u++){let h=u,d=n&&u===a-1?0:u+1,p=o[h],f=o[d],m=null;if(!rw(r[h].data,r[d].data))p.position.distanceTo(f.position)>d_&&(m=new Ev(p.position,p.controlNext,f.controlPrevious,f.position));else{let g=p.position.clone(),v=f.position.clone();(p.removedLength!==0||f.removedLength!==0)&&(p.nextDir&&g.add(p.nextDir.clone().setLength(p.removedLength)),f.prevDir&&v.add(f.prevDir.clone().setLength(f.removedLength))),g.distanceTo(v)>d_&&(m=new Ev(g,g.clone().lerp(v,.3),v.clone().lerp(g,.3),v))}l[2*u+1]=m}for(let u=0;u<a;u++){let h=o[u];if(h.removedLength===0){l[2*u]=null;continue}let d=h.position,p=h.prevDir.clone().multiplyScalar(h.removedLength).add(d),f=h.nextDir.clone().multiplyScalar(h.removedLength).add(d),m=h.tan*h.removedLength,g=h.prevDir.clone().add(h.nextDir).normalize(),v=p.clone().lerp(f,.5),y=p.distanceTo(f)/2,x=g.clone().multiplyScalar(Math.sqrt(Math.pow(m,2)-Math.pow(y,2))).add(v),w=g.clone().multiplyScalar(-m).add(x),b=d.distanceTo(w)/d.distanceTo(v),_=h.prevDir.clone().multiplyScalar(b*d.distanceTo(p)).add(d),A=_.clone().lerp(w,2),S=p.clone().lerp(_,4/3),C=f.clone().lerp(A,4/3);l[2*u]=new Ev(p,S,C,f)}let c=new gle;return l.forEach(u=>{u&&c.add(u)}),c}var Mt;(e=>{function t(r){return r&&r.__isEntity}e.is=t})(Mt||(Mt={}));var Wa=e=>Mt.is(e),vle={type:"completeState",isfromEntity:!0},mA=e=>class extends fA(e){constructor(){super(...arguments),this.raycastLock=!1,this.scaleLock=!1,this.disposed=!1,this.stateSelection=null,this.instances=[],this.prevState=null,this.currentState=null,this.reversibleToState=null,this.currentTransitionEvent=null,this.previousAction=null,this._singleBBox=new eD,this._recursiveBBox=new eD,this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0,this._needApplyPathSnapping=!0,this.attachedPaths=new Set}get __isEntity(){return!0}entityChildren(t){let r=this.children[t];if(Mt.is(r))return r}entityChildrenCount(){let t=this.children.length;for(;t--;)if(Mt.is(this.children[t]))return t+1;return 0}get isConcreteEntity(){return typeof this.identity=="string"}get isVirtualEntity(){return typeof this.identity!="string"}get isInstanceRoot(){return this.isConcreteEntity&&this.data.type==="Instance"}nearestInstanceSelfOrParent(){let t=this;for(;t.data.type!=="Instance";){let r=t.parent;if(Mt.is(r))t=r;else return}return t}forInstancesRec(t){this.instances.forEach(r=>{r.disposed||t(r),r.forInstancesRec(t)})}super_Entity(t,r){typeof t=="string"&&(this.uuid=t),this.identity=t,this.data=r,this.matrixAutoUpdate=!1,this.dataPatched=this.data}changeSelectedState(t,r,i=!1){if(!(this.data.states.length===0&&!i)){for(let n of this.data.states)uc.toOps(this.data,n.data).forEach(s=>{let a=D2.replaceProps(s,this.data);this.dataPatched=this.data,this.updateByPatchedOp(a,this.data,r)});if(t!==null){let n=this.data.states.data(t);n&&(this.dataPatched=uc.patch(this.data,n),uc.toOps(this.data,n).forEach(s=>{this.updateByPatchedOp(s,this.dataPatched,r)}))}i&&this.updateTransformState(this.dataPatched),this.stateSelection=t,this.updatePathSnapping(this.dataPatched.pathSnapping)}}get singleBBox(){return this.singleBBoxNeedsUpdate&&(this.singleBBoxNeedsUpdate=!1,this._singleBBox.setFromObjectSize(this,!1),this._singleBBox.computeVertices(),this._singleBBox.computeEdges(),this._singleBBox.computeFaces()),this._singleBBox}get recursiveBBox(){return this.recursiveBBoxNeedsUpdate&&(this.recursiveBBoxNeedsUpdate=!1,this._recursiveBBox.setFromObjectSize(this,!0),this._recursiveBBox.computeVertices(),this._recursiveBBox.computeEdges(),this._recursiveBBox.computeFaces()),this._recursiveBBox}updateEntityBoxSize(t,r){t.setScalar(0),r.setScalar(0)}resetBBoxNeedsUpdateSelf(){this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}resetBBoxNeedsUpdate(){this.resetBBoxNeedsUpdateSelf(),this.traverseAncestors(t=>{Wa(t)&&t.resetBBoxNeedsUpdateSelf()}),this.traverseEntity(t=>{t.resetBBoxNeedsUpdateSelf()})}find(t){let r;return this.traverseEntity(i=>{i.uuid===t&&(r=i)}),r}traverseSortNextHelper(){let t=this.parent;if(t){let r=t.children,i=r.indexOf(this)+1;if(Mt.is(r[i]))return r[i];if(Mt.is(t))return t.traverseSortNextHelper()}}sortNext(){let t=this.children;return this.children.length>0&&Mt.is(this.children[0])?t[0]:this.traverseSortNextHelper()}goUp(t){let r=this;for(;t>0&&r!==null;)r=r.parent,t-=1;return r}hasAnccestorOrSelf(t){return this===t||this.hasAnccestor(t)}hasAnccestor(t){let r=this.parent;for(;r;){if(t===r)return!0;r=r.parent}return!1}countToAccestor(t){let r=0,i=this;for(;i!==t;){if(i===null)return-1;i=i.parent,r+=1}return r}forEachEntity(t){for(let r of this.children)Wa(r)&&t(r)}traverseEntityAncestors(t){this.traverseAncestors(r=>{Mt.is(r)&&t(r)})}traverseConcreteEntity(t,r=0){if(t(this,r)!==!0)for(let i of this.children)Wa(i)&&i.isConcreteEntity&&i.traverseEntity(t,r+1)}traverseEntity(t,r=0){if(t(this,r)!==!0)for(let i of this.children)Wa(i)&&i.traverseEntity(t,r+1)}traverseVisibleEntity(t){t(this);for(let r of this.children)Wa(r)&&r.visible&&r.traverseVisibleEntity(t)}updateMatrix(){super.updateMatrix(),this.cloner&&this.cloner.onObjUpdateMatrix(),this.dispatchEvent({type:"updateMatrix"})}copy(t,r=!1){return super.copy(t,r),this.dataPatched=t.dataPatched,this.raycastLock=t.raycastLock,this.scaleLock=t.scaleLock,this.hiddenMatrix.copy(t.hiddenMatrix),this}hasEntityChild(){return this.children.some(t=>Wa(t))}isAncestorOf(t){if(this.uuid===t)return!1;let r=!1;return this.traverseEntity(i=>{i.uuid===t&&(r=!0)}),r}toObjectTransformState(t=[]){this.updateWorldMatrix(!0,!1);let r={position:this.position.toArray(),rotation:[this.rotation.x,this.rotation.y,this.rotation.z],scale:this.scale.toArray(),hiddenMatrix:this.hiddenMatrix.toArray()};return P2(r,t)}updateTransformState(t){let r=!1;return t.position&&(this.position.fromArray(t.position),r=!0),t.rotation&&(this.rotation.fromArray(t.rotation),r=!0),t.scale&&(r=!0,this.scale.fromArray(t.scale)),t.hiddenMatrix!==void 0&&(r=!0,this.hiddenMatrix.fromArray(t.hiddenMatrix??Qu.identity)),r&&(this.updateMatrix(),this.resetBBoxNeedsUpdate(),this.invalidateClonerTransform(this),this.traverseEntityAncestors(i=>{i.invalidateClonerTransform(this)})),t.position&&t.rotation&&t.scale&&t.hiddenMatrix!==void 0&&this.updateWorldMatrix(!1,!0),r}dispose(){this.disposed=!0,this.cloner&&(this.cloner.removeFromParent(),this.cloner=void 0)}disposeChildrenRecursively(){for(let t of this.children)Mt.is(t)&&t.disposeRecursively()}disposeRecursively(){this.dispose(),this.children.forEach(t=>{Mt.is(t)&&t.disposeRecursively()})}toState(t=[]){let r={name:this.name,visible:this.visible,raycastLock:this.raycastLock,...this.toObjectTransformState(t)};return P2(r,t)}updateByObjUpdateOp(t,r){t!==void 0&&this.updateByOp({type:0,props:t,path:[]},{...this.data,...t},r,!1)}updateByOp(t,r,i,n){let s=this.data;this.data=r;let a=t,o=qn(t.path,["states","*"]);if(o!==null){if(t.type===0){let[l]=o;if((this==null?void 0:this.stateSelection)===l){let c={...t.props};if(delete c.name,Object.values(t.props).some(u=>u===void 0)){let u=this.data;if(u!==void 0){let h=ua.zoom(u,t.path.slice(2));if(h)for(let d in t.props)t.props[d]===void 0&&d in h&&(c[d]=h[d])}}a={...t,props:c,path:t.path.slice(2)}}}}else if(t.type===0){let l=this.stateSelection?this.data.states.data(this.stateSelection):void 0;if(l!==void 0){if(t.props.name!==void 0&&l.name){let{name:u,...h}=l;l=h}if(t.props.material!==void 0&&"material"in l){let{material:u,...h}=l;l=h}let c=ua.removeOverridden(t.path,t.props,l);a={...t,props:c}}}if(this.updateByPatchedOpBase(a,uc.patch(this.data,this.stateSelection?this.data.states.data(this.stateSelection):void 0),i),qn(t.path,["overrides"])){let l=[],c=[...t.path];for(l.push(c[1]),c.splice(0,2);c.length>0&&c[0]==="descendants";)l.push(c[1]),c.splice(0,2);if(l[l.length-1]===void 0){if(t.type===0)for(let u of Object.keys(t.props)){l[l.length-1]=u;let h=i.scene.findInstance([this.uuid,...l]);h&&(h.overrideData=t.props[u],h.updateState(fl.apply(h.component.data,h.overrideData),i))}}else{let u=i.scene.findInstance([this.uuid,...l]);if(u){let h=ua.zoom(u.component.data,c);if(t={...t,path:c},t.type===0){let d=t.props;if(h)for(let[p,f]of Object.entries(t.props))f===void 0&&(d===t.props&&(d={...t.props}),d[p]=h[p]);t={...t,props:d}}u.overrideData=Y0.resolve(r.overrides,l),u.updateByOp(t,Ri.applySimple(u.data,t),i,!1)}}}else if(this.instances.length>0){let l;if(t.path.length===0&&t.type===0){let c;for(let u of $o.rootOverrideProps)u in t.props&&(c===void 0&&(c={}),c[u]=t.props[u]);c&&(l={...t,props:c})}else for(let c of $o.rootOverrideProps)if(qn(t.path,[c])){l=t;break}l!==void 0&&this.instances.forEach(c=>{if(c.isInstanceRoot){let u=fl.filterOp(c.overrideData,l);u&&c.updateByOp(u,Ri.applySimple(c.data,u),i,!0)}}),this.instances.forEach(c=>{if(!c.isInstanceRoot){let u=fl.filterOp(c.overrideData,t);if(u){let h;s===c.data&&t===u?h=r:h=Ri.applySimple(c.data,u),c.updateByOp(u,h,i,!0)}}})}}updateByPatchedOpBase(t,r,i){if(this.dataPatched=r,t.path.length===0&&t.type===0)t.props.type!==void 0&&!zc.is(t.props.type)&&Jo.changeEntityProptotype(this,r,i);else if(t.path.length===1&&t.path[0]==="geometry"&&t.type===0&&"type"in t.props){Jo.changeEntityProptotype(this,r,i);for(let n of this.children)Mt.is(n)&&n.updateVisible()}this.updateByPatchedOp(t,r,i)}updateByPatchedOp(t,r,i){if(t.path.length===0&&t.type===0&&this.updateState(t.props,i),qn(t.path,["pathSnapping"])!==null&&this.updatePathSnapping(r.pathSnapping),qn(t.path,["cloner"])!==null){let n=Ri.drop(t,1);n.path.length===0&&n.type===0&&n.props.disabled===!0?this.setFromClonerState(null,i):this.cloner?this.cloner.updateState(r.cloner,i.scene):(this.setFromClonerState(r.cloner,i),this.expandCloner(i.scene)),this.updateVisible()}}updatePathSnapping(t){this._updatedPathSnapping=t,this._needApplyPathSnapping=!0}get updatedPathSnapping(){return this._updatedPathSnapping}applyPathSnapping(t){var f,m,g,v,y;let r=((f=this._updatedPathSnapping)==null?void 0:f.pathId)??this.dataPatched.pathSnapping.pathId,i=((m=this._updatedPathSnapping)==null?void 0:m.slide)??this.dataPatched.pathSnapping.slide??0,n=((g=this._updatedPathSnapping)==null?void 0:g.offset)??this.dataPatched.pathSnapping.offset,s=((v=this._updatedPathSnapping)==null?void 0:v.orientation)??this.dataPatched.pathSnapping.orientation;if(r===null)return;let a=t.find(r);if(!a||this._needApplyPathSnapping===!1)return;this._needApplyPathSnapping=!1;let o=a.data;if(o.geometry.path.points.length<=1)return;let l=mz(o.geometry.path),c=(i+n)%1;i+n===1&&c===0&&(c=1);let u=l.getPointAt(c),h=this.parent?(y=this.parent)==null?void 0:y.matrixWorld:new _e;a.updateMatrixWorld();let d=new _e().multiplyMatrices(h.clone().invert(),a.matrixWorld);u.applyMatrix4(d);let p={position:u.toArray(),rotation:o.rotation};if(s==="tangential"){let x=new _e().extractRotation(a.matrixWorld),w=l.getTangentAt(c).applyMatrix4(x).add(u),b=new _e().lookAt(u,w,new E(0,1,0)),_=new Zr().setFromRotationMatrix(b);p={...p,rotation:[_.x,_.y,_.z]}}this.updateTransformState(p),this.traverseEntity(x=>{x._cameraType&&x.dispatchEvent(vle)})}updateVisible(){var t;this.visible=this.dataPatched.visible&&(!this.dataPatched.cloner||(this.dataPatched.cloner.disabled??!1)||((t=this.dataPatched.cloner)==null?void 0:t.hideBase)!==!0)}updateState_Entity(t,r){t.name!==void 0&&(this.name=t.name),t.raycastLock!==void 0&&(this.raycastLock=t.raycastLock),t.visible!==void 0&&(this.updateVisible(),this.resetBBoxNeedsUpdate()),r&&"cloner"in t&&t.cloner!==void 0&&(this.setFromClonerState(t.cloner,r),this.updateVisible()),this.updateTransformState(t)}get attachedSurfaceCloners(){return this.children.filter(t=>t instanceof Jo.Cloner&&t.parameters.type==="toObject")}setFromClonerState(t,r){this.disposed||(t===null||t.disabled?(this.cloner&&this.cloner.removeFromParent(),this.cloner=void 0):this.cloner===void 0?(this.cloner=new Jo.Cloner(this,t),r.scene.addPendingExpandCloner(this)):this.cloner.updateState(t,r.scene))}expandCloner(t){!this.disposed&&this.cloner&&this.cloner.expandClones(t)}invalidateClonerTransform(t){this.cloner&&this.cloner.invalidateTransform(t)}},gz=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,radialSegments:64,heightSegments:1,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadius:8,cornerSegments:8,hollow:0},e.parameters),i=r.width/2,n=r.radiusTop??i,s=r.radiusBottom??i;return n===s?(n=i,s=i):n>s?(n=i,s=s*i/n):(n=n*i/s,s=i),{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width),radiusTop:n,radiusBottom:s})}}static build(e){let{width:t,depth:r,height:i,radialSegments:n,heightSegments:s,openEnded:a,thetaStart:o,thetaLength:l,radiusTop:c,radiusBottom:u,cornerRadius:h,cornerSegments:d,hollow:p}=e.parameters,f;return h||p?f=new vz(c,u,i,n,s,a,o,l*Math.PI/180,h,h,d,p):f=new L3(c,u,i,n,s,a,o,l*Math.PI/180),f.scale(1,1,r/t),Object.assign(f,{userData:{...e,type:"CylinderGeometry"}})}};function Mo(e,t,r){r.x=e.x*t.x,r.y=e.y,r.z=e.x*t.y}function tD(e){return new W(e.y,-e.x)}var vz=class extends it{constructor(e,t,r,i,n,s,a,o,l,c,u,h,d=!1){super(),this.type="RoundedCylinderBufferGeometry",e=e!==void 0?e:1,t=t!==void 0?t:1,r=r||1,i=Math.floor(i)||8,n=Math.floor(n)||1,s=s!==void 0?s:!1,a=a!==void 0?a:0,o=o!==void 0?o:Math.PI*2,s&&(l=0,c=0);let p=[],f=[],m=[],g=[],v=0,y=r/2,x=new E,w=new E;d&&e==0&&(e=l),d&&t==0&&(t=c);let b=new W(e,y),_=new W(t,-y),A=null,S=null,C=null,M=null,T=b.clone().sub(_),P=0,D=0,I=0;h>0&&(P=Math.min(e,t)*(1-h),D=e-P,I=t-P);let B=b.clone();B.x-=P;let X=Math.PI-T.angle(),H=T.angle(),R=Math.tan(H/2),q=Math.tan(X/2),F=R+q,N=h?F:q,j=h?F:R;if(l=Math.min(l,(e-D)/N,T.length()/F),c=Math.min(c,(t-I)/j,T.length()/F),l>0){let J=l/R;A=b.clone().sub(new W(J,l)),h&&(C=A.clone(),C.x-=P-F*l),b.sub(T.clone().setLength(J))}if(c>0){let J=c/q;S=_.clone().sub(new W(J,-c)),_.add(T.clone().setLength(J)),h&&(M=S.clone(),M.x-=P-F*c,B.sub(T.clone().setLength(J)))}T=b.clone().sub(_);let K=T.length()<.5,U=[];for(let J=0;J<=i;J++){let ee=[],se=J/i,ce=se*o+a,ue=new W(Math.sin(ce),Math.cos(ce));M&&S?(Y(ee,se,ue,X,c,M,-1,!0),Y(ee,se,ue,H,c,S,-1,!1)):S?(V(ee,ue,S.x,0,-1),Y(ee,se,ue,H,c,S,-1,!1)):s||V(ee,ue,t,I,-1);let ye=tD(T).normalize();if(Mo(ye,ue,x),!K)for(let Re=0;Re<=n;Re++){let Se=Re/n,ke=T.clone().multiplyScalar(Se).add(_);Mo(ke,ue,w),f.push(w.x,w.y,w.z),m.push(x.x,x.y,x.z),g.push(se,.5+w.y/r),ee.push(v++)}if(C&&A?(Y(ee,se,ue,X,l,A,1,!1),Y(ee,se,ue,H,l,C,1,!0)):A?(Y(ee,se,ue,X,l,A,1,!1),V(ee,ue,A.x,0,1)):s||V(ee,ue,e,D,1),h&&!K){let Re=tD(T).multiplyScalar(-1).normalize();Mo(Re,ue,x);for(let Se=0;Se<=n;Se++){let ke=Se/n,Oe=T.clone().multiplyScalar(-ke).add(B);Mo(Oe,ue,w),f.push(w.x,w.y,w.z),m.push(x.x,x.y,x.z),g.push(se,.5+w.y/r),ee.push(v++)}}h&&!s&&ee.push(ee[0]),U.push(ee)}for(let J=0;J<U.length-1;J++)for(let ee=0;ee<U[0].length-1;ee++){if(s&&h&&ee==n)continue;let se=U[J][ee],ce=U[J+1][ee],ue=U[J+1][ee+1],ye=U[J][ee+1],Re=f[ue*3+0],Se=f[ue*3+2];p.push(se,ce,ye),(Re!=0||Se!=0)&&p.push(ce,ue,ye)}o<Math.PI*2&&(ie(-1,U[0],a),ie(1,U[U.length-1],a+o)),this.setIndex(p),this.setAttribute("position",new Ne(f,3)),this.setAttribute("normal",new Ne(m,3)),this.setAttribute("uv",new Ne(g,2));function Y(J,ee,se,ce,ue,ye,Re,Se){for(let ke=0;ke<u+1;ke++){let Oe=ke/u,Ce=Re<0?Oe:1-Oe;Se&&(Ce-=1),Ce*=ce;let Ae=new W(Math.sin(Ce),Math.cos(Ce)*Re),je=Ae.clone().multiplyScalar(ue).add(ye);Mo(je,se,w),f.push(w.x,w.y,w.z),Mo(Ae,se,x),m.push(x.x,x.y,x.z),g.push(ee,.5+w.y/r),J.push(v++)}}function V(J,ee,se,ce,ue){let ye=new E,Re=new W,Se=[se,ce];ue<0&&Se.reverse();for(let ke of Se)Re.set(ke,y*ue),Mo(Re,ee,ye),f.push(ye.x,ye.y,ye.z),m.push(0,ue,0),g.push(.5,.5),J.push(v++)}function ie(J,ee,se){let ce=new W(Math.sin(se),Math.cos(se)),ue=new W(-Math.cos(se),Math.sin(se)),ye=new E,Re=J<0?(Oe,Ce,Ae)=>p.push(Oe,Ce,Ae):(Oe,Ce,Ae)=>p.push(Oe,Ae,Ce),Se=new W((e+t+D+I)/4,0);Mo(Se,ce,ye),f.push(ye.x,ye.y,ye.z),m.push(ue.x,0,ue.y),g.push(.5,.5);let ke=v++;for(let Oe of ee){let Ce=f.slice(Oe*3,Oe*3+3);f.push(...Ce),m.push(ue.x,0,ue.y);let Ae=g.slice(Oe*2,Oe*2+2);g.push(...Ae),v++}for(let Oe=ke+1;Oe<v-1;Oe++)Re(ke,Oe,Oe+1);Re(ke,v-1,ke+1)}}},yle=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,radialSegments:32,heightSegments:8,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadiusTop:8,cornerRadiusBottom:8,cornerSegments:8},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t,depth:r,height:i,radialSegments:n,heightSegments:s,openEnded:a,thetaStart:o,thetaLength:l,cornerRadiusTop:c,cornerRadiusBottom:u,cornerSegments:h}=e.parameters,d;return c>0||u>0||l<360?d=new vz(0,t/2,i,n,s,a,o,l*Math.PI/180,c,u,h,0,!0):d=new LR(t/2,i,n,s,a),d.scale(1,1,r/t),Object.assign(d,{userData:{...e,type:"ConeGeometry"}})}},xle=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,widthSegments:1,heightSegments:1,depthSegments:1,cornerRadius:8,cornerSegments:8},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t,height:r,depth:i,widthSegments:n,heightSegments:s,depthSegments:a,cornerRadius:o,cornerSegments:l}=e.parameters,c;return o==0?c=new ma(t,r,i,n,s,a):c=new wle(t,r,i,n,s,a,o,l),Object.assign(c,{userData:{...e,type:"CubeGeometry"}})}},iw=Math.PI/2,wle=class extends it{constructor(e=1,t=1,r=1,i=1,n=1,s=1,a=0,o=4){super(),this.type="BoxGeometry";let l=this;i=Math.floor(i),n=Math.floor(n),s=Math.floor(s),o=Math.floor(o),a=Math.min(a,e/2,t/2,r/2);let c=[],u=[],h=[],d=[],p=0,f=0;m("z","y","x",-1,-1,r,t,e,s,n,0),m("z","y","x",1,-1,r,t,-e,s,n,1),m("x","z","y",1,1,e,r,t,i,s,2),m("x","z","y",1,-1,e,r,-t,i,s,3),m("x","y","z",1,-1,e,t,r,i,n,4),m("x","y","z",-1,-1,e,t,-r,i,n,5),a>0&&(g("z","y","x",-1,-1,1,r,t,e,s,0),g("z","y","x",1,-1,-1,r,t,e,s,1),g("z","y","x",-1,1,-1,r,t,e,s,1),g("z","y","x",1,1,1,r,t,e,s,0),g("x","y","z",-1,-1,-1,e,t,r,i,0),g("x","y","z",1,-1,1,e,t,r,i,1),g("x","y","z",-1,1,1,e,t,r,i,0),g("x","y","z",1,1,-1,e,t,r,i,1),g("y","x","z",-1,-1,1,t,e,r,n,0),g("y","x","z",1,-1,-1,t,e,r,n,1),g("y","x","z",1,1,1,t,e,r,n,1),g("y","x","z",-1,1,-1,t,e,r,n,0),v(1,1,1),v(-1,1,1),v(1,-1,1),v(-1,-1,1),v(1,1,-1),v(-1,1,-1),v(1,-1,-1),v(-1,-1,-1)),this.setIndex(c),this.setAttribute("position",new Ne(u,3)),this.setAttribute("normal",new Ne(h,3)),this.setAttribute("uv",new Ne(d,2));function m(y,x,w,b,_,A,S,C,M,T,P){let D=(A-2*a)/M,I=(S-2*a)/T,B=A/2-a,X=S/2-a,H=C/2,R=M+1,q=T+1,F=0,N=0,j=new E;for(let K=0;K<q;K++){let U=K*I-X;for(let Y=0;Y<R;Y++){let V=Y*D-B;j[y]=V*b,j[x]=U*_,j[w]=H,u.push(j.x,j.y,j.z),j[y]=0,j[x]=0,j[w]=C>0?1:-1,h.push(j.x,j.y,j.z),d.push(Y/M),d.push(1-K/T),F+=1}}for(let K=0;K<T;K++)for(let U=0;U<M;U++){let Y=p+U+R*K,V=p+U+R*(K+1),ie=p+(U+1)+R*(K+1),J=p+(U+1)+R*K;c.push(Y,V,J),c.push(V,ie,J),N+=6}l.addGroup(f,N,P),f+=N,p+=F}function g(y,x,w,b,_,A,S,C,M,T,P){let D=(S-2*a)/T,I=S/2-a,B=C/2-a,X=M/2,H=T+1,R=0,q=0,F=new E,N=new E;for(let j=0;j<o+1;j++){let K=j/o*iw,U=Math.sin(K)*a,Y=(1-Math.cos(K))*a,V=Math.sin(K),ie=Math.cos(K);F[x]=(B+U)*_,F[w]=(X-Y)*A,N[y]=0,N[x]=V*Math.sign(F[x]),N[w]=ie*Math.sign(F[w]);for(let J=0;J<H;J++){let ee=J*D-I;F[y]=ee*b,u.push(F.x,F.y,F.z),h.push(N.x,N.y,N.z),d.push(J/T),d.push(0),R+=1}}for(let j=0;j<o;j++)for(let K=0;K<T;K++){let U=p+K+H*j,Y=p+K+H*(j+1),V=p+(K+1)+H*(j+1),ie=p+(K+1)+H*j;c.push(U,Y,ie),c.push(Y,V,ie),q+=6}l.addGroup(f,q,P),f+=q,p+=R}function v(y,x,w){let b=new E,_=new E(e/2,t/2,r/2);_.subScalar(a);let A=[],S=y*x*w>0?(M,T,P)=>c.push(M,T,P):(M,T,P)=>c.push(M,P,T);for(let M=0;M<=o;M++){let T=[],P=iw*(1-M/o),D=Math.cos(P),I=Math.sin(P),B=0;for(let X=0;X<=M;X++){let H=Math.cos(B),R=Math.sin(B);b.x=D*H,b.y=I,b.z=D*R;let q=_.clone().addScaledVector(b,a);u.push(y*q.x,x*q.y,w*q.z),h.push(y*b.x,x*b.y,w*b.z),d.push(0,0),T.push(p++),B+=iw/M}A.push(T)}let C=A.length-1;for(let M=0;M<C;M++){let T=A[M],P=A[M+1],D=T.length-1;S(T[0],P[1],P[0]);for(let I=1;I<=D;I++)S(T[I-1],T[I],P[I]),S(T[I],P[I+1],P[I])}}}},gA=class extends it{constructor(e=[],t=[],r="",i=1,n=.2,s=4){super(),this.type="PolyhedronGeometryRound";let a=[],o=[],l=[];c(),u(),this.setAttribute("position",new Ne(a,3)),this.setAttribute("normal",new Ne(l,3)),this.setAttribute("uv",new Ne(o,2));return;function c(){var H;n=Math.min(1-1e-5,n),n==0&&(s=0);let h={IcosahedronGeometry:5,DodecahedronGeometry:3,HexahedronGeometry:3,OctahedronGeometry:4,TetrahedronGeometry:3}[r],d=new E,p=d.clone(),f=new yi,m=n*i,g=i-m,v=s+1,y=new E,x=(R,q)=>y.subVectors(R,q).normalize(),w=(R,q)=>Array(R).fill(void 0).map(q),b=w(e.length/3,(R,q)=>new E().fromArray(e,q*3).setLength(i)),_=[],A=1e6;for(let R=0;R<b.length;R++){let q=b[R],F=[],N,j,K,U=1e10,Y=-1;for(;(Y=t.indexOf(R,Y+1))!=-1;){let ee=Y-Y%3;N=t[ee+(Y+1)%3],j=t[ee+(Y+2)%3],K=q.distanceToSquared(b[N]),U=Math.min(U,K),F.push([N,j,K])}U+=1e-6;let V=[],ie=0,J=F.length;for(let ee=0;ee<J;ee++){[N,j,K]=F[ie];let se=((H=_[N])==null?void 0:H.includes(R))==!0;K<=U&&V.push(N+ +se*A),ie=F.findIndex(ce=>ce[0]==j)}_.push(V)}let S=[];{let R=0,q=0,F,N,j=h==3;for(let K=0;K<=s;K++){F=K*(K+1)/2,N=(K+1)*(K+2)/2;for(let U=0;U<s-K;U++)[R,q]=[F+U+K+2,N+U+K+3],S.push(F,N,...j?[q,F]:[R,N],q,R),[F,N]=[R,q];S.push(F,N,F+s+2)}}let C=d.clone(),M=d.clone(),T=d.clone(),P=d.clone(),D=d.clone(),I=[],B=w(b.length,()=>w(h,()=>d.clone()));for(let R=0;R<b.length;R++){d.copy(b[R]).normalize(),C.copy(d).multiplyScalar(g);let q=_[R];for(let V=0;V<q.length;V++){let ie=q[V],J=q[(V+1)%h];f.setFromPointsAndIndices(b,R,ie%A,J%A),f.b.sub(f.a).setLength(1e10).add(f.a),f.c.sub(f.a).setLength(1e10).add(f.a),f.closestPointToPoint(C,B[R][V])}let F=[],N=[],j=[],K=new E;s==0&&[...B[R]].reduce((V,ie)=>V.add(ie),K).multiplyScalar(1/h);for(let V=0;V<h;V++){let ie=[],J=(V-1+h)%h,ee=B[R][J],se=B[R][V];d.copy(ee).sub(C),p.copy(se).sub(C);let ce=C.angleTo(d),ue=d.angleTo(p),ye=Math.cos(ce)*m;s==0?M.copy(K):M.copy(C).setLength(g+ye),N.push(ye);let Re=[M,ee,se];for(let Se=0;Se<2;Se++){let ke=Re[Se],Oe=Re[Se+1];P.subVectors(ke,C),D.subVectors(Oe,C),T.crossVectors(P,D).normalize();for(let Ce=0;Ce<v;Ce++){let Ae=[ce,ue][Se]*Ce/v;d.copy(P).applyAxisAngle(T,Ae).add(C),F.push(d.clone()),Se&&(x(d,C),ie.push([Ce==0?ke:d.clone(),y.clone()]))}Se&&(x(Oe,C),ie.push([Oe,y.clone()]))}j.push(ie)}I.push(j);let U=2*v,Y=2;for(let V=0;V<h;V++){let ie=U*V,J=U*((V+1)%h),ee=[F[ie]];for(let ce=1;ce<v;ce++){P=F[ie+ce],D=F[J+ce],ee.push(P);for(let ue=1,ye=ce-Y+1;ue<=ye;ue++)d.lerpVectors(P,D,ue/(ye+1)),d.sub(C).setLength(N[V]).add(C),ee.push(d.clone());ee.push(D)}for(let ce=0;ce<v;ce++)ee.push(F[ce+v+ie]);ee.push(F[J+v]);let se=S.map(ce=>ee[ce]);a.push(...se.map(ce=>[ce.x,ce.y,ce.z]).flat()),l.push(...se.map(ce=>(x(ce,C),[y.x,y.y,y.z])).flat())}}let X=[];for(let R=0;R<_.length;R++)for(let q=0;q<h;q++){let F=_[R][q];if(F<A){let N=_[F].findIndex(U=>U%A==R),j=I[R][q],K=I[F][N];for(let U=0;U<v;U++){let Y=j[U],V=K[v-U],ie=j[U+1],J=K[v-(U+1)];[Y,V,ie,ie,V,J].forEach(ee=>{a.push(ee[0].x,ee[0].y,ee[0].z),l.push(ee[1].x,ee[1].y,ee[1].z)})}X.push(j[0][0],K[v][0],j[v][0],K[0][0])}}for(;X.length;){let R,q,F,N;[R,q]=X.splice(0,2);let j=[R];for(;R!=q;)j.push(q),F=X.indexOf(q),N=F%2,q=X.splice(F-N,2)[1-N];y.subVectors(j[0],j[1]).cross(d.subVectors(j[0],j[2])).normalize();let K=y.dot(j[0])<0;K&&y.negate();for(let U=1;U<=j.length-2;U++)[j[U+ +K],j[U+1-+K],j[0]].forEach(Y=>{a.push(Y.x,Y.y,Y.z),l.push(y.x,y.y,y.z)})}}function u(){let h=new E;for(let _=0;_<a.length;_+=3){h.x=a[_+0],h.y=a[_+1],h.z=a[_+2];let A=w(h)/2/Math.PI+.5,S=b(h)/Math.PI+.5;o.push(A,1-S)}let d=new E,p=new E,f=new E,m=new E,g=new W,v=new W,y=new W,x=(_,A,S,C)=>{C<0&&_.x===1&&(o[A]=_.x-1),S.x===0&&S.z===0&&(o[A]=C/2/Math.PI+.5)};for(let _=0,A=0;_<a.length;_+=9,A+=6){d.set(a[_+0],a[_+1],a[_+2]),p.set(a[_+3],a[_+4],a[_+5]),f.set(a[_+6],a[_+7],a[_+8]),g.set(o[A+0],o[A+1]),v.set(o[A+2],o[A+3]),y.set(o[A+4],o[A+5]),m.copy(d).add(p).add(f).divideScalar(3);let S=w(m);x(g,A+0,d,S),x(v,A+2,p,S),x(y,A+4,f,S)}for(let _=0;_<o.length;_+=6){let A=o[_+0],S=o[_+2],C=o[_+4],M=Math.max(A,S,C),T=Math.min(A,S,C);M>.9&&T<.1&&(A<.2&&(o[_+0]+=1),S<.2&&(o[_+2]+=1),C<.2&&(o[_+4]+=1))}function w(_){return Math.atan2(_.z,-_.x)}function b(_){return Math.atan2(-_.y,Math.sqrt(_.x*_.x+_.z*_.z))}}}static fromJSON(e){return new gA(e.vertices,e.indices,e.radius,e.corner,e.cornerSides)}},ble=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,detail:0,corner:0,cornerSides:4},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t,height:r,depth:i,detail:n,corner:s,cornerSides:a}=e.parameters,o=n===0&&s!==0?new yz(t*.5,s,a):new IR(t*.5,n);return o.scale(1,r/t,i/t),Object.assign(o,{userData:{...e,type:"DodecahedronGeometry"}})}},yz=class extends gA{constructor(e=1,t=.2,r=4){let i=(1+Math.sqrt(5))/2,n=1/i,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-i,0,-n,i,0,n,-i,0,n,i,-n,-i,0,-n,i,0,n,-i,0,n,i,0,-i,0,-n,i,0,-n,-i,0,n,i,0,n],a=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],o="DodecahedronGeometry";super(s,a,o,e,t,r),this.type=o}static fromJSON(e){return new yz(e.radius,e.corner,e.cornerSides)}},np=1e-12,vA=class{constructor(e){this.position=new W,this.startPosition=new W,this.uuid=mt.generateUUID(),this.position=e.clone()}start(){this.reset()}reset(){this.startPosition.copy(this.position)}applyOffset(e){this.position.copy(this.startPosition).add(e)}copy(e){return this.position.copy(e.position),this.startPosition.copy(e.startPosition),this}clone(){return new vA(this.position).copy(this)}toJSON(){return[this.position.x,this.position.y]}},f_=class extends vA{constructor(e){super(e.position),this.parent=e}copy(e){return super.copy(e),this}clone(){return new f_(this.parent).copy(this)}},Au=class extends vA{constructor(e,t){super(t),this.controls=[],this.roundness=0,this.areControlsDirectionsMirrored=!0,this.uuid=e,this.controls.push(new f_(this),new f_(this))}static create(e,t){let r=new Au(e,new W(...t.position));return r.controls[0].position.set(...t.controlPrevious.position),r.controls[1].position.set(...t.controlNext.position),r.roundness=t.roundness,r.areControlsDirectionsMirrored=t.areControlsDirectionsMirrored,r}getOppositeControl(e){let t=this.controls.indexOf(e);return t===0?this.controls[1]:t===1?this.controls[0]:null}applyOffsetToControls(e,t=1){for(let r=0,i=this.controls.length;r<i;r++){let n=this.controls[r];this.position.distanceTo(n.position)<=t?n.position.copy(this.position):n.applyOffset(e)}}controlsMoved(){return!(this.position.equals(this.controls[0].position)&&this.position.equals(this.controls[1].position))}copy(e){return super.copy(e),this.controls[0].copy(e.controls[0]),this.controls[1].copy(e.controls[1]),this.roundness=e.roundness,this.uuid=e.uuid,this}clone(){return new Au(this.uuid,this.position).copy(this)}toJSON(){return super.toJSON().concat(this.controls[0].toJSON(),this.controls[1].toJSON(),[this.roundness])}computeTangents(){var r,i;let e=(r=this.curveBefore)==null?void 0:r.getTangentAt(1),t=(i=this.curveAfter)==null?void 0:i.getTangentAt(0);return[e,t]}computeNormals(e=new W,t=new W){let[r,i]=this.computeTangents();return r&&i&&(rD(r,e),rD(i,t)),[e,t]}computeTangent(e=new W){let[t,r]=this.computeTangents();return t&&r&&e.copy(t).add(r).normalize(),e}computeNormal(e=new W){let[t,r]=this.computeNormals();return e.copy(t).add(r).normalize(),e}};function rD(e,t=new W){let r=e.length();return t.set(-e.y/r,e.x/r)}var yA=e=>e,Ad=new W,r1=new W,_le=new W,Sle=new W,Ale=new W,Cle=new W,xz=new E,wz=new E;function Mle(e){let t=new W;t.addVectors(e.v0,Ad.subVectors(e.v1,e.v0).multiplyScalar(2/3));let r=new W;return r.addVectors(e.v2,r1.subVectors(e.v1,e.v2).multiplyScalar(2/3)),new bs(e.v0,t,r,e.v2)}function Pp(e,t,r=Number.EPSILON){return Math.abs(e-t)<r}function Ele(e,t,r=Number.EPSILON){return e.distanceTo(t)<r}function Tle(e,t,r=Number.EPSILON){return e.distanceTo(t)<r}function bz(e,t,r){let i=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),n=Math.sqrt(Math.pow(t.x-r.x,2)+Math.pow(t.y-r.y,2)),s=Math.sqrt(Math.pow(r.x-e.x,2)+Math.pow(r.y-e.y,2));return Math.acos((n*n+i*i-s*s)/(2*n*i))}function Ple(e,t,r){return nD(e,t)&&nD(t,r)&&m_(e.position,t.position,r.position)}function m_(e,t,r){return Ad.copy(t).sub(e).cross(r1.copy(r).sub(e))===0}function Dle(e,t,r,i,n){let s=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),a=(e.y+t.y)/2,o=(e.x+t.x)/2,l=Math.sqrt(Math.pow(r,2)-Math.pow(s/2,2))*(e.y-t.y)/s,c=Math.sqrt(Math.pow(r,2)-Math.pow(s/2,2))*(t.x-e.x)/s;return i.set(o+l,a+c),n.set(o-l,a-c),[i,n]}function Lle(e,t,r){let i=e.distanceTo(r),n=t.distanceTo(r);return i<n?t:e}function Ile(e,t,r,i,n,s){let a=t.x-e.x,o=t.y-e.y,l=r.x-e.x,c=r.y-e.y,u=Math.sqrt((a+l)*(a+l)+(o+c)*(o+c)),h;return bz(t,e,r)>Math.PI&&(u*=-1),Pp(c,o)?h=(o+c)*(i/u-.5)*8/3/(a-l):h=(a+l)*(i/u-.5)*8/3/(c-o),n.set(t.x-h*o,t.y+h*a),s.set(r.x+h*c,r.y-h*l),[n,s]}function iD(e,t){return e.position.equals(e.controls[1].position)&&t.position.equals(t.controls[0].position)}function nD(e,t){return m_(e.position,e.controls[1].position,t.position)&&m_(e.position,t.controls[0].position,t.position)}function Ole(e,t,r,i,n=.5){let s=Ad.subVectors(t,e).multiplyScalar(n).add(e),a=r1.subVectors(r,t).multiplyScalar(n).add(t),o=_le.subVectors(i,r).multiplyScalar(n).add(r),l=s,c=Sle.subVectors(a,s).multiplyScalar(n).add(s),u=Ale.subVectors(o,a).multiplyScalar(n).add(a),h=o,d=Cle.subVectors(u,c).multiplyScalar(n).add(c);return[e.x,e.y,l.x,l.y,c.x,c.y,d.x,d.y,u.x,u.y,h.x,h.y,i.x,i.y]}function Rle(e,t,r=12,i=!0){let n=wz.set(0,0,0),s,a=0;for(let o=0;o<t.length;o++){let l=yA(t[o]),c=Ad,u=Sc(l,r);for(let h=0;h<=u;h++)if(l instanceof bs||l instanceof Sl||l instanceof Ts){if(l.getPoint(h/u,c),n.set(c.x,c.y,0),s!==void 0&&Tle(s,n))continue;s===void 0&&(s=xz),s.copy(n),e.setXYZ(a,n.x,n.y,n.z),a++}}return i&&a>1&&!(e.getX(a-1)===e.getX(0)&&e.getY(a-1)===e.getY(0)&&e.getZ(a-1)===e.getZ(0))&&(e.setXYZ(a,e.getX(0),e.getY(0),e.getZ(0)),a++),e}function Ble(e,t,r,i=12,n=!0){let s=wz.set(0,0,0),a=0,o=[];for(let l=0;l<t.length;l++){if(r[l]===!1)continue;let c,u=yA(t[l]),h=Ad,d=Sc(u,i);o.push(d);for(let p=0;p<=d;p++)if(u instanceof bs||u instanceof Sl||u instanceof Ts){if(u.getPoint(p/d,h),s.set(h.x,h.y,0),c==null?void 0:c.equals(s))continue;c===void 0?c=xz:(e.setXYZ(a,c.x,c.y,c.z),a++,e.setXYZ(a,s.x,s.y,s.z),a++),c.copy(s)}}return n&&a>1&&!(e.getX(a-1)===e.getX(0)&&e.getY(a-1)===e.getY(0)&&e.getZ(a-1)===e.getZ(0))&&(e.setXYZ(a,e.getX(0),e.getY(0),e.getZ(0)),a++),o}function sD(e,t=12,r=!1){let i=[];for(let n=0,s=e.length;n<s;n++){let a=e[n],o=0;if(r&&a.roundedCurveCorner!==void 0){let l=Sc(a.roundedCurveCorner,t)*.5;n>0&&(i[n-1]+=l),o+=l}a.curveAfter!==void 0&&(o+=Sc(a.curveAfter,t)),i.push(o)}return e.length>0&&r&&e[0].roundedCurveCorner!==void 0&&(i[e.length-1]+=Sc(e[0].roundedCurveCorner,t)*.5),i}function Sc(e,t=12){return e&&e instanceof Uy?t*2:e&&(e instanceof Ts||e instanceof TR)?1:e&&e instanceof D3?t*e.points.length:t}function zle(e,t,r=12,i=!0){let n,s=0;for(let a=0;a<t.length;a++){let o=yA(t[a]),l=Sc(o,r),c=Ad;for(let u=0;u<=l;u++)if(o instanceof bs||o instanceof Sl||o instanceof Ts){if(o.getPoint(u/l,c),n!==void 0&&Ele(n,c,np))continue;n===void 0&&(n=r1),n.copy(c),e.push(c.x,c.y),s++}}return Pp(e[0],e[e.length-2],np)&&Pp(e[1],e[e.length-1],np)&&(e.pop(),e.pop()),i&&s>1&&!(Pp(e[s-1],e[1],np)&&Pp(e[s-2],e[0],np))&&(e.push(e[0],e[1]),s++),e}var nw=new W,kle=new W,Nle=new W,Fle=new W,Ule=new W,jle=new W,fr=class extends C0{constructor(e=100,t=100){super(),this.points=[],this.shapeHoles=[],this.plane=new gn(new E(0,0,-1)),this.subdivision=0,this.controlSnapDistance=4,this.pointIDs=0,this.isMesh2D=!1,this._roundness=0,this.isClosed=!1,this.useCubicForRoundedCorners=!0,this.uuid=mt.generateUUID(),this.needsUpdate=!1,this.roundedCurves=[],this._width=e,this._height=t}static createFromState(e,t,r){let i=new fr;return i.isClosed=e.isClosed,i.points=e.points.map(n=>Au.create(n.id,n.data)),typeof e.roundness=="number"&&(i.roundness=e.roundness),i.shapeHoles=e.shapeHoles.map(n=>fr.createFromState(n)),t!==void 0&&r!==void 0&&i.applySize(t,r),i.update(),i}get width(){return this._width}get height(){return this._height}get roundness(){return this._roundness}set roundness(e){if(this._roundness!==e){this._roundness=e;for(let t=0,r=this.points.length;t<r;t++)this.points[t].roundness=e;this.needsUpdate=!0}}getPointsIndexesByIds(e){return e.map(t=>this.getPointIndexById(t)).filter(t=>t>=0)}getPointIndexById(e){let t=this.points.length,r=this.points.findIndex(i=>i.uuid===e);if(r<0){let i=t;for(let n=0,s=this.shapeHoles.length;n<s;n++){let a=this.shapeHoles[n],o=a.points.length,l=a.getPointIndexById(e);if(l<0)i+=o;else return l+i}}return r}getLineIndexById(e){return this.getPointIndexById(e)}getBezierPoint(e){if(e<=this.points.length-1)return this.points[e];if(this.shapeHoles.length>0){let t=this.points.length;for(let r=0,i=this.shapeHoles.length;r<i;r++){let n=this.shapeHoles[r],s=e-t;if(s<=n.points.length-1)return n.points[s];t+=n.points.length}}throw new Error("This shape does not have a point for this index: "+e)}getBezierPointIndex(e){let t=this.points.indexOf(e);if(t>=0)return t;if(t=this.points.length,this.shapeHoles.length>0)for(let r=0,i=this.shapeHoles.length;r<i;r++){let n=this.shapeHoles[r],s=n.points.indexOf(e);if(s>=0)return t+s;t+=n.points.length}return-1}getAllPoints(){let e=[].concat(...this.shapeHoles.map(t=>t.points));return[...this.points,...e]}applySize(e,t){e===0&&(e=.001),t===0&&(t=.001),this._width=e,this._height=t}applyScale(e,t){let r=nw.set(e,t);for(let i=0,n=this.points.length;i<n;i++){let s=this.points[i];s.position.multiply(r),s.controls[0].position.multiply(r),s.controls[1].position.multiply(r)}for(let i=0,n=this.shapeHoles.length;i<n;i++)this.shapeHoles[i].applyScale(e,t);this._update()}createPoint(e,t=0,r=mt.generateUUID()){let i;e instanceof W?i=e:i=new W(e,t);let n=new Au(r,i);return n.roundness=this.roundness,n}addPoint(e){this.points.push(e),this.needsUpdate=!0}addPointAt(e,t){this.points.splice(t,0,e),this.needsUpdate=!0}getPointByUuid(e){for(let t=0,r=this.points.length;t<r;t++){let i=this.points[t];if(i.uuid===e)return i}for(let t=0,r=this.shapeHoles.length;t<r;t++){let i=this.shapeHoles[t].getPointByUuid(e);if(i)return i}}getFirstPoint(){return this.points[0]}getLastPoint(){return this.points[this.points.length-1]}removePoint(e){let t=this.points.indexOf(e);t>=0&&this.points.splice(t,1),this.needsUpdate=!0}removePointById(e){let t=this.points.find(r=>r.uuid===e);t&&this.removePoint(t)}update(){for(let e=0,t=this.shapeHoles.length;e<t;e++)this.shapeHoles[e].update();this._update()}extractShapePointsToBuffer(e,t=12,r=!1){this.subdivision=t,this.curveDivisions===void 0&&this.computeCurveDivisions(t);let i=r?this.roundedCurveDivisions:this.curveDivisions;return Rle(e,r?this.roundedCurves:this.curves,t,this.autoClose),i.reduce((n,s)=>n+s,0)+1}computeCurveDivisions(e=12){return this.curveDivisions=sD(this.points,e,!1),this.roundedCurveDivisions=sD(this.points,e,!0),this.curveDivisions}extractFilteredShapePointsToBuffer(e,t,r=12){return Ble(e,this.curves,t,r,this.autoClose).reduce((i,n)=>i+n,0)*2}extractShapePointsToFlatArray(e,t=12){return this.subdivision=t,this.curveDivisions===void 0&&this.computeCurveDivisions(t),zle(e,this.roundedCurves,t,this.autoClose)}getCurveIndexFromVertexId(e,t=!1){let r=0;this.curveDivisions===void 0&&this.computeCurveDivisions(this.subdivision);let i=t?this.roundedCurveDivisions:this.curveDivisions,n=0;t&&this.points[0].roundedCurveCorner!==void 0&&(n=Sc(this.points[0].roundedCurveCorner,this.subdivision)*.5);let s=e-n;s<0&&(s+=i.reduce((a,o)=>a+o,0));for(let a=0,o=i.length;a<o;a++){let l=i[a];if(s<r+l)return[a,(s-r+1)/l];r+=l}return[0,1]}getCurveT(e,t,r){let i=this.points[e],n=this.points[e>=this.points.length-1?0:e+1],s=this.curveDivisions,a=s[e];if(iD(i,n)){let l=i.position.distanceTo(n.position);return i.position.distanceTo(nw.set(r.x,r.y))/l}let o=0;for(let l=0;l<e;l++)o+=s[l];return(t-o)/a}dispose(){}_applyCurveForPoint(e,t){iD(t,e)?this.lineTo(e.position.x,e.position.y):this.bezierCurveTo(t.controls[1].position.x,t.controls[1].position.y,e.controls[0].position.x,e.controls[0].position.y,e.position.x,e.position.y);let r=this.curves[this.curves.length-1];e.curveBefore=r,t.curveAfter=r;let i=r.clone();e.roundedCurveBefore=i,t.roundedCurveAfter=i,e.roundedCurveCorner=void 0,this.roundedCurves.push(i)}_update(){if(this.curves=[],this.roundedCurves=[],!this.points.length)return;for(let t=0,r=this.points.length;t<r;t++){let i=this.points[t];if(t===0)this.moveTo(i.position.x,i.position.y);else{let n=this.points[t-1];this._applyCurveForPoint(i,n)}}let e=this.getLastPoint();if(e!=null&&e.curveAfter&&(e.curveAfter=void 0),this.isClosed){let t=this.points[0],r=this.points[this.points.length-1];this._applyCurveForPoint(t,r)}if(this.points.length>2){let t=0;for(let r=0,i=this.points.length;r<i;r++){let n=this.points[r],s=this.points[r-1]??this.points[this.points.length-1],a=this.points[r+1]??this.points[0],o=n.roundness,l=s&&a&&Ple(s,n,a);if(!n.controlsMoved()&&o>0&&!l){let c=n.curveBefore,u=n.curveAfter;if(c===void 0||u===void 0)continue;let h=n.roundedCurveBefore,d=n.roundedCurveAfter,p=c.getLength(),f=u.getLength(),m=Math.min(o,p*.499),g=Math.min(o,f*.499),v=Math.min(m,g),y=1-v/p,x=v/f,w=c.getPointAt(y,nw),b=u.getPointAt(x,kle);this._subSplitCurve(c,h,y,w,void 0),this._subSplitCurve(u,d,x,void 0,b);let _;if(this.useCubicForRoundedCorners){let A=bz(w,n.position,b)/2,S=Math.tan(A)*w.distanceTo(n.position),[C,M]=Dle(w,b,S,Nle,Fle),T=Lle(C,M,n.position),[P,D]=Ile(T,w,b,S,Ule,jle);_=new bs(w.clone(),P.clone(),D.clone(),b.clone())}else _=new Sl(w.clone(),n.position.clone(),b.clone());n.roundedCurveCorner=_,this.roundedCurves.splice(r+t,0,_),t++}}}}_subSplitCurve(e,t,r,i,n){if(e instanceof Ts)i!==void 0&&t.v2.copy(i),n!==void 0&&t.v1.copy(n);else{let s=e,a=t,o=s.getUtoTmapping(r,0),l=Ole(s.v0,s.v1,s.v2,s.v3,o);return i!==void 0&&(a.v0.set(l[0],l[1]),a.v1.set(l[2],l[3]),a.v2.set(l[4],l[5]),a.v3.set(l[6],l[7])),n!==void 0&&(a.v0.set(l[6],l[7]),a.v1.set(l[8],l[9]),a.v2.set(l[10],l[11]),a.v3.set(l[12],l[13])),a}return t}clone(){let e=new fr(this._width,this._height);return e.points=this.points.map(t=>t.clone()),e.isClosed=this.isClosed,e.roundness=this.roundness,e.isMesh2D=this.isMesh2D,e.shapeHoles=this.shapeHoles.map(t=>t.clone()),e}toJSON(){return{points:this.points.reduce((e,t)=>e.concat(t.toJSON()),[]),shapeHoles:this.shapeHoles.map(e=>e.toJSON()),isClosed:this.isClosed,roundness:this.roundness}}fromJSON(e){var r;this.points=[],this.pointIDs=0;let t=e.points.length/7;for(let i=0;i<t;i++){let n=i*7,s=e.points[n+0],a=e.points[n+1],o=e.points[n+2],l=e.points[n+3],c=e.points[n+4],u=e.points[n+5],h=e.points[n+6],d=new Au(mt.generateUUID(),new W(s,a));d.controls[0].position.set(o,l),d.controls[1].position.set(c,u),d.roundness=h,this.points.push(d)}return this.shapeHoles=(r=e.shapeHoles)!=null&&r.length?e.shapeHoles.map(i=>{let n=new fr;return n.fromJSON(i),n}):[],this.isClosed=e.isClosed,this._roundness=e.roundness,this._update(),this}fromShape(e){let t=(i,n)=>{n instanceof bs&&n.v3.equals(i.position)&&i.controls[0].position.copy(n.v2)},r=i=>{let n=[],s,a;for(s=0,a=i.length;s<a;s++)i[s]instanceof Sl&&(i[s]=Mle(i[s]));for(s=0,a=i.length;s<a;s++){let c=i[s],u=s>0?i[s-1]:null,h;c instanceof bs?(h=this.createPoint(c.v0),h.controls[1].position.copy(c.v1)):c instanceof Ts&&(h=this.createPoint(c.v1)),h!==void 0&&(u!==null&&t(h,u),n.push(h))}let o=i[i.length-1],l=!1;return o instanceof bs?o.v3.equals(n[0].position)&&(n[0].controls[0].position.copy(o.v2),l=!0):o instanceof Ts&&o.v2.equals(n[0].position)&&(l=!0),this.isClosed=l,n};return this.points=r(e.curves),e instanceof C0&&(this.shapeHoles=e.holes.map(i=>{let n=new fr;return n.fromShape(i),n})),this.update(),this}updatePoint(e,t){let r=this.getPointByUuid(e);r&&(t.position!==void 0&&r.position.fromArray(t.position),t.roundness!==void 0&&(r.roundness=t.roundness),t.areControlsDirectionsMirrored!==void 0&&(r.areControlsDirectionsMirrored=t.areControlsDirectionsMirrored),this.needsUpdate=!0)}updatePreviousControl(e,t){var i;let r=(i=this.getPointByUuid(e))==null?void 0:i.controls[0];r&&(t.position&&r.position.fromArray(t.position),this.needsUpdate=!0)}updateNextControl(e,t){var i;let r=(i=this.getPointByUuid(e))==null?void 0:i.controls[1];r&&(t.position&&r.position.fromArray(t.position),this.needsUpdate=!0)}},g_=Math.PI*2;function sw({x:e,y:t},r,i,n,s){return{x:e*r+n,y:t*i+s}}function Vle(e,t){let r=t===1.5707963267948966?.551915024494:t===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(t/4),i=Math.cos(e),n=Math.sin(e),s=Math.cos(e+t),a=Math.sin(e+t);return[{x:i-n*r,y:n+i*r},{x:s+a*r,y:a-s*r},{x:s,y:a}]}function aD(e,t,r,i){let n=e*i-t*r<0?-1:1,s=Math.min(1,Math.max(-1,e*r+t*i));return n*Math.acos(s)}function Hle(e,t,r,i,n,s,a,o,l,c){let u=Math.pow(n,2),h=Math.pow(s,2),d=Math.pow(a,2),p=Math.pow(o,2),f=u*h-u*p-h*d;f<0&&(f=0),f/=u*p+h*d,f=Math.sqrt(f)*(l===c?-1:1);let m=f*n/s*o,g=f*-s/n*a,v=m+(e+r)/2,y=g+(t+i)/2,x=(a-m)/n,w=(o-g)/s,b=(-a-m)/n,_=(-o-g)/s,A=aD(1,0,x,w),S=aD(x,w,b,_);return!c&&S>0&&(S-=g_),c&&S<0&&(S+=g_),{centerx:v,centery:y,ang1:A,ang2:S}}function Gle({px:e,py:t,cx:r,cy:i,rx:n,ry:s,largeArcFlag:a,sweepFlag:o}){let l=[];if(n===0||s===0)return[];let c=(e-r)/2,u=(t-i)/2;if(c===0&&u===0)return[];n=Math.abs(n),s=Math.abs(s);let h=Math.pow(c,2)/Math.pow(n,2)+Math.pow(u,2)/Math.pow(s,2);h>1&&(n*=Math.sqrt(h),s*=Math.sqrt(h));let d=Hle(e,t,r,i,n,s,c,u,a,o),{ang1:p,ang2:f}=d,{centerx:m,centery:g}=d,v=Math.abs(f)/(g_/4);Math.abs(1-v)<1e-7&&(v=1);let y=Math.max(Math.ceil(v),1);f/=y;for(let x=0;x<y;x++)l.push(Vle(p,f)),p+=f;return l.map(x=>{let{x:w,y:b}=sw(x[0],n,s,m,g),{x:_,y:A}=sw(x[1],n,s,m,g),{x:S,y:C}=sw(x[2],n,s,m,g);return{x1:w,y1:b,x2:_,y2:A,x:S,y:C}})}var Nt;(function(e){e[e.ODD=0]="ODD",e[e.NONZERO=1]="NONZERO",e[e.POSITIVE=2]="POSITIVE",e[e.NEGATIVE=3]="NEGATIVE",e[e.ABS_GEQ_TWO=4]="ABS_GEQ_TWO"})(Nt||(Nt={}));var Lr;(function(e){e[e.POLYGONS=0]="POLYGONS",e[e.CONNECTED_POLYGONS=1]="CONNECTED_POLYGONS",e[e.BOUNDARY_CONTOURS=2]="BOUNDARY_CONTOURS"})(Lr||(Lr={}));function tt(e,t){if(!e)throw t||"Assertion Failed!"}var Qe=function(){function e(){}return e.vertEq=function(t,r){return t.s===r.s&&t.t===r.t},e.vertLeq=function(t,r){return t.s<r.s||t.s===r.s&&t.t<=r.t},e.transLeq=function(t,r){return t.t<r.t||t.t===r.t&&t.s<=r.s},e.edgeGoesLeft=function(t){return e.vertLeq(t.Dst,t.Org)},e.edgeGoesRight=function(t){return e.vertLeq(t.Org,t.Dst)},e.vertL1dist=function(t,r){return Math.abs(t.s-r.s)+Math.abs(t.t-r.t)},e.edgeEval=function(t,r,i){tt(e.vertLeq(t,r)&&e.vertLeq(r,i));var n=r.s-t.s,s=i.s-r.s;return n+s>0?n<s?r.t-t.t+(t.t-i.t)*(n/(n+s)):r.t-i.t+(i.t-t.t)*(s/(n+s)):0},e.edgeSign=function(t,r,i){tt(e.vertLeq(t,r)&&e.vertLeq(r,i));var n=r.s-t.s,s=i.s-r.s;return n+s>0?(r.t-i.t)*n+(r.t-t.t)*s:0},e.transEval=function(t,r,i){tt(e.transLeq(t,r)&&e.transLeq(r,i));var n=r.t-t.t,s=i.t-r.t;return n+s>0?n<s?r.s-t.s+(t.s-i.s)*(n/(n+s)):r.s-i.s+(i.s-t.s)*(s/(n+s)):0},e.transSign=function(t,r,i){tt(e.transLeq(t,r)&&e.transLeq(r,i));var n=r.t-t.t,s=i.t-r.t;return n+s>0?(r.s-i.s)*n+(r.s-t.s)*s:0},e.vertCCW=function(t,r,i){return t.s*(r.t-i.t)+r.s*(i.t-t.t)+i.s*(t.t-r.t)>=0},e.interpolate=function(t,r,i,n){return t=t<0?0:t,i=i<0?0:i,t<=i?i===0?(r+n)/2:r+(n-r)*(t/(t+i)):n+(r-n)*(i/(t+i))},e.intersect=function(t,r,i,n,s){var a,o,l;e.vertLeq(t,r)||(l=t,t=r,r=l),e.vertLeq(i,n)||(l=i,i=n,n=l),e.vertLeq(t,i)||(l=t,t=i,i=l,l=r,r=n,n=l),e.vertLeq(i,r)?e.vertLeq(r,n)?(a=e.edgeEval(t,i,r),o=e.edgeEval(i,r,n),a+o<0&&(a=-a,o=-o),s.s=e.interpolate(a,i.s,o,r.s)):(a=e.edgeSign(t,i,r),o=-e.edgeSign(t,n,r),a+o<0&&(a=-a,o=-o),s.s=e.interpolate(a,i.s,o,n.s)):s.s=(i.s+r.s)/2,e.transLeq(t,r)||(l=t,t=r,r=l),e.transLeq(i,n)||(l=i,i=n,n=l),e.transLeq(t,i)||(l=t,t=i,i=l,l=r,r=n,n=l),e.transLeq(i,r)?e.transLeq(r,n)?(a=e.transEval(t,i,r),o=e.transEval(i,r,n),a+o<0&&(a=-a,o=-o),s.t=e.interpolate(a,i.t,o,r.t)):(a=e.transSign(t,i,r),o=-e.transSign(t,n,r),a+o<0&&(a=-a,o=-o),s.t=e.interpolate(a,i.t,o,n.t)):s.t=(i.t+r.t)/2},e}(),sp=function(){function e(){this.next=null,this.prev=null,this.anEdge=null,this.trail=null,this.n=0,this.marked=!1,this.inside=!1}return e}(),Bg=function(){function e(t){this.side=t,this.next=null,this.Org=null,this.Sym=null,this.Onext=null,this.Lnext=null,this.Lface=null,this.activeRegion=null,this.winding=0}return Object.defineProperty(e.prototype,"Rface",{get:function(){return this.Sym.Lface},set:function(t){this.Sym.Lface=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dst",{get:function(){return this.Sym.Org},set:function(t){this.Sym.Org=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Oprev",{get:function(){return this.Sym.Lnext},set:function(t){this.Sym.Lnext=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Lprev",{get:function(){return this.Onext.Sym},set:function(t){this.Onext.Sym=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dprev",{get:function(){return this.Lnext.Sym},set:function(t){this.Lnext.Sym=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Rprev",{get:function(){return this.Sym.Onext},set:function(t){this.Sym.Onext=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dnext",{get:function(){return this.Sym.Onext.Sym},set:function(t){this.Sym.Onext.Sym=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Rnext",{get:function(){return this.Sym.Lnext.Sym},set:function(t){this.Sym.Lnext.Sym=t},enumerable:!0,configurable:!0}),e}(),Ih=function(){function e(){this.next=null,this.prev=null,this.anEdge=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=0,this.n=0,this.idx=0}return e}(),oD=function(){function e(){var t=new Ih,r=new sp,i=new Bg(0),n=new Bg(1);t.next=t.prev=t,t.anEdge=null,r.next=r.prev=r,i.next=i,i.Sym=n,n.next=n,n.Sym=i,this.vHead=t,this.fHead=r,this.eHead=i,this.eHeadSym=n}return e.prototype.makeEdge_=function(t){var r=new Bg(0),i=new Bg(1);t.Sym.side<t.side&&(t=t.Sym);var n=t.Sym.next;return i.next=n,n.Sym.next=r,r.next=t,t.Sym.next=i,r.Sym=i,r.Onext=r,r.Lnext=i,r.Org=null,r.Lface=null,r.winding=0,r.activeRegion=null,i.Sym=r,i.Onext=i,i.Lnext=r,i.Org=null,i.Lface=null,i.winding=0,i.activeRegion=null,r},e.prototype.splice_=function(t,r){var i=t.Onext,n=r.Onext;i.Sym.Lnext=r,n.Sym.Lnext=t,t.Onext=n,r.Onext=i},e.prototype.makeVertex_=function(t,r,i){var n=t;tt(n,"Vertex can't be null!");var s=i.prev;n.prev=s,s.next=n,n.next=i,i.prev=n,n.anEdge=r;var a=r;do a.Org=n,a=a.Onext;while(a!==r)},e.prototype.makeFace_=function(t,r,i){var n=t;tt(n,"Face can't be null");var s=i.prev;n.prev=s,s.next=n,n.next=i,i.prev=n,n.anEdge=r,n.trail=null,n.marked=!1,n.inside=i.inside;var a=r;do a.Lface=n,a=a.Lnext;while(a!==r)},e.prototype.killEdge_=function(t){t.Sym.side<t.side&&(t=t.Sym);var r=t.next,i=t.Sym.next;r.Sym.next=i,i.Sym.next=r},e.prototype.killVertex_=function(t,r){var i=t.anEdge,n=i;do n.Org=r,n=n.Onext;while(n!==i);var s=t.prev,a=t.next;a.prev=s,s.next=a},e.prototype.killFace_=function(t,r){var i=t.anEdge,n=i;do n.Lface=r,n=n.Lnext;while(n!==i);var s=t.prev,a=t.next;a.prev=s,s.next=a},e.prototype.makeEdge=function(){var t=new Ih,r=new Ih,i=new sp,n=this.makeEdge_(this.eHead);return this.makeVertex_(t,n,this.vHead),this.makeVertex_(r,n.Sym,this.vHead),this.makeFace_(i,n,this.fHead),n},e.prototype.splice=function(t,r){var i=!1,n=!1;if(t!==r){if(r.Org!==t.Org&&(n=!0,this.killVertex_(r.Org,t.Org)),r.Lface!==t.Lface&&(i=!0,this.killFace_(r.Lface,t.Lface)),this.splice_(r,t),!n){var s=new Ih;this.makeVertex_(s,r,t.Org),t.Org.anEdge=t}if(!i){var a=new sp;this.makeFace_(a,r,t.Lface),t.Lface.anEdge=t}}},e.prototype.delete=function(t){var r=t.Sym,i=!1;if(t.Lface!==t.Rface&&(i=!0,this.killFace_(t.Lface,t.Rface)),t.Onext===t)this.killVertex_(t.Org,null);else if(t.Rface.anEdge=t.Oprev,t.Org.anEdge=t.Onext,this.splice_(t,t.Oprev),!i){var n=new sp;this.makeFace_(n,t,t.Lface)}r.Onext===r?(this.killVertex_(r.Org,null),this.killFace_(r.Lface,null)):(t.Lface.anEdge=r.Oprev,r.Org.anEdge=r.Onext,this.splice_(r,r.Oprev)),this.killEdge_(t)},e.prototype.addEdgeVertex=function(t){var r=this.makeEdge_(t),i=r.Sym;this.splice_(r,t.Lnext),r.Org=t.Dst;var n=new Ih;return this.makeVertex_(n,i,r.Org),r.Lface=i.Lface=t.Lface,r},e.prototype.splitEdge=function(t){var r=this.addEdgeVertex(t),i=r.Sym;return this.splice_(t.Sym,t.Sym.Oprev),this.splice_(t.Sym,i),t.Dst=i.Org,i.Dst.anEdge=i.Sym,i.Rface=t.Rface,i.winding=t.winding,i.Sym.winding=t.Sym.winding,i.idx=t.idx,i.Sym.idx=t.Sym.idx,i},e.prototype.connect=function(t,r){var i=!1,n=this.makeEdge_(t),s=n.Sym;if(r.Lface!==t.Lface&&(i=!0,this.killFace_(r.Lface,t.Lface)),this.splice_(n,t.Lnext),this.splice_(s,r),n.Org=t.Dst,s.Org=r.Org,n.Lface=s.Lface=t.Lface,t.Lface.anEdge=s,!i){var a=new sp;this.makeFace_(a,n,t.Lface)}return n},e.prototype.zapFace=function(t){var r=t.anEdge,i,n,s,a,o;n=r.Lnext;do i=n,n=i.Lnext,i.Lface=null,i.Rface===null&&(i.Onext===i?this.killVertex_(i.Org,null):(i.Org.anEdge=i.Onext,this.splice_(i,i.Oprev)),s=i.Sym,s.Onext===s?this.killVertex_(s.Org,null):(s.Org.anEdge=s.Onext,this.splice_(s,s.Oprev)),this.killEdge_(i));while(i!=r);a=t.prev,o=t.next,o.prev=a,a.next=o},e.prototype.countFaceVerts_=function(t){var r=t.anEdge,i=0;do i++,r=r.Lnext;while(r!==t.anEdge);return i},e.prototype.mergeConvexFaces=function(t){var r,i,n,s,a,o,l;for(r=this.fHead.next;r!==this.fHead;r=r.next)if(r.inside)for(i=r.anEdge,a=i.Org;n=i.Lnext,s=i.Sym,s&&s.Lface&&s.Lface.inside&&(o=this.countFaceVerts_(r),l=this.countFaceVerts_(s.Lface),o+l-2<=t&&Qe.vertCCW(i.Lprev.Org,i.Org,s.Lnext.Lnext.Org)&&Qe.vertCCW(s.Lprev.Org,s.Org,i.Lnext.Lnext.Org)&&(n=s.Lnext,this.delete(s),i=null,s=null)),!(i&&i.Lnext.Org===a);)i=n;return!0},e.prototype.check=function(){var t=this.fHead,r=this.vHead,i=this.eHead,n,s,a,o,l,c;for(s=t,s=t;(n=s.next)!==t;s=n){tt(n.prev===s),l=n.anEdge;do tt(l.Sym!==l),tt(l.Sym.Sym===l),tt(l.Lnext.Onext.Sym===l),tt(l.Onext.Sym.Lnext===l),tt(l.Lface===n),l=l.Lnext;while(l!==n.anEdge)}for(tt(n.prev===s&&n.anEdge===null),o=r,o=r;(a=o.next)!==r;o=a){tt(a.prev===o),l=a.anEdge;do tt(l.Sym!==l),tt(l.Sym.Sym===l),tt(l.Lnext.Onext.Sym===l),tt(l.Onext.Sym.Lnext===l),tt(l.Org===a),l=l.Onext;while(l!==a.anEdge)}for(tt(a.prev===o&&a.anEdge===null),c=i,c=i;(l=c.next)!==i;c=l)tt(l.Sym.next===c.Sym),tt(l.Sym!==l),tt(l.Sym.Sym===l),tt(l.Org!==null),tt(l.Dst!==null),tt(l.Lnext.Onext.Sym===l),tt(l.Onext.Sym.Lnext===l);tt(l.Sym.next===c.Sym&&l.Sym===this.eHeadSym&&l.Sym.Sym===l&&l.Org===null&&l.Dst===null&&l.Lface===null&&l.Rface===null)},e}(),lD=function(){function e(){this.handle=null}return e}(),cD=function(){function e(){this.key=null,this.node=0}return e}(),Wle=function(){function e(t,r){this.leq=r,this.max=0,this.nodes=[],this.handles=[],this.initialized=!1,this.freeList=0,this.size=0,this.max=t,this.nodes=[],this.handles=[];for(var i=0;i<t+1;i++)this.nodes[i]=new lD,this.handles[i]=new cD;this.initialized=!1,this.nodes[1].handle=1,this.handles[1].key=null}return e.prototype.floatDown_=function(t){var r=this.nodes,i=this.handles,n,s,a;for(n=r[t].handle;;){if(a=t<<1,a<this.size&&this.leq(i[r[a+1].handle].key,i[r[a].handle].key)&&++a,tt(a<=this.max),s=r[a].handle,a>this.size||this.leq(i[n].key,i[s].key)){r[t].handle=n,i[n].node=t;break}r[t].handle=s,i[s].node=t,t=a}},e.prototype.floatUp_=function(t){var r=this.nodes,i=this.handles,n,s,a;for(n=r[t].handle;;){if(a=t>>1,s=r[a].handle,a===0||this.leq(i[s].key,i[n].key)){r[t].handle=n,i[n].node=t;break}r[t].handle=s,i[s].node=t,t=a}},e.prototype.init=function(){for(var t=this.size;t>=1;--t)this.floatDown_(t);this.initialized=!0},e.prototype.min=function(){return this.handles[this.nodes[1].handle].key},e.prototype.insert=function(t){var r,i;if(r=++this.size,r*2>this.max){this.max*=2;var n,s;for(s=this.nodes.length,this.nodes.length=this.max+1,n=s;n<this.nodes.length;n++)this.nodes[n]=new lD;for(s=this.handles.length,this.handles.length=this.max+1,n=s;n<this.handles.length;n++)this.handles[n]=new cD}return this.freeList===0?i=r:(i=this.freeList,this.freeList=this.handles[i].node),this.nodes[r].handle=i,this.handles[i].node=r,this.handles[i].key=t,this.initialized&&this.floatUp_(r),i},e.prototype.extractMin=function(){var t=this.nodes,r=this.handles,i=t[1].handle,n=r[i].key;return this.size>0&&(t[1].handle=t[this.size].handle,r[t[1].handle].node=1,r[i].key=null,r[i].node=this.freeList,this.freeList=i,--this.size,this.size>0&&this.floatDown_(1)),n},e.prototype.delete=function(t){var r=this.nodes,i=this.handles,n;tt(t>=1&&t<=this.max&&i[t].key!==null),n=i[t].node,r[n].handle=r[this.size].handle,i[r[n].handle].node=n,--this.size,n<=this.size&&(n<=1||this.leq(i[r[n>>1].handle].key,i[r[n].handle].key)?this.floatDown_(n):this.floatUp_(n)),i[t].key=null,i[t].node=this.freeList,this.freeList=t},e}(),aw=function(){function e(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1}return e}(),hD=function(){function e(){this.key=null,this.next=null,this.prev=null}return e}(),qle=function(){function e(t,r){this.frame=t,this.leq=r,this.head=new hD,this.head.next=this.head,this.head.prev=this.head}return e.prototype.min=function(){return this.head.next},e.prototype.max=function(){return this.head.prev},e.prototype.insert=function(t){return this.insertBefore(this.head,t)},e.prototype.search=function(t){var r=this.head;do r=r.next;while(r.key!==null&&!this.leq(this.frame,t,r.key));return r},e.prototype.insertBefore=function(t,r){do t=t.prev;while(t.key!==null&&!this.leq(this.frame,t.key,r));var i=new hD;return i.key=r,i.next=t.next,t.next.prev=i,i.prev=t,t.next=i,i},e.prototype.delete=function(t){t.next.prev=t.prev,t.prev.next=t.next},e}(),Xle=function(){function e(){}return e.regionBelow=function(t){return t.nodeUp.prev.key},e.regionAbove=function(t){return t.nodeUp.next.key},e.debugEvent=function(t){},e.addWinding=function(t,r){t.winding+=r.winding,t.Sym.winding+=r.Sym.winding},e.edgeLeq=function(t,r,i){var n=t.event,s=r.eUp,a=i.eUp;if(s.Dst===n)return a.Dst===n?Qe.vertLeq(s.Org,a.Org)?Qe.edgeSign(a.Dst,s.Org,a.Org)<=0:Qe.edgeSign(s.Dst,a.Org,s.Org)>=0:Qe.edgeSign(a.Dst,n,a.Org)<=0;if(a.Dst===n)return Qe.edgeSign(s.Dst,n,s.Org)>=0;var o=Qe.edgeEval(s.Dst,n,s.Org),l=Qe.edgeEval(a.Dst,n,a.Org);return o>=l},e.deleteRegion=function(t,r){r.fixUpperEdge&&tt(r.eUp.winding===0),r.eUp.activeRegion=null,t.dict.delete(r.nodeUp)},e.fixUpperEdge=function(t,r,i){tt(r.fixUpperEdge),t.mesh.delete(r.eUp),r.fixUpperEdge=!1,r.eUp=i,i.activeRegion=r},e.topLeftRegion=function(t,r){var i=r.eUp.Org,n;do r=e.regionAbove(r);while(r.eUp.Org===i);if(r.fixUpperEdge){if(n=t.mesh.connect(e.regionBelow(r).eUp.Sym,r.eUp.Lnext),n===null)return null;e.fixUpperEdge(t,r,n),r=e.regionAbove(r)}return r},e.topRightRegion=function(t){var r=t.eUp.Dst;do t=e.regionAbove(t);while(t.eUp.Dst===r);return t},e.addRegionBelow=function(t,r,i){var n=new aw;return n.eUp=i,n.nodeUp=t.dict.insertBefore(r.nodeUp,n),n.fixUpperEdge=!1,n.sentinel=!1,n.dirty=!1,i.activeRegion=n,n},e.isWindingInside=function(t,r){switch(t.windingRule){case Nt.ODD:return(r&1)!==0;case Nt.NONZERO:return r!==0;case Nt.POSITIVE:return r>0;case Nt.NEGATIVE:return r<0;case Nt.ABS_GEQ_TWO:return r>=2||r<=-2}throw new Error("Invalid winding rulle")},e.computeWinding=function(t,r){r.windingNumber=e.regionAbove(r).windingNumber+r.eUp.winding,r.inside=e.isWindingInside(t,r.windingNumber)},e.finishRegion=function(t,r){var i=r.eUp,n=i.Lface;n.inside=r.inside,n.anEdge=i,e.deleteRegion(t,r)},e.finishLeftRegions=function(t,r,i){for(var n,s=null,a=r,o=r.eUp;a!==i;){if(a.fixUpperEdge=!1,s=e.regionBelow(a),n=s.eUp,n.Org!=o.Org){if(!s.fixUpperEdge){e.finishRegion(t,a);break}n=t.mesh.connect(o.Lprev,n.Sym),e.fixUpperEdge(t,s,n)}o.Onext!==n&&(t.mesh.splice(n.Oprev,n),t.mesh.splice(o,n)),e.finishRegion(t,a),o=s.eUp,a=s}return o},e.addRightEdges=function(t,r,i,n,s,a){var o,l,c,u,h=!0;c=i;do tt(Qe.vertLeq(c.Org,c.Dst)),e.addRegionBelow(t,r,c.Sym),c=c.Onext;while(c!==n);for(s===null&&(s=e.regionBelow(r).eUp.Rprev),l=r,u=s;o=e.regionBelow(l),c=o.eUp.Sym,c.Org===u.Org;)c.Onext!==u&&(t.mesh.splice(c.Oprev,c),t.mesh.splice(u.Oprev,c)),o.windingNumber=l.windingNumber-c.winding,o.inside=e.isWindingInside(t,o.windingNumber),l.dirty=!0,!h&&e.checkForRightSplice(t,l)&&(e.addWinding(c,u),e.deleteRegion(t,l),t.mesh.delete(u)),h=!1,l=o,u=c;l.dirty=!0,tt(l.windingNumber-c.winding===o.windingNumber),a&&e.walkDirtyRegions(t,l)},e.spliceMergeVertices=function(t,r,i){t.mesh.splice(r,i)},e.vertexWeights=function(t,r,i){var n=Qe.vertL1dist(r,t),s=Qe.vertL1dist(i,t),a=.5*s/(n+s),o=.5*n/(n+s);t.coords[0]+=a*r.coords[0]+o*i.coords[0],t.coords[1]+=a*r.coords[1]+o*i.coords[1],t.coords[2]+=a*r.coords[2]+o*i.coords[2]},e.getIntersectData=function(t,r,i,n,s,a){r.coords[0]=r.coords[1]=r.coords[2]=0,r.idx=-1,e.vertexWeights(r,i,n),e.vertexWeights(r,s,a)},e.checkForRightSplice=function(t,r){var i=e.regionBelow(r),n=r.eUp,s=i.eUp;if(Qe.vertLeq(n.Org,s.Org)){if(Qe.edgeSign(s.Dst,n.Org,s.Org)>0)return!1;Qe.vertEq(n.Org,s.Org)?n.Org!==s.Org&&(t.pq.delete(n.Org.pqHandle),e.spliceMergeVertices(t,s.Oprev,n)):(t.mesh.splitEdge(s.Sym),t.mesh.splice(n,s.Oprev),r.dirty=i.dirty=!0)}else{if(Qe.edgeSign(n.Dst,s.Org,n.Org)<0)return!1;e.regionAbove(r).dirty=r.dirty=!0,t.mesh.splitEdge(n.Sym),t.mesh.splice(s.Oprev,n)}return!0},e.checkForLeftSplice=function(t,r){var i=e.regionBelow(r),n=r.eUp,s=i.eUp,a;if(tt(!Qe.vertEq(n.Dst,s.Dst)),Qe.vertLeq(n.Dst,s.Dst)){if(Qe.edgeSign(n.Dst,s.Dst,n.Org)<0)return!1;e.regionAbove(r).dirty=r.dirty=!0,a=t.mesh.splitEdge(n),t.mesh.splice(s.Sym,a),a.Lface.inside=r.inside}else{if(Qe.edgeSign(s.Dst,n.Dst,s.Org)>0)return!1;r.dirty=i.dirty=!0,a=t.mesh.splitEdge(s),t.mesh.splice(n.Lnext,s.Sym),a.Rface.inside=r.inside}return!0},e.checkForIntersect=function(t,r){var i=e.regionBelow(r),n=r.eUp,s=i.eUp,a=n.Org,o=s.Org,l=n.Dst,c=s.Dst,u,h,d=new Ih,p,f;if(tt(!Qe.vertEq(c,l)),tt(Qe.edgeSign(l,t.event,a)<=0),tt(Qe.edgeSign(c,t.event,o)>=0),tt(a!==t.event&&o!==t.event),tt(!r.fixUpperEdge&&!i.fixUpperEdge),a===o||(u=Math.min(a.t,l.t),h=Math.max(o.t,c.t),u>h))return!1;if(Qe.vertLeq(a,o)){if(Qe.edgeSign(c,a,o)>0)return!1}else if(Qe.edgeSign(l,o,a)<0)return!1;return e.debugEvent(t),Qe.intersect(l,a,c,o,d),tt(Math.min(a.t,l.t)<=d.t),tt(d.t<=Math.max(o.t,c.t)),tt(Math.min(c.s,l.s)<=d.s),tt(d.s<=Math.max(o.s,a.s)),Qe.vertLeq(d,t.event)&&(d.s=t.event.s,d.t=t.event.t),p=Qe.vertLeq(a,o)?a:o,Qe.vertLeq(p,d)&&(d.s=p.s,d.t=p.t),Qe.vertEq(d,a)||Qe.vertEq(d,o)?(e.checkForRightSplice(t,r),!1):!Qe.vertEq(l,t.event)&&Qe.edgeSign(l,t.event,d)>=0||!Qe.vertEq(c,t.event)&&Qe.edgeSign(c,t.event,d)<=0?c===t.event?(t.mesh.splitEdge(n.Sym),t.mesh.splice(s.Sym,n),r=e.topLeftRegion(t,r),n=e.regionBelow(r).eUp,e.finishLeftRegions(t,e.regionBelow(r),i),e.addRightEdges(t,r,n.Oprev,n,n,!0),!0):l===t.event?(t.mesh.splitEdge(s.Sym),t.mesh.splice(n.Lnext,s.Oprev),i=r,r=e.topRightRegion(r),f=e.regionBelow(r).eUp.Rprev,i.eUp=s.Oprev,s=e.finishLeftRegions(t,i,null),e.addRightEdges(t,r,s.Onext,n.Rprev,f,!0),!0):(Qe.edgeSign(l,t.event,d)>=0&&(e.regionAbove(r).dirty=r.dirty=!0,t.mesh.splitEdge(n.Sym),n.Org.s=t.event.s,n.Org.t=t.event.t),Qe.edgeSign(c,t.event,d)<=0&&(r.dirty=i.dirty=!0,t.mesh.splitEdge(s.Sym),s.Org.s=t.event.s,s.Org.t=t.event.t),!1):(t.mesh.splitEdge(n.Sym),t.mesh.splitEdge(s.Sym),t.mesh.splice(s.Oprev,n),n.Org.s=d.s,n.Org.t=d.t,n.Org.pqHandle=t.pq.insert(n.Org),e.getIntersectData(t,n.Org,a,l,o,c),e.regionAbove(r).dirty=r.dirty=i.dirty=!0,!1)},e.walkDirtyRegions=function(t,r){for(var i=e.regionBelow(r),n,s;;){for(;i.dirty;)r=i,i=e.regionBelow(i);if(!r.dirty&&(i=r,r=e.regionAbove(r),r===null||!r.dirty))return;if(r.dirty=!1,n=r.eUp,s=i.eUp,n.Dst!==s.Dst&&e.checkForLeftSplice(t,r)&&(i.fixUpperEdge?(e.deleteRegion(t,i),t.mesh.delete(s),i=e.regionBelow(r),s=i.eUp):r.fixUpperEdge&&(e.deleteRegion(t,r),t.mesh.delete(n),r=e.regionAbove(i),n=r.eUp)),n.Org!==s.Org)if(n.Dst!==s.Dst&&!r.fixUpperEdge&&!i.fixUpperEdge&&(n.Dst===t.event||s.Dst===t.event)){if(e.checkForIntersect(t,r))return}else e.checkForRightSplice(t,r);n.Org===s.Org&&n.Dst===s.Dst&&(e.addWinding(s,n),e.deleteRegion(t,r),t.mesh.delete(n),r=e.regionAbove(i))}},e.connectRightVertex=function(t,r,i){var n,s=i.Onext,a=e.regionBelow(r),o=r.eUp,l=a.eUp,c=!1;if(o.Dst!==l.Dst&&e.checkForIntersect(t,r),Qe.vertEq(o.Org,t.event)&&(t.mesh.splice(s.Oprev,o),r=e.topLeftRegion(t,r),s=e.regionBelow(r).eUp,e.finishLeftRegions(t,e.regionBelow(r),a),c=!0),Qe.vertEq(l.Org,t.event)&&(t.mesh.splice(i,l.Oprev),i=e.finishLeftRegions(t,a,null),c=!0),c){e.addRightEdges(t,r,i.Onext,s,s,!0);return}Qe.vertLeq(l.Org,o.Org)?n=l.Oprev:n=o,n=t.mesh.connect(i.Lprev,n),e.addRightEdges(t,r,n,n.Onext,n.Onext,!1),n.Sym.activeRegion.fixUpperEdge=!0,e.walkDirtyRegions(t,r)},e.connectLeftDegenerate=function(t,r,i){var n,s,a,o,l;if(n=r.eUp,Qe.vertEq(n.Org,i)){tt(!1),e.spliceMergeVertices(t,n,i.anEdge);return}if(!Qe.vertEq(n.Dst,i)){t.mesh.splitEdge(n.Sym),r.fixUpperEdge&&(t.mesh.delete(n.Onext),r.fixUpperEdge=!1),t.mesh.splice(i.anEdge,n),e.sweepEvent(t,i);return}tt(!1),r=e.topRightRegion(r),l=e.regionBelow(r),a=l.eUp.Sym,s=o=a.Onext,l.fixUpperEdge&&(tt(s!==a),e.deleteRegion(t,l),t.mesh.delete(a),a=s.Oprev),t.mesh.splice(i.anEdge,a),Qe.edgeGoesLeft(s)||(s=null),e.addRightEdges(t,r,a.Onext,o,s,!0)},e.connectLeftVertex=function(t,r){var i,n,s,a,o,l,c=new aw;if(c.eUp=r.anEdge.Sym,i=t.dict.search(c).key,n=e.regionBelow(i),!!n){if(a=i.eUp,o=n.eUp,Qe.edgeSign(a.Dst,r,a.Org)===0){e.connectLeftDegenerate(t,i,r);return}if(s=Qe.vertLeq(o.Dst,a.Dst)?i:n,i.inside||s.fixUpperEdge){if(s===i)l=t.mesh.connect(r.anEdge.Sym,a.Lnext);else{var u=t.mesh.connect(o.Dnext,r.anEdge);l=u.Sym}s.fixUpperEdge?e.fixUpperEdge(t,s,l):e.computeWinding(t,e.addRegionBelow(t,i,l)),e.sweepEvent(t,r)}else e.addRightEdges(t,i,r.anEdge,r.anEdge,null,!0)}},e.sweepEvent=function(t,r){t.event=r,e.debugEvent(t);for(var i=r.anEdge;i.activeRegion===null;)if(i=i.Onext,i===r.anEdge){e.connectLeftVertex(t,r);return}var n=e.topLeftRegion(t,i.activeRegion);tt(n!==null);var s=e.regionBelow(n),a=s.eUp,o=e.finishLeftRegions(t,s,null);o.Onext===a?e.connectRightVertex(t,n,o):e.addRightEdges(t,n,o.Onext,a,a,!0)},e.addSentinel=function(t,r,i,n){var s=new aw,a=t.mesh.makeEdge();a.Org.s=i,a.Org.t=n,a.Dst.s=r,a.Dst.t=n,t.event=a.Dst,s.eUp=a,s.windingNumber=0,s.inside=!1,s.fixUpperEdge=!1,s.sentinel=!0,s.dirty=!1,s.nodeUp=t.dict.insert(s)},e.initEdgeDict=function(t){t.dict=new qle(t,e.edgeLeq);var r=t.bmax[0]-t.bmin[0],i=t.bmax[1]-t.bmin[1],n=t.bmin[0]-r,s=t.bmax[0]+r,a=t.bmin[1]-i,o=t.bmax[1]+i;e.addSentinel(t,n,s,a),e.addSentinel(t,n,s,o)},e.doneEdgeDict=function(t){for(var r,i=0;(r=t.dict.min().key)!==null;)r.sentinel||(tt(r.fixUpperEdge),tt(++i===1)),tt(r.windingNumber===0),e.deleteRegion(t,r)},e.removeDegenerateEdges=function(t){var r,i,n,s=t.mesh.eHead;for(r=s.next;r!==s;r=i)i=r.next,n=r.Lnext,Qe.vertEq(r.Org,r.Dst)&&r.Lnext.Lnext!==r&&(e.spliceMergeVertices(t,n,r),t.mesh.delete(r),r=n,n=r.Lnext),n.Lnext===r&&(n!==r&&((n===i||n===i.Sym)&&(i=i.next),t.mesh.delete(n)),(r===i||r===i.Sym)&&(i=i.next),t.mesh.delete(r))},e.initPriorityQ=function(t){var r,i,n,s=0;for(n=t.mesh.vHead,i=n.next;i!==n;i=i.next)s++;for(s+=8,r=t.pq=new Wle(s,Qe.vertLeq),n=t.mesh.vHead,i=n.next;i!==n;i=i.next)i.pqHandle=r.insert(i);return i!==n?!1:(r.init(),!0)},e.donePriorityQ=function(t){t.pq=null},e.removeDegenerateFaces=function(t,r){var i,n,s;for(i=r.fHead.next;i!==r.fHead;i=n)n=i.next,s=i.anEdge,tt(s.Lnext!==s),s.Lnext.Lnext===s&&(e.addWinding(s.Onext,s),t.mesh.delete(s));return!0},e.computeInterior=function(t,r){r===void 0&&(r=!0);var i,n;if(e.removeDegenerateEdges(t),!e.initPriorityQ(t))return!1;for(e.initEdgeDict(t);(i=t.pq.extractMin())!==null;){for(;n=t.pq.min(),!(n===null||!Qe.vertEq(n,i));)n=t.pq.extractMin(),e.spliceMergeVertices(t,i.anEdge,n.anEdge);e.sweepEvent(t,i)}return t.event=t.dict.min().key.eUp.Org,e.debugEvent(t),e.doneEdgeDict(t),e.donePriorityQ(t),e.removeDegenerateFaces(t,t.mesh)?(r&&t.mesh.check(),!0):!1},e}(),Yle=function(){function e(){this.mesh=new oD,this.normal=[0,0,0],this.sUnit=[0,0,0],this.tUnit=[0,0,0],this.bmin=[0,0],this.bmax=[0,0],this.windingRule=Nt.ODD,this.dict=null,this.pq=null,this.event=null,this.vertexIndexCounter=0,this.vertices=[],this.vertexIndices=[],this.vertexCount=0,this.elements=[],this.elementCount=0}return e.prototype.dot_=function(t,r){return t[0]*r[0]+t[1]*r[1]+t[2]*r[2]},e.prototype.normalize_=function(t){var r=t[0]*t[0]+t[1]*t[1]+t[2]*t[2];if(!r)throw"Zero-size vector!";r=Math.sqrt(r),t[0]/=r,t[1]/=r,t[2]/=r},e.prototype.longAxis_=function(t){var r=0;return Math.abs(t[1])>Math.abs(t[0])&&(r=1),Math.abs(t[2])>Math.abs(t[r])&&(r=2),r},e.prototype.computeNormal_=function(t){var r,i,n,s,a,o,l=[0,0,0],c=[0,0,0],u=[0,0,0],h=[0,0,0],d=[0,0,0],p=[null,null,null],f=[null,null,null],m=this.mesh.vHead;r=m.next;for(var g=0;g<3;++g)s=r.coords[g],c[g]=s,f[g]=r,l[g]=s,p[g]=r;for(r=m.next;r!==m;r=r.next)for(var v=0;v<3;++v)s=r.coords[v],s<c[v]&&(c[v]=s,f[v]=r),s>l[v]&&(l[v]=s,p[v]=r);var y=0;if(l[1]-c[1]>l[0]-c[0]&&(y=1),l[2]-c[2]>l[y]-c[y]&&(y=2),c[y]>=l[y]){t[0]=0,t[1]=0,t[2]=1;return}for(o=0,i=f[y],n=p[y],u[0]=i.coords[0]-n.coords[0],u[1]=i.coords[1]-n.coords[1],u[2]=i.coords[2]-n.coords[2],r=m.next;r!==m;r=r.next)h[0]=r.coords[0]-n.coords[0],h[1]=r.coords[1]-n.coords[1],h[2]=r.coords[2]-n.coords[2],d[0]=u[1]*h[2]-u[2]*h[1],d[1]=u[2]*h[0]-u[0]*h[2],d[2]=u[0]*h[1]-u[1]*h[0],a=d[0]*d[0]+d[1]*d[1]+d[2]*d[2],a>o&&(o=a,t[0]=d[0],t[1]=d[1],t[2]=d[2]);o<=0&&(t[0]=t[1]=t[2]=0,t[this.longAxis_(u)]=1)},e.prototype.checkOrientation_=function(){for(var t=this.mesh.fHead,r,i=this.mesh.vHead,n,s=0,a=t.next;a!==t;a=a.next)if(n=a.anEdge,!(n.winding<=0))do s+=(n.Org.s-n.Dst.s)*(n.Org.t+n.Dst.t),n=n.Lnext;while(n!==a.anEdge);if(s<0){for(r=i.next;r!==i;r=r.next)r.t=-r.t;this.tUnit[0]=-this.tUnit[0],this.tUnit[1]=-this.tUnit[1],this.tUnit[2]=-this.tUnit[2]}},e.prototype.projectPolygon_=function(){var t=this.mesh.vHead,r=[0,0,0],i,n,s=!1;r[0]=this.normal[0],r[1]=this.normal[1],r[2]=this.normal[2],!r[0]&&!r[1]&&!r[2]&&(this.computeNormal_(r),s=!0),i=this.sUnit,n=this.tUnit;var a=this.longAxis_(r);i[a]=0,i[(a+1)%3]=1,i[(a+2)%3]=0,n[a]=0,n[(a+1)%3]=0,n[(a+2)%3]=r[a]>0?1:-1;for(var o=t.next;o!==t;o=o.next)o.s=this.dot_(o.coords,i),o.t=this.dot_(o.coords,n);s&&this.checkOrientation_();for(var l=!0,c=t.next;c!==t;c=c.next)l?(this.bmin[0]=this.bmax[0]=c.s,this.bmin[1]=this.bmax[1]=c.t,l=!1):(c.s<this.bmin[0]&&(this.bmin[0]=c.s),c.s>this.bmax[0]&&(this.bmax[0]=c.s),c.t<this.bmin[1]&&(this.bmin[1]=c.t),c.t>this.bmax[1]&&(this.bmax[1]=c.t))},e.prototype.addWinding_=function(t,r){t.winding+=r.winding,t.Sym.winding+=r.Sym.winding},e.prototype.tessellateMonoRegion_=function(t,r){var i,n;if(i=r.anEdge,!(i.Lnext!==i&&i.Lnext.Lnext!==i))throw"Mono region invalid";for(;Qe.vertLeq(i.Dst,i.Org);i=i.Lprev);for(;Qe.vertLeq(i.Org,i.Dst);i=i.Lnext);n=i.Lprev;for(var s=void 0;i.Lnext!==n;)if(Qe.vertLeq(i.Dst,n.Org)){for(;n.Lnext!==i&&(Qe.edgeGoesLeft(n.Lnext)||Qe.edgeSign(n.Org,n.Dst,n.Lnext.Dst)<=0);)s=t.connect(n.Lnext,n),n=s.Sym;n=n.Lprev}else{for(;n.Lnext!==i&&(Qe.edgeGoesRight(i.Lprev)||Qe.edgeSign(i.Dst,i.Org,i.Lprev.Org)>=0);)s=t.connect(i,i.Lprev),i=s.Sym;i=i.Lnext}if(n.Lnext===i)throw"Mono region invalid";for(;n.Lnext.Lnext!==i;)s=t.connect(n.Lnext,n),n=s.Sym;return!0},e.prototype.tessellateInterior_=function(t){for(var r,i=t.fHead.next;i!==t.fHead;i=r)if(r=i.next,i.inside&&!this.tessellateMonoRegion_(t,i))return!1;return!0},e.prototype.discardExterior_=function(t){for(var r,i=t.fHead.next;i!==t.fHead;i=r)r=i.next,i.inside||t.zapFace(i)},e.prototype.setWindingNumber_=function(t,r,i){for(var n,s=t.eHead.next;s!==t.eHead;s=n)n=s.next,s.Rface.inside!==s.Lface.inside?s.winding=s.Lface.inside?r:-r:i?t.delete(s):s.winding=0},e.prototype.getNeighbourFace_=function(t){return!t.Rface||!t.Rface.inside?-1:t.Rface.n},e.prototype.outputPolymesh_=function(t,r,i,n){var s,a=0,o=0,l;i>3&&t.mergeConvexFaces(i);for(var c=t.vHead.next;c!==t.vHead;c=c.next)c.n=-1;for(var u=t.fHead.next;u!==t.fHead;u=u.next)if(u.n=-1,!!u.inside){s=u.anEdge,l=0;do{var c=s.Org;c.n===-1&&(c.n=o,o++),l++,s=s.Lnext}while(s!==u.anEdge);if(l>i)throw"Face vertex greater that support polygon";u.n=a,++a}this.elementCount=a,r===Lr.CONNECTED_POLYGONS&&(a*=2),this.elements=[],this.elements.length=a*i,this.vertexCount=o,this.vertices=[],this.vertices.length=o*n,this.vertexIndices=[],this.vertexIndices.length=o;for(var c=t.vHead.next;c!==t.vHead;c=c.next)if(c.n!==-1){var h=c.n*n;this.vertices[h+0]=c.coords[0],this.vertices[h+1]=c.coords[1],n>2&&(this.vertices[h+2]=c.coords[2]),this.vertexIndices[c.n]=c.idx}for(var d=0,u=t.fHead.next;u!==t.fHead;u=u.next)if(u.inside){s=u.anEdge,l=0;do{var c=s.Org;this.elements[d++]=c.n,l++,s=s.Lnext}while(s!==u.anEdge);for(var p=l;p<i;++p)this.elements[d++]=-1;if(r===Lr.CONNECTED_POLYGONS){s=u.anEdge;do this.elements[d++]=this.getNeighbourFace_(s),s=s.Lnext;while(s!==u.anEdge);for(var f=l;f<i;++f)this.elements[d++]=-1}}},e.prototype.outputContours_=function(t,r){var i,n,s=0,a=0;this.vertexCount=0,this.elementCount=0;for(var o=t.fHead.next;o!==t.fHead;o=o.next)if(o.inside){n=i=o.anEdge;do this.vertexCount++,i=i.Lnext;while(i!==n);this.elementCount++}this.elements=[],this.elements.length=this.elementCount*2,this.vertices=[],this.vertices.length=this.vertexCount*r,this.vertexIndices=[],this.vertexIndices.length=this.vertexCount;var l=0,c=0,u=0;s=0;for(var o=t.fHead.next;o!==t.fHead;o=o.next)if(o.inside){a=0,n=i=o.anEdge;do this.vertices[l++]=i.Org.coords[0],this.vertices[l++]=i.Org.coords[1],r>2&&(this.vertices[l++]=i.Org.coords[2]),this.vertexIndices[c++]=this.vertexIdCallback?this.vertexIdCallback(i):i.Org.idx,a++,i=i.Lnext;while(i!==n);this.elements[u++]=s,this.elements[u++]=a,s+=a}},e.prototype.addContour=function(t,r){this.mesh===null&&(this.mesh=new oD),t<2&&(t=2),t>3&&(t=3);for(var i=null,n=0;n<r.length;n+=t)i===null?(i=this.mesh.makeEdge(),this.mesh.splice(i,i.Sym)):(this.mesh.splitEdge(i),i=i.Lnext),i.Org.coords[0]=r[n+0],i.Org.coords[1]=r[n+1],t>2?i.Org.coords[2]=r[n+2]:i.Org.coords[2]=0,i.Org.idx=this.vertexIndexCounter++,this.edgeCreateCallback&&this.edgeCreateCallback(i),i.winding=1,i.Sym.winding=-1},e.prototype.tesselate=function(t,r,i,n,s,a){if(t===void 0&&(t=Nt.ODD),r===void 0&&(r=Lr.POLYGONS),a===void 0&&(a=!0),this.vertices=[],this.elements=[],this.vertexIndices=[],this.vertexIndexCounter=0,s&&(this.normal[0]=s[0],this.normal[1]=s[1],this.normal[2]=s[2]),this.windingRule=t,n<2&&(n=2),n>3&&(n=3),!this.mesh)return!1;this.projectPolygon_(),Xle.computeInterior(this,a);var o=this.mesh;return r===Lr.BOUNDARY_CONTOURS?this.setWindingNumber_(o,1,!0):this.tessellateInterior_(o),a&&o.check(),r===Lr.BOUNDARY_CONTOURS?this.outputContours_(o,n):this.outputPolymesh_(o,r,i,n),!0},e}();function el(e){var t=e.windingRule,r=t===void 0?Nt.ODD:t,i=e.elementType,n=i===void 0?Lr.POLYGONS:i,s=e.polySize,a=s===void 0?3:s,o=e.vertexSize,l=o===void 0?2:o,c=e.normal,u=c===void 0?[0,0,1]:c,h=e.contours,d=h===void 0?[]:h,p=e.strict,f=p===void 0?!0:p,m=e.debug,g=m===void 0?!1:m;if(!d&&f)throw new Error("Contours can't be empty");if(d){var v=new Yle;e.edgeCreateCallback&&(v.edgeCreateCallback=e.edgeCreateCallback),e.vertexIdCallback&&(v.vertexIdCallback=e.vertexIdCallback);for(var y=0;y<d.length;y++)v.addContour(l||2,d[y]);return v.tesselate(r,n,a,l,u,f),{vertices:v.vertices,vertexIndices:v.vertexIndices,vertexCount:v.vertexCount,elements:v.elements,elementCount:v.elementCount,mesh:g?v.mesh:void 0}}}Nt.ODD;Nt.NONZERO;Nt.POSITIVE;Nt.NEGATIVE;Nt.ABS_GEQ_TWO;Lr.POLYGONS;Lr.CONNECTED_POLYGONS;Lr.BOUNDARY_CONTOURS;var v_=class{constructor(e=256,t=!1){this.capacity=e,this.size=0,this.debug=t,this.debug&&console.log(`allocating with cap ${e}`);let r=e*v_.eSize;this.buffer=new ArrayBuffer(r);let i=Float32Array.BYTES_PER_ELEMENT,n=0;this.positions=new Float32Array(this.buffer,n*i,3*e),n+=3*e,this.normals=new Float32Array(this.buffer,n*i,3*e),n+=3*e,this.uvs=new Float32Array(this.buffer,n*i,2*e)}realloc(e,t=!1){if(e<this.size)throw Error("cannot shrink buffer");if(e<=this.capacity&&!t)return;this.debug&&console.log(`resizing from ${this.capacity} → ${e}`);let r=e*v_.eSize,i=new ArrayBuffer(r),n=Float32Array.BYTES_PER_ELEMENT,s=0,a=new Float32Array(i,s*n,3*e);s+=3*e;let o=new Float32Array(i,s*n,3*e);s+=3*e;let l=new Float32Array(i,s*n,2*e);t?(a.set(this.positions.subarray(0,this.size*3)),o.set(this.normals.subarray(0,this.size*3)),l.set(this.uvs.subarray(0,this.size*2))):(a.set(this.positions),o.set(this.normals),l.set(this.uvs)),this.buffer=i,this.positions=a,this.normals=o,this.uvs=l,this.capacity=e}get(e=1){let t=this.size+e;if(t>this.capacity){let i=this.capacity;for(;t>i;)i*=2;this.realloc(i)}let r=this.size;return this.size=t,r}reserve(e){let t=this.size+e;t>this.capacity&&this.realloc(t)}shrink(){this.debug&&console.log(`shrinking ${this.capacity} → ${this.size}`),this.realloc(this.size,!0)}},_z=v_;_z.eSize=(3+3+2)*Float32Array.BYTES_PER_ELEMENT;var Qle=ld(SG()),xA={vertices:[160,160,-160,160,-160,-160,160,-160],vertexIndices:[1,0,3,2],vertexCount:4,elements:[0,4],elementCount:1,mesh:void 0},Sz={vertices:[],vertexIndices:[],vertexCount:0,elements:[],elementCount:0,mesh:void 0},Az={vertices:[-160,160,160,-160,160,160,-160,-160],vertexIndices:[1,3,0,2],vertexCount:4,elements:[0,1,2,1,0,3],elementCount:2,mesh:void 0},ow=(e,t)=>([r,i])=>(i<r&&(i+=t),(e>=r?e:e+t)<=i),wA=class extends it{constructor(e,t,r=0,i=12,n=3,s=Nt.ODD,a=!1){super(),this.forPathBevel=a,this.type="ShapeGeometry",this.vertexCache={},this._shape=e,this._depth=t,this._curveSegments=i,this._bevelSegmentsInput=n;let o=this._shape.extractShapePointsToFlatArray([],i),l=this._shape.shapeHoles.map(C=>{let M=C.extractShapePointsToFlatArray([],i),T=[];for(let P=M.length-1;P>=1;P-=2){let D=M[P-1],I=M[P-0];T.push(D,I)}return T}),c=[],u=[];for(let C=0;C<o.length;C+=2)u.push([o[C],o[C+1]]);c.push(u);for(let C=0;C<l.length;C++){let M=l[C],T=[];for(let P=0;P<M.length;P+=2)T.push([M[P],M[P+1]]);c.push(T)}let h=c[0].length?(0,Qle.default)(c).distance:r;r<=0?(this._bevel=0,this._bevelSegments=0):(this._bevel=Math.min(r,h,t/2),this._bevelSegments=Math.floor(n));let d;try{d=el({windingRule:s,elementType:Lr.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[o]})}catch{d=xA}let p;try{p=el({windingRule:Nt.ODD,elementType:Lr.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...l]})}catch{p=Sz}if(!d)throw new Error("error generating geometry");let f=d.elementCount;if(p){d.elementCount+=p.elementCount;for(let C=0;C<p.elements.length;C++){let M=p.elements[C],T=C%2===0?d.vertexCount:0;d.elements.push(M+T)}for(let C=0;C<p.vertexIndices.length;C++){let M=p.vertexIndices[C],T=d.vertexCount;d.vertexIndices.push(M+T)}for(let C=0;C<p.vertices.length;C++){let M=p.vertices[C];d.vertices.push(M)}}let m=1/0,g=-1/0,v=1/0,y=-1/0;for(let C=0,M=d.vertexCount;C<M;C++){let T=C*2,P=d.vertices[T+0],D=d.vertices[T+1];P<m&&(m=P),P>g&&(g=P),D<v&&(v=D),D>y&&(y=D)}this._minX=m,this._minY=v,this._width=g-m,this._height=y-v,this._buffer=new _z(this._computeBufferEstimatedSize(d));let x=[],w=[];for(let C=d.elementCount-1;C>=0;C--){let M=C>=f,T=C*2,P=d.elements[T+0],D=d.elements[T+1],I=P+D,B={start:P,count:D,normals:[],continuous:[],concave:[]},X=P,H=I-1,R=P+1,q=this._shape.roundedCurves.length;do{let U=X-P,Y=d.vertices[H*2+0],V=d.vertices[H*2+1],ie=d.vertices[X*2+0],J=d.vertices[X*2+1],ee=d.vertices[R*2+0],se=d.vertices[R*2+1],ce=ie-Y,ue=J-V,ye=Math.sqrt(ce*ce+ue*ue);ce/=ye,ue/=ye;let Re=ie-ee,Se=J-se,ke=Math.sqrt(Re*Re+Se*Se);Re/=ke,Se/=ke,B.normals[U*2+0]=-Se,B.normals[U*2+1]=Re,B.concave[U]=ce*Se-ue*Re>0;let Oe=d.vertexIndices[X];if(Array.isArray(Oe))B.continuous[U]=!1;else{let[Ce,Ae]=this._shape.getCurveIndexFromVertexId(Oe-1,!0);if(Ae>0&&Ae<1)B.continuous[U]=!0;else{let je=Ae===1?Ce+1:Ce-1;je=(je+q)%q;let We=Ae===1?0:1,k=this._shape.roundedCurves[Ce].getTangent(Ae),O=this._shape.roundedCurves[je].getTangent(We);B.continuous[U]=k.dot(O)>.95}}M&&(B.normals[U*2+0]*=-1,B.normals[U*2+1]*=-1),[H,X,R]=[X,R,R+1],R>=I&&(R-=D)}while(R!==P+1);let F=[];F.push({bevelI:0,angle:0,size:0,boundary:{vertices:d.vertices.slice(P*2,I*2),vertexCount:D,vertexIndices:new Array(D).fill(!0).map((U,Y)=>[Y,Y]),elements:[0,D],elementCount:1,mesh:null},reverseMap:[],insetPoints:d.vertices.slice(P*2,I*2)});let N=0;for(let U=1;U<=this._bevelSegments;U++){let Y=U/this._bevelSegments*Math.PI/2,V=(1-Math.cos(Y))*this._bevel,ie=[],J=[],ee=0;for(let ce=0;ce<D;ce++){let ue=ce*2,ye=(ce-1+D)%D*2,Re=d.vertices[B.start*2+ue+0],Se=d.vertices[B.start*2+ue+1],ke=-B.normals[ye+0]*V,Oe=-B.normals[ye+1]*V,Ce=-B.normals[ue+0]*V,Ae=-B.normals[ue+1]*V;if(B.concave[ce]||!B.concave[ce]&&M){let je=Math.atan2(Oe,ke),We=Math.atan2(Ae,Ce);We>je&&(We-=Math.PI*2);let k=We-je;if(B.continuous[ce]||M){let O=je+k/2,oe=Math.cos(O)*V,be=Math.sin(O)*V;ie[2*ee+0]=Re+oe*(M?-1:1),ie[2*ee+1]=Se+be*(M?-1:1),J[ee]=ce,ee++}else{let O=Math.max(1,Math.floor(i/4*Math.abs(k)/Math.PI));for(let oe=0;oe<=O;oe++){let be=je+k*(oe/O),xe=Math.cos(be)*V,Te=Math.sin(be)*V;ie[2*ee+0]=Re+xe,ie[2*ee+1]=Se+Te,J[ee]=ce,ee++}}}else ie[2*ee+0]=Re+ke,ie[2*ee+1]=Se+Oe,J[ee]=ce,ee++,ie[2*ee+0]=Re,ie[2*ee+1]=Se,J[ee]=ce,ee++,ie[2*ee+0]=Re+Ce,ie[2*ee+1]=Se+Ae,J[ee]=ce,ee++}let se=el({windingRule:Nt.POSITIVE,elementType:Lr.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[ie],edgeCreateCallback:ce=>{let ue=ce.Org.idx,ye=J[ue],Re=J[(ue+1)%J.length];ce.idx=[ye,Re],ce.Sym.idx=[Re,ye]},vertexIdCallback:ce=>{let ue=ce.Lprev.idx;return[ue?ue[1]:0,ce.idx?ce.idx[0]:0]}});if(!se)throw console.log("Error"),new Error(`error generating bevel geometry for ${U}'th loop`);if(!se.vertexCount){let ce=(U-1)/this._bevelSegments*Math.PI/2;N=(1-Math.sin(ce))*this._bevel;break}for(let ce=0;ce<se.vertexIndices.length;ce++){let[ue,ye]=se.vertexIndices[ce];if(ue===ye)continue;let Re=ye;ye<ue&&(Re+=D);for(let Se=ue;Se<Re;Se++){let ke=Se%D,Oe=(Se+1)%D;if(!B.continuous[ke]||!B.continuous[Oe]){se.vertexIndices[ce]=[ue,ke],se.vertexIndices.splice(ce+1,0,[Oe,ye]),se.vertices.splice((ce+1)*2,0,se.vertices[ce*2],se.vertices[ce*2+1]);break}}}F.push({bevelI:U,angle:Y,size:V,boundary:se,reverseMap:J,insetPoints:ie})}let j=(U,Y,V)=>{let ie=0,J=U.boundary.vertexIndices.length;for(;ie<J&&V(U.boundary.vertexIndices[Y]);)Y=(Y+1)%J,ie++;return ie},K=x.length;for(let U=1;U<F.length;U++){let Y=F[U-1],V=F[U],ie=Y.boundary.vertexIndices.length,J=V.boundary.vertexIndices.length;if(!ie||!J)break;let ee=B.concave.length,se=0,ce=ow(se,D);for(;!Y.boundary.vertexIndices.filter(ce).length||!V.boundary.vertexIndices.filter(ce).length;)se++,ce=ow(se,D);let ue=Y.boundary.vertexIndices.findIndex(ce),ye=V.boundary.vertexIndices.findIndex(ce);do ue=(ue+1)%ie;while(ce(Y.boundary.vertexIndices[ue]));do ye=(ye+1)%J;while(ce(V.boundary.vertexIndices[ye]));se=(se+1)%D;let Re=se,Se=0,ke=this._buildBevelVert(B,Y,(ue-1+ie)%ie,void 0,Se),Oe=this._buildBevelVert(B,V,(ye-1+J)%J,void 0,Se),Ce=ke,Ae=Oe,je,We,k=!1;do{Se=(se||ee)/ee,ce=ow(se,D);let O=j(Y,ue,ce),oe=j(V,ye,ce),be=k;if(k=!1,O&&!oe){for(let xe=0;xe<O;xe++)je=this._buildBevelVert(B,Y,(ue+xe)%ie,xe/(O-1),Se),x.push(Ce.topN,je.topP,Ae.topN),a===!1&&x.push(je.bottomP,Ce.bottomN,Ae.bottomN),Ce=je;k=!0}else if(!O&&oe)for(let xe=0;xe<oe;xe++)We=this._buildBevelVert(B,V,(ye+xe)%J,xe/(oe-1),Se),x.push(Ae.topN,Ce.topP,We.topP),a===!1&&x.push(Ce.bottomP,Ae.bottomN,We.bottomP),Ae=We;else if(O&&oe)if(je=this._buildBevelVert(B,Y,ue,0,Se),We=this._buildBevelVert(B,V,ye,0,Se),be?(x.push(Ce.topN,We.topP,Ae.topN),x.push(Ce.topN,je.topP,We.topP),a===!1&&(x.push(We.bottomP,Ce.bottomN,Ae.bottomN),x.push(We.bottomP,je.bottomP,Ce.bottomN))):(x.push(Ae.topN,Ce.topN,je.topP),x.push(Ae.topN,je.topP,We.topP),a===!1&&(x.push(je.bottomP,Ce.bottomN,Ae.bottomN),x.push(je.bottomP,Ae.bottomN,We.bottomP))),Ce=je,Ae=We,O===oe)for(let xe=1;xe<O;xe++)je=this._buildBevelVert(B,Y,(ue+xe)%ie,xe/(O-1),Se),We=this._buildBevelVert(B,V,(ye+xe)%J,xe/(oe-1),Se),x.push(Ce.topN,je.topP,Ae.topN),x.push(Ae.topN,je.topP,We.topP),a===!1&&(x.push(je.bottomP,Ce.bottomN,Ae.bottomN),x.push(je.bottomP,Ae.bottomN,We.bottomP)),Ce=je,Ae=We;else if(O>oe){let xe=O/oe,Te=0;for(let Ge=1;Ge<O;Ge++)je=this._buildBevelVert(B,Y,(ue+Ge)%ie,Ge/(O-1),Se),x.push(Ce.topN,je.topP,Ae.topN),a===!1&&x.push(je.bottomP,Ce.bottomN,Ae.bottomN),Ce=je,Ge>(Te+1)*xe&&(Te++,We=this._buildBevelVert(B,V,(ye+Te)%J,Te/(oe-1),Se),x.push(Ae.topN,je.topP,We.topP),a===!1&&x.push(je.bottomP,Ae.bottomN,We.bottomP),Ae=We)}else{let xe=oe/O,Te=0;for(let Ge=1;Ge<oe;Ge++)We=this._buildBevelVert(B,V,(ye+Ge)%J,Ge/(oe-1),Se),x.push(Ae.topN,je.topP,We.topP),a===!1&&x.push(je.bottomP,Ae.bottomN,We.bottomP),Ae=We,Ge>(Te+1)*xe&&(Te++,je=this._buildBevelVert(B,Y,(ue+Te)%ie,Te/(O-1),Se),x.push(Ce.topN,je.topP,Ae.topN),a===!1&&x.push(je.bottomP,Ce.bottomN,Ae.bottomN),Ce=je)}ue=(ue+O)%ie,ye=(ye+oe)%J,se=(se+1)%ee}while(se!==Re)}if(a===!1&&this._depth>this._bevel*2&&this._buildWall(F,B,x),M){let U=[];for(let Y=x.length-1;Y>=K+2;Y-=3){let V=x[Y-2],ie=x[Y-1],J=x[Y-0];U.push(J,ie,V)}x.splice(K,x.length-K,...U)}if(M){let U=[];for(let Y=F[F.length-1].boundary.vertices.length-1;Y>=1;Y-=2){let V=F[F.length-1].boundary.vertices[Y-1],ie=F[F.length-1].boundary.vertices[Y-0];U.push(V,ie)}w.push(U)}if(!M){let U=F[F.length-1],Y;try{Y=el({windingRule:F.length>1?Nt.POSITIVE:Nt.ODD,elementType:Lr.POLYGONS,vertexSize:2,strict:!0,contours:[U.insetPoints,...w]})}catch{Y=Az}if(!Y)throw new Error("Error generating geometry for surface");l.length===0&&this._bevel<h&&Object.assign(this,{useNgonForTopBottomFaceDuringBake:!0});for(let V=0;V<Y.elementCount*3;V+=3){let ie=this._buildSurfaceVert(Y,Y.elements[V+0],N),J=this._buildSurfaceVert(Y,Y.elements[V+1],N),ee=this._buildSurfaceVert(Y,Y.elements[V+2],N);x.push(ie.top,J.top,ee.top),a===!1&&x.push(ee.bottom,J.bottom,ie.bottom)}}this.vertexCache={}}this._buffer.shrink();let b=new nt(Uint32Array.from(x),1),_=new nt(this._buffer.positions,3),A=new nt(this._buffer.normals,3),S=new nt(this._buffer.uvs,2);_.needsUpdate=!0,A.needsUpdate=!0,S.needsUpdate=!0,b.needsUpdate=!0,this.setAttribute("position",_),this.setAttribute("normal",A),this.setAttribute("uv",S),this.setIndex(b)}_computeBufferEstimatedSize(e){return e.vertexCount*2*(2+this._bevelSegments)}_buildWall(e,t,r){let i=e[0];for(let n=0,s=i.boundary.vertexCount;n<s;n++){let a=this._buildBevelVert(t,i,n),o=this._buildBevelVert(t,i,(n+1)%s);r.push(o.topP,a.topN,a.bottomN),r.push(o.topP,a.bottomN,o.bottomP)}}_buildSurfaceVert(e,t,r){let i=t.toString();if(i in this.vertexCache)return this.vertexCache[i];let n=e.vertices[t*2+0],s=e.vertices[t*2+1],a=(n-this._minX)/this._width,o=(s-this._minY)/this._height;this.forPathBevel&&(o=1);let l=this._buffer.get(this.forPathBevel?1:2),c=l*3,u=l*2,h={top:l+0,bottom:l+1};return this._buffer.positions[c+0]=n,this._buffer.positions[c+1]=s,this._buffer.positions[c+2]=this.forPathBevel?this._bevel:this._depth-r,this._buffer.normals[c+0]=0,this._buffer.normals[c+1]=0,this._buffer.normals[c+2]=1,this._buffer.uvs[u+0]=a,this._buffer.uvs[u+1]=o,this.forPathBevel===!1&&(this._buffer.positions[c+3]=n,this._buffer.positions[c+4]=s,this._buffer.positions[c+5]=r,this._buffer.normals[c+3]=0,this._buffer.normals[c+4]=0,this._buffer.normals[c+5]=-1,this._buffer.uvs[u+2]=a,this._buffer.uvs[u+3]=o),this.vertexCache[i]=h,h}_buildBevelVert(e,t,r,i=1,n){let s=`${t.bevelI}:${r}`;if(s in this.vertexCache&&n!==0&&n!==1&&(!n||n===this.vertexCache[s].pathBevelUCoord))return this.vertexCache[s];let[a,o]=t.boundary.vertexIndices[r],l,c,u,h;a!==o?(c=a,l=o,h=!1,u=e.continuous[c]&&e.continuous[l]):(l=a,c=(l-1+e.count)%e.count,h=e.concave[l]&&t.bevelI>0,u=e.continuous[l]||h);let d=Math.cos(t.angle),p=Math.sin(t.angle),f=r*2,m=l*2,g=c*2,v=t.boundary.vertices[f+0],y=t.boundary.vertices[f+1],x=(1-p)*this._bevel,w=(v-this._minX)/this._width,b=(y-this._minY)/this._height;this.forPathBevel&&(n!==void 0&&(w=n),b=1);let _=e.normals[m+0],A=e.normals[m+1],S=e.normals[g+0],C=e.normals[g+1];if(h){let I=S-_,B=C-A;_=_+I*(1-i),A=A+B*(1-i);let X=Math.sqrt(_*_+A*A);_/=X,A/=X}let M=this.forPathBevel?this._buffer.get(u?1:2):this._buffer.get(u?2:4),T=M*3,P=M*2,D={i:r,fi:l,topP:M+0,topN:M+0,bottomP:M+1,bottomN:M+1,pathBevelUCoord:n};return this._buffer.positions[T+0]=v,this._buffer.positions[T+1]=y,this._buffer.positions[T+2]=(this.forPathBevel?this._bevel:this._depth)-x,this._buffer.normals[T+0]=_*d,this._buffer.normals[T+1]=A*d,this._buffer.normals[T+2]=p,this._buffer.uvs[P+0]=w,this._buffer.uvs[P+1]=b,this.forPathBevel===!1&&(this._buffer.positions[T+3]=v,this._buffer.positions[T+4]=y,this._buffer.positions[T+5]=x,this._buffer.normals[T+3]=_*d,this._buffer.normals[T+4]=A*d,this._buffer.normals[T+5]=-p,this._buffer.uvs[P+2]=b,this._buffer.uvs[P+3]=w),u||(this.forPathBevel?(M+=1,T+=3,P+=2):(M+=2,T+=6,P+=4),D.topP=M+0,D.bottomP=M+1,this._buffer.positions[T+0]=v,this._buffer.positions[T+1]=y,this._buffer.positions[T+2]=(this.forPathBevel?this._bevel:this._depth)-x,this._buffer.normals[T+0]=S*d,this._buffer.normals[T+1]=C*d,this._buffer.normals[T+2]=p,this._buffer.uvs[P+0]=w,this._buffer.uvs[P+1]=b,this.forPathBevel===!1&&(this._buffer.positions[T+3]=v,this._buffer.positions[T+4]=y,this._buffer.positions[T+5]=x,this._buffer.normals[T+3]=S*d,this._buffer.normals[T+4]=C*d,this._buffer.normals[T+5]=-p,this._buffer.uvs[P+2]=b,this._buffer.uvs[P+3]=w)),this.vertexCache[s]=D,D}clone(){let e=new wA(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return e.userData=Qy(this.userData),e}},Cz=class extends it{constructor(e,t=12,r={}){super(),this.type="ShapeGeometry",this.windingRule=Nt.ODD,this.elementType=Lr.POLYGONS,this.polySize=3,this.vertexSize=2,this.strict=!0,this._shape=e,this._curveSegments=t,this._triangulationOptions=Object.assign({windingRule:Nt.ODD,elementType:Lr.POLYGONS,polySize:3,vertexSize:2,strict:!0},r);let i=this._shape.extractShapePointsToFlatArray([],this._curveSegments),n=this._shape.shapeHoles.map(d=>d.extractShapePointsToFlatArray([],this._curveSegments)),s,a=!0,o=!0,l,c;for(let d=0,p=i.length/2;d<p;d++){let f=d*2,m=i[f+0],g=i[f+1];if(l!==void 0&&m!==l&&(a=!1),c!==void 0&&g!==c&&(o=!1),l=m,c=g,!a&&!o)break}if(!a&&!o)try{s=el({contours:[i,...n],windingRule:this._triangulationOptions.windingRule,elementType:this._triangulationOptions.elementType,polySize:this._triangulationOptions.polySize,vertexSize:this._triangulationOptions.vertexSize,strict:this._triangulationOptions.strict})}catch{s=xA}let u=(s==null?void 0:s.vertexCount)??1,h=(s==null?void 0:s.elementCount)??1;if(this._positionAttribute=new nt(new Float32Array(u*3),3),this._normalAttribute=new nt(new Float32Array(u*3),3),this._uvAttribute=new nt(new Float32Array(u*2),2),this._indexAttribute=new nt(new Uint32Array(h*3),1),s){let d=1/0,p=-1/0,f=1/0,m=-1/0;for(let y=0,x=u;y<x;y++){let w=y*2,b=s.vertices[w+0],_=s.vertices[w+1];b<d&&(d=b),b>p&&(p=b),_<f&&(f=_),_>m&&(m=_)}let g=p-d,v=m-f;for(let y=0,x=u;y<x;y++){let w=y*2,b=s.vertices[w+0],_=s.vertices[w+1],A=(b-d)/g,S=(_-f)/v;this._positionAttribute.setXYZ(y,b,_,0),this._normalAttribute.setXYZ(y,0,0,1),this._uvAttribute.setXY(y,A,S)}for(let y=0,x=h;y<x;y++){let w=y*3,b=s.elements[w+0],_=s.elements[w+1],A=s.elements[w+2];this._indexAttribute.setX(w+0,b),this._indexAttribute.setX(w+1,_),this._indexAttribute.setX(w+2,A)}}this.setAttribute("position",this._positionAttribute),this.setAttribute("normal",this._normalAttribute),this.setAttribute("uv",this._uvAttribute),this.setIndex(this._indexAttribute),this.setDrawRange(0,((s==null?void 0:s.elementCount)??1)*3)}clone(){let e=new Cz(this._shape,this._curveSegments);return e.userData=Qy(this.userData),e}},Mz=class extends wA{constructor(e,t,r=0,i=12,n=3,s=Nt.ODD){super(e,t,r,i,n,s),this.type="ShapeGeometry"}_computeBufferEstimatedSize(e){return e.vertexCount*2*(2+this._bevelSegments)}_buildWall(e,t,r){let i=e[0];for(let n=0,s=i.boundary.vertexCount;n<s;n++){let a=this._buildBevelVert(t,i,n),o=this._buildBevelVert(t,i,(n+1)%s);r.push(o.topP,a.topN,a.bottomN),r.push(o.topP,a.bottomN,o.bottomP)}}clone(){let e=new Mz(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return e.userData=Qy(this.userData),e}},Xc=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var c,u;let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,subdivisions:40,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3,windingRule:Nt.ODD},e.parameters),i=Math.abs(r.width),n=Math.abs(r.height??r.width),s=Math.abs(r.depth??0),a=e.shape??(t==null?void 0:t.shape),o=(a==null?void 0:a.roundness)??r.roundness;a!==void 0&&(a instanceof fr?(a.width!==i||a.height!==n)&&a.applySize(i,n):a=new fr(i,n).fromJSON(a),((c=e.parameters)==null?void 0:c.roundness)!==void 0&&((u=e.parameters)==null?void 0:u.roundness)>0&&a.update());let l=a??new fr(i,n);return{parameters:Object.assign(r,{width:i,height:n,depth:s,roundness:o}),shape:l}}static build(e){let{depth:t,extrudeBevelSize:r,extrudeBevelSegments:i,subdivisions:n,roundness:s,windingRule:a}=e.parameters;e.shape.roundness=s;let o;return t<=0?o=new Cz(e.shape,n,{windingRule:a}):o=new Mz(e.shape,t,r,n,i,a),Object.assign(o,{userData:{...e,type:"VectorGeometry"}})}},Ez=Math.PI*2,bA=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,spikes:64,angle:360,innerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters);return{shape:e.shape&&e.shape instanceof fr?e.shape:new fr,parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??0)})}}static build(e){let{width:t,height:r,spikes:i,angle:n,innerRadius:s,depth:a,extrudeBevelSize:o,extrudeBevelSegments:l}=e.parameters,c=e.shape,u=t*.5,h=r*.5,d=Kle(c,u,h,n*Math.PI/180,i,s);c.isClosed=!0,c.update();let p=Xc.create({shape:c,parameters:{subdivisions:d,depth:a,extrudeBevelSize:o,extrudeBevelSegments:l}});return Object.assign(p,{userData:{...e,type:"EllipseGeometry"}})}};function Kle(e,t,r,i,n,s){if(i>=Ez)return n>30||n%4===0?($le(e,t,r,s),Math.round(n/4)):uD(e,i,n,t,r,s);i=Math.max(i,.001);let a={x:0,y:r},o=i+Math.PI*.5,l={x:Math.cos(o)*t,y:Math.sin(o)*r},c=Gle({px:a.x,py:a.y,cx:l.x,cy:l.y,rx:t,ry:r,largeArcFlag:i>Math.PI,sweepFlag:!0});return n>30||n%c.length===0?Zle(e,a.x,a.y,c,n,t,r,s):uD(e,i,n,t,r,s)}function Zle(e,t,r,i,n,s,a,o){let l=Math.round(n/i.length);e.addPoint(Cu(t,r));for(let c=0,u=i.length;c<u;c++){let h=i[c],d=e.points[c],p=Cu(h.x,h.y);d.controls[1].position.set(h.x1,h.y1),p.controls[0].position.set(h.x2,h.y2),e.addPoint(p)}return o>0?Tz(e,s,a,o):e.addPoint(Cu(0,0)),l}function uD(e,t,r,i,n,s){let a=-t/r;for(let o=0;o<=r;o++){let l=a*o,c=Math.sin(l)*i,u=Math.cos(l)*n;e.addPoint(Cu(c,u))}return t<Ez?s>0?Tz(e,i,n,s):e.addPoint(Cu(0,0)):(e.removePoint(e.points[e.points.length-1]),s>0&&Pz(e,i,n,s)),1}function $le(e,t,r,i=0,n=0,s=0){let a=.5522847498,o=t*a,l=r*a;e.addPoint(zg(n-t,s,n-t,s-l,n-t,s+l)),e.addPoint(zg(n,s+r,n-o,s+r,n+o,s+r)),e.addPoint(zg(n+t,s,n+t,s+l,n+t,s-l)),e.addPoint(zg(n,s-r,n+o,s-r,n-o,s-r)),i>0&&Pz(e,t,r,i)}function Cu(e,t){return new Au(mt.generateUUID(),new W(e,t))}function zg(e,t,r,i,n,s){let a=Cu(e,t);return a.controls[0].position.set(r,i),a.controls[1].position.set(n,s),a}function Tz(e,t,r,i){Dz(e,t,r,i).forEach(n=>e.addPoint(n))}function Pz(e,t,r,i){let n=Dz(e,t,r,i),s=new fr;n.forEach(a=>s.addPoint(a)),s.isClosed=!0,e.shapeHoles.push(s)}function Dz(e,t,r,i){let n=i*t/100,s=n*(Math.abs(r)/Math.abs(t)),a=new W(n/t,s/r),o=e.points.map(l=>{let c=l.clone();return c.uuid=mt.generateUUID(),c}).reverse();return o.forEach(l=>{l.position.multiply(a);let c=l.controls[0].position.clone().multiply(a),u=l.controls[1].position.clone().multiply(a);l.controls[0].position.copy(u),l.controls[1].position.copy(c)}),o}var Jle=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,revolutions:2,segments:40,pathRadius:10,pathType:0,pathSegments:30,cornerRadius:30,cornerSegments:4},e.parameters),i=Math.abs(r.width),n=Math.abs(r.height??i),s=Math.abs(r.depth??i),a=Math.abs(Math.min(i,s))/2;return{parameters:Object.assign(r,{width:i,height:n,depth:s,radius:a,segments:Math.round(r.segments),pathSegments:Math.round(r.pathSegments),cornerSegments:Math.round(r.cornerSegments)})}}static build(e){let{width:t,height:r,depth:i,radius:n,revolutions:s,segments:a,pathRadius:o,pathType:l,pathSegments:c,cornerRadius:u,cornerSegments:h}=e.parameters,d=new Lz(!1,t,r,i,n,s,a,o,l,c,u,h);return Object.assign(d,{userData:{...e,type:"HelixGeometry"}})}},lw=new gu([0,0,0],1),Lz=class extends it{constructor(e=!0,t=1,r=1,i=1,n=1,s=1,a=1,o=1,l=1,c=1,u=1,h=1){if(super(),s===0)return;let d=e&&s===1;d&&(h=0),u>100&&(u=100),u===0&&(h=0);let p=()=>new E,f=new E,m=p(),g=p(),v=p(),y,x,w,b,_,A,S,C,M=p(),T=p(),P=p(),D=p(),I=p(),B=p(),X=p(),H=p(),R=r-2*o+.001,q=R/s,F=Math.ceil(a*s),N=F+1,j=R/F,K=-R/2,U=c+1,Y=2*Math.PI/c,V=Math.PI/2/h,ie=.01,J=Math.min((1-u/100)*o,o-ie),ee=o-J,se=0,ce=2,ue=h*ce+ce,ye=U*ue/ce,Re=ye+U*N,Se=U*(N+ue),[ke,Oe,Ce]=[3,3,2].map(pe=>Array(Se*pe).fill(0)),Ae=[],je=n-o;function We(pe,Ve){let qe=Math.PI/2;A=Ve*j,C=2*Math.PI*(A%q)/q+qe,A+=K,S=Math.sin(C)*je,_=Math.cos(C)*je,e?pe.set(_,S,A):pe.set(_,A,S)}We(f,-1e-10),We(m,0),M.copy(f),We(f,1);let k=f.distanceTo(m),O=d?0:ee+J,oe=k*F+2*O,be=J,xe=oe-O;for(let pe=0;pe<=F;pe++){We(g,pe),H.subVectors(g,M).normalize(),M.copy(g),B.copy(g).setComponent(+e+1,0).normalize(),X.crossVectors(H,B).normalize();let Ve=pe===0,qe=pe===F,Xe=Ve?3*Math.PI/2:V,Q=Ve?be:xe,$=Ve?U:Re,de=Ve?0:Se-U,Ee=H.clone().multiplyScalar(Ve?-ee:ee).add(g),He=H.clone().multiplyScalar(Ve?-1:1).normalize();for(let G=0;G<U;G++){let te=G*Y;if(T.addVectors(f.copy(B).multiplyScalar(o*Math.cos(te)),m.copy(X).multiplyScalar(o*Math.sin(te))),P.copy(T).normalize(),Ve||qe){d||(se=de+G,[0,1,2].forEach(ae=>{ke[se*3+ae]=Ee.getComponent(ae),Oe[se*3+ae]=He.getComponent(ae)}),Ce[se*2]=+qe,Ce[se*2+1]=G/c),m.copy(P).multiplyScalar(J),v.addVectors(g,m);for(let ae=0;ae<h;ae++){let me=ae*V+Xe;D.addVectors(f.copy(H).multiplyScalar(ee*Math.sin(me)),m.copy(P).multiplyScalar(ee*Math.cos(me))),I.copy(D).normalize(),m.addVectors(v,D),D.normalize(),se=$+ae*U+G,[0,1,2].forEach(Je=>{ke[se*3+Je]=m.getComponent(Je),Oe[se*3+Je]=I.getComponent(Je)});let Le=+Ve+Math.sin(me);Ce[se*2]=(Q+ee*Le)/oe,Ce[se*2+1]=G/c}}m.addVectors(g,T),se=ye+pe*U+G,[0,1,2].forEach(ae=>{ke[se*3+ae]=m.getComponent(ae),Oe[se*3+ae]=P.getComponent(ae)}),Ce[se*2]=(O+pe*k)/oe,Ce[se*2+1]=G/c}}let Te=N+2*h+ce,[Ge,Ie]=[+d,Te-1];for(let pe=Ge;pe<=Ie-1;pe++){let Ve=d&&pe===Ie-1;for(let qe=0;qe<U-1;qe++)y=pe*U+qe,x=y+1,w=(Ve?qe:y)+U,b=(Ve?qe+1:x)+U,pe===0?Ae.push(x,b,w):pe===Te-2?Ae.push(y,x,w):Ae.push(y,x,w,x,b,w)}this.setIndex(Ae),this.setAttribute("position",new Ne(ke,3)),this.setAttribute("normal",new Ne(Oe,3)),this.setAttribute("uv",new Ne(Ce,2))}getClosedTorusIndicesForBooleanOrSubdiv(){let e=this.userData.parameters,t=Math.ceil(e.tubularSegments),r=e.radialSegments+1,i=Array.from(this.getIndex().array),n,s,a,o,l=6*(t-1)*e.radialSegments,c=t,u=c===t;for(let h=0;h<e.radialSegments;h++)n=c*r+h,s=n+1,a=(u?h:n)+r,o=(u?h+1:s)+r,i[l++]=n,i[l++]=s,i[l++]=a,i[l++]=s,i[l++]=o,i[l++]=a;return i.length=l,lw.array=i,lw.count=i.length,lw}},ece=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,detail:0,corner:0,cornerSides:4},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t,height:r,depth:i,detail:n,corner:s,cornerSides:a}=e.parameters,o=n===0&&s!==0?new Iz(t*.5,s,a):new kR(t*.5,n);return o.scale(1,r/t,i/t),Object.assign(o,{userData:{...e,type:"IcosahedronGeometry"}})}},Iz=class extends gA{constructor(e=1,t=.2,r=4){let i=(1+Math.sqrt(5))/2,n=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],a="IcosahedronGeometry";super(n,s,a,e,t,r),this.type=a}static fromJSON(e){return new Iz(e.radius,e.corner,e.cornerSides)}},tce=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var i;(((i=e.parameters)==null?void 0:i.points)??[]).forEach(n=>{Array.isArray(n)&&(n.x=n[0],n.y=n[1])});let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,segments:64,verticalSegments:64,points:[{x:0,y:-50,id:0},{x:50,y:-50,id:1},{x:50,y:50,id:2},{x:0,y:50,id:3}]},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{points:t,segments:r,verticalSegments:i}=e.parameters,n=new C0;n.moveTo(t[0].x,t[0].y),n.bezierCurveTo(t[1].x,t[1].y,t[2].x,t[2].y,t[3].x,t[3].y);let s=new DR(n.extractPoints(i).shape,r);return s.rotateZ(Math.PI),Object.assign(s,{userData:{...e,type:"LatheGeometry"}})}},Us=new _e,cw=new Vt,kg=new E,ty=class extends ui{constructor(){super(),this.uuid=mt.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}applyMatrix4(e){let t=new Jr().getNormalMatrix(e);for(let r=0,i=this.vertices.length;r<i;r++)this.vertices[r].applyMatrix4(e);for(let r=0,i=this.faces.length;r<i;r++){let n=this.faces[r];n.normal.applyMatrix3(t).normalize();for(let s=0,a=n.vertexNormals.length;s<a;s++)n.vertexNormals[s].applyMatrix3(t).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this}rotateX(e){return Us.makeRotationX(e),this.applyMatrix4(Us),this}rotateY(e){return Us.makeRotationY(e),this.applyMatrix4(Us),this}rotateZ(e){return Us.makeRotationZ(e),this.applyMatrix4(Us),this}translate(e,t,r){return Us.makeTranslation(e,t,r),this.applyMatrix4(Us),this}scale(e,t,r){return Us.makeScale(e,t,r),this.applyMatrix4(Us),this}lookAt(e){return cw.lookAt(e),cw.updateMatrix(),this.applyMatrix4(cw.matrix),this}fromBufferGeometry(e){let t=this,r=e.index!==null?e.index:void 0,i=e.attributes;if(i.position===void 0)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;let n=i.position,s=i.normal,a=i.color,o=i.uv,l=i.uv2;l!==void 0&&(this.faceVertexUvs[1]=[]);for(let h=0;h<n.count;h++)t.vertices.push(new E().fromBufferAttribute(n,h)),a!==void 0&&t.colors.push(new $e().fromBufferAttribute(a,h));function c(h,d,p,f){let m=a===void 0?[]:[t.colors[h].clone(),t.colors[d].clone(),t.colors[p].clone()],g=s===void 0?[]:[new E().fromBufferAttribute(s,h),new E().fromBufferAttribute(s,d),new E().fromBufferAttribute(s,p)],v=new y_(h,d,p,g,m,f);t.faces.push(v),o!==void 0&&t.faceVertexUvs[0].push([new W().fromBufferAttribute(o,h),new W().fromBufferAttribute(o,d),new W().fromBufferAttribute(o,p)]),l!==void 0&&t.faceVertexUvs[1].push([new W().fromBufferAttribute(l,h),new W().fromBufferAttribute(l,d),new W().fromBufferAttribute(l,p)])}let u=e.groups;if(u.length>0)for(let h=0;h<u.length;h++){let d=u[h],p=d.start,f=d.count;for(let m=p,g=p+f;m<g;m+=3)r!==void 0?c(r.getX(m),r.getX(m+1),r.getX(m+2),d.materialIndex):c(m,m+1,m+2,d.materialIndex)}else if(r!==void 0)for(let h=0;h<r.count;h+=3)c(r.getX(h),r.getX(h+1),r.getX(h+2));else for(let h=0;h<n.count;h+=3)c(h,h+1,h+2);return this.computeFaceNormals(),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(kg).negate(),this.translate(kg.x,kg.y,kg.z),this}normalize(){this.computeBoundingSphere();let e=this.boundingSphere.center,t=this.boundingSphere.radius,r=t===0?1:1/t,i=new _e;return i.set(r,0,0,-r*e.x,0,r,0,-r*e.y,0,0,r,-r*e.z,0,0,0,1),this.applyMatrix4(i),this}computeFaceNormals(){let e=new E,t=new E;for(let r=0,i=this.faces.length;r<i;r++){let n=this.faces[r],s=this.vertices[n.a],a=this.vertices[n.b],o=this.vertices[n.c];e.subVectors(o,a),t.subVectors(s,a),e.cross(t),e.normalize(),n.normal.copy(e)}}computeVertexNormals(e=!0){let t=new Array(this.vertices.length);for(let r=0,i=this.vertices.length;r<i;r++)t[r]=new E;if(e){let r=new E,i=new E;for(let n=0,s=this.faces.length;n<s;n++){let a=this.faces[n],o=this.vertices[a.a],l=this.vertices[a.b],c=this.vertices[a.c];r.subVectors(c,l),i.subVectors(o,l),r.cross(i),t[a.a].add(r),t[a.b].add(r),t[a.c].add(r)}}else{this.computeFaceNormals();for(let r=0,i=this.faces.length;r<i;r++){let n=this.faces[r];t[n.a].add(n.normal),t[n.b].add(n.normal),t[n.c].add(n.normal)}}for(let r=0,i=this.vertices.length;r<i;r++)t[r].normalize();for(let r=0,i=this.faces.length;r<i;r++){let n=this.faces[r],s=n.vertexNormals;s.length===3?(s[0].copy(t[n.a]),s[1].copy(t[n.b]),s[2].copy(t[n.c])):(s[0]=t[n.a].clone(),s[1]=t[n.b].clone(),s[2]=t[n.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeFlatVertexNormals(){this.computeFaceNormals();for(let e=0,t=this.faces.length;e<t;e++){let r=this.faces[e],i=r.vertexNormals;i.length===3?(i[0].copy(r.normal),i[1].copy(r.normal),i[2].copy(r.normal)):(i[0]=r.normal.clone(),i[1]=r.normal.clone(),i[2]=r.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeMorphNormals(){for(let t=0,r=this.faces.length;t<r;t++){let i=this.faces[t];i.__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]);for(let n=0,s=i.vertexNormals.length;n<s;n++)i.__originalVertexNormals[n]?i.__originalVertexNormals[n].copy(i.vertexNormals[n]):i.__originalVertexNormals[n]=i.vertexNormals[n].clone()}let e=new ty;e.faces=this.faces;for(let t=0,r=this.morphTargets.length;t<r;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];let n=this.morphNormals[t].faceNormals,s=this.morphNormals[t].vertexNormals;for(let a=0,o=this.faces.length;a<o;a++){let l=new E,c={a:new E,b:new E,c:new E};n.push(l),s.push(c)}}let i=this.morphNormals[t];e.vertices=this.morphTargets[t].vertices,e.computeFaceNormals(),e.computeVertexNormals();for(let n=0,s=this.faces.length;n<s;n++){let a=this.faces[n],o=i.faceNormals[n],l=i.vertexNormals[n];o.copy(a.normal),l.a.copy(a.vertexNormals[0]),l.b.copy(a.vertexNormals[1]),l.c.copy(a.vertexNormals[2])}}for(let t=0,r=this.faces.length;t<r;t++){let i=this.faces[t];i.normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals}}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Ar),this.boundingBox.setFromPoints(this.vertices)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Mn),this.boundingSphere.setFromPoints(this.vertices)}merge(e,t,r=0){if(!(e&&e.isGeometry)){console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e);return}let i,n=this.vertices.length,s=this.vertices,a=e.vertices,o=this.faces,l=e.faces,c=this.colors,u=e.colors;t!==void 0&&(i=new Jr().getNormalMatrix(t));for(let h=0,d=a.length;h<d;h++){let p=a[h].clone();t!==void 0&&p.applyMatrix4(t),s.push(p)}for(let h=0,d=u.length;h<d;h++)c.push(u[h].clone());for(let h=0,d=l.length;h<d;h++){let p=l[h],f,m,g=p.vertexNormals,v=p.vertexColors,y=new y_(p.a+n,p.b+n,p.c+n);y.normal.copy(p.normal),i!==void 0&&y.normal.applyMatrix3(i).normalize();for(let x=0,w=g.length;x<w;x++)f=g[x].clone(),i!==void 0&&f.applyMatrix3(i).normalize(),y.vertexNormals.push(f);y.color.copy(p.color);for(let x=0,w=v.length;x<w;x++)m=v[x],y.vertexColors.push(m.clone());y.materialIndex=p.materialIndex+r,o.push(y)}for(let h=0,d=e.faceVertexUvs.length;h<d;h++){let p=e.faceVertexUvs[h];this.faceVertexUvs[h]===void 0&&(this.faceVertexUvs[h]=[]);for(let f=0,m=p.length;f<m;f++){let g=p[f],v=[];for(let y=0,x=g.length;y<x;y++)v.push(g[y].clone());this.faceVertexUvs[h].push(v)}}}mergeMesh(e){if(!(e&&e.isMesh)){console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e);return}e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)}mergeVertices(e=4){let t={},r=[],i=[],n=Math.pow(10,e);for(let o=0,l=this.vertices.length;o<l;o++){let c=this.vertices[o],u=Math.round(c.x*n)+"_"+Math.round(c.y*n)+"_"+Math.round(c.z*n);t[u]===void 0?(t[u]=o,r.push(this.vertices[o]),i[o]=r.length-1):i[o]=i[t[u]]}let s=[];for(let o=0,l=this.faces.length;o<l;o++){let c=this.faces[o];c.a=i[c.a],c.b=i[c.b],c.c=i[c.c];let u=[c.a,c.b,c.c];for(let h=0;h<3;h++)if(u[h]===u[(h+1)%3]){s.push(o);break}}for(let o=s.length-1;o>=0;o--){let l=s[o];this.faces.splice(l,1);for(let c=0,u=this.faceVertexUvs.length;c<u;c++)this.faceVertexUvs[c].splice(l,1)}let a=this.vertices.length-r.length;return this.vertices=r,a}setFromPoints(e){this.vertices=[];for(let t=0,r=e.length;t<r;t++){let i=e[t];this.vertices.push(new E(i.x,i.y,i.z||0))}return this}sortFacesByMaterialIndex(){let e=this.faces,t=e.length;for(let o=0;o<t;o++)e[o]._id=o;function r(o,l){return o.materialIndex-l.materialIndex}e.sort(r);let i=this.faceVertexUvs[0],n=this.faceVertexUvs[1],s,a;i&&i.length===t&&(s=[]),n&&n.length===t&&(a=[]);for(let o=0;o<t;o++){let l=e[o]._id;s&&s.push(i[l]),a&&a.push(n[l])}s&&(this.faceVertexUvs[0]=s),a&&(this.faceVertexUvs[1]=a)}toJSON(){let e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),this.parameters!==void 0){let p=this.parameters;for(let f in p)p[f]!==void 0&&(e[f]=p[f]);return e}let t=[];for(let p=0;p<this.vertices.length;p++){let f=this.vertices[p];t.push(f.x,f.y,f.z)}let r=[],i=[],n={},s=[],a={},o=[],l={};for(let p=0;p<this.faces.length;p++){let f=this.faces[p],m=!0,g=!1,v=this.faceVertexUvs[0][p]!==void 0,y=f.normal.length()>0,x=f.vertexNormals.length>0,w=f.color.r!==1||f.color.g!==1||f.color.b!==1,b=f.vertexColors.length>0,_=0;if(_=c(_,0,0),_=c(_,1,m),_=c(_,2,g),_=c(_,3,v),_=c(_,4,y),_=c(_,5,x),_=c(_,6,w),_=c(_,7,b),r.push(_),r.push(f.a,f.b,f.c),r.push(f.materialIndex),v){let A=this.faceVertexUvs[0][p];r.push(d(A[0]),d(A[1]),d(A[2]))}if(y&&r.push(u(f.normal)),x){let A=f.vertexNormals;r.push(u(A[0]),u(A[1]),u(A[2]))}if(w&&r.push(h(f.color)),b){let A=f.vertexColors;r.push(h(A[0]),h(A[1]),h(A[2]))}}function c(p,f,m){return m?p|1<<f:p&~(1<<f)}function u(p){let f=p.x.toString()+p.y.toString()+p.z.toString();return n[f]!==void 0||(n[f]=i.length/3,i.push(p.x,p.y,p.z)),n[f]}function h(p){let f=p.r.toString()+p.g.toString()+p.b.toString();return a[f]!==void 0||(a[f]=s.length,s.push(p.getHex())),a[f]}function d(p){let f=p.x.toString()+p.y.toString();return l[f]!==void 0||(l[f]=o.length/2,o.push(p.x,p.y)),l[f]}return e.data={},e.data.vertices=t,e.data.normals=i,s.length>0&&(e.data.colors=s),o.length>0&&(e.data.uvs=[o]),e.data.faces=r,e}clone(){return new ty().copy(this)}copy(e){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;let t=e.vertices;for(let h=0,d=t.length;h<d;h++)this.vertices.push(t[h].clone());let r=e.colors;for(let h=0,d=r.length;h<d;h++)this.colors.push(r[h].clone());let i=e.faces;for(let h=0,d=i.length;h<d;h++)this.faces.push(i[h].clone());for(let h=0,d=e.faceVertexUvs.length;h<d;h++){let p=e.faceVertexUvs[h];this.faceVertexUvs[h]===void 0&&(this.faceVertexUvs[h]=[]);for(let f=0,m=p.length;f<m;f++){let g=p[f],v=[];for(let y=0,x=g.length;y<x;y++){let w=g[y];v.push(w.clone())}this.faceVertexUvs[h].push(v)}}let n=e.morphTargets;for(let h=0,d=n.length;h<d;h++){let p={};if(p.name=n[h].name,n[h].vertices!==void 0){p.vertices=[];for(let f=0,m=n[h].vertices.length;f<m;f++)p.vertices.push(n[h].vertices[f].clone())}if(n[h].normals!==void 0){p.normals=[];for(let f=0,m=n[h].normals.length;f<m;f++)p.normals.push(n[h].normals[f].clone())}this.morphTargets.push(p)}let s=e.morphNormals;for(let h=0,d=s.length;h<d;h++){let p={};if(s[h].vertexNormals!==void 0){p.vertexNormals=[];for(let f=0,m=s[h].vertexNormals.length;f<m;f++){let g=s[h].vertexNormals[f],v={};v.a=g.a.clone(),v.b=g.b.clone(),v.c=g.c.clone(),p.vertexNormals.push(v)}}if(s[h].faceNormals!==void 0){p.faceNormals=[];for(let f=0,m=s[h].faceNormals.length;f<m;f++)p.faceNormals.push(s[h].faceNormals[f].clone())}this.morphNormals.push(p)}let a=e.skinWeights;for(let h=0,d=a.length;h<d;h++)this.skinWeights.push(a[h].clone());let o=e.skinIndices;for(let h=0,d=o.length;h<d;h++)this.skinIndices.push(o[h].clone());let l=e.lineDistances;for(let h=0,d=l.length;h<d;h++)this.lineDistances.push(l[h]);let c=e.boundingBox;c!==null&&(this.boundingBox=c.clone());let u=e.boundingSphere;return u!==null&&(this.boundingSphere=u.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this}toBufferGeometry(){let e=new rce().fromGeometry(this),t=new it,r=new Float32Array(e.vertices.length*3);if(t.setAttribute("position",Ng.call(new nt(r,3),e.vertices)),e.normals.length>0){let i=new Float32Array(e.normals.length*3);t.setAttribute("normal",Ng.call(new nt(i,3),e.normals))}if(e.colors.length>0){let i=new Float32Array(e.colors.length*3);t.setAttribute("color",dD.call(new nt(i,3),e.colors))}if(e.uvs.length>0){let i=new Float32Array(e.uvs.length*2);t.setAttribute("uv",pD.call(new nt(i,2),e.uvs))}if(e.uvs2.length>0){let i=new Float32Array(e.uvs2.length*2);t.setAttribute("uv2",pD.call(new nt(i,2),e.uvs2))}t.groups=e.groups;for(let i in e.morphTargets){let n=[],s=e.morphTargets[i];for(let a=0,o=s.length;a<o;a++){let l=s[a],c=new Ne(l.data.length*3,3);c.name=l.name,n.push(Ng.call(c,l.data))}t.morphAttributes[i]=n}if(e.skinIndices.length>0){let i=new Ne(e.skinIndices.length*4,4);t.setAttribute("skinIndex",fD.call(i,e.skinIndices))}if(e.skinWeights.length>0){let i=new Ne(e.skinWeights.length*4,4);t.setAttribute("skinWeight",fD.call(i,e.skinWeights))}return e.boundingSphere!==null&&(t.boundingSphere=e.boundingSphere.clone()),e.boundingBox!==null&&(t.boundingBox=e.boundingBox.clone()),t}computeTangents(){console.error("THREE.Geometry: .computeTangents() has been removed.")}computeLineDistances(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}applyMatrix(e){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}dispose(){this.dispatchEvent({type:"dispose"})}static createBufferGeometryFromObject(e){let t=new it,r=e.geometry;if(e.isPoints||e.isLine){let i=new Ne(r.vertices.length*3,3),n=new Ne(r.colors.length*3,3);if(t.setAttribute("position",Ng.call(i,r.vertices)),t.setAttribute("color",dD.call(n,r.colors)),r.lineDistances&&r.lineDistances.length===r.vertices.length){let s=new Ne(r.lineDistances.length,1);t.setAttribute("lineDistance",ice.call(s,r.lineDistances))}r.boundingSphere!==null&&(t.boundingSphere=r.boundingSphere.clone()),r.boundingBox!==null&&(t.boundingBox=r.boundingBox.clone())}else e.isMesh&&(t=r.toBufferGeometry());return t}};ty.prototype.isGeometry=!0;var rce=class{constructor(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}computeGroups(e){let t=[],r,i,n,s=e.faces;for(i=0;i<s.length;i++){let a=s[i];a.materialIndex!==n&&(n=a.materialIndex,r!==void 0&&(r.count=i*3-r.start,t.push(r)),r={start:i*3,materialIndex:n})}r!==void 0&&(r.count=i*3-r.start,t.push(r)),this.groups=t}fromGeometry(e){let t=e.faces,r=e.vertices,i=e.faceVertexUvs,n=i[0]&&i[0].length>0,s=i[1]&&i[1].length>0,a=e.morphTargets,o=a.length,l;if(o>0){l=[];for(let g=0;g<o;g++)l[g]={name:a[g].name,data:[]};this.morphTargets.position=l}let c=e.morphNormals,u=c.length,h;if(u>0){h=[];for(let g=0;g<u;g++)h[g]={name:c[g].name,data:[]};this.morphTargets.normal=h}let d=e.skinIndices,p=e.skinWeights,f=d.length===r.length,m=p.length===r.length;r.length>0&&t.length===0&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(let g=0;g<t.length;g++){let v=t[g];this.vertices.push(r[v.a],r[v.b],r[v.c]);let y=v.vertexNormals;if(y.length===3)this.normals.push(y[0],y[1],y[2]);else{let w=v.normal;this.normals.push(w,w,w)}let x=v.vertexColors;if(x.length===3)this.colors.push(x[0],x[1],x[2]);else{let w=v.color;this.colors.push(w,w,w)}if(n===!0){let w=i[0][g];w!==void 0?this.uvs.push(w[0],w[1],w[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",g),this.uvs.push(new W,new W,new W))}if(s===!0){let w=i[1][g];w!==void 0?this.uvs2.push(w[0],w[1],w[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",g),this.uvs2.push(new W,new W,new W))}for(let w=0;w<o;w++){let b=a[w].vertices;l[w].data.push(b[v.a],b[v.b],b[v.c])}for(let w=0;w<u;w++){let b=c[w].vertexNormals[g];h[w].data.push(b.a,b.b,b.c)}f&&this.skinIndices.push(d[v.a],d[v.b],d[v.c]),m&&this.skinWeights.push(p[v.a],p[v.b],p[v.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),this}},y_=class{constructor(e,t,r,i,n,s=0){this.a=e,this.b=t,this.c=r,this.normal=i&&i.isVector3?i:new E,this.vertexNormals=Array.isArray(i)?i:[],this.color=n&&n.isColor?n:new $e,this.vertexColors=Array.isArray(n)?n:[],this.materialIndex=s}clone(){return new this.constructor().copy(this)}copy(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(let t=0,r=e.vertexNormals.length;t<r;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(let t=0,r=e.vertexColors.length;t<r;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}};function ice(e){return this.array.set(e),this}function dD(e){let t=this.array,r=0;for(let i=0,n=e.length;i<n;i++){let s=e[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),s=new $e),t[r++]=s.r,t[r++]=s.g,t[r++]=s.b}return this}function pD(e){let t=this.array,r=0;for(let i=0,n=e.length;i<n;i++){let s=e[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),s=new W),t[r++]=s.x,t[r++]=s.y}return this}function Ng(e){let t=this.array,r=0;for(let i=0,n=e.length;i<n;i++){let s=e[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),s=new E),t[r++]=s.x,t[r++]=s.y,t[r++]=s.z}return this}function fD(e){let t=this.array,r=0;for(let i=0,n=e.length;i<n;i++){let s=e[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),s=new dt),t[r++]=s.x,t[r++]=s.y,t[r++]=s.z,t[r++]=s.w}return this}var nce=["a","b","c"];function sce(e,t){switch(t){case"c":return e.c;case"b":return e.b;case"a":default:return e.a}}function hw(e,t,r){let i=Math.min(e,t),n=Math.max(e,t),s=i+"_"+n;return r.get(s)}function uw(e,t,r,i,n,s){let a=Math.min(e,t),o=Math.max(e,t),l=a+"_"+o,c;if(i.has(l))c=i.get(l);else{let u=r[a],h=r[o];c={a:u,b:h,newEdge:null,faces:[]},i.set(l,c)}c.faces.push(n),s[e].edges.push(c),s[t].edges.push(c)}function ace(e,t,r,i){let n,s,a;for(n=0,s=e.length;n<s;n++)r[n]={edges:[]};for(n=0,s=t.length;n<s;n++)a=t[n],uw(a.a,a.b,e,i,a,r),uw(a.b,a.c,e,i,a,r),uw(a.c,a.a,e,i,a,r)}function Fg(e,t,r,i,n){e.push(new y_(t,r,i,void 0,void 0,n))}function yh(e,t){return Math.abs(t-e)/2+Math.min(e,t)}function Ug(e,t,r,i){e.push([t.clone(),r.clone(),i.clone()])}var oce=class{constructor(e=1){this.subdivisions=e}modify(e){e instanceof it?e=new ty().fromBufferGeometry(e):e=e.clone(),e.mergeVertices();let t=this.subdivisions;for(;t-- >0;)this._smooth(e);return e.computeFaceNormals(),e.computeVertexNormals(),e}_smooth(e){let t=new E,r,i,n,s,a,o=e.vertices,l=e.faces,c=e.faceVertexUvs[0],u=c!==void 0&&c.length>0,h=[],d=new Map;ace(o,l,h,d);let p=[],f,m,g,v,y,x,w;for(let ie of Array.from(d.keys())){for(m=d.get(ie),g=new E,y=3/8,x=1/8,w=m.faces.length,w!=2&&(y=.5,x=0,w!=1),g.addVectors(m.a,m.b).multiplyScalar(y),t.set(0,0,0),s=0;s<w;s++){for(v=m.faces[s],a=0;a<3&&(f=o[sce(v,nce[a])],!(f!==m.a&&f!==m.b));a++);f&&t.add(f)}t.multiplyScalar(x),g.add(t),m.newEdge=p.length,p.push(g)}let b,_,A,S,C,M,T,P=[];for(i=0,n=o.length;i<n;i++){for(M=o[i],C=h[i].edges,r=C.length,r==3?b=3/16:r>3&&(b=3/(8*r)),_=1-r*Number(b),A=b,r<=2&&(r==2?(_=3/4,A=1/8):r==1||r==0),T=M.clone().multiplyScalar(_),t.set(0,0,0),s=0;s<r;s++)S=C[s],f=S.a!==M?S.a:S.b,t.add(f);t.multiplyScalar(Number(A)),T.add(t),P.push(T)}let D=P.concat(p),I=P.length,B,X,H,R=[],q=[],F,N,j,K,U=new W,Y=new W,V=new W;for(i=0,n=l.length;i<n;i++)v=l[i],B=Number(hw(v.a,v.b,d).newEdge)+I,X=Number(hw(v.b,v.c,d).newEdge)+I,H=Number(hw(v.c,v.a,d).newEdge)+I,Fg(R,B,X,H,v.materialIndex),Fg(R,v.a,B,H,v.materialIndex),Fg(R,v.b,X,B,v.materialIndex),Fg(R,v.c,H,X,v.materialIndex),u&&(F=c[i],N=F[0],j=F[1],K=F[2],U.set(yh(N.x,j.x),yh(N.y,j.y)),Y.set(yh(j.x,K.x),yh(j.y,K.y)),V.set(yh(N.x,K.x),yh(N.y,K.y)),Ug(q,U,Y,V),Ug(q,N,U,V),Ug(q,j,Y,U),Ug(q,K,V,Y));e.vertices=D,e.faces=R,u&&(e.faceVertexUvs[0]=q)}},Rr=new E,lce=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=e.geometry??(t==null?void 0:t.geometry)??new it().copy(new ma(100,100,100)),i;t===void 0?(r.computeBoundingBox(),r.boundingBox.getSize(Rr),i={width:Rr.x,height:Rr.y,depth:Rr.z,subdivisions:0}):i=t.parameters;let n={...i,...e.parameters};return{parameters:{width:Math.abs(n.width),height:Math.abs(n.height),depth:Math.abs(n.depth),subdivisions:Math.abs(n.subdivisions)},geometry:r}}static build(e){let{width:t,height:r,depth:i,subdivisions:n}=e.parameters,s=e.geometry??new it().copy(new ma(100,100,100)),a=s.userData.parameters;a===void 0?(s.computeBoundingBox(),s.boundingBox.getSize(Rr)):Rr.set(a.width,a.height,a.depth),(t!==Rr.x||r!==Rr.y||i!==Rr.z)&&s.scale(Rr.x===0?1:t/Rr.x,Rr.y===0?1:r/Rr.y,Rr.z===0?1:i/Rr.z);let o=s.originalGeometry;try{n>0?(o===void 0||(a==null?void 0:a.subdivisions)!==n)&&(o===void 0&&(o=s),s=new oce(n).modify(o).toBufferGeometry()):(o!==void 0&&(s=o),o=void 0,s.getAttribute("normal")===void 0&&s.computeVertexNormals())}catch{o!==void 0&&(s=o),o=void 0,s.getAttribute("normal")===void 0&&s.computeVertexNormals()}return o!==void 0&&Object.assign(s,{originalGeometry:o}),delete e.geometry,Object.assign(s,{userData:{...e,type:"NonParametricGeometry"}})}static loadFromUrl(e,t,r){new GR(r).load(e,i=>{let n=this.normalizeInputs({geometry:i});i.boundingBox.getSize(Rr);let s=100/Rr.x;Object.assign(n.parameters,{width:100,height:Rr.y*s,depth:Rr.z*s}),t(this.build(n))})}},Oz=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:3},e.parameters);return{shape:e.shape&&e.shape instanceof fr?e.shape:new fr,parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??0)})}}static build(e){let{width:t,height:r,spikes:i,cornerRadius:n,depth:s,extrudeBevelSize:a,extrudeBevelSegments:o}=e.parameters,l=e.shape,c=t*.5,u=r*.5,h=0,d=0,p=2*Math.PI/i;for(let m=0;m<i;m++){let g=p*m,v=h+Math.sin(g)*c,y=d+Math.cos(g)*u;l.addPoint(l.createPoint(v,y))}l.isClosed=!0;for(let m=0,g=l.points.length;m<g;m++)l.points[m].roundness=n;l.roundness=n,l.update();let f=Xc.create({shape:l,parameters:{roundness:n,depth:s,extrudeBevelSize:a,extrudeBevelSegments:o}});return Object.assign(f,{userData:{...e,type:"PolygonGeometry"}})}},cce=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,radialSegments:4,heightSegments:1,cornerRadius:0,cornerSegments:8,openEnded:!1},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t,height:r,depth:i,radialSegments:n,heightSegments:s,openEnded:a,cornerRadius:o,cornerSegments:l}=e.parameters,c=new uce(t*.5,r,n,s,a,o,l);return c.scale(1,1,i/t),Object.assign(c,{userData:{...e,type:"PyramidGeometry"}})}};function ap(e,t,r){r.x=e.x*t.x,r.y=e.y,r.z=e.x*t.y}function dw(e,t,r,i,n,s){let a=t.clone().sub(e),o=r.clone().sub(e),l=a.angleTo(o);if(a.normalize(),o.normalize(),i===n){let c=a.add(o).normalize();s.copy(e).addScaledVector(c,i/Math.sin(l/2))}else{let c=a.angleTo(o);s.copy(e),s.addScaledVector(a,n/Math.sin(c)),s.addScaledVector(o,i/Math.sin(c))}}function hce(e,t,r){let i=e.clone().sub(t),n=r.clone().sub(t);return i.projectOnVector(n),i.add(t)}var uce=class extends it{constructor(e=.5,t=1,r=4,i=1,n=!1,s=0,a=4){super(),r=Math.floor(Math.max(3,r)),i=Math.floor(i),a=Math.floor(a);let o=[],l=[],c=[],u=[],h=0,d=t/2,p=Math.PI/r,f=e*Math.cos(Math.PI/r),m=2*Math.PI/r,g=(r-2)*Math.PI/r,v=Math.PI-g,y=new E(0,-d,0),x=new E(0,d,0),w=new W(e,-d),b=new W(f,-d),_=new W(0,x.y).sub(b),A=new W(0,x.y).sub(w),S=new W(_.y,-_.x).normalize(),C=new W(A.y,-A.x).normalize(),M=e*Math.cos(Math.PI/r)*Math.tan((Math.PI-_.angle())/2)-1e-8;s=Math.min(s,M);let T;{let H=new E(S.x,S.y,0),R=new E(Math.cos(m)*H.x,H.y,Math.sin(m)*H.x);T=H.angleTo(R)}let P=s/Math.tan((Math.PI-_.angle())/2),D=s/Math.tan((Math.PI-T)/2),I=new E;if(!n){l.push(y.x,y.y,y.z),c.push(0,-1,0),u.push(0,0);let H=h++,R=[],q=w.clone(),F=P/Math.cos(Math.PI/r);q.x-=F;for(let N=0;N<r;N++){let j=N/r*Math.PI*2+p,K=new W(Math.sin(j),Math.cos(j));ap(q,K,I),l.push(I.x,I.y,I.z),c.push(0,-1,0),u.push(0,0),R.push(h++)}for(let N=0;N<R.length;N++)o.push(R[N],H,R[(N+1)%R.length])}{let H=new E,R=new E,q=new E,F=new E,N=new E,j=new E;for(let K=0;K<r;K++){let U=K/r*Math.PI*2+p,Y=(K+.5)/r*Math.PI*2+p,V=(K+1)/r*Math.PI*2+p,ie=new W(Math.sin(U),Math.cos(U)),J=new W(Math.sin(Y),Math.cos(Y)),ee=new W(Math.sin(V),Math.cos(V));ap(w,ie,R),ap(w,ee,q),ap(S,J,H),dw(x,R,q,D,D,F),l.push(F.x,F.y,F.z),dw(R,x,q,D,P,N),l.push(N.x,N.y,N.z),dw(q,R,x,P,D,j),l.push(j.x,j.y,j.z),c.push(H.x,H.y,H.z),c.push(H.x,H.y,H.z),c.push(H.x,H.y,H.z),u.push(0,0),u.push(0,0),u.push(0,0);let se=h++,ce=h++,ue=h++;if(o.push(se,ce,ue),s>0){{let Se=R.clone().add(q).multiplyScalar(.5),ke=x.clone().sub(Se).normalize(),Oe=y.clone().sub(Se).normalize().add(ke).normalize().multiplyScalar(-1),Ce=j.clone().sub(N);B(Se,Ce,Oe,_.angle())}let ye,Re;{let Se=new E;ap(C,ee,Se);let ke=j.clone().add(F).multiplyScalar(.5);ke=hce(ke,q,x);let Oe=j.clone().sub(F);[ye,Re]=B(ke,Oe,Se,T,F.y)}{let Se=ye,ke=Se.clone().setY(0).normalize(),Oe=new E(0,-1,0),Ce=ke.clone().cross(Oe);X(Se,ke,Oe,Ce)}{let Se=_.angle(),ke=Math.PI-Se,Oe=x.clone();Oe.y-=s/Math.sin(Se-Math.PI/2);let Ce=new E,Ae=[];for(let We=0;We<a;We++){let k=[],O=Math.PI/2-ke*We/a,oe=Math.cos(O),be=Math.sin(O),xe=Y;for(let Te=0;Te<=We;Te++){let Ge=Math.cos(xe),Ie=Math.sin(xe);H.x=oe*Ie,H.y=be,H.z=oe*Ge,Ce.copy(Oe).addScaledVector(H,s),l.push(Ce.x,Ce.y,Ce.z),c.push(H.x,H.y,H.z),u.push(0,0),k.push(h++),xe+=Math.PI*2/We/r}Ae.push(k)}Re.reverse(),Ae.push(Re);let je=Ae.length-1;for(let We=0;We<je;We++){let k=Ae[We],O=Ae[We+1],oe=k.length-1;o.push(O[1],k[0],O[0]);for(let be=1;be<=oe;be++)o.push(k[be],k[be-1],O[be]),o.push(O[be+1],k[be],O[be])}}}}}this.setIndex(o),this.setAttribute("position",new Ne(l,3)),this.setAttribute("normal",new Ne(c,3)),this.setAttribute("uv",new Ne(u,2));function B(H,R,q,F,N){let j=-F/2,K=(Math.PI-F)/2,U=R.clone().normalize().cross(q);H.addScaledVector(q,-s/Math.sin(K));let Y=new E,V=new E,ie=1,J=h,ee=[];for(let se=0;se<=a;se++){let ce=j+se/a*F;V.set(0,0,0),V.addScaledVector(U,Math.sin(ce)),V.addScaledVector(q,Math.cos(ce));for(let ue=0;ue<=ie;ue++){let ye=ue/ie-.5;if(Y.copy(H),Y.addScaledVector(R,ye),Y.addScaledVector(V,s),N!=null){let Re=Math.max(0,Y.y-N);Y.addScaledVector(R,-Re/R.y)}l.push(Y.x,Y.y,Y.z),c.push(V.x,V.y,V.z),u.push(0,0),ue===0&&ee.push(h),h++}}for(let se=0;se<a;se++)for(let ce=0;ce<ie;ce++){let ue=J+ce+(ie+1)*se,ye=ue+(ie+1),Re=ye+1,Se=ue+1;o.push(ue,ye,Se),o.push(ye,Re,Se)}return[H.clone().addScaledVector(R,.5),ee]}function X(H,R,q,F){let N=Math.PI/2,j=A.angle()-N,K=[],U=new E,Y=new E;for(let ie=0;ie<=a;ie++){let J=[],ee=ie/a;for(let se=0;se<=ie;se++){let ce=((ie?se/ie:0)-.5)*v,ue=Math.cos(ce),ye=Math.sin(ce),Re=Math.atan(Math.tan(j)*ue),Se=(N+Re)*ee,ke=Math.cos(Se),Oe=Math.sin(Se);U.set(0,0,0),U.addScaledVector(R,Oe*ue),U.addScaledVector(q,ke),U.addScaledVector(F,Oe*ye),Y.copy(H).addScaledVector(U,s),l.push(Y.x,Y.y,Y.z),c.push(U.x,U.y,U.z),u.push(0,0),J.push(h++)}K.push(J)}let V=K.length-1;for(let ie=0;ie<V;ie++){let J=K[ie],ee=K[ie+1],se=J.length-1;o.push(J[0],ee[1],ee[0]);for(let ce=1;ce<=se;ce++)o.push(J[ce-1],J[ce],ee[ce]),o.push(J[ce],ee[ce+1],ee[ce])}}}},Rz=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,cornerRadius:[0,0,0,0],cornerType:1,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters),i=Object.assign((t==null?void 0:t.ui)??{enabledIndieCorners:!1},e.ui);return{shape:e.shape&&e.shape instanceof fr?e.shape:new fr,parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??0)}),ui:i}}static build(e){let t=e.shape,{width:r,height:i,cornerRadius:n,cornerType:s,depth:a,extrudeBevelSize:o,extrudeBevelSegments:l}=e.parameters,c={x:r*.5,y:i*.5},u={x:-c.x,y:-c.y},h={x:c.x,y:c.y};function d(w,b,_){return b>r&&_>i?Math.min(w*r/b,w*i/_):b>r?w*r/b:_>i?w*i/_:w}let p=[];p[0]=n[0]===0?0:d(n[0],n[0]+n[3],n[0]+n[1]),p[1]=n[1]===0?0:d(n[1],n[1]+n[2],n[1]+n[0]),p[2]=n[2]===0?0:d(n[2],n[2]+n[1],n[2]+n[3]),p[3]=n[3]===0?0:d(n[3],n[3]+n[0],n[3]+n[2]);let f=u.x,m=h.x,g=h.y,v=u.y;t.addPoint(t.createPoint(f,g)),t.addPoint(t.createPoint(m,g)),t.addPoint(t.createPoint(m,v)),t.addPoint(t.createPoint(f,v)),t.isClosed=!0;let y=!0;for(let w=0,b=t.points.length;w<b;w++)t.points[w].roundness=p[w],w>0&&p[w]!==p[w-1]&&(y=!1);y&&(t.roundness=p[0]),t.useCubicForRoundedCorners=s!==1,t.update();let x=Xc.create({shape:t,parameters:{depth:a,extrudeBevelSize:o,extrudeBevelSegments:l}});return Object.assign(x,{userData:{...e,type:"RectangleGeometry"}})}},dce=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:Math.PI},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t=100,height:r=t,depth:i=t,widthSegments:n=64,heightSegments:s=64,phiStart:a,phiLength:o,thetaStart:l,thetaLength:c}=e.parameters,u=new O3(.5*t,n,s,a,o,l,c);return u.scale(1,r/t,i/t),Object.assign(u,{userData:{...e,type:"SphereGeometry"}})}},pce=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,widthSegments:8,heightSegments:8},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:0})}}static build(e){let{width:t=100,height:r=t,widthSegments:i=8,heightSegments:n=8}=e.parameters,s=new Ny(t,r,i,n);return s.scale(1,1,1),Object.assign(s,{userData:{...e,type:"PlaneGeometry"}})}},fce=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,angle:90,cornerRadius:24,cornerSegments:8},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t,height:r,depth:i,angle:n,cornerRadius:s,cornerSegments:a}=e.parameters,o=new mce(t,r,i,n,s,a);return Object.assign(o,{userData:{...e,type:"BackdropGeometry"}})}},mce=class extends it{constructor(e=1,t=1,r=1,i=90,n=10,s=24){super(),this.type="BackdropGeometry";let a=[],o=[],l=[],c=.001;n==0&&(s=1),s=Math.max(1,Math.floor(s)),n=Math.min(n,100),i=Math.min(180-c,i),i*=Math.PI/180;let u=[],h=Math.PI/2,d=(ie=0,J=0,ee=0)=>new E(ie,J,ee),p=d(),f=d(),[m,g,v]=[t/2,e/2,r/2],y=-g,x=+g,[w,b,_]=[d(y,-m,+v),d(y,-m,-v),d(y,+m,-v)],A=(ie,J=!1)=>Math.sin(ie-Math.PI/(1+ +J)),S=(ie,J=!1)=>Math.cos(ie-Math.PI/(1+ +J));_.y=Math.sin(i)*t-m;let C=Math.cos(i)*t-v,M=w.z-c;i<=h?(_.z=Math.min(C,M),_.z==M&&(_.y-=(C-M)/Math.tan(h-i))):b.z=Math.min(b.z-C-v,w.z-c),p.subVectors(w,b),f.subVectors(_,b);let T=Math.min(p.length(),f.length())*n/100,P=T*Math.tan(i/2),D=T/Math.cos(i/2),I=p.clone().normalize().add(f.normalize()).setLength(D).add(b);p.set(0,A(i,!0),S(i,!0)),u.push([_,p.clone()]);let B=(Math.PI-i)/s;for(let ie=0;ie<=s;ie++){let J=h+i+ie*B;p.set(0,Math.sin(J)*P,Math.cos(J)*P),p.add(I),f.set(0,A(J),S(J)),u.push([p.clone(),f.clone()])}u.push([w,d(0,1,0)]);let X=Math.sin(B/2)*P*2,H=u.length-1,R=u[0][0].distanceTo(u[1][0]),q=u[H-1][0].distanceTo(u[H][0]),F=R+X*s+q;u[0].push(1);for(let ie=0;ie<=s;ie++)u[ie+1].push(1-(R+ie*X)/F);u[H].push(0);let[N,j,K]=u[0],U,Y,V;for(let ie=1;ie<u.length;ie++)[U,Y,V]=u[ie],a.push(y,N.y,N.z,y,U.y,U.z,x,N.y,N.z,x,N.y,N.z,y,U.y,U.z,x,U.y,U.z),o.push(0,j.y,j.z,0,Y.y,Y.z,0,j.y,j.z,0,j.y,j.z,0,Y.y,Y.z,0,Y.y,Y.z),l.push(0,K,0,V,1,K,1,K,0,V,1,V),[N,j,K]=[U,Y,V];this.setAttribute("position",new Ne(a,3)),this.setAttribute("normal",new Ne(o,3)),this.setAttribute("uv",new Ne(l,2))}},Bz=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,innerRadiusPercent:38.19,spikes:5,cornerRadius:0,angle:360,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters);return{shape:e.shape&&e.shape instanceof fr?e.shape:new fr,parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??0)})}}static build(e){let{width:t,height:r,innerRadiusPercent:i,spikes:n,cornerRadius:s,angle:a,depth:o,extrudeBevelSize:l,extrudeBevelSegments:c}=e.parameters,u=e.shape,h=t*.5,d=r*.5,p=0,f=0,m=a*Math.PI/360/n,g=Math.PI/2*3*-1,v=h*i/100,y=d*i/100;if(n===3&&i===50){m=2*Math.PI/n;for(let w=0;w<n;w++){let b=m*w,_=p+Math.sin(b)*h,A=f+Math.cos(b)*d;u.addPoint(u.createPoint(_,A))}}else for(let w=0;w<n;w++){let b=p+Math.cos(g)*h,_=f+Math.sin(g)*d;u.addPoint(u.createPoint(b,_)),g+=m,b=p+Math.cos(g)*v,_=f+Math.sin(g)*y,u.addPoint(u.createPoint(b,_)),g+=m}u.isClosed=!0;for(let w=0,b=u.points.length;w<b;w++)u.points[w].roundness=s;u.roundness=s,u.update();let x=Xc.create({shape:u,parameters:{roundness:s,depth:o,extrudeBevelSize:l,extrudeBevelSegments:c}});return Object.assign(x,{userData:{...e,type:"StarGeometry"}})}},gce=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??0)})}}static build(e){let{width:t,height:r}=e.parameters,i=new Ny(t,r);return Object.assign(i,{userData:{...e,type:"TextFrameGeometry"}})}},vce=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,radialSegments:32,tubularSegments:64,arc:Math.PI*2,cornerRadius:30,cornerSegments:8},e.parameters),i=Math.abs(r.width),n=Math.abs(r.height??r.width),s=Math.round(Math.abs(r.depth??r.width*.25));return{parameters:Object.assign(r,{width:i,height:n,depth:s})}}static build(e){let{width:t,height:r,depth:i,radialSegments:n,tubularSegments:s,arc:a,cornerRadius:o,cornerSegments:l}=e.parameters,c=yce(t,r,i,t*.5,a,s,0,0,n,o,l);return c.scale(1,r/t,1),Object.assign(c,{userData:{...e,type:"TorusGeometry"}})}};function yce(e,t,r,i,n,s,a,o,l,c,u){return[t,r]=[r,t],a=t/2,n/=2*Math.PI,n==1&&(c=0),new Lz(!0,e,t,r,i,n,s,a,o,l,c,u)}var xce=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,tubularSegments:64,radialSegments:32,p:2,q:3},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width),tube:r.tube??r.width*.125})}}static build(e){let{width:t,tube:r,tubularSegments:i,radialSegments:n,p:s,q:a}=e.parameters,o=t*.5;o!==r&&(o-=r);let l=new NR(o,r,i,n,s,a);return Object.assign(l,{userData:{...e,type:"TorusKnotGeometry"}})}},wce=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1,isRect:!1},e.parameters);return{shape:e.shape&&e.shape instanceof fr?e.shape:new fr,parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width*(r.isRect?1:Math.sqrt(3)/2)),depth:Math.abs(r.depth??0)})}}static build(e){let{width:t=100,height:r,cornerRadius:i,depth:n,extrudeBevelSize:s,extrudeBevelSegments:a,isRect:o}=e.parameters,l=e.shape,c=t*.5,u=r*.5;o?(l.addPoint(l.createPoint(-c,u)),l.addPoint(l.createPoint(c,-u)),l.addPoint(l.createPoint(-c,-u))):(l.addPoint(l.createPoint(0,u)),l.addPoint(l.createPoint(c,-u)),l.addPoint(l.createPoint(-c,-u))),l.isClosed=!0;for(let d=0,p=l.points.length;d<p;d++)l.points[d].roundness=i;l.roundness=i,l.update();let h=Xc.create({shape:l,parameters:{roundness:i,depth:n,extrudeBevelSize:s,extrudeBevelSegments:a}});return Object.assign(h,{userData:{...e,type:"TriangleGeometry"}})}};function bce(e,t){let r=2*Math.PI;return(e%r+r)%r===(t%r+r)%r}var _ce=new _e,Sce=new _e;function Ace(e,t,r){let i=[new E,new E,new E],n=[new E,new E,new E];return e.extractBasis(i[0],i[1],i[2]),t.extractBasis(n[0],n[1],n[2]),i.forEach((s,a)=>{let o=n[a],l=mt.lerp(s.length(),o.length(),r);s.lerp(o,r).setLength(l)}),new _e().makeBasis(i[0],i[1],i[2])}var Cce=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,height:100,depth:1,subdivisions:12,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3},e.parameters),i=Math.abs(r.width),n=Math.abs(r.height??r.width),s=Math.abs(r.depth??0),a=(t==null?void 0:t.shapeData)??bA.create({parameters:oz}).userData.shape;return{path:e.path??W0.defaultData(),parameters:Object.assign(r,{width:i,height:n,depth:s,extrusion:{...lz,...r.extrusion}}),shapeData:a}}static build(e){if(e.path.points.length>=2){let t=new Mce(e);return Object.assign(t,{userData:{...e,type:"PathGeometry"}})}else return Object.assign(new it,{userData:{...e,type:"PathGeometry"}})}},Mce=class extends it{constructor(e){super(),this.type="PathExtrusionGeometry",this.inputs=e,this.build()}_isGeometryClosed(){return this.inputs.path.isClosed&&this.inputs.parameters.extrusion.depth===1}_isOpenEnded(){let e=this.inputs.parameters.extrusion;return!(this.inputs.path.isClosed&&e.depth===1)||!bce(e.twist,0)||e.startScale!==e.endScale}build(){let e=this._extractPathPoints();if(e.length<2)return;let t=this._computeBasisMatrices(e),{depth:r,offset:i}=this.inputs.parameters.extrusion,n=this.inputs.path.isClosed?e.length:e.length-1,s=Math.floor(i*n),a=this.inputs.path.isClosed?Math.ceil((r+i)*n):Math.ceil(Math.min(1,r+i)*n),o=Math.min(Math.max(2,a-s+1),n+2),l=[],c=[];for(let H=0;H<o;H++){let R=this.inputs.path.isClosed?(H+s)%e.length:Math.min(H+s,e.length-1);l.push(e[R].clone()),c.push(t[R].clone())}let u=(H,R,q)=>{l[H]=l[H].clone().lerp(l[R],q),c[H]=Ace(c[H],c[R],q)},h=0,d=i*n%1;(!this.inputs.path.isClosed||r<=1)&&(d||i===0)&&(h=d,u(0,1,h));let p=0,f=(i+r)*n%1;if((this.inputs.path.isClosed&&r<=1||!this.inputs.path.isClosed&&i+r<1)&&f&&(p=f,u(l.length-1,l.length-2,1-p)),r===0){let H=l.length-1;l[H].copy(l[0]),c[H].copy(c[0])}this._applyPathModifiers(c,h,p);let{bevel:m,bevelSides:g}=this.inputs.parameters.extrusion,v=m>0?this.inputs.parameters.extrusion.capType:"flat",y=5;this.inputs.parameters.extrusion.shape.type==="Custom"&&(y=this.inputs.parameters.extrusion.shape.shapeQuality==="low"?5:12);let{regions:x,infos:w,vertices:b}=this._computeShapePoints(y),_=0,A;v==="round"&&(A=new wA(this.inputs.shapeData,2*m,m,y,g,void 0,!0),_=A.getAttribute("position").count);let S=0,C=0;w.sort((H,R)=>H.start-R.start),w.forEach(H=>{H.verticesStart=S,H.verticesCount=H.continuous.reduce((R,q,F)=>R+(F===0||!q?2:1),0),C+=H.verticesCount,S=C});let M=C*o,T,P=0;if(this._isOpenEnded()&&v==="flat"){try{T=el({windingRule:Nt.ODD,elementType:Lr.POLYGONS,polySize:3,vertexSize:2,strict:!0,contours:x})}catch{T=Az}P=T.vertexCount}let D=M+2*P+_*2,I=M+2*P,B={positions:new Float32Array(D*3),normals:new Float32Array(D*3),uvs:new Float32Array(D*2)},X=[];if(w.forEach(H=>{this._extrudeRegion(H,b,c,l,B,X,this._isGeometryClosed()&&!this._isOpenEnded())}),T&&(this._closeEnd(T,M,X,B,c[0],l[0],!1),this._closeEnd(T,M+P,X,B,c[c.length-1],l[l.length-1],!0)),A){B.positions.set(A.getAttribute("position").array,I*3),B.normals.set(A.getAttribute("normal").array,I*3),B.uvs.set(A.getAttribute("uv").array,I*2);let H=X.length;X.push(...A.getIndex().array.map(F=>F+I)),I+=_,B.positions.set(A.getAttribute("position").array,I*3),B.normals.set(A.getAttribute("normal").array,I*3),B.uvs.set(A.getAttribute("uv").array,I*2);let R=X.length;X.push(...A.getIndex().array.map(F=>F+I)),this.setAttribute("position",new nt(B.positions,3)),this.setAttribute("normal",new nt(B.normals,3)),this.setAttribute("uv",new nt(B.uvs,2)),this.setIndex(X);let q=_ce;q.copy(c[c.length-1]).setPosition(l[l.length-1]),this.applyMatrix4OnRange(q,I,D),q.copy(c[0]).setPosition(l[0]).multiply(Sce.makeScale(1,1,-1)),this.applyMatrix4OnRange(q,I-_,I),this.reverseIndicesOnRange(H,R)}else this.setAttribute("position",new nt(B.positions,3)),this.setAttribute("normal",new nt(B.normals,3)),this.setAttribute("uv",new nt(B.uvs,2)),this.setIndex(X)}_extractPathPoints(){let e=mz(this.inputs.path).getPoints(this.inputs.path.subdivisions);if(e.length<2)return[];let t=[e[0]];return e.forEach(r=>{t[t.length-1].distanceToSquared(r)>.001&&t.push(r)}),this.inputs.path.isClosed&&t[t.length-1].distanceTo(t[0])<.001&&t.pop(),t}_computeBasisMatrices(e){let t=[],r=e.length,i=this.inputs.path.isClosed,n=new E,s=new E,a=new E,o=new E,l=new E(0,1,0);for(let f=0;f<r;f++){let m=e[f],g;f===0?g=i?e[e.length-2]:m.clone().multiplyScalar(2).sub(e[1]):g=e[f-1];let v;f===r-1?v=i?e[1]:m.clone().multiplyScalar(2).sub(e[f-1]):v=e[f+1];let y=m.clone().sub(g).normalize(),x=v.clone().sub(m).normalize(),w=y.clone().add(x).normalize();a.copy(w),f===0&&(w.equals(l)||w.clone().negate().equals(l))&&l.set(0,0,1);let b=l.clone().cross(w).normalize(),_=w.clone().cross(b).normalize();l.copy(_),o.copy(b),f===0&&(n.copy(_),s.copy(w));let A=new _e().makeBasis(b,_,w);t.push(A)}let c=i?s:a,u=i?n:new E(0,1,0),h=c.clone().cross(o).normalize(),d=Math.acos(u.dot(h));if(isNaN(d))return t;let p=u.clone().cross(h);c.dot(p)>0&&(d*=-1);for(let f=1;f<t.length;f++){let m=new _e().makeRotationZ(d*f/t.length);t[f].multiply(m)}return t}_applyPathModifiers(e,t,r){let i=e.length,{angle:n,twist:s,startScale:a,endScale:o}=this.inputs.parameters.extrusion,l=new _e,c=new _e;return e.forEach((u,h)=>{let d=h===0?0:h===i-1?1:(h-t)/(i-(r===0?0:1)-(t+(1-r)));l.makeRotationZ(mt.lerp(n,n+s,d));let p=mt.lerp(a,o,d);c.makeScale(p,p,p),u.multiply(l).multiply(c)}),e}_computeShapePoints(e=12,t=Nt.ODD){let r=this.inputs.shapeData,i=r.extractShapePointsToFlatArray([],e),n=r.shapeHoles.map(c=>{let u=c.extractShapePointsToFlatArray([],e),h=[];for(let d=u.length-1;d>=1;d-=2){let p=u[d-1],f=u[d-0];h.push(p,f)}return h}),s;try{s=el({windingRule:t,elementType:Lr.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[i]})}catch{s=xA}let a;try{a=el({windingRule:Nt.ODD,elementType:Lr.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...n]})}catch{a=Sz}if(!s)throw new Error("error generating geometry");let o=s.elementCount;if(a){s.elementCount+=a.elementCount;for(let c=0;c<a.elements.length;c++){let u=a.elements[c],h=c%2===0?s.vertexCount:0;s.elements.push(u+h)}for(let c=0;c<a.vertexIndices.length;c++){let u=a.vertexIndices[c],h=s.vertexCount;s.vertexIndices.push(u+h)}for(let c=0;c<a.vertices.length;c++){let u=a.vertices[c];s.vertices.push(u)}}for(let c=0,u=s.vertexCount;c<u;c++){let h=c*2;s.vertices[h+0],s.vertices[h+1]}let l=[];for(let c=s.elementCount-1;c>=0;c--){let u=c>=o,h=c*2,d=s.elements[h+0],p=s.elements[h+1],f=d+p,m={start:d,count:p,normals:[],isHole:u,continuous:[],verticesStart:0,verticesCount:0};l.push(m);let g=d,v=f-1,y=d+1,x=r.roundedCurves.length;do{let w=g-d;s.vertices[v*2+0],s.vertices[v*2+1];let b=s.vertices[g*2+0],_=s.vertices[g*2+1],A=s.vertices[y*2+0],S=s.vertices[y*2+1],C=b-A,M=_-S,T=Math.sqrt(C*C+M*M);C/=T,M/=T,m.normals[w*2+0]=-M,m.normals[w*2+1]=C;let P=s.vertexIndices[g];if(Array.isArray(P))m.continuous[w]=!1;else{let[D,I]=r.getCurveIndexFromVertexId(P-1,!0);if(I>0&&I<1)m.continuous[w]=!0;else{let B=I===1?D+1:D-1;B=(B+x)%x;let X=I===1?0:1,H=r.roundedCurves[D].getTangent(I),R=r.roundedCurves[B].getTangent(X);m.continuous[w]=H.dot(R)>.95}}u&&(m.normals[w*2+0]*=-1,m.normals[w*2+1]*=-1),[v,g,y]=[g,y,y+1],y>=f&&(y-=p)}while(y!==d+1)}return{regions:[i,...n],infos:l,vertices:s.vertices}}_insertVertex(e,t,r,i,n){let s=t*2,a=t*3;e.positions[a+0]=r.x,e.positions[a+1]=r.y,e.positions[a+2]=r.z,e.normals[a+0]=i.x,e.normals[a+1]=i.y,e.normals[a+2]=i.z,e.uvs[s+0]=n.x,e.uvs[s+1]=n.y}_extrudeRegion(e,t,r,i,n,s,a){let o=new E,l=new E,c=new E,u=new E,h=new W;r.forEach((p,f)=>{let m=i[f],g=e.verticesStart*r.length+e.verticesCount*f;for(let v=0;v<e.count;v++){let y=(e.start+v)*2;if(o.set(t[y+0],t[y+1],0),c.copy(o).applyMatrix4(p).add(m),e.continuous[v])u.set(e.normals[v*2+0],e.normals[v*2+1],0);else{let x=v===0?(e.start+e.count-1)*2:y-2;l.set(t[x+0],t[x+1],0),u.copy(o).sub(l),u.set(-u.y,u.x,0),e.isHole||u.negate()}if(u.applyMatrix4(p).normalize(),h.set(v===0?1:v/e.count,f/(r.length-1)),this._insertVertex(n,g,c,u,h),g++,!e.continuous[v]||v===0){if(v===0)u.set(e.normals[v*2+0],e.normals[v*2+1],0),h.set(0,f/(r.length-1));else{let x=v===e.count-1?e.start*2:y+2;l.set(t[x+0],t[x+1],0),u.copy(l).sub(o),u.set(-u.y,u.x,0),e.isHole||u.negate()}u.applyMatrix4(p).normalize(),this._insertVertex(n,g,c,u,h),g++}}});let d=r.length-1;for(let p=0;p<d;p++){let f=e.verticesStart*r.length+e.verticesCount*p,m=e.verticesStart*r.length+e.verticesCount*(p+1),g=0;for(let v=0;v<e.count;v++){(!e.continuous[v]||v===0)&&g++;let y=v===e.count-1?0:g+1,x=f+g,w=f+y,b=m+y,_=m+g;e.isHole?s.push(x,b,w,x,_,b):s.push(x,w,b,x,b,_),g++}}}_closeEnd(e,t,r,i,n,s,a){let o=e.vertexCount,l=new E(0,0,a?-1:1).applyMatrix4(n),c=new E,u=new W;for(let d=0;d<o;d++){let p=2*d;c.set(e.vertices[p+0],e.vertices[p+1],0).applyMatrix4(n).add(s),this._insertVertex(i,t+d,c,l,u)}let h=e.elements;for(let d=0;d<e.elementCount;d++){let p=3*d,f=h[p+0]+t,m=h[p+(a?1:2)]+t,g=h[p+(a?2:1)]+t;r.push(f,m,g)}}applyMatrix4OnRange(e,t,r){let i=e.elements,n=new Jr().getNormalMatrix(e).elements,s,a,o,l,c=this.attributes.position,u=this.attributes.normal;if(!c||!u)return;let h=c.array,d=u.array,p=c.itemSize;for(let f=t*p,m=r*p;f<m;f+=p){if(f===t)debugger;s=h[f+0],a=h[f+1],o=h[f+2],l=1/(i[3]*s+i[7]*a+i[11]*o+i[15]),h[f+0]=(i[0]*s+i[4]*a+i[8]*o+i[12])*l,h[f+1]=(i[1]*s+i[5]*a+i[9]*o+i[13])*l,h[f+2]=(i[2]*s+i[6]*a+i[10]*o+i[14])*l,s=d[f+0],a=d[f+1],o=d[f+2],d[f+0]=n[0]*s+n[3]*a+n[6]*o,d[f+1]=n[1]*s+n[4]*a+n[7]*o,d[f+2]=n[2]*s+n[5]*a+n[8]*o}c.needsUpdate=!0,u.needsUpdate=!0}reverseIndicesOnRange(e,t){let r=this.index;if(r){for(let i=e;i<t;i+=3){let n=r.getX(i),s=r.getX(i+1),a=r.getX(i+2);r.setXYZ(i,a,s,n)}r.needsUpdate=!0}}};function zz(){let e=new it;return e.setAttribute("position",new nt(new Float32Array([]),3)),e.setIndex(new nt(new Uint16Array([]),1)),e}var Ece=zz().attributes,Tce=12,Pce=1,kz=class extends it{constructor(e,t){super(),this.charWidths=[],this.charCoords=[],this.wrappedText=[],this.isLowResolution=!1,this.vectorShapes=[],Object.assign(this.attributes,Ece),this.userData={parameters:e,type:"TextGeometry"};let r=t.getFont(e.font);r!=null&&r.isLoaded?(this.font=r,this.update(e)):this.updateFont(e.font,t).then(()=>{this.update(e),t==null||t.requestRender()})}async updateFont(e,t){let r=t.getFont(e);r&&(this.font=r,await r.loadingPromise)}update(e){let t=this.font;if(this.userData={parameters:e,type:"TextGeometry"},!(t!=null&&t.isLoaded)){console.warn("Cannot update text because its font is not loaded");return}let{width:r,height:i,depth:n,extrudeBevelSize:s,extrudeBevelSegments:a,text:o,textTransform:l}=e,c=l===2?o.toUpperCase():l===3?o.toLowerCase():o,u=Dce(e,t,c),{shapes:h,charWidths:d,charCoords:p}=t.generateShapes(u,e),f=r*.5,m=i*.5,g=h.map(x=>new fr().fromShape(x));this.vectorShapes=g;let v=g.map(x=>Xc.create({shape:x,parameters:{depth:n,extrudeBevelSegments:a,extrudeBevelSize:s,windingRule:n<=0?Nt.NONZERO:Nt.ODD,subdivisions:this.isLowResolution&&n>0?Pce:Tce}})),y=v.length?dc(v):zz();y.translate(-f,m,0),this.dispose(),this.wrappedText=u,this.charCoords=p,this.charWidths=d,this.deleteAttribute("extrudeNormal"),Object.entries(y.attributes).forEach(([x,w])=>{this.setAttribute(x,w)}),this.setIndex(y.index),this.computeBoundingSphere()}clone(){let e=Bc(new it,kz.prototype);return e.copy(this),console.log("CloneGeometry",this,e),e}copy(e){return Object.entries(e.attributes).forEach(([t,r])=>{this.setAttribute(t,r)}),this.setIndex(e.index),this.userData={parameters:{...e.userData.parameters},type:"TextGeometry"},this}async setText(e){this.font&&await this.font.loadingPromise,await this.update({...this.userData.parameters,text:e})}get text(){return this.userData.parameters.text??""}};function Dce(e,t,r){r=r??e.text;let i=[""],n="";for(let s of r)n+=s,s===" "||s===`
`?(i[i.length-1]+=n,n="",s===`
`&&i.push("")):t.getTextWidth(i[i.length-1]+n,e)>e.width&&(i[i.length-1].length&&i.push(""),t.getTextWidth(i[i.length-1]+n,e)>e.width&&(n.length===1?(i[i.length-1]+=n,n=""):(i[i.length-1]+=n.slice(0,-1),n=n[n.length-1],i.push(""))));return i[i.length-1]+=n,i}var Nz,_A=new Promise(e=>{Nz=e}),mD=!1,jg;function Lce(){if(mD)return;if(jg)return jg;async function e(){let t="https://unpkg.com/@splinetool/modelling-wasm@0.9.450/build",r=cm(()=>import("./process-10f79362.js"),[]),[i,n]=await Promise.all([r,fetch(`${t}/process.wasm`).then(o=>o.arrayBuffer())]),s=i.default,a=await s({wasmBinary:n});Nz(a),mD=!0}return jg=e(),jg}function ry(e,t,r){let i={parameters:e,type:e.type};if(e.type==="PathGeometry")i.path=e.path;else if(e.type==="VectorGeometry"){let s=fr.createFromState(e.shape,e.width,e.height);i.shape=s}else if(e.type==="NonParametricGeometry")e.data.groups&&e.data.groups.forEach(s=>s.materialIndex=Math.max(s.materialIndex??0,0)),i.geometry=new GR().parse(e);else{if(e.type==="SubdivGeometry")return new Ii(e,r);if(e.type==="TextGeometry")return new kz(e,t)}let n;try{n=wD(i)}catch(s){console.error(s)}if(!n){let s=fr.createFromState(G0.defaultData(),100,100);i.shape=s,n=wD(i)}return n}var Ice=new _e;function x_(e,t,r,i){let n=e.position.array,s=e.normal.array,a=Ice.makeScale(t,r,i).invert().elements,o,l,c;for(var u=0,h=n.length;u<h;u+=3)n[u]*=t,n[u+1]*=r,n[u+2]*=i,o=s[u],l=s[u+1],c=s[u+2],s[u]=a[0]*o+a[4]*l+a[8]*c,s[u+1]=a[1]*o+a[5]*l+a[9]*c,s[u+2]=a[2]*o+a[6]*l+a[10]*c;e.position.needsUpdate=!0,e.normal.needsUpdate=!0}var Vg=new Ar,xh=new E,Ke;_A.then(e=>{Ke=e});var gD=new Float32Array([10,10,0,-10,10,0,-10,-10,0,10,-10,0]),vD=new Uint32Array([0,1,2,3]),yD=new Uint8Array([4]),Ii=class extends it{constructor(e,t){super(),this.data=e,this.flatShading=t,this.subdivPointer=0,this.rebuild(),this.freeSubdivPointer()}mutateDirectlyScaleBaked(e,t){this.freeSubdivPointer();let r=this.data.scaleBaked,i=bc.div(t,r);this.subdividedGeometry&&x_(this.subdividedGeometry.attributes,...i),this.originalGeometry&&x_(this.originalGeometry.attributes,...i),this.data=e;let n=this.userData.parameters;this.userData.parameters={width:n.width*i[0],height:n.height*i[1],depth:n.depth*i[2]},this.originalGeometry.boundingSphere.center.multiply(xh.fromArray(i));let s=xh.set(n.width,n.height,n.depth).length();this.originalGeometry.boundingSphere.radius=s/2}ensureSubdivPointer(){return this.subdivPointer===0&&this.rebuild(),this.subdivPointer}rebuild(){let e,t,r;try{({originalGeometry:e,subdividedGeometry:t,subdivPointer:r}=Ii.build(this.data,void 0,!this.flatShading,void 0))}catch{e=new ma(100,100,100),r=0}this.subdivPointer=r,this.originalGeometry=e,this.subdividedGeometry=t??void 0;let i=this.subdividedGeometry??this.originalGeometry;Object.assign(this,i),this.calcBoundingBox()}freeSubdivPointer(){this.subdivPointer&&(Ii.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0)}dispose(){super.dispose(),this.freeSubdivPointer()}calcBoundingBox(){let e=this.originalGeometry;e.boundingSphere===null&&(e.boundingSphere=new Mn,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=e.boundingSphere));let t=e.attributes.position,r=e.boundingSphere.center;Vg.setFromBufferAttribute(t),Vg.getCenter(r),e.boundingSphere.radius=r.distanceTo(Vg.max),isNaN(e.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),Vg.getSize(xh);let i={width:xh.x,height:xh.y,depth:xh.z};return this.userData.parameters=i,i}static build(e,t,r,i){let n,s,a,o=(e==null?void 0:e.phongAngle)??35;r===!1&&(o=-1),t&&(Ke.free_bvh(t),Ke.free_subdivision_surface(t));try{n=Ii.allocate(e,i)}catch(l){console.error(l,e),n=Ii.allocate({positionWASM:gD,indexWASM:vD,verticesPerFaceWASM:yD},i)}if(Ke.set_destination_refinement_level(n,0),s=Ii.buildLevel(n,!0,o),e.subdivisions>0)try{Ke.set_destination_refinement_level(n,e.subdivisions),a=Ii.buildLevel(n,!1,o)}catch{try{Ke.set_destination_refinement_level(n,e.subdivisions-1),a=Ii.buildLevel(n,!1,o)}catch{a=null}}else a=null;return{subdivPointer:n,originalGeometry:s,subdividedGeometry:a}}static primitiveToQuads(e,t,r){e.widthSegments>16&&(e.widthSegments=16),e.heightSegments>16&&(e.heightSegments=16),e.depthSegments>16&&(e.depthSegments=16),e.radialSegments>16&&(e.radialSegments=16),e.type==="DodecahedronGeometry"&&(e.detail=0);let i=e.shape!==void 0||e.path!==void 0?t.geometry:ry(e,r,!1),n;e.type==="TorusGeometry"&&e.arc===Math.PI*2?n=i.getClosedTorusIndicesForBooleanOrSubdiv():n=i.getIndex();let s,a,o,l;({positions:s,triIndices:l}=i1(i.getAttribute("position"),n));let c;if(e.type==="CylinderGeometry"&&e.cornerRadius===0&&e.hollow===0&&e.openEnded===!1){let u=e.radialSegments*e.heightSegments*3*2,h=u+e.radialSegments*3;c=[u,h]}return{indices:a,verticesPerFace:o}=Fz(s,l,i,c),{positions:s,indices:a,verticesPerFace:o}}static allocate(e,t){var x;let r,i,n,s=[],a=[];e.positionWASM&&e.positionWASM.length>0?(r=e.positionWASM,i=e.indexWASM,n=e.verticesPerFaceWASM):(r=gD,i=vD,n=yD);let o=r.length,l=i.length,c=n.length,u=r.length+s.length+a.length,h=i.length+n.length,d=u*Float32Array.BYTES_PER_ELEMENT+h*Uint32Array.BYTES_PER_ELEMENT,p=u*Float32Array.BYTES_PER_ELEMENT,f=Ke._malloc(d),m=new Float32Array(Ke.HEAPF32.buffer,f,u),g=new Uint32Array(Ke.HEAPU32.buffer,f+p,h);m.set(r,0),m.set(s,r.length),m.set(a,r.length+s.length),g.set(i,0),g.set(n,i.length);let v;(x=e==null?void 0:e.scaleBaked)!=null&&x.some(w=>w!==1)&&(v=new _e().makeScale(...e.scaleBaked)),t&&(v?v.premultiply(t):v=t);let y=v?Ke.alloc_subdivision_surface2(f,o,f+p,l,f+p+i.length*Uint32Array.BYTES_PER_ELEMENT,c,v.elements):Ke.alloc_subdivision_surface(f,o,f+p,l,f+p+i.length*Uint32Array.BYTES_PER_ELEMENT,c);return Ke._free(f),y}static buildLevel(e,t,r,i,n){let s=n?Ke.get_mesh_data2(e,t?Ke.Level.CONTROL:Ke.Level.REFINED,r,n.elements):Ke.get_mesh_data(e,t?Ke.Level.CONTROL:Ke.Level.REFINED,r),a=8,o=Ke.HEAPU32.subarray(s>>2,(s>>2)+a),l=o.subarray(4,4+4),c=0,u=Ke.HEAPU32[o[c]>>2],h=Ke.HEAPF32.subarray(u>>2,(u>>2)+l[c]);c++;let d=Ke.HEAPU32[o[c]>>2],p=Ke.HEAPF32.subarray(d>>2,(d>>2)+l[c]);c++;let f=Ke.HEAPU32[o[c]>>2],m=Ke.HEAPU32.subarray(f>>2,(f>>2)+l[c]);c++;let g=Ke.HEAPU32[o[c]>>2],v=Ke.HEAPU32.subarray(g>>2,(g>>2)+l[c]);if(c++,i===void 0){let y=new it;if(y.setIndex(new gu(v,1)),y.setAttribute("position",new Ne(h,3)),y.setAttribute("normal",new Ne(p,3)),t){y.setAttribute("faceMap",new gu(m,1));let x=new Float32Array(p.length/3*4).fill(0);y.setAttribute("color",new nt(x,4))}return Ke.free_mesh_data(s),y.userData.type="SubdivGeometry",y}i.getAttribute("position").copyArray(h),i.getAttribute("normal").copyArray(p),i.attributes.position.needsUpdate=!0,i.attributes.normal.needsUpdate=!0,Ke.free_mesh_data(s)}static freeSubdivPointer(e){Ke.free_bvh(e),Ke.free_subdivision_surface(e)}static buildControlCageWireframe(e,t,r){let i=Ke.get_wireframe_data_for_base_level(e),n=4,s=Ke.HEAPU32.subarray(i>>2,(i>>2)+n),a=s.subarray(2,2+2),o=0,l=Ke.HEAPU32[s[o]>>2],c=Ke.HEAPF32.subarray(l>>2,(l>>2)+a[o]);o++;let u=Ke.HEAPU32[s[o]>>2],h=Ke.HEAPU32.subarray(u>>2,(u>>2)+a[o]);if(t===void 0){let d=new it;d.setAttribute("position",new Ne(c,3));let p=new Float32Array(c.length);for(let f=0,m=c.length;f<m;)p[f++]=r.r,p[f++]=r.g,p[f++]=r.b;return d.setAttribute("color",new nt(p,3)),d.setIndex(new gu(h,1)),Ke.free_wireframe_data_for_base_level(i),d}t.getAttribute("position").copyArray(c),t.attributes.position.needsUpdate=!0,Ke.free_wireframe_data_for_base_level(i)}static updateCollabMesh(e,t,r){let i=t===0;i||Ke.set_destination_refinement_level(e,t);let n=r?Ke.get_topological_data2(e,i?Ke.Level.CONTROL:Ke.Level.REFINED,r.elements):Ke.get_topological_data(e,i?Ke.Level.CONTROL:Ke.Level.REFINED),s=6,a=Ke.HEAPU32.subarray(n>>2,(n>>2)+s),o=a.subarray(3,3+3),l=0,c=Ke.HEAPU32[a[l]>>2],u=new Float32Array(Ke.HEAPF32.subarray(c>>2,(c>>2)+o[l]));l++;let h=Ke.HEAPU32[a[l]>>2],d=new Uint32Array(Ke.HEAPU32.subarray(h>>2,(h>>2)+o[l]));l++;let p=Ke.HEAPU32[a[l]>>2],f=new Uint8Array(Ke.HEAPU32.subarray(p>>2,(p>>2)+o[l]));return Ke.free_topological_data(n),{positions:u,indices:d,verticesPerFace:f}}},xD=["getX","getY","getZ"];function i1(e,t){let r={},i=t?t.count:e.count,n=0,s=[],a=[],o=1e4;for(let c=0;c<i;c++){let u=t?t.getX(c):c,h="";for(let d=0;d<3;d++)h+=`${~~(e[xD[d]](u)*o)},`;if(h in r)s.push(r[h]);else{for(let d=0;d<3;d++)a.push(e[xD[d]](u));r[h]=n,s.push(n),n++}}let l=[];for(let c=0;c<s.length;c+=3)s[c]===s[c+1]||s[c]===s[c+2]||s[c+1]===s[c+2]||l.push(s[c],s[c+1],s[c+2]);return{positions:a,triIndices:l}}var Hg=new E,pw=new E,fw=new E,mw=new E;function Fz(e,t,r,i){let n=[],s=[];if(r.userData.shape!==void 0&&r.userData.parameters.depth===0&&r.userData.shape.shapeHoles.length===0){let l=r.userData.shape.extractShapePointsToFlatArray([]),c=r.userData.parameters.spikes;if(r.userData.type==="EllipseGeometry"&&c<=24&&c%4===0&&r.userData.parameters.angle>=360){let d=l.length/2/c;l=l.filter((p,f)=>Math.floor(f/2)%d===0)}let u=0;for(let d=0;d<l.length;d+=2)u+=(l[d]-l[(d===0?l.length:d)-2])*(l[d+1]+l[(d===0?l.length:d)-1]);e.length=0;let h=0;if(u<0)for(let d=0;d<l.length;d+=2)e.push(l[d],l[d+1],0),n.push(h++);else for(let d=l.length-2;d>=0;d-=2)e.push(l[d],l[d+1],0),n.push(h++);return s.push(h),{indices:n,verticesPerFace:s}}let a=new Float32Array([r.userData.parameters.depth])[0],o=0;for(;o<t.length;){if(r.useNgonForTopBottomFaceDuringBake){let l=0;if((e[t[o]*3+2]===a||e[t[o]*3+2]===0)&&l++,(e[t[o+1]*3+2]===a||e[t[o+1]*3+2]===0)&&l++,(e[t[o+2]*3+2]===a||e[t[o+2]*3+2]===0)&&l++,l===3)break}if(t[o+1]===t[o+3]&&t[o+2]===t[o+5]||t[o+0]===t[o+3]&&t[o+2]===t[o+4]){Hg.set(e[t[o]*3],e[t[o]*3+1],e[t[o]*3+2]),pw.set(e[t[o+1]*3],e[t[o+1]*3+1],e[t[o+1]*3+2]),fw.set(e[t[o+4]*3],e[t[o+4]*3+1],e[t[o+4]*3+2]),mw.set(e[t[o+5]*3],e[t[o+5]*3+1],e[t[o+5]*3+2]),pw.sub(Hg).normalize(),fw.sub(Hg).normalize(),mw.sub(Hg).normalize();let l=pw.cross(fw).dot(mw);Math.abs(l)>.005||i&&i.some((c,u)=>u%2===1?!1:o>=i[u]&&o<i[u+1])?(n.push(t[o],t[o+1],t[o+2]),s.push(3),o+=3):(n.push(t[o],t[o+1],t[o+4],t[o+5]),s.push(4),o+=6)}else n.push(t[o],t[o+1],t[o+2]),s.push(3),o+=3}if(r.useNgonForTopBottomFaceDuringBake){let l=[],c=[],u=0;for(let h=0,d=0;h<e.length;h+=3,d++)e[h+2]===0&&(l.push(d),u++),e[h+2]===a&&c.push(d);if(r.userData.parameters.extrudeBevelSize===0){let h=c[0];c[0]=c[1],c[1]=h}l.reverse(),n.push(...l,...c),s.push(u,u)}return{indices:n,verticesPerFace:s}}var Ua={};xG(Ua,{calcBoolean:()=>kce,calcBooleanTopological:()=>zce,freeMeshSet:()=>jce,getMeshSet:()=>Nce,hasOpenEdges:()=>Fce,transformMeshSet:()=>Uce});var Uz,Oce=new Promise(e=>{Uz=e}),Gg;function Rce(){if(Gg)return Gg;async function e(){let t="https://unpkg.com/@splinetool/boolean-wasm@0.9.450/build",r=cm(()=>import("./boolean-613a7c9c.js"),[]),[i,n]=await Promise.all([r,fetch(`${t}/boolean.wasm`).then(o=>o.arrayBuffer())]),s=i.default,a=await s({wasmBinary:n});Uz(a)}return Gg=e(),Gg}var xt,Mu;Oce.then(e=>xt=e);function Bce(e,t,r){let i,n;e.userData.parameters.type==="TorusGeometry"&&e.userData.parameters.arc===Math.PI*2?n=e.getClosedTorusIndicesForBooleanOrSubdiv():n=e.getIndex();let{positions:s,triIndices:a}=i1(e.getAttribute("position"),n),o;if(t&&r){let{indices:l,verticesPerFace:c}=Fz(s,a,e);o=c.length,i=[];for(let u=0,h=0;u<o;u++){i.push(c[u]);for(let d=0;d<c[u];d++)i.push(l[h++])}}else{let l=a.length;i=Array(l+l/3),o=0;for(let c=0,u=0;u<i.length;)i[u++]=3,o++,i[u++]=a[c++],i[u++]=a[c++],i[u++]=a[c++]}return{positions:s,faceIndices:i,nFaces:o}}function jz(e){let t=e.length,r=t*Uint32Array.BYTES_PER_ELEMENT,i=t*Float32Array.BYTES_PER_ELEMENT,n=Number.isInteger(e[0])?r:i,s=xt._malloc(n);return(Number.isInteger(e[0])?new Uint32Array(xt.HEAPU32.buffer,s,t):new Float32Array(xt.HEAPF32.buffer,s,t)).set(e,0),s}function Vz(e){switch(e){case 0:return xt.OP.UNION;case 1:return xt.OP.INTERSECTION;case 2:return xt.OP.A_MINUS_B;case 3:return xt.OP.B_MINUS_A;case 4:return xt.OP.SYMMETRIC_DIFFERENCE;case 5:return xt.OP.ALL;default:throw new Error("Unknown boolean operation "+e)}}function zce(e,t){Mu===void 0&&(Mu=xt.init_csg());let r=jz(e),i=xt.csg_calc_topological(Mu,r,e.length,Vz(t));xt._free(r);let n=6,s=xt.HEAPU32.subarray(i>>2,(i>>2)+n),a=s.subarray(3,3+3),o=0,l=xt.HEAPU32[s[o]>>2],c=new Float32Array(xt.HEAPF32.subarray(l>>2,(l>>2)+a[o]));o++;let u=xt.HEAPU32[s[o]>>2],h=new Uint32Array(xt.HEAPU32.subarray(u>>2,(u>>2)+a[o]));o++;let d=xt.HEAPU32[s[o]>>2],p=new Uint8Array(xt.HEAPU32.subarray(d>>2,(d>>2)+a[o]));return xt.free_mesh_data(i),{positions:c,indices:h,verticesPerFace:p}}function kce(e,t,r,i){Mu===void 0&&(Mu=xt.init_csg());let n=jz(e),s=xt.csg_calc(Mu,n,e.length,i,Vz(t));xt._free(n);let a=5,o=xt.HEAPU32.subarray(s>>2,(s>>2)+a),l=o.subarray(2,2+3),c=0,u=xt.HEAPU32[o[c]>>2],h=xt.HEAPF32.subarray(u>>2,(u>>2)+l[c]);c++;let d=xt.HEAPU32[o[c]>>2],p=xt.HEAPF32.subarray(d>>2,(d>>2)+l[c]);c++;let f=l[c];r.setAttribute("position",new Ne(h,3)),r.setAttribute("normal",new Ne(p,3));let m=xt.HEAPF32.subarray((s>>2)+5,(s>>2)+5+6);return r.boundingSphere===null&&(r.boundingSphere=new Mn),r.boundingSphere.center.set(m[0],m[1],m[2]),r.boundingSphere.radius=(m[3]**2+m[4]**2+m[5]**2)**.5,r.userData.parameters={width:m[3]*2,height:m[4]*2,depth:m[5]*2},xt.free_mesh_data(s),f}function Nce(e,t,r){if(xt===void 0)return-1;let i,n,s;if(t&&e.userData.positions!==void 0){let m=e.userData;s=m.verticesPerFace.length,i=m.positions,n=Array(m.verticesPerFace.reduce((g,v)=>g+v,0)+s);for(let g=0,v=0,y=0;g<m.verticesPerFace.length;g++){n[y++]=m.verticesPerFace[g];for(let x=0;x<m.verticesPerFace[g];x++)n[y++]=m.indices[v++]}}else({positions:i,faceIndices:n,nFaces:s}=Bce(e,t,r));let a=i.length,o=n.length,l=i.length,c=n.length,u=l*Float32Array.BYTES_PER_ELEMENT+c*Uint32Array.BYTES_PER_ELEMENT,h=l*Float32Array.BYTES_PER_ELEMENT,d=xt._malloc(u),p=new Float32Array(xt.HEAPF32.buffer,d,l),f=new Uint32Array(xt.HEAPU32.buffer,d+h,c);return p.set(i,0),f.set(n,0),xt.get_csg_mesh(d,a,d+h,o,s)}function Fce(e){return xt.has_open_edges(e)}function Uce(e,t){xt.transform_csg_mesh(e,t.elements)}function jce(e){xt.free_csg_mesh(e)}var Vce={ConeGeometry:yle,CubeGeometry:xle,CylinderGeometry:gz,DodecahedronGeometry:ble,EllipseGeometry:bA,HelixGeometry:Jle,IcosahedronGeometry:ece,LatheGeometry:tce,NonParametricGeometry:lce,PolygonGeometry:Oz,PyramidGeometry:cce,RectangleGeometry:Rz,SphereGeometry:dce,PlaneGeometry:pce,BackdropGeometry:fce,StarGeometry:Bz,TextFrameGeometry:gce,TorusGeometry:vce,TorusKnotGeometry:xce,TriangleGeometry:wce,PathGeometry:Cce,VectorGeometry:Xc},wD=e=>Vce[e.type].create(e);function op(e){return e!==null&&"booleanOp"in e}var Hz=class extends mA(Ki){constructor(){super(...arguments),this.booleanMeshSetAddress=-1,this.booleanWasTransformed=!1,this.booleanMatrixInvOld=new _e}updateVisible(){super.updateVisible(),this.visible=!op(this.parent)&&this.visible,op(this.parent)&&this.parent.invalidateDownstreamBooleanData()}freeBooleanPointer(){this.booleanMeshSetAddress!==-1&&(Ua.freeMeshSet(this.booleanMeshSetAddress),this.booleanMeshSetAddress=-1)}invalidateDownstreamBooleanData(e=!1){return e?this.booleanWasTransformed=!0:this.freeBooleanPointer(),op(this.parent)?this.parent.invalidateDownstreamBooleanData():this}invalidateUpstreamBooleanData(){this.freeBooleanPointer();for(let e of this.children)e instanceof Hz&&(e.freeBooleanPointer(),op(e)&&e.invalidateUpstreamBooleanData())}updateTransformState(e){let t=super.updateTransformState(e);return t&&op(this.parent)&&this.invalidateDownstreamBooleanData(!0),t}},Wg=new Ar;function SA(e,t=0,r=e.count,i,n){let s=1/0,a=1/0,o=1/0,l=-1/0,c=-1/0,u=-1/0;for(let h=t;h<r;h++){let d=e.getX(h),p=e.getY(h),f=e.getZ(h);d<s&&(s=d),p<a&&(a=p),f<o&&(o=f),d>l&&(l=d),p>c&&(c=p),f>u&&(u=f)}Wg.min.set(s,a,o),Wg.max.set(l,c,u),Wg.getCenter(i),Wg.getSize(n).multiplyScalar(.5)}var Hce=new it,Gce=new dm,an=class extends Hz{constructor(e,t){super(Hce,Gce),this.super_Entity(e,t)}updateState(e,t){this.updateState_Entity(e,t)}updateEntityBoxSize(e,t){let r=this.geometry.getAttribute("position");r!==void 0?SA(r,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:r.count,e,t):super.updateEntityBoxSize(e,t)}},bD=class{constructor(e){e=e??{},this.name=e.name,this.type=e.type,this.node=e.node,this.size=e.size,this.needsUpdate=e.needsUpdate}get value(){return this.node.value}set value(e){this.node.value=e}},Il=class{constructor(e){this.hashProperties=void 0,this.isNode=!0,this.shortcuts={},this.uuid=mt.generateUUID(),this.type=e,this.name=""}analyze(e,t){t=t??{},e.analyzing=!0,this.build(e.addFlow(t.slot,t.cache,t.context),"v4"),e.clearVertexNodeCode(),e.clearFragmentNodeCode(),e.removeFlow(),e.analyzing=!1}analyzeAndFlow(e,t,r){return r=r??{},this.analyze(e,r),this.flow(e,t,r)}flow(e,t,r){r=r??{},e.addFlow(r.slot,r.cache,r.context);let i={result:this.build(e,t),code:e.clearNodeCode(),extra:e.context.extra};return e.removeFlow(),i}build(e,t,r){t=t??this.getType(e,t);let i=e.getNodeData(r??this);return e.analyzing&&this.appendDepsNode(e,i,t),e.nodes.indexOf(this)===-1&&e.nodes.push(this),this.updateFrame!==void 0&&e.updaters.indexOf(this)===-1&&e.updaters.push(this),this.generate(e,t,r)}updateFrame(e){}generateReadonly(e,t,r,i,n,s){return""}generate(e,t,r,i,n){return""}parse(e,t,r,i){}appendDepsNode(e,t,r){t.deps=(t.deps||0)+1;let i=e.getTypeLength(r);(i>(t.outputMax||0)||this.getType(e,r))&&(t.outputMax=i,t.output=r)}setName(e){this.name=e}getName(){return this.name}getType(e,t){return t==="sampler2D"||t==="samplerCube"?t:this.type}getHash(){let e="{",t,r;for(t in this)r=this[t],r instanceof Il&&(e+='"'+t+'":'+r.getHash()+",");if(this.hashProperties)for(let i=0;i<this.hashProperties.length;i++)t=this.hashProperties[i],r=this[t],e+='"'+t+'":"'+String(r)+'",';return e+='"id":"'+this.uuid+'"}',e}},Wce=class{constructor(){this.nodes={},this.keywords={}}add(e){this.nodes[e.name]=e}addKeyword(e,t,r){r=r!==void 0?r:!0,this.keywords[e]={callback:t,cache:r}}remove(e){delete this.nodes[e.name]}removeKeyword(e){delete this.keywords[e]}get(e){return this.nodes[e]}getKeyword(e,t){return this.keywords[e].callback(t)}getKeywordData(e){return this.keywords[e]}contains(e){return this.nodes[e]!==void 0}containsKeyword(e){return this.keywords[e]!==void 0}},Yi=new Wce,Ht=class extends Il{constructor(e,t){super(e),this.scope="",t=t??{},this.shared=t.shared!==void 0?t.shared:!0,this.unique=t.unique!==void 0?t.unique:!1}build(e,t,r,i){if(t=t??this.getType(e),this.getShared(e,t)){let n=this.getUnique(e,t);n&&this.uuid===void 0&&(this.uuid=mt.generateUUID()),r=e.getUUID(r??this.getUUID(),!n);let s=e.getNodeData(r),a=s.output||this.getType(e);if(e.analyzing)return(s.deps||0)>0||this.getLabel()?(this.appendDepsNode(e,s,t),this.generate(e,t,r)):super.build(e,t,r);if(n)return s.name=s.name||super.build(e,t,r),s.name;if(!this.getLabel()&&(!this.getShared(e,a)||e.context.ignoreCache||s.deps===1))return super.build(e,t,r);r=this.getUUID(!1);let o=this.getTemp(e,r);if(o)return e.format(o,a,t);{o=super.generate(e,t,r,s.output,i);let l=this.generate(e,a,r);return e.addNodeCode(o+" = "+l+";"),e.format(o,a,t)}}return super.build(e,t,r)}getShared(e,t){return t!=="sampler2D"&&t!=="samplerCube"&&this.shared}getUnique(e,t){return this.unique}setLabel(e){return this.label=e,this}getLabel(){return this.label}getUUID(e){let t=this.uuid;return typeof this.scope=="string"&&(t=this.scope+"-"+t),t}getTemp(e,t){t=t||this.uuid;let r=e.getVars()[t];return r?r.name:void 0}generate(e,t,r,i,n){return this.getShared(e,t)||console.error("TempNode is not shared"),r=r??this.uuid,e.getTempVar(r,i??this.getType(e),n,this.getLabel()).name}},ln=class extends Ht{constructor(e,t){t=t??{},t.shared=t.shared!==void 0?t.shared:!1,super(e,t),this.readonly=!1}setReadonly(e){return this.readonly=e,this.hashProperties=this.readonly?["value"]:void 0,this}getReadonly(){return this.readonly}generate(e,t,r,i,n,s){r=e.getUUID(r??this.getUUID()),i=i??this.getType(e);let a=e.getNodeData(r);return this.getReadonly()&&this.generateReadonly!==void 0?this.generateReadonly(e,t,r,i,n,s):e.isShader("vertex")?(a.vertex||(a.vertex=e.createVertexUniform(i,this,n,s,this.getLabel())),e.format(a.vertex.name,i,t)):(a.fragment||(a.fragment=e.createFragmentUniform(i,this,n,s,this.getLabel())),e.format(a.fragment.name,i,t))}},li=class extends ln{constructor(e=0,t){super("v2"),this.nodeType="Vector2",this.value=e instanceof W?e:new W(e,t)}get x(){return this.value.x}set x(e){this.value.x=e}get y(){return this.value.y}set y(e){this.value.y=e}generateReadonly(e,t,r,i,n,s){return e.format("vec2("+this.value.x+", "+this.value.y+")",i,t)}},kn=class extends ln{constructor(t=0,r,i){super("v3"),this.nodeType="Vector3",this.value=t instanceof E?t:new E(t,r,i)}get x(){return this.value.x}set x(t){this.value.x=t}get y(){return this.value.y}set y(t){this.value.y=t}get z(){return this.value.z}set z(t){this.value.z=t}generateReadonly(t,r,i,n,s,a){return t.format("vec3("+this.value.x+", "+this.value.y+", "+this.value.z+")",n,r)}},nn=class extends $e{constructor(e,t,r,i){super(e,t,r),this.isColorA=!0,this.a=i}setRGBA(e,t,r,i){super.setRGB(e,t,r),this.a=i}copy(e){return super.copy(e),this.a="a"in e?e.a:1,this}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}setStyle(e,t="srgb"){let r;if(e==="transparent")return this.setRGBA(0,0,0,0),this;if(r=/^((?:rgb|hsl)a?)\(([^)]*)\)/.exec(e)){let i,n=r[1],s=r[2];switch(n){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.a=n==="rgba"?parseFloat(i[4]):1,super.setStyle(e,t);break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)%\s*,\s*(\d*\.?\d+)%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.a=n==="hsla"?parseFloat(i[4]):1,super.setStyle(e,t);break}}return super.setStyle(e,t)}get x(){return this.r}get y(){return this.g}get z(){return this.b}get w(){return this.a}set x(e){this.r=e}set y(e){this.g=e}set z(e){this.b=e}set w(e){this.a=e}},ja=class extends ln{constructor(e){super("v4"),this.nodeType="Vector4",this.value=e instanceof nn?e:new nn(e.r,e.g,e.b,e.a)}generateReadonly(e,t,r,i,n,s){return e.format("vec4("+this.value.r+", "+this.value.g+", "+this.value.b+", "+this.value.a+")",i,t)}},qce=/^\s*([a-z_0-9]+)\s([a-z_0-9]+)\s*\((.*?)\)/i,_D=/[a-z_0-9]+/gi,De=class extends Ht{constructor(e,t,r,i,n){super(n),this.src="",this.nodeType="Function",this.useKeywords=!0,this.includes=[],this.extensions={},this.keywords={},this.isMethod=n===void 0,this.isInterface=!1,this.parse(e,t,r,i)}getShared(e,t){return!this.isMethod}getType(e){return e.getTypeByFormat(this.type)}getInputByName(e){if(this.inputs){let t=this.inputs.length;for(;t--;)if(this.inputs[t].name===e)return this.inputs[t]}}getIncludeByName(e){if(this.includes){let t=this.includes.length;for(;t--;)if(this.includes[t].name===e)return this.includes[t]}}generate(e,t,r,i,n){let s,a=0,o=this.src;if(this.includes)for(let c=0;c<this.includes.length;c++)e.include(this.includes[c],this);for(let c in this.extensions)e.extensions[c]=!0;let l=[];for(;s=_D.exec(this.src);)l.push(s);for(let c=0;c<l.length;c++){let u=l[c],h=u[0],d=this.isMethod?!this.getInputByName(h):!0,p=h;if(this.keywords[h]||this.useKeywords&&d&&Yi.containsKeyword(h)){let f=this.keywords[h];if(!f){let m=Yi.getKeywordData(h);m.cache&&(f=e.keywords[h]),f=f||Yi.getKeyword(h,e),m.cache&&(e.keywords[h]=f)}p=f.build(e)}h!==p&&o[u.index+a-1]!=="."&&(o=o.substring(0,u.index+a)+p+o.substring(u.index+h.length+a),a+=p.length-h.length),this.getIncludeByName(p)===void 0&&Yi.contains(p)&&e.include(Yi.get(p))}return t==="source"?o:this.isMethod?(this.isInterface||e.include(this,void 0,o),this.name):e.format("( "+o+" )",this.getType(e),t)}parse(e,t,r,i){if(this.src=e||"",this.includes=t??[],this.extensions=r??{},this.keywords=i??{},this.isMethod){let n=qce.exec(this.src);if(this.inputs=[],n&&n.length==4){this.type=n[1],this.name=n[2];let s=n[3].match(_D);if(s){let a=0;for(;a<s.length;){let o=s[a++],l;o==="in"||o==="out"||o==="inout"?l=s[a++]:(l=o,o="");let c=s[a++];this.inputs.push({name:c,type:l,qualifier:o})}}this.isInterface=this.src.indexOf("{")===-1}else this.type="",this.name=""}}},Xce=/^([a-z_0-9]+)\s([a-z_0-9]+)\s?\=?\s?(.*?)(\;|$)/i,Gz=class extends Ht{constructor(e="",t){super(),this.src="",this.useDefine=!1,this.nodeType="Const",this.parse(e||Gz.PI,void 0,void 0,void 0,t)}getType(e){return e.getTypeByFormat(this.type)}parse(e,t,r,i,n){this.src=e||"";let s,a,o="",l=Xce.exec(e);this.useDefine=n??this.src.charAt(0)==="#",l&&l.length>1?(a=l[1],s=l[2],o=l[3]):(s=this.src,a="f"),this.name=s,this.type=a,this.value=o}build(e,t){if(t==="source"){if(this.value)return this.useDefine?"#define "+this.name+" "+this.value:"const "+this.type+" "+this.name+" = "+this.value+";";if(this.useDefine)return this.src}return e.include(this),e.format(this.name,this.getType(e),t)}generate(e,t,r,i,n){return e.format(this.name,this.getType(e),t)}},kt=Gz;kt.PI="PI",kt.PI2="PI2",kt.RECIPROCAL_PI="RECIPROCAL_PI",kt.RECIPROCAL_PI2="RECIPROCAL_PI2",kt.LOG2="LOG2",kt.EPSILON="EPSILON";var Yce=new RegExp(`^structs*([a-z_0-9]+)s*{s*((.|
)*?)}`,"gim"),Qce=new RegExp("s*(w*?)s*(w*?)(=|;)","gim"),Wz=class extends Ht{constructor(e=""){super(),this.inputs=[],this.src="",this.nodeType="Struct",this.parse(e)}getType(e){return e.getTypeByFormat(this.name)}getInputByName(e){let t=this.inputs.length;for(;t--;)if(this.inputs[t].name===e)return this.inputs[t]}generate(e,t,r,i,n){return t==="source"?this.src+";":e.format("( "+this.src+" )",this.getType(e),t)}parse(e=""){this.src=e,this.inputs=[];let t=Yce.exec(e);if(t){let r=t[2],i;for(;i=Qce.exec(r);)this.inputs.push({type:i[1],name:i[2]});this.name=t[1]}else this.name="";this.type=this.name}},AA=class extends Ht{constructor(e){super("v2",{shared:!1}),this.nodeType="UV",this.index=e??0}generate(e,t){e.requires.uv[this.index]=!0;let r=this.index>0?this.index+1:"",i=e.isShader("vertex")?"uv"+r:"vUv"+r;return e.format(i,this.getType(e),t)}};Yi.addKeyword("uv",function(){return new AA});Yi.addKeyword("uv2",function(){return new AA(1)});var Oh=class extends Ht{constructor(e,t){super("v4"),this.nodeType="ColorSpace",this.input=e,this.method=t??Oh.LINEAR_TO_LINEAR,this.hashProperties=["method"]}static getEncodingComponents(e){switch(e){case fa:return["Linear"];case ut:return["sRGB"];default:return[]}}generate(e,t){var a;let r=this.input.build(e,"v4"),i=this.getType(e),n=Oh.Nodes[this.method],s=e.include(n);if(s===Oh.LINEAR_TO_LINEAR)return e.format(r,i,t);if(((a=n.inputs)==null?void 0:a.length)===2){let o=this.factor.build(e,"f");return e.format(s+"( "+r+", "+o+" )",i,t)}else return e.format(s+"( "+r+" )",i,t)}fromEncoding(e){let t=Oh.getEncodingComponents(e);this.method="LinearTo"+t[0],this.factor=t[1]}fromDecoding(e){let t=Oh.getEncodingComponents(e);this.method=t[0]+"ToLinear",this.factor=t[1]}},aa=Oh;aa.Nodes={LinearToLinear:new De(["vec4 LinearToLinear( in vec4 value ) {","	return value;","}"].join(`
`)),sRGBToLinear:new De(["vec4 sRGBToLinear( in vec4 value ) {","	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );","}"].join(`
`)),LinearTosRGB:new De(["vec4 LinearTosRGB( in vec4 value ) {","	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );","}"].join(`
`))},aa.LINEAR_TO_LINEAR="LinearToLinear",aa.SRGB_TO_LINEAR="sRGBToLinear",aa.LINEAR_TO_SRGB="LinearTosRGB";var Zt=class extends De{constructor(e="",t,r,i,n){super(e,n,i,r,t),this.nodeType="Expression"}},Xa=class extends ln{constructor(e=new jr,t,r,i){super("v4",{shared:!0}),this.nodeType="Texture",this.value=e,this.uv=t??new AA,this.bias=r,this.project=i!==void 0?i:!1}getTexture(e,t){return super.generate(e,t,this.value.uuid,"t")}generate(e,t){if(t==="sampler2D")return this.getTexture(e,t);let r=this.getTexture(e,t),i=this.uv.build(e,this.project?"v4":"v2"),n=this.bias?this.bias.build(e,"f"):void 0;n===void 0&&e.context.bias&&(n=e.context.bias.setTexture(this).build(e,"f"));let s,a;this.project?s="texture2DProj":s=n?"tex2DBias":"tex2D",n?a=s+"( "+r+", "+i+", "+n+" )":a=s+"( "+r+", "+i+" )";let o={include:e.isShader("vertex"),ignoreCache:!0},l=this.getType(e);return e.addContext(o),this.colorSpace=this.colorSpace??new aa(new Zt("",l)),this.colorSpace.fromDecoding(e.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(a),a=this.colorSpace.build(e,l),e.removeContext(),e.format(a,l,t)}},Be=class extends ln{constructor(e){super("f"),this.nodeType="Float",this.value=e??0}generateReadonly(e,t,r,i,n,s){return e.format(this.value+(this.value%1?"":".0"),i,t)}},SD=class extends Ht{constructor(e,t){super(),this.inputs=[],this.nodeType="FunctionCall",this.value=e,this.inputs=t??[]}getFunction(){return this.value}getType(e){return this.value.getType(e)}generate(e,t,r,i,n){i=this.getType(e);let s=this.value,a=s.build(e,t)+"( ",o=[];if(s.inputs){for(let l=0;l<s.inputs.length;l++){let c=s.inputs[l],u=this.inputs[l]||this.inputs[c.name];o.push(u.build(e,e.getTypeByFormat(c.type)))}a+=o.join(", ")+" )"}return e.format(a,i,t)}},qz=class extends Ht{constructor(e,t,r=qz.ADD){super(),this.nodeType="Operator",this.type=e.type,this.a=e,this.b=t,this.op=r}getType(e){let t=this.a.getType(e),r=this.b.getType(e);return e.isTypeMatrix(t)?"v4":e.getTypeLength(r)>e.getTypeLength(t)?r:t}generate(e,t){let r=this.getType(e);this.type=r;let i=this.a.build(e,r),n=this.b.build(e,r);return e.format("( "+i+" "+this.op+" "+n+" )",r,t)}},Hi=qz;Hi.ADD="+",Hi.SUB="-",Hi.MUL="*",Hi.DIV="/";var zt=class extends Ht{constructor(e,t=zt.ABS,r,i){super(),this.nodeType="Math",this.a=e,typeof t!="string"?this.b=t:i=t,typeof r!="string"?this.c=r:i=r,this.method=i,this.hashProperties=["method"]}getNumInputs(e){switch(this.method){case zt.MIX:case zt.CLAMP:case zt.REFRACT:case zt.SMOOTHSTEP:case zt.FACEFORWARD:return 3;case zt.MIN:case zt.MAX:case zt.MOD:case zt.STEP:case zt.REFLECT:case zt.DISTANCE:case zt.DOT:case zt.CROSS:case zt.POW:return 2;default:return 1}}getInputType(e){let t=e.getTypeLength(this.a.getType(e)),r=this.b?e.getTypeLength(this.b.getType(e)):0,i=this.c?e.getTypeLength(this.c.getType(e)):0;return t>r&&t>i?this.a.getType(e):r>i?this.b.getType(e):this.c.getType(e)}getType(e){switch(this.method){case zt.LENGTH:case zt.DISTANCE:case zt.DOT:return"f";case zt.CROSS:return"v3"}return this.getInputType(e)}generate(e,t){let r,i,n,s=this.a?e.getTypeLength(this.a.getType(e)):0,a=this.b?e.getTypeLength(this.b.getType(e)):0,o=this.c?e.getTypeLength(this.c.getType(e)):0,l=this.getInputType(e),c=this.getType(e);switch(this.type=c,this.method){case zt.NEGATE:return e.format("( -"+this.a.build(e,l)+" )",l,t);case zt.INVERT:return e.format("( 1.0 - "+this.a.build(e,l)+" )",l,t);case zt.CROSS:r=this.a.build(e,"v3"),i=this.b.build(e,"v3");break;case zt.STEP:r=this.a.build(e,s===1?"f":l),i=this.b.build(e,l);break;case zt.MIN:case zt.MAX:case zt.MOD:r=this.a.build(e,l),i=this.b.build(e,a===1?"f":l);break;case zt.REFRACT:r=this.a.build(e,l),i=this.b.build(e,l),n=this.c.build(e,"f");break;case zt.MIX:r=this.a.build(e,l),i=this.b.build(e,l),n=this.c.build(e,o===1?"f":l);break;default:r=this.a.build(e,l),this.b&&(i=this.b.build(e,l)),this.c&&(n=this.c.build(e,l));break}let u=[];u.push(r),i&&u.push(i),n&&u.push(n);let h=this.getNumInputs(e);if(u.length!==h)throw Error(`Arguments not match used in "${this.method}". Require ${h}, currently ${u.length}.`);return e.format(this.method+"( "+u.join(", ")+" )",c,t)}},ct=zt;ct.RAD="radians",ct.DEG="degrees",ct.EXP="exp",ct.EXP2="exp2",ct.LOG="log",ct.LOG2="log2",ct.SQRT="sqrt",ct.INV_SQRT="inversesqrt",ct.FLOOR="floor",ct.CEIL="ceil",ct.NORMALIZE="normalize",ct.FRACT="fract",ct.SATURATE="saturate",ct.SIN="sin",ct.COS="cos",ct.TAN="tan",ct.ASIN="asin",ct.ACOS="acos",ct.ARCTAN="atan",ct.ABS="abs",ct.SIGN="sign",ct.LENGTH="length",ct.NEGATE="negate",ct.INVERT="invert",ct.MIN="min",ct.MAX="max",ct.MOD="mod",ct.STEP="step",ct.REFLECT="reflect",ct.DISTANCE="distance",ct.DOT="dot",ct.CROSS="cross",ct.POW="pow",ct.MIX="mix",ct.CLAMP="clamp",ct.REFRACT="refract",ct.SMOOTHSTEP="smoothstep",ct.FACEFORWARD="faceforward";var Dp=class extends Ht{constructor(e,t,r){super("v4"),this.nodeType="TextureCubeUV",this.value=e,this.uv=t,this.bias=r}bilinearCubeUV(e,t,r,i){let n=new SD(Dp.Nodes.bilinearCubeUV,[t,r,i]);this.colorSpaceTL=this.colorSpaceTL??new aa(new Zt("","v4")),this.colorSpaceTL.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTL.input.parse(n.build(e)+".tl"),this.colorSpaceTR=this.colorSpaceTR??new aa(new Zt("","v4")),this.colorSpaceTR.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTR.input.parse(n.build(e)+".tr"),this.colorSpaceBL=this.colorSpaceBL??new aa(new Zt("","v4")),this.colorSpaceBL.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBL.input.parse(n.build(e)+".bl"),this.colorSpaceBR=this.colorSpaceBR??new aa(new Zt("","v4")),this.colorSpaceBR.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBR.input.parse(n.build(e)+".br");let s={include:e.isShader("vertex"),ignoreCache:!0};e.addContext(s),this.colorSpaceTLExp=new Zt(this.colorSpaceTL.build(e,"v4"),"v4"),this.colorSpaceTRExp=new Zt(this.colorSpaceTR.build(e,"v4"),"v4"),this.colorSpaceBLExp=new Zt(this.colorSpaceBL.build(e,"v4"),"v4"),this.colorSpaceBRExp=new Zt(this.colorSpaceBR.build(e,"v4"),"v4"),e.removeContext();let a=new Zt("mix( mix( cubeUV_TL, cubeUV_TR, cubeUV.f.x ), mix( cubeUV_BL, cubeUV_BR, cubeUV.f.x ), cubeUV.f.y )","v4");return a.keywords.cubeUV_TL=this.colorSpaceTLExp,a.keywords.cubeUV_TR=this.colorSpaceTRExp,a.keywords.cubeUV_BL=this.colorSpaceBLExp,a.keywords.cubeUV_BR=this.colorSpaceBRExp,a.keywords.cubeUV=n,a}generate(e,t){if(e.isShader("fragment")){let r=this.uv,i=this.bias||e.context.roughness,n=new SD(Dp.Nodes.roughnessToMip,[i]),s=new ct(n,Dp.Nodes.m0,Dp.Nodes.cubeUV_maxMipLevel,ct.CLAMP),a=new ct(s,ct.FLOOR),o=new ct(s,ct.FRACT),l=this.bilinearCubeUV(e,this.value,r,a),c=this.bilinearCubeUV(e,this.value,r,new Hi(a,new Be(1).setReadonly(!0),Hi.ADD)),u=new ct(l,c,o,ct.MIX);return e.format(u.build(e),"v4",t)}else return console.warn("TextureCubeUVNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.getType(e),t)}},w_=Dp;w_.Nodes=function(){let e=new Wz(`struct TextureCubeUVData {
			vec4 tl;
			vec4 tr;
			vec4 br;
			vec4 bl;
			vec2 f;
		}`),t=new kt("float cubeUV_maxMipLevel 8.0",!0),r=new kt("float cubeUV_minMipLevel 4.0",!0),i=new kt("float cubeUV_maxTileSize 256.0",!0),n=new kt("float cubeUV_minTileSize 16.0",!0),s=new De(`float getFace(vec3 direction) {
				vec3 absDirection = abs(direction);
				float face = -1.0;
				if (absDirection.x > absDirection.z) {
					if (absDirection.x > absDirection.y)
						face = direction.x > 0.0 ? 0.0 : 3.0;
					else
						face = direction.y > 0.0 ? 1.0 : 4.0;
				} else {
					if (absDirection.z > absDirection.y)
						face = direction.z > 0.0 ? 2.0 : 5.0;
					else
						face = direction.y > 0.0 ? 1.0 : 4.0;
				}
				return face;
		}`);s.useKeywords=!1;let a=new De(`vec2 getUV(vec3 direction, float face) {
				vec2 uv;
				if (face == 0.0) {
					uv = vec2(direction.z, direction.y) / abs(direction.x); // pos x
				} else if (face == 1.0) {
					uv = vec2(-direction.x, -direction.z) / abs(direction.y); // pos y
				} else if (face == 2.0) {
					uv = vec2(-direction.x, direction.y) / abs(direction.z); // pos z
				} else if (face == 3.0) {
					uv = vec2(-direction.z, direction.y) / abs(direction.x); // neg x
				} else if (face == 4.0) {
					uv = vec2(-direction.x, direction.z) / abs(direction.y); // neg y
				} else {
					uv = vec2(direction.x, direction.y) / abs(direction.z); // neg z
				}
				return 0.5 * (uv + 1.0);
		}`);a.useKeywords=!1;let o=new De(`TextureCubeUVData bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {
			float face = getFace(direction);
			float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);
			mipInt = max(mipInt, cubeUV_minMipLevel);
			float faceSize = exp2(mipInt);
			float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);
			vec2 uv = getUV(direction, face) * (faceSize - 1.0);
			vec2 f = fract(uv);
			uv += 0.5 - f;
			if (face > 2.0) {
				uv.y += faceSize;
				face -= 3.0;
			}
			uv.x += face * faceSize;
			if(mipInt < cubeUV_maxMipLevel){
				uv.y += 2.0 * cubeUV_maxTileSize;
			}
			uv.y += filterInt * 2.0 * cubeUV_minTileSize;
			uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);
			uv *= texelSize;
			vec4 tl = texture2D(envMap, uv);
			uv.x += texelSize;
			vec4 tr = texture2D(envMap, uv);
			uv.y += texelSize;
			vec4 br = texture2D(envMap, uv);
			uv.x -= texelSize;
			vec4 bl = texture2D(envMap, uv);
			return TextureCubeUVData( tl, tr, br, bl, f );
		}`,[e,s,a,t,r,i,n]);o.useKeywords=!1;let l=new kt("float r0 1.0",!0),c=new kt("float v0 0.339",!0),u=new kt("float m0 -2.0",!0),h=new kt("float r1 0.8",!0),d=new kt("float v1 0.276",!0),p=new kt("float m1 -1.0",!0),f=new kt("float r4 0.4",!0),m=new kt("float v4 0.046",!0),g=new kt("float m4 2.0",!0),v=new kt("float r5 0.305",!0),y=new kt("float v5 0.016",!0),x=new kt("float m5 3.0",!0),w=new kt("float r6 0.21",!0),b=new kt("float v6 0.0038",!0),_=new kt("float m6 4.0",!0),A=[l,c,u,h,d,p,f,m,g,v,y,x,w,b,_],S=new De(`float roughnessToMip(float roughness) {
			float mip = 0.0;
			if (roughness >= r1) {
				mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;
			} else if (roughness >= r4) {
				mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;
			} else if (roughness >= r5) {
				mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;
			} else if (roughness >= r6) {
				mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;
			} else {
				mip = -2.0 * log2(1.16 * roughness);// 1.16 = 1.79^0.25
			}
			return mip;
		}`,A);return{bilinearCubeUV:o,roughnessToMip:S,m0:u,cubeUV_maxMipLevel:t}}();var Rh=class extends Ht{constructor(e){super("v3"),this.nodeType="Normal",this.scope=e??Rh.VIEW}getShared(){return this.scope===Rh.WORLD}build(e,t,r,i){let n=e.context[this.scope+"Normal"];return n?n.build(e,t,r,i):super.build(e,t,r)}generate(e,t,r,i,n){let s;switch(this.scope){case Rh.VIEW:e.isShader("vertex")?s="transformedNormal":s="geometryNormal";break;case Rh.LOCAL:e.isShader("vertex")?s="objectNormal":(e.requires.normal=!0,s="vObjectNormal");break;case Rh.WORLD:e.isShader("vertex")?s="inverseTransformDirection( transformedNormal, viewMatrix ).xyz":(e.requires.worldNormal=!0,s="vWNormal");break}return e.format(s,this.getType(e),t)}},Zi=Rh;Zi.LOCAL="local",Zi.WORLD="world",Zi.VIEW="view",Zi.NORMAL="normal";Yi.addKeyword("viewNormal",function(){return new Zi(Zi.VIEW)});Yi.addKeyword("localNormal",function(){return new Zi(Zi.NORMAL)});Yi.addKeyword("worldNormal",function(){return new Zi(Zi.WORLD)});var ka=class extends Ht{constructor(e){super("v3"),this.nodeType="Position",this.scope=e??ka.LOCAL}getType(){switch(this.scope){case ka.PROJECTION:return"v4"}return this.type}getShader(){switch(this.scope){case ka.LOCAL:case ka.WORLD:return!1}return!0}generate(e,t,r,i,n){let s;switch(this.scope){case ka.LOCAL:e.isShader("vertex")?s="transformed":(e.requires.position=!0,s="vPosition");break;case ka.WORLD:if(e.isShader("vertex"))return"( modelMatrix * vec4( transformed, 1.0 ) ).xyz";e.requires.worldPosition=!0,s="vWPosition";break;case ka.VIEW:s=e.isShader("vertex")?"-mvPosition.xyz":"vViewPosition";break;case ka.PROJECTION:s=e.isShader("vertex")?"( projectionMatrix * modelViewMatrix * vec4( position, 1.0 ) )":"vec4( 0.0 )";break}return e.format(s,this.getType(),t)}},Ss=ka;Ss.LOCAL="local",Ss.WORLD="world",Ss.VIEW="view",Ss.PROJECTION="projection";Yi.addKeyword("position",function(){return new Ss});Yi.addKeyword("worldPosition",function(){return new Ss(Ss.WORLD)});Yi.addKeyword("viewPosition",function(){return new Ss(Ss.VIEW)});var Xs=class extends Ht{constructor(e){super("v3"),this.nodeType="Reflect",this.scope=e??Xs.CUBE}getUnique(e){return!e.context.viewNormal}getType(){switch(this.scope){case Xs.SPHERE:return"v2"}return this.type}generate(e,t){let r=this.getUnique(e);if(e.isShader("fragment")){let i;switch(this.scope){case Xs.VECTOR:{let n=new Zi(Zi.VIEW),s=e.context.roughness,a=n.build(e,"v3"),o=new Ss(Ss.VIEW).build(e,"v3"),l=s?s.build(e,"f"):void 0,c=`reflect( -normalize( ${o} ), ${a} )`;l&&(c=`normalize( mix( ${c}, ${a}, ${l} * ${l} ) )`);let u=`inverseTransformDirection( ${c}, viewMatrix )`;r?(e.addNodeCode(`vec3 reflectVec = ${u};`),i="reflectVec"):i=u;break}case Xs.CUBE:{let n=new Xs(Xs.VECTOR).build(e,"v3"),s="vec3( -"+n+".x, "+n+".yz )";r?(e.addNodeCode(`vec3 reflectCubeVec = ${s};`),i="reflectCubeVec"):i=s;break}case Xs.SPHERE:{let n="normalize( ( viewMatrix * vec4( "+new Xs(Xs.VECTOR).build(e,"v3")+", 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) ).xy * 0.5 + 0.5";r?(e.addNodeCode(`vec2 reflectSphereVec = ${n};`),i="reflectSphereVec"):i=n;break}}return e.format(i,this.getType(),t)}else return console.warn("ReflectNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.type,t)}},Eu=Xs;Eu.CUBE="cube",Eu.SPHERE="sphere",Eu.VECTOR="vector";var Kce=class extends Ht{constructor(e=new Xa,t,r){super("v4"),this.nodeType="TextureCube",this.value=e,this.radianceNode=new w_(this.value,t??new Eu(Eu.VECTOR),r),this.irradianceNode=new w_(this.value,new Zi(Zi.WORLD),new Be(1).setReadonly(!0))}generate(e,t){return e.isShader("fragment")?(e.require("irradiance"),e.context.bias&&e.context.bias.setTexture(this.value),(e.slot==="irradiance"?this.irradianceNode:this.radianceNode).build(e,t)):(console.warn("TextureCubeNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.getType(e),t))}},Zce=class extends ln{constructor(e=new A3,t,r){super("v4",{shared:!0}),this.nodeType="CubeTexture",this.value=e,this.uv=t??new Eu,this.bias=r}getTexture(e,t){return super.generate(e,t,this.value.uuid,"tc")}generate(e,t){var l;if(t==="samplerCube")return this.getTexture(e,t);let r=this.getTexture(e,t),i=(l=this.uv)==null?void 0:l.build(e,"v3"),n=this.bias?this.bias.build(e,"f"):void 0;n===void 0&&e.context.bias&&(n=e.context.bias.setTexture(this).build(e,"f"));let s;n?s="texCubeBias( "+r+", "+i+", "+n+" )":s="texCube( "+r+", "+i+" )";let a={include:e.isShader("vertex"),ignoreCache:!0},o=this.getType(e);return e.addContext(a),this.colorSpace=this.colorSpace??new aa(new Zt("",o)),this.colorSpace.fromDecoding(e.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(s),s=this.colorSpace.build(e,o),e.removeContext(),e.format(s,o,t)}},$ce=`
uniform int frameIndex;
uniform vec2 resolution;
uniform mat4 previousModelViewMatrix;
uniform mat4 previousProjectionMatrix;

varying vec4 vCurrentPosition;
varying vec4 vPreviousPosition;
`,Jce=`
layout(location = 1) out vec4 gVelocity;

uniform int frameIndex;
uniform vec2 resolution;

varying vec4 vCurrentPosition;
varying vec4 vPreviousPosition;

const vec2 haltonSequence[16] = vec2[16](
vec2( 0.000000,-0.333334),
vec2(-0.500000, 0.333334),
vec2( 0.500000,-0.777778),
vec2(-0.750000,-0.111112),
vec2( 0.250000, 0.555556),
vec2(-0.250000,-0.555556),
vec2( 0.750000, 0.111112),
vec2(-0.875000, 0.777778),
vec2(0.125000, -0.925926),
vec2(-0.375000, -0.259260),
vec2(0.625000, 0.407408),
vec2(-0.625000, -0.703704),
vec2(0.375000, -0.037038),
vec2(-0.125000, 0.629630),
vec2(0.875000, -0.481482),
vec2(-0.937500, 0.185186));

vec2 vogelDiskSample(int sampleIndex, int sampleCount, float angle) {
  const float goldenAngle = 2.399963f; // radians
  float r = sqrt(float(sampleIndex) + 0.5f) / sqrt(float(sampleCount));
  float theta = float(sampleIndex) * goldenAngle + angle;
  float sine = sin(theta);
  float cosine = cos(theta);
  return vec2(cosine, sine) * r;
}

// Derived from the interleaved gradient function from Jimenez 2014 http:goo.gl/eomGso
float getNoiseInterleavedGradient(vec2 screenPos) {
    vec3 magic = vec3(0.06711056f, 0.00583715f, 52.9829189f);
    return fract(magic.z * fract(dot(screenPos, magic.xy)));
}

`,ehe=`
// TODO: This could be generated CPU side and passed to the shader every frame
const vec2 haltonSequence[16] = vec2[16](
vec2( 0.000000,-0.333334),
vec2(-0.500000, 0.333334),
vec2( 0.500000,-0.777778),
vec2(-0.750000,-0.111112),
vec2( 0.250000, 0.555556),
vec2(-0.250000,-0.555556),
vec2( 0.750000, 0.111112),
vec2(-0.875000, 0.777778),
vec2(0.125000, -0.925926),
vec2(-0.375000, -0.259260),
vec2(0.625000, 0.407408),
vec2(-0.625000, -0.703704),
vec2(0.375000, -0.037038),
vec2(-0.125000, 0.629630),
vec2(0.875000, -0.481482),
vec2(-0.937500, 0.185186));

// TODO: Pass correct view size
vec2 offset = haltonSequence[frameIndex];
offset.x /= resolution.x;
offset.y /= resolution.y;

vec4 currentPosition = gl_Position;
vec4 currentPositionJittered = currentPosition + (vec4(offset.x, offset.y, 0.0, 0.0) * currentPosition.w);

// We want to calculate the velocity with unjittered positions
// so that things that are not moving get a velocity = 0
vCurrentPosition = currentPosition;
vPreviousPosition = previousProjectionMatrix * previousModelViewMatrix * vec4(transformed, 1.0);
#ifdef OUTLINE_COMPENSATION
vPreviousPosition.xy += OUTLINE_COMPENSATION;
#endif
gl_Position = currentPositionJittered;

`,the=`
vec2 oldPos = vPreviousPosition.xy;
    oldPos /= vPreviousPosition.w;
    oldPos.xy = (oldPos.xy+1.)/2.0;

vec2 newPos = vCurrentPosition.xy;
    newPos /= vCurrentPosition.w;
    newPos.xy = (newPos.xy+1.)/2.0;

vec2 velocity = (newPos - oldPos);

// Discard fully transparent pixels 
if (gl_FragColor.a <= 0.0) discard;

gVelocity = vec4(velocity, 0.0, 1.0);
`,AD=["x","y","z","w"],rhe=["float","vec2","vec3","vec4"],ihe={float:"f",vec2:"v2",vec3:"v3",vec4:"v4",mat4:"v4",int:"i",bool:"b","float[]":"f[]","vec4[]":"v4[]"},nhe={t:"sampler2D",tc:"samplerCube",b:"bool",i:"int",f:"float",c:"vec3",v2:"vec2",v3:"vec3",v4:"vec4",m3:"mat3",m4:"mat4","f[]":"float[]","v4[]":"vec4[]"},she=class{constructor(){this.includes={consts:{},functions:{},structs:{}},this.cache="",this.slot="",this.shader="",this.context={},this.needsJitter=!0,this.getIncludesCode=function(){function e(t,r){return t.deps.length-r.deps.length}return function(t,r){let i=this.getIncludes(t,r);if(!i)return"";let n="";i=i.sort(e);for(let s=0;s<i.length;s++)i[s].src&&(n+=i[s].src+`
`);return n}}(),this.slots=[],this.caches=[],this.contexts=[],this.keywords={},this.nodeData={},this.fragmentVariables={},this.fragmentParsVariables={},this.vertexParsVariables={},this.requires={uv:[],color:[],transparent:!1,irradiance:!1,position:!1,worldPosition:!1,normal:!1,worldNormal:!1,vWorldViewDir:!1,modelMatrix:!1,viewMatrix:!1,projectionMatrix:!1},this.includes={consts:[],functions:[],structs:[]},this.attributes={},this.prefixCode=["#ifdef TEXTURE_LOD_EXT","	#define texCube(a, b) textureCube(a, b)","	#define texCubeBias(a, b, c) textureCubeLodEXT(a, b, c)","	#define tex2D(a, b) texture2D(a, b)","	#define tex2DBias(a, b, c) texture2DLodEXT(a, b, c)","#else","	#define texCube(a, b) textureCube(a, b)","	#define texCubeBias(a, b, c) textureCube(a, b, c)","	#define tex2D(a, b) texture2D(a, b)","	#define tex2DBias(a, b, c) texture2D(a, b, c)","#endif",`
			// NOTE: Include Spline's blending modes. This could be part of BlendNode
			#define SPE_BLENDING_NORMAL 0
			#define SPE_BLENDING_MULTIPLY 1
			#define SPE_BLENDING_SCREEN 2
			#define SPE_BLENDING_OVERLAY 3

			vec3 spe_normalBlend( vec3 a, vec3 b, float alpha ) {
				return mix( a, b, alpha );
			}

			vec3 spe_multiplyBlend( vec3 a, vec3 b, float alpha ) {
				return mix( a, a * b, alpha );
			}

			vec3 spe_screenBlend( vec3 a, vec3 b, float alpha ) {
				vec3 tmp = 1.0 - ( 1.0 - a ) * ( 1.0 - b );
				return mix( a, tmp, alpha );
			}

			vec3 spe_overlayBlend( vec3 a, vec3 b, float alpha ) {
				vec3 tmp = mix( 1. - 2. * (1. - a) * (1. - b), 2. * a * b, step( a, vec3(.5) ) );
				return clamp( mix( a, tmp, alpha ), 0.0, 1.0 );
			}

			vec3 spe_blend( vec3 a, vec3 b, float alpha, int mode ) {
				if ( mode == SPE_BLENDING_NORMAL ) return spe_normalBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_MULTIPLY ) return spe_multiplyBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_SCREEN ) return spe_screenBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_OVERLAY ) return spe_overlayBlend( a, b, alpha );
				return vec3( 1.0 );
			}
			`,"#include <packing>","#include <common>"].join(`
`),this.parsCode={vertex:["float neighbor_offset = 0.0001;",""].join(`
`),fragment:["float accumAlpha = 0.0;",`void accumulateAlpha(float alpha) {
					accumAlpha += (1.0 - accumAlpha) * alpha;
				}`,""].join(`
`)},this.code={vertex:"",fragment:""},this.nodeCode={vertex:"",fragment:""},this.resultCode={vertex:"",fragment:""},this.finalCode={vertex:"",fragment:""},this.inputs={uniforms:{list:[],vertex:[],fragment:[]},arrayUniforms:{list:[],vertex:[],fragment:[]},vars:{varying:[],vertex:[],fragment:[]}},this.defines={},this.uniforms={},this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.updaters=[],this.nodes=[],this.analyzing=!1}build(e,t){this.addVertexParsCode($ce),this.addFragmentParsCode(Jce),this.buildShader("vertex",e),this.buildShader("fragment",t);for(let r=0;r<this.requires.uv.length;r++)if(this.requires.uv[r]){let i=r>0?r+1:"";this.addVaryCode("varying vec2 vUv"+i+";"),r>0&&this.addVertexParsCode("attribute vec2 uv"+i+";"),this.addVertexFinalCode("vUv"+i+" = uv"+i+";")}return this.requires.color[0]&&(this.addVaryCode("varying vec4 vColor;"),this.addVertexParsCode("attribute vec4 color;"),this.addVertexFinalCode("vColor = color;")),this.requires.color[1]&&(this.addVaryCode("varying vec4 vColor2;"),this.addVertexParsCode("attribute vec4 color2;"),this.addVertexFinalCode("vColor2 = color2;")),this.requires.position&&(this.addVaryCode("varying vec3 vPosition;"),this.addVertexFinalCode("vPosition = transformed;")),this.requires.worldPosition,this.requires.normal&&(this.addVaryCode("varying vec3 vObjectNormal;"),this.addVertexFinalCode("vObjectNormal = normal;")),this.requires.modelMatrix&&this.addFragmentParsCode("uniform mat4 modelMatrix;"),this.requires.viewMatrix&&this.addFragmentParsCode("uniform mat4 viewMatrix;"),this.requires.projectionMatrix&&this.addFragmentParsCode("uniform mat4 projectionMatrix;"),this.requires.worldNormal&&(this.addVaryCode("varying vec3 vWNormal;"),this.addVertexFinalCode("vWNormal = inverseTransformDirection( transformedNormal, viewMatrix ).xyz;")),this.requires.vWorldViewDir&&(this.addVaryCode("varying vec3 vWorldViewDir;"),this.addVertexFinalCode("vWorldViewDir = isPerspectiveMatrix( projectionMatrix ) ?  ( (modelMatrix * vec4(position, 1.0)).xyz - cameraPosition ) : vec3( -viewMatrix[0][2], -viewMatrix[1][2], -viewMatrix[2][2] );")),this.needsJitter&&(this.addVertexFinalCode(ehe),this.addFragmentFinalCode(the)),this}buildShader(e,t){this.resultCode[e]=t.build(this.setShader(e),"v4")}setMaterial(e,t){return this.defines={},this}addFlow(e,t,r){return this.addSlot(e).addCache(t).addContext(r)}removeFlow(){return this.removeSlot().removeCache().removeContext()}addCache(e){return this.cache=e??"",this.caches.push(this.cache),this}removeCache(){return this.caches.pop(),this.cache=this.caches[this.caches.length-1]||"",this}addContext(e){return this.context=Object.assign({},this.context,e),this.context.extra=this.context.extra||{},this.contexts.push(this.context),this}removeContext(){return this.contexts.pop(),this.context=this.contexts[this.contexts.length-1]||{},this}addSlot(e){return this.slot=e||"",this.slots.push(this.slot),this}removeSlot(){return this.slots.pop(),this.slot=this.slots[this.slots.length-1]||"",this}addFragmentVariable(e,t){this.fragmentVariables[e]===void 0&&(this.addFragmentCode(`${t} ${e};`),this.fragmentVariables[e]="")}addFragmentParsVariable(e,t){this.fragmentParsVariables[e]===void 0&&(this.addFragmentParsCode(`${t} ${e};`),this.fragmentParsVariables[e]="")}addVertexParsVariable(e,t){this.vertexParsVariables[e]===void 0&&(this.addVertexParsCode(`${t} ${e};`),this.vertexParsVariables[e]="")}addVertexCode(e){this.addCode(e,"vertex")}addFragmentCode(e){this.addCode(e,"fragment")}addCode(e,t){this.code[t??this.shader]+=e+`
`}addVertexNodeCode(e){this.addNodeCode(e,"vertex")}addFragmentNodeCode(e){this.addNodeCode(e,"fragment")}addNodeCode(e,t){this.nodeCode[t??this.shader]+=e+`
`}clearNodeCode(e){e=e??this.shader;let t=this.nodeCode[e];return this.nodeCode[e]="",t}clearVertexNodeCode(){return this.clearNodeCode("vertex")}clearFragmentNodeCode(){return this.clearNodeCode("fragment")}addVertexFinalCode(e){this.addFinalCode(e,"vertex")}addFragmentFinalCode(e){this.addFinalCode(e,"fragment")}addFinalCode(e,t){this.finalCode[t??this.shader]+=e+`
`}addVertexParsCode(e){this.addParsCode(e,"vertex")}addFragmentParsCode(e){this.addParsCode(e,"fragment")}addParsCode(e,t){this.parsCode[t??this.shader]+=e+`
`}addVaryCode(e){this.addVertexParsCode(e),this.addFragmentParsCode(e)}isCache(e){return this.caches.indexOf(e)!==-1}isSlot(e){return this.slots.indexOf(e)!==-1}define(e,t){this.defines[e]=t===void 0?1:t}require(e){this.requires[e]=!0}isDefined(e){return this.defines[e]!==void 0}getVar(e,t,r,i="varying",n="V",s=""){let a=this.getVars(i),o=a[e];if(!o){let l=a.length;o={name:r||"node"+n+l+(s?"_"+s:""),type:t},a.push(o),a[e]=o}return o}getTempVar(e,t,r,i){return this.getVar(e,t,r,this.shader,"T",i)}getAttribute(e,t){if(!this.attributes[e]){let r=this.getVar(e,t);this.addVertexParsCode("attribute "+t+" "+e+";"),this.addVertexFinalCode(r.name+" = "+e+";"),this.attributes[e]={varying:r,name:e,type:t}}return this.attributes[e]}getCode(e){return[this.prefixCode,this.parsCode[e],this.getVarListCode(this.getVars("varying"),"varying"),this.getVarListCode(this.inputs.uniforms[e],"uniform"),this.getVarListCode(this.inputs.arrayUniforms[e],"uniform"),this.getIncludesCode("consts",e),this.getIncludesCode("structs",e),this.getIncludesCode("functions",e),"void main() {",this.getVarListCode(this.getVars(e)),this.code[e],this.resultCode[e],this.finalCode[e],"}"].join(`
`)}getVarListCode(e,t){t=t??"";let r="";for(let i=0,n=e.length;i<n;++i){let s=e[i],a=s.type,o=s.name,l=s.size,c=this.getFormatByType(a);if(c===void 0)throw new Error("Node pars "+c+" not found.");c.includes("[]")?r+=t+" "+c.substring(0,c.length-2)+" "+o+`[${l}];
`:r+=t+" "+c+" "+o+`;
`}return r}getVars(e){return this.inputs.vars[e??this.shader]}getNodeData(e){let t=e instanceof Il?e.uuid:e;return this.nodeData[t]=this.nodeData[t]||{}}createUniform(e,t,r,i,n,s){if(t.includes("[]")){let a=this.inputs.arrayUniforms,o=a.list.length,l=new bD({type:t,size:r.size,name:i||"nodeUA"+o+(s?"_"+s:""),node:r,needsUpdate:n});return a.list.push(l),a[e].push(l),a[e][l.name]=l,this.uniforms[l.name]=l,l}else{let a=this.inputs.uniforms,o=a.list.length,l=new bD({type:t,name:i||"nodeU"+o+(s?"_"+s:""),node:r,needsUpdate:n});return a.list.push(l),a[e].push(l),a[e][l.name]=l,this.uniforms[l.name]=l,l}}createVertexUniform(e,t,r,i,n){return this.createUniform("vertex",e,t,r,i,n)}createFragmentUniform(e,t,r,i,n){return this.createUniform("fragment",e,t,r,i,n)}include(e,t,r){var s;let i;if(e=typeof e=="string"?Yi.get(e):e,this.context.include===!1)return e.name;e instanceof De?i=this.includes.functions:e instanceof kt?i=this.includes.consts:e instanceof Wz&&(i=this.includes.structs);let n=i[this.shader]=i[this.shader]||[];if(e){let a=n[e.name];if(a||(a=n[e.name]={node:e,deps:[]},n.push(a),a.src=e.build(this,"source")),e instanceof De&&t&&n[t.name]&&n[t.name].deps.indexOf(e)===-1&&(n[t.name].deps.push(e),(s=e.includes)==null?void 0:s.length)){let o=0;do this.include(e.includes[o++],t);while(o<e.includes.length)}return r&&(a.src=r),e.name}else throw new Error("Include not found.")}colorToVectorProperties(e){return e.replace("r","x").replace("g","y").replace("b","z").replace("a","w")}colorToVector(e){return e.replace(/c/g,"v3")}getIncludes(e,t){return this.includes[e][t||this.shader]}getConstructorFromLength(e){return rhe[e-1]}isTypeMatrix(e){return/^m/.test(e)}getTypeLength(e){return e==="f"?1:parseInt(this.colorToVector(e).substr(1))}getTypeFromLength(e){return e===1?"f":"v"+e}findNode(...e){for(let t=0;t<arguments.length;t++){let r=e[t];if(r!=null&&r.isNode)return r}}resolve(...e){for(let t=0;t<arguments.length;t++){let r=e[t];if(r!==void 0){if(r.isNode)return r;if(r.isTexture)switch(r.mapping){case Lc:case Ic:return new Zce(r);case hm:return new Kce(new Xa(r));default:return new Xa(r)}else{if(r.isVector2)return new li(r);if(r.isVector3)return new kn(r);if(r.isVector4)return new ja(r)}}}}format(e,t,r){switch(this.colorToVector(r+" <- "+t)){case"f <- v2":return e+".x";case"f <- v3":return e+".x";case"f <- v4":return e+".x";case"f <- i":case"f <- b":return"float( "+e+" )";case"v2 <- f":return"vec2( "+e+" )";case"v2 <- v3":return e+".xy";case"v2 <- v4":return e+".xy";case"v2 <- i":case"v2 <- b":return"vec2( float( "+e+" ) )";case"v3 <- f":return"vec3( "+e+" )";case"v3 <- v2":return"vec3( "+e+", 0.0 )";case"v3 <- v4":return e+".xyz";case"v3 <- i":case"v3 <- b":return"vec2( float( "+e+" ) )";case"v4 <- f":return"vec4( "+e+" )";case"v4 <- v2":return"vec4( "+e+", 0.0, 1.0 )";case"v4 <- v3":return"vec4( "+e+", 1.0 )";case"v4 <- i":case"v4 <- b":return"vec4( float( "+e+" ) )";case"i <- f":case"i <- b":return"int( "+e+" )";case"i <- v2":return"int( "+e+".x )";case"i <- v3":return"int( "+e+".x )";case"i <- v4":return"int( "+e+".x )";case"b <- f":return"( "+e+" != 0.0 )";case"b <- v2":return"( "+e+" != vec2( 0.0 ) )";case"b <- v3":return"( "+e+" != vec3( 0.0 ) )";case"b <- v4":return"( "+e+" != vec4( 0.0 ) )";case"b <- i":return"( "+e+" != 0 )"}return e}getTypeByFormat(e){return ihe[e]||e}getFormatByType(e){return nhe[e]||e}getUUID(e,t){return t=t!==void 0?t:!0,t&&this.cache&&(e=this.cache+"-"+e),e}getElementByIndex(e){return AD[e]}getIndexByElement(e){return AD.indexOf(e)}isShader(e){return this.shader===e}setShader(e){return this.shader=e,this}mergeDefines(e){for(let t in e)this.defines[t]=e[t];return this.defines}mergeUniform(e){for(let t in e)this.uniforms[t]=e[t];return this.uniforms}getTextureEncodingFromMap(e){let t;return e?e.isTexture&&(t=e.encoding):t=fa,t===fa&&this.context.gamma&&(t=ut),t}},mr=class extends ln{constructor(e=0,t,r,i){super("c"),this.nodeType="Color",this.value=e instanceof nn?e:new nn(e||0,t,r,i)}setRGBA(e){this.value.setRGBA(e.r,e.g,e.b,e.a)}generate(e,t,r,i,n,s){r=e.getUUID(r??this.getUUID()),i=i??this.getType(e);let a=e.getNodeData(r),o=this.getReadonly()&&this.generateReadonly!==void 0;if(this.alpha){let l=this.alpha.build(e,"f");e.addFragmentNodeCode(`accumAlpha += ( 1.0 - accumAlpha ) * ${l};`)}return o?this.generateReadonly(e,t,r,i,n,s):e.isShader("vertex")?(a.vertex||(a.vertex=e.createVertexUniform(i,this,n,s,this.getLabel())),e.format(a.vertex.name,i,t)):(a.fragment||(a.fragment=e.createFragmentUniform(i,this,n,s,this.getLabel())),e.format(a.fragment.name,i,t))}generateReadonly(e,t,r,i,n,s){return e.format("vec3("+this.value.r+", "+this.value.g+", "+this.value.b+")",i,t)}},Wt=class extends ln{constructor(e){super("i"),this.nodeType="Int",this.value=Math.floor(e??0)}generateReadonly(e,t,r,i,n,s){return e.format(this.value.toString(),i,t)}},Oi=class extends ln{constructor(e){super("b"),this.nodeType="Bool",this.value=e??!1}generateReadonly(e,t,r,i){return e.format(this.value?"true":"false",i,t)}},$l=class extends ln{constructor(e=1,t){super("f[]"),this.nodeType="FloatArray",this.size=e,this.value=Array.isArray(t)?t:typeof t=="number"?new Array(e).fill(t):new Array(e).fill(0)}},CA=class extends ln{},ahe=class extends CA{constructor(e){super("v3"),this.image=e,this._value=new E}get value(){return this._value.x=this.image.isVideo?this.image.img.videoWidth??0:this.image.img.width,this._value.y=this.image.isVideo?this.image.img.videoHeight??0:this.image.img.height,this._value}},b_=class extends CA{constructor(e,t){super("t"),this.image=e,this.wrap=t}get value(){return this.image.getTexture(this.wrap)}},Xz=class extends ln{constructor(e){super("m3"),this.nodeType="Matrix3",this.value=e??new Jr}generateReadonly(e,t,r,i,n,s){return e.format("mat3("+this.value.elements.join(", ")+")",i,t)}get elements(){return this.value.elements}set elements(e){this.value.fromArray(e)}},ya=class extends ln{constructor(t){super("m4"),this.nodeType="Matrix4",this.value=t??new _e}generateReadonly(t,r,i,n,s,a){return t.format("mat4("+this.value.elements.join(", ")+")",n,r)}get elements(){return this.value.elements}set elements(t){this.value.fromArray(t)}};function CD(e,t,r){e.setUvTransform(r[0],r[1],t[0],t[1],0,0,0)}var ohe=class extends Xz{constructor(e,t){super(new Jr),this.repeat=e,this.offset=t,CD(this.value,e,t)}updateMatrix(){CD(this.value,this.repeat,this.offset)}},Jl=class extends ln{constructor(e=1,t){super("v4[]"),this.nodeType="Vector4Array",this.size=e,this.value=Array.isArray(t)?t:t instanceof dt?new Array(e).fill(t):new Array(e).fill(new dt(0))}},MD=class extends Ht{constructor(e,t,r,i){super("v3"),this.nodeType="Blend",this.a=e,this.b=t,this.alpha=r,this.mode=i}generate(e,t){if(e.isShader("fragment")){let r=[];return r.push(this.a.build(e,"c")),r.push(this.b.build(e,"c")),r.push(this.alpha.build(e,"f")),r.push(this.mode.build(e,"i")),e.format("spe_blend("+r.join(",")+")",this.getType(e),t)}else return console.warn("BlendNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},Yz=class extends Ht{constructor(e,t){super("v3"),this.nodeType="CustomColor",this.color=e,this.alpha=t,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){let r=e.include(Yz.Nodes.customColor);e.addFragmentVariable(this.calpha,"float");let i=[];return i.push(this.color.build(e,"v3")),i.push(this.mask?`luminance(${this.mask.build(e,"v3")})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("CustomColorNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},__=Yz;__.Nodes=function(){return{customColor:new De(`vec3 customColor(vec3 color, float mask, float alpha, out float calpha) {
				float lalpha = alpha * mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha;

				return color;
			}`)}}();var Qz=class extends Ht{constructor(e,t){super("v3"),this.nodeType="CustomNormal",this.cnormal=e,this.alpha=t,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){let r=e.include(Qz.Nodes.customNormal);e.addFragmentVariable(this.calpha,"float");let i=[];return i.push(this.cnormal.build(e,"v3")),i.push("normal"),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("CustomNormalNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},Kz=Qz;Kz.Nodes=function(){return{customNormal:new De(`vec3 customNormal(vec3 cnormal, vec3 norm, float mask, float alpha, out float calpha) {
				vec3 normal = packNormalToRGB( norm ).rgb;
				normal *= step( vec3(0.5), cnormal );

				float lalpha = alpha * mask;
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * lalpha;

				return normal;
			}`)}}();var Lp=class extends Ht{constructor(e,t,r,i,n,s,a,o,l,c,u,h){super("v3"),this.nodeType="CustomTexture",this.texture=e,this.textureSize=t,this.crop=r,this.projection=i,this.axis=n,this.side=s,this.size=a,this.blending=o,this.mat=l,this.isMask=h,this.alpha=c,this.mode=u,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){e.require("position"),e.require("normal"),e.require("uv"),e.requires.uv=[!0],e.extensions.shaderTextureLOD=!0,e.extensions.derivatives=!0;let r=`g${this.uuid.toString().replace(/-/g,"")}`,i;switch(this.projection.value){case 3:i=e.include(Lp.Nodes.cylindrical);break;case 2:i=e.include(Lp.Nodes.spherical);break;case 1:let s=["vec3(1.0, 0.0, 0.0)","vec3(0.0, 1.0, 0.0)","vec3(0.0, 0.0, 1.0)"][this.axis.value],a=["zy","xz","xy"][this.axis.value],o=new De(`
		vec3 ${r}_planarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
				vec2 projected = (1. + (position.${a})) / 2.;
				vec2 uvs = ( mat * vec3( (projected * 2. - 1.) / (size * .5), 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

				vec4 tmp = texture2D( tex, uvs );

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				${this.side.value===2?"":`lalpha *= step(0.0, ${this.side.value===1?"-1.0 * ":""}dot(vObjectNormal, mat * ${s}));`}

				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				
				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}`);i=e.include(o);break;case 4:i=e.include(Lp.Nodes.triplanar);break;default:i=e.include(Lp.Nodes.uv);break}e.addFragmentVariable(this.calpha,"float");let n=[];if(n.push("normal"),n.push(this.texture.generate(e,"t")),n.push(this.textureSize.build(e,"v2")),n.push(this.crop.build(e,"f")),n.push(this.mat.build(e,"mat3")),n.push(this.size.build(e,"v2")),n.push(this.blending.build(e,"f")),n.push(this.isMask.build(e,"b")),n.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.mode.build(e,"i")),n.push(this.calpha),this.projection.value===4){let s=`${r}_writeUvs`,a=s+"0",o=s+"1",l=s+"2",c=`${r}_triplanarWeights`;e.addFragmentVariable(a,"vec2"),e.addFragmentVariable(o,"vec2"),e.addFragmentVariable(l,"vec2"),e.addFragmentVariable(c,"vec3"),n.push(a),n.push(o),n.push(l),n.push(c)}else{let s=`${r}_writeUvs`;e.addFragmentVariable(s,"vec2"),n.push(s)}return e.format(i+"("+n.join(",")+")",this.getType(e),t)}},MA=Lp;MA.Nodes=function(){let e=new De(`
vec3 cylindricalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
                vec3 posN = normalize(position);
                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);
                float scaledHeight = position.y / (size.y * 0.5);
                float v =  (scaledHeight / 2.) + .5;

                vec2 calculatedUv = vec2(u,v);
				vec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

                vec2 df = fwidth(uvs);
               	if(df.x > 0.5) df.x = 0.;

				#ifdef GL_EXT_shader_texture_lod
                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#else
                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;
				
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}
`),t=new De(`
vec3 sphericalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
                vec3 posN = normalize(vPosition);
                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);
                float v = 0.5 + asin(posN.y) / 3.1415;

                vec2 calculatedUv = vec2(u,v);
				vec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

                vec2 df = fwidth(uvs);
               	if(df.x > 0.5) df.x = 0.;
				#ifdef GL_EXT_shader_texture_lod
                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#else
                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}
`),r=new De(`vec3 uvTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
				vec2 uvs = ( mat * vec3( vUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

				vec4 tmp = texture2D( tex, uvs );

				vec3 col = tmp.rgb;

				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				
				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}`),i=new De(`vec3 triplanarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUvs0, out vec2 writeUvs1, out vec2 writeUvs2, out vec3 writeWeights) {
				vec3 p = position;
				vec2 uv0 = (1.0 + p.xy) / 2.0;     
				vec2 uv1 = (1.0 + p.zy) / 2.0;		
				vec2 uv2 = (1.0 + p.xz) / 2.0;		
	
				uv0 = (mat * vec3((uv0 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;
				uv1 = (mat * vec3((uv1 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;
				uv2 = (mat * vec3((uv2 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;

				// Range from 3 to 128 seems to be good
				float exponent = (1.0 - blending) * 125.0 + 3.0;

				vec3 n = vObjectNormal;
				vec3 weights = abs(normalize(n));
				weights = pow(weights, vec3(exponent));
				weights /= dot(weights, vec3(1.0));

				// Write out all sets of UVs that we generated
				writeUvs0 = uv0;
				writeUvs1 = uv1;
				writeUvs2 = uv2;
				writeWeights = weights;

				// Derivatives for LOD
				vec2 df0 = fwidth(uv0);
				vec2 df1 = fwidth(uv1);
				vec2 df2 = fwidth(uv2);
				if (df0.x > 0.5) df0.x = 0.0;
				if (df1.x > 0.5) df1.x = 0.0;
				if (df2.x > 0.5) df2.x = 0.0;

				#ifdef GL_EXT_shader_texture_lod
                	vec4 tmp = 
						texture2DLodEXT(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + 
						texture2DLodEXT(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + 
						texture2DLodEXT(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;
				#else
                	vec4 tmp = 
						textureLod(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + 
						textureLod(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + 
						textureLod(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;

				// Apply cropping across all 3 planes
				if ( crop > 0.5 ) {
					if ( uv0.x < 0.0 || uv0.x > 1.0 || uv0.y < 0.0 || uv0.y > 1.0 )  {
						lalpha = 0.0;
					}
					if ( uv1.x < 0.0 || uv1.x > 1.0 || uv1.y < 0.0 || uv1.y > 1.0 )  {
						lalpha = 0.0;
					}
					if ( uv2.x < 0.0 || uv2.x > 1.0 || uv2.y < 0.0 || uv2.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;//n * 0.5 + 0.5;
			}			
			`);return{cylindrical:e,spherical:t,uv:r,triplanar:i}}();var Ip=class extends Ht{constructor(e,t,r,i,n,s,a,o,l,c,u,h){super("v3"),this.nodeType="Depth",this.gradientType=e,this.smooth=t,this.near=r,this.far=i,this.isVector=n,this.isWorldSpace=s,this.origin=a,this.direction=o,this.colors=l,this.steps=c,this.isMask=h,this.alpha=u,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){let r=`g${this.uuid.toString().replace(/-/g,"")}`,i=new De(`vec3 ${r}_sdepth(float near, float far, vec3 origin, vec3 direction, vec4 colors[${r}_MAX_COLORS], float steps[${r}_MAX_COLORS], bool isMask, float mask, float alpha, out float calpha) {
               vec4 color = colors[0];
               #ifdef ${r}_IS_VECTOR
                   #ifdef ${r}_LINEAR
                       #ifdef ${r}_WORLDSPACE
                       float depth = vectorLinearWorldSpaceDepth(direction, origin, near, far);
                       #else
                       float depth = vectorLinearObjectSpaceDepth(direction, origin, near, far);
                       #endif
                   #else
                       #ifdef ${r}_WORLDSPACE
                           float depth = vectorSphericalWorldSpaceDepth(origin, near, far);
                       #else
                           float depth = vectorSphericalObjectSpaceDepth(origin, near, far);
                       #endif
                   #endif
               #else
                   float dist = length(vWPosition - cameraPosition);
			       float depth = ( dist - near ) / ( far - near );
               #endif


              float p;
              #ifdef ${r}_SMOOTH
				for ( int i = 1; i < ${r}_MAX_COLORS; i++ ) {
						p = clamp( ( depth - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
					}
              #else
                for ( int i = 1; i < ${r}_MAX_COLORS; i++ ) {
                   p = clamp(( depth - steps[i - 1] ) / ( steps[i] - steps[i - 1] ), 0.0, 1.0);
                   color = mix(color, colors[i], p);
                 }
              #endif

               float lalpha = alpha * color.a * mask;
               calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
			   accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
			   
               return color.rgb;
			}`,[Ip.Nodes.vectorLinearWorldSpaceDepth,Ip.Nodes.vectorLinearObjectSpaceDepth,Ip.Nodes.vectorSphericalObjectSpaceDepth,Ip.Nodes.vectorSphericalWorldSpaceDepth]);if(e.isShader("fragment")){e.define(`${r}_MAX_COLORS`,this.colors.value.length),this.smooth.value&&e.define(`${r}_SMOOTH`),this.isVector.value>.5&&e.define(`${r}_IS_VECTOR`),this.gradientType.value===0&&e.define(`${r}_LINEAR`),this.isWorldSpace.value>.5&&e.define(`${r}_WORLDSPACE`),e.require("worldPosition"),e.addFragmentVariable(this.calpha,"float");let n=e.include(i),s=[];return s.push(this.near.build(e,"f")),s.push(this.far.build(e,"f")),s.push(this.origin.build(e,"v3")),s.push(this.direction.build(e,"v3")),s.push(this.colors.build(e,"v4[]")),s.push(this.steps.build(e,"f[]")),s.push(this.isMask.build(e,"b")),s.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),s.push(this.alpha.build(e,"f")),s.push(this.calpha),e.format(n+"("+s.join(",")+")",this.getType(e),t)}else return console.warn("DepthNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},Zz=Ip;Zz.Nodes=function(){let e=new De(`float vectorLinearWorldSpaceDepth(vec3 direction, vec3 origin, float near, float far) {
               vec3 n = normalize(direction);
               float dist = (n.x*(vWPosition.x - origin.x) + n.y*(vWPosition.y - origin.y) + n.z*(vWPosition.z - origin.z));
               return ( dist - near ) / ( far - near );
            }`),t=new De(`float vectorLinearObjectSpaceDepth(vec3 direction, vec3 origin, float near, float far) {
               vec3 n = normalize(direction);
               float dist = (n.x*(position.x - origin.x) + n.y*(position.y - origin.y) + n.z*(position.z - origin.z));
               return ( dist - near ) / ( far - near );
            }`),r=new De(`float vectorSphericalWorldSpaceDepth(vec3 origin, float near, float far) {
               float dist = length(vWPosition - origin);
               return ( dist - near ) / ( far - near );
            }`),i=new De(`float vectorSphericalObjectSpaceDepth(vec3 origin, float near, float far) {
               float dist = length(position - origin);
               return ( dist - near ) / ( far - near );
            }`);return{vectorLinearWorldSpaceDepth:e,vectorLinearObjectSpaceDepth:t,vectorSphericalWorldSpaceDepth:r,vectorSphericalObjectSpaceDepth:i}}();var lhe=class extends Ht{constructor(e,t,r,i,n,s,a,o){super("v3"),this.nodeType="Fresnel",this.color=e,this.bias=t,this.scale=r,this.intensity=i,this.factor=n,this.isMask=o,this.alpha=s,this.mode=a,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.require("vWorldViewDir"),e.require("worldNormal"),e.isShader("fragment")){e.addFragmentVariable(this.calpha,"float");let r=new De(`vec3 fresnel(vec3 color, float bias, float scale, float intensity, float factor, bool isMask, float mask, float alpha, int mode, out float calpha) {
					float fresnel = bias + scale * pow( abs( factor + dot( normalize( vWorldViewDir ), normalize( vWNormal ) ) ), intensity );

					float lalpha = clamp(fresnel, 0.0, 1.0) * alpha * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

					return color;
				}`),i=e.include(r),n=[];return n.push(this.color.build(e,"c")),n.push(this.bias.build(e,"f")),n.push(this.scale.build(e,"f")),n.push(this.intensity.build(e,"f")),n.push(this.factor.build(e,"f")),n.push(this.isMask.build(e,"b")),n.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.mode.build(e,"i")),n.push(this.calpha),e.format(i+"("+n.join(",")+")",this.getType(e),t)}else return console.warn("FresnelNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},$z=class extends Ht{constructor(e,t,r,i,n,s,a,o,l){super("v3"),this.nodeType="Gradient",this.gradientType=e,this.smooth=t,this.colors=r,this.steps=i,this.offset=n,this.morph=s,this.angle=a,this.isMask=l,this.alpha=o,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){e.define("GRAD_MAX",10),e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let r=e.include($z.Nodes.gradient),i=[];return i.push(this.gradientType.build(e,"i")),i.push(this.smooth.build(e,"b")),i.push(this.colors.build(e,"v4[]")),i.push(this.steps.build(e,"f[]")),i.push(this.offset.build(e,"v2")),i.push(this.morph.build(e,"v2")),i.push(this.angle.build(e,"f")),i.push(this.isMask.build(e,"b")),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("GradientNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},Jz=$z;Jz.Nodes=function(){return{gradient:new De(`vec3 gradient(int gradientType, bool smoothed, vec4 colors[GRAD_MAX], float steps[GRAD_MAX], vec2 offset, vec2 morph, float angle, bool isMask, float mask, float alpha, out float calpha) {
				vec4 color = colors[0];
				vec2 m = morph / vUv.xy;
				vec2 rot = vec2( 0.5 + m.x, m.y );
				vec2 dt = vec2(
					cos( angle ) * rot.x - sin( angle ) * rot.y,
					sin( angle ) * rot.x + cos( angle ) * rot.y
				);
				vec2 pt = ( vUv - 0.5 + offset ) / 2.0 + dt / 2.0;
				float t = dot( pt, dt ) / dot( dt, dt );
				if ( gradientType == 1 ) {
					t = distance (
						( vUv + morph ) * 3.0,
						( vUv + offset ) + 1.0
					) + angle;
				} else if ( gradientType == 2 ) {
					float polar = atan(
						vUv.x + morph.x - 0.5 + offset.x,
						vUv.y + morph.y - 0.5 + offset.y
					) * -1.0;
					t = fract( ( angle / PI / -2.0 ) + 0.5 * ( polar / PI ) );
				}

				float p;
				if (smoothed) {
					for ( int i = 1; i < GRAD_MAX; i++ ) {
						p = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
					}

				} else {
					for ( int i = 1; i < GRAD_MAX; i++ ) {
						p = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], p);
					}
				}

				float lalpha = alpha * color.a * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
				
				return color.xyz;
			}`)}}();var ek=class extends Ht{constructor(e,t,r,i){super("v3"),this.nodeType="Matcap",this.texture=e,this.isMask=i,this.alpha=t,this.mode=r,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){e.addFragmentVariable(this.calpha,"float");let r=e.include(ek.Nodes.matcap);e.require("normal"),e.requires.normal=!0;let i=[];return i.push(this.texture.generate(e,"t")),i.push("normal"),i.push(this.isMask.build(e,"b")),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.mode.build(e,"i")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("MatcapNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},tk=ek;tk.Nodes=function(){return{matcap:new De(`vec3 matcap(sampler2D matcapTex, vec3 normal, bool isMask, float mask, float alpha, int mode, out float calpha) {
					vec3 viewDir = normalize( vViewPosition );
					vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
					vec3 y = cross( viewDir, x );
					vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5; // 0.495 to remove artifacts caused by undersized matcap disks
					vec4 matcapColor = texture2D( matcapTex, uv );

					float lalpha = alpha * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
					
					return matcapColor.rgb;
            	}`)}}();var EA=(e=>(e.SIMPLEX="simplex3d",e.SIMPLEX_FRACTAL="simplex3dFractal",e.ASHIMA="simplexAshima",e.FBM="fbm",e.PERLIN="perlin",e.VORONOI="voronoi",e))(EA||{}),qi=function(){let e=new De(`vec3 random3(vec3 c) {
			float j = 4096.0*sin(dot(c,vec3(17.0, 59.4, 15.0)));
			vec3 r;
			r.z = fract(512.0*j);
			j *= .125;
			r.x = fract(512.0*j);
			j *= .125;
			r.y = fract(512.0*j);
			return r-0.5;
		}`),t=new De(`float simplex3d(vec3 p) {
			 vec3 s = floor(p + dot(p, vec3(F3)));
			 vec3 x = p - s + dot(s, vec3(G3));
			 
			 vec3 e = step(vec3(0.0), x - x.yzx);
			 vec3 i1 = e*(1.0 - e.zxy);
			 vec3 i2 = 1.0 - e.zxy*(1.0 - e);
				
			 vec3 x1 = x - i1 + G3;
			 vec3 x2 = x - i2 + 2.0*G3;
			 vec3 x3 = x - 1.0 + 3.0*G3;
			 
			 vec4 w, d;
			 
			 w.x = dot(x, x);
			 w.y = dot(x1, x1);
			 w.z = dot(x2, x2);
			 w.w = dot(x3, x3);
			 
			 w = max(0.6 - w, 0.0);
			 
			 d.x = dot(random3(s), x);
			 d.y = dot(random3(s + i1), x1);
			 d.z = dot(random3(s + i2), x2);
			 d.w = dot(random3(s + 1.0), x3);
			 
			 w *= w;
			 w *= w;
			 d *= w;
			 
			 return dot(d, vec4(52.0));
		}`,[e]);t.keywords.F3=new kt("float F3 0.3333333"),t.keywords.G3=new kt("float G3 0.1666667");let r=new De(`float simplex3dFractal(vec3 m) {
			mat3 rot1 = mat3(-0.37, 0.36, 0.85,-0.14,-0.93, 0.34,0.92, 0.01,0.4);
			mat3 rot2 = mat3(-0.55,-0.39, 0.74, 0.33,-0.91,-0.24,0.77, 0.12,0.63);
			mat3 rot3 = mat3(-0.71, 0.52,-0.47,-0.08,-0.72,-0.68,-0.7,-0.45,0.56);
			return 0.5333333 * simplex3d(m * rot1)
				 + 0.2666667 * simplex3d(2.0 * m * rot2)
				 + 0.1333333 * simplex3d(4.0 * m * rot3)
				 + 0.0666667 * simplex3d(8.0 * m);
		}`,[t]),i=new De("vec4 permute(vec4 x){return mod(((x*34.0)+1.0)*x, 289.0);}"),n=new De("vec4 taylorInvSqrt(vec4 r){return 1.79284291400159 - 0.85373472095314 * r;}"),s=new De(`float simplexAshima(vec3 v) {
		  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;
		  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);
		  vec3 i  = floor(v + dot(v, C.yyy) );
		  vec3 x0 =   v - i + dot(i, C.xxx) ;
		  vec3 g = step(x0.yzx, x0.xyz);
		  vec3 l = 1.0 - g;
		  vec3 i1 = min( g.xyz, l.zxy );
		  vec3 i2 = max( g.xyz, l.zxy );
		  vec3 x1 = x0 - i1 + 1.0 * C.xxx;
		  vec3 x2 = x0 - i2 + 2.0 * C.xxx;
		  vec3 x3 = x0 - 1. + 3.0 * C.xxx;
		  i = mod(i, 289.0 ); 
		  vec4 p = permute( permute( permute( 
					 i.z + vec4(0.0, i1.z, i2.z, 1.0 ))
				   + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) 
				   + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));
		  float n_ = 1.0/7.0; // N=7
		  vec3  ns = n_ * D.wyz - D.xzx;
		  vec4 j = p - 49.0 * floor(p * ns.z *ns.z);  //  mod(p,N*N)
		  vec4 x_ = floor(j * ns.z);
		  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)
		  vec4 x = x_ *ns.x + ns.yyyy;
		  vec4 y = y_ *ns.x + ns.yyyy;
		  vec4 h = 1.0 - abs(x) - abs(y);
		  vec4 b0 = vec4( x.xy, y.xy );
		  vec4 b1 = vec4( x.zw, y.zw );
		  vec4 s0 = floor(b0)*2.0 + 1.0;
		  vec4 s1 = floor(b1)*2.0 + 1.0;
		  vec4 sh = -step(h, vec4(0.0));
		  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;
		  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;
		  vec3 p0 = vec3(a0.xy,h.x);
		  vec3 p1 = vec3(a0.zw,h.y);
		  vec3 p2 = vec3(a1.xy,h.z);
		  vec3 p3 = vec3(a1.zw,h.w);
		  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));
		  p0 *= norm.x;
		  p1 *= norm.y;
		  p2 *= norm.z;
		  p3 *= norm.w;
		  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);
		  m = m * m;
		  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), 
										dot(p2,x2), dot(p3,x3) ) );
		}`,[i,n]),a=new De("vec4 mod289(vec4 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}"),o=new De("vec4 perm(vec4 x){return mod289(((x * 34.0) + 1.0) * x);}",[a]),l=new De(`float noise(vec3 p){
			vec3 a = floor(p);
			vec3 d = p - a;
			d = d * d * (3.0 - 2.0 * d);
			vec4 b = a.xxyy + vec4(0.0, 1.0, 0.0, 1.0);
			vec4 k1 = perm(b.xyxy);
			vec4 k2 = perm(k1.xyxy + b.zzww);
			vec4 c = k2 + a.zzzz;
			vec4 k3 = perm(c);
			vec4 k4 = perm(c + 1.0);
			vec4 o1 = fract(k3 * (1.0 / 41.0));
			vec4 o2 = fract(k4 * (1.0 / 41.0));
			vec4 o3 = o2 * d.z + o1 * (1.0 - d.z);
			vec2 o4 = o3.yw * d.x + o3.xz * (1.0 - d.x);
			return o4.y * d.y + o4.x * (1.0 - d.y);
		}`,[o]),c=new De(`float fbm(vec3 x) {
			float v = 0.0;
			float a = 0.5;
			vec3 shift = vec3(100);
			for (int i = 0; i < NUM_OCTAVES; ++i) {
				v += a * noise(x);
				x = x * 2.0 + shift;
				a *= 0.5;
			}
			return v;
		}`,[l]);c.keywords.NUM_OCTAVES=new kt("int NUM_OCTAVES 5");let u=new De("vec3 fade(vec3 t) {return t*t*t*(t*(t*6.0-15.0)+10.0);}"),h=new De(`float perlin(vec3 P){
		  vec3 Pi0 = floor(P);
		  vec3 Pi1 = Pi0 + vec3(1.0);
		  Pi0 = mod(Pi0, 289.0);
		  Pi1 = mod(Pi1, 289.0);
		  vec3 Pf0 = fract(P);
		  vec3 Pf1 = Pf0 - vec3(1.0);
		  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
		  vec4 iy = vec4(Pi0.yy, Pi1.yy);
		  vec4 iz0 = Pi0.zzzz;
		  vec4 iz1 = Pi1.zzzz;
		  vec4 ixy = permute(permute(ix) + iy);
		  vec4 ixy0 = permute(ixy + iz0);
		  vec4 ixy1 = permute(ixy + iz1);
		  vec4 gx0 = ixy0 / 7.0;
		  vec4 gy0 = fract(floor(gx0) / 7.0) - 0.5;
		  gx0 = fract(gx0);
		  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
		  vec4 sz0 = step(gz0, vec4(0.0));
		  gx0 -= sz0 * (step(0.0, gx0) - 0.5);
		  gy0 -= sz0 * (step(0.0, gy0) - 0.5);
		  vec4 gx1 = ixy1 / 7.0;
		  vec4 gy1 = fract(floor(gx1) / 7.0) - 0.5;
		  gx1 = fract(gx1);
		  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
		  vec4 sz1 = step(gz1, vec4(0.0));
		  gx1 -= sz1 * (step(0.0, gx1) - 0.5);
		  gy1 -= sz1 * (step(0.0, gy1) - 0.5);
		  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);
		  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);
		  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);
		  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);
		  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);
		  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);
		  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);
		  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);
		  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
		  g000 *= norm0.x;
		  g010 *= norm0.y;
		  g100 *= norm0.z;
		  g110 *= norm0.w;
		  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
		  g001 *= norm1.x;
		  g011 *= norm1.y;
		  g101 *= norm1.z;
		  g111 *= norm1.w;
		  float n000 = dot(g000, Pf0);
		  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
		  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
		  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
		  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
		  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
		  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
		  float n111 = dot(g111, Pf1);
		  vec3 fade_xyz = fade(Pf0);
		  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
		  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
		  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x); 
		  return 2.2 * n_xyz;
		}`,[i,n,u]),d=new De(`float hashwithoutsine13(vec3 p3)
		{
			p3  = fract(p3 * .1031);
			p3 += dot(p3, p3.yzx + 33.33);
			return fract((p3.x + p3.y) * p3.z);
		}`),p=new De(`vec3 hashwithoutsine33(vec3 p3)
		{
			p3 = fract(p3 * vec3(.1031, .1030, .0973));
			p3 += dot(p3, p3.yxz+33.33);
			return fract((p3.xxy + p3.yxx)*p3.zyx);
		}`),f=new De(`float metric(in vec3 p)
		{
			// L2 
			return length(p);

			// Chebyshev 
			// vec3 a = abs(p);
			// return max(a.x, max(a.y, a.z));
		}`),m=new De(`float smin( float a, float b, float k )
		{
			float h = smoothstep(0.0, 1.0, 0.5 + 0.5 * (b - a) / k);
			float correction = k * h * (1.0 - h);
			return mix(b, a, h) - correction;
		}`),g=new De(`float smax( float a, float b, float k )
		{
			float h = smoothstep(1.0, 0.0, 0.5 + 0.5 * (a - b) / k);
			float correction = k * h * (1.0 - h);
			return mix(a, b, h) + correction;
		}`),v=new De(`float remap(float value, float input_min, float input_max, float output_min, float output_max) {
			// Compute width of each interval
			float input_width = input_max - input_min;
			float output_width = output_max - output_min;
		
			// Convert input range into a 0-1 range 
			float scaled = (value - input_min) / input_width;
		
			// Convert the 0-1 range into a value in output range
			return output_min + (scaled * output_width);
		}`),y=new De(`float voronoi(in vec3 x, in int style, in float smoothness, in float seed, in int quality) 
		{
			// Integer and fractional parts of this point's coordinates
			ivec3 p = ivec3(floor(x));
			vec3 f = fract(x);

			// Different variables that we will use to construct noise:
			//
			// f1: distance to the closest feature point
			// f2: distance to the second closest feature point
			// e: distance to the closest edge (cell boundary)
			//
			// We also compute "smooth" versions of all of the above quantites, essentially
			// replacing "hard" minimums with "smooth" minimums (described by IQ)
			float f1_smooth = 8.0;
			float f1 = 8.0;
			float f2_smooth = 8.0;
			float f2 = 8.0;
			float e_smooth = 8.0;
			float e = 8.0;

			// Variables stored from closest cell
			ivec3 mb;
			vec3 mr; 

			int steps = quality;
			
			for (int x = -steps; x <= steps; x++) 
			for (int y = -steps; y <= steps; y++)
			for (int z = -steps; z <= steps; z++)
			{
				ivec3 b = ivec3(x, y, z);
				vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
				float d = length(r);
				
				f1_smooth = smin(d, f1_smooth, smoothness);

				// Store un-smoothed distances too 
				if (d < f1) 
				{
					f2 = f1;
					f1 = d;

					mb = ivec3(x, y, z);
					mr = r;
				} 
				else if (d < f2) 
				{
					f2 = d;
				}
			}	
			
			float id = hashwithoutsine13(vec3(p + mb) + seed);

			// Second pass for edge distance  
			for (int x = -steps; x <= steps; x++) 
			for (int y = -steps; y <= steps; y++)
			for (int z = -steps; z <= steps; z++)
			{
				// Start search at the cell that contains the closest point to "x" (found in 1st pass)
				ivec3 b = mb + ivec3(x, y, z);
				vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
				float d1 = dot(0.5 * (mr + r), (r - mr)); 				// IQ normalizes "r - mr" but that breaks things for the smooth version?
				float d2 = dot(0.5 * (mr + r), normalize(r - mr));

				e_smooth = smin(d1, e_smooth, smoothness);

				e = min(e, d2);

				// Also compute a smooth version of F2 in this pass
				{
					ivec3 b = ivec3(x, y, z);
					if (b != mb) 
					{
						vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
						float d = length(r);

						f2_smooth = smin(d, f2_smooth, smoothness);
					}
				}
			}

			// Different visualization modes 
			if (style == 0) 
			{
				return f1_smooth;
			}
			if (style == 1) 
			{
				return f2_smooth;
			}
			if (style == 2) 
			{
				return f2_smooth - f1_smooth;
				
				// "Pebbles" also cool
				//return step(0.2, f2_smooth - f1_smooth);
			}
			if (style == 3) 
			{
				// This one is really good for rock / stone effects
				float a = f1; 
				float b = f2;
				float k = 3.0;
				float h = max(k - abs(a - b), 0.0) / k;
				float final = min(a, b) - h * h * k * (1.0 / 4.0);
				return final;
			}
			if (style == 4) 
			{
				// Some random adjustments to make this style stand out more 
				return exp(5.0 * e_smooth);
			}
			if (style == 5) 
			{
				return pow(f1_smooth, 3.0);
			}
			if (style == 6) 
			{				
				const float eps = 0.0125;

				// Thicker lines as the user increases the smoothness slider
				float thickness = smoothness * 0.25 + eps;

				// Blurrier lines as the user increases the smoothness slider
				float blur = pow(smoothness, 3.0) * 0.25 + eps;

				return smoothstep(
					thickness - thickness * blur, 
					thickness + thickness * blur, 
					e
				);
			}
			if (style == 7) 
			{
				return hashwithoutsine13(vec3(p + mb) + seed);
			}
		}
	`,[d,p,f,m,g,v]);return{simplex:t,simplexFractal:r,simplexAshima:s,fbm:c,perlin:h,voronoi:y}}(),rk=class extends Ht{constructor(e,t,r,i,n,s,a,o,l,c,u,h,d,p,f,m,g,v,y){super("v3"),this.nodeType="Noise",this.scale=e,this.size=t,this.move=r,this.fA=i,this.fB=n,this.distortion=s,this.colorA=a,this.colorB=o,this.colorC=l,this.colorD=c,this.noiseType=h,this.voronoiStyle=p,this.highCut=f,this.lowCut=m,this.smoothness=g,this.seed=v,this.quality=y,this.isMask=d,this.alpha=u,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t,r,i,n){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let s=Object.values(EA)[this.noiseType.value],a=s=="voronoi"?`
		float v = ${s}(st + move, voronoiStyle, smoothness, seed, quality);

		// Apply clipping to colors
		v = remap(v, lowCut, highCut, 0.0, 1.0);
		v = smax(v, 0.0, smoothness * 0.25);
		v = smin(v, 1.0, smoothness * 0.25);

		// Note that the voronoi mode only uses colors "A" and "C" from the UI 
		vec4 color = mix(colorA, colorC, v); 
		`:`
		vec3 q = vec3(${s}(st),
					   ${s}(st + vec3(1.0)),
					   ${s}(st + vec3(1.0)));
		vec3 r = vec3(${s}(st + vec3(distortion, 1.0) * q + vec3(fA, 1.0) + move),
					  ${s}(st + vec3(distortion, 1.0) * q + vec3(fB, 1.0) + move), 
					  ${s}(st * q));
		float f = ${s}(st + r);
		vec4 color;
		color = mix(colorA, colorB, clamp((f * f) * 4.0, 0.0, 1.0));
		color = mix(color, colorC, clamp(length(q), 0.0, 1.0));
		color = mix(color, colorD, clamp(length(r.x), 0.0, 1.0));
		`,o=new De(`vec3 ${s}customNoise(float scale, vec3 size, float move, vec2 fA, vec2 fB, vec2 distortion, vec4 colorA, vec4 colorB, vec4 colorC, vec4 colorD, int voronoiStyle, float highCut, float lowCut, float smoothness, float seed, int quality, bool isMask, float mask, float alpha, out float calpha) 
			{
                // Prevent scale of zero 
				scale = max(abs(scale), 0.001);

				vec3 st = position / size;
				st /= scale;

				${a}

				float lalpha = alpha * color.a * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return clamp(color, 0.0, 1.0).rgb;
			}`,[qi.simplex,qi.simplexFractal,qi.simplexAshima,qi.fbm,qi.perlin,qi.voronoi]),l=e.include(o),c=[];return c.push(this.scale.build(e,"f")),c.push(this.size.build(e,"v3")),c.push(this.move.build(e,"f")),c.push(this.fA.build(e,"v2")),c.push(this.fB.build(e,"v2")),c.push(this.distortion.build(e,"v2")),c.push(this.colorA.build(e,"v4")),c.push(this.colorB.build(e,"v4")),c.push(this.colorC.build(e,"v4")),c.push(this.colorD.build(e,"v4")),c.push(this.voronoiStyle.build(e,"i")),c.push(this.highCut.build(e,"f")),c.push(this.lowCut.build(e,"f")),c.push(this.smoothness.build(e,"f")),c.push(this.seed.build(e,"f")),c.push(this.quality.build(e,"i")),c.push(this.isMask.build(e,"b")),c.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),c.push(this.alpha.build(e,"f")),c.push(this.calpha),e.format(l+"("+c.join(",")+")",this.getType(e),t)}};rk.numOctaves=5;var ik=class extends Ht{constructor(e,t,r,i,n,s,a,o,l,c,u,h,d,p,f,m){super("v3"),this.nodeType="Outline",this.firstTime=!0,this.outlineColor=e,this.contourColor=t,this.outlineWidth=r,this.contourWidth=i,this.contourThreshold=n,this.outlineThreshold=s,this.contourFrequency=a,this.outlineSmoothing=o,this.contourDirection=l,this.positionalLines=c,this.compensation=u,this.resolution=h,this.normalMap=d,this.depthMap=p,this.pixelRatio=f,this.alpha=m,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){let r=`g${this.uuid.toString().replace(/-/g,"")}`;if(e.require("vWorldViewDir"),e.require("worldNormal"),e.extensions.derivatives=!0,this.compensation.value&&e.define("OUTLINE_COMPENSATION",`${r}_offset`),this.firstTime){let i=this.outlineWidth.build(e,"f"),n=this.resolution.build(e,"v2"),s=this.compensation.build(e,"b"),a=this.pixelRatio.build(e,"f");e.addVertexParsVariable("randomColor","attribute vec3"),e.addVertexParsVariable("extrudeNormal","attribute vec3"),e.addVertexParsVariable(i,"uniform float"),e.addVertexParsVariable(n,"uniform vec2"),e.addVertexParsVariable(s,"uniform bool"),e.addVertexParsVariable(a,"uniform float"),e.addVertexParsVariable("vID","flat out float"),e.addFragmentParsVariable("vID","flat in float"),e.addVertexFinalCode(`
                vID = randomColor.r;
                vec2 ${r}_offset = vec2(0.0);
                if (${s}) {
                    vec4 ${r}_clipPosition = projectionMatrix * (modelViewMatrix * vec4(position, 1.0));
                    // NOTE: For certain shapes, like spheres, we get incorrect extrusion when the
                    // normals face the camera directly. So we hackily fix this by offsetting the normal
                    // by a tiny amount.
                    vec3 ${r}_clipNormal = mat3(projectionMatrix) * (mat3(modelViewMatrix) * extrudeNormal) + 0.0000001;
                    ${r}_offset = normalize(${r}_clipNormal.xy) / ${n} * (${i} / 2.0) * ${r}_clipPosition.w * 2.0 * ${a};
                    ${r}_clipPosition.xy += ${r}_offset;
                    // TODO(MAX): To handle multiple outline layers, we only want to extrude
                    // if this offset is the biggest of all the potential offsets
                    gl_Position = ${r}_clipPosition;
                }
            `)}if(e.isShader("fragment")){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let i=e.include(ik.Nodes.outline),n=[];return n.push(this.outlineColor.build(e,"c")),n.push(this.contourColor.build(e,"c")),n.push(this.outlineWidth.build(e,"f")),n.push(this.contourWidth.build(e,"f")),n.push(this.contourThreshold.build(e,"f")),n.push(this.outlineThreshold.build(e,"f")),n.push(this.contourFrequency.build(e,"f")),n.push(this.outlineSmoothing.build(e,"f")),n.push(this.contourDirection.build(e,"v3")),n.push(this.positionalLines.build(e,"b")),n.push(this.resolution.build(e,"v2")),n.push(this.normalMap.getTexture(e,"t")),n.push(this.depthMap.getTexture(e,"t")),n.push(this.pixelRatio.build(e,"f")),n.push(this.compensation.build(e,"b")),n.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.calpha),this.firstTime=!this.firstTime,e.format(i+"("+n.join(",")+")",this.getType(e),t)}else return console.warn("OutlineNode is not compatible with "+e.shader+" shader."),""}},nk=ik;nk.Nodes=function(){let e=new De(`
float sobelSample(sampler2D t, sampler2D d, vec2 uv, vec2 resolution, float outlineWidth, float pixelRatio)
{
    vec2 halton = haltonSequence[frameIndex];
    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
    float temporalAngle  = temporalOffset * PI2;

    vec2 texelSize = (vec2(1.0) / resolution);
    vec2 offsetSize = texelSize * outlineWidth * pixelRatio;

    vec2 uvSamples[9];
    vec4 normalSamples[9];

	uvSamples[0] = uv + vec2( -offsetSize.x, -offsetSize.y) + (vogelDiskSample(0, 9, temporalAngle) * texelSize);
	uvSamples[1] = uv + vec2(0.0, -offsetSize.y) + (vogelDiskSample(1, 9, temporalAngle) * texelSize);
	uvSamples[2] = uv + vec2(  offsetSize.x, -offsetSize.y) + (vogelDiskSample(2, 9, temporalAngle) * texelSize);
	uvSamples[3] = uv + vec2( -offsetSize.x, 0.0) + (vogelDiskSample(3, 9, temporalAngle) * texelSize);
	uvSamples[4] = uv;
	uvSamples[5] = uv + vec2(  offsetSize.x, 0.0) + (vogelDiskSample(5, 9, temporalAngle) * texelSize);
	uvSamples[6] = uv + vec2( -offsetSize.x, offsetSize.y) + (vogelDiskSample(6, 9, temporalAngle) * texelSize);
	uvSamples[7] = uv + vec2(0.0, offsetSize.y) + (vogelDiskSample(7, 9, temporalAngle) * texelSize);
	uvSamples[8] = uv + vec2(  offsetSize.x, offsetSize.y) + (vogelDiskSample(8, 9, temporalAngle) * texelSize);


    normalSamples[0] = texture2D(t, uvSamples[0]);
    normalSamples[1] = texture2D(t, uvSamples[1]);
    normalSamples[2] = texture2D(t, uvSamples[2]);
    normalSamples[3] = texture2D(t, uvSamples[3]);
    normalSamples[4] = texture2D(t, uvSamples[4]);
    normalSamples[5] = texture2D(t, uvSamples[5]);
    normalSamples[6] = texture2D(t, uvSamples[6]);
    normalSamples[7] = texture2D(t, uvSamples[7]);
    normalSamples[8] = texture2D(t, uvSamples[8]);

    float depthBias = 0.0001;
    // TODO(MAX): Can we somehow reduce the number of conditionals here with MATH?!
    if (normalSamples[0].a != vID && normalSamples[0].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[0]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[1].a != vID && normalSamples[1].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[1]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[2].a != vID && normalSamples[2].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[2]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[3].a != vID && normalSamples[3].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[3]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }


    if (normalSamples[4].a != vID && normalSamples[4].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[4]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[5].a != vID && normalSamples[5].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[5]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[6].a != vID && normalSamples[6].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[6]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[7].a != vID && normalSamples[7].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[7]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[8].a != vID && normalSamples[8].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[8]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    vec3 sobel_edge_h = normalSamples[2].rgb + (2.0*normalSamples[5].rgb) + normalSamples[8].rgb - (normalSamples[0].rgb + (2.0*normalSamples[3].rgb) + normalSamples[6].rgb);
  	vec3 sobel_edge_v = normalSamples[0].rgb + (2.0*normalSamples[1].rgb) + normalSamples[2].rgb - (normalSamples[6].rgb + (2.0*normalSamples[7].rgb) + normalSamples[8].rgb);

    float edgeNormal = sqrt(dot(sobel_edge_h, sobel_edge_h) + dot(sobel_edge_v, sobel_edge_v));
    return edgeNormal;
}
`);return{outline:new De(`vec3 outline(vec3 outlineColor, vec3 contourColor, float outlineWidth, float contourWidth, float outlineThreshold, float contourThreshold, float outlineSmoothing, float contourFrequency, vec3 contourDirection, bool positionalLines, vec2 resolution, sampler2D normalMap, sampler2D depthMap, float pixelRatio, bool compensation, float mask, float alpha, out float calpha) {
                vec3 result = outlineColor;
                float resultAlpha = 0.0;

                vec3 N = normalize(vWNormal);
                vec2 nuv = (gl_FragCoord.xy / resolution);
                float sobelSample = compensation ? sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth / 2., pixelRatio) : sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth, pixelRatio);
                resultAlpha = smoothstep(outlineThreshold - outlineSmoothing, outlineThreshold + outlineSmoothing, sobelSample);

                //resultAlpha = 1.0;
                //result = vec3(sobelSample);

                float t = 1.0 - contourThreshold;
                if(positionalLines) {
                    vec3 NDir = position * contourDirection;
                    float NT = NDir.x + NDir.y + NDir.z;
                    float f  = fract(NT * contourFrequency * 0.01);
                    float df = fwidth(NT * contourFrequency);

                    float g = smoothstep(df * (contourWidth * 0.01), df * (contourWidth * 0.01 * 2.0), f);
                    if (g < 1.0 && resultAlpha == 0.0) {
                        result = contourColor;
                        resultAlpha = 1.0;
                    }
                 }
                 else {
                    vec3 NDir = N * contourDirection;
                    float NT = NDir.x + NDir.y + NDir.z;
                    float df = fwidth(NT * contourThreshold);
                    float f = sin(NT * 1.0 * contourFrequency);
                    float g = smoothstep(0.0, df * contourWidth, 1.0 - f);

                    if (df > (t * 0.5) && g < 1.0 && resultAlpha == 0.0) {
                        result = contourColor;
                        resultAlpha = 1.0 - g;
                    }
                 }

                 float lalpha = alpha * resultAlpha * mask;
                 calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
                 accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
				 
                 return result;
             }`,[e])}}();var Na=class extends Ht{constructor(e,t,r,i,n,s,a,o,l,c,u,h,d,p,f,m,g,v){super("v3"),this.nodeType="Pattern",this.style=e,this.projection=t,this.axis=r,this.blending=i,this.offset=n,this.colorA=s,this.colorB=a,this.frequency=o,this.size=l,this.variation=c,this.smoothness=u,this.zigzag=h,this.rotation=d,this.vertical=p,this.horizontal=f,this.sides=m,this.isMask=v,this.alpha=g,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){e.require("position"),e.require("uv"),e.requires.uv=[!0],e.require("normal"),e.requires.normal=!0,e.addFragmentVariable(this.calpha,"float");let r;switch(this.style.value){case 0:r="circle";break;case 1:r="ring";break;case 2:r="polygon";break;case 3:r="xcross";break;case 4:r="diamond";break;case 5:r="checkerboard";break;case 6:r="line";break;case 7:r="wave";break;default:r="circle";break}let i=`g${this.uuid.toString().replace(/-/g,"")}`,n=new De(`float hashwithoutsine12(vec2 p)
				{
					vec3 p3 = fract(vec3(p.xyx) * .1031);
					p3 += dot(p3, p3.yzx + 33.33);
					return fract((p3.x + p3.y) * p3.z);
				}`),s=new De(`vec2 rotate_uv(in vec2 uv, float a, bool repeat) 
				{
					const float mid = 0.5;
					float radians = a * (PI / 180.0);
					vec2 rotated = vec2(
						cos(radians) * (uv.x - mid) + sin(radians) * (uv.y - mid) + mid,
						cos(radians) * (uv.y - mid) - sin(radians) * (uv.x - mid) + mid
					);
					return repeat ? fract(rotated): rotated;
				}`),a="";if(this.projection.value===4){let u=this.style.value===2?`${r}(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${r}(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,h=this.style.value===2?`${r}(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${r}(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,d=this.style.value===2?`${r}(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${r}(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation)`;a=`
				vec3 p = position;
				float factor = 0.0125;
				vec2 uv0 = fract(p.xy * factor);
				vec2 uv1 = fract(p.zy * factor);
				vec2 uv2 = fract(p.xz * factor);
				
				uv0 = rotate_uv(uv0 + offset, rotation, true);
				uv1 = rotate_uv(uv1 + offset, rotation, true);
				uv2 = rotate_uv(uv2 + offset, rotation, true);
	
				float d0 = ${u};
				float d1 = ${h};
				float d2 = ${d};
				
				// Range from 3 to 128 seems to be good
				float exponent = (1.0 - blending) * 125.0 + 3.0;

				vec3 n = vObjectNormal;
				vec3 weights = abs(normalize(n));
				weights = pow(weights, vec3(exponent));
				weights /= dot(weights, vec3(1.0));
				d0 *= weights.z;
				d1 *= weights.x;
				d2 *= weights.y;
				float draw = d0 + d1 + d2;
	
				vec2 custom_uv = uv0 * weights.z + uv1 * weights.x + uv2 * weights.y;
				`}else{let u=this.style.value===2?`${r}(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${r}(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,h="";this.axis.value===0?h=`float radius = length(p);
					float theta = atan(p.y, p.z);
					float phi = acos(p.x / radius);`:this.axis.value===1?h=`float radius = length(p);
					float theta = atan(p.x, p.z);
					float phi = acos(p.y / radius);`:(this.axis.value,h=`float radius = length(p);
					float theta = atan(p.y, p.x);
					float phi = acos(p.z / radius);`);let d="";switch(this.projection.value){case 0:d="custom_uv = vUv.st;";break;case 1:break;case 2:d=`
							vec3 p = position;
							${h}
							custom_uv = vec2(theta, phi);
							custom_uv /= PI;
							`;break}a=`
				vec2 custom_uv;
				${d}
	
				custom_uv += offset;
				custom_uv = fract(custom_uv);
				custom_uv = rotate_uv(custom_uv, rotation, true);
	
				float draw = ${u};
				`}let o=new De(`vec3 ${i}_pattern(vec3 normal, float blending, int style, vec2 offset, vec4 colorA, vec4 colorB, vec2 frequency, float size, float variation, float smoothness, float zigzag, float rotation, vec2 vertical, vec2 horizontal, int sides, bool isMask, float mask, float alpha, out float calpha) {
					const float TWO_PI = PI * 2.0;
					float smoothness_remapped = pow(smoothness, 5.0);	

					${a}

					// Construct final output color
					vec4 color = mix(colorA, colorB, draw);
					color.a = clamp(color.a, 0.0, 1.0);

					// Apply cuts
					color.a *= 
						step(vertical.x, custom_uv.y) * 
						step(custom_uv.y, vertical.y);
					color.a *= 
						step(horizontal.x, abs(custom_uv.x)) * 
						step(abs(custom_uv.x), horizontal.y);

					// Accumulate alpha 
					float lalpha = alpha * clamp(color.a, 0.0, 1.0) * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

					return clamp(color, 0.0, 1.0).rgb;
				}`,[s,n,Na.DrawFunctions.circle,Na.DrawFunctions.ring,Na.DrawFunctions.polygon,Na.DrawFunctions.cross,Na.DrawFunctions.diamond,Na.DrawFunctions.checkerboard,Na.DrawFunctions.line,Na.DrawFunctions.wave]),l=e.include(o),c=[];return c.push("normal"),c.push(this.blending.build(e,"f")),c.push(this.style.build(e,"i")),c.push(this.offset.build(e,"v2")),c.push(this.colorA.build(e,"v4")),c.push(this.colorB.build(e,"v4")),c.push(this.frequency.build(e,"v2")),c.push(this.size.build(e,"f")),c.push(this.variation.build(e,"f")),c.push(this.smoothness.build(e,"f")),c.push(this.zigzag.build(e,"f")),c.push(this.rotation.build(e,"f")),c.push(this.vertical.build(e,"v2")),c.push(this.horizontal.build(e,"v2")),c.push(this.sides.build(e,"i")),c.push(this.isMask.build(e,"b")),c.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),c.push(this.alpha.build(e,"f")),c.push(this.calpha),e.format(l+"("+c.join(",")+")",this.getType(e),t)}else return console.warn("PatterNode is not compatible with "+e.shader+" shader."),e.format("vec3(0.0)",this.getType(e),t)}},sk=Na;sk.DrawFunctions=function(){let e=new De(`float hashwithoutsine12(vec2 p) {
				vec3 p3 = fract(vec3(p.xyx) * 0.1031);
				p3 += dot(p3, p3.yzx + 33.33);
				return fract((p3.x + p3.y) * p3.z);
			}`),t=new De(`vec2 tile_and_center(in vec2 uv, in vec2 frequency, in float variation, in float zigzag, in float rotation) {
                // Create tiles in UV-space
                uv *= frequency;

                // Integer coords
                vec2 i = floor(uv);

                // Offset every other row based on zigzag param, then compute fractional coords
                float row_offset = mod(i.y, 2.0);
                uv.x += row_offset * zigzag;
                vec2 f = fract(uv);

				// Rotate the tile itself:
				// const float mid = 0.5;
				// f = vec2(
				// 	cos(rotation) * (f.x - mid) + sin(rotation) * (f.y - mid) + mid,
				// 	cos(rotation) * (f.y - mid) - sin(rotation) * (f.x - mid) + mid
				// );
				// f = fract(f);

                f = f * 2.0 - 1.0;

				// Recompute integer coords after shifting - then, random value per tile 
				i = floor(uv);
				float rand = (hashwithoutsine12(i) * 5.0 + 1.0);
				float jitter = mix(1.0, rand, variation);
				f *= jitter;

                return f;
            }`,[e]),r=new De(`float circle(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(
                    -smoothness, 
                     smoothness, 
                     length(f) - size
                );
            }`,[t]),i=new De(`float ring(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);

				float d = length(f);
                const float inner_width = 0.5;

                float outer = smoothstep(-smoothness, smoothness, d - size);
                float inner = smoothstep(-smoothness, smoothness, d - size * inner_width);
				return outer + (1.0 - inner);   
            }`,[t]),n=new De(`float sdf_ngon(in vec2 p, in float r, in int n) {
                float an = (PI * 2.0) / float(n);
                float he = r * tan(0.5 * an);
                
                // Rotate to first sector
                p = -p.yx; 
                float bn = an * floor((atan(p.y, p.x) + 0.5 * an) / an);
                vec2  cs = vec2(cos(bn), sin(bn));
                p = mat2(cs.x, -cs.y, cs.y, cs.x)*p;
            
                // Side of polygon
                return length(p - vec2(r, clamp(p.y, -he, he))) * sign(p.x - r);
            }
            
            float polygon(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation, in int sides) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(-smoothness, smoothness, sdf_ngon(f, size, sides));
            }`,[t]),s=new De(`float sdf_cross(in vec2 p, in vec2 b, float r ) {
                p = abs(p); 
				p = (p.y > p.x) ? p.yx : p.xy;
                vec2  q = p - b;
                float k = max(q.y, q.x);
                vec2  w = (k > 0.0) ? q : vec2(b.y - p.x, -k);
                return sign(k) * length(max(w, 0.0)) + r;
            }
            
            // Avoid namespace conflicts 
            float xcross(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(-smoothness, smoothness, sdf_cross(f, vec2(size, size * 0.25), smoothness));
            }`,[t]),a=new De(`float ndot(vec2 a, vec2 b) { 
                return a.x*b.x - a.y*b.y; 
            }
            
            float sdf_diamond(in vec2 p, in vec2 b) {
                p = abs(p);
                float h = clamp(ndot(b - 2.0 * p, b) / dot(b, b), -1.0, 1.0);
                float d = length(p - 0.5 * b * vec2(1.0 - h, 1.0 + h));
                return d * sign(p.x * b.y + p.y * b.x - b.x * b.y);
            }

            float diamond(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
	            return smoothstep(-smoothness, smoothness, sdf_diamond(f, vec2(size)));
            }`,[t]),o=new De(`float checkerboard(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                uv *= frequency;
                vec2 i = floor(uv);

                float offset = mod(i.y, 2.0);

                uv.x += offset + zigzag * offset;
                float x = floor(uv.x);
                
                return mod(x, 2.0);
            }`),l=new De(`float line(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, 0.0, zigzag, rotation);
				
				// Different approach for variation param here
				float row = floor(uv * frequency).y;
				float rand = hashwithoutsine12(vec2(row));
				float s = mix(size, size * rand, variation);

				return smoothstep(
					s - smoothness, 
					s + smoothness, 
					abs(f.y)
				);
            }`,[t]),c=new De(`// Uses bisection 
            float udf_cos(in vec2 p, in float a, in float b, in float c, in float d) {
                // Convert all data to a primitive cosine wave
                p = c * (p - vec2(d, a));
                
                const float TWO_PI = PI * 2.0;

                // Reduce to principal half cycle
                p.x = mod(p.x, TWO_PI); 
                if (p.x > PI) {
                    p.x = TWO_PI - p.x;
                }
            
                // Find zero of derivative (minimize distance)
                float xa = 0.0;
                float xb = TWO_PI;

                // 24 bit precision
                for (int i = 0; i < 24; i++) {
                    float x = 0.5 * (xa + xb);
                    float y = x - p.x + b * c * sin(x) * (p.y - b * c * cos(x));
                    if (y < 0.0) xa = x; 
                    else xb = x;
                }
                float x = 0.5 * (xa + xb);
                
                // Compute distance    
                vec2 q = vec2(x, b * c * cos(x));
                return length(p - q) / c;
            }

            float wave(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                float repeat = frequency.x;
                uv *= repeat;
                vec2 i = floor(uv);
                float row_offset = mod(i.y, 2.0);
                uv.x += row_offset * zigzag;
                vec2 f = vec2(uv.x, fract(uv.y));

                // Generalized cosine: y(x) = a + b * cos(cx + d)
                const float amplitude = 0.125;
                float wave_frequency = frequency.y * 0.1;
                float distance_estimate = udf_cos(f, 0.50, amplitude, wave_frequency * (2.0 * PI), 0.0);

				// Different approach for variation param here
				float rand = hashwithoutsine12(vec2(i.y));
				float s = mix(size, size * rand, variation);

                return smoothstep(-smoothness, smoothness, distance_estimate - s * 0.5);
            }`);return{tileAndCenter:t,circle:r,ring:i,polygon:n,cross:s,diamond:a,checkerboard:o,line:l,wave:c}}();var ak=class extends Ht{constructor(e,t,r,i,n,s,a,o){super("v3"),this.nodeType="Rainbow",this.filmThickness=e,this.movement=t,this.wavelengths=r,this.noiseStrength=i,this.noiseScale=n,this.offset=s,this.isMask=o,this.alpha=a,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.require("vWorldViewDir"),e.require("worldNormal"),e.isShader("fragment")){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let r=e.include(ak.Nodes.rainbow),i=[];return i.push(this.filmThickness.build(e,"f")),i.push(this.movement.build(e,"f")),i.push(this.wavelengths.build(e,"v3")),i.push(this.noiseStrength.build(e,"f")),i.push(this.noiseScale.build(e,"f")),i.push(this.offset.build(e,"v3")),i.push(this.isMask.build(e,"b")),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("RainbowNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},ok=ak;ok.Nodes=function(){let e=new De(`vec3 attenuation(vec3 wavelengths, float filmThickness, float movement, float noiseStrength, float noiseScale, vec3 offset) {
                 vec3 st = position / noiseScale;
				 vec3 q = vec3(simplex3d(st),
							  simplex3d(st + vec3(1.0)),
							  simplex3d(st + vec3(1.0)));

				 vec3 r = vec3(simplex3d(st + vec3(1.4, 1.3, 1.0) * q + vec3(1.7, 9.2, 1.0)),
							  simplex3d(st + vec3(2.0, 1.2, 1.0) * q + vec3(8.3, 2.8, 1.0)),
							  simplex3d(st * q));

                 float noise = simplex3d(st + r);

                 return .5 + .5 * cos((((filmThickness + (noise * noiseStrength)) / (vec3(wavelengths.r * 1.0, wavelengths.g * 0.8, wavelengths.b * 0.6) + 1.0)) * dot(normalize(vWorldViewDir + (offset * -0.001)), normalize(vWNormal))) + movement);
             }`,[qi.simplex]);return{rainbow:new De(`vec3 rainbow(float filmThickness, float movement, vec3 wavelengths, float noiseStrength, float noiseScale, vec3 offset, bool isMask, float mask, float alpha, out float calpha) {
				vec3 res = clamp(attenuation(wavelengths, filmThickness, movement, noiseStrength, noiseScale, offset), 0.0, 2.0);

				float rainbowContribution = clamp(res.r + res.g + res.b, 0.0, 1.0);

				float lalpha = alpha * rainbowContribution * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return res;
             }`,[e])}}();var lk=class extends Ht{constructor(e,t,r,i,n,s,a,o,l,c){super("v3"),this.nodeType="Toon",this.positioning=e,this.colors=t,this.steps=r,this.source=i,this.isWorldSpace=n,this.noiseStrength=s,this.noiseScale=a,this.shadowColor=o,this.offset=l,this.alpha=c,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.require("worldNormal"),e.require("worldPosition"),e.isShader("fragment")){e.define("COLORS_MAX",10),e.addFragmentVariable(this.calpha,"float");let r=e.include(lk.Nodes.toon),i=[];return i.push(this.positioning.build(e,"i")),i.push(this.colors.build(e,"v4[]")),i.push(this.steps.build(e,"f[]")),i.push(this.source.build(e,"v3")),i.push(this.isWorldSpace.build(e,"b")),i.push(this.noiseStrength.build(e,"f")),i.push(this.noiseScale.build(e,"f")),i.push(this.shadowColor.build(e,"v4")),i.push(this.offset.build(e,"v3")),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("ToonNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},ck=lk;ck.Nodes=function(){let e=new De(`float rand(float n) {
				return fract(sin(n) * 43758.5453123);
			}`),t=new De(`float hash1(float p) { 
				p = fract(p * 0.011); 
				p *= p + 7.5; 
				p *= p + p; 
				return fract(p); 
			}`),r=new De(`float valueNoise(vec3 x) {
				const vec3 step = vec3(110, 241, 171);
			
				vec3 i = floor(x);
				vec3 f = fract(x);
			 
				// For performance, compute the base input to a 1D hash from the integer part of the argument and the 
				// incremental change to the 1D based on the 3D -> 1D wrapping
				float n = dot(i, step);
			
				vec3 u = f * f * (3.0 - 2.0 * f);
				return mix(mix(mix( hash1(n + dot(step, vec3(0, 0, 0))), hash1(n + dot(step, vec3(1, 0, 0))), u.x),
							   mix( hash1(n + dot(step, vec3(0, 1, 0))), hash1(n + dot(step, vec3(1, 1, 0))), u.x), u.y),
						   mix(mix( hash1(n + dot(step, vec3(0, 0, 1))), hash1(n + dot(step, vec3(1, 0, 1))), u.x),
							   mix( hash1(n + dot(step, vec3(0, 1, 1))), hash1(n + dot(step, vec3(1, 1, 1))), u.x), u.y), u.z);
			}`,[t]),i=new De(`vec3 hash3(vec3 x) {
				x = vec3(dot(x,vec3(127.1, 311.7, 74.7)),
						 dot(x,vec3(269.5, 183.3, 246.1)),
						 dot(x,vec3(113.5, 271.9, 124.6)));
			
				return fract(sin(x)*43758.5453123);
			}`),n=new De(`vec3 voronoiNoise(in vec3 x)
			{
				vec3 p = floor(x);
				vec3 f = fract(x);

				float id = 0.0;
				vec2 res = vec2(100.0);

				for(int k=-1; k<=1; k++)
				for(int j=-1; j<=1; j++)
				for(int i=-1; i<=1; i++)
				{
					vec3 b = vec3(float(i), float(j), float(k));

					// Comment out the "+ hash(p + b);" part below to get "square" cells
					vec3 r = vec3(b) - f + hash3(p + b);
					float d = dot(r, r);

					if (d < res.x)
					{
						id = dot(p + b, vec3(1.0, 57.0, 113.0));
						res = vec2(d, res.x);			
					}
					else if (d < res.y)
					{
						res.y = d;
					}
				}

				return vec3(sqrt(res), abs(id));
			}
			`,[i]);return{toon:new De(`vec3 toon(int positioning, vec4 colors[COLORS_MAX], float steps[COLORS_MAX], vec3 source, bool isWorldSpace, float noiseStrength, float noiseScale, vec4 shadowColor, vec3 offset, float mask, float alpha, out float calpha) {
				float t = 0.0;
				float shadow = 1.0;

				if (positioning == 0) {

					// Can't do this mode if lighting is "none"
					#if (defined(PHONG) || defined(LAMBERT) || defined(STANDARD))

						// Algorithm from Chapter 10 of Graphics Shaders
						const vec3 weights = vec3(0.2125, 0.7154, 0.0721);
						vec3 lpos;
						vec3 l;
						float dproduct;

						#if (NUM_POINT_LIGHTS > 0)

							#if defined(USE_SHADOWMAP) && (NUM_POINT_LIGHT_SHADOWS > 0)
								PointLightShadow pointLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_POINT_LIGHTS; i++) {
								// Light positions are in view-space for some reason?
								lpos = (inverse(viewMatrix) * vec4(pointLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;
								l = normalize(lpos - worldPosition);
								
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								
								// TODO: we want to use "intensity" but it isn't available in the shader code
								//dproduct += dot(pointLights[UNROLLED_LOOP_INDEX].color, weights);

								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS)
									pointLightShadow = pointLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getPointShadow( 
											pointShadowMap[UNROLLED_LOOP_INDEX], 
											pointLightShadow.shadowMapSize, 
											pointLightShadow.shadowBias, 
											pointLightShadow.shadowRadius,
											vPointShadowCoord[UNROLLED_LOOP_INDEX], 
											pointLightShadow.shadowCameraNear, 
											pointLightShadow.shadowCameraFar);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						#if NUM_DIR_LIGHTS > 0 
							
							#if defined(USE_SHADOWMAP) && (NUM_DIR_LIGHT_SHADOWS > 0)
								DirectionalLightShadow directionalLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_DIR_LIGHTS; i++) {
								// Use the direction vector for directional lights instead
								l = (inverse(viewMatrix) * vec4(directionalLights[UNROLLED_LOOP_INDEX].direction, 0.0)).xyz;
		
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS)
									directionalLightShadow = directionalLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getShadow( 
										UNROLLED_LOOP_INDEX,
										directionalShadowMap[UNROLLED_LOOP_INDEX], 
										directionalLightShadow.shadowMapSize, 
										directionalLightShadow.shadowBias, 
										directionalLightShadow.shadowRadius, 
										vDirectionalShadowCoord[UNROLLED_LOOP_INDEX]);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						#if NUM_SPOT_LIGHTS > 0 
							
							#if defined(USE_SHADOWMAP) && (NUM_SPOT_LIGHT_SHADOWS > 0)
								SpotLightShadow spotLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_SPOT_LIGHTS; i++) {
								lpos = (inverse(viewMatrix) * vec4(spotLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;
								l = normalize(lpos - worldPosition);
								
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS)
									spotLightShadow = spotLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getShadow(
										UNROLLED_LOOP_INDEX,
										spotShadowMap[UNROLLED_LOOP_INDEX], 
										spotLightShadow.shadowMapSize, 
										spotLightShadow.shadowBias, 
										spotLightShadow.shadowRadius, 
										vSpotLightCoord[UNROLLED_LOOP_INDEX]);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						t = clamp(t, 0.0, 1.0);
				
					#endif

				} else if (positioning == 1) {
					
					vec3 origin = mix(position, worldPosition, float(isWorldSpace));
					vec3 direction = normalize(source - origin);
					t = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;	

				} else {

					vec3 origin = worldPosition;
					vec3 source = cameraPosition - offset;
					vec3 direction = normalize(source - origin);
					t = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;	
					
				}

				if (noiseStrength > 0.0) {
					// Distort with noise
					vec3 st = position / noiseScale;
					
					// Voronoi "smooth" noise
					float noise = 1.0 - voronoiNoise(st).x;

					// Voronoi cellular noise
					//float noise = 1.0 - rand(voronoiNoise(st).z);

					// Position warp noise
					// vec3 offset = vec3(
					// 	simplex3d(st),
					// 	simplex3d(st + vec3(111.1, 143.89, 217.19)),
					// 	simplex3d(st + vec3(171.1, 247.89, 117.23))
					// );
					// st += offset;
					// float noise = valueNoise(st);

					t += noise * noiseStrength;
				}

				t = clamp(t, 0.0, 1.0);

				// Compute ramp color
				float p;
				vec4 color = colors[0];
				for (int i = 1; i < COLORS_MAX; i++) {
					p = clamp((t - steps[i-1]) / (steps[i] - steps[i-1]), 0.0, 1.0);
					color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
				}

				// Incorporate custom shadow color
				if (positioning == 0) {

					vec3 blendedShadow = mix(color.rgb, shadowColor.rgb, shadowColor.a);
					color.rgb = mix(blendedShadow, color.rgb, shadow);
				
				}

				// Accumulate alpha as usual
				float lalpha = alpha * color.a * mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha;

				return color.xyz;

            }`,[qi.simplex,e,r,n])}}();var che=function(){return{textureBicubic:new De(`float w0( float a ) {
            return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
        }
    
        float w1( float a ) {
            return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
        }
    
        float w2( float a ){
            return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
        }
    
        float w3( float a ) {
            return ( 1.0 / 6.0 ) * ( a * a * a );
        }
    
        // g0 and g1 are the two amplitude functions
        float g0( float a ) {
            return w0( a ) + w1( a );
        }
    
        float g1( float a ) {
            return w2( a ) + w3( a );
        }
    
        // h0 and h1 are the two offset functions
        float h0( float a ) {
            return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
        }
    
        float h1( float a ) {
            return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
        }
    
        vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
            uv = uv * texelSize.zw + 0.5;
    
            vec2 iuv = floor( uv );
            vec2 fuv = fract( uv );
    
            float g0x = g0( fuv.x );
            float g1x = g1( fuv.x );
            float h0x = h0( fuv.x );
            float h1x = h1( fuv.x );
            float h0y = h0( fuv.y );
            float h1y = h1( fuv.y );
    
            vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
            vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
            vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
            vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
    
            return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) + 
                   g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
        }

        vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
            vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
            vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
            vec2 fLodSizeInv = 1.0 / fLodSize;
            vec2 cLodSizeInv = 1.0 / cLodSize;
            vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
            vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
            return mix( fSample, cSample, fract( lod ) );
        }`)}}();function hhe(e,t){return e>=t?new W(t/e,1):new W(1,e/t)}var hk=class extends Ht{constructor(e,t,r,i,n,s,a,o){super("v3"),this.nodeType="Transmission",this.thickness=e,this.ior=t,this.roughness=r,this.transmissionSamplerSize=i,this.transmissionSamplerMap=n,this.transmissionDepthMap=s,this.aspectRatio=a,this.alpha=o,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.extensions.shaderTextureLOD=!0,e.extensions.derivatives=!0,e.isShader("fragment")){e.define("NUM_SAMPLES",6),e.define("BLUR_SLOD",Math.pow(2,Ze.transmissionLod.value)),e.require("worldPosition"),e.requires.worldNormal=!0,e.requires.modelMatrix=!0,e.requires.projectionMatrix=!0,e.addFragmentVariable(this.calpha,"float");let r=e.include(hk.Nodes.transmission),i=[];return i.push(this.thickness.build(e,"f")),i.push(this.ior.build(e,"f")),i.push(this.roughness.build(e,"f")),i.push(this.transmissionSamplerSize.build(e,"v2")),i.push(this.transmissionSamplerMap.getTexture(e,"t")),i.push(this.transmissionDepthMap.getTexture(e,"t")),i.push(this.aspectRatio.build(e,"v2")),i.push("normal"),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("TransmissionNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},uk=hk;uk.Nodes=function(){let e=new De(`vec3 blur(sampler2D sp, vec2 U, vec2 scale, float lod, sampler2D dm, vec2 unrefractedU, vec2 aspectRatio) {
                // Slightly modified version of this:
                // https://www.shadertoy.com/view/ltScRG

				// Special case for blur == 0.0
				if (lod == 0.0) {
					#ifdef TEXTURE_LOD_EXT
					return texture2DLodEXT( sp, U, 0.0).rgb;
					#else
					return textureLod( sp, U, 0.0).rgb;
					#endif
				}
				
				vec2 texelSize = vec2(1.0) / resolution;
                vec2 halton = haltonSequence[frameIndex];
                float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
                float temporalAngle  = temporalOffset * PI2;
				vec3 res = vec3(0.0);
                vec2 uv = vec2(0.0);
                vec2 offset = vec2(0.0);
                vec2 vogelSample = vec2(0.0);
                for (int i = 0; i < NUM_SAMPLES; i++) {
                    vogelSample =  vogelDiskSample(i, NUM_SAMPLES, temporalAngle) * texelSize;
                    offset = vogelSample * scale * (lod * 10.0); // TODO: used to be hardcoded to 20
                    uv = U + offset;
                    float opaqueDepth = unpackRGBAToDepth(textureLod(dm, uv, lod));
                    if (opaqueDepth != 0.0 && opaqueDepth < gl_FragCoord.z) {
                        uv = unrefractedU;
                        lod = lod > 4.0 ? lod : lod / 2.0;
                    }
                    res += textureLod(sp, uv, lod).rgb;
                }
                return res / float(NUM_SAMPLES);
            }`),t=new De(`vec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {
		        // Direction of refracted light.
		        vec3 refractionVector = refract( -v,  n, 1.0 / ior );
		        
				// Compute rotation-independant scaling of the model matrix.
		        vec3 modelScale;
		        modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		        modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		        modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );

		        // The thickness is specified in local space
		        return normalize( refractionVector ) * thickness * modelScale;
	        }`),r=new De(`float applyIorToRoughness( float roughness, float ior ) {
				// Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and
				// an IOR of 1.5 results in the default amount of microfacet refraction.
				return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
			}`),i=new De(`vec3 getTransmissionSample( vec2 fragCoord, float roughness, float ior, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 unrefractedCoords, vec2 aspectRatio) {
				// Threejs exports do not pass a depth map to this shader, so we have to fallback to the "Threejs method of blurring" - see
				// also the code in convertTransmission.ts, which runs during export
				#ifdef IS_THREEJS_EXPORT
					float lod = log2(transmissionSamplerSize.x) * applyIorToRoughness(roughness / 5.0, ior);
					return textureBicubic(transmissionSamplerMap, fragCoord.xy, lod).rgb;
				#else
					float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
					float lod = applyIorToRoughness(roughness, ior);
					return blur(transmissionSamplerMap, fragCoord, vec2(lod), min(framebufferLod / 5.5, 8.5), transmissionDepthMap, unrefractedCoords, aspectRatio);
				#endif
			}`,[che.textureBicubic,r,e]),n=new De(`vec3 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;

				// Project refracted vector on the framebuffer, while mapping to normalized device coordinates.
				vec4 ndcPos = projMatrix * viewMatrix *  vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;

				vec4 ndcPosUnrefracted = projMatrix * viewMatrix * vec4(position, 1.0 );
				vec2 unrefractedCoords = ndcPosUnrefracted.xy / ndcPosUnrefracted.w;
				unrefractedCoords += 1.0;
				unrefractedCoords /= 2.0;

				// Sample framebuffer to get pixel the refracted ray hits.
				return getTransmissionSample( refractionCoords, roughness, ior, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, unrefractedCoords, aspectRatio );
    		}`,[i,t]);return{transmission:new De(`vec3 transmission(float thickness, float ior, float roughness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio, vec3 normal, float mask, float alpha, out float calpha) {
                vec3 v = vec3(0.);
                if (isOrthographic) {
                    v = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
                } else {
                    v = normalize(vWPosition - cameraPosition);
                }
                vec3 transmission = getIBLVolumeRefraction(vWNormal, -v, roughness,  vWPosition, modelMatrix, viewMatrix, projectionMatrix, ior, thickness, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, aspectRatio );
                
				float lalpha = alpha * mask;
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * alpha;

				return transmission;
            }`,[n])}}();var S_=(e=>(e.NOISE="noise",e.MAP="map",e))(S_||{}),dk=class extends Ht{constructor(e,t,r,i,n,s,a,o,l,c,u){super("v3"),this.displacementTypeIndex=new Wt(0),this.nodeType="VertexDisplacement",this.intensity=e,this.movementOrTexture=t,Object.values(S_)[this.displacementTypeIndex.value]==="map"&&(this.mat=new Xz(this.movementOrTexture.value.matrix)),this.cropOrOffset=r,this.scale=c,this.noiseFunctionIndex=u,this.voronoiStyle=i,this.smoothness=n,this.seed=s,this.highCut=a,this.lowCut=o,this.quality=l}generate(e,t){if(e.isShader("vertex")){e.define("USE_LAYER_DISPLACE");let r,i=[];switch(i.push("displaced_position"),i.push("displaced_normal"),Object.values(S_)[this.displacementTypeIndex.value]){case"map":{r=e.include(dk.Nodes.map),i.push(this.movementOrTexture.getTexture(e,"t")),i.push("uv"),i.push(this.cropOrOffset.build(e,"f")),this.mat&&i.push(this.mat.build(e,"mat3"));break}case"noise":{let n=Object.values(EA)[this.noiseFunctionIndex.value],s=new De(`vec3 orthogonal(vec3 v) {
							return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));
						}`),a=n=="voronoi"?`
					float v = ${n}((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1), voronoiStyle, smoothness, seed, quality);
					v = remap(v, lowCut, highCut, 0.0, 1.0);
					v = smax(v, 0.0, smoothness * 0.25);
					v = smin(v, 1.0, smoothness * 0.25);

					return p + n * v * intensity;
					`:`
					return p + n * ${n}((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1)) * intensity;
					`,o=new De(`vec3 distorted(vec3 p, vec3 n, float scale, float intensity, vec3 offset, float neighbour_offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality) {
							${a}
						}`,[qi.simplex,qi.simplexFractal,qi.simplexAshima,qi.fbm,qi.perlin,qi.voronoi]),l=new De(`vec3 vertexDisplacementNoise(vec3 position, vec3 normal, float scale, vec3 offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality, float intensity, out vec3 displaced_normal) {
							vec3 displaced_position = distorted(position, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							vec3 tangent1 = orthogonal(normal);
							vec3 tangent2 = normalize(cross(normal, tangent1));

                            // TODO(Max): The distance to the neighbors was originally scaled by 0.1.
                            // This caused some small oval/circular visual artifacts in the lighting.
                            // For now, simply using neighbors further away betters the problem,
                            // but we should figure out the underlying cause when we have some time.
                            // Maybe its related to how we calculate the tangent and bitangent?
							vec3 nearby1 = position + tangent1;
							vec3 nearby2 = position + tangent2;
							vec3 distorted1 = distorted(nearby1, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							vec3 distorted2 = distorted(nearby2, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							displaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));
							return displaced_position;
						}`,[o,s]);r=e.include(l),i.push(this.scale.build(e,"f")),i.push(this.cropOrOffset.build(e,"v3")),i.push(this.movementOrTexture.build(e,"f")),i.push(this.voronoiStyle.build(e,"i")),i.push(this.smoothness.build(e,"f")),i.push(this.seed.build(e,"f")),i.push(this.highCut.build(e,"f")),i.push(this.lowCut.build(e,"f")),i.push(this.quality.build(e,"i"));break}}return i.push(this.intensity.build(e,"f")),i.push("displaced_normal"),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("VertexDisplacementNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},pk=dk;pk.Nodes=function(){let e=new De(`vec3 orthogonal(vec3 v) {
				return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));
			}`),t=new De(`float displacementMapTexture(sampler2D tex, float crop, vec2 uv, mat3 mat, vec2 offset) {
				vec2 uvs = (mat * vec3(uv * 2.0 - 1.0, 1.0) / 2.0 + 0.5).xy + offset;
				vec4 tmp = texture2D(tex, uvs);
				vec3 col = tmp.rgb;
				if (crop > 0.5) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						return 0.0;
					}
				}
				return col.r;
			}`);return{map:new De(`vec3 vertexDisplacementMap(vec3 position, vec3 normal, sampler2D tex, vec2 uv, float crop, mat3 mat, float intensity, out vec3 displaced_normal) {
				vec3 displaced_position = position + normal * displacementMapTexture(tex, crop, uv, mat, vec2(0.0)) * intensity;
				vec3 tangent1 = normalize(orthogonal(normal));
				vec3 tangent2 = normalize(cross(normal, tangent1));
				vec3 nearby1 = position + tangent1 * 0.1;
				vec3 nearby2 = position + tangent2 * 0.1;
				vec3 distorted1 = nearby1 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;
				vec3 distorted2 = nearby2 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;
				displaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));
				return displaced_position;
			}`,[e,t])}}();var Ze={normalRenderTarget:new Xa,normalRenderTargetDepth:new Xa,transmissionRenderTarget:new Xa,aspectRatio:new li,transmissionSize:new li(2048,2048),transmissionRenderTargetDepth:new Xa,aoRenderTarget:new Xa,aoEnabled:new Oi,pixelRatioNode:new Be(1),resolution:new li,penumbraSize:new $l(5,.5),frameIndex:new Wt(0),transmissionLod:new Wt(2)};for(let e of Object.values(Ze))e.isRenderGlobal=!0;var fk=class extends Il{constructor(){super("basic"),this.nodeType="Basic",this.color=new mr(rs),this.shadingAlpha=new Be(1),this.shadingBlend=new Wt(0),this.previousModelViewMatrix=new ya,this.previouseProjectionMatrix=new ya}get category(){return"phong"}generate(e){let t;if(e.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:Ze.frameIndex}),e.mergeUniform({resolution:Ze.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(ud.merge([Pe.fog])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#if defined( USE_LAYER_DISPLACE )
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <begin_vertex>
				#endif /* !USE_LAYER_DISPLACE */
				`];r&&i.push(r.code,r.result?"displaced_position = "+r.result+";":""),i.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","	vNormal = transformedNormal;","#endif"),i.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join(`
`)}else{this.color===void 0&&(this.color=new mr(rs)),this.color.analyze(e,{slot:"color"}),this.alpha&&this.alpha.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"});let r=this.color.flow(e,"c",{slot:"color"}),i=this.alpha?this.alpha.flow(e,"f"):void 0,n=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0,s=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0;e.requires.transparent=i!==void 0,e.addParsCode(["varying vec3 vWPosition;","#include <fog_pars_fragment>","#include <dithering_pars_fragment>","varying vec3 vViewPosition;","#include <normal_pars_fragment>"].join(`
`));let a=["#include <normal_fragment_begin>",r.code];i&&a.push(i.code,"#ifdef ALPHATEST"," if ( "+i.result+" <= ALPHATEST ) discard;","#endif"),s?a.push(s.code,`vec3 outgoingLight = ${r.result};`,`vec3 finalColor = spe_blend(outgoingLight, ${s.result}, 1.0, SPE_BLENDING_NORMAL);`):a.push(`vec3 finalColor = ${r.result};`);let o="1.0";this.mask&&(this.mask.analyze(e),o=`luminance(${this.mask.flow(e,"v3").result})`),i?a.push(`gl_FragColor = vec4( finalColor, accumAlpha * ${i.result} * ${o} );`):a.push("gl_FragColor = vec4("+r.result+", 1.0 );"),n&&a.push(`gl_FragColor.a *= ${n.result};`),a.push("#include <fog_fragment>","#include <dithering_fragment>"),t=a.join(`
`)}return t}},uhe=class extends Il{constructor(){super("lambert"),this.nodeType="Lambert",this.color=new mr(rs),this.emissive=new mr(0),this.emissiveIntensity=new Be(1),this.previousModelViewMatrix=new ya,this.previouseProjectionMatrix=new ya,this.shadingAlpha=new Be(1),this.shadingBlend=new Wt(0),this.occlusion=new Oi(!0)}get category(){return"lambert"}build(e){let t;if(e.define("LAMBERT"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:Ze.frameIndex}),e.mergeUniform({resolution:Ze.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(ud.merge([Pe.fog,Pe.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","	varying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <color_pars_vertex>","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];r&&i.push(r.code,r.result?"displaced_position = "+r.result+";":""),i.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("	#include <project_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>",`
					vec3 diffuse = vec3( 1.0 );
					GeometricContext geometry;
					geometry.position = mvPosition.xyz;
					geometry.normal = normalize( transformedNormal );
					geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
				`),i.push(`
					GeometricContext backGeometry;
					backGeometry.position = geometry.position;
					backGeometry.normal = -geometry.normal;
					backGeometry.viewDir = geometry.viewDir;
					vLightFront = vec3( 0.0 );
					vIndirectFront = vec3( 0.0 );
					#ifdef DOUBLE_SIDED
						vLightBack = vec3( 0.0 );
						vIndirectBack = vec3( 0.0 );
					#endif
					IncidentLight directLight;
					float dotNL;
					vec3 directLightColor_Diffuse;
					vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
					vIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );
					#ifdef DOUBLE_SIDED
						vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
						vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );
					#endif
					#if NUM_POINT_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
							getPointLightInfo( pointLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_SPOT_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
							getSpotLightInfo( spotLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_DIR_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
							getDirectionalLightInfo( directionalLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_HEMI_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
							vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
							#ifdef DOUBLE_SIDED
								vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );
							#endif
						}
						#pragma unroll_loop_end
					#endif
				`,"	#include <shadowmap_vertex>","	#include <fog_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join(`
`)}else{e.mergeUniform({penumbraSize:Ze.penumbraSize}),e.mergeUniform({frameIndex:Ze.frameIndex}),e.mergeUniform({aoMap:Ze.aoRenderTarget}),e.mergeUniform({aoEnabled:Ze.aoEnabled}),this.color===void 0&&(this.color=new mr(rs)),this.color.analyze(e,{slot:"color"}),this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let r=this.color.flow(e,"c",{slot:"color"}),i=this.emissive.flow(e,"c",{slot:"emissive"}),n=this.emissiveIntensity.flow(e,"f",{slot:"emissive"}),s=this.occlusion.flow(e,"b",{slot:"occlusion"}),a=this.shadingAlpha.flow(e,"f"),o=this.shadingBlend.flow(e,"i"),l=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,c=this.alpha?this.alpha.flow(e,"f"):void 0,u=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0;e.requires.transparent=c!==void 0,e.addParsCode(["uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#include <normal_pars_fragment>","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","	varying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <fog_pars_fragment>","#include <shadowmap_pars_fragment>","#include <shadowmask_pars_fragment>","#include <clipping_planes_pars_fragment>","#include <dithering_pars_fragment>"].join(`
`));let h=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx, viewdy));
				bool isFrontFacing = (dot(normal, faceNormal) >= 0.0);
				`,"#include <clipping_planes_fragment>"];h.push(r.code,"vec3 diffuseColor = "+r.result+";","ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );"),c&&h.push(c.code,"#ifdef ALPHATEST","if ( "+c.result+" <= ALPHATEST ) discard;","#endif"),h.push("#ifdef DOUBLE_SIDED","	reflectedLight.indirectDiffuse += ( isFrontFacing ) ? vIndirectFront : vIndirectBack;","#else","	reflectedLight.indirectDiffuse += vIndirectFront;","#endif","#include <lightmap_fragment>","reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );","#ifdef DOUBLE_SIDED","	reflectedLight.directDiffuse = ( isFrontFacing ) ? vLightFront : vLightBack;","#else","	reflectedLight.directDiffuse = vLightFront;","#endif","reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();"),i&&h.push(i.code,"reflectedLight.directDiffuse += "+i.result+" * "+n.result+";"),h.push("vec3 ao = aoEnabled && "+s.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = (reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) ;");let d="1.0";this.mask&&(this.mask.analyze(e),d=`luminance(${this.mask.flow(e,"v3").result})`),h.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${a.result} * ${d} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${a.result} * ${d}, ${o.result} );

					outgoingLight *= ao;
				}
				`),l&&h.push(l.code,`outgoingLight = spe_blend(outgoingLight, ${l.result}, 1.0, SPE_BLENDING_NORMAL);`),c?h.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${c.result} );`):h.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),u&&h.push(`gl_FragColor.a *= ${u.result};`),h.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=h.join(`
`)}return t}},td=function(){let e=new De(`vec2 dHdxy(sampler2D bumpMap, vec2 bumpMapUv, float bumpScale) {

            // Gradient of UVs w.r.t. X coordinate (in screen-space)
            vec2 dSTdx = dFdx(bumpMapUv);

            // Gradient of UVs w.r.t. Y coordinate (in screen-space)
            vec2 dSTdy = dFdy(bumpMapUv);
            
            // Forward differencing
            float Hll = bumpScale * luminance(texture(bumpMap, bumpMapUv).rgb);
            float dBx = bumpScale * luminance(texture(bumpMap, bumpMapUv + dSTdx).rgb) - Hll;
            float dBy = bumpScale * luminance(texture(bumpMap, bumpMapUv + dSTdy).rgb) - Hll;
            
            return vec2( dBx, dBy );
        }`),t=new De(`vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
            vec3 vSigmaX = dFdx( surf_pos.xyz );
            vec3 vSigmaY = dFdy( surf_pos.xyz );
            vec3 vN = surf_norm; // normalized
            
            vN = normalize(vN);

            vec3 R1 = cross( vSigmaY, vN );
            vec3 R2 = cross( vN, vSigmaX );

            R1 = normalize(R1);
            R2 = normalize(R2);
    
            float fDet = dot( vSigmaX, R1 ) * faceDirection;
    
            vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
            return normalize( abs( fDet ) * vN - vGrad );
        }`);return{dHdxy:e,perturbNormalArb:t}}(),dhe=class extends Il{constructor(){super("phong"),this.nodeType="Phong",this.color=new mr(rs),this.specular=new mr(1118481),this.shininess=new Be(30),this.previousModelViewMatrix=new ya,this.previouseProjectionMatrix=new ya,this.shadingAlpha=new Be(1),this.shadingBlend=new Wt(0),this.occlusion=new Oi(!0)}get category(){return"phong"}build(e){let t;if(e.define("PHONG"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:Ze.frameIndex}),e.mergeUniform({resolution:Ze.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(ud.merge([Pe.fog,Pe.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif


				vec3 displaced_position = position;
				vec3 displaced_normal = objectNormal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];r&&i.push(r.code,r.result?"displaced_position = "+r.result+";":""),i.push("transformed = displaced_position;","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("	#include <project_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>","	#include <shadowmap_vertex>","	#include <fog_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join(`
`)}else{e.mergeUniform({penumbraSize:Ze.penumbraSize}),e.mergeUniform({frameIndex:Ze.frameIndex}),e.mergeUniform({aoMap:Ze.aoRenderTarget}),e.mergeUniform({aoEnabled:Ze.aoEnabled}),this.color===void 0&&(this.color=new mr(rs)),this.color.analyze(e,{slot:"color"}),this.specular.analyze(e),this.shininess.analyze(e);let r=this.occlusion.flow(e,"b",{slot:"occlusion"});this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let i=this.color.flow(e,"c",{slot:"color"}),n=this.specular.flow(e,"c"),s=this.shininess.flow(e,"f"),a=this.shadingAlpha.flow(e,"f"),o=this.shadingBlend.flow(e,"i"),l=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,c=this.alpha?this.alpha.flow(e,"f"):void 0,u=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0;e.requires.transparent=c!==void 0,e.addParsCode(["varying vec3 vWPosition;","uniform vec3 emissive;","uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_phong_pars_fragment>","#include <shadowmap_pars_fragment>","#include <dithering_pars_fragment>"].join(`
`));let h=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	BlinnPhongMaterial material;"];if(this.bumpMap){e.include(td.dHdxy),e.include(td.perturbNormalArb);let p=this.bumpMap.texture.flow(e,"t"),f=this.bumpMap.flow(e,"v3"),m=this.bumpMapIntensity?this.bumpMapIntensity.flow(e,"f").result:"1.0",g="";this.bumpMap.projection.value===4?g=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${p.result}, uv0, ${m});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${p.result}, uv1, ${m});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${p.result}, uv2, ${m});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:g=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${p.result}, bumpMapCachedUv, ${m});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,h.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${f.result};
					${g}
					`)}h.push(i.code,"	vec3 diffuseColor = "+i.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","	vec3 totalEmissiveRadiance = emissive;",n.code,"	vec3 specular = "+n.result+";",s.code,"	float shininess = max( 0.0001, "+s.result+" );","	float specularStrength = 1.0;"),c&&h.push(c.code,"#ifdef ALPHATEST","if ( "+c.result+" <= ALPHATEST ) discard;","#endif"),h.push("material.diffuseColor = diffuseColor;"),h.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),h.push("vec3 ao = aoEnabled && "+r.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;");let d="1.0";this.mask&&(this.mask.analyze(e),d=`luminance(${this.mask.flow(e,"v3").result})`),h.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${a.result} * ${d} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${a.result} * ${d}, ${o.result} );
					
					outgoingLight *= ao;
				}
				`),l&&h.push(l.code,`outgoingLight = spe_blend(outgoingLight, ${l.result}, 1.0, SPE_BLENDING_NORMAL);`),c?h.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${c.result});`):h.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),u&&h.push(`gl_FragColor.a *= ${u.result};`),h.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=h.join(`
`)}return t}},phe=class extends Il{constructor(){super("standard"),this.nodeType="Standard",this.color=new mr(rs),this.roughness=new Be(.3),this.metalness=new Be(0),this.reflectivity=new Be(.5),this.previousModelViewMatrix=new ya,this.previouseProjectionMatrix=new ya,this.shadingAlpha=new Be(1),this.shadingBlend=new Wt(0),this.occlusion=new Oi(!0)}get category(){return"physical"}build(e){let t;if(e.define("STANDARD"),e.requires.lights=!0,e.extensions.derivatives=!0,e.extensions.shaderTextureLOD=!0,e.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:Ze.frameIndex}),e.mergeUniform({resolution:Ze.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(ud.merge([Pe.fog,Pe.lights])),Pe.LTC_1&&(e.uniforms.ltc_1={value:void 0},e.uniforms.ltc_2={value:void 0}),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#if defined( USE_LAYER_DISPLACE )
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <begin_vertex>
				#endif /* !USE_LAYER_DISPLACE */
				`];r&&i.push(r.code,r.result?"displaced_position = "+r.result+";":""),i.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>","#include <shadowmap_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join(`
`)}else{e.mergeUniform({penumbraSize:Ze.penumbraSize}),e.mergeUniform({frameIndex:Ze.frameIndex}),e.mergeUniform({aoMap:Ze.aoRenderTarget}),e.mergeUniform({aoEnabled:Ze.aoEnabled});let r={gamma:!0};this.color===void 0&&(this.color=new mr(rs)),this.color.analyze(e,{slot:"color",context:r}),this.roughness.analyze(e),this.metalness.analyze(e);let i=this.occlusion.flow(e,"b",{slot:"occlusion"});this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e),this.reflectivity&&this.reflectivity.analyze(e);let n=this.color.flow(e,"c",{slot:"color",context:r}),s=this.roughness.flow(e,"f"),a=this.metalness.flow(e,"f"),o=this.shadingAlpha.flow(e,"f"),l=this.shadingBlend.flow(e,"i"),c=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,u=this.alpha?this.alpha.flow(e,"f"):void 0,h=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0,d=this.reflectivity?this.reflectivity.flow(e,"f"):void 0;e.requires.transparent=u!==void 0,e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <dithering_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_physical_pars_fragment>","#include <shadowmap_pars_fragment>"].join(`
`));let p=["#include <clipping_planes_fragment>","	#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	PhysicalMaterial material;","	material.diffuseColor = vec3( 1.0 );"];if(this.bumpMap){e.include(td.dHdxy),e.include(td.perturbNormalArb);let m=this.bumpMap.texture.flow(e,"t"),g=this.bumpMap.flow(e,"v3"),v=this.bumpMapIntensity?this.bumpMapIntensity.flow(e,"f").result:"1.0",y="";this.bumpMap.projection.value===4?y=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${m.result}, uv0, ${v});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${m.result}, uv1, ${v});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${m.result}, uv2, ${v});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:y=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${m.result}, bumpMapCachedUv, ${v});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,p.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${g.result};
					${y}
					`)}if(p.push(n.code,"	vec3 diffuseColor = "+n.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",a.code,"	float metalnessFactor = "+a.result+";"),this.roughnessMap){let m=this.roughnessMap.texture.flow(e,"t"),g=this.roughnessMap.flow(e,"v3"),v="";this.roughnessMap.projection.value===4?v=`
					float roughnessChange = 1.0;
					{
						vec2 uv0 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						float r0 = luminance(texture(${m.result}, uv0).rgb) * roughnessScale;
						float r1 = luminance(texture(${m.result}, uv1).rgb) * roughnessScale;
						float r2 = luminance(texture(${m.result}, uv2).rgb) * roughnessScale;

						roughnessChange = (r0 * weights.z + r1 * weights.x + r2 * weights.y);
					}
					float roughnessFactor = roughnessChange * ${s.result};
					`:v=`
					vec2 roughnessMapCachedUv = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs;

					vec4 vals = texture(${m.result},  roughnessMapCachedUv);
					float roughnessFactor = luminance(vals.rgb) * ${s.result};
					`,p.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${g.result};

					const float roughnessScale = 1.0;

					${v}
				`)}else p.push(s.code,"	float roughnessFactor = "+s.result+";");u&&p.push(u.code,"#ifdef ALPHATEST","	if ( "+u.result+" <= ALPHATEST ) discard;","#endif"),p.push("vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );"),p.push("material.diffuseColor = diffuseColor * ( 1.0 - metalnessFactor );","material.roughness = max( roughnessFactor, 0.0525 );","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.roughness = clamp( roughnessFactor, 0.04, 1.0 );"),d?p.push(d.code,"material.specularColor = mix( vec3( 0.16 * pow2( "+d.result+" ) ), diffuseColor, metalnessFactor );"):p.push("material.specularColor = mix( vec3( 0.04 ), diffuseColor, metalnessFactor );"),p.push("#include <lights_fragment_begin>"),p.push("#include <lights_fragment_end>"),p.push("vec3 ao = aoEnabled && "+i.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular;");let f="1.0";this.mask&&(this.mask.analyze(e),f=`luminance(${this.mask.flow(e,"v3").result})`),p.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${o.result} * ${f} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${o.result} * ${f}, ${l.result} );
					
					outgoingLight *= ao;
				}
				`),c&&p.push(c.code,`outgoingLight = spe_blend(outgoingLight, ${c.result}, 1.0, SPE_BLENDING_NORMAL);`),u?p.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${u.result} );`):p.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),h&&p.push(`gl_FragColor.a *= ${h.result};`),p.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=p.join(`
`)}return t}},fhe=class extends Il{constructor(){super("toon"),this.nodeType="Toon",this.color=new mr(rs),this.specular=new mr(1118481),this.shininess=new Be(30),this.previousModelViewMatrix=new ya,this.previouseProjectionMatrix=new ya,this.shadingAlpha=new Be(1),this.shadingBlend=new Wt(0)}get category(){return"toon"}build(e){let t;if(e.define("TOON"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:Ze.frameIndex}),e.mergeUniform({resolution:Ze.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(ud.merge([Pe.fog,Pe.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];r&&i.push(r.code,r.result?"displaced_position = "+r.result+";":""),i.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("	#include <project_vertex>","	#include <fog_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>","	#include <shadowmap_vertex>","	#include <fog_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join(`
`)}else{e.mergeUniform({penumbraSize:Ze.penumbraSize}),e.mergeUniform({frameIndex:Ze.frameIndex}),e.mergeUniform({aoMap:Ze.aoRenderTarget}),e.mergeUniform({aoEnabled:Ze.aoEnabled}),this.color===void 0&&(this.color=new mr(rs)),this.color.analyze(e,{slot:"color"}),this.specular.analyze(e),this.shininess.analyze(e),this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let r=this.color.flow(e,"c",{slot:"color"}),i=this.specular.flow(e,"c"),n=this.shininess.flow(e,"f"),s=this.shadingAlpha.flow(e,"f"),a=this.shadingBlend.flow(e,"i"),o=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,l=this.alpha?this.alpha.flow(e,"f"):void 0,c=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0;e.requires.transparent=l!==void 0,e.addParsCode(["uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vWPosition;","#include <normal_pars_fragment>","#include <gradientmap_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <dithering_pars_fragment>",`
					varying vec3 vViewPosition;
					struct ToonMaterial {
						vec3	diffuseColor;
						vec3	specularColor;
						float	specularShininess;
						float	specularStrength;
					};
					void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
						vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
			
						reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
						reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
					}
					void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
						reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
					}
					#define RE_Direct				RE_Direct_Toon
					#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
					#define Material_LightProbeLOD( material )	(0)
					`,"#include <shadowmap_pars_fragment>","#include <bumpmap_pars_fragment>","#include <normalmap_pars_fragment>"].join(`
`));let u=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	ToonMaterial material;"];if(this.bumpMap){e.include(td.dHdxy),e.include(td.perturbNormalArb);let d=this.bumpMap.texture.flow(e,"t"),p=this.bumpMap.flow(e,"v3"),f=this.bumpMapIntensity?this.bumpMapIntensity.flow(e,"f").result:"1.0",m="";this.bumpMap.projection.value===4?m=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${d.result}, uv0, ${f});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${d.result}, uv1, ${f});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${d.result}, uv2, ${f});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:m=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${d.result}, bumpMapCachedUv, ${f});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,u.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${p.result};
					${m}
					`)}u.push(r.code,"	vec3 diffuseColor = "+r.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",i.code,"	vec3 specular = "+i.result+";",n.code,"	float shininess = max( 0.0001, "+n.result+" );","	float specularStrength = 1.0;"),l&&u.push(l.code,"#ifdef ALPHATEST","if ( "+l.result+" <= ALPHATEST ) discard;","#endif"),u.push("material.diffuseColor = diffuseColor;"),u.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),u.push("vec3 ao = aoEnabled ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) * ao) + reflectedLight.directSpecular;");let h="1.0";this.mask&&(this.mask.analyze(e),h=`luminance(${this.mask.flow(e,"v3").result})`),u.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${s.result} * ${h} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${s.result} * ${h}, ${a.result} );
				}
				`),o&&u.push(o.code,`outgoingLight = spe_blend(outgoingLight, ${o.result}, 1.0, SPE_BLENDING_NORMAL);`),l?u.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${l.result} );`):u.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),c&&u.push(`gl_FragColor.a *= ${c.result};`),u.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=u.join(`
`)}return t}},mhe=class{constructor(e=1e3*10){this.timeout=e,this.cache=new Map,this.head={data:null,time:0,src:null,next:null,prev:null},this.tail={data:null,time:1/0,src:null,next:null,prev:null},this.hasClean=!1,this.head.next=this.tail,this.tail.prev=this.head}log(...e){}remove(e){let t=this.cache.get(e);t&&(this.dispose(e,t.data),this.cache.delete(e),t.prev.next=t.next,t.next.prev=t.prev)}scheduleCleanup(){this.hasClean||(this.log("scheduled cleanup"),this.hasClean=!0,setTimeout(()=>{this.hasClean=!1,this.log("cleaning");let e=Date.now(),t=this.head.next;for(;t.time<e-this.timeout;)this.dispose(t.src,t.data),this.cache.delete(t.src),t=t.next,t.prev=this.head,this.head.next=t;this.head.next!==this.tail?this.scheduleCleanup():this.log("no more cleanup")},this.timeout+1e3))}has(e){var t;return(t=this.cache.get(e))==null?void 0:t.data}load(e){let t=Date.now(),r=this.cache.get(e);return r===void 0?(r={data:this.create(e),src:e,time:t,next:null,prev:null},this.cache.set(e,r)):(r.time=t,r.prev.next=r.next,r.next.prev=r.prev),r.prev=this.tail.prev,r.next=this.tail,this.tail.prev.next=r,this.tail.prev=r,this.scheduleCleanup(),r.data}},ghe=class extends mhe{create(e){return URL.createObjectURL(new Blob([e]))}dispose(e,t){URL.revokeObjectURL(t)}},gw;function vhe(e){return typeof e=="string"?e:(gw||(gw=new ghe),gw.load(e))}var yhe=class{constructor(e,t){this.data=e,this.cache=t,this.refCount=0}deref(){this.refCount,this.refCount-=1,this.refCount===0&&(this.cache.remove(this),this.dispose())}dispose(){this.refCount}},xhe=class{constructor(){this.cache=new Map}remove(e){this.cache.delete(e.data)}load(e){let t=this.cache.get(e);return t===void 0&&(t=this.create(e),this.cache.set(e,t)),t.refCount+=1,t}},mk=class extends yhe{constructor(e,t){super(e,t.imageHolderCache),this.data=e,this.shared=t,this.loaded=!1,this.isVideo=!1,this.isVideo=e.type==="video",this.updateSrc(e.data)}async updateSrc(e){if(typeof document>"u")return;this.disposeTextures(),this.loaded=!1;let t=()=>{this.loaded=!0;let i=[1e3,1001,1002];for(let n of i){let s=this[n];s&&(s.image=this.img,s.needsUpdate=!0)}this.shared.requestRender()};if(this.isVideo){if(this.img=document.createElement("video"),this.img.preload="auto",this.img.playsInline=!0,this.img.currentTime=.01,typeof e!="string"){var r=new FileReader;r.readAsDataURL(new Blob([e],{type:"video/mp4"}));let i;await new Promise(n=>{r.onloadend=s=>{var a;i=(a=s.target)==null?void 0:a.result,n(null)}}),this.img.src=i}else this.img.src=e;this.img.onloadeddata=()=>{t()}}else this.img=new Image,this.img.src=vhe(e),this.img.onload=t}getTexture(e){let t=this[e];if(t)return t;{let r;return this.isVideo?r=new RK(this.img,void 0,e,e):r=new jr(this.img,void 0,e,e),this.loaded&&(r.needsUpdate=!0),this[e]=r,r}}disposeTextures(){var e,t,r;(e=this[1e3])==null||e.dispose(),this[1e3]=void 0,(t=this[1001])==null||t.dispose(),this[1001]=void 0,(r=this[1002])==null||r.dispose(),this[1002]=void 0}dispose(){super.dispose(),this.disposeTextures()}},pc=class extends mk{};function Bi(e,t){return t.color(e)}function whe(e,t){switch(e.type){case"fresnel":return She(e,t);case"gradient":return Ahe(e);case"depth":return Che(e);case"normal":return Mhe(e);case"noise":return Ehe(e,t);case"rainbow":return The(e);case"toon":return Phe(e,t);case"outline":return Dhe(e,t);case"transmission":return Lhe(e);case"color":return _he(e,t);case"pattern":return Ihe(e,t)}}function bhe(e){return{type:e.type}}function Os(e){let{alpha:t,mode:r,isMask:i}=e;return{...bhe(e),alpha:t,mode:r,isMask:i}}function _he(e,t){return{...Os(e),color:Bi(e.color,t)}}function She(e,t){let{bias:r,scale:i,intensity:n,factor:s,color:a,isMask:o}=e;return{...Os(e),color:Bi(a,t),bias:r,scale:i,intensity:n,factor:s}}function Ahe(e){let{gradientType:t,smooth:r,colors:i,steps:n,angle:s,offset:a,morph:o}=e;return{...Os(e),gradientType:t,smooth:r,colors:i.map(l=>new dt(l[0],l[1],l[2],l[3])),num:i.length,steps:n,offset:new W(...a),morph:new W(...o),angle:s}}function Che(e){let{gradientType:t,near:r,far:i,isVector:n,isWorldSpace:s,origin:a,direction:o,colors:l,steps:c,smooth:u}=e;return{...Os(e),gradientType:t,near:r,far:i,isVector:n,isWorldSpace:s,origin:new E(...a),direction:o?new E(...o):new E(1,0,0),colors:l.map(h=>h!==void 0?new dt(h[0],h[1],h[2],h[3]):new dt(0,0,0,0)),steps:c.slice(0,l.length),smooth:u}}function Mhe(e){let{cnormal:t}=e;return{...Os(e),cnormal:new E(t[0],t[1],t[2])}}function Ehe(e,t){return{...Os(e),scale:e.scale,move:e.move,fA:new W(...e.fA),fB:new W(...e.fB),size:new E(...e.size),distortion:new W(...e.distortion),colorA:Bi(e.colorA,t),colorB:Bi(e.colorB,t),colorC:Bi(e.colorC,t),colorD:Bi(e.colorD,t),noiseType:e.noiseType,voronoiStyle:e.voronoiStyle,highCut:e.highCut,lowCut:e.lowCut,smoothness:e.smoothness,seed:e.seed,quality:e.quality}}function The(e){return{...Os(e),filmThickness:e.filmThickness,movement:e.movement,wavelengths:new E(...e.wavelengths),noiseStrength:e.noiseStrength,noiseScale:e.noiseScale,offset:new E(...e.offset)}}function Phe(e,t){return{...Os(e),positioning:e.positioning,colors:e.colors.map(r=>new dt(r[0],r[1],r[2],r[3])),num:e.colors.length,steps:e.steps,source:new E(...e.source),isWorldSpace:e.isWorldSpace,noiseStrength:e.noiseStrength,noiseScale:e.noiseScale,shadowColor:Bi(e.shadowColor,t),offset:new E(...e.offset)}}function Dhe(e,t){return{...Os(e),outlineColor:Bi(e.outlineColor,t),contourColor:Bi(e.contourColor,t),outlineWidth:e.outlineWidth,contourWidth:e.contourWidth,outlineThreshold:e.outlineThreshold,contourThreshold:e.contourThreshold,outlineSmoothing:e.outlineSmoothing,contourFrequency:e.contourFrequency,contourDirection:new E(...e.contourDirection),positionalLines:e.positionalLines,compensation:e.compensation}}function Lhe(e,t){return{...Os(e),thickness:e.thickness,ior:e.ior,roughness:e.roughness}}function Ihe(e,t){return{...Os(e),style:e.style,projection:e.projection,axis:e.axis,blending:e.blending,offset:new W(...e.offset),colorA:Bi(e.colorA,t),colorB:Bi(e.colorB,t),frequency:new W(...e.frequency),size:e.size,variation:e.variation,smoothness:e.smoothness,zigzag:e.zigzag,rotation:e.rotation,vertical:new W(...e.vertical),horizontal:new W(...e.horizontal),sides:e.sides}}var iy=class extends nn{},gk={noise:["noiseType"],texture:["projection","axis","side"],video:["projection","axis","side"],displace:["noiseType"],light:["roughnessMap","bumpMap"],depth:["smooth","isWorldSpace","gradientType","isVector"],pattern:["style","projection","axis"]},vk={depth:["colors"]};function Ohe(e,t,r){var s,a;if(t==="isMask")return!0;let i=gk[e.type],n=vk[e.type];if(n!==void 0){let o=e.color;if(n.includes(t)){let l=(a=(s=o[t])==null?void 0:s.value)==null?void 0:a.length;if(l!==void 0&&l!==r.length)return!0}}return i!==void 0?i.includes(t):!1}function yk(e,t,r){let i=r.uniforms[`f${r.id}_texture`];if(!i)return!1;let n=!1,s=e;if("image"in s){let a=s.image,o=t.image(a),l=i;l.image instanceof pc||l.image.deref(),l.image=o}if("video"in s){let a=s.video,o=t.video(a),l=i;l.image instanceof pc||l.image.deref(),l.image=o}if("wrapping"in s){let a=i;a.wrap=s.wrapping}if("repeat"in s||"offset"in s){let a="mat",o=r.uniforms[`f${r.id}_${a}`];"repeat"in s&&(o.repeat=s.repeat),"offset"in s&&(o.offset=s.offset),o.updateMatrix()}return n}function Rhe(e,t,r,i){let n=!1;for(let[s,a]of Object.entries(e)){if(s==="bumpMap"||s==="roughnessMap"){n=!0;continue}if(!s||a===void 0)continue;if(wk(s,r,i)){s==="visible"&&r.type==="light"&&(n=!0);continue}r.visible=i.visible;let o=r.uniforms[`f${r.id}_${s}`];if(o&&!(o instanceof CA))switch(n=n||Ohe(r,s,a),o.constructor){case mr:if(typeof a=="string"){let l=t.getColor(a);l&&(o.value=l);break}else{let l=a;o.value instanceof iy?o.value=new nn(l.r,l.g,l.b,l.a):o.setRGBA(l);break}case ja:if(typeof a=="string"){let l=t.getColor(a);l&&(o.value=l);break}else{let l=a;o.value instanceof iy?o.value=new nn(l.r,l.g,l.b,l.a):o.value.setRGBA(l.r,l.g,l.b,l.a);break}case li:{let l=a;o.value.setX(l[0]),o.value.setY(l[1]);break}case kn:{let l=a;o.value.setX(l[0]),o.value.setY(l[1]),o.value.setZ(l[2]);break}case Xa:{yk(a,t,r);break}case Jl:{o.value=a.map(l=>new dt(...l));break}default:{o.value=a;break}}}return n}var Ac=class{constructor(e,t,r,i){this.id=e,this.uuid=t,this.data=r,this.uniforms={};for(let n in i)this.uniforms[`f${this.id}_${n}`]=i[n];for(let n in r)wk(n,this,r)}get type(){return this.data.type}static create(e,t,r,i){if(r.type==="light")return Va.createLigherLayer(e,t,r,i);if(r.type==="texture"||r.type==="video"){let n=r.type==="texture"?i.image(r.texture.image):i.video(r.texture.video),s=new b_(n,r.texture.wrapping),a=new ahe(n),o=new ohe(r.texture.repeat,r.texture.offset),l=new Be(r.crop?1:0),c=new Wt(r.projection??0),u=new Wt(["x","y","z"].indexOf(r.axis)??0),h=new Wt(r.side??0),d=new li(r.size?new W(r.size[0],r.size[1]):new W(100,100)),p=new Be(r.blending??0),f=new Be(r.alpha??1),m=new Wt(r.mode??0),g=new Oi(r.isMask??!1),v=new MA(s,a,l,c,u,h,d,p,o,f,m,g),y=new Zt(v.calpha,"f");return new hr(e,t,r,{texture:s,textureSize:a,crop:l,projection:c,axis:u,side:h,size:d,blending:p,mat:o,alpha:f,mode:m,isMask:g},v,m,y,g)}else if(r.type==="matcap"){let n=i.image(r.texture.image),s=new b_(n,r.texture.wrapping),a=new Be(r.alpha??1),o=new Wt(r.mode??0),l=new Oi(r.isMask??!1),c=new tk(s,a,o,l),u=new Zt(c.calpha,"f");return new hr(e,t,r,{texture:s,alpha:a,mode:o,isMask:l},c,o,u,l)}else if(r.type==="displace")if(r.displacementType==="noise"){let n=new kn(new E(...r.offset)),s=new Be(r.scale??10),a=new Be(r.intensity??8),o=new Be(r.movement??1),l=new Wt(r.noiseType??0),c=new Wt(r.voronoiStyle??0),u=new Be(r.smoothness??.5),h=new Be(r.seed??0),d=new Be(r.highCut??1),p=new Be(r.lowCut??0),f=new Wt(r.quality??1),m=new pk(a,o,n,c,u,h,d,p,f,s,l);return new xk(e,t,r,{offset:n,scale:s,intensity:a,movement:o,noiseType:l,voronoiStyle:c,smoothness:u,seed:h,highCut:d,lowCut:p,quality:f},m)}else throw new Error;else return khe(e,t,r,i)}updateByOp(e,t,r){let i=e;if(i.path[0]===void 0){if(i.type===0)return"type"in i.props||"category"in i.props||"visible"in i.props?(r.scene.markNeedsUpdateRendererDirty(),!0):Rhe(i.props,r.shared,this,t)}else if(i.path[0]==="texture")return"texture"in t||"video"in t?yk(i.props,r.shared,this):!0;return!1}dispose(){if(Bhe(this)){let e=this.uniforms[`f${this.id}_texture`];if(!e)return!1;let t=e;t.image instanceof pc||t.image.deref()}}hasValueByKey(e){return this.uniforms[e]!==void 0}hasValue(e){return this.hasValueByKey(`f${this.id}_${e}`)}setValue(e,t){let r=`f${this.id}_${e}`;this.hasValueByKey(r)&&t!==void 0&&(this.uniforms[r].value=t)}getNode(e){let t=`f${this.id}_${e}`;if(this.hasValueByKey(t))return this.uniforms[t]}getValue(e){let t=`f${this.id}_${e}`;if(this.hasValueByKey(t))return this.uniforms[t].value}getName(e){let t=/f\d+_(.*)/.exec(e);if(t&&t.length>1)return t[1];console.log(`Layer.getName: error ${e}`)}getNames(){let e=[];for(let t in this.uniforms){let r=this.getName(t);r&&e.push(r)}return e}},hr=class extends Ac{constructor(e,t,r,i,n,s,a,o){super(e,t,r,i),this.params=i,this.color=n,this.mode=s,this.alpha=a,this.isMask=o}},xk=class extends Ac{constructor(e,t,r,i,n){super(e,t,r,i),this.position=n}},Va=class extends Ac{constructor(e,t,r,i,n){super(e,t,r,n),this.node=i}static createLigherLayer(e,t,r,i){let n,s=new Be(r.alpha),a=new Wt(r.mode),o=new Be(r.bumpMapIntensity),l=new Be(r.alphaOverride),c;if(!r.visible)n=new fk,c={};else if(r.category==="lambert"){n=new uhe;let u=new mr(i.color(r.emissive)??0),h=new Oi(r.occlusion??!0);c={emissive:u,occlusion:h},n.emissive=u,n.occlusion=h}else if(r.category==="toon"){n=new fhe;let u=new Be(r.shininess??30),h=new mr(i.color(r.specular)??1118481);c={shininess:u,specular:h},n.shininess=u,n.specular=h}else if(r.category==="physical"){n=new phe;let u=new Be(r.roughness??.3),h=new Be(r.metalness??0),d=new Be(r.reflectivity??.5),p=new Oi(r.occlusion??!0);c={roughness:u,metalness:h,reflectivity:d,occlusion:p},n.roughness=u,n.metalness=h,n.reflectivity=d,n.occlusion=p}else{n=new dhe;let u=new Be(r.shininess??30),h=new mr(r.specular!==void 0?i.color(r.specular)??1118481:1118481),d=new Oi(r.occlusion??!0);c={shininess:u,specular:h,occlusion:d},n.shininess=u,n.specular=h,n.occlusion=d}return n.alpha=new Be(1),n.shadingAlpha=s,n.shadingBlend=a,n.bumpMapIntensity=o,n.alphaOverride=l,c.alpha=n.shadingAlpha,c.mode=n.shadingBlend,c.bumpMapIntensity=n.bumpMapIntensity,c.alphaOverride=n.alphaOverride,new Va(e,t,r,n,c)}get category(){return this.node.category}};function Bhe(e){let t=e instanceof Ac?e.type:e;return t==="texture"||t==="video"||t==="displace_map"||t==="matcap"}function On(e){return{alpha:new Be(e.alpha??1),mode:new Wt(e.mode??0),isMask:new Oi(e.isMask??!1)}}function zhe(e,t,r,i){switch(e.type){case"color":{let n=new mr(i.color??rs),s=On(i),a=new __(n,s.alpha),o=new Zt(a.calpha,"f");return new hr(t,r,e,{color:n,...s},a,s.mode,o,s.isMask)}case"fresnel":{let n=new mr(i.color??16777215),s=new Be(i.bias??.1),a=new Be(i.scale??1),o=new Be(i.intensity??2),l=new Be(i.factor??1),c=On(i),u=new lhe(n,s,a,o,l,c.alpha,c.mode,c.isMask),h=new Zt(u.calpha,"f");return new hr(t,r,e,{color:n,bias:s,scale:a,intensity:o,factor:l,...c},u,c.mode,h,c.isMask)}case"rainbow":{let n=new Be(i.filmThickness??30),s=new Be(i.movement??0),a=new kn(i.wavelengths??new E(0,0,0)),o=new Be(i.noiseStrength??0),l=new Be(i.noiseScale??1),c=new kn(i.offset??new E(0,0,0)),u=On(i),h=new ok(n,s,a,o,l,c,u.alpha,u.isMask),d=new Zt(h.calpha,"f");return new hr(t,r,e,{filmThickness:n,movement:s,wavelengths:a,noiseStrength:o,noiseScale:l,offset:c,...u},h,u.mode,d,u.isMask)}case"transmission":{let n=new Be(i.thickness??10),s=new Be(i.ior??1.5),a=new Be(i.roughness??.5),o=Ze.transmissionSize,l=Ze.transmissionRenderTarget,c=Ze.transmissionRenderTargetDepth,u=window.innerWidth,h=window.innerHeight,d=u>=h?new li(h/u,1):new li(1,u/h),p=On(i),f=new uk(n,s,a,o,l,c,d,p.alpha),m=new Zt(f.calpha,"f");return new hr(t,r,e,{thickness:n,ior:s,roughness:a,aspectRatio:d,...p},f,p.mode,m,p.isMask)}case"toon":{let n=new Wt(i.positioning??0),s;i.colors?s=new Jl(i.colors.length,i.colors):(s=new Jl(10,new dt(0,0,0,1)),s.value[1]=new dt(1,1,1,1));let a;i.steps?a=new $l(i.steps.length,i.steps):(a=new $l(10,1),a.value[0]=0);let o=new kn(i.source??new E(0,0,0)),l=new Oi(i.isWorldSpace??!0),c=new Be(i.noiseStrength??0),u=new Be(i.noiseScale??1),h=new ja(i.shadowColor),d=new kn(i.offset??new E(0,0,0)),p=On(i),f=new ck(n,s,a,o,l,c,u,h,d,p.alpha),m=new Zt(f.calpha,"f");return new hr(t,r,e,{positioning:n,colors:s,steps:a,source:o,isWorldSpace:l,noiseStrength:c,noiseScale:u,shadowColor:h,offset:d,...p},f,p.mode,m,p.isMask)}case"outline":{let n=new mr(i.outlineColor??16777215),s=new mr(i.contourColor??16777215),a=new Be(i.outlineWidth??.1),o=new Be(i.contourWidth??.1),l=new Be(i.outlineThreshold??.1),c=new Be(i.contourThreshold??.1),u=new Be(i.outlineSmoothing??.1),h=new Be(i.contourFrequency??.1),d=new kn(i.contourDirection??new E(0,1,0)),p=new Oi(i.positionalLines??!1),f=new Oi(i.compensation??!0),m=Ze.normalRenderTarget,g=Ze.normalRenderTargetDepth,v=Ze.pixelRatioNode,y=Ze.resolution,x=On(i),w=new nk(n,s,a,o,l,c,u,h,d,p,f,y,m,g,v,x.alpha),b=new Zt(w.calpha,"f");return new hr(t,r,e,{outlineColor:n,contourColor:s,outlineWidth:a,contourWidth:o,outlineThreshold:l,contourThreshold:c,outlineSmoothing:u,contourFrequency:h,contourDirection:d,positionalLines:p,compensation:f,...x},w,x.mode,b,x.isMask)}case"depth":{let n=new Wt(i.gradientType??0),s=new Oi(i.smooth??!1),a=new Be(i.near??50),o=new Be(i.far??200),l=new Be(i.isVector??1),c=new Be(i.isWorldSpace??0),u=new kn(i.origin??new E),h=new kn(i.direction??new E),d;i.colors?d=new Jl(i.colors.length,i.colors):(d=new Jl(2,new dt(0,0,0,1)),d.value[1]=new dt(1,1,1,1));let p;i.steps?p=new $l(i.steps.length,i.steps):(p=new $l(2,1),p.value[0]=0);let f=On(i),m=new Zz(n,s,a,o,l,c,u,h,d,p,f.alpha,f.isMask),g=new Zt(m.calpha,"f");return new hr(t,r,e,{gradientType:n,smooth:s,near:a,far:o,isVector:l,isWorldSpace:c,origin:u,direction:h,colors:d,steps:p,...f},m,f.mode,g,f.isMask)}case"noise":{let n=new Be(i.scale??1),s=new kn(i.size??new E(100,100,100)),a=new Be(i.move??1),o=new li(i.fA??new W(1.7,9.2)),l=new li(i.fB??new W(8.3,2.8)),c=new li(i.distortion??new W(1,1)),u=new ja(i.colorA),h=new ja(i.colorB),d=new ja(i.colorC),p=new ja(i.colorD),f=new Wt(i.noiseType??0),m=new Wt(i.voronoiStyle??0),g=new Be(i.highCut??1),v=new Be(i.lowCut??0),y=new Be(i.smoothness??.5),x=new Be(i.seed??.5),w=new Wt(i.quality??1),b=On(i),_=new rk(n,s,a,o,l,c,u,h,d,p,b.alpha,f,b.isMask,m,g,v,y,x,w),A=new Zt(_.calpha,"f");return new hr(t,r,e,{scale:n,size:s,move:a,fA:o,fB:l,distortion:c,colorA:u,colorB:h,colorC:d,colorD:p,noiseType:f,...b,voronoiStyle:m,highCut:g,lowCut:v,smoothness:y,seed:x,quality:w},_,b.mode,A,b.isMask)}case"normal":{let n=new kn(i.cnormal??new E(1,1,1)),s=On(i),a=new Kz(n,s.alpha),o=new Zt(a.calpha,"f");return new hr(t,r,e,{cnormal:n,...s},a,s.mode,o,s.isMask)}case"gradient":{let n=new Wt(i.gradientType??0),s=new Oi(i.smooth??!1),a;i.colors?a=new Jl(i.colors.length,i.colors):(a=new Jl(10,new dt(0,0,0,1)),a.value[1]=new dt(1,1,1,1));let o;i.steps?o=new $l(i.steps.length,i.steps):(o=new $l(10,1),o.value[0]=0);let l=new li(i.offset??new W(0,0)),c=new li(i.morph??new W(0,0)),u=new Be(i.angle??0),h=On(i),d=new Jz(n,s,a,o,l,c,u,h.alpha,h.isMask),p=new Zt(d.calpha,"f");return new hr(t,r,e,{gradientType:n,smooth:s,colors:a,steps:o,offset:l,morph:c,angle:u,...h},d,h.mode,p,h.isMask)}case"pattern":{let n=new Wt(i.style??0),s=new Wt(i.projection??0),a=new Wt(["x","y","z"].indexOf(i.axis)??0),o=new Be(i.blending??0),l=new li(i.offset??new W(0,0)),c=new ja(i.colorA),u=new ja(i.colorB),h=new li(i.frequency??new W(10,10)),d=new Be(i.size??.5),p=new Be(i.variation??0),f=new Be(i.smoothness??.5),m=new Be(i.zigzag??0),g=new Be(i.rotation??0),v=new li(i.vertical??new W(0,1)),y=new li(i.horizontal??new W(0,1)),x=new Wt(i.sides??6),w=On(i),b=new sk(n,s,a,o,l,c,u,h,d,p,f,m,g,v,y,x,w.alpha,w.isMask),_=new Zt(b.calpha,"f");return new hr(t,r,e,{style:n,projection:s,axis:a,blending:o,offset:l,colorA:c,colorB:u,frequency:h,size:d,variation:p,smoothness:f,zigzag:m,rotation:g,vertical:v,horizontal:y,sides:x,...w},b,w.mode,_,w.isMask)}default:{let n=new mr(1,0,0,1),s=On(i),a=new __(n,s.alpha),o=new Zt(a.calpha,"f");return new hr(t,r,e,{color:n,...s},a,s.mode,o,s.isMask)}}}function khe(e,t,r,i){let n=whe(r,i);return zhe(r,e,t,n)}function wk(e,t,r){if(r.type==="displace"&&(e==="intensity"||e==="visible")){let i=t.uniforms[`f${t.id}_intensity`];return i?(i.value=r.intensity*(r.visible?1:0),i):void 0}if(r.type!=="displace"&&(e==="alpha"||e==="visible")){let i=t.uniforms[`f${t.id}_alpha`];if(!i)return;if(i.value=r.alpha*(r.visible?1:0),r.type==="outline"&&e==="visible"){let n=t.uniforms[`f${t.id}_compensation`];n&&(n.value=r.compensation&&r.visible)}return i}}function ny(e,t){let r=0,i=e.layers.find(n=>n.data.type==="light");if(i&&i.data.alphaOverride<1)return!0;for(let n of e.layers){if(n.data.type!=="displace"&&n.data.isMask)return!0;if(n.data.type!=="displace"&&"alpha"in n.data&&n.data.type!=="light"&&n.data.type!=="fresnel"&&n.data.type!=="texture"&&n.data.type!=="matcap"&&n.data.type!=="rainbow"&&n.data.type!=="outline"&&n.data.type!=="pattern"){let s=n.data.visible?n.data.alpha:0;if(s===1&&n.data.type==="depth"||n.data.type==="gradient"){for(let a of n.data.colors)if(a[3]<1){s=a[3];break}}else if(s===1&&n.data.type==="noise"){let a=t.color(n.data.colorA).a,o=t.color(n.data.colorB).a,l=t.color(n.data.colorC).a,c=t.color(n.data.colorD).a,u=Math.min(a,Math.min(o,Math.min(l,c)));u<1&&(s=u)}r+=(1-r)*s}}return r<1}var Cl=class extends Yt{constructor(){super(void 0),this.flatShading=!1,this.needsJitter=!0,this.cacheKey="",this.fog=!0,this.dithering=!0,this.vertexColors=!0,this.transparent=!0}customProgramCacheKey(){return this.cacheKey}},Nhe=class extends Cl{constructor(e,t,r,i){super(),this.flatShading=e,this.side=t,this.wireframe=r,this.root=i}updateAfterBuild(){let e=this.root;this.lights=e.lights,this.vertexShader=e.vertexShader,this.fragmentShader=e.fragmentShader,this.defines=e.defines,this.uniforms=e.uniforms,this.extensions=e.extensions,this.transparent=e.transparent,this.cacheKey=e.customProgramCacheKey()+"flat"+this.flatShading+this.side}onBeforeCompile(e,t){this.root.onBeforeCompile(e)}get data(){return this.root.data}get category(){return this.root.category}get hasAO(){return this.root.hasAO}getFlavor(e,t,r){return this.root.getFlavor(e,t,r)}get layers(){return this.root.layers}get fragment(){return this.root.fragment}getLayersOfType(e){return this.root.getLayersOfType(e)}getLayerByUuid(e){return this.root.getLayerByUuid(e)}updateByOp(e,t,r){this.root.updateByOp(e,t,r)}nodeMaterialDispose(){this.root.nodeMaterialDispose()}},TA=class extends Cl{constructor(e,t){super(),this.data=e,this.layerIdGen=0,this.flavors=[],this.masks={},this.type="NodeMaterial",this.updaters=[],this.reset0(e,t)}get nodeMaterial(){return this}getFlavor(e,t,r){let i=r?6:(e?3:0)+t;if(i===0)return this;this.flavors===void 0&&(this.flavors=[]),i-=1;let n=this.flavors[i];return n===void 0&&(n=new Nhe(e,t,r,this),this.flavors[i]=n,n.flatShading=e,n.side=t,n.updateAfterBuild()),n}get fragment(){return this.lightLayer.node}get category(){return this.lightLayer.category}get hasAO(){var e;return((e=this.lightLayer.getNode("occlusion"))==null?void 0:e.value)??!1}reset(e,t){this.data!==e&&this.reset0(e,t)}reset0(e,t){this.data=e;let r=e.layers??wi.defaultTwoLayerData("phong").layers;try{this.layers=r.map(i=>Ac.create(this.layerIdGen++,i.id,i.data,t.shared))}catch{this.layers=[]}this.layers.reverse(),this.name=e.name??"Untitled Material",this.onUpdate(),this.transparent=ny(e,t.shared)}getLayersOfType(e){return this.layers.filter(t=>t.type===e)}getLayerByUuid(e){return this.layers.find(t=>t.uuid===e)}onUpdate(){this.cacheKey=this.computeCacheKey(),this.lightLayer=this.layers.find(e=>e instanceof Va),this.lightLayer===void 0&&(this.lightLayer=new Va(0,"",{...Wi.defaultData("light","phong"),visible:!1},new fk,{})),this.dispose();for(let e of this.flavors)e&&e.dispose();this.applyTextureMaps(),this.applyMasks(),this.blendColors(),this.blendAfterColors(),this.blendPositions()}applyTextureMaps(){let e=this.layers.find(n=>n instanceof Va);if(!e)return;let t=e.data,r=t.bumpMap,i=t.roughnessMap;e.node.bumpMap=void 0,e.node.roughnessMap=void 0;for(let n=0;n<this.layers.length;++n){let s=this.layers[n];s instanceof hr&&s.color instanceof MA&&(s.uuid===r&&(e.node.bumpMap=s.color),s.uuid===i&&(e.node.roughnessMap=s.color))}}updateByOp(e,t,r){if(t!==void 0?this.data=t:t=this.data,this.transparent=ny(t,r.shared),e.path[0]==="layers"){this.data=t;let i=r.shared,n=e.path[1];if(n===void 0){if(this.layers.reverse(),e.type===4){let s=Ac.create(this.layerIdGen++,e.id,e.data,r.shared);this.layers.splice(e.localIndex,0,s),r.scene.markNeedsUpdateRendererDirty()}else if(e.type===5)this.layers.splice(e.localIndex,1)[0].dispose(),r.scene.markNeedsUpdateRendererDirty();else if(e.type===6){let s=this.layers.findIndex(o=>o.uuid===e.id),a=this.layers[s];this.layers.splice(s,1),this.layers.splice(e.localIndex,0,a),r.scene.markNeedsUpdateRendererDirty()}this.layers.reverse(),this.onUpdate()}else{e.type===0&&e.props.occlusion!==void 0&&r.scene.markNeedsUpdateRendererDirty();let s=this.layers.find(a=>a.uuid===n);if(s){let a=t.layers.data(n);if(s.updateByOp({...e,path:e.path.slice(2)},a,r)){let o=Ac.create(this.layerIdGen++,n,a,i);this.layers.splice(this.layers.findIndex(l=>l.uuid===n),1,o),this.onUpdate()}}}}else this.reset(t,r)}applyMasks(){for(let e=0;e<this.layers.length;++e){let t=this.layers[e];t instanceof hr?t.color.mask=void 0:t instanceof Va&&(t.node.mask=void 0)}for(let e=0;e<this.layers.length;++e){let t=this.layers[e];if(t instanceof hr&&t.isMask.value&&t.data.visible&&e>0){let r=e-1,i=this.layers[r];i instanceof Va?i.node.mask=new Hi(t.color,t.alpha,Hi.MUL):i instanceof hr&&(i.isMask.value||(i.color.mask=new Hi(t.color,t.alpha,Hi.MUL)))}}}blendColors(){let e=this.layers.findIndex(r=>r instanceof hr),t=this.layers.findIndex(r=>r instanceof Va);if(e!==-1&&e<t){let r=this.layers[e].color;for(let i=e+1;i<t;++i){let n=this.layers[i];if(n instanceof hr){if(n.isMask.value)continue;r=new MD(r,n.color,n.alpha,n.mode)}}this.fragment.color=r}else this.fragment.color=void 0}blendAfterColors(){let e=new Zt("outgoingLight","f"),t=this.layers.findIndex(r=>r instanceof Va);if(this.layers.length>t+1){for(let r=t+1;r<this.layers.length;++r){let i=this.layers[r];if(i instanceof hr){if(i.isMask.value)continue;e=new MD(e,i.color,i.alpha,i.mode)}}this.fragment.afterColor=e}else this.fragment.afterColor=void 0}blendPositions(){let e=this.layers.filter(t=>t instanceof xk);if(e.length>0){let t=e[0].position;for(let r=1;r<e.length;++r)e[r]&&(t=new Hi(t,e[r].position,Hi.ADD),t=new Hi(t,new Be(.5).setReadonly(!0),Hi.MUL));this.fragment.position=t}else this.fragment.position=void 0}getDefines(){return this.defines}getUniforms(){return this.uniforms}getVertexShader(){return this.vertexShader}getFragmentShader(){return this.fragmentShader}onBeforeCompile(e){this.build(),e.defines=this.defines,e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e.extensionDerivatives=this.extensions.derivatives===!0,e.extensionFragDepth=this.extensions.fragDepth===!0,e.extensionDrawBuffers=this.extensions.drawBuffers===!0,e.extensionShaderTextureLOD=this.extensions.shaderTextureLOD===!0}clampUniformsForPreview(e,t){let r=(i,n,s)=>Math.min(Math.max(i,n),s);for(let i of this.layers)if(i.type==="displace"){let n=r(i.uniforms[`f${i.id}_intensity`].value,e,t);i.uniforms[`f${i.id}_intensity`].value=n}}computeCacheKey(){let e="[";for(let{data:t}of this.data.layers)if(t.type==="light")e+=`"${t.visible?t.category.toUpperCase():"Basic"}"`;else{let r=(gk[t.type]??[]).map(o=>t[o]),i=(vk[t.type]??[]).map(o=>{var l;return((l=t[o])==null?void 0:l.length)??0}),n=[...r,...i],s="isMask"in t&&t.isMask,a=`"${t.type}-${t.visible}-${s}"`;n.length?e+=`[${a}, "${n.join('","')}"],`:e+=a}return e=e.slice(0,-1)+"]",e}updateFrame(e){for(let t=0;t<this.updaters.length;++t)e.updateNode(this.updaters[t])}build(){let e=new she;e.needsJitter=this.needsJitter,this.lights=this.lightLayer.data.visible,e.build(this.fragment,this.fragment),this.vertexShader=e.getCode("vertex"),this.fragmentShader=e.getCode("fragment"),this.defines=e.defines,this.uniforms=e.uniforms,this.extensions=e.extensions,this.updaters=e.updaters;for(let t of this.flavors)t&&t.updateAfterBuild();return this}nodeMaterialDispose(){this.layers.forEach(e=>e.dispose()),super.dispose();for(let e of this.flavors)e&&e.dispose()}assetsLoaded(){for(let e of this.layers)if(e instanceof hr){let t=e.params.texture;if(t instanceof b_&&!t.image.loaded)return!1}return!0}getHash(){let e="{";return e+='"fragment":'+this.fragment.getHash(),e+="}",e}};Object.defineProperties(Cl.prototype,{properties:{get:function(){return this.fragment.properties}}});var A_=class extends TA{},Fhe=ld(AG()),ED=new Map;function Uhe(e){if(typeof e=="string")return e;let t=ED.get(e);return t||(t={url:URL.createObjectURL(new Blob([e]))},ED.set(e,t)),t.url}var Op=class{constructor({src:e,volume:t,delay:r,loop:i}){this._volume=1,this.delay=0,this._loop=1,this.loopsRemaining=0,this._status="stopped",this.onEnd=()=>{this.loopsRemaining===1/0?this.replay():this.loopsRemaining>1?(this.replay(),this.loopsRemaining--):(this._status="stopped",this.loopsRemaining=this._loop)};let n;typeof e=="string"?n={src:e}:n={src:Uhe(e),format:"wav"},this.sound=new Fhe.Howl(n),this.sound.on("end",this.onEnd),this.src=e,t!==void 0&&(this.volume=t),r!==void 0&&(this.delay=r),i!==void 0&&(this.loop=i)}get status(){return this._status}get volume(){return this._volume}set volume(e){this._volume=e,this.sound.volume(e)}get loop(){return this._loop}set loop(e){this._loop=e,this.loopsRemaining=e}replay(){this.clearDelay(),this.delayTimerId=window.setTimeout(()=>{this.sound.play(),this.clearDelay()},this.delay)}fade(e,t=1e3){e?(this.sound.volume(this._volume),this.clearFade(),this.fadeTimerId=window.setTimeout(()=>{this.sound.fade(this._volume,0,t),this.clearFade()},e)):this.sound.fade(this._volume,0,t)}on(e,t,r){this.sound.on(e,t,r)}off(e,t,r){this.sound.off(e,t,r)}play(){this._status==="playing"||this.sound.playing()||(this._status==="paused"?(this.sound.seek()===0?this.replay():this.sound.play(),this._status="playing"):this._status==="stopped"&&(this.replay(),this._status="playing"))}pause(){this._status==="playing"&&(this.sound.pause(),this.clearFade(),this.clearDelay(),this._status="paused")}stop(){this.sound.stop(),this.loopsRemaining=this._loop,this.clearFade(),this.clearDelay(),this._status="stopped"}clearFade(){this.fadeTimerId&&(clearTimeout(this.fadeTimerId),delete this.fadeTimerId)}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}dispose(e=!1){this.off(),this.stop(),this.clearFade(),this.clearDelay()}},jhe=class{constructor(){this.type="ShapePath",this.color=new $e,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new A0,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){var r;return(r=this.currentPath)==null||r.lineTo(e,t),this}quadraticCurveTo(e,t,r,i){var n;return(n=this.currentPath)==null||n.quadraticCurveTo(e,t,r,i),this}bezierCurveTo(e,t,r,i,n,s){var a;return(a=this.currentPath)==null||a.bezierCurveTo(e,t,r,i,n,s),this}splineThru(e){var t;return(t=this.currentPath)==null||t.splineThru(e),this}toShapes(){let e={ORIGIN:0,DESTINATION:1,BETWEEN:2,LEFT:3,RIGHT:4,BEHIND:5,BEYOND:6},t={loc:e.ORIGIN,t:0};function r(p,f,m,g){let v=p.x,y=f.x,x=m.x,w=g.x,b=p.y,_=f.y,A=m.y,S=g.y,C=(w-x)*(b-A)-(S-A)*(v-x),M=(y-v)*(b-A)-(_-b)*(v-x),T=(S-A)*(y-v)-(w-x)*(_-b),P=C/T,D=M/T;if(T===0&&C!==0||P<=0||P>=1||D<0||D>1)return null;if(C===0&&T===0){for(let I=0;I<2;I++)if(i(I===0?m:g,p,f),t.loc===e.ORIGIN){let B=I===0?m:g;return{x:B.x,y:B.y,t:t.t}}else if(t.loc===e.BETWEEN){let B=+(v+t.t*(y-v)).toPrecision(10),X=+(b+t.t*(_-b)).toPrecision(10);return{x:B,y:X,t:t.t}}return null}else{for(let X=0;X<2;X++)if(i(X===0?m:g,p,f),t.loc===e.ORIGIN){let H=X===0?m:g;return{x:H.x,y:H.y,t:t.t}}let I=+(v+P*(y-v)).toPrecision(10),B=+(b+P*(_-b)).toPrecision(10);return{x:I,y:B,t:P}}}function i(p,f,m){let g=m.x-f.x,v=m.y-f.y,y=p.x-f.x,x=p.y-f.y,w=g*x-y*v;if(p.x===f.x&&p.y===f.y){t.loc=e.ORIGIN,t.t=0;return}if(p.x===m.x&&p.y===m.y){t.loc=e.DESTINATION,t.t=1;return}if(w<-Number.EPSILON){t.loc=e.LEFT;return}if(w>Number.EPSILON){t.loc=e.RIGHT;return}if(g*y<0||v*x<0){t.loc=e.BEHIND;return}if(Math.sqrt(g*g+v*v)<Math.sqrt(y*y+x*x)){t.loc=e.BEYOND;return}let b;g!==0?b=y/g:b=x/v,t.loc=e.BETWEEN,t.t=b}function n(p,f){let m=[],g=[];for(let v=1;v<p.length;v++){let y=p[v-1],x=p[v];for(let w=1;w<f.length;w++){let b=f[w-1],_=f[w],A=r(y,x,b,_);A!==null&&m.find(S=>S.t<=A.t+Number.EPSILON&&S.t>=A.t-Number.EPSILON)===void 0&&(m.push(A),g.push(new W(A.x,A.y)))}}return g}function s(p,f,m){let g=new W;f.getCenter(g);let v=[];return m.forEach(y=>{y.boundingBox.containsPoint(g)&&n(p,y.points).forEach(x=>{v.push({identifier:y.identifier,isCW:y.isCW,point:x})})}),v.sort((y,x)=>y.point.x-x.point.x),v}function a(p,f,m,g,v){(v==null||v==="")&&(v="nonzero");let y=new W;p.boundingBox.getCenter(y);let x=[new W(m,y.y),new W(g,y.y)],w=s(x,p.boundingBox,f);w.sort((M,T)=>M.point.x-T.point.x);let b=[],_=[];w.forEach(M=>{M.identifier===p.identifier?b.push(M):_.push(M)});let A=b[0].point.x,S=[],C=0;for(;C<_.length&&_[C].point.x<A;)S.length>0&&S[S.length-1]===_[C].identifier?S.pop():S.push(_[C].identifier),C++;if(S.push(p.identifier),v==="evenodd"){let M=S.length%2===0,T=S[S.length-2];return{identifier:p.identifier,isHole:M,for:T}}else if(v==="nonzero"){let M=!0,T=null,P=null;for(let D=0;D<S.length;D++){let I=S[D];f[I]&&(M?(P=f[I].isCW,M=!1,T=I):P!==f[I].isCW&&(P=f[I].isCW,M=!0))}return{identifier:p.identifier,isHole:M,for:T}}else console.warn('fill-rule: "'+v+'" is currently not implemented.')}let o=0,l=999999999,c=-999999999,u=[];this.subPaths.forEach(p=>{let f=p.getPoints(),m=-999999999,g=999999999,v=-999999999,y=999999999;for(let x=0;x<f.length;x++){let w=f[x];w.y>m&&(m=w.y),w.y<g&&(g=w.y),w.x>v&&(v=w.x),w.x<y&&(y=w.x)}c<=v&&(c=v+1),l>=y&&(l=y-1),f.length&&u.push({curves:p.curves,points:f,isCW:zR.isClockWise(f),identifier:o++,boundingBox:new FZ(new W(y,g),new W(v,m))})});let h=u.map(p=>{var f;return a(p,u,l,c,(f=this.userData)==null?void 0:f.style.fillRule)}),d=[];return u.forEach(p=>{let f=h[p.identifier];if(f&&!f.isHole){let m=new C0;m.curves=p.curves,h.filter(g=>(g==null?void 0:g.isHole)&&g.for===p.identifier).forEach(g=>{if(g){let v=u[g.identifier],y=new A0;y.curves=v.curves,m.holes.push(y)}}),d.push(m)}}),d}},bk,TD=new Promise(e=>{bk=e}),PD=!1,qg;function Vhe(){if(PD)return;if(qg)return qg;async function e(){let t=await cm(()=>import("./opentype-fc28cde9.js"),[]);bk(t),PD=!0}return qg=e(),qg}var Hhe=class{async load(e,t,r=()=>{}){let{load:i}=await TD;i(e,(n,s)=>{n||!s?r(n??"Something went wrong"):t(s)})}async parse(e){let{parse:t,Bidi:r}=await TD;try{let i=t(e),n=new r,s=a=>i.charToGlyphIndex(a.char);return n.registerModifier("glyphIndex",null,s),n.applyFeatures(i,i.defaultRenderOptions.features),{font:i,bidi:n}}catch(i){console.error(i)}}};async function Ghe(e){return await(await fetch(e)).arrayBuffer()}var Whe=new Hhe;async function DD(e){let t,r,i=!1;if(e.url?(t=await Ghe(e.url),r=e.url,i=e.url.startsWith("/")):e.data&&(t=e.data.buffer.slice(e.data.byteOffset,e.data.byteOffset+e.data.byteLength)),t){let n=await Whe.parse(t);if(n)return{font:n.font,url:r,intercepted:i,arr:t,bidi:n.bidi}}}function qhe(e,t){return t.state.glyphIndex===e||t.state.fina===e||t.state.medi===e||t.state.init===e}var Xhe=class{constructor(e){this._arrayBuffer=new ArrayBuffer(1),this._isLoaded=!1,this._intercepted=!1,this._isUserFont=e.isUserFont??!1,this._loadingPromise=DD(e).then(t=>{t&&(this._arrayBuffer=t.arr,this._url=t.url,this.font=t.font,this._intercepted=t.intercepted,this._isLoaded=!0,this._bidi=t.bidi)})}update(e){this._isLoaded=!1,this._isUserFont=e.isUserFont??!1,this._loadingPromise=DD(e).then(t=>{t&&(this._arrayBuffer=t.arr,this._url=t.url,this.font=t.font,this._intercepted=t.intercepted,this._isLoaded=!0,this._bidi=t.bidi)})}get url(){return this._url}get intercepted(){return this._intercepted}get isLoaded(){return this._isLoaded}get loadingPromise(){return this._loadingPromise}reverseLigaturesTable(e,t,r){if(!this._bidi)return[];let i=this._bidi;i.getTextGlyphs(t);let n=i.tokenizer.tokens,s=[],a=0,o=r.length===n.length;for(let l=0;l<r.length;l++){let c=r[l].index,u=String.fromCharCode(r[l].unicode),h=n[a];if(qhe(c,h)||o)s.push({char:u,index:c,replacements:[h.state.glyphIndex],replacementChars:[h.char]}),a++;else{let d=h.char,p="",f=[h.state.glyphIndex],m=[],g=!1;for(;!g;)a++,p=t.charAt(a),d+=p,f.push(e.charToGlyphIndex(p)),m=e.stringToGlyphs(d),m.length===1&&m[0].index===c&&(g=!0),a>t.length&&(g=!0);s.push({char:u,index:c,replacements:f,replacementChars:Array.from(d)}),a++}}return s}generateShapes(e,t){if(!this._isLoaded)return;let r=this.font,i=t.fontSize/this.unitsPerEm,n=t.fontSize*t.lineHeight,s=e.map(v=>this.getTextWidth(v,t)),a=t.width,o=this.getCharWidth(`
`,t),l=t.horizontalAlign===1?o:0,c=this.computeSpaceWidthForLine(e,0,t),u=this.getLineInitialOffsetX(s[0],a,t.horizontalAlign,e[0],o),h=this.getLineInitialOffsetY(n,e.length,t.height,i,t.verticalAlign),d=[],p=e.map(v=>[]),f=e.map(v=>[]),m;for(let v=0;v<e.length;v++){let y=e[v],x={features:{liga:!0}},w=[];try{w=r.stringToGlyphs(y,x)}catch(_){console.warn(_)}u=this.getLineInitialOffsetX(s[v],a,t.horizontalAlign,y,o);let b=[];try{b=this.reverseLigaturesTable(r,y,w)}catch(_){console.warn(_)}c=this.computeSpaceWidthForLine(e,v,t);for(let _=0;_<w.length;_++){let A=w[_],S=A.index===0?`
`:A.unicode?String.fromCharCode(A.unicode):void 0,C=b[_],M=0,T=0;_===0&&t.horizontalAlign===2&&A.leftSideBearing!==void 0&&(T=-A.leftSideBearing*i),m&&(M=r.getKerningValue(A,m)*i),u+=T+M;let P=0;if(S===`
`)P=l;else if(S===" ")P=c;else{let D=this.createPath(A,i,u,h,t);D&&(P=D.offsetX-(M+T),d.push(D.path))}if(C.replacements.length===1)f[v].push([u,h]),p[v].push(P);else{let D=C.replacements.map(H=>(r.glyphs.get(H).advanceWidth??0)*i),I=D.reduce((H,R)=>H+=R,0),B=D.map(H=>H/I),X=u;for(let H=0;H<B.length;H++){let R=P*B[H];f[v].push([X,h]),p[v].push(R),X+=R}}u+=P,m=A}h-=n}let g=[];for(let v=0,y=d.length;v<y;v++)g.push(...d[v].toShapes());return{shapes:g,charWidths:p,lineWidths:s,charCoords:f}}get isUserFont(){return this._isUserFont}get arrayBuffer(){return this._arrayBuffer}get ascender(){var e;return((e=this.font)==null?void 0:e.ascender)??0}get descender(){var e;return((e=this.font)==null?void 0:e.descender)??0}get familyName(){var e;return((e=this.font)==null?void 0:e.names.fontFamily)??""}get subfamilyName(){var e;return((e=this.font)==null?void 0:e.names.fontSubfamily)??""}get unitsPerEm(){var e;return((e=this.font)==null?void 0:e.unitsPerEm)??1}getLineInitialOffsetX(e,t,r,i,n){return(r===3||r===2)&&i.indexOf(`
`)>=0&&(e-=n),r===3?t*.5-e*.5:r===2?t-e:0}getLineInitialOffsetY(e,t,r,i,n){let s=t*e,a=Math.abs(this.ascender-this.descender)*i,o=e-a,l=-this.ascender*i-o/2;return n===3?-(r-s-l):n===2?-(r*.5-s*.5-l):l}createPath(e,t,r,i,n){var l;let s=e.getPath(r,-i,n.fontSize,{kerning:!1,letterSpacing:n.letterSpacing});if(!s){console.error('THREE.Font: character "'+e+'" does not exists in font family '+this.familyName+".");return}let a=new jhe,o=(e.advanceWidth??1)*t;if(e)for(let c of s.commands){let u=(l=a.currentPath)==null?void 0:l.currentPoint;if(!(u&&c.type!=="Z"&&u.x===c.x&&-u.y===c.y))switch(c.type){case"M":a.moveTo(c.x,-c.y);break;case"L":a.lineTo(c.x,-c.y);break;case"Q":a.quadraticCurveTo(c.x1,-c.y1,c.x,-c.y);break;case"C":a.bezierCurveTo(c.x1,-c.y1,c.x2,-c.y2,c.x,-c.y);break}}return a.subPaths.forEach(c=>{let u=Yhe(c.curves);u!==void 0&&c.currentPoint.distanceTo(u)>0&&c.lineTo(u.x,u.y)}),{offsetX:o+n.fontSize*n.letterSpacing,path:a}}getCharWidth(e,t){var r;return((r=this.font)==null?void 0:r.getAdvanceWidth(e,t.fontSize,{kerning:!0,letterSpacing:t.letterSpacing}))??0}getTextWidth(e,t){var r;return((r=this.font)==null?void 0:r.getAdvanceWidth(e,t.fontSize,{kerning:!0,letterSpacing:t.letterSpacing}))??0}computeSpaceWidthForLine(e,t,r){let i=this.getCharWidth(" ",r),n=e[t];if(n){let s=this.countSpaces(n.trimEnd());if(r.horizontalAlign===4&&t<e.length-1&&s){let a=r.width,o=this.getTextWidth(n,r);return(a-(o-s*i))/s}}return i}countSpaces(e){return(e.match(/ /g)||[]).length}};function Yhe(e){if(e.length){let t=e[0];if(t instanceof Ts)return t.v1;if(t instanceof bs||t instanceof Sl)return t.v0}}var Qhe=class{constructor(){this.objects=new Map,this.unreachable=new Set}getCached(e){return this.objects.get(e)}get size(){return this.objects.size}get(e,t){let r=this.objects.get(e);return r===void 0?(r=this.createObject(e,t),this.objects.set(e,r)):r.isShared=!0,r}mutateIfUnique(e,t){let r=this.objects.get(e);if(r&&r.isShared!==!0)return this.objects.delete(e),this.objects.set(t,r),r}startGc(){this.unreachable=new Set(this.objects.keys())}markAsReachable(e,t){let r=this.objects.get(e);t===r&&this.unreachable.delete(e)}endGc(){this.unreachable.forEach(e=>{this.disposeObject(this.objects.get(e)),this.objects.delete(e)}),this.unreachable.clear()}dispose(){this.objects.forEach(e=>{this.disposeObject(e)}),this.objects.clear()}},LD=class extends Qhe{constructor(e){super(),this.flatShading=e}disposeObject(e){e.dispose()}createObject(e,t){let r=ry(e,t,this.flatShading);return r.computeBoundingSphere(),r}},Khe={markNeedsUpdateRendererDirty:()=>{}},Zhe=class extends xhe{constructor(e){super(),this.shared=e}create(e){return new mk(e,this.shared)}},PA=class{constructor(e,t={}){if(this.data=e,this.geometryCache=new LD(!0),this.geometryCache2=new LD(!1),this.imageHolderCache=new Zhe(this),this.thisContext={scene:Khe,shared:this},this.deletedMaterial=new A_(wi.defaultTwoLayerData("phong"),this.thisContext),this.deletedImage=new pc(K0.emptyImage,this),this.deletedVideo=new pc(H0.defaultVideo,this),this.materials={},this.images={},this.videos={},this.colors={},this.audios={},this.fonts={},this.requestRender=()=>{this._requestRender&&this._requestRender()},t.images)for(let[r,i]of Object.entries(t.images))this.addImage(r,i);if(t.videos)for(let[r,i]of Object.entries(t.videos))this.addVideo(r,i);if(t.audios)for(let[r,i]of Object.entries(t.audios))this.addAudio(r,i);this.reset(e)}setRequestRender(e){this._requestRender=e}reset(e){this.resetLib(e.lib);for(let[t,r]of Object.entries(e.images))this.addImage(t,r);for(let[t,r]of Object.entries(e.videos))this.addVideo(t,r);for(let[t,r]of Object.entries(e.colors))this.addColor(t,r);for(let[t,r]of Object.entries(e.materials))this.addMaterial(t,r);for(let[t,r]of Object.entries(e.audios))this.addAudio(t,r);for(let[t,r]of Object.entries(e.fonts))this.addFont(t,r)}addMaterial(e,t){if(this.materials[e]){let r=this.materials[e];r.reset(t,this.thisContext),r.dispose()}else{let r=new A_(t,this.thisContext);r.uuid=e,this.materials[e]=r}}deleteMaterial(e){this.materials[e]&&(this.materials[e].nodeMaterialDispose(),delete this.materials[e])}getMaterial(e){return this.materials[e]}getMaterialOrDeletedPlaceholder(e){return this.materials[e]??this.deletedMaterial}material(e){return typeof e=="string"?this.getMaterialOrDeletedPlaceholder(e):e==null?(console.error("material is undefined or null"),this.deletedMaterial):new TA(e,this.thisContext)}getMaterials(){return this.materials}addImage(e,t){return this.images[e]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),this.images[e].updateSrc(t.data),!0):(this.images[e]=new pc(t,this),!1)}deleteImage(e){let t=this.images[e];t&&(t.dispose(),delete this.images[e])}getDefaultImage(){return this.images.image_0}getImage(e){return this.images[e]??this.deletedImage}image(e){return typeof e=="string"?this.getImage(e):this.imageHolderCache.load(e)}addVideo(e,t){return this.videos[e]?(this.videos[e].updateSrc(t.data),!0):(this.videos[e]=new pc(t,this),!1)}deleteVideo(e){let t=this.videos[e];t&&(t.dispose(),delete this.videos[e])}getVideo(e){return this.videos[e]??this.deletedVideo}video(e){return typeof e=="string"?this.getVideo(e):this.imageHolderCache.load(e)}addColor(e,t){return this.colors[e]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),"a"in t?this.colors[e].setRGBA(t.r,t.g,t.b,t.a):this.colors[e].setRGBA(t.r,t.g,t.b,1),!0):("a"in t?this.colors[e]=new iy(t.r,t.g,t.b,t.a):this.colors[e]=new iy(t.r,t.g,t.b,1),!1)}updateColor(e,t){if(this.colors[e]){this.onColorOrImageUpdate&&this.onColorOrImageUpdate();let r=this.colors[e];return this.colors[e].r=t.r??r.r,this.colors[e].g=t.g??r.g,this.colors[e].b=t.b??r.b,this.colors[e].a=t.a??r.a,!0}return!1}deleteColor(e){this.colors[e]&&delete this.colors[e]}getColor(e){return this.colors[e]}color(e){let t;if(typeof e=="string"){let r=this.getColor(e);r?t=r:(console.warn("Tried to create color layer params with a color key that does not exist in the assets manager"),t=new nn(0,0,0,0))}else return"a"in e?new nn(e.r,e.g,e.b,e.a):new nn(e.r,e.g,e.b,1);return t}addAudio(e,t){this.audios[e]=t}getAudio(e){let t=this.audios[e];if(t instanceof Op)return t;{let r=new Op({src:t.data});return this.audios[e]=r,r}}deleteAudio(e){let t=this.audios[e];t&&(t instanceof Op&&t.dispose(),delete this.audios[e])}addFont(e,t){this.fonts[e]=new Xhe(t),this.fonts[e].loadingPromise.then(()=>this.requestRender())}getFont(e){return this.fonts[e]}deleteFont(e){this.fonts[e]&&delete this.fonts[e]}dispose(){Object.keys(this.materials).forEach(e=>this.deleteMaterial(e)),this._requestRender=void 0,Object.values(this.audios).forEach(e=>{e instanceof Op&&e.dispose()}),this.audios={},this.geometryCache.dispose(),this.geometryCache2.dispose()}resetLib(e){for(let[t,r]of Object.entries(e.images))this.addImage(t,r.asset);for(let[t,r]of Object.entries(e.audios))this.addAudio(t,r.asset);for(let[t,r]of Object.entries(e.colors))this.addColor(t,r.asset);for(let[t,r]of Object.entries(e.fonts))this.addFont(t,r.asset);for(let[t,r]of Object.entries(e.materials))this.addMaterial(t,r.asset);for(let[t,r]of Object.entries(e.videos))this.addVideo(t,r.asset)}updateLibByOp(e,t){e.path[0]==="images"?e.path.length===1&&e.type===1?this.addImage(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteImage(e.id):e.path[0]==="videos"?e.path.length===1&&e.type===1?this.addVideo(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteVideo(e.id):e.path[0]==="audios"?e.path.length===1&&e.type===1?this.addAudio(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteAudio(e.id):e.path[0]==="colors"?e.path.length===1&&e.type===1?this.addColor(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteColor(e.id):e.path[0]==="materials"?e.path.length===1&&e.type===1?this.addMaterial(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteMaterial(e.id):e.path[0]==="fonts"?e.path.length===1&&e.type===1?this.addFont(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteFont(e.id):e.path[0]==="components"&&t.updateByLibOp(e,this)}updateByOp(e,t,r){this.data=t,e.path[0]==="images"?e.path.length===2&&e.type===0?e.props.data&&this.getImage(e.path[1]).updateSrc(e.props.data):e.path.length===1&&e.type===1?this.addImage(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteImage(e.id):e.path[0]==="videos"?e.path.length===2&&e.type===0?e.props.data&&this.getVideo(e.path[1]).updateSrc(e.props.data):e.path.length===1&&e.type===1?this.addVideo(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteVideo(e.id):e.path[0]==="audios"?e.path.length===2&&e.type===0?e.props.data&&this.addAudio(e.path[1],t.audios[e.path[1]]):e.path.length===1&&e.type===1?this.addAudio(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteAudio(e.id):e.path[0]==="colors"?e.path.length===2&&e.type===0?this.updateColor(e.path[1],e.props):e.path.length===1&&e.type===1?this.addColor(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteColor(e.id):e.path[0]==="materials"?e.path.length===1&&e.type===1?this.addMaterial(e.id,e.data):e.path.length===1&&e.type===2?this.deleteMaterial(e.id):e.path.length>1&&this.getMaterial(e.path[1]).updateByOp(Ri.drop(e,2),t.materials[e.path[1]],{shared:this,scene:r}):e.path[0]==="fonts"?e.path.length===2&&e.type===0?this.updateFont(e.path[1],e,r):e.path.length===1&&e.type===1?this.addFont(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteFont(e.id):e.path[0]==="lib"&&this.updateLibByOp(Ri.drop(e,1),r)}updateFont(e,t,r){if(t.props.url){let i=this.getFont(e),n={...this.data.fonts[e],url:t.props.url};i.update(n),i.loadingPromise.then(()=>this.requestRender()),r.updateFont(e,this)}}};new PA(Ga.emptyData());var Cd=class extends an{updateByPatchedOp(e,t,r){if(super.updateByPatchedOp(e,t,r),Oae(e.path,["materials"])!==null&&e.type===0&&Array.isArray(this.material))for(let[i,n]of Object.entries(e.props)){let s=r.shared.material(n);this.material[Number(i)]=s}else if(qn(e.path,["material"])&&this.material instanceof Cl)"material"in t&&typeof t.material!="string"&&this.material.updateByOp(Ri.drop(e,1),t.material,r);else if(qn(e.path,["materials","*"])&&Array.isArray(this.material)){let i=e.path[1];if("materials"in t&&i<this.material.length){let n=t.materials[i];typeof n!="string"&&this.material[i].updateByOp(Ri.drop(e,2),n,r)}}}get needsAO(){return this.material!==void 0?(Array.isArray(this.material)?this.material[0]:this.material).hasAO:!1}updateState(e,t){var i,n;super.updateState(e,t),e.castShadow!==void 0&&(this.castShadow=e.castShadow),e.receiveShadow!==void 0&&(this.receiveShadow=e.receiveShadow);let r=this.dataPatched;if(((i=e.geometry)==null?void 0:i.type)!=="NonParametricGeometry"&&"material"in e&&e.material!==void 0&&(this.disposeMaterial(),this.material=t.shared.material(e.material).getFlavor(r.flatShading,r.side,r.wireframe),t.scene.markNeedsUpdateRendererDirty()),((n=e.geometry)==null?void 0:n.type)==="NonParametricGeometry"&&("materials"in e&&e.materials!==void 0?(this.disposeMaterial(),this.material=e.materials.map(s=>t.shared.material(s).getFlavor(r.flatShading,r.side,r.wireframe)),t.scene.markNeedsUpdateRendererDirty()):"material"in e&&e.material!==void 0&&(this.disposeMaterial(),this.material=[t.shared.material(e.material).getFlavor(r.flatShading,r.side,r.wireframe)],t.scene.markNeedsUpdateRendererDirty())),e.flatShading!==void 0||e.wireframe!==void 0||e.side!==void 0)if(Array.isArray(this.material))for(let s=0;s<this.material.length;s++)this.material[s]=this.material[s].getFlavor(r.flatShading,r.side,r.wireframe);else this.material=this.material.getFlavor(r.flatShading,r.side,r.wireframe)}disposeMaterial(){this.material&&TB(this.material).forEach(e=>{e instanceof Cl&&(e instanceof A_||e.nodeMaterialDispose())})}dispose(){this.disposeMaterial(),super.dispose()}},ID=new E,OD=new dt,RD=new dt,$he=new E,BD=new _e,zi=class extends Cd{constructor(e,t,r){super(e,t),this.data=t,this.localGeometry=void 0,t.bindMode&&t.bindMatrix&&(this.isSkinnedMesh=!0,this.bindMode=t.bindMode,this.bindMatrix=new _e().fromArray(t.bindMatrix),this.bindMatrixInverse=new _e)}chooseGeoemtryCache(e){return e.geometryCache}markGeometryAsReachable(e){this.geometryCreateDeleyed instanceof it&&this.chooseGeoemtryCache(e).markAsReachable(this.dataPatched.geometry,this.geometryCreateDeleyed)}get geometry(){if(this.localGeometry!==void 0)return this.localGeometry;if(this.geometryCreateDeleyed instanceof PA){let e=this.geometryCreateDeleyed,t=this.chooseGeoemtryCache(e);this.geometryCreateDeleyed=t.get(this.dataPatched.geometry,e)}return this.geometryCreateDeleyed}set geometry(e){this.localGeometry=e}get is2DAndNoDepth(){let e=this.dataPatched.geometry;return q0.is2DParametricMesh(e.type)&&e.depth===0}get is2DType(){return q0.is2DParametricMesh(this.geometry.userData.type)}get isNonParametric(){return this.geometry.userData.type==="NonParametricGeometry"}updateByPatchedOp(e,t,r){super.updateByPatchedOp(e,t,r),qn(e.path,["geometry"])&&this.updateByPatchedOpGeometry(Ri.drop(e,1),t.geometry,r)}removeInteractionGeometry(){var e;(e=this.localGeometry)==null||e.dispose(),this.localGeometry=void 0}updateGeometryInteractions(e,t){var i;this.invalidateDownstreamBooleanData();let r=this.data.geometry.type;if(r==="NonParametricGeometry"||r==="SubdivGeometry"){let n=e;if(this.localGeometry===void 0){let c={...this.data.geometry,...n};this.localGeometry=ry(c,t,this.data.flatShading)}let s,a,o;n.scaleBaked?[s,a,o]=n.scaleBaked:{width:s,height:a,depth:o}=n;let l=this.localGeometry.userData;l.sxPrev!==void 0&&x_(this.localGeometry.attributes,s/l.sxPrev,a/l.syPrev,o/l.szPrev),l.sxPrev=s,l.syPrev=a,l.szPrev=o}else{let n={...this.data.geometry,...e};(i=this.localGeometry)==null||i.dispose(),this.localGeometry=ry(n,t,this.data.flatShading)}}refreshAttachedCloners(e){for(let t of this.attachedSurfaceCloners)e.scene.addPendingUpdateCloner(t.object)}refreshAttachedPaths(e){for(let t of this.attachedPaths)e.scene.addPendingCommand(()=>t.updateShape())}createGeometryDelayed(e){this.geometryCreateDeleyed=e.shared,this.refreshAttachedCloners(e),this.refreshAttachedPaths(e)}updateByPatchedOpGeometry(e,t,r){var n;let i=!1;e.type===0&&e.path.length===0&&rA(["scaleBaked"],Object.keys(e.props))&&this.geometryCreateDeleyed instanceof Ii&&this.chooseGeoemtryCache(r.shared).mutateIfUnique(this.geometryCreateDeleyed.data,t)===this.geometryCreateDeleyed&&(i=!0,this.geometryCreateDeleyed.mutateDirectlyScaleBaked(t,e.props.scaleBaked),this.refreshAttachedCloners(r),this.refreshAttachedPaths(r)),i||((n=r.scene)==null||n.markGeometryCacheDirty(),this.createGeometryDelayed(r)),this.resetBBoxNeedsUpdate(),this.invalidateDownstreamBooleanData()}updateGeometryOnStateUpdate(e,t){this.createGeometryDelayed(t)}updateState(e,t){e.geometry!==void 0&&this.updateGeometryOnStateUpdate(e.geometry,t),super.updateState(e,t)}updateGeometryGroupsIfNeeded(){var e;Array.isArray(this.material)&&this.geometry.groups.length===0&&this.geometry.addGroup(0,Math.max(((e=this.geometry.getIndex())==null?void 0:e.count)??0,this.geometry.getAttribute("position").count),0)}updateEntityBoxSize(e,t){let r=this.geometry.userData.parameters;this.is2DType?e.set(0,0,r.depth*.5):this.isNonParametric?(e.setScalar(0),this.geometry.boundingSphere&&e.copy(this.geometry.boundingSphere.center),t.set(r.width,r.height,r.depth??0).multiplyScalar(.5)):e.setScalar(0),t.set(r.width,r.height,r.depth??0).multiplyScalar(.5)}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"&&this.bindMatrixInverse.copy(this.bindMatrix).invert()}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(e){let t=new dt,r=this.geometry.attributes.skinWeight;for(let i=0,n=r.count;i<n;i++){t.fromBufferAttribute(r,i);let s=1/t.manhattanLength();s!==1/0?t.multiplyScalar(s):t.set(1,0,0,0),r.setXYZW(i,t.x,t.y,t.z,t.w)}}boneTransform(e,t){let r=this.skeleton;if(r===void 0)return;let i=this.geometry;OD.fromBufferAttribute(i.attributes.skinIndex,e),RD.fromBufferAttribute(i.attributes.skinWeight,e),ID.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let n=0;n<4;n++){let s=RD.getComponent(n);if(s!==0){let a=OD.getComponent(n);BD.multiplyMatrices(r.bones[a].matrixWorld,r.boneInverses[a]),t.addScaledVector($he.copy(ID).applyMatrix4(BD),s)}}return t.applyMatrix4(this.bindMatrixInverse)}};function Jhe(e){var a,o;if(e.geometry.attributes.extrudeNormal||!e.geometry.attributes.position||!e.geometry.attributes.normal)return;let t=new Map,r=e.geometry.attributes,i=r.position.array,n=r.normal.array,s=new Float32Array(i.length);for(let l=0;l<i.length;l+=3){let c=`${i[l]}_${i[l+1]}_${i[l+2]}`,u=new E(n[l],n[l+1],n[l+2]);t.has(c)?(a=t.get(c))==null||a.normals.push(u):t.set(c,{normals:[u],result:new E})}t.forEach((l,c)=>{for(let u of l.normals)l.result.add(u);l.result.divideScalar(l.normals.length)});for(let l=0;l<i.length;l+=3){let c=`${i[l]}_${i[l+1]}_${i[l+2]}`,u=(o=t.get(c))==null?void 0:o.result;u&&(s[l]=u.x,s[l+1]=u.y,s[l+2]=u.z)}e.geometry.setAttribute("extrudeNormal",new Ne(s,3))}function eue(e){if(e.geometry.attributes.extrudeNormals||!e.geometry.attributes.position)return;let t=e.geometry.attributes.position.array,r=new Float32Array(t.length),i=new E;for(let n=0;n<t.length;n+=3)i.set(t[n],t[n+1],t[n+2]).normalize(),r[n]=i.x,r[n+1]=i.y,r[n+2]=i.z;e.geometry.setAttribute("extrudeNormal",new Ne(r,3))}function DA(e){if(Array.isArray(e.material)){for(let t of e.material)if(t.getLayersOfType("outline").length===0)return}else if(!(e.material instanceof Cl)||e.material.getLayersOfType("outline").length===0)return;e instanceof zi&&e.is2DAndNoDepth?eue(e):Jhe(e)}function LA(e){if(!e.geometry.attributes.position)return;let t=e.geometry.attributes.position.array,r=new Float32Array(t.length),i=parseInt(e.uuid.replace(/\D/g,"")),n=[mt.seededRandom(i),mt.seededRandom(i+1e4),mt.seededRandom(i+2e4)];for(let s=0;s<t.length;s++)r[s]=n[s%3];e.geometry.setAttribute("randomColor",new nt(r,3))}_A.then(e=>{});var js=new Ar,lp=new E;function tue(e){let t=!1;return e.scene.objects.traverse((r,i)=>{i.type==="Mesh"&&i.geometry.type==="SubdivGeometry"&&(t=!0)}),t}var Kf=class extends zi{constructor(e,t,r){super(e,t,r),this.data=t,this.hiddenMatrixOld=new _e,this.smoothShading=!0,this.skipReactionUpdate=!1}chooseGeoemtryCache(e){return this.dataPatched.flatShading?e.geometryCache:e.geometryCache2}get subdivPointerNew(){return this.localGeometry!==void 0?this.subdivPointer:this.geometry.ensureSubdivPointer()}get originalGeometryNew(){return this.localGeometry!==void 0?this.originalGeometry:this.geometry.originalGeometry}get phongAngle(){return this.data.geometry.phongAngle??45}updateEntityBoxSize(e,t){let r=this.geometry.userData.parameters;e.copy(this.originalGeometryNew.boundingSphere.center),t.set(r.width,r.height,r.depth??0).multiplyScalar(.5)}createGeometryByControls(e){var s,a,o;if(this.skipReactionUpdate===!0)return;let t=(s=this.localGeometry)==null?void 0:s.uuid,{originalGeometry:r,subdividedGeometry:i,subdivPointer:n}=Ii.build(e,this.subdivPointer,this.smoothShading,this.hasNonUniformScale?this.shearScale:void 0);this.subdivPointer=n,r!==void 0&&((a=this.originalGeometry)==null||a.dispose(),this.originalGeometry=r),i!==void 0&&((o=this.subdividedGeometry)==null||o.dispose(),this.subdividedGeometry=i??void 0),this.localGeometry=this.subdividedGeometry??this.originalGeometry,DA(this),LA(this),this.calcBoundingBox(),t&&(this.localGeometry.uuid=t)}updateState(e,t){if(super.updateState(e,t),e.flatShading!==void 0){let r=this.material;this.material=r.getFlavor(!1,r.side,r.wireframe),this.smoothShading=!e.flatShading,this.createGeometryDelayed(t)}}updateMesh(e=!1){Ii.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1,this.originalGeometry,e&&this.hasNonUniformScale?this.shearScaleInv:void 0),this.subdividedGeometry&&Ii.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1,this.subdividedGeometry,e&&this.hasNonUniformScale?this.shearScaleInv:void 0)}updateTopology(){this.originalGeometry.dispose(),this.originalGeometry=Ii.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1),this.subdividedGeometry&&(this.subdividedGeometry.dispose(),this.subdividedGeometry=Ii.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1)),this.localGeometry=this.subdividedGeometry??this.originalGeometry}raycast(e,t){let r=this.localGeometry;this.localGeometry=this.originalGeometryNew,an.prototype.raycast.call(this,e,t),this.localGeometry=r}activateSVDCompensation(){!this.hasNonUniformScale||(this.matrix.copy(this.matrixWorldRigid),this.hiddenMatrixOld.copy(this.hiddenMatrix),this.hiddenMatrix.copy(this.parent.matrixWorld).invert())}deactivateSVDCompensation(){!this.hasNonUniformScale||(this.updateMatrix(),this.hasNonUniformScale=void 0,this.hiddenMatrix.copy(this.hiddenMatrixOld))}calcBoundingBox(){let e=this.originalGeometry;e.boundingSphere===null&&(e.boundingSphere=new Mn,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=e.boundingSphere));let t=e.attributes.position,r=e.boundingSphere.center;js.setFromBufferAttribute(t),js.getCenter(r),e.boundingSphere.radius=r.distanceTo(js.max),isNaN(e.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),js.getSize(lp),this.hasNonUniformScale&&lp.divide(this.scale);let i={width:lp.x,height:lp.y,depth:lp.z};return this.geometry.userData.parameters=i,i}updateBoundingSphere(e){let t=this.originalGeometry;js.min.set(e[0],e[2],e[4]),js.max.set(e[1],e[3],e[5]),this.hasNonUniformScale&&(js.min.applyMatrix4(this.shearScaleInv),js.max.applyMatrix4(this.shearScaleInv)),t.boundingSphere===null&&(t.boundingSphere=new Mn);let r=t.boundingSphere.center;js.getCenter(r),t.boundingSphere.radius=r.distanceTo(js.max)}freeSubdivPointer(){var e,t;this.subdivPointer&&(Ii.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0),this.localGeometry=void 0,(e=this.originalGeometry)==null||e.dispose(),(t=this.subdividedGeometry)==null||t.dispose()}dispose(){super.dispose(),this.freeSubdivPointer()}updateByPatchedOpGeometry(e,t,r){super.updateByPatchedOpGeometry(e,t,r),this.localGeometry&&this.createGeometryByControls(t)}},zD=-1,rue=1,iue={x:[1,0,0],"-x":[-1,0,0],y:[0,1,0],"-y":[0,-1,0],z:[0,0,1],"-z":[0,0,-1]},nue={polygon_center:0,edge:1,vertex:2},Xg=(e,t)=>(r,i)=>!t||r===0||e===0?0:e*i/100,ht=(e,t)=>{let r=Math.abs(t),i=r*-1;return(e-zD)*(r-i)/(rue-zD)+i};function sue(e){let t=[],r={};for(var i=0,n=e.length;i<n;i++){var s=JSON.stringify(e[i].pos.map(a=>Math.round(a*1e4)/1e4));r[s]||(t.push(e[i]),r[s]=!0)}return t}var aue=new E,Yg=new E,oue=new E,lue=new E;function Tu(e,t){let r=oue.fromArray(e),i=lue.fromArray(t);Yg.copy(i).sub(r);let n=Yg.length();return Yg.normalize().multiplyScalar(n*.5),aue.copy(r).add(Yg).toArray()}var Gn=new yi,Qg=new E,sy=new E,nc=new E;function cue(e){let t=[];for(let r=0;r<=e.index.count;r++)if(Qg.fromArray(e.index.array,r*3),Gn.setFromAttributeAndIndices(e.attributes.position,Qg.x,Qg.y,Qg.z),Gn.getNormal(sy),Gn.getMidpoint(nc),!(isNaN(nc.x)||isNaN(nc.y)||isNaN(nc.z))){let{a:i,b:n,c:s}=Gn,a=i.toArray(),o=n.toArray(),l=s.toArray(),c=i.distanceTo(n),u=n.distanceTo(s),h=s.distanceTo(i),d=Tu(a,o),p=Tu(o,l),f=Tu(l,a),m=[c,u,h],g=Math.max(...m),v=m.filter(w=>Math.round(w)===Math.round(g)).length>1,y=[],x=Gn.getMidpoint(nc).toArray();g===c&&!v&&(y=[p,f,f],x=d),g===u&&!v&&(y=[d,f,f],x=p),g===h&&!v&&(y=[d,p,p],x=f),v&&(y=[d,p,f]),t.push({vertices:[a,o,l],faceCenters:y,midpoint:x,norm:Gn.getNormal(sy).toArray()})}return t}function hue(e){let t=[],{position:r}=e.attributes;for(let i=0;i<r.count;i++){Gn.setFromAttributeAndIndices(r,i*3,i*3+1,i*3+2),Gn.getNormal(sy),Gn.getMidpoint(nc);let n=Gn.a.toArray(),s=Gn.b.toArray(),a=Gn.c.toArray();t.push({vertices:[n,s,a],faceCenters:[Tu(n,s),Tu(s,a),Tu(a,n)],midpoint:nc.toArray(),norm:sy.toArray()})}return t}var uue=4,due=.5,vw=e=>.5*(1-Math.cos(e*Math.PI)),pue=class{constructor(){this.perlin=new Array(4095+1)}noise(e,t=0,r=0){if(this.perlin==null){this.perlin=new Array(4095+1);for(let g=0;g<4095+1;g++)this.perlin[g]=Math.random()}e<0&&(e=-e),t<0&&(t=-t),r<0&&(r=-r);let i=Math.floor(e),n=Math.floor(t),s=Math.floor(r),a=e-i,o=t-n,l=r-s,c,u,h=0,d=.5,p,f,m;for(let g=0;g<uue;g++){let v=i+(n<<4)+(s<<8);c=vw(a),u=vw(o),p=this.perlin[v&4095],p+=c*(this.perlin[v+1&4095]-p),f=this.perlin[v+16&4095],f+=c*(this.perlin[v+16+1&4095]-f),p+=u*(f-p),v+=256,f=this.perlin[v&4095],f+=c*(this.perlin[v+1&4095]-f),m=this.perlin[v+16&4095],m+=c*(this.perlin[v+16+1&4095]-m),f+=u*(m-f),p+=vw(l)*(f-p),h+=p*d,d*=due,i<<=1,a*=2,n<<=1,o*=2,s<<=1,l*=2,a>=1&&(i++,a--),o>=1&&(n++,o--),l>=1&&(s++,l--)}return h}noiseSeed(e){let t=(()=>{let r,i;return{setSeed(n){i=r=(n??Math.random()*4294967296)>>>0},getSeed(){return r},rand(){return i=(1664525*i+1013904223)%4294967296,i/4294967296}}})();t.setSeed(e),this.perlin=new Array(4095+1);for(let r=0;r<4095+1;r++)this.perlin[r]=t.rand()}},fue=pue,kD=new E,ND=new _e,FD=new hd;function UD(e){let t=!1;return e.scene.objects.traverse((r,i)=>{i.type==="Mesh"&&i.geometry.type==="TextGeometry"&&(t=!0)}),t}var _k=class extends zi{constructor(e,t,r){super(e,t,r),this.data=t}get textGeometry(){return this.geometry}get charWidths(){return this.textGeometry.charWidths}get charCoords(){return this.textGeometry.charCoords}get wrappedText(){return this.textGeometry.wrappedText}get font(){return this.textGeometry.font}get initialOffsetY(){var t;let e=this.dataPatched;return((t=this.font)==null?void 0:t.getLineInitialOffsetY(this.lineHeight,this.wrappedText.length,e.geometry.height,this.fontScale,e.geometry.verticalAlign))??0}get fontScale(){let e=this.dataPatched;return this.font?e.geometry.fontSize/this.font.unitsPerEm:1}get AD(){return Math.abs(this.ascender-this.descender)}get ascender(){var e;return(((e=this.font)==null?void 0:e.ascender)??1)*this.fontScale}get descender(){var e;return(((e=this.font)==null?void 0:e.descender)??1)*this.fontScale}get lineHeight(){let e=this.dataPatched;return e.geometry.fontSize*e.geometry.lineHeight}raycast(e,t){let{matrixWorld:r}=this;if(!(isNaN(e.ray.origin.x)||this.scale.x===0||this.scale.y===0||this.scale.z===0)&&(ND.copy(r).invert(),FD.copy(e.ray).applyMatrix4(ND),FD.intersectBox(this.singleBBox,kD))){let i=kD.applyMatrix4(r),n=e.ray.origin.distanceTo(i);t.push({distance:n,point:i.clone(),object:this})}}},Mi=1e-4,Vs,Sk,Ak,Ck,jD=new E,VD=new E;_A.then(e=>{Vs=e,Sk=[Vs.get_face_center,Vs.get_edge_midpoint,Vs.get_vertex_position],Ak=[Vs.get_face_normal,Vs.get_edge_normal,Vs.get_vertex_normal],Ck=[Vs.face_count,Vs.edge_count,Vs.vertex_count]});var mue=new _e,gue=new _e,Eo=new E,Hl=new E,cp=new E,yw=new E,vue=new E,yue=new E,Da=new fue,As=class extends fA(Vt){constructor(e,t){super(),this.parameters=t,this.objectForSample=void 0,this._pendingMediaLoad=!1,this.object=e}resetOnMove(){this.removeFromParent(),this.parent=null}expandClones(e){if(this.parent===null)this.updateState(this.parameters,e);else for(let t of this.children)t instanceof xi&&t.expand()}invalidateTransform(e){this.matrixWorldNeedsUpdate=!0,this.traverse(t=>{t instanceof xi&&t.object===e&&(t.matrixWorldNeedsUpdate=!0)})}onObjUpdateMatrix(){this.parameters.type!=="toObject"&&(this.matrixWorldNeedsUpdate=!0)}update(){switch(this._updateCount(),this.parameters.type){case"radial":this._updateRadial(this.parameters);break;case"linear":this._updateLinear(this.parameters);break;case"grid":this._updateGrid(this.parameters);break;case"toObject":this._updateToObject(this.parameters)}for(let e of this.children)e.updateMatrix(),e.hasNonUniformScale&&(e.updateMatrixWorld(),e.updateMatrixWorldSVD())}_updateCount(e){let t;if(e!==void 0?t=e:t=this.parameters.type==="grid"?Math.round(this.parameters.grid.count[0])*Math.round(this.parameters.grid.count[1])*Math.round(this.parameters.grid.count[2]):this.parameters.count,this.parameters.type==="toObject"&&!this.parameters.toObject.object&&(t=0),this.parameters.type==="toObject"&&this.objectForSample){for(let i=0,n=this.children.length;i<n;++i)this.remove(this.children[0]);let r=this.children;if(r.length===t)return;if(r.length<t)for(let i=0,n=t-r.length;i<n;++i){let s=new xi(this.object);s.expand(),this.add(s)}else for(let i=0,n=r.length-t;i<n;++i)this.remove(r[i])}else{if(this.children.length===t)return;if(this.children.length<t)for(let r=0,i=t-this.children.length;r<i;++r){let n=new xi(this.object);n.expand(),this.add(n)}else for(let r=0,i=this.children.length-t;r<i;++r)this.remove(this.children[0])}}_updateRadial(e){let t=e.radial,r=t.start*mt.DEG2RAD,i=t.end*mt.DEG2RAD,n=r-i,s=new Zr(t.rotation[0],t.rotation[1],t.rotation[2]),a;switch(t.axis){case"z":a=new E(0,0,1);break;case"y":a=new E(0,1,0);break;default:case"x":a=new E(1,0,0);break}let o=e.randomnessObject??Zo.defaultData([1,1,1]).randomnessObject,l=o.noiseType==="perlin";Da.noiseSeed(o.seed);let c=tw((0,rp.default)(o.seed)),u=Xg(o.strength,this.parameters.randomness);for(let[h,d]of this.children.entries()){let p=h*(o.freqScale/10)+o.movement,f=l?Da.noise(p):c(p,p),m=h+1;d.scale.x=t.scale[0]+u(m,ht(f,o.scale[0]))||Mi,d.scale.y=t.scale[1]+u(m,ht(f,o.scale[1]))||Mi,d.scale.z=t.scale[2]+u(m,ht(f,o.scale[2]))||Mi,d.position.setScalar(0);let g=n/e.count*h-r;switch(t.axis){case"x":d.rotation.set(0,g,0);break;case"y":d.rotation.set(0,0,g);break;case"z":d.rotation.set(g,0,0);break}d.translateOnAxis(a,t.radius),d.position.x+=t.position[0]+u(m,ht(f,o.position[0])),d.position.y+=t.position[1]+u(m,ht(f,o.position[1])),d.position.z+=t.position[2]+u(m,ht(f,o.position[2]));let v=u(m,ht(f,o.rotation[0])),y=u(m,ht(f,o.rotation[1])),x=u(m,ht(f,o.rotation[2]));t.alignment===!0?(d.rotation.x+=s.x+v,d.rotation.y+=s.y+y,d.rotation.z+=s.z+x):d.rotation.set(s.x+v,s.y+y,s.z+x)}}_updateLinear(e){if(e.type!=="linear")throw new Error;let t=e.linear,r=new Zr(t.rotation[0],t.rotation[1],t.rotation[2]),i=e.randomnessObject??Zo.defaultData([1,1,1]).randomnessObject,n=i.noiseType==="perlin";Da.noiseSeed(i.seed);let s=tw((0,rp.default)(i.seed)),a=Xg(i.strength,this.parameters.randomness);for(let[o,l]of this.children.entries()){let c=o*(i.freqScale/10)+i.movement,u=n?Da.noise(c):s(c,c),h=o+1,d=a(h,ht(u,i.rotation[0])),p=a(h,ht(u,i.rotation[1])),f=a(h,ht(u,i.rotation[2]));l.scale.x=1+(t.scale[0]-1)*o+a(h,ht(u,i.scale[0]))||Mi,l.scale.y=1+(t.scale[1]-1)*o+a(h,ht(u,i.scale[1]))||Mi,l.scale.z=1+(t.scale[2]-1)*o+a(h,ht(u,i.scale[2]))||Mi,l.rotation.x=r.x*o+d,l.rotation.y=r.y*o+p,l.rotation.z=r.z*o+f,l.position.x=t.position[0]*o+a(h,ht(u,i.position[0])),l.position.y=t.position[1]*o+a(h,ht(u,i.position[1])),l.position.z=t.position[2]*o+a(h,ht(u,i.position[2]))}}_updateGrid(e){let t=0,r=e.grid,i=e.randomnessObject??Zo.defaultData([1,1,1]).randomnessObject,n=Xg(i.strength,this.parameters.randomness),s=i.noiseType==="perlin";Da.noiseSeed(i.seed);let a=ale((0,rp.default)(i.seed));if(r.useCenter===!0){let o={x:r.count[0]%2===0?2:1,y:r.count[1]%2===0?2:1,z:r.count[2]%2===0?2:1},l=new E(r.size[0]*(r.count[0]-o.x)*.5,r.size[1]*(r.count[1]-o.y)*.5,r.size[2]*(r.count[2]-o.z)*.5);for(let c=0;c<r.count[0];c++)for(let u=0;u<r.count[1];u++)for(let h=0;h<r.count[2];h++){let d=[(c+1)*(i.freqScale/10)+i.movement,(u+1)*(i.freqScale/10)+i.movement,(h+1)*(i.freqScale/10)+i.movement],p=s?Da.noise(...d):a(...d),f=this.children[t++];f.scale.x=1+n(t,ht(p,i.scale[0]))||Mi,f.scale.y=1+n(t,ht(p,i.scale[1]))||Mi,f.scale.z=1+n(t,ht(p,i.scale[2]))||Mi;let m=n(t,ht(p,i.rotation[0])),g=n(t,ht(p,i.rotation[1])),v=n(t,ht(p,i.rotation[2]));f.rotation.set(m,g,v),f.position.x=r.size[0]*c-l.x+n(t,ht(p,i.position[0])),f.position.y=r.size[1]*u-l.y+n(t,ht(p,i.position[1])),f.position.z=r.size[2]*h-l.z+n(t,ht(p,i.position[2]))}}else for(let o=0;o<r.count[0];o++)for(let l=0;l<r.count[1];l++)for(let c=0;c<r.count[2];c++){let u=[(o+1)*(i.freqScale/10)+i.movement,(l+1)*(i.freqScale/10)+i.movement,(c+1)*(i.freqScale/10)+i.movement],h=s?Da.noise(...u):a(...u),d=this.children[t++];d.scale.x=1+n(t,ht(h,i.scale[0]))||Mi,d.scale.y=1+n(t,ht(h,i.scale[1]))||Mi,d.scale.z=1+n(t,ht(h,i.scale[2]))||Mi;let p=n(t,ht(h,i.rotation[0])),f=n(t,ht(h,i.rotation[1])),m=n(t,ht(h,i.rotation[2]));d.rotation.set(p,f,m),d.position.x=r.size[0]*o+n(t,ht(h,i.position[0])),d.position.y=-r.size[1]*l+n(t,ht(h,i.position[1])),d.position.z=-r.size[2]*c+n(t,ht(h,i.position[2]))}}_updateToObject(e){var m;if(e.type!=="toObject")throw new Error;let{toObject:t}=e,r=new Zr(t.rotation[0],t.rotation[1],t.rotation[2]),i=e.randomnessObject??Zo.defaultData([1,1,1]).randomnessObject,n=i.noiseType==="perlin";Da.noiseSeed(i.seed);let s=tw((0,rp.default)(i.seed)),a=Xg(i.strength,this.parameters.randomness);if(!t.object){for(let[,g]of this.children.entries())g.position.set(0,0,0),g.scale.setScalar(1),g.rotation.set(0,0,0);this.objectForSample=void 0;return}if(!this.objectForSample)return;if(this.objectForSample instanceof _k)if(!((m=this.objectForSample.font)!=null&&m.isLoaded)||this.objectForSample.geometry.attributes.position===void 0){this._pendingMediaLoad=!0;return}else this._pendingMediaLoad=!1;if(this.objectForSample.geometry===void 0&&this.objectForSample.isAncestorOf(this.object.uuid)){console.warn(`Oh no! The object "${this.object.name}" (${this.object.uuid}) seem to be a child/descendant of the object it's being cloned to. Please re-parent it so that they are siblings instead.`);return}let o=this.getSubdivData(),l=[],c=g=>{let v=g.length,y=g.map(b=>b[0]).reduce((b,_)=>b+_,0),x=g.map(b=>b[1]).reduce((b,_)=>b+_,0),w=g.map(b=>b[2]).reduce((b,_)=>b+_,0);return[y/v,x/v,w/v]},u=g=>Math.round(g*1e6)/1e6;o.forEach(g=>{let v=o.filter(y=>u(g.pos[0])===u(y.pos[0])&&u(g.pos[1])===u(y.pos[1])&&u(g.pos[2])===u(y.pos[2]));v.length>1?l.push({pos:g.pos,norm:c(v.map(y=>y.norm))}):l.push(g)});let h=sue(l);if(o.length>0){let g=Math.round(h.length*t.count/100);this._updateCount(g)}else{console.warn(`Oh no! The object "${this.object.name}" (${this.object.uuid}) cannot be cloned on the surface of "${this.objectForSample.name}" (${this.objectForSample.uuid}) because the latter does not have a valid geometry.`);return}this.objectForSample.updateMatrixWorld();let d=new ole(this.objectForSample).build(),p=iue[t.axis],f=this.children;d.setRandomGenerator((0,rp.default)(this.object.uuid+t.seed));for(let[g,v]of f.entries()){let y=g*(i.freqScale/10)+i.movement,x=n?Da.noise(y):s(y,y),w=g+1,b=a(w,ht(x,i.rotation[0])),_=a(w,ht(x,i.rotation[1])),A=a(w,ht(x,i.rotation[2]));t.spreadType==="random"?d.sample(cp,yw):(h.length&&(cp.fromArray(h[g].pos),yw.fromArray(h[g].norm)),this.objectForSample instanceof Kf&&cp.applyMatrix4(mue.copy(this.objectForSample.matrixWorld).invert())),cp.applyMatrix4(this.object.hiddenMatrix.clone().invert()),v.position.copy(cp),Eo.fromArray(p);let S=t.align==="normal"?yw:this.object.getWorldDirection(yue),C=Hl.fromArray(t.position);Hl.x+=Hl.x+a(w,ht(x,i.position[0])),Hl.y+=Hl.y+a(w,ht(x,i.position[1])),Hl.z+=Hl.z+a(w,ht(x,i.position[2]));let M=Math.acos(S.dot(Eo)),T=vue.crossVectors(Eo,S).normalize(),P=gue.makeRotationAxis(T,M),D=S.clone().cross(this.object.up).normalize(),I=D.clone().cross(S).normalize(),B=new _e().makeBasis(D,S,I),X=new E(Eo.y,Eo.z,Eo.x).normalize(),H=X.clone().cross(Eo).normalize(),R=new _e().makeBasis(X,Eo,H).invert(),q=new _e().multiplyMatrices(B,R);v.rotation.setFromRotationMatrix(q),C.applyMatrix4(P),v.position.add(C),v.rotation.x=v.rotation.x+r.x+b,v.rotation.y=v.rotation.y+r.y+_,v.rotation.z=v.rotation.z+r.z+A,v.scale.setScalar(1),v.scale.x=v.scale.x+t.scale[0]+a(w,ht(x,i.scale[0]))||Mi,v.scale.y=v.scale.y+t.scale[1]+a(w,ht(x,i.scale[1]))||Mi,v.scale.z=v.scale.z+t.scale[2]+a(w,ht(x,i.scale[2]))||Mi,v.scale.multiply(this.object.scale),v.hiddenMatrix=this.object.hiddenMatrix}}getSubdivData(){if(!this.objectForSample)return[];let e=this.parameters.toObject.spreadType;if(e==="random")return[];if(this.objectForSample instanceof Kf){let t=this.objectForSample,r=nue[e],i=Ck[r],n=Sk[r],s=Ak[r],a=[],o=i(t.subdivPointerNew);for(let l=0;l<=o-1;l++){let c=n(t.subdivPointerNew,l),u=s(t.subdivPointerNew,l);jD.fromArray(c).applyMatrix4(t.matrixWorld),VD.fromArray(u),a.push({pos:jD.toArray(),norm:VD.toArray()})}return a}else return(this.objectForSample.geometry.index?cue(this.objectForSample.geometry):hue(this.objectForSample.geometry)).map((t,r)=>e==="polygon_center"?{pos:t.midpoint,norm:t.norm}:e==="vertex"?[{pos:t.vertices[0],norm:t.norm},{pos:t.vertices[1],norm:t.norm},{pos:t.vertices[2],norm:t.norm}]:e==="edge"?[{pos:t.faceCenters[0],norm:t.norm},{pos:t.faceCenters[1],norm:t.norm},{pos:t.faceCenters[2],norm:t.norm}]:[]).flat()}updateState(e,t){var r;if(this.parameters=Qy(e),this.parameters.type!=="toObject")(this.parent===null||this.parent!==this.object)&&(this.removeFromParent(),(r=this.object.parent)==null||r.add(this),this.matrix=this.object.matrix,this.hiddenMatrix=this.object.hiddenMatrix,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1);else if(this.parent===null||this.parent.uuid!==this.parameters.toObject.object){this.removeFromParent();let i=t.find(this.parameters.toObject.object);i instanceof an?this.objectForSample=i:this.objectForSample=void 0,this.matrix=new _e,this.hiddenMatrix=new _e,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1,i&&i.add(this)}this.update()}get pendingMediaLoad(){return this._pendingMediaLoad}},ym=e=>{var t;return t=class extends e{},t.geometryHelper=new ma(30,30,30),t},Kg=new hd,xw=new Mn,HD=new _e,xm=(e,t,r,i,n=!1)=>{let s=t,a=e.matrixWorld;if(s.boundingSphere===null&&s.computeBoundingSphere(),xw.copy(s.boundingSphere),xw.applyMatrix4(a),r.ray.intersectsSphere(xw)===!1||(HD.copy(a).invert(),Kg.copy(r.ray).applyMatrix4(HD),s.boundingBox!==null&&Kg.intersectsBox(s.boundingBox)===!1))return;let o,l,c,u,h=s.index,d=s.attributes.position,p=s.drawRange,f,m;if(n===!1){let v=Math.max(0,p.start),y=Math.min(h.count,p.start+p.count);for(f=v,m=y;f<m;f+=3)if(l=h.getX(f),c=h.getX(f+1),u=h.getX(f+2),o=g(e,r,Kg,d,l,c,u),o){o.faceIndex=Math.floor(f/3),i.push(o);return}}else{let v=s.attributes.position,y=new E,x=new E,w=new E,b=new E,_=2,A=1/((e.scale.x+e.scale.y+e.scale.z)/3),S=A*A,C=Math.max(0,p.start),M=Math.min(v.count,p.start+p.count);for(let T=C,P=M-1;T<P;T+=_){if(y.fromBufferAttribute(v,T),x.fromBufferAttribute(v,T+1),Kg.distanceSqToSegment(y,x,b,w)>S)continue;b.applyMatrix4(e.matrixWorld);let D=r.ray.origin.distanceTo(b);D<r.near||D>r.far||i.push({distance:D,point:w.clone().applyMatrix4(e.matrixWorld),object:e})}}function g(v,y,x,w,b,_,A){let S=new E,C=new E,M=new E,T=new E,P=new E;if(S.fromBufferAttribute(w,b),C.fromBufferAttribute(w,_),M.fromBufferAttribute(w,A),x.intersectTriangle(S,C,M,!1,T)===null)return null;P.copy(T),P.applyMatrix4(v.matrixWorld);let D=y.ray.origin.distanceTo(P);return D<y.near||D>y.far?null:{faceIndex:1,distance:D,point:P.clone(),object:v}}},Zg=new E,Rn=new dd,xue=class extends pm{constructor(e){let t=new it,r=new Ll({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],n=[],s={},a=new $e(15711266),o=new $e(15711266),l=new $e(2857471);c("n1","n2",a),c("n2","n4",a),c("n4","n3",a),c("n3","n1",a),c("f1","f2",a),c("f2","f4",a),c("f4","f3",a),c("f3","f1",a),c("n1","f1",a),c("n2","f2",a),c("n3","f3",a),c("n4","f4",a),c("p","n1",o),c("p","n2",o),c("p","n3",o),c("p","n4",o),c("u1","u2",l),c("u2","u3",l),c("u3","u1",l);function c(h,d,p){u(h,p),u(d,p)}function u(h,d){i.push(0,0,0),n.push(d.r,d.g,d.b),s[h]===void 0&&(s[h]=[]),s[h].push(i.length/3-1)}t.setAttribute("position",new Ne(i,3)),t.setAttribute("color",new Ne(n,3)),super(t,r),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update()}update(){let e=this.geometry,t=this.pointMap;Rn.projectionMatrixInverse.elements=[.5112609807824982,-0,-0,-0,-0,.41421356237309503,-0,-0,-0,-0,-0,-.099999,-0,-0,-1.0000000000000002,.100001];let r=1,i=1,n=.8;hs("n1",t,e,Rn,-r,-i,n),hs("n2",t,e,Rn,r,-i,n),hs("n3",t,e,Rn,-r,i,n),hs("n4",t,e,Rn,r,i,n);let s=n;hs("f1",t,e,Rn,-r,-i,s),hs("f2",t,e,Rn,r,-i,s),hs("f3",t,e,Rn,-r,i,s),hs("f4",t,e,Rn,r,i,s);let a=s,o=.5;hs("u1",t,e,Rn,r*.7*o,i*1.1,a),hs("u2",t,e,Rn,-r*.7*o,i*1.1,a),hs("u3",t,e,Rn,0,i*(1.1+.9*o),a),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function hs(e,t,r,i,n,s,a){Zg.set(n,s,a).unproject(i);let o=t[e];if(o!==void 0){let l=r.getAttribute("position");for(let c=0,u=o.length;c<u;c++)l.setXYZ(o[c],Zg.x,Zg.y,Zg.z)}}var wue=class extends ym(xue){constructor(e){super(e),this.object=e,this.object=e,this.name=`CombinedCameraHelper: ${e.uuid}`}updateMatrixWorld(e){super.updateMatrixWorld(e),this.updateTarget()}updateTarget(){let e=this.object.getTarget();this.updateWorldMatrix(!0,!1),this.worldToLocal(e)}raycast(e,t){xm(this.object,this.geometry,e,t,!0)}},C_;(e=>e.is=t=>"objectHelper"in t)(C_||(C_={}));var wm=(e,t)=>class extends mA(e){constructor(){super(...arguments),this.objectHelper=new t(this),this.gizmos={}}get geometryHelper(){return t.geometryHelper}raycast(r,i){this.objectHelper.raycast(r,i)}showGizmos(){for(let r in this.gizmos){let i=this.gizmos[r];i instanceof P0&&(i.visible=!0)}}updateEntityBoxSize(r,i){this.objectHelper.visible&&this.geometryHelper instanceof ma?(r.setScalar(0),i.set(this.geometryHelper.parameters.width,this.geometryHelper.parameters.height,this.geometryHelper.parameters.height).multiplyScalar(.5)):super.updateEntityBoxSize(r,i)}hideGizmos(){for(let r in this.gizmos){let i=this.gizmos[r];i instanceof P0&&(i.visible=!1)}}},$g=790,wh=new E,ww=new E,bw=new ft,_w=new E,hp=new E,Sw=new E,bi=class extends wm(dd,wue){constructor(e="",t={...Hf.defaultData,name:""}){super(),this._cameraType="OrthographicCamera",this.targetOffset=Ku.DefaultTargetOffset,this.isUpVectorFlipped=!1,this.angleOffsetFromUp=0,this.wasMovedByUser=!1,this.wasMovedBySwitchCameraAction=!1,this.super_Entity(e,t),this.previousProjectionMatrix=new _e,this.matrixAutoUpdate=!0,this.width=window.innerWidth,this.height=window.innerHeight;let r=this.width,i=this.height;this.orthoCamera=new M3(r*-.5,r*.5,i*.5,i*-.5,-5e4,1e4),this.perspCamera=new vi(45,r/i,50,1e4),this.left=this.orthoCamera.left,this.right=this.orthoCamera.right,this.top=this.orthoCamera.top,this.bottom=this.orthoCamera.bottom,this.far=this.orthoCamera.far,this.view=this.orthoCamera.view,this.aspect=this.perspCamera.aspect,this.focus=this.perspCamera.focus,this.filmGauge=this.perspCamera.filmGauge,this.filmOffset=this.perspCamera.filmOffset,this.objectHelper.update()}get isPerspectiveCamera(){return this.cameraType==="PerspectiveCamera"}get isOrthographicCamera(){return!this.isPerspectiveCamera}get cameraType(){return this._cameraType}set fov(e){this.perspCamera.fov=e}get fov(){return this.perspCamera.fov}setNear(e,t){e==="PerspectiveCamera"?this.perspCamera.near=t:this.orthoCamera.near=t}setZoom(e,t){t>=0&&(e==="PerspectiveCamera"?this.perspCamera.zoom=t:this.orthoCamera.zoom=t)}set cameraType(e){e==="PerspectiveCamera"?this.toPerspective():e==="OrthographicCamera"&&this.toOrthographic()}get near(){return this._cameraType==="PerspectiveCamera"?this.perspCamera.near:this.orthoCamera.near}set near(e){this._cameraType==="PerspectiveCamera"?this.perspCamera.near=e:this.orthoCamera.near=e}get zoom(){return this._cameraType==="PerspectiveCamera"?this.perspCamera.zoom:this.orthoCamera.zoom}set zoom(e){e>=0&&(this._cameraType==="PerspectiveCamera"?this.perspCamera.zoom=e:this.orthoCamera.zoom=e)}lookAt(e,t,r){typeof e=="number"&&(e=new E(e,t,r)),super.lookAt(e),this.getWorldPosition(wh),this.targetOffset=wh.distanceTo(e)}getTarget(e=new E){return this.getWorldDirection(ww),this.getWorldPosition(wh),ww.multiplyScalar(this.targetOffset),e.copy(wh).add(ww),e}getDistanceToTarget(){let e=this.getTarget();return this.getWorldPosition(wh),wh.distanceTo(e)}updateUp(){this.getWorldQuaternion(bw),_w.set(0,0,1).applyQuaternion(bw),hp.copy(Vt.DEFAULT_UP),this.isUpVectorFlipped&&hp.negate(),hp.applyQuaternion(bw),Sw.copy(Vt.DEFAULT_UP).projectOnPlane(_w),this.angleOffsetFromUp=Sw.angleTo(hp),this.angleOffsetFromUp*=Sw.cross(hp).dot(_w)>=0?1:-1}updateTransformState(e){let t=super.updateTransformState(e);return e.isUpVectorFlipped!==void 0&&(this.isUpVectorFlipped=e.isUpVectorFlipped),this.updateUp(),t}getViewFrontToObject(e){let t=e.getWorldPosition(new E),r=e.getWorldDirection(new E).multiplyScalar(this.targetOffset);return{position:t.clone().add(r),target:t}}getViewToTarget(e){let t=this.getWorldDirection(new E).multiplyScalar(this.targetOffset);return{position:e.clone().sub(t),target:e}}getViewToObject(e){let t=new E;return e.getWorldPosition(t),this.getViewToTarget(t)}setViewplaneSize(e,t,r=!1){if(this.aspect=e/t,r){let i=e>t?this.aspect:1,n=e>t?1:this.aspect;this.left=-$g*.5*i,this.right=$g*.5*i,this.top=$g*.5*(1/n),this.bottom=-$g*.5*(1/n)}else this.left=-e*.5,this.right=e*.5,this.top=t*.5,this.bottom=-t*.5;this.updateProjectionMatrix()}copyViewPlaneSize(e){this.aspect=e.aspect,this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.updateProjectionMatrix()}toOrthographic(){this.orthoCamera.left=this.left,this.orthoCamera.right=this.right,this.orthoCamera.top=this.top,this.orthoCamera.bottom=this.bottom,this.orthoCamera.view=this.view,this.orthoCamera.far=this.far,this.orthoCamera.updateProjectionMatrix(),this.projectionMatrix=this.orthoCamera.projectionMatrix,this.projectionMatrixInverse=this.orthoCamera.projectionMatrixInverse,this._cameraType="OrthographicCamera",this.objectHelper&&this.objectHelper.update()}toPerspective(){this.perspCamera.aspect=this.aspect,this.perspCamera.fov=this.fov,this.perspCamera.view=this.view,this.perspCamera.far=this.far,this.perspCamera.updateProjectionMatrix(),this.projectionMatrix=this.perspCamera.projectionMatrix,this.projectionMatrixInverse=this.perspCamera.projectionMatrixInverse,this._cameraType="PerspectiveCamera",this.objectHelper&&this.objectHelper.update()}setFocalLength(e){this.perspCamera.setFocalLength(e),this.toPerspective()}getFocalLength(){return this.perspCamera.getFocalLength()}getEffectiveFOV(){return this.perspCamera.getEffectiveFOV()}getFilmWidth(){return this.perspCamera.getFilmWidth()}getFilmHeight(){return this.perspCamera.getFilmHeight()}setViewOffset(e,t,r,i,n,s){this._cameraType==="PerspectiveCamera"?this.perspCamera.setViewOffset(e,t,r,i,n,s):this.orthoCamera.setViewOffset(e,t,r,i,n,s)}clearViewOffset(){this._cameraType==="PerspectiveCamera"?(this.perspCamera.clearViewOffset(),this.toPerspective()):(this.orthoCamera.clearViewOffset(),this.toOrthographic())}copyHistory(){this.previousProjectionMatrix&&this.previousProjectionMatrix.copy(this.projectionMatrix)}updateProjectionMatrix(){this._cameraType==="PerspectiveCamera"?this.toPerspective():this._cameraType==="OrthographicCamera"&&this.toOrthographic()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}copy(e,t){return super.copy(e,t),this.parent=e.parent,this.orthoCamera.copy(e.orthoCamera),this.perspCamera.copy(e.perspCamera),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.far=e.far,this.view=e.view===null?null:Object.assign({},e.view),this._cameraType=e._cameraType,this.aspect=e.aspect,this.fov=e.fov,this.focus=e.focus,this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this.targetOffset=e.targetOffset,this.updateProjectionMatrix(),this}toCameraState(e=[]){let t={type:this.cameraType,far:this.far,orthographic:{near:this.orthoCamera.near,zoom:this.orthoCamera.zoom},perspective:{near:this.perspCamera.near,fov:this.perspCamera.fov,zoom:this.perspCamera.zoom},up:this.up.toArray(),targetOffset:this.targetOffset,isUpVectorFlipped:this.isUpVectorFlipped};return P2(t,e)}updateCameraSubtype(e,t){let r=e==="perspective"?"PerspectiveCamera":"OrthographicCamera";t.zoom!==void 0&&this.setZoom(r,t.zoom),t.near!==void 0&&this.setNear(r,t.near),t.fov!==void 0&&r==="PerspectiveCamera"&&(this.fov=t.fov)}updateState(e,t){this.updateCameraState(e,t)}updateCameraState(e,t){this.updateState_Entity(e,t),e.far!==void 0&&(this.far=e.far),e.orthographic!==void 0&&this.updateCameraSubtype("orthographic",e.orthographic),e.perspective!==void 0&&this.updateCameraSubtype("perspective",e.perspective),e.type!==void 0&&(this.cameraType=e.type),e.up!==void 0&&this.up.fromArray(e.up),e.targetOffset!==void 0&&(this.targetOffset=e.targetOffset),e.isUpVectorFlipped!==void 0&&(this.isUpVectorFlipped=e.isUpVectorFlipped),this.updateProjectionMatrix()}updateByPatchedOp(e,t,r){super.updateByPatchedOp(e,t,r),e.path.length===1&&e.type===0&&this.updateCameraSubtype(e.path[0],e.props)}toState(e){return{...super.toState(e),...this.toCameraState(e),type:this.cameraType}}},bh=new _e,bue=new _e;function GD(e){let t=!1;return e.scene.objects.traverse((r,i)=>{var n;((n=i.geometry)==null?void 0:n.type)==="BooleanGeometry"&&(t=!0)}),t}var rd=class extends Cd{constructor(e,t,r){super(e,t),this.data=t,this.meshSetAddresses=[],this.needsTransformForDownstream=!1,this.geometry=new it,this.onAfterRender=(i,n,s,a,o,l)=>{super.onAfterRender(i,n,s,a,o,l),this.recomputeBoolean()},this.geometry.userData.parameters={width:0,height:0,depth:0}}get booleanOp(){return this.data.geometry.operation}get phongAngle(){return this.data.geometry.phongAngle??45}get isLOD(){return this.recomputeBoolean(),!1}updateByPatchedOp(e,t,r){super.updateByPatchedOp(e,t,r),e.path.length===1&&e.path[0]==="geometry"&&e.type===0&&e.props.operation!==void 0&&(this.freeBooleanPointer(),this.resetBBoxNeedsUpdate())}freeBooleanPointer(){super.freeBooleanPointer(),this.geometry.dispose()}recomputeBoolean(e,t=!0){var i;if(this.booleanMeshSetAddress!==-1&&!e)return;for(let n=0;n<this.children.length;n++){let s=this.children[n];s instanceof rd&&s.dataPatched.visible===!0&&s.recomputeBoolean(e===!0,t)}this.meshSetAddresses=[];for(let n=0;n<this.children.length;n++){let s=this.children[n];if(s instanceof an&&s.dataPatched.visible===!0&&((i=s.geometry.attributes.position)==null?void 0:i.count)>0&&s.geometry.drawRange.count>0){if(bh.multiplyMatrices(s.hiddenMatrix,s.matrix),s.booleanMeshSetAddress===-1){if((s.geometry.index??s.geometry.getAttribute("position")).count/3<15e5&&(s.booleanMeshSetAddress=Ua.getMeshSet(s.geometry,e===!0,t)),s.booleanMeshSetAddress===-1)return;Ua.transformMeshSet(s.booleanMeshSetAddress,bh),s.booleanMatrixInvOld.copy(bh).invert(),s.booleanWasTransformed=!1}else s instanceof rd&&s.needsTransformForDownstream===!0?(Ua.transformMeshSet(s.booleanMeshSetAddress,bh),s.needsTransformForDownstream=!1):s.booleanWasTransformed===!0&&(Ua.transformMeshSet(s.booleanMeshSetAddress,bue.multiplyMatrices(bh,s.booleanMatrixInvOld)),s.booleanMatrixInvOld.copy(bh).invert(),s.booleanWasTransformed=!1);Ua.hasOpenEdges(s.booleanMeshSetAddress)===!1||n===this.children.length-1&&this.booleanOp===2?(this.meshSetAddresses.push(s.booleanMeshSetAddress),s.geometry.userData.wasFilteredFromBoolean=!1):s.geometry.userData.wasFilteredFromBoolean=!0}}if(this.meshSetAddresses.length===0){this.geometry.setAttribute("position",new Ne([],0)),this.geometry.setDrawRange(0,0);return}if(e===!0)return Ua.calcBooleanTopological(this.meshSetAddresses,this.booleanOp);let r=this.geometry;r.dispose(),this.geometry=new it,this.geometry.userData=r.userData,this.geometry.boundingSphere=r.boundingSphere;try{this.booleanMeshSetAddress=Ua.calcBoolean(this.meshSetAddresses,this.booleanOp,this.geometry,this.phongAngle)}catch(n){this.booleanMeshSetAddress=0,console.error(n)}this.booleanMatrixInvOld.copy(this.matrix).invert(),this.needsTransformForDownstream=!0,DA(this),LA(this)}dispose(){super.dispose(),this.geometry.dispose()}},M_;(e=>{function t(r){return Mt.is(r)&&r instanceof mm}e.is=t})(M_||(M_={}));var IA=(e,t)=>class extends wm(e,t){updateState_Light(r,i){this.updateState_Entity(r,i),r.color!==void 0&&(this.color=i.shared.color(r.color)),r.intensity!==void 0&&(this.intensity=r.intensity),r.depth!==void 0&&(this.shadow.camera.far=r.depth,this.shadow.needsUpdate=!0),r.shadows!==void 0&&(this.castShadow=r.shadows)}},ws=e=>e instanceof an,na=e=>e!==null&&e instanceof rd,_ue=e=>e instanceof bi,Sue=e=>M_.is(e),E_=e=>C_.is(e),n1=class extends ym(HZ){constructor(e,t=15){super(t),this.object=e,this.object.updateMatrixWorld(),this.name=`EmptyObjectHelper: ${e.uuid}`,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.object.isBone&&(this.visible=!1)}raycast(e,t){xm(this.object,n1.geometryHelper,e,t)}update(){}},Zf=class extends wm(ru,n1){constructor(e,t){super(),this.super_Entity(e,t),this.objectHelper.update()}updateState(e,t){this.updateState_Entity(e,t)}},Mk={RED:0,GREEN:1,BLUE:2,ALPHA:3},bm="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",Aue=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform lowp sampler2D cocBuffer;uniform vec2 texelSize;uniform float scale;
#if PASS == 1
uniform vec4 kernel64[32];
#else
uniform vec4 kernel16[8];
#endif
varying vec2 vUv;void main(){
#ifdef FOREGROUND
vec2 CoCNearFar=texture2D(cocBuffer,vUv).rg;float CoC=CoCNearFar.r*scale;
#else
float CoC=texture2D(cocBuffer,vUv).g*scale;
#endif
if(CoC==0.0){gl_FragColor=texture2D(inputBuffer,vUv);}else{
#ifdef FOREGROUND
vec2 step=texelSize*max(CoC,CoCNearFar.g*scale);
#else
vec2 step=texelSize*CoC;
#endif
#if PASS == 1
vec4 acc=vec4(0.0);for(int i=0;i<32;++i){vec4 kernel=kernel64[i];vec2 uv=step*kernel.xy+vUv;acc+=texture2D(inputBuffer,uv);uv=step*kernel.zw+vUv;acc+=texture2D(inputBuffer,uv);}gl_FragColor=acc/64.0;
#else
vec4 maxValue=texture2D(inputBuffer,vUv);for(int i=0;i<8;++i){vec4 kernel=kernel16[i];vec2 uv=step*kernel.xy+vUv;maxValue=max(texture2D(inputBuffer,uv),maxValue);uv=step*kernel.zw+vUv;maxValue=max(texture2D(inputBuffer,uv),maxValue);}gl_FragColor=maxValue;
#endif
}}`,Jg=class extends Yt{constructor(e=!1,t=!1){super({name:"BokehMaterial",defines:{PASS:e?"2":"1"},uniforms:{kernel64:new we(null),kernel16:new we(null),inputBuffer:new we(null),cocBuffer:new we(null),texelSize:new we(new W),scale:new we(1)},blending:Ir,depthWrite:!1,depthTest:!1,fragmentShader:Aue,vertexShader:bm}),this.toneMapped=!1,t&&(this.defines.FOREGROUND="1"),this.generateKernel()}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}set cocBuffer(e){this.uniforms.cocBuffer.value=e}setCoCBuffer(e){this.uniforms.cocBuffer.value=e}get scale(){return this.uniforms.scale.value}set scale(e){this.uniforms.scale.value=e}getScale(e){return this.uniforms.scale.value=e}setScale(e){this.uniforms.scale.value=e}generateKernel(){let e=2.39996323,t=new Float32Array(128),r=new Float32Array(32),i=0,n=0;for(let o=0;o<80;++o){let l=o*e,c=Math.sqrt(o)/Math.sqrt(80),u=c*Math.cos(l),h=c*Math.sin(l);o%5===0?(r[n++]=u,r[n++]=h):(t[i++]=u,t[i++]=h)}let s=[],a=[];for(let o=0;o<128;)s.push(new dt(t[o++],t[o++],t[o++],t[o++]));for(let o=0;o<32;)a.push(new dt(r[o++],r[o++],r[o++],r[o++]));this.uniforms.kernel64.value=s,this.uniforms.kernel16.value=a}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t)}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}};function WD(e,t,r){return e*(t-r)-t}function T_(e,t,r){return Math.min(Math.max((e+t)/(t-r),0),1)}var Cue=`#include <common>
#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform float focusDistance;uniform float focusRange;uniform float cameraNear;uniform float cameraFar;varying vec2 vUv;float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}void main(){float depth=readDepth(vUv);
#ifdef PERSPECTIVE_CAMERA
float viewZ=perspectiveDepthToViewZ(depth,cameraNear,cameraFar);float linearDepth=viewZToOrthographicDepth(viewZ,cameraNear,cameraFar);
#else
float linearDepth=depth;
#endif
float signedDistance=linearDepth-focusDistance;float magnitude=smoothstep(0.0,focusRange,abs(signedDistance));gl_FragColor.rg=magnitude*vec2(step(signedDistance,0.0),step(0.0,signedDistance));}`,Mue=class extends Yt{constructor(e){super({name:"CircleOfConfusionMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new we(null),focusDistance:new we(0),focusRange:new we(0),cameraNear:new we(.3),cameraFar:new we(1e3)},blending:Ir,depthWrite:!1,depthTest:!1,fragmentShader:Cue,vertexShader:bm}),this.toneMapped=!1,this.uniforms.focalLength=this.uniforms.focusRange,this.adoptCameraSettings(e)}get near(){return this.uniforms.cameraNear.value}get far(){return this.uniforms.cameraFar.value}set depthBuffer(e){this.uniforms.depthBuffer.value=e}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=vo){this.depthBuffer=e,this.depthPacking=t}get focusDistance(){return this.uniforms.focusDistance.value}set focusDistance(e){this.uniforms.focusDistance.value=e}get worldFocusDistance(){return-WD(this.focusDistance,this.near,this.far)}set worldFocusDistance(e){this.focusDistance=T_(-e,this.near,this.far)}getFocusDistance(e){this.uniforms.focusDistance.value=e}setFocusDistance(e){this.uniforms.focusDistance.value=e}get focalLength(){return this.focusRange}set focalLength(e){this.focusRange=e}get focusRange(){return this.uniforms.focusRange.value}set focusRange(e){this.uniforms.focusRange.value=e}get worldFocusRange(){return-WD(this.focusRange,this.near,this.far)}set worldFocusRange(e){this.focusRange=T_(-e,this.near,this.far)}getFocalLength(e){return this.focusRange}setFocalLength(e){this.focusRange=e}adoptCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof vi?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}},Eue=`#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;
#include <encodings_fragment>
#include <dithering_fragment>
}`,Tue="uniform vec2 texelSize;uniform vec2 halfTexelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize*vec2(kernel)+halfTexelSize)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",qD=class extends Yt{constructor(e=new W){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new we(null),texelSize:new we(new W),halfTexelSize:new we(new W),kernel:new we(0),scale:new we(1)},blending:Ir,depthWrite:!1,depthTest:!1,fragmentShader:Eue,vertexShader:Tue}),this.toneMapped=!1,this.setTexelSize(e.x,e.y)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.inputBuffer=e}get scale(){return this.uniforms.scale.value}set scale(e){this.uniforms.scale.value=e}getScale(){return this.uniforms.scale.value}setScale(e){this.uniforms.scale.value=e}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(e){this.uniforms.kernel.value=e}setKernel(e){this.kernel=e}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t),this.uniforms.halfTexelSize.value.set(e,t).multiplyScalar(.5)}setSize(e,t){let r=this.uniforms;r.texelSize.value.set(1/e,1/t),r.halfTexelSize.value.copy(r.texelSize.value).multiplyScalar(.5)}},Pue=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;
#include <encodings_fragment>
}`,Due=class extends Yt{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new we(null),opacity:new we(1)},blending:Ir,depthWrite:!1,depthTest:!1,fragmentShader:Pue,vertexShader:bm}),this.toneMapped=!1}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}getOpacity(e){return this.uniforms.opacity.value}setOpacity(e){this.uniforms.opacity.value=e}},Lue=`varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#if EDGE_DETECTION_MODE != 0
varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;
#endif
#if EDGE_DETECTION_MODE == 1
#include <common>
#endif
#if EDGE_DETECTION_MODE == 0 || PREDICATION_MODE == 1
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}vec3 gatherNeighbors(){float p=readDepth(vUv);float pLeft=readDepth(vUv0);float pTop=readDepth(vUv1);return vec3(p,pLeft,pTop);}
#elif PREDICATION_MODE == 2
uniform sampler2D predicationBuffer;vec3 gatherNeighbors(){float p=texture2D(predicationBuffer,vUv).r;float pLeft=texture2D(predicationBuffer,vUv0).r;float pTop=texture2D(predicationBuffer,vUv1).r;return vec3(p,pLeft,pTop);}
#endif
#if PREDICATION_MODE != 0
vec2 calculatePredicatedThreshold(){vec3 neighbours=gatherNeighbors();vec2 delta=abs(neighbours.xx-neighbours.yz);vec2 edges=step(PREDICATION_THRESHOLD,delta);return PREDICATION_SCALE*EDGE_THRESHOLD*(1.0-PREDICATION_STRENGTH*edges);}
#endif
#if EDGE_DETECTION_MODE != 0
uniform sampler2D inputBuffer;
#endif
void main(){
#if EDGE_DETECTION_MODE == 0
const vec2 threshold=vec2(DEPTH_THRESHOLD);
#elif PREDICATION_MODE != 0
vec2 threshold=calculatePredicatedThreshold();
#else
const vec2 threshold=vec2(EDGE_THRESHOLD);
#endif
#if EDGE_DETECTION_MODE == 0
vec3 neighbors=gatherNeighbors();vec2 delta=abs(neighbors.xx-vec2(neighbors.y,neighbors.z));vec2 edges=step(threshold,delta);if(dot(edges,vec2(1.0))==0.0){discard;}gl_FragColor=vec4(edges,0.0,1.0);
#elif EDGE_DETECTION_MODE == 1
float l=luminance(texture2D(inputBuffer,vUv).rgb);float lLeft=luminance(texture2D(inputBuffer,vUv0).rgb);float lTop=luminance(texture2D(inputBuffer,vUv1).rgb);vec4 delta;delta.xy=abs(l-vec2(lLeft,lTop));vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}float lRight=luminance(texture2D(inputBuffer,vUv2).rgb);float lBottom=luminance(texture2D(inputBuffer,vUv3).rgb);delta.zw=abs(l-vec2(lRight,lBottom));vec2 maxDelta=max(delta.xy,delta.zw);float lLeftLeft=luminance(texture2D(inputBuffer,vUv4).rgb);float lTopTop=luminance(texture2D(inputBuffer,vUv5).rgb);delta.zw=abs(vec2(lLeft,lTop)-vec2(lLeftLeft,lTopTop));maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges.xy*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);
#elif EDGE_DETECTION_MODE == 2
vec4 delta;vec3 c=texture2D(inputBuffer,vUv).rgb;vec3 cLeft=texture2D(inputBuffer,vUv0).rgb;vec3 t=abs(c-cLeft);delta.x=max(max(t.r,t.g),t.b);vec3 cTop=texture2D(inputBuffer,vUv1).rgb;t=abs(c-cTop);delta.y=max(max(t.r,t.g),t.b);vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}vec3 cRight=texture2D(inputBuffer,vUv2).rgb;t=abs(c-cRight);delta.z=max(max(t.r,t.g),t.b);vec3 cBottom=texture2D(inputBuffer,vUv3).rgb;t=abs(c-cBottom);delta.w=max(max(t.r,t.g),t.b);vec2 maxDelta=max(delta.xy,delta.zw);vec3 cLeftLeft=texture2D(inputBuffer,vUv4).rgb;t=abs(c-cLeftLeft);delta.z=max(max(t.r,t.g),t.b);vec3 cTopTop=texture2D(inputBuffer,vUv5).rgb;t=abs(c-cTopTop);delta.w=max(max(t.r,t.g),t.b);maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);
#endif
}`,Iue=`uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;
#if EDGE_DETECTION_MODE != 0
varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;
#endif
void main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,0.0);vUv1=vUv+texelSize*vec2(0.0,-1.0);
#if EDGE_DETECTION_MODE != 0
vUv2=vUv+texelSize*vec2(1.0,0.0);vUv3=vUv+texelSize*vec2(0.0,1.0);vUv4=vUv+texelSize*vec2(-2.0,0.0);vUv5=vUv+texelSize*vec2(0.0,-2.0);
#endif
gl_Position=vec4(position.xy,1.0,1.0);}`,s1={DEPTH:0,LUMA:1,COLOR:2},Oue={DISABLED:0,DEPTH:1,CUSTOM:2},Rue=class extends Yt{constructor(e=new W,t=s1.COLOR){super({name:"EdgeDetectionMaterial",defines:{THREE_REVISION:cd.replace(/\D+/g,""),LOCAL_CONTRAST_ADAPTATION_FACTOR:"2.0",EDGE_THRESHOLD:"0.1",DEPTH_THRESHOLD:"0.01",PREDICATION_MODE:"0",PREDICATION_THRESHOLD:"0.01",PREDICATION_SCALE:"2.0",PREDICATION_STRENGTH:"1.0",DEPTH_PACKING:"0"},uniforms:{inputBuffer:new we(null),depthBuffer:new we(null),predicationBuffer:new we(null),texelSize:new we(e)},blending:Ir,depthWrite:!1,depthTest:!1,fragmentShader:Lue,vertexShader:Iue}),this.toneMapped=!1,this.edgeDetectionMode=t}set depthBuffer(e){this.uniforms.depthBuffer.value=e}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=vo){this.depthBuffer=e,this.depthPacking=t}get edgeDetectionMode(){return Number(this.defines.EDGE_DETECTION_MODE)}set edgeDetectionMode(e){this.defines.EDGE_DETECTION_MODE=e.toFixed(0),this.needsUpdate=!0}getEdgeDetectionMode(){return this.edgeDetectionMode}setEdgeDetectionMode(e){this.edgeDetectionMode=e}get localContrastAdaptationFactor(){return Number(this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR)}set localContrastAdaptationFactor(e){this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR=e.toFixed("6"),this.needsUpdate=!0}getLocalContrastAdaptationFactor(){return this.localContrastAdaptationFactor}setLocalContrastAdaptationFactor(e){this.localContrastAdaptationFactor=e}get edgeDetectionThreshold(){return Number(this.defines.EDGE_THRESHOLD)}set edgeDetectionThreshold(e){this.defines.EDGE_THRESHOLD=e.toFixed("6"),this.defines.DEPTH_THRESHOLD=(e*.1).toFixed("6"),this.needsUpdate=!0}getEdgeDetectionThreshold(){return this.edgeDetectionThreshold}setEdgeDetectionThreshold(e){this.edgeDetectionThreshold=e}get predicationMode(){return Number(this.defines.PREDICATION_MODE)}set predicationMode(e){this.defines.PREDICATION_MODE=e.toFixed(0),this.needsUpdate=!0}getPredicationMode(){return this.predicationMode}setPredicationMode(e){this.predicationMode=e}set predicationBuffer(e){this.uniforms.predicationBuffer.value=e}setPredicationBuffer(e){this.uniforms.predicationBuffer.value=e}get predicationThreshold(){return Number(this.defines.PREDICATION_THRESHOLD)}set predicationThreshold(e){this.defines.PREDICATION_THRESHOLD=e.toFixed("6"),this.needsUpdate=!0}getPredicationThreshold(){return this.predicationThreshold}setPredicationThreshold(e){this.predicationThreshold=e}get predicationScale(){return Number(this.defines.PREDICATION_SCALE)}set predicationScale(e){this.defines.PREDICATION_SCALE=e.toFixed("6"),this.needsUpdate=!0}getPredicationScale(){return this.predicationScale}setPredicationScale(e){this.predicationScale=e}get predicationStrength(){return Number(this.defines.PREDICATION_STRENGTH)}set predicationStrength(e){this.defines.PREDICATION_STRENGTH=e.toFixed("6"),this.needsUpdate=!0}getPredicationStrength(){return this.predicationStrength}setPredicationStrength(e){this.predicationStrength=e}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}},Bue=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#if THREE_REVISION >= 137
vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}FRAGMENT_HEADvoid main(){FRAGMENT_MAIN_UVvec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGEgl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <encodings_fragment>
#endif
#include <dithering_fragment>
}`,zue="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEADvoid main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORTgl_Position=vec4(position.xy,1.0,1.0);}",us={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},P_=class extends Yt{constructor(e,t,r,i,n=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:cd.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new we(null),depthBuffer:new we(null),resolution:new we(new W),texelSize:new we(new W),cameraNear:new we(.3),cameraFar:new we(1e3),aspect:new we(1),time:new we(0)},blending:Ir,depthWrite:!1,depthTest:!1,dithering:n}),this.toneMapped=!1,e&&this.setShaderParts(e),t&&this.setDefines(t),r&&this.setUniforms(r),this.adoptCameraSettings(i)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(e){this.uniforms.depthBuffer.value=e}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=vo){this.depthBuffer=e,this.depthPacking=t}setShaderParts(e){return this.fragmentShader=Bue.replace(us.FRAGMENT_HEAD,e.get(us.FRAGMENT_HEAD)).replace(us.FRAGMENT_MAIN_UV,e.get(us.FRAGMENT_MAIN_UV)).replace(us.FRAGMENT_MAIN_IMAGE,e.get(us.FRAGMENT_MAIN_IMAGE)),this.vertexShader=zue.replace(us.VERTEX_HEAD,e.get(us.VERTEX_HEAD)).replace(us.VERTEX_MAIN_SUPPORT,e.get(us.VERTEX_MAIN_SUPPORT)),this.needsUpdate=!0,this}setDefines(e){for(let t of e.entries())this.defines[t[0]]=t[1];return this.needsUpdate=!0,this}setUniforms(e){for(let t of e.entries())this.uniforms[t[0]]=t[1];return this}setExtensions(e){this.extensions={};for(let t of e)this.extensions[t]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(e){this.encodeOutput!==e&&(e?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(e){return this.encodeOutput}setOutputEncodingEnabled(e){this.encodeOutput=e}get time(){return this.uniforms.time.value}set time(e){this.uniforms.time.value=e}setDeltaTime(e){this.uniforms.time.value+=e}adoptCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof vi?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(e,t){let r=this.uniforms;r.resolution.value.set(e,t),r.texelSize.value.set(1/e,1/t),r.aspect.value=e/t}static get Section(){return us}},kue=`#include <common>
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef RANGE
uniform vec2 range;
#elif defined(THRESHOLD)
uniform float threshold;uniform float smoothing;
#endif
varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);
#ifdef RANGE
float low=step(range.x,l);float high=step(l,range.y);l*=low*high;
#elif defined(THRESHOLD)
l=smoothstep(threshold,threshold+smoothing,l);
#endif
#ifdef COLOR
gl_FragColor=vec4(texel.rgb*l,l);
#else
gl_FragColor=vec4(l);
#endif
}`,Nue=class extends Yt{constructor(e=!1,t=null){super({name:"LuminanceMaterial",defines:{THREE_REVISION:cd.replace(/\D+/g,"")},uniforms:{inputBuffer:new we(null),threshold:new we(0),smoothing:new we(1),range:new we(null)},blending:Ir,depthWrite:!1,depthTest:!1,fragmentShader:kue,vertexShader:bm}),this.toneMapped=!1,this.colorOutput=e,this.luminanceRange=t}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get threshold(){return this.uniforms.threshold.value}set threshold(e){this.smoothing>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=e}getThreshold(){return this.threshold}setThreshold(e){this.threshold=e}get smoothing(){return this.uniforms.smoothing.value}set smoothing(e){this.threshold>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=e}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(e){this.smoothing=e}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(e){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(e){e?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(e){return this.colorOutput}setColorOutputEnabled(e){this.colorOutput=e}get useRange(){return this.luminanceRange!==null}set useRange(e){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(e){e!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=e,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(e){this.luminanceRange=e}},Fue=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef MASK_PRECISION_HIGH
uniform mediump sampler2D maskTexture;
#else
uniform lowp sampler2D maskTexture;
#endif
#if MASK_FUNCTION != 0
uniform float strength;
#endif
varying vec2 vUv;void main(){
#if COLOR_CHANNEL == 0
float mask=texture2D(maskTexture,vUv).r;
#elif COLOR_CHANNEL == 1
float mask=texture2D(maskTexture,vUv).g;
#elif COLOR_CHANNEL == 2
float mask=texture2D(maskTexture,vUv).b;
#else
float mask=texture2D(maskTexture,vUv).a;
#endif
#if MASK_FUNCTION == 0
#ifdef INVERTED
mask=step(mask,0.0);
#else
mask=1.0-step(mask,0.0);
#endif
#else
mask=clamp(mask*strength,0.0,1.0);
#ifdef INVERTED
mask=1.0-mask;
#endif
#endif
#if MASK_FUNCTION == 2
gl_FragColor=vec4(mask*texture2D(inputBuffer,vUv).rgb,mask);
#else
gl_FragColor=mask*texture2D(inputBuffer,vUv);
#endif
}`,Ek={DISCARD:0,MULTIPLY:1,MULTIPLY_RGB_SET_ALPHA:2},Uue=class extends Yt{constructor(e=null){super({name:"MaskMaterial",uniforms:{maskTexture:new we(e),inputBuffer:new we(null),strength:new we(1)},blending:Ir,depthWrite:!1,depthTest:!1,fragmentShader:Fue,vertexShader:bm}),this.toneMapped=!1,this.setColorChannel(Mk.RED),this.setMaskFunction(Ek.DISCARD)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}set maskTexture(e){this.uniforms.maskTexture.value=e,delete this.defines.MASK_PRECISION_HIGH,e.type!==Si&&(this.defines.MASK_PRECISION_HIGH="1"),this.needsUpdate=!0}setMaskTexture(e){this.maskTexture=e}set colorChannel(e){this.defines.COLOR_CHANNEL=e.toFixed(0),this.needsUpdate=!0}setColorChannel(e){this.colorChannel=e}set maskFunction(e){this.defines.MASK_FUNCTION=e.toFixed(0),this.needsUpdate=!0}setMaskFunction(e){this.maskFunction=e}get inverted(){return this.defines.INVERTED!==void 0}set inverted(e){this.inverted&&!e?delete this.defines.INVERTED:e&&(this.defines.INVERTED="1"),this.needsUpdate=!0}isInverted(){return this.inverted}setInverted(e){this.inverted=e}get strength(){return this.uniforms.strength.value}set strength(e){this.uniforms.strength.value=e}getStrength(){return this.strength}setStrength(e){this.strength=e}},jue=`#define sampleLevelZeroOffset(t, coord, offset) texture2D(t, coord + offset * texelSize)
#if __VERSION__ < 300
#define round(v) floor(v + 0.5)
#endif
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform lowp sampler2D areaTexture;uniform lowp sampler2D searchTexture;uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}vec2 decodeDiagBilinearAccess(in vec2 e){e.r=e.r*abs(5.0*e.r-5.0*0.75);return round(e);}vec4 decodeDiagBilinearAccess(in vec4 e){e.rb=e.rb*abs(5.0*e.rb-5.0*0.75);return round(e);}vec2 searchDiag1(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 searchDiag2(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);coord.x+=0.25*texelSize.x;vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;e=decodeDiagBilinearAccess(e);coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 areaDiag(const in vec2 dist,const in vec2 e,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE_DIAG,AREATEX_MAX_DISTANCE_DIAG)*e+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.x+=0.5;texCoord.y+=AREATEX_SUBTEX_SIZE*offset;return texture2D(areaTexture,texCoord).rg;}vec2 calculateDiagWeights(const in vec2 texCoord,const in vec2 e,const in vec4 subsampleIndices){vec2 weights=vec2(0.0);vec4 d;vec2 end;if(e.r>0.0){d.xz=searchDiag1(texCoord,vec2(-1.0,1.0),end);d.x+=float(end.y>0.9);}else{d.xz=vec2(0.0);}d.yw=searchDiag1(texCoord,vec2(1.0,-1.0),end);if(d.x+d.y>2.0){vec4 coords=vec4(-d.x+0.25,d.x,d.y,-d.y-0.25)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.xy=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).rg;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).rg;c.yxwz=decodeDiagBilinearAccess(c.xyzw);vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.z);}d.xz=searchDiag2(texCoord,vec2(-1.0,-1.0),end);if(sampleLevelZeroOffset(inputBuffer,texCoord,vec2(1,0)).r>0.0){d.yw=searchDiag2(texCoord,vec2(1.0),end);d.y+=float(end.y>0.9);}else{d.yw=vec2(0.0);}if(d.x+d.y>2.0){vec4 coords=vec4(-d.x,-d.x,d.y,d.y)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.x=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).g;c.y=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(0,-1)).r;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).gr;vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.w).gr;}return weights;}float searchLength(const in vec2 e,const in float offset){vec2 scale=SEARCHTEX_SIZE*vec2(0.5,-1.0);vec2 bias=SEARCHTEX_SIZE*vec2(offset,1.0);scale+=vec2(-1.0,1.0);bias+=vec2(0.5,-0.5);scale*=1.0/SEARCHTEX_PACKED_SIZE;bias*=1.0/SEARCHTEX_PACKED_SIZE;return texture2D(searchTexture,scale*e+bias).r;}float searchXLeft(in vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x>end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(-2.0,0.0)*texelSize+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.0)+3.25;return texelSize.x*offset+texCoord.x;}float searchXRight(vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x<end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(2.0,0.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.5)+3.25;return-texelSize.x*offset+texCoord.x;}float searchYUp(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.y>end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=-vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.0)+3.25;return texelSize.y*offset+texCoord.y;}float searchYDown(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;i++){if(!(texCoord.y<end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.5)+3.25;return-texelSize.y*offset+texCoord.y;}vec2 area(const in vec2 dist,const in float e1,const in float e2,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE)*round(4.0*vec2(e1,e2))+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.y=AREATEX_SUBTEX_SIZE*offset+texCoord.y;return texture2D(areaTexture,texCoord).rg;}void detectHorizontalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){
#if !defined(DISABLE_CORNER_DETECTION)
vec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,1)).r;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).r;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,-2)).r;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,-2)).r;weights*=clamp(factor,0.0,1.0);
#endif
}void detectVerticalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){
#if !defined(DISABLE_CORNER_DETECTION)
vec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(1,0)).g;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).g;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(-2,0)).g;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(-2,1)).g;weights*=clamp(factor,0.0,1.0);
#endif
}void main(){vec4 weights=vec4(0.0);vec4 subsampleIndices=vec4(0.0);vec2 e=texture2D(inputBuffer,vUv).rg;if(e.g>0.0){
#if !defined(DISABLE_DIAG_DETECTION)
weights.rg=calculateDiagWeights(vUv,e,subsampleIndices);if(weights.r==-weights.g){
#endif
vec2 d;vec3 coords;coords.x=searchXLeft(vOffset[0].xy,vOffset[2].x);coords.y=vOffset[1].y;d.x=coords.x;float e1=texture2D(inputBuffer,coords.xy).r;coords.z=searchXRight(vOffset[0].zw,vOffset[2].y);d.y=coords.z;d=round(resolution.xx*d+-vPixCoord.xx);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.zy,vec2(1,0)).r;weights.rg=area(sqrtD,e1,e2,subsampleIndices.y);coords.y=vUv.y;detectHorizontalCornerPattern(weights.rg,coords.xyzy,d);
#if !defined(DISABLE_DIAG_DETECTION)
}else{e.r=0.0;}
#endif
}if(e.r>0.0){vec2 d;vec3 coords;coords.y=searchYUp(vOffset[1].xy,vOffset[2].z);coords.x=vOffset[0].x;d.x=coords.y;float e1=texture2D(inputBuffer,coords.xy).g;coords.z=searchYDown(vOffset[1].zw,vOffset[2].w);d.y=coords.z;d=round(resolution.yy*d-vPixCoord.yy);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.xz,vec2(0,1)).g;weights.ba=area(sqrtD,e1,e2,subsampleIndices.x);coords.x=vUv.x;detectVerticalCornerPattern(weights.ba,coords.xyxz,d);}gl_FragColor=weights;}`,Vue="uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void main(){vUv=position.xy*0.5+0.5;vPixCoord=vUv*resolution;vOffset[0]=vUv.xyxy+texelSize.xyxy*vec4(-0.25,-0.125,1.25,-0.125);vOffset[1]=vUv.xyxy+texelSize.xyxy*vec4(-0.125,-0.25,-0.125,1.25);vOffset[2]=vec4(vOffset[0].xz,vOffset[1].yw)+vec4(-2.0,2.0,-2.0,2.0)*texelSize.xxyy*MAX_SEARCH_STEPS_FLOAT;gl_Position=vec4(position.xy,1.0,1.0);}",Hue=class extends Yt{constructor(e=new W,t=new W){super({name:"SMAAWeightsMaterial",defines:{MAX_SEARCH_STEPS_INT:"16",MAX_SEARCH_STEPS_FLOAT:"16.0",MAX_SEARCH_STEPS_DIAG_INT:"8",MAX_SEARCH_STEPS_DIAG_FLOAT:"8.0",CORNER_ROUNDING:"25",CORNER_ROUNDING_NORM:"0.25",AREATEX_MAX_DISTANCE:"16.0",AREATEX_MAX_DISTANCE_DIAG:"20.0",AREATEX_PIXEL_SIZE:"(1.0 / vec2(160.0, 560.0))",AREATEX_SUBTEX_SIZE:"(1.0 / 7.0)",SEARCHTEX_SIZE:"vec2(66.0, 33.0)",SEARCHTEX_PACKED_SIZE:"vec2(64.0, 16.0)"},uniforms:{inputBuffer:new we(null),searchTexture:new we(null),areaTexture:new we(null),resolution:new we(t),texelSize:new we(e)},blending:Ir,depthWrite:!1,depthTest:!1,fragmentShader:jue,vertexShader:Vue}),this.toneMapped=!1}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get searchTexture(){return this.uniforms.searchTexture.value}set searchTexture(e){this.uniforms.searchTexture.value=e}get areaTexture(){return this.uniforms.areaTexture.value}set areaTexture(e){this.uniforms.areaTexture.value=e}setLookupTextures(e,t){this.searchTexture=e,this.areaTexture=t}get orthogonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_INT)}set orthogonalSearchSteps(e){let t=Math.min(Math.max(e,0),112);this.defines.MAX_SEARCH_STEPS_INT=t.toFixed("0"),this.defines.MAX_SEARCH_STEPS_FLOAT=t.toFixed("1"),this.needsUpdate=!0}setOrthogonalSearchSteps(e){this.orthogonalSearchSteps=e}get diagonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_DIAG_INT)}set diagonalSearchSteps(e){let t=Math.min(Math.max(e,0),20);this.defines.MAX_SEARCH_STEPS_DIAG_INT=t.toFixed("0"),this.defines.MAX_SEARCH_STEPS_DIAG_FLOAT=t.toFixed("1"),this.needsUpdate=!0}setDiagonalSearchSteps(e){this.diagonalSearchSteps=e}get diagonalDetection(){return this.defines.DISABLE_DIAG_DETECTION===void 0}set diagonalDetection(e){e?delete this.defines.DISABLE_DIAG_DETECTION:this.defines.DISABLE_DIAG_DETECTION="1",this.needsUpdate=!0}isDiagonalDetectionEnabled(){return this.diagonalDetection}setDiagonalDetectionEnabled(e){this.diagonalDetection=e}get cornerRounding(){return Number(this.defines.CORNER_ROUNDING)}set cornerRounding(e){let t=Math.min(Math.max(e,0),100);this.defines.CORNER_ROUNDING=t.toFixed("4"),this.defines.CORNER_ROUNDING_NORM=(t/100).toFixed("4"),this.needsUpdate=!0}setCornerRounding(e){this.cornerRounding=e}get cornerDetection(){return this.defines.DISABLE_CORNER_DETECTION===void 0}set cornerDetection(e){e?delete this.defines.DISABLE_CORNER_DETECTION:this.defines.DISABLE_CORNER_DETECTION="1",this.needsUpdate=!0}isCornerRoundingEnabled(){return this.cornerDetection}setCornerRoundingEnabled(e){this.cornerDetection=e}setSize(e,t){let r=this.uniforms;r.texelSize.value.set(1/e,1/t),r.resolution.value.set(e,t)}},Gue=new dd,To=null;function Wue(){if(To===null){let e=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),t=new Float32Array([0,0,2,0,0,2]);To=new it,To.setAttribute!==void 0?(To.setAttribute("position",new nt(e,3)),To.setAttribute("uv",new nt(t,2))):(To.addAttribute("position",new nt(e,3)),To.addAttribute("uv",new nt(t,2)))}return To}var Vi=class{constructor(e="Pass",t=new pl,r=Gue){this.name=e,this.renderer=null,this.scene=t,this.camera=r,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(e){if(this.rtt===e){let t=this.getFullscreenMaterial();t!==null&&(t.needsUpdate=!0),this.rtt=!e}}setRenderer(e){this.renderer=e}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(e){let t=this.screen;t!==null?t.material=e:(t=new Ki(Wue(),e),t.frustumCulled=!1,this.scene===null&&(this.scene=new pl),this.scene.add(t),this.screen=t)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(e){this.fullscreenMaterial=e}getDepthTexture(){return null}setDepthTexture(e,t=vo){}render(e,t,r,i,n){throw new Error("Render method not implemented!")}setSize(e,t){}initialize(e,t,r){}dispose(){for(let e of Object.keys(this)){let t=this[e];if(t!==null&&typeof t.dispose=="function"){if(t instanceof pl||t===this.renderer)continue;this[e].dispose()}}}},D_=class extends Vi{constructor(e,t=!0){super("CopyPass"),this.fullscreenMaterial=new Due,this.needsSwap=!1,this.renderTarget=e,e===void 0&&(this.renderTarget=new Ut(1,1,{minFilter:vt,magFilter:vt,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=t}get resize(){return this.autoResize}set resize(e){this.autoResize=e}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(e){this.autoResize=e}render(e,t,r,i,n){this.fullscreenMaterial.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){this.autoResize&&this.renderTarget.setSize(e,t)}initialize(e,t,r){r!==void 0&&(this.renderTarget.texture.type=r,r!==Si?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":e.outputEncoding===ut&&(this.renderTarget.texture.encoding=ut))}},que=class extends Vi{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(e,t,r,i,n){let s=e.state.buffers.stencil;s.setLocked(!1),s.setTest(!1)}},Aw=new $e,OA=class extends Vi{constructor(e=!0,t=!0,r=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=e,this.depth=t,this.stencil=r,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(e,t,r){this.color=e,this.depth=t,this.stencil=r}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(e){this.overrideClearColor=e}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(e){this.overrideClearAlpha=e}render(e,t,r,i,n){let s=this.overrideClearColor,a=this.overrideClearAlpha,o=e.getClearAlpha(),l=s!==null,c=a>=0;l?(Aw.copy(e.getClearColor(Aw)),e.setClearColor(s,c?a:o)):c&&e.setClearAlpha(a),e.setRenderTarget(this.renderToScreen?null:t),e.clear(this.color,this.depth,this.stencil),l?e.setClearColor(Aw,o):c&&e.setClearAlpha(o)}},Po=-1,$i=class extends ui{constructor(e,t=Po,r=Po,i=1){super(),this.resizable=e,this.base=new W(1,1),this.preferred=new W(t,r),this.target=this.preferred,this.s=i}get width(){let{base:e,preferred:t,scale:r}=this,i;return t.width!==Po?i=t.width:t.height!==Po?i=Math.round(t.height*(e.width/Math.max(e.height,1))):i=Math.round(e.width*r),i}set width(e){this.preferredWidth=e}get height(){let{base:e,preferred:t,scale:r}=this,i;return t.height!==Po?i=t.height:t.width!==Po?i=Math.round(t.width/Math.max(e.width/Math.max(e.height,1),1)):i=Math.round(e.height*r),i}set height(e){this.preferredHeight=e}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(e){this.s!==e&&(this.s=e,this.preferred.setScalar(Po),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getScale(){return this.scale}setScale(e){this.scale=e}get baseWidth(){return this.base.width}set baseWidth(e){this.base.width!==e&&(this.base.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseWidth(){return this.base.width}setBaseWidth(e){this.base.width!==e&&(this.base.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get baseHeight(){return this.base.height}set baseHeight(e){this.base.height!==e&&(this.base.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(e){this.baseHeight=e}setBaseSize(e,t){(this.base.width!==e||this.base.height!==t)&&(this.base.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get preferredWidth(){return this.preferred.width}set preferredWidth(e){this.preferred.width!==e&&(this.preferred.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(e){this.preferredWidth=e}get preferredHeight(){return this.preferred.height}set preferredHeight(e){this.preferred.height!==e&&(this.preferred.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(e){this.preferredHeight=e}setPreferredSize(e,t){(this.preferred.width!==e||this.preferred.height!==t)&&(this.preferred.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}copy(e){this.base.set(e.getBaseWidth(),e.getBaseHeight()),this.preferred.set(e.getPreferredWidth(),e.getPreferredHeight()),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height)}static get AUTO_SIZE(){return Po}},Cw=!1,XD=class{constructor(e=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(e),this.meshCount=0,this.replaceMaterial=t=>{if(t.isMesh){let r;if(t.material.flatShading)switch(t.material.side){case yn:r=this.materialsFlatShadedDoubleSide;break;case $r:r=this.materialsFlatShadedBackSide;break;default:r=this.materialsFlatShaded;break}else switch(t.material.side){case yn:r=this.materialsDoubleSide;break;case $r:r=this.materialsBackSide;break;default:r=this.materials;break}this.originalMaterials.set(t,t.material),t.isSkinnedMesh?t.material=r[2]:t.isInstancedMesh?t.material=r[1]:t.material=r[0],++this.meshCount}}}setMaterial(e){if(this.disposeMaterials(),this.material=e,e!==null){let t=this.materials=[e.clone(),e.clone(),e.clone()];for(let r of t)r.uniforms=Object.assign({},e.uniforms),r.side=Ds;t[2].skinning=!0,this.materialsBackSide=t.map(r=>{let i=r.clone();return i.uniforms=Object.assign({},e.uniforms),i.side=$r,i}),this.materialsDoubleSide=t.map(r=>{let i=r.clone();return i.uniforms=Object.assign({},e.uniforms),i.side=yn,i}),this.materialsFlatShaded=t.map(r=>{let i=r.clone();return i.uniforms=Object.assign({},e.uniforms),i.flatShading=!0,i}),this.materialsFlatShadedBackSide=t.map(r=>{let i=r.clone();return i.uniforms=Object.assign({},e.uniforms),i.flatShading=!0,i.side=$r,i}),this.materialsFlatShadedDoubleSide=t.map(r=>{let i=r.clone();return i.uniforms=Object.assign({},e.uniforms),i.flatShading=!0,i.side=yn,i})}}render(e,t,r){let i=e.shadowMap.enabled;if(e.shadowMap.enabled=!1,Cw){let n=this.originalMaterials;this.meshCount=0,t.traverse(this.replaceMaterial),e.render(t,r);for(let s of n)s[0].material=s[1];this.meshCount!==n.size&&n.clear()}else{let n=t.overrideMaterial;t.overrideMaterial=this.material,e.render(t,r),t.overrideMaterial=n}e.shadowMap.enabled=i}disposeMaterials(){if(this.material!==null){let e=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(let t of e)t.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return Cw}static set workaroundEnabled(e){Cw=e}},Xue=class extends Vi{constructor(e,t,r=null){super("RenderPass",e,t),this.needsSwap=!1,this.clearPass=new OA,this.overrideMaterialManager=r===null?null:new XD(r),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}get renderToScreen(){return super.renderToScreen}set renderToScreen(e){super.renderToScreen=e,this.clearPass.renderToScreen=e}get overrideMaterial(){let e=this.overrideMaterialManager;return e!==null?e.material:null}set overrideMaterial(e){let t=this.overrideMaterialManager;e!==null?t!==null?t.setMaterial(e):this.overrideMaterialManager=new XD(e):t!==null&&(t.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(e){this.overrideMaterial=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getSelection(){return this.selection}setSelection(e){this.selection=e}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(e){this.ignoreBackground=e}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(e){this.skipShadowMapUpdate=e}getClearPass(){return this.clearPass}render(e,t,r,i,n){let s=this.scene,a=this.camera,o=this.selection,l=a.layers.mask,c=s.background,u=e.shadowMap.autoUpdate,h=this.renderToScreen?null:t;o!==null&&a.layers.set(o.getLayer()),this.skipShadowMapUpdate&&(e.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(s.background=null),this.clearPass.enabled&&this.clearPass.render(e,t),e.setRenderTarget(h),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(e,s,a):e.render(s,a),a.layers.mask=l,s.background=c,e.shadowMap.autoUpdate=u}},YD=class extends Vi{constructor(e,t,{resolutionScale:r=1,width:i=$i.AUTO_SIZE,height:n=$i.AUTO_SIZE,renderTarget:s}={}){super("DepthPass"),this.needsSwap=!1,this.renderPass=new Xue(e,t,new AR({depthPacking:hR}));let a=this.renderPass;a.skipShadowMapUpdate=!0,a.ignoreBackground=!0;let o=a.getClearPass();o.overrideClearColor=new $e(16777215),o.overrideClearAlpha=1,this.renderTarget=s,this.renderTarget===void 0&&(this.renderTarget=new Ut(1,1,{minFilter:Xt,magFilter:Xt,stencilBuffer:!1}),this.renderTarget.texture.name="DepthPass.Target");let l=this.resolution=new $i(this,i,n,r);l.addEventListener("change",c=>this.setSize(l.baseWidth,l.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,r,i,n){let s=this.renderToScreen?null:this.renderTarget;this.renderPass.render(e,s)}setSize(e,t){let r=this.resolution;r.setBaseSize(e,t),this.renderTarget.setSize(r.width,r.height)}},Ct={SKIP:0,ADD:1,ALPHA:2,AVERAGE:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,EXCLUSION:8,LIGHTEN:9,MULTIPLY:10,DIVIDE:11,NEGATION:12,NORMAL:13,OVERLAY:14,REFLECT:15,SCREEN:16,SOFT_LIGHT:17,SUBTRACT:18},Yue="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x+y,1.0)*opacity+x*(1.0-opacity);}",Que="vec3 blend(const in vec3 x,const in vec3 y,const in float opacity){return y*opacity+x*(1.0-opacity);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){float a=min(y.a,opacity);return vec4(blend(x.rgb,y.rgb,a),max(x.a,a));}",Kue="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y)*0.5*opacity+x*(1.0-opacity);}",Zue="float blend(const in float x,const in float y){return(y==0.0)?y:max(1.0-(1.0-x)/y,0.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",$ue="float blend(const in float x,const in float y){return(y==1.0)?y:min(x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",Jue="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x,y)*opacity+x*(1.0-opacity);}",ede="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return abs(x-y)*opacity+x*(1.0-opacity);}",tde="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y-2.0*x*y)*opacity+x*(1.0-opacity);}",rde="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x,y)*opacity+x*(1.0-opacity);}",ide="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return x*y*opacity+x*(1.0-opacity);}",nde="float blend(const in float x,const in float y){return(y>0.0)?min(x/y,1.0):1.0;}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",sde="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-abs(1.0-x-y))*opacity+x*(1.0-opacity);}",ade="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y*opacity+x*(1.0-opacity);}",ode="float blend(const in float x,const in float y){return(x<0.5)?(2.0*x*y):(1.0-2.0*(1.0-x)*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",lde="float blend(const in float x,const in float y){return(y==1.0)?y:min(x*x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",cde="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-(1.0-x)*(1.0-y))*opacity+x*(1.0-opacity);}",hde="float blend(const in float x,const in float y){return(y<0.5)?(2.0*x*y+x*x*(1.0-2.0*y)):(sqrt(x)*(2.0*y-1.0)+2.0*x*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",ude="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x+y-1.0,0.0)*opacity+x*(1.0-opacity);}",dde=new Map([[Ct.SKIP,null],[Ct.ADD,Yue],[Ct.ALPHA,Que],[Ct.AVERAGE,Kue],[Ct.COLOR_BURN,Zue],[Ct.COLOR_DODGE,$ue],[Ct.DARKEN,Jue],[Ct.DIFFERENCE,ede],[Ct.EXCLUSION,tde],[Ct.LIGHTEN,rde],[Ct.MULTIPLY,ide],[Ct.DIVIDE,nde],[Ct.NEGATION,sde],[Ct.NORMAL,ade],[Ct.OVERLAY,ode],[Ct.REFLECT,lde],[Ct.SCREEN,cde],[Ct.SOFT_LIGHT,hde],[Ct.SUBTRACT,ude]]),pde=class extends ui{constructor(e,t=1){super(),this.f=e,this.opacity=new we(t)}getOpacity(){return this.opacity.value}setOpacity(e){this.opacity.value=e}get blendFunction(){return this.f}set blendFunction(e){this.f=e,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(e){this.blendFunction=e}getShaderCode(){return dde.get(this.blendFunction)}},da={NONE:0,DEPTH:1,CONVOLUTION:2},ba=class extends ui{constructor(e,t,{attributes:r=da.NONE,blendFunction:i=Ct.SCREEN,defines:n=new Map,uniforms:s=new Map,extensions:a=null,vertexShader:o=null}={}){super(),this.name=e,this.renderer=null,this.attributes=r,this.fragmentShader=t,this.vertexShader=o,this.defines=n,this.uniforms=s,this.extensions=a,this.blendMode=new pde(i),this.blendMode.addEventListener("change",l=>this.setChanged())}getName(){return this.name}setRenderer(e){this.renderer=e}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(e){this.attributes=e,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(e){this.fragmentShader=e,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(e){this.vertexShader=e,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(e,t=vo){}update(e,t,r){}setSize(e,t){}initialize(e,t,r){}dispose(){for(let e of Object.keys(this)){let t=this[e];if(t!==null&&typeof t.dispose=="function"){if(t instanceof pl||t===this.renderer)continue;this[e].dispose()}}}};function QD(e,t,r){for(let i of t){let n="$1"+e+i.charAt(0).toUpperCase()+i.slice(1),s=new RegExp("([^\\.])(\\b"+i+"\\b)","g");for(let a of r.entries())a[1]!==null&&r.set(a[0],a[1].replace(s,n))}}function fde(e,t,r,i,n,s,a){let o=new Map([["fragment",t.getFragmentShader()],["vertex",t.getVertexShader()]]),l=o.get("fragment")!==void 0&&/mainImage/.test(o.get("fragment")),c=o.get("fragment")!==void 0&&/mainUv/.test(o.get("fragment")),u=[],h=[],d=!1,p=!1;if(o.get("fragment")===void 0)console.error("Missing fragment shader",t);else if(c&&a&da.CONVOLUTION)console.error("Effects that transform UV coordinates are incompatible with convolution effects",t);else if(!l&&!c)console.error("The fragment shader contains neither a mainImage nor a mainUv function",t);else{let f=/(?:\w+\s+(\w+)\([\w\s,]*\)\s*{[^}]+})/g,m=P_.Section;if(c){let v=`	${e}MainUv(UV);
`;r.set(m.FRAGMENT_MAIN_UV,r.get(m.FRAGMENT_MAIN_UV)+v),d=!0}if(o.get("vertex")!==null&&/mainSupport/.test(o.get("vertex"))){let v=`	${e}MainSupport(`;v+=/mainSupport *\([\w\s]*?uv\s*?\)/.test(o.get("vertex"))?`vUv);
`:`);
`,r.set(m.VERTEX_MAIN_SUPPORT,r.get(m.VERTEX_MAIN_SUPPORT)+v),u=u.concat([...o.get("vertex").matchAll(/(?:varying\s+\w+\s+(\w*))/g)].map(y=>y[1])),h=h.concat(u).concat([...o.get("vertex").matchAll(f)].map(y=>y[1]))}h=h.concat([...o.get("fragment").matchAll(f)].map(v=>v[1])),h=h.concat([...t.defines.keys()].map(v=>v.replace(/\([\w\s,]*\)/g,""))),h=h.concat([...t.uniforms.keys()]),t.uniforms.forEach((v,y)=>s.set(e+y.charAt(0).toUpperCase()+y.slice(1),v)),t.defines.forEach((v,y)=>n.set(e+y.charAt(0).toUpperCase()+y.slice(1),v)),QD(e,h,n),QD(e,h,o);let g=t.blendMode;if(i.set(g.blendFunction,g),l){let v=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/,y=`${e}MainImage(color0, UV, `;a&da.DEPTH&&v.test(o.get("fragment"))&&(y+="depth, ",p=!0),y+=`color1);
	`;let x=e+"BlendOpacity";s.set(x,g.opacity),y+=`color0 = blend${g.blendFunction}(color0, color1, ${x});

	`,r.set(m.FRAGMENT_MAIN_IMAGE,r.get(m.FRAGMENT_MAIN_IMAGE)+y),y=`uniform float ${x};

`,r.set(m.FRAGMENT_HEAD,r.get(m.FRAGMENT_HEAD)+y)}r.set(m.FRAGMENT_HEAD,r.get(m.FRAGMENT_HEAD)+o.get("fragment")+`
`),o.get("vertex")!==null&&r.set(m.VERTEX_HEAD,r.get(m.VERTEX_HEAD)+o.get("vertex")+`
`)}return{varyings:u,transformedUv:d,readDepth:p}}var ay=class extends Vi{constructor(e,...t){super("EffectPass"),this.fullscreenMaterial=new P_(null,null,null,e),this.effects=t.sort((r,i)=>i.attributes-r.attributes),this.skipRendering=!1,this.uniformCount=0,this.varyingCount=0,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(e){this.fullscreenMaterial.encodeOutput=e}get dithering(){return this.fullscreenMaterial.dithering}set dithering(e){let t=this.fullscreenMaterial;t.dithering=e,t.needsUpdate=!0}verifyResources(){let e=this.renderer.capabilities,t=Math.min(e.maxFragmentUniforms,e.maxVertexUniforms);this.uniformCount>t&&console.warn("The current rendering context doesn't support more than "+t+" uniforms, but "+this.uniformCount+" were defined"),t=e.maxVaryings,this.varyingCount>t&&console.warn("The current rendering context doesn't support more than "+t+" varyings, but "+this.varyingCount+" were defined")}updateMaterial(){let e=P_.Section,t=new Map([[e.FRAGMENT_HEAD,""],[e.FRAGMENT_MAIN_UV,""],[e.FRAGMENT_MAIN_IMAGE,""],[e.VERTEX_HEAD,""],[e.VERTEX_MAIN_SUPPORT,""]]),r=new Map,i=new Map,n=new Map,s=new Set,a=0,o=0,l=0,c=!1,u=!1;for(let d of this.effects)if(d.blendMode.blendFunction===Ct.SKIP)l|=d.getAttributes()&da.DEPTH;else if(l&d.getAttributes()&da.CONVOLUTION)console.error("Convolution effects cannot be merged",d);else{l|=d.getAttributes();let p="e"+a++,f=fde(p,d,t,r,i,n,l);if(o+=f.varyings.length,c=c||f.transformedUv,u=u||f.readDepth,d.extensions!==null)for(let m of d.extensions)s.add(m)}let h=/\bblend\b/g;for(let d of r.values()){let p=d.getShaderCode().replace(h,`blend${d.blendFunction}`);t.set(e.FRAGMENT_HEAD,t.get(e.FRAGMENT_HEAD)+p+`
`)}if(l&da.DEPTH){if(u){let d=`float depth = readDepth(UV);

	`;t.set(e.FRAGMENT_MAIN_IMAGE,d+t.get(e.FRAGMENT_MAIN_IMAGE))}this.needsDepthTexture=this.getDepthTexture()===null}else this.needsDepthTexture=!1;if(c){let d=`vec2 transformedUv = vUv;
`;t.set(e.FRAGMENT_MAIN_UV,d+t.get(e.FRAGMENT_MAIN_UV)),i.set("UV","transformedUv")}else i.set("UV","vUv");t.forEach((d,p,f)=>f.set(p,d.trim().replace(/^#/,`
#`))),this.uniformCount=n.size,this.varyingCount=o,this.skipRendering=a===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderParts(t).setExtensions(s).setUniforms(n).setDefines(i)}recompile(){this.updateMaterial(),this.verifyResources()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(e,t=vo){this.fullscreenMaterial.depthBuffer=e,this.fullscreenMaterial.depthPacking=t;for(let r of this.effects)r.setDepthTexture(e,t)}render(e,t,r,i,n){for(let s of this.effects)s.update(e,t,i);if(!this.skipRendering||this.renderToScreen){let s=this.fullscreenMaterial;s.inputBuffer=t.texture,s.time+=i,e.setRenderTarget(this.renderToScreen?null:r),e.render(this.scene,this.camera)}}setSize(e,t){this.fullscreenMaterial.setSize(e,t);for(let r of this.effects)r.setSize(e,t)}initialize(e,t,r){this.renderer=e;for(let i of this.effects)i.initialize(e,t,r),i.addEventListener("change",n=>this.handleEvent(n));this.updateMaterial(),this.verifyResources(),r!==void 0&&r!==Si&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(let e of this.effects)e.dispose()}handleEvent(e){switch(e.type){case"change":this.recompile();break}}},mde=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],Tk=class extends Vi{constructor({resolutionScale:e=.5,width:t=$i.AUTO_SIZE,height:r=$i.AUTO_SIZE,kernelSize:i=RA.LARGE}={}){super("KawaseBlurPass"),this.renderTargetA=new Ut(1,1,{minFilter:vt,magFilter:vt,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";let n=this.resolution=new $i(this,t,r,e);n.addEventListener("change",s=>this.setSize(n.baseWidth,n.baseHeight)),this.blurMaterial=new qD,this.ditheredBlurMaterial=new qD,this.ditheredBlurMaterial.uniforms.scale=this.blurMaterial.uniforms.scale,this.ditheredBlurMaterial.dithering=!0,this.dithering=!1,this.kernelSize=i}getResolution(){return this.resolution}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get scale(){return this.blurMaterial.scale}set scale(e){this.blurMaterial.scale=e}getScale(){return this.blurMaterial.scale}setScale(e){this.blurMaterial.scale=e}getKernelSize(){return this.kernelSize}setKernelSize(e){this.kernelSize=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,r,i,n){let s=this.scene,a=this.camera,o=this.renderTargetA,l=this.renderTargetB,c=mde[this.kernelSize],u=this.blurMaterial,h=t,d,p;for(this.fullscreenMaterial=u,d=0,p=c.length-1;d<p;++d){let f=d&1?l:o;u.kernel=c[d],u.inputBuffer=h.texture,e.setRenderTarget(f),e.render(s,a),h=f}this.dithering&&(u=this.ditheredBlurMaterial,this.fullscreenMaterial=u),u.kernel=c[d],u.inputBuffer=h.texture,e.setRenderTarget(this.renderToScreen?null:r),e.render(s,a)}setSize(e,t){let r=this.resolution;r.setBaseSize(e,t);let i=r.width,n=r.height;this.renderTargetA.setSize(i,n),this.renderTargetB.setSize(i,n),this.blurMaterial.setSize(i,n),this.ditheredBlurMaterial.setSize(i,n)}initialize(e,t,r){r!==void 0&&(this.renderTargetA.texture.type=r,this.renderTargetB.texture.type=r,r!==Si?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.ditheredBlurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):e.outputEncoding===ut&&(this.renderTargetA.texture.encoding=ut,this.renderTargetB.texture.encoding=ut))}static get AUTO_SIZE(){return $i.AUTO_SIZE}},gde=class extends Vi{constructor({width:e=$i.AUTO_SIZE,height:t=$i.AUTO_SIZE,renderTarget:r,luminanceRange:i,colorOutput:n}={}){super("LuminancePass"),this.fullscreenMaterial=new Nue(n,i),this.needsSwap=!1,this.renderTarget=r,this.renderTarget===void 0&&(this.renderTarget=new Ut(1,1,{minFilter:vt,magFilter:vt,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target",this.renderTarget.texture.generateMipmaps=!1);let s=this.resolution=new $i(this,e,t);s.addEventListener("change",a=>this.setSize(s.baseWidth,s.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(e,t,r,i,n){let s=this.fullscreenMaterial;s.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){let r=this.resolution;r.setBaseSize(e,t),this.renderTarget.setSize(r.width,r.height)}initialize(e,t,r){r!==void 0&&r!==Si&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},vde=class extends Vi{constructor(e,t){super("MaskPass",e,t),this.needsSwap=!1,this.clearPass=new OA(!1,!1,!0),this.inverse=!1}get inverted(){return this.inverse}set inverted(e){this.inverse=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(e){this.inverted=e}render(e,t,r,i,n){let s=e.getContext(),a=e.state.buffers,o=this.scene,l=this.camera,c=this.clearPass,u=this.inverted?0:1,h=1-u;a.color.setMask(!1),a.depth.setMask(!1),a.color.setLocked(!0),a.depth.setLocked(!0),a.stencil.setTest(!0),a.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),a.stencil.setFunc(s.ALWAYS,u,4294967295),a.stencil.setClear(h),a.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?c.render(e,null):(c.render(e,t),c.render(e,r))),this.renderToScreen?(e.setRenderTarget(null),e.render(o,l)):(e.setRenderTarget(t),e.render(o,l),e.setRenderTarget(r),e.render(o,l)),a.color.setLocked(!1),a.depth.setLocked(!1),a.stencil.setLocked(!1),a.stencil.setFunc(s.EQUAL,1,4294967295),a.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),a.stencil.setLocked(!0)}},Js=class extends Vi{constructor(e,t="inputBuffer"){super("ShaderPass"),this.fullscreenMaterial=e,this.inputBufferUniform=null,this.setInput(t)}setInput(e){if(this.inputBufferUniform=null,this.fullscreenMaterial!==null){let t=this.fullscreenMaterial.uniforms;t!==void 0&&t[e]!==void 0&&(this.inputBufferUniform=t[e])}}render(e,t,r,i,n){this.inputBufferUniform!==null&&t!==null&&(this.inputBufferUniform.value=t.texture),e.setRenderTarget(this.renderToScreen?null:r),e.render(this.scene,this.camera)}initialize(e,t,r){r!==void 0&&r!==Si&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},Mw=1/1e3,yde=1e3,xde=class{constructor(){this.previousTime=0,this.currentTime=0,this.delta=0,this.fixedDelta=1e3/60,this.elapsed=0,this.timescale=1,this.fixedDeltaEnabled=!1,this.autoReset=!1}setFixedDeltaEnabled(e){return this.fixedDeltaEnabled=e,this}isAutoResetEnabled(e){return this.autoReset}setAutoResetEnabled(e){return typeof document<"u"&&document.hidden!==void 0&&(e?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this.autoReset=e),this}getDelta(){return this.delta*Mw}getFixedDelta(){return this.fixedDelta*Mw}setFixedDelta(e){return this.fixedDelta=e*yde,this}getElapsed(){return this.elapsed*Mw}getTimescale(){return this.timescale}setTimescale(e){return this.timescale=e,this}update(e){return this.fixedDeltaEnabled?this.delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=e!==void 0?e:performance.now(),this.delta=this.currentTime-this.previousTime),this.delta*=this.timescale,this.elapsed+=this.delta,this}reset(){return this.delta=0,this.elapsed=0,this.currentTime=performance.now(),this}handleEvent(e){document.hidden||(this.currentTime=performance.now())}dispose(){this.setAutoResetEnabled(!1)}},RA={VERY_SMALL:0,SMALL:1,MEDIUM:2,LARGE:3,VERY_LARGE:4,HUGE:5},wde=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D map;
#else
uniform lowp sampler2D map;
#endif
uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=clamp(texture2D(map,uv)*intensity,0.0,1.0);}`,bde=class extends ba{constructor({blendFunction:e=Ct.SCREEN,luminanceThreshold:t=.9,luminanceSmoothing:r=.025,resolutionScale:i=.5,intensity:n=1,width:s=$i.AUTO_SIZE,height:a=$i.AUTO_SIZE,kernelSize:o=RA.LARGE}={}){super("BloomEffect",wde,{blendFunction:e,uniforms:new Map([["map",new we(null)],["intensity",new we(n)]])}),this.renderTarget=new Ut(1,1,{minFilter:vt,magFilter:vt,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.renderTarget.texture.generateMipmaps=!1,this.uniforms.get("map").value=this.renderTarget.texture,this.luminancePass=new gde({renderTarget:this.renderTarget,colorOutput:!0}),this.luminanceMaterial.threshold=t,this.luminanceMaterial.smoothingFactor=r,this.blurPass=new Tk({resolutionScale:i,width:s,height:a,kernelSize:o});let l=this.blurPass.getResolution();l.addEventListener("change",c=>this.setSize(l.baseWidth,l.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}get resolution(){return this.blurPass.resolution}getResolution(){return this.blurPass.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get dithering(){return this.blurPass.dithering}set dithering(e){this.blurPass.dithering=e}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(e){this.blurPass.kernelSize=e}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(e){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(e){this.uniforms.get("intensity").value=e}getIntensity(){return this.intensity}setIntensity(e){this.intensity=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}update(e,t,r){let i=this.renderTarget;this.luminancePass.enabled?(this.luminancePass.render(e,t,i),this.blurPass.render(e,i,i)):this.blurPass.render(e,t,i)}setSize(e,t){let r=this.resolution;r.setBaseSize(e,t),this.renderTarget.setSize(r.width,r.height),this.luminancePass.resolution.copy(r)}initialize(e,t,r){this.blurPass.initialize(e,t,r),r!==void 0&&(this.renderTarget.texture.type=r,e.outputEncoding===ut&&(this.renderTarget.texture.encoding=ut))}},_de="uniform float brightness;uniform float contrast;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=inputColor.rgb+vec3(brightness-0.5);if(contrast>0.0){color/=vec3(1.0-contrast);}else{color*=vec3(1.0+contrast);}outputColor=vec4(min(color+vec3(0.5),1.0),inputColor.a);}",Sde=class extends ba{constructor({blendFunction:e=Ct.NORMAL,brightness:t=0,contrast:r=0}={}){super("BrightnessContrastEffect",_de,{blendFunction:e,uniforms:new Map([["brightness",new we(t)],["contrast",new we(r)]])})}get brightness(){return this.uniforms.get("brightness").value}set brightness(e){this.uniforms.get("brightness").value=e}getBrightness(e){return this.brightness}setBrightness(e){this.brightness=e}get contrast(){return this.uniforms.get("contrast").value}set contrast(e){this.uniforms.get("contrast").value=e}getContrast(e){return this.contrast}setContrast(e){this.contrast=e}},Ade="void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=vec4(vec3(average(inputColor.rgb)),inputColor.a);}",Cde=class extends ba{constructor(e=Ct.NORMAL){super("ColorAverageEffect",Ade,{blendFunction:e})}},Mde="varying vec2 vUvR;varying vec2 vUvB;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec2 ra=texture2D(inputBuffer,vUvR).ra;vec2 ba=texture2D(inputBuffer,vUvB).ba;outputColor=vec4(ra.x,inputColor.g,ba.x,max(max(ra.y,ba.y),inputColor.a));}",Ede="uniform vec2 offset;varying vec2 vUvR;varying vec2 vUvB;void mainSupport(const in vec2 uv){vec2 shift=offset*vec2(1.0,aspect);vUvR=uv+shift;vUvB=uv-shift;}",Tde=class extends ba{constructor({blendFunction:e=Ct.NORMAL,offset:t=new W(.001,5e-4)}={}){super("ChromaticAberrationEffect",Mde,{vertexShader:Ede,blendFunction:e,attributes:da.CONVOLUTION,uniforms:new Map([["offset",new we(t)]])})}get offset(){return this.uniforms.get("offset").value}set offset(e){this.uniforms.get("offset").value=e}getOffset(){return this.offset}setOffset(e){this.offset=e}},Pde=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D nearColorBuffer;uniform mediump sampler2D farColorBuffer;
#else
uniform lowp sampler2D nearColorBuffer;uniform lowp sampler2D farColorBuffer;
#endif
uniform lowp sampler2D nearCoCBuffer;uniform float scale;void mainImage(const in vec4 inputColor,const in vec2 uv,const in float depth,out vec4 outputColor){vec4 colorNear=texture2D(nearColorBuffer,uv);vec4 colorFar=texture2D(farColorBuffer,uv);float CoCNear=texture2D(nearCoCBuffer,uv).r;CoCNear=min(CoCNear*scale,1.0);vec4 result=inputColor*(1.0-colorFar.a)+colorFar;result=mix(result,colorNear,CoCNear);outputColor=result;}`,Dde=class extends ba{constructor(e,{blendFunction:t=Ct.NORMAL,worldFocusDistance:r,worldFocusRange:i,focusDistance:n=0,focalLength:s=.1,focusRange:a=s,bokehScale:o=1,width:l=$i.AUTO_SIZE,height:c=$i.AUTO_SIZE}={}){super("DepthOfFieldEffect",Pde,{blendFunction:t,attributes:da.DEPTH,uniforms:new Map([["nearColorBuffer",new we(null)],["farColorBuffer",new we(null)],["nearCoCBuffer",new we(null)],["scale",new we(1)]])}),this.camera=e,this.renderTarget=new Ut(1,1,{minFilter:vt,magFilter:vt,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="DoF.Intermediate",this.renderTarget.texture.generateMipmaps=!1,this.renderTargetMasked=this.renderTarget.clone(),this.renderTargetMasked.texture.name="DoF.Masked.Far",this.renderTargetNear=this.renderTarget.clone(),this.renderTargetNear.texture.name="DoF.Bokeh.Near",this.uniforms.get("nearColorBuffer").value=this.renderTargetNear.texture,this.renderTargetFar=this.renderTarget.clone(),this.renderTargetFar.texture.name="DoF.Bokeh.Far",this.uniforms.get("farColorBuffer").value=this.renderTargetFar.texture,this.renderTargetCoC=this.renderTarget.clone(),this.renderTargetCoC.texture.name="DoF.CoC",this.renderTargetCoCBlurred=this.renderTargetCoC.clone(),this.renderTargetCoCBlurred.texture.name="DoF.CoC.Blurred",this.uniforms.get("nearCoCBuffer").value=this.renderTargetCoCBlurred.texture,this.cocPass=new Js(new Mue(e));let u=this.cocMaterial;u.focusDistance=n,u.focusRange=a,r!==void 0&&(u.worldFocusDistance=r),i!==void 0&&(u.worldFocusRange=i),this.blurPass=new Tk({kernelSize:RA.MEDIUM,width:l,height:c});let h=this.blurPass.getResolution();h.addEventListener("change",p=>this.setSize(h.getBaseWidth(),h.getBaseHeight())),this.maskPass=new Js(new Uue(this.renderTargetCoC.texture));let d=this.maskPass.fullscreenMaterial;d.maskFunction=Ek.MULTIPLY,d.colorChannel=Mk.GREEN,this.bokehNearBasePass=new Js(new Jg(!1,!0)),this.bokehNearBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehNearFillPass=new Js(new Jg(!0,!0)),this.bokehNearFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehFarBasePass=new Js(new Jg(!1,!1)),this.bokehFarBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.bokehFarFillPass=new Js(new Jg(!0,!1)),this.bokehFarFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.target=null,this.bokehScale=o}get cocTexture(){return this.renderTargetCoC.texture}get cocMaterial(){return this.cocPass.fullscreenMaterial}get circleOfConfusionMaterial(){return this.cocMaterial}getCircleOfConfusionMaterial(){return this.circleOfConfusionMaterial}getBlurPass(){return this.blurPass}get resolution(){return this.blurPass.getResolution()}getResolution(){return this.blurPass.getResolution()}get bokehScale(){return this.uniforms.get("scale").value}set bokehScale(e){let t=[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass];for(let r of t)r.fullscreenMaterial.setScale(e);this.maskPass.fullscreenMaterial.setStrength(e),this.uniforms.get("scale").value=e}getBokehScale(){return this.bokehScale}setBokehScale(e){this.bokehScale=e}getTarget(){return this.target}setTarget(e){this.target=e}calculateFocusDistance(e){let t=this.camera,r=t.position.distanceTo(e);return T_(-r,t.near,t.far)}setDepthTexture(e,t=vo){this.circleOfConfusionMaterial.depthBuffer=e,this.circleOfConfusionMaterial.depthPacking=t}update(e,t,r){let i=this.renderTarget,n=this.renderTargetCoC,s=this.renderTargetCoCBlurred,a=this.renderTargetMasked;if(this.target!==null){let o=this.calculateFocusDistance(this.target);this.circleOfConfusionMaterial.focusDistance=o}this.cocPass.render(e,null,n),this.blurPass.render(e,n,s),this.maskPass.render(e,t,a),this.bokehFarBasePass.render(e,a,i),this.bokehFarFillPass.render(e,i,this.renderTargetFar),this.bokehNearBasePass.render(e,t,i),this.bokehNearFillPass.render(e,i,this.renderTargetNear)}setSize(e,t){let r=this.resolution;r.setBaseSize(e,t);let i=r.width,n=r.height,s=[this.cocPass,this.blurPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass];s.push(this.renderTargetCoC,this.renderTargetMasked),s.forEach(a=>a.setSize(e,t)),s=[this.renderTarget,this.renderTargetNear,this.renderTargetFar,this.renderTargetCoCBlurred],s.forEach(a=>a.setSize(i,n)),[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach(a=>a.fullscreenMaterial.setSize(i,n))}initialize(e,t,r){[this.cocPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach(i=>i.initialize(e,t,r)),this.blurPass.initialize(e,t,Si),r!==void 0&&(this.renderTarget.texture.type=r,this.renderTargetNear.texture.type=r,this.renderTargetFar.texture.type=r,this.renderTargetMasked.texture.type=r,e.outputEncoding===ut&&(this.renderTarget.texture.encoding=ut,this.renderTargetNear.texture.encoding=ut,this.renderTargetFar.texture.encoding=ut,this.renderTargetMasked.texture.encoding=ut))}};new E;new _e;var Lde="uniform vec3 hue;uniform float saturation;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=vec3(dot(inputColor.rgb,hue.xyz),dot(inputColor.rgb,hue.zxy),dot(inputColor.rgb,hue.yzx));float average=(color.r+color.g+color.b)/3.0;vec3 diff=average-color;if(saturation>0.0){color+=diff*(1.0-1.0/(1.001-saturation));}else{color+=diff*-saturation;}outputColor=vec4(min(color,1.0),inputColor.a);}",Ide=class extends ba{constructor({blendFunction:e=Ct.NORMAL,hue:t=0,saturation:r=0}={}){super("HueSaturationEffect",Lde,{blendFunction:e,uniforms:new Map([["hue",new we(new E)],["saturation",new we(r)]])}),this.hue=t}get saturation(){return this.uniforms.get("saturation").value}set saturation(e){this.uniforms.get("saturation").value=e}getSaturation(){return this.saturation}setSaturation(e){this.saturation=e}get hue(){let e=this.uniforms.get("hue").value;return Math.acos((e.x*3-1)/2)}set hue(e){let t=Math.sin(e),r=Math.cos(e);this.uniforms.get("hue").value.set((2*r+1)/3,(-Math.sqrt(3)*t-r+1)/3,(Math.sqrt(3)*t-r+1)/3)}getHue(){return this.hue}setHue(e){this.hue=e}};new $e;var Ode=`void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 noise=vec3(rand(uv*time));
#ifdef PREMULTIPLY
outputColor=vec4(min(inputColor.rgb*noise,vec3(1.0)),inputColor.a);
#else
outputColor=vec4(noise,inputColor.a);
#endif
}`,Rde=class extends ba{constructor({blendFunction:e=Ct.SCREEN,premultiply:t=!1}={}){super("NoiseEffect",Ode,{blendFunction:e}),this.premultiply=t}get premultiply(){return this.defines.has("PREMULTIPLY")}set premultiply(e){this.premultiply!==e&&(e?this.defines.set("PREMULTIPLY","1"):this.defines.delete("PREMULTIPLY"),this.setChanged())}isPremultiplied(){return this.premultiply}setPremultiplied(e){this.premultiply=e}},Bde="uniform bool active;uniform vec2 d;void mainUv(inout vec2 uv){if(active){uv=vec2(d.x*(floor(uv.x/d.x)+0.5),d.y*(floor(uv.y/d.y)+0.5));}}",zde=class extends ba{constructor(e=30){super("PixelationEffect",Bde,{uniforms:new Map([["active",new we(!1)],["d",new we(new W)]])}),this.resolution=new W,this.d=0,this.granularity=e}get granularity(){return this.d}set granularity(e){let t=Math.floor(e);t%2>0&&(t+=1),this.d=t,this.uniforms.get("active").value=t>0,this.setSize(this.resolution.width,this.resolution.height)}getGranularity(){return this.granularity}setGranularity(e){this.granularity=e}setSize(e,t){this.resolution.set(e,t),this.uniforms.get("d").value.setScalar(this.d).divide(this.resolution)}};new E;new E;var KD="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAAQCAYAAACm53kpAAAAeElEQVRYR+2XSwqAMAxEJ168ePEqwRSKhIIiuHjJqiU0gWE+1CQdApcVAMUAuARaMGCX1MIL/Ow13++9lW2s3mW9MWvsnWc/2fvGygwPAN4E8QzAA4CXAB6AHjG4JTHYI1ey3pcx6FHnEfhLDOIBKAmUBK6/ANUDTlROXAHd9EC1AAAAAElFTkSuQmCC",ZD="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAIwCAYAAAABNmBHAAAgAElEQVR4Xuy9CbhlV1ktOvbpq09DkiIkUBI6kxASIH0DlAQiIK1wRfSJTx+i4JX7vKIigs8HXpXvqVcvrcC9agQ7IDTSSWgqCQQliDRBJKkkhDSkqVPNqVOnP+8b//rH3P+eZ+199tlznVTlvVrft7+1T7OaueZY42/m37QALKNk2wHg1pITlB17mC+Pp11W3X/LHyT32vhg48/5SOv+PnwpsHA70JoGlueB1iKApeqzvOzn44GatTB76Xzhd7suBR7+WWADgDEAwwCG/L54b/poDLrHuvvm70Z2Avhsc+PVcxscBU8F8C8ADg5+ipIjD/PlGwfgju8B924E5seARUfLsiNmqQW0IjL8+7L2NYD/7COBzfcCm+aB8SVgdAkYIRCXKyDax4EdAanL5PuNPllNvXDlAHwFgP8AcC2AhRIoDXbsYb48dl5WkVFTE3LGDcC9m4CZCWBuFFgeAZaGAYJQQCRqDHT+McJrVb8zwATUXH02MHYfMHEIGFsAxgjApQqACYQORjtd/B7Axt/z79sC0+cMPgjjlwPwVwHcA+DfAHzTxcVgWBroqMN8+cYBeM71wH0TwKExYHYUWCIAHYRLTlkCYgcIBcAgU/n3qy8GRu4HRgnAOWBkERhddPAJhGJDBxkvw7cqimr+zFM/ZLnZF64cgL8BYD+AWwB8x/dlWuWagHiYL984AJ/0RWBy1AE4AizyM1yxYAcTigW55xMbAkxEiwEdkJ/ZCQxPAiOHgBECcKEC4TBZcKkSv+mTieNcNPNC26mLNsj45QD8LQDTAO4GcJt/7iw2bfoG4WG+vAGwm9ExiEg69zpg/wgwPQLMjgALzn4E4aIzoJjQ9g4024uygkj+pyuAoX0VAIfngOH5NgCHMhAm8Sv2y3XDZeBhNIp8OzJE8OsBzAKYBHAXgDt8/4O+MVT0j4f58o0D8Pxrgf3DwMwIMEPQEYRkNwfgsuuDZLskip0No0gWMD/9HGDoADAkAC4Aw/wsAgZAgs2Z0ABI0GU6IVmKv+f28KDnHxkA/G0A8y6G73N9kOCjXnh/Ebb6OvgwX75xAF5wLTA1VIHPADgMLDj4yIA5AAm6aCUnv4oz46eeDwxNAUMzwJAz4BABSNDFTwSfg7DDKHE23MG5PqIY8A1u/dINs9dBdy8AgnGPM2NfUBrsnw7z5RsH4IXXAAcJviFgluAbygBINnSLWOAjGxJ4pgOKDV0v/OSLKp8iGXBovhLBBOCQM2ACoTOhnYrAdItYbCij5JFzRyIAqRccAnDAQUjg6UNQ7hsMXP0cRQAexss3DsCLCECCLwCQzMcPwUi2MwAScAKbfnY/YRLFQ8DHX+IAJAMSfDkAF13kLvleIjhjQQHxUVS3jjgGpKeeNzYVQEjgUS8k+PghONdhIwAP4+XXBYCHKIJbwJyDTgaIAdCBJx3Q2M8tYAHP9m4df/ylQOsQ0JqtRLCx30K1wtLBggScQOgsKBGcWHAJeOwRC0BSM1mQIKRbhh+Bj98JQP6t4U0APEyXXxcAEnxkQAFwoVUxID9kvQg+c1C7vidRbIDkc24B//hTQGumDcCWA5DgMxASdNIFBUI5pCML8v8API5zfEQx4BudgqiczviSnJhQwCP4BMCGl+wO8+U7AJi/W4O4YS6+pmK/2ciADsAOBhTIIiAJnPB7AvNjP+0AnANaYkAHX2JBAc+tYaJXOqBZv24Vc386XW5dtkHGW+4HFAJonpOe+YYQZAShgKjv3PNvPQaxVoI8zJdfFwASfPzMUwS3Kt1v0UFIlos6oDFdAGFcliMAP/ryAEAGNwQRnDOgLbdlIEwrIs6AZ/QgkMMHQF6ZAKQcJAsSYPwIeAIk9wJgoPK1gi7+PwF4GC/fOAAvIQPSs0URTPBJ/Pp3GSEGRHfBCIQ0xowBtUbcAj7ys5X4Jfu1HIAGQrIgQRXEsAFQIORDFhiDY/rMHmrU4QUgR08AkgUjCAW6CD6CkwBsAIQC4GG6fPMA3OXiNzCg2I9gNCMksmAAoemDzoimFwL48M85AKkiuQVMAAp8CYRRDAt8GQiJ67N6GJODAXAHlsGguscA2AJg1IPGYmxOpBxFWkRN9LsATgIwXnNs/v/5z/9XCf8BO3YAtxbc/46/KDt+5+ea1Yku2VUxHz/z0v24FwMGK1gWsK2OUUxHHdCBeRUB6OxHABr4ZICIBd0QWSF+XRdMTAjgCdTrG9cBNwE4F8CpDkICyYLGsuhFt6zs+gISwUen8zEAjgMw4cfx2H6O/90yAFo84Cbg4ID3/9TfLTt+5+ebnRABkODjx0SwPi5ec/FrYpmqSAxM8Dn60CsqAFI6GfhqAMiDE/gokmvEr0C4PgDkBQm40wE8zMFEUDKEVoxIMLl/KS73mE7H9d+vcKHQQcjwW0Yu9nP8m8sAmOIBuWY6wP2/4s0ezjjg8TuvaR6ABJ70vxUApGrm7EbGE+i472BAB+WHfqHS/eoAaEwY2E9+wLSXTqhI7CXgnB6LCoOJ4BiST+hTnG0HcCwAglCx3ARoZEVFXnBPp/O/A/hXACc7CPs9/i1lAOyIB+RDX+P9/+pbQjjjAMfv/PL6AFDs1wFAgs/9fgKfgdE/ZEpuiQlbwAde6QAMBgiRmsSwA9BY0JfjovGRDBMH4TlcXGhcBOc6HkF0gjPhZgchxTLZMAci/04W/B6Ab3t09EPXcPyflgFwRTwgJ2MN9/8bf5qFM67x+B/aW4XQz42FeL0YrRyikztUFw0704mf9kXgxhOAqc3AAsPyRxxQCs/PdXOFY0W1KHy3QIUGtx+6vdnx1vsB+dsTncm2AogglFgVEAlUWrOMB2RyEmMCGQ/Y7/HvKns6tfGAnJQ+r/9b76oJZ1zD8WdyQjYBh8aBhVEHjELouQ8ukQ7VRSCJAALwkr+sALhnGzDD3JAJYJHg9uhoi4bx8ytkWUtvHT/7+Zc4dw1uZ3612fH2dkQf7yxIEEockwkJQn4IQoq8unhAhmPRKKFx0uv4K8ueTs94wD7u//VX9ghn7OP4c+4G7h8HpseB+dF2AKlFLwuAIZ8jD6NPrOhAffmfA9/ZBuzZCkyRWSeqBCWyoYGQ5yQrBpDbum/ME1HoPo0XEkSD2zlfbna8q6+EUJcTCxKEtHL5EQjP6BEPyIgYAZBvYt3xHyx7OqvGA65y/7/9wVXCGVc5/sl7qxD66dEqiYgRzAqhN1A4CBNAAlDyAFI+iZ9/N3DLJuC+jcDUBmCWyUnOrmTYCMIOkNclLg0B8/RsNLg9+UvNjnd1APLmmQpFHyEBROuWACQT8nN+H/GAvY7/VNnT6SsesMf13/CpahGnZzhjj+PPmwX2MYdDIfQexWyBAwEUOQDrRDN/98p3A7dvAO6fAA5sqHJDBEAyoUVGkwEd6HR12XU4kwzfl6fCXTZzjy57vvnR513X7Hj7AyDvggAUi9EyFgiZqNxPQF6345nOWbD1HQ/Y5fpvuLa/2+82/vNHgAPDFQDnhoF5j2C2qBWCI8bw1eRw5CL5l94L3DEOTI4DB8Y9OWmsEu/zBJ3rgsaybqBob/7A4C7jtWcooRrczr+u2fH2D0AOQgAUCxKEP7aGgLy64+m6KdjWFA9Yc/03/Osa4glrjr+AupqHz1sEs0cxG0BC9HIePLoit9eNkVf9L+DuUWByDJgaq4ybGYLPAWgiXmLedUE7dwC7saL7CqfPKXi4NYdaykCD410bAHlDEsNiwZ9wAPYbkJcfz6T2gm3N8YDZ9d/wHxUA+739fPwXPrSKYGb+BuP3jAFDElFH9HIWwbzCIGkBr/or4J4RYO8oMOW6ZVcAuvi1Cgoha04BCwT5gfMKHm7NoRde2+x41w5A3hQZkADk5+cGiAeMx3+/7AENFA8Yrv/G71cAXFM4Yzj+otOAaQLQA0gZxaIIZtMDFTigKJV8H9Iq6aZ59ZXAvSPAvpEKgBTtBODcSCWCZeRYtpzrmLyeGNCAyFl1v+Hei8qeb370Rdc2O97BAMi7EgB/2QG41nhAHU9LuWAbOB7Qr//GPRUA13r7Gv9FZwIMoVcEswEwfDoimEP0shKKtIphaZQAXv1+YM+wA3DEdcvRKkGJADQQEsQuhi1Tjt95vBsh5nx2IO59SsHDrTmUOStNjndwAAqEry0IyCMICkOyiuIBNwBvPFQQT7gBuPjc9oRYAIHyOEL4vIFEYVNaOou5vCGE/tV/A0wOVcnpzI47NOri3QFIBpSeaSDUdYLOSWvYImSGgftpJDa4MWJbAGxivGUA5MAOc0Be6eVLj7/4Mk+hzCOYPYpZDBiNkLh+G/M3yFyv/ltgL3W3YQfgcFUhgRY2PwY+Z7/EhAR1SFyXCOb57r28QfQBsJQBMn5D4y0HYLPje9Cd7RIC0PM3EiMofF4gVCBp1P840ix/gyz56r+vAMjk9Gl375iB4+CzveuZdLkkEPJ8ZEfX/6R73vOjzT5Si9hucLxHAVg4PwJgRwh9CKOXK8YA4ZEqKZXSQWh5P+5AftXfA/uGKvYjCKn72cctbFrZNECka5L5CPwIPtMH3TVz17MLB5gdLgA2Nd6jACycHwLQxFEUSR5ASvARDB0h9AQb9bXIgCGk6lUfAPYTgEPAITKgg1BObk58srTJgG58WMkWMaAbQQT1nc8rHGANAJsc71EAFs4PAagQestgC1lsBJ4BMCSOK6dDUcwqqaFiQr/0QeAAAdjy+jBiQQeeMSBZT3nCPUDIa9z+/MIB1gCwyfEeBWDh/BCAeQSzgkjFfGLBBD5nxQ4DxN0wv3hVxX5TBGDwL5obxvVA5YqYL5BeMLd66YYxJpRB0gK+96LCAdYAsMnxHgVg4fwIgMrhUPKQ2C+Bz0PmBTqBMQehAbDlIjj4F80KJguSVZ0FuXpjoCOgXawLjALhbT9eOMAuAGxqvEcBWDg/l1IE05Ed0ygZnyHdz0VwCqEPIfNyx0QQvvLDFQCp+8nfZk5und8tXwIgWcHSNX0N2CJmnAl3v6RwgNnhl17T7HiPArBwfghAS7mV/hey2JS9FvM3BLpUUi1YwDRMXvkRYJoAlAh2l0dcZ04s6JUTDIjyBcrl4yDc/dLCAdYAsMnxHgVg4fxwKVwJgGEJNmWtxpQMpX9on2eRhVA+O56AjMfnP+e3Xvf3NwG4xIPTleiY55bpGh6UbafNU0l0z0p+5Jh5HqYJ6b51nP6XP8cx12XNHQVgIQB/bFPVg2OC7Q+WgVFWng/FvtWLI06uWh5oguKEcXVS/9sEAF//VGD7t4ETDgJbF4CNi8CGZWBs2fPL/H6Vwp2KEtVk4fJ+v/EIYPN9wKa5qu+IncfPwXHVZe/aOL3EbwS7xv8A1rQvnO0j8PArTgTGZ4BxFv9mIxhOCGsv+0OPYDRghcLfkWkEuq0+G00x4OtfDGz+d2DbHmDLjL8si8AYP/7CGIAiEEMTG92zXqSbH+d9R2aA0XnvO+JjthiIrOVDHHPOkBrzUQAWAPsZp3oPDpa/Xag6EVkLBK+5rAnJC3/nYk/APD704WiEAV8OTHwX2LQH2DgFbJgFNrBhjd8r79deGoEwsllgNBOzy8CdjweG9wBj08AIAci2D6HafmyAk4/Z7SJ72hGYRwFYAMDLTwOGp4FRFgD3HhzqRGQiyeurqOdG6r0Rm8IEZjzRlkiqCWoEgK8Axm4BJu4HJhyAbFhDxmbDGnZO4j0SgLGDkpibgEq66TJw/1nA0F5gdLpq+zDqFfd5LMeWqu5HNST0uJOIllg+qgMWgI+HPv0xwLA3gWHpW2sC441gCECbmKziaGrnUdMO4aHeh6MxAP4SMHI7ML4HGD8AjHvHJGNAgpDgY/ck3stipRemvVhc+uASMPUEYGh/9dIRgGx8Y+MNbR/00uVtH0wEx94j/v0oAxaA8Ed+GBieAYZZg5kADC0QWGOFzGJlcGPzl1BxNLXD8sk4xftwNAbA/wwM3wGMUmxOOQBnHXzetIYvibonmSiuYTNjriVg7glAiwBk0fNZH6+PmX9P6kfNmCXGpftJ7TgKwBIAnln14BAAYxMYm5C6RjCyCoOyr0qkD/c+HI0B8DXA8N3AyCQwesD1VQKH7EcASm1Q+y4CkN9pUKiVF5nLvy+fBbTUd8QBaH1HvNBROiZvfsNnrF4kcvPwpdsBLBeU18Nf7AB23Dp4ecHC8oBgUlJJecLS+7+WOpE3gbE+HKw+yoevCYkMGKqPJrdEKARutaFYRs1fiEZ0wP8CDN8LDO8FRqYq3W10pgKgfYLaYCzootgA6KXaTA90y374TKB1sBozy77xHFZ536utRgAmEaw6g5kUSFZwSXnA330qsOlfgHMPDlZesLA8IOjoLypPWHj/11EnCiVwkz7kAExtsGraYUWdSDX5TmsagL8KDBGA7Bd30JsW0oWivnEOQNP7yGTSBR101AlZSUtGyfgZDkCWY1HnJdcBVe6325hTvelg2CQjZNDygG/2An0j1wKnL6y9vGBheUC8prQ8YeH9X39OVQSc7Mc6fCaKvAeHdCIVf4yMYCynTpX+nb97NJmlSQb8r8DQHm9YOFUZTKOzoXGhs6AxF0HIexcLBvWBuiHN8s2ne98R3qc6L4Vyb2oBVjfm9MIFHbjDCh6kPOBbQoG+oW8CO5bWVl6wsDwgfr20PGHh/X/1iaEIuDcCTIW/1Q4rFv8OnYiW3c+W2iKwUjKbyjQNwL1uuR6sAEgDgq1brXOmV81PxhNB6DUDBSYzQJwFtz623XcktX1Q1VWKaTF/zZhVazBVYA1tX5MazsGvobwe/jQr0Ne6BTh5uf/ygoXlAfG60vKEhff/rSe1i4DnTWDUACY1guFTDqLYdCBvf6DJYSMYATBfOx1kLfj1v1axH10nQ3Sd0GUkBnTfpemtBJgseIKQAHLQcVxa2TnuMW0Aqui5es8xBIegVdVVE8VhzHnLh65WMB9An+X18K6aAn2tO4ETl6vqbKuVFywsDwhevqg8YeH93/Rk70JE90nowxZbIJjvS3WYNSGUwGHJTpPxwwcbBuBrgRYBeKACn7VtpdUu/c0NJxO9BIxcKu4TTODzbkonPLoaL0vyUQRb2y8HsL1ckfWzMeuFi40Qezqi+yiPhyt7FOjr6/gCFwgP7Xb5vssTFt7/nQRg6MGRWmDRoeyTlpgw68GRTwgZgo1gGmXAX6/8dtaylSKY/koyID9BhzML3q1gAos2AcOrZYSoq/pJp1VtODRm9Z3LS/7WjVkvXOzEtOpKyGrlAT+4SoG+VY8vBGCvy/dVnrDw/vee65NBJiAjBIVcAJQjOm+DkCZEeiGAMw6sAwDZsJrAdhFM9rPGhd4904Co5oVuCZPV6kD40Ec6+9W8dBTBsfdc3nkpvnB82fp2RPcs79dHgb51LA9ofsDV6vut5/3PnxcAmLVBiDqgevDaJLkYrpuQxzcNwN8AWgIgRbB8loEBzXDwl4cGiDGft58SCOWGedgjvOJ+bPvgRkiuA+ZjzhnQQOiFNVbloa7l/fos0LdO5QENgEXlCfs8Qbf7HyMA3QVjYihYhLENgjX9y/qwxQmRU/asfd0ZcLU2CHVGyusJQLKfVi98CS12T5f7iECkHpsMkAhCF8+nshWH2I/jXsOYO144GV/9ApAIrS3vt4YCfetQHtAA2G+/4PW4/2PPbzMgmUMi2NoeSCRxIt2/FvuxWURIWCXg357gfTjEDNIHnTRXRCpH5ugKwGl3HpMBXQc0v6WLYVm/5limj04rG762K2uYY9jBkr9+rI03NL5ZbczS/dJ+LQyoga4o77fGAn0NlwdMAOy3vl/T938KAcj121z8Bn+Y9eWQJRz8Y6kNagDh2ey5EvxjxQD8TWdAuneCCO4An1vw5vdzQMmdktwq7pLZQR+dM34+ZumAxvY1Y04uqOAJ6FsExzeto7zfAAX6GiwPaLWR1lrfr8n7f/Rl3QGzmsis+/uO71V9OFgP2gpPhgr7TGRqRUT6dyvr4aIs/pm/2zVUNbBSv6G8e5pEv0Cvec7Po7+bTtjlBRlkvAMBkDeQyvsNWKCvofKACYBrre/X1P0/oWEAnnFD1YdjhtXxR73mX10FfCHHE9pVWcGAI/S0gKsfA2y+twrFZw6Hxf/F0Pk8Ri/kpGSnMuDx5T0iACgQHioo0NdAecBUHW6QdsV2/cL7v/Cyqr5gnc42CCOcfX1VIZ/V8We9IDmTzVXwPDJiXuKXPxtDBma8+lzP4WAgKkPxCUAPE4v5GzEuMX0PYJPLhB6FJsc7MAMmkVxaYC/K9gG+F1++8AQ7Gwbgk78I7GFpXgIwFiRXOwaJZPUbiR0yCUDRk+cHf+YpwMj9HgfI8ClGPyvsSiH0WSKRuYlitLb/zHM/JOSs5C/YIC9cMQDZr/dwxgOW9gtGYUBi0wA8l304vDQvAchilFbpIBQhZ7Ejq6ZQ0/Yhil8y4j89Axie9DAsD6FX9HOK3QtROTFkviN83kG4felIY8DCeLrSeMDSfsEovAECUFsTjHD+tcB+tkFgcXKvBRir7qtFl9owmO4Xy/1G3bAFfPrZHorFNWBFwHjQAFctIghj2kBarw06If/+MM9ZqTN6DgsDojCerjQesLRfMApvoGkAWh8Ob/tgAPSKWCp8ngNQtadjmTdltvNvn3peFYhgQQgh+iUmEaUAUoXM1yRLmWuFLaE9Z+XIAWBhPF1pPGBpv2AU3kDTALzwmqo6qtVh9kJErAudABia38TC5wJgS2xIhAwBn3yhByL4EhzXfRXxYsDTJ4IvrNN2JFMxZcBzVo4cABbG05XGA5b2C0bhDTQNQLZBYH1AVsQSAAU+imI1obHyblnjG/kJk3U8BHz8xVUQAhnQIl5CyNgKAGp5LKSSCoAySh5Jj79vTagcxUaIBeRNe79g9gq+DXig4wGzy+PONfT7RWFA4noAkGXZVAhcBckJQgNgrLiaNb3paIDo1vHHX+oA9LQBi4DxJcOUPJUnTgU2NJUyROs8irGARxQAC+PpCtsFd40H/AEf0gMQkLgeACT41PiGoLOKqyrJq3K/Ya9mNyr5FusN/uPLPIeDa8Bc+w3rtyl4VFHaMZc3i9RWBM9jjzgAFsbTFbYLRmm/YBTeQNMAtD4cBKDXBTQGdAB2MGBo8SCLmEuS1AFVAJ3A/NhPt0PoCcA8bSDG76XI7aySg6JYuGfKwJHFgH0E5B3ueMCe/Y4L+xVHAOZ+9EHcEgQgwbeiEYx6jwTdz4qfu7EhEJqxGqruf/RnHIAEnxgwBM0aC8aUAYWNBRCmoIll4HTqO122QcZbrgMWxtMVtgvuOx6wa7/jwhtoGoDWh4MBJ16WN4lfr8AqI0TVV1O1fa9BbQzovkAy4Ed+NgCQUSxZCFWvCOaOFREXyUwZOPIA2GdA3uGOB6wPaOz+QPv5S+MA3OXiN9aclghW+d3IgupBF2pPqxcxGenDPxfSRh2ASiKKiVP2PaZScvAKoA0VDc6cOlIB2GdA3uGOB1zR77iwX/F6AFB9ONSOQW0frA50sILVcckWJyIDSgwPAVcJgFbYuZ3FJvAlEHbJ3IsgJLGedeBIA+AAAXmHOx6wo99xYb/i9QKg2iAIfDJEJHqj4SExbEty0gkdhB/6P9oZbBZIGiKYVb9GKaN50lRHBLOvhDxh/5EKwDUG5B3ueMB2QGM/grb7/6wHAPNGMAY+GSGUjC52VX2f2CD4+HO0gqkZfegXKgBaHkcWtS0AWii9xG1ImrLlN5XR8L8fmQD05BVrmEENmpYSP9QX+KHiqj2/82+HqqDWwnbBRfGATdzAegGwru2DpRq7Mzq2fpAf0Nq0Rl2wBXzglZ4yUAPAmDSVWDBPHQjLcgTqOZ6zUvdKHh4ruDCerox/Dnu7YqwXAC1NI/QcEQuK6WK/kdgCTGC0PYAP/KIDMBgglq+hIkrOfsaCviLSofcJgJ5AdM7kkSaCj/HqQKVIGvD4swF8bcBjmzjsaQ2H5D/6acBd9wALB4DFWWB5AVherMp4GKIYEOp7+26UF0aSfT/xYuDG7wDjrIpAERytXf2vajj7ueryQXSFl10K/ON3gIWDwCLvjfGB8Z54O+Ee4ve6513uB2R1yzsqC+twbC8HcNVhfAeaBuDP/TvwtS3A/ePAIfYFVlPq2HHTuyulZCTlhbjhETF5yxTQGgPGhoHhIWC4VSXGD3n0tLkMHXHxu+YyB+MlPwDuZs5K6FlsbCzdVO9DuKfkHM8AEkP7B8fOkwDcD+B7np42+JkGOvKdAL4E4K8P0zvQdET0b14D3DgB3D0B7B8HZka9WzrD88N6sFm+YcUjrn7E1ZDvMtF9DBgeAYaHgSGB0PNHCD4BLwLRsByAyX/ij0/dDUxuqlIG5hix7eFhvLcOVUAtyPSydAFmOQNe6EYGV/9ZESiKgIEgtbaD/gHALQC4ovY5r5KwtjOU/XfTAHzzLuCmIeDuMWDvKHBwpMoN0WQzNtAaYSs0K4ZlOSAjGG9kPjCBRwZ0ABKEBJexYAZEAU3A7Oi1BeDym4EDnjQ1TwCGWMW8MXcKks0YOyZNlQOQjcgYIUHllEzYQ0ktm+r6oz8G4F4AXwXwRd8/kO9A0wB8y65KmPxgGJgcqYJTKYpTv2CCzyddQJRDOjKivn+Deh8BF8BnwBtaCUA+YYEyAU8h+c6Az9gNHHRmrgOgmDA3jHQ+iWupCeUAvNSrA9HNwqx+muk9nJVNg/CTfrmbAPwbgK8D+PcHkIibjob5o13A3XypWsAkG1cPA9PDFQDZM1id0i1KxsWfOrKnAFXlifCFFMMRcASigOcs2MGAIfE9iWXplS6On7UbmPaUUTXQrgsVMzcRj5Folg2V5ayUA5BWYKwOxKUafnosWjcJwk+7W5F2EKvlE3xcXaNYfiCYsGkA/smuqug6hcleAnAImPbO6YwRpMgjCAVAm/yQmKTv5hNsAf/i7SyNBSl2a8Qv/4/M1yF+BZSYlNQCnnVrpbC+mToAACAASURBVJcaI7sOSEY2NpaDXLqpR+vE/OVksDgImgGgghHoYJbTWc7oJtFWc65/cg2AYvh2ALsB3AzgVv95nS/f4QdsIkT9T3cBrGtITWZfC5hqtQHInsEGQn3UDDvEDEY/ICf7SxMOrAg8T+c00JGkvHGd2DABUYZIAONzCUDppCFhSukCBsLQrFtZe/IixYQpSyEoJoqnuPWrVRAubQh83HNlZB23z7j1ywmj6CIIqUPxw2Xeu9bx2jx10wz4Z7sqTYZaDD8EIDuoE3hMVEphWg66JIp90k0sBxBcy+iPIIaT1RtEsHS/yIAqw+VSNPWQfe5tlVEk8auXgVa5BUsEJuT5uoliAbE5AGotmIAjCPnR9xDG3TQernYAUupTdBGEFMf83OkApHG+XlvTAPwfuyrgSZOhas3u6cwTsUBVn2gTwyFMi8wjHZAA1M9fYGHDULJD1m8Cpa8fRxDad+l+Ykf/3XNvd11U+qiL39SxXevSsshdDFvgbI1O2AwAtRZMZzTBRuDFjxe1Xg8QEIB8yyj5yYIUxfQIkfkIRnmHCM712JoG4FsdgHHp3ACoMH2G6jM4lWzoQarSvwQ6MSB/vporVaFkh+mCLlpVR8Z+dqDZLoDOpHSiQeAFDkBjPrlgCHgCUaFifg67H/9uYjn4Ai1vpTERTAASBaoQJBAKeNqHlL6mwPDZYAOROag/EYRkPX34MwHIvzW9rQcA+TLpI22G7EcQKlJGsYIJhC6ClUMiXfBTbFUQAej6nPS/OuAl9pOOqIc2BLzg++3VmWgIEUz82cRuCAtLIHQQm0gO52uOAb22sC3JEWgRfPpZf2sQBQIgLydPEIFGwPEj8MlF2bSbsulghLftqsCXq9HGgHysznrGgi5qzTUTFH8FLhAUn3hIJwCN0HLncw37qaF2zoYvuKNivmQIuUNc7GvWt6sHNs26twA6vhyq8NEMAHlyntFrDCcQehyaPTl+FwAbXDcmAKMRThakEk8Q8kPg8SPL0qzLBl+A9QCgR6uZGs3vfHz8TtBZvkgGQrEPBVAUg2Sij50QAOjiVKI3saADJRm7dSLYWfSFDkCem/dhZeMy9pPY5QvSDYQyUJoDIK8qMezh3wY6fSL49PcGgCAA8pScJLIgAUYQEmz8RPA17StvGoBv39W24eREiBoNQSgWNI1HBkdgxJSw1AI+dFIbgOYmkjimQ1r6XXC3rAbCHycAgytohf8vsB/r2KRaRq7zpZ+D37HMX0s3DDcCUGLYaw53MJ4YUODzusqlGCQAOQCejuxA8UULUkxIwAmMAp8Wa3qkN/R9W+sBwOhIEPjk5SLr8HeKFbTQfb77csPIMHGl/4MPbReslPhNe4+MiTpi9AFGV4nI7MfvagNQLh/pfrYnDAS8aJQ42A2w4em2cAyWQUuJVQTGWLs1uL7DG9J1RjhA+jvYk4t3KXeMqijpzrud4At9z3XtP16yGfjKZmCGooYh1tZzvv8xXPFl4PoJYC97k9FlwZWD+Azi/deMZWeP13eQCGEyoERudChIjbb3mJYwH7V0QIKuCwj/gfMj0asn2I0FXRSHXfL/iRkNgLyeVj8ccMY//J1fyxzTAXT2+xoQViKYD/1hDqLxPiYxTgSvQrphphG97tz4Slqafnj7uk1kIQDZrvWTw8B3jwEW+RLxPgSiCERdPwPR7+wCPg/gulFgfruDkOMQkFc5x84e708JAMmCuRNBXi4TIg5CGRzGiBGE/D4E/C2r2vcAYJoify62i0aJSMhB+2IHoNwu0fkcjQ85pu3ack5nIBREqneYFyWLkAXIJHESe00Cyx5QyeL6F/tyEcDcrOW2n7fX8df0mME+/vQ/PQjhoy3gzo3AISYf80MQaQx1peH9wb7v2mrtmCBkIMMejp3jIJD1MsaxaMZ8v5N/67INAsB3BAYU4JL4DSo1J15AFPAEwuQHZJzkKfUAtOHLJSOQRWndBYQvCQA01cfnNopfsaCJaD2baBn79QjSTiOEP1EcawIpkq2kegBTNgHWEpOKF8Uwq2NRFPM4AqCf46/rA2U9/uVDvurB01zvAJpiiwOl3fEeciCGF+Ij11f+QkbSfMPfIzqw57mEFZ9Dl3Ps5HXWAYByHJAJKV7N+s0cCQQhwSlfm4lGZ0KB8C/rABgZUS6ZHITBSEhCowUYAAksF7cStWREyxRwtuPpOlgw+5s9sq6OaIJIIlUgEhA1edoTgHxa9HVw5jibZNF+j/9yGQA/7pbujZ4bwv2+cWB6tFo0NzYnkxFA+cvEAo43VBoEo2e+48EMXEOmD9F6xhCE8RwZEJ80VblKvDlmzwicfqy93/o+8K8TwB2jVSgW138FrJQTXBNlnJgmrjZwanow9CBP/rL9wF0jwAGWDtFyoN9PHutnIHT05mPXz93dMGQAPniJsjiBXiTbxDZFMF9NLUPQxKR5qezz1Y6/YZDH0D6GkdAkYJIvRalAdHAMmPZoYhb6NhDWvEyf/ma737CXN7R1ZC7hUbPgcFgqt/ZZjADnM1xqEVhYBpb4CUk5UsL7jQvj///5buDrLeCOEeD+YQchYwG9VIfyg1NaZszFiCH6DkRGLze5/dgk8IMWcMCjdCiCzR8od1B8OTwvJM8JEShFut1fzMhi+eRJr6LI7hYP2M/xVLwKNoZjUTwRMAQQmYyhWGQxsSADOflZ4kukj7PhZ75bETjBpkAGahMkcrGgwhsXeCyBHBj1wmOBQwvAwqKzoFeRV8ZaerjKYAuirmPY/o9X7q5Cyr7fAvYMAftCPGAEoYlBiVtFwLjtp2U4irj7yOANbi+crHyrfCbTquJV44O0F1FrwQGIMZFqdQDyP/gGSZ8TC0ZRRsOlVzzgasd/u+zpMByLehAfCgMQCDyGZJHFCCgLZ2f8mgI5qauEcVx9e5vACTgCTwEMWr5TdIpWKJb5MvrnoocDswvAPAG4VLGg6UKeqmi4iuDz4er30oX0FP7u5moMvIf7W8B+jwlUNAzFnlZCIhvGFRCeWzrgXSSIBreXTFZSgVLHAp4UHOFuociEEsn2PJwl/XEk0dzfSojeerFg1IOo5BKAveIBex1P67lgUzgWQaJwLAKRH04i14ItgDKEtGsRnWx49b2Vkk9wUefTGrKCF7R0JxZMqxN8cmPAxWcAcxGABKEAKPA5u9lEaAbCmKMI+sDN1X3z+ro24wEZFc0VEE64ABgT180PF9ZdBcDb6JpqcPtPk+1ACbmKjJnllwyuILunEAWjZHkBsrsRUnfD0qEiC5IJfyisgMhzWhcP2O14Ro4WbASgAMQJ48SJwchmBCDFa8qpyBbSP7OvU4PQ0p2W7+LSnSJUFOrI4V7w5IoBTQQTfJ6oTSYk2mQcpGRyH2syGjIF6EM3V/fM++C1CfwUExhCsmzCaQT43lZC3e1hBpEHh36XEqrB7Scmq5dV0XZxmV8WuDFzAF9iwhow9seAGoBcGtKjqAc+1l9rLb/1igesO55ysmCrC8ei6IxRMAKTWNBi6Xw98xNTFUi0jEcmpYgRAPhddpVi9OIEPP5cYD4CcLkCooHPwaW9kV+iwWrQHT8uA1fd3F7DFvgUHUP2k8jTiogAqLoxFpDgbMj9jXSuN7i9dLIdaxzBp5XVBMIMgFEnFAPKT9qPd6A9BIGI7MfPmf4U+40HzI8nWgq2PBxL4FEkjKJixGRRFyQQPzzd1iAUzCAQas1YOmAEoFjwkecDC/PAwhKw6CxIkCXwOdVJLxTobMjBdyIgfvimNvNJ7Evf4jWtdnRYD1YNGVuG93VWuWs4Jf+mlZCCZxwP/cnJ6mXVKk2+tK8lQQVHRTGc64SDAZB3Ey3JcxyACkToJx4wHl+YwqloGDICmYmTFgMQFBET8yyYzyAG/AfWX8mCGQg0BTRoHwt9KVaPE/HQ890AIfgWK+CRAaMRYnVdxHbhdY8Wslw1V93UDsmPIj9GxgiAioRRMIJNvoti+SW/Ikd0gwAU8+XxJcbGITJPDvI6XdCFREFSknTB83xka40H1PGF9dnycCxFwygkK0bASJQSVAbAYeD98xUAe5U3jKIwBosSgNsuABYogl3/IwgFPrOIg1Xc4ZrpAsSrvruykl2ucykapkMMh4CExD5DwJfWAYAxwk4MKPAJgOIjGSEGwuCakRhemw6Yv0UUwRf7L00L9pnsNx6Qx4feY4O8pDEcixOjsoTKKpMYjSFYYjOC8Eq3Wnnr0YYS+0Tmi2HysrPGLqwASNYzBnT2Mz2QD91laxLB0gs12GAh81cf/o/OcHyJ+qj0S/zxnhUZbSyYWaL8+Rq2S29wowiWkJPan4MvgrDDGAlRe7KIywDIgR3meEDWg9HbJgApNTkXo8o0i7oVgxnEgFr8F7jEdnU5GvqfJQKQKyEOPlsNIQvyvupAGHS/Okv4qv9oh+PHxMLk8ggBCRxvAmEN+AiEzz2iQfQBeNmkh4K52hJBKOaNe/FSLobLRXCz43rQnu2yi9oMSMDxs2jo8303ERz1wsCGZECF4kd3DwEYYwJjhoNlQrgIjlYodbBPrwMAZfEmyzcIv27gs6XDzC/IR1DOgA9a6DRz4wZAsZ+LYXvQYsHoD4ziOFklna6YD3+nnU6dZ7bGDAcBUImIAmEUw/zbJ1i/scGNDJiLXmle3RhQ+l/aq57gUQCWzwwBKPeLsZ/LFrGg/ShRXAe64Ajkv30kALAjF8R11Dy3K7KRwJcsUTaqWScARou3w/INVnCH+A36n8RvM3nB5XP4oD6DATBYwGb5ajlOLOh6X8JaBKRG77+7ygGYp1bn+V25/01AzBnwQ1ypanD7KWfA1QDYC3zJIj7KgOUzc9nFbetX/r+O5biwNhyX5uSEDr5o0xsJwLp8/m4A7GaJUv/j3/5+HQFYJ3oFPPkho/hNeqBcMkcB2BAA6XrxmMBkfFAci/m0JpwzXw0TXvXtzrz+PKc/Ml/ugzM9MDqCAbz/keVjjGcQA/YLvjoguo1mRslRI6RwfsiA5nqhL5D6nscF8gfTdfxpS+/hLzvWfzMQCoB1Fq/8b3VWaPIDZqsRV64DALsZHVHs1gEvsqFAeBSApQC8pHK90Oql4UEAyvCwNeGcBXNLOPMLftgZsI75ouUr9ousp2TEyIJ/sU4AzC1e+WIFshyAHPZREVwItrrD3wGAhibTYBhxVpe/xePyrNBuWaoNp3DgFwC81O+RAepK/a5Lfe51jxr7JwA83nPXYgq1asl0yX5N48+f4VEGLATlK1vAo5YB1gBSRmsM+NFE57lcfPD5pPFWCJImtyvGgGfOAacBYO59zFglgHgPefZsXV6/gPXBYeC0RVgyJNOGYuJjPka9eHWgjL9bWzhWk0/n/wPn+k8bgFNmgYcsVflZnBRmIShtJM/m7JGibGBoOIIez9wKPP4AcNpylfbNlGfdI+9NjBjz8JVzppckZuJ+dBw4aQ44drk6j1LIY9JkPD7P4s2lwVEGLHwJnncscNIh4Nh5YMsSsHm5ndOu1BGFThJ8/K6JrZtoslST2+XHA6ftB05ZAE5crgAups5TfaL6EF+UyIif3gAcOwtsXep82eIYY9JkXpMgMp/AeZQBC2b8OduBYw8C2+aALQvARgJwGZhY7swEzbNa88IRvAVO1qkF91J36DNOBE7eD2yfB45fqphLnevzdGeBKBfL8UX5/CZgyyyweRHYsFwxYHzRNK6oetSBMDLjUQAWTPqPngpsnQK2zgKbCMAlYMMSME4ALrcnR6JYQIwsoUnjpDRstOLy7cBJB4CHUGwuAtuW2nUDVH1EFUhycSwWjGD64mZg0xywcaECoI0z5P3X5P6nWlHdgHgUgAUAfOYOYMtBYNMssHEe2LgITBCADkIzSJZXpCOnIg25uPrhgnupO/TyhwLHHwSOmwW2LVSik2pCrDsQskzNIBGIpBdGI+VfNgMb5oENCxX4yPRjPj4xaJ0+WGeEHRXBDUz2Mx4FbDoIbJypADixUAFwzAFI8KUJChMV2SUaAGc1cE/xFJef3FYRti64nkqWDrqqEhbrsm5zvZCdPCd8nHzJOLZuABRz9hTHZwPL7LnLnoNMIY2VyaKcjtZLHOAbNgNPngKe4BacfGF1pnydD+hphQ/8XV5UiEueLGnDN1tWXj/3/4cTwAUzwGPcRcFJiDpPt3FLmf5vjwE2HAQ2zPrEzDv7OQg5OSM+ScYQy5Xbo8465u/ZfLTJ7fKHAdumKxVh8wKwealSE6inEoSy2MWCdbUHIghv3AqMzwHji9VLZuDzD8cXxxWZs5c7apmW0fMBnIHKn5X7d6I5npvRz94O7LgXuGIReJSb+Xl1tzqflybwRwqf9i97BQRWomWJQ7oZVFtJoqDX/b/oGODsvcBTATB9gsfGqmzdjtVz+G+PAyamgYmZCoDjFE2anCVg1CeJwOMnTRB/DmUINVkkgia3y08BtkwDW+YqAFJFMD1VAAw6XG61R31O9/fdrcDYPDDmY0zjc1UjivBuAMx1QdMB+WAYXU8dhEU16dOSkppbcHFSrng8MHwnsGMPcN5ypURHp2xMIa7zDz2z8Gn/kVe0YomO0wEwBYKujL7v/zHA6C3AxfOVh58g5AsZxx4fZM7sf3h6BcDxWWeGBZ+cMEFiwGEHHRnDzun7ONHs/djkRgBunql0VDOSHIDU3cxSD4aEajhFXS4H4S1bgVGN0V8we7E0Fh9jVDG6Obr1LJMRwn+kOCaTEYT0dsfqZHXl/p7PrLi9wIY7gO0H2yAgCAWCWCowKrYE8nMLn/a7PQn9X7zIJPPkCcK+758y7x7guNsB6l98gZjLLYet3Ay5n0sv4R+fCYxPA2MOwLEAQLIDPyP8uBg2cRYmzFweAYilKkn+OC8/Fdh0CNhEA4nGA40kd6FES13WLO8v1qHKAfh9B+DoYjU2Ak/js/8NAIwg7OUb7LCC+WAfB4CpBJoIiTRNRmS1l13kqWh3Adv2A8cdqqp1MB+aIOSxWv6pq5D2kkIAvt8rF7BLJksN/jMqfa7v+7/Ak4B3A6ceqpasKMq5akAmlLWY37t8ZW97PDB2qALg2BxgAFwANEGcnI5JcrDZRPlkaXL4u1KJUAfAjbTQ59x6dSvdLPXAgGYshZWR6JIRaXB/NwFI8C1WwLMXzMeSwLfcXuKrA2G+wrLCDcN/IIg4ERRn0qvyySAQX6mG1XuA4fuAbTOVwktRRr2MLCoQyvEZ/UY/WwjAj3jtFJZkU79g1ghkgEBf98+0Umb/3A2M3lkBl/fOcdMok2EjkZyv8773LAfgHDDKjwNwxEUw9yailpwdxBAEYhBbAuGzG3aKkQEJwAkCkOCjlb7Y6SYyf2UwlAS+vKYnAXjfNmDEX7DEfA5CjUcsnzvbu1nDtUMmCDkRZEEyGdlAk6G6lQTSa6m0MP6HuY73AxNTlcJLZ6WOJYC5/CNxLpHMgdKIKNl69Qvu6/75AjHOiTU87gKOOViJb748BKCWrnK/maTA+58AjM0Ao7PA6Lx/xBAupoYDC9okBRAmPdBZ47lNA/DhwMRsxX7mPgl+SrmK5EaRNRslXFQ9CKB9DkADn79cZtkHFkysJ103eBbqlh97DpmTQTYgk9VNxu+xYbXKU3lhFoJPOgdFGY+lPkgQxokkgF9Xgj4AvfoFs84eX4Ke9x9fIC+tRfDxvvniif358sSir2LCj5wNjBKAc8CIi2AxxLCzIAGY9L7AhGIKgpATw4l8wToB0JjPrfTkp+SLQbHrOqm5jNyajS6VCMIpApDAWwQ4LrGgXqzIfnq5cv0vN0ZXHTInME5GBNLb1DGdOYQsI7AfGKFjlgqve8wJwG4T+fuFAFytXzCLb+VgWnH/fIGYfc46Hs7iHC8ZkPcdXx4VfVXJw8+cA4wIgM6AHSLKWZCTESfLfg7WsIyRF3ckiRQ+HACXkwHptyP4KHrpJvKVGnOhRF9eBF9wE0mUEogz2wC+WGI/vVxiQQIxAs9+rmHA6E1YFYB8DJwQMZl0OrLZ++i7sfT8zroYHLS9df4RACWKxSZvLXzG/fQLZqk2gqn2/vUCUQ9UZaM9wDaPeSPrC4A5C1KV+NITKwCS/SiCR/jRBDlLmP7nHynsxno1IPwJSyRpbiMADXzuPDYfZfBTEoAmcuVQdiaW0zwXwQsCYDYmMaDA1wG8TBSvaoR0G77EcGSET6hjOvVApfRPAUN0zjr45JzVcSqiTxD+VeGzXku/4Nr7JwDJOkxFIwt6j6+RqUrlkO4bXzp1gCAAv04AzgLDDsBhKugLFUvQUhTwCEKbnKCw14HwJ9cDgGQ9WegRgDI8XEcVEDvAl7lVlglAgi+I4CR+Zf1mLGgMmDFhBGFfDCicRJFERviSABjLS7FC0MFKMU+07wOPE0kGvaoQgGvtF9z1/iODkwn3VWoEXxres5ib9xx1wZufBAwLgAQexbAD0JiQwJOuJBA68/H3Zhk6+3CifqqwWNMKN8wjKgbk6gWJgC+FMaBb5vJVmsUbV2vCqo3cRWZcCIACoax53+ulkqNd7iqOcU1WcC9cxEm5kQBUdZ+sTnSL/jEtTWngi21jhJNJBivZBukXvOL+yYBkcOqxKjJ4AGgxzMrBVwdAMmHrZOAYF2l6y/mwV6xD17zmWo6MbRyeWtOHwxJ91IIhr6rqZS70DPPLXDVUrfBwzHKr1EUp6/h0T/6L/GcCqslt4IhoTcwdAqDSs7I60WQH6R329pHuFyuXDJmEjuOSbdB+wSvuP5bGUjmsA5XoUvcvBXKKAQnApUdXwah0b8jXR2YzJTsC0ZHB33FL+2yiX3h/1YeD1fFZGT81g/H6yqkVa9YEpqMhTADle8erHA6t7Mh6j4ZBXdBGjFyO4CSIm9wGBiBvgqxwIAJQlXIyEJLyI/i0SkAG/FbhaEr6BXfcv+5dLKhCg4z1C1HEBJ8+BODQGZXfk/quAZC6ketAZEQCTWAU8PIJt0fgwHzZvVWNaKqi7JLOmtDWFy42g1FxH/XfqGkII0C+a0tnDkfsGxQjn3VPsk7tXmuy+Xp0JhtoJosAaFcUAJUYKiYJxcqHqKAH9rPlG2cMrmCUbMX9guMLpGTcCMKDlZGhMK8IPnPIn1X5PA2AwegwEEYmDGBMjOI5whGQP3NPBT7VJlRNaKvF4t2IWHbDErtDlSk1p4lJ7/zd246tglGZryIfrFhQ7pU8WCAX0ZENG+57U14Z4YrCeLrSxXdev6TfLwrbxT7znMrfKQXfHLQCnyvmRIv0Q3430ezMmL98P393G3wqz6am1NYzzoGn+svqRmTAU2citctqAX/2EI8F9ACEmLHXLZGoFxtSl2xyK2bAYwrj6Xr12+1noL/jUTCD9vvFrn6u0v1/nvGkaoVBAQi0eummMAuXQHMWJAA7gCixG8U0gFfcXdlBKk4Z6zELgAJfZEKrxpC1xOIl/+Sk7jkcdYlSco90y9+gK6vJrRiADD0piad7RuFo3udNCgft94vCdrGXn+tujgV3QAcHLcFnroelivHkchEL8ue0uQ74S3eubAITS3IQhKkMRjBMokgWG3L//2z3VSnP4VDgQWxUEEUxAZFHL0eR3HDfm3IRbDHkBfF0zy4EIKNhSvr9goGEBdvTz/MIYQLQdVsTwRTFDj5jQmdArRDYJQNDSs961R3tPhx5NXoVgoxleHnarjohgLec3D2HI492yQNvIwvqO9fJm9zKGbAwnu6FhaP5pFuMg/b7tTbpBdvTz68cz/zI8azVj8iAHTqgmFHXDUB89R2dtaC7tUGw4kDOgFb0R2wYRDGZ8g9O8aU4XwPOczhiwGlMjqqLWiFYGu570wADFsbTvaxg8nkow7E8nM/atfKzln6/1mS4YHv6BQ4+Z0BbqHcd0NwwYbVD3+1yWhXJxPBrbq8AqE/XApSqAxiBV2MZ/54DMOZwKE00rnDUWcR5KiV/brjtSAMALIyn+/mCyeehjIYp6fdrvVELth8RAClyHXxmhPi6r1m8FM0ucgk8+y4RHC1kAK/5XgW+2hZYofafWcPq1B5AqDqEYsQ3nepR2gqhV2yiol1COkD0C+aOaoGx4aL7DQCwMJ7uVwomn4fm7VrX2u/XAlELth+5sHPtN+l/Ap6sX2dCsZ/phZkIJgv9l++1wbcq+2WFv2NXIjNKAPzuw7MUAV8DTuynFIEsQy83RgTAhiv+NgBABaQOGE/3mwWTLwAqHnaQfr9GnwUbARgDNBUlkpzQboyYCyYDYdILdf0l4NduW9kGoa4geNdazLElKoA3Prx7DofiETtC6XvE7hGEzJlpcis3Qgrj6d5UOJoYDcMglrX2+y0NPtl5UZUjkfx/Hqbecoe0OZzdF1gHQrln9Bhee4s3f3Zxm4MvAk9VSFdUIw0i+Q2PaBtISiBSSFgCYMjMW00MP7pwvvLDmwFgQTzdHxcOSGvBg/b7ZRZByWYAlOERluKM3Ra9CKWc0q73dTBhMFT4ZwIw9l5Lrpes+HjeBiGCUOKXeuBvPcKTiEIOR0f+RhDBMYi0Lhea4GTaa5NbOQAVDzhgPB1La5RssV3rIP1+7yy5OAADoAchEHBkFbKfGRpiweAPtMs5IFNokyOGk/7rAYC9OhBFwNXVY1at5tftCBHaWVS2AJdEcEinrDNC+Lumiyc1B8AB4+muLARAXTDCWvr93lR4/Z0Xt6ODFQkj8WtumEwHTKDLQejAfN3uds/dfjoQdatGLxb8jQBAYz6/boxiFgAVudzNIc2/s3xLk1szAORoB4yn+2DhaATAGJCtbpkCYq9+v4V+aBgAQ4i66XtaC85YkDog/zdZvzUgfN1N7a633Xqv6fe9msDIHfNaB6Ay2JRE1AHAEDIfI5nzZCLeN4Nbm9yaA+CA8XSsul6yqV0rJ2WQfr+splCyCYBR/HJyKX4phs0PKBZ0lqOYTpvniAiUAmAd+HKjo1cvDjHgr+3wPJQsVCymUZrPMuRsRBDG4AQCsunyJtFGHwAAIABJREFUcc0BUJlxQoH62q8ST8cggpKNAFRGwCD9fkuvbwAkyGgJE3C+Nz1P1q9/T3F1EZBxvZh50s6AEYC5yyUHXt5/Q8zI5/KrAmAIkkipkyGPYwXz1aRT8v5ZO6jJrRyAvKOvNXlLazsXs9bo/ztc29Pohgotp5J49Rcj/pzfIwGS//3OM4CNd1dpntQpFUmjEH4LYIgnyn/OLjL8FeDGhwJbNgFjI8DIEDA8BAy1PFK7FSKf43cNKrvHx+8C/vmxwMgmYHgEaA35J0StpvvzL/nP8RbLAfhyT207TChgDRiu/ZL9DsfWNABvYzbhCDBKoBAk/pEobGWTqp819hzQ1/0k0PoaMDEJbJjxVZFgDad0SaUO5LksWVj+XScDmw5UEUDJ6U4d0nVbC91S3ovfVHp5al64cgC+k7mZAP768KCA0WD3A/ieLz090CDceVmlAuhBljLgrfcAw6PAyDAwPFwBkCAbItM4a/FiNtERjBl76W9ffD2AbwJDdwFj+6syImRXrd5Y2FjIYcnzWPLEqnsfC0zsr6qBMQmfIDR/pyJ6xMhKyMrSDiKD2xja6TADTt0/AGAs1KcAUCFrOLF6tbtiRVFavT/wuMCa7MfVTlH098YBeBcwNAIMEYAUlS4uBULOmK3LCnwOPANlEIOSoF9+C4DvVoWXhvdWZVOYqWgi3vOXDUQhgieB0EElViMYJ08HxqeqnG8D4IIDkAzo51DKQQJvBKUmKACzbM4+5hUivwrgiwC4LzvjmgCh6nBcgiMTcv9Abo0D8E6g5eCjfpUA6AxoQIzgi8ALmWwC4z//DxcPPwBak8DQFDB8yJPpPZHeGCyC0KN5DFCByfh9/+OAsekKgEzCTwD047X0SCPM1IYQjCv2E/MJoGVwUUQoPboq0MdqkWVn7RtDDMahB4g+P6qhXFpjVtkDtRGA2nKjos7IyOyHFUbIrXe0FXsTuzIYfNb4O2M3ATGIYQOmPn6hG6gi3eUkQQAeAIYOAUOzALMVh2pAlESqGFBAXAYOMQVjxll03iO/yYKRAT0FQXkwZkjp1pz51LO2XAT3KtD3AIAwj4Wg05kfiuUHYlsXAJLVnP0INLM0OYFx78AzcRySeTsw2AJueI+Dj2Fne4EWKz5MA0MzDkCCkAByUWqsJzarEanzj2zXwjEGFHuGY+pYsMojzZL1G9EBexXou339IRBrC3lJGmNDuSHX+w7WC4Cm6wWxm8DngLTImgC8pBcGBuTXf/1fXnyTugnFwxTQOgi0CECyIFlsvvJfEnh0mhsYI/s5uxFYi1xZof7oOqSAawwYjRGBzYGXbtWXaCIrlvHUagX6SP/ruMVYCEbEqECXAMjfree2HgA0ESur1/0vtnNwGSsG0RsZME20/+/XWH6Mugk/yngPAGy5GDYALjiIHIgRUIrsZjM7Ax+BSx1S4pfffQVIep8dL7dMDsTGjJB+CvQxTHmdtrw4l0CovFruC2NOe975egDQsCXRK/eK634JhBK90q2C7I1i+Gt0jxF40k1cPJAB7UP2m3MGJAAFQrGei9iUTH9yBUDTHfU3B5+BOIKQ43BWtNtPcWIOzEZE8FoK9K0DCGNxLi3FqaKA9gTgeoFwPQAoI0OulWT11oEwiFz7cwbErzNxWtEYBB+VY76Vh4DWrH8IOoGQ7Ocg1CqMRLPltmxvs1/SHaP4dcAJePYyyUCRIzrTB8tE8FoL9DUMwl61kQQ87Rmy2PS2rgB0a1ci18RudEJH57OsY02y/+83/sZdBKr4FXQTApBvprGgQCg9UEAM+h9F6ugJDkC3gJPBEvRGrYoYCBX9IxEcS5K4i6cZAHIw8oXQ4mLBb35YH5d7OekadtTV1UZSjaEIPH4nQzYNwgjAHNwDuWGYpZc7lzPfX1cQur5oBorfzDf+zi0yVTuSkuxBI2Q+PhQDIUEnMLo1TBCZLufGw/ixbQa0KB8CTODjPohdY78IQmfDjmW7Yo/doAX6GqIiAtDHaYswSmeMubV81kp11L6hy2PdAcgblfslOKC1IiKRmyRxZgV/8++DS8BFrxXi5Hd/U6MeSKdqEsEKhpBRsgRMbAtuG4KU/+9ry5brzP/lPVMv1EPOQegharrVcgZUhVHFxNPcp9VFtlOWkL437C0WABWypFRGsV0sb5Hn2zYBwvUGoKl10v1knDgo0y7XA8Pfv0UACnjaK33Co9gJQAOe64FkNvtZAHQdjz9v2Nz2GSa3jYej2W3KGuZ9ixGdIVSoKT13B2s5AHkGheST6qn0erHv5AIgAAU+LVfw/wq3CEAV7clBKDDGZG9/5oVXx/oyYARczcqH5GyH8eFplTawFvAtrtXLGpNrQDGbejupB3omlIHQGc/ErzOcGSRs8zrhAbbuL1Tco/JfbLlNwHOmi2kIcs3owbdwNpYtynDQhsFcgvuG9/YapGFvYX22zZcAU0/GwA2LJ/4AmGF9mwEbBu98Y3cMF+uAGQCj2HVp3BbPuo3IlqxAy5wHAq4OfARmEBXGfNIBa0BIsG0ecwC67merHgRpZLwocrWaovuTxew/V0txJQ2DWeae3WAGbdhb2DB4+wRw7w5g8Qpv88liyGtoWHzMi4C9fAEHbBi8kwUKu2xNAdBxaGBLbJdZux1LwAGECYAEm6wyfpelJrEgFnRDxESwgyUxIUsVMwjVy5AYO0bG89Auu1/5BF38KqjBHlUAYXsteNCGwTeWNuwtk4JMkrlzGNizA1hm69g1Nix+zDOBW0aBeRZZGqBh8M4emfWNADDT+zqMjQyESdQFHfDbZECCLRgdHeCTe8CBaKJY1rDnBRCIAuGW4TYAZeFG8ZuMkGiQ1IEwGCJtHZBmy1obBsvVMnDD3jIAerti3LEBOMjGcOpa3WfD4ic9t6oveDtLfw7QMHjnH6wPAybW6yaG4+8D4HIQfvtDIVtLejpBFsVvUI7NIBHw3DUjRzL3rDVtsYPOkAScuX3coNDynT2VYJCkn+PjqvUD8hVbS8NgjphGxcANe8sAGNoVY/824BCBtIaGxRe8pLKZdpMkTvXiJ2toGHzSNHDPScAyq3er4qPyGaNc7JCRXWLT2TjwGmCOeQashq6+qSpZmp8vojQpheF58ncdZVjLnjWPHr4VWKTKxrHGUqq97qXu3jp0wPy+eEC/DYNZsZAO6IEb9pY9lNCuGPcNV830ZmkM9dmw+OKfbdcXvJMPdY0Ng0/7GnDXKcDMccBS7MwdKz8KCAKQIgY0MWGCtr4TOHAasMwOkTqf6unyuLykfd254nkb7qsw/iVg7jhgmSX31Vpd9yRHeLx+zRhjEGRbB6wDYT8NdymyubzDzCCGfpMJWfSRYfr9HP/aMgBm7YoxNQHMbQHm+ID6aFh8yS93tAvGQb7da2gYfPoXgbtPAqaPA+a3AEubgGU1RM6B060fgkRoCzj+TcD+04CFE4BldZdRc4/YxlxgjJMewSiwN1zWfsOngdljq3EmY08vm5i/7j5yIMqpvupKyGoNg9lngYosl9wY/0dZdrMzYl8Ne8sAWNOu2MA3zw/F2CoNiy99XbvftrcLriz6PhsGn3U9cM9xMODObQYWCMANwPJ49UliuW6SaqqBn/gGYP8pwPyJwNIxwDK76ahDeN6uXYCuYyABkEza4LbpY5WEWdSLxjF26/dQB0SJ6r4ByAN6NQxmkWcqrnQ00x1DEDJFjR8CcNWGvWVPp6ZdMQ6OVOCb3wAscPJ6NCy+7PerkP5Q3tBY1PrT9tEw+JwbgPu2AlNbgVkCcCOwtAFYcgAuiwWlM/XqDjMEbP9t4MB2YO54YJFMo/5gHIcALV1TRZ17FXOhPtvgtvkqf9H4kvHDlyKK4l6VzvVSBF22uwjOb7pbw+CfcwBSkyeFEHAUx/yw9JTyEbo27C17Ol3aFWNuAlgIn9QxO2tYfNlbK6MvaxeMRYquvL9rTcPgJ30TuH8LcHAzMOugX3QALo21WXBZLEHwRF1OgHS2eOgbgIPHA7PHAezNu7QFWFZ7JnXJ5rnqxHEulvlzwyVNN3+wern5Yovl7SXLGwvn4riLWO4fgMRJXcPd/+pmOymELEhRzBxJAo9gVL4kwVnbsLccgHEpWi3epocCAMeBRU5eTcPiy/6qtl0wpvhA+2gYfO7NwOQm4OBGYGaDs+5ExYDGgqP+ccAkINaVpB8GTv4d4OBxwNw2YGFrxYCmV0YxLNYheCXau7EhV3ga3Lb8g4+R45uoGLADgHWqhsBXA8K1AZADyRvuvtkBSArh+i9DsQhCOtf0UUgW/7aiYW/Z0+nRrhizoxXwFhyAi5y4rGHxU66qAFhT3rDSIVdpGHzencDejcDBDcDsBDBP1uX1CMJRwFiQIBzxieL3KIY1YW5MPOxNwLRb8gs0aghAss1GZ1O+SFHsdRPt0i/PLHu++dFb/x4mXfhcbWxhfCtYMFr/uWvKxfDaAcg7ipPCvFOVpuo3HrCjYW/ZA+rRrti6TS6MVQ+L4NPH2nx698GnXF0BsKa8Iab4dFZpGHz+JLBvApieqAA4J8CPOQuOBBAOV0CUYbIskRkAecrvAdNbXc/aDCxSpyT4CEIyTgRgneiLIp3nP6fs+a4A4N8B8/48CUC+ZGJA29fpuLmxJW+5h5kNFg2jiWHSi0r0Uv4pCoZsxw8DUfnhd4Vk0XGdGvaWPaBV2hVjdjgA0BlpkQ/K9bmn/HOVqtClvKEBqlfD4AtmgP3jDsBxB6DA7tdbcvYzJvQJkii2n4NOeMpbgJktbYPGACiF3wFoEx1ZMNe/4jnPLXu+KwD4t/5SO/iMBcXuesHylyACMBPDgzGg7opM8mEHIGdwrfGA1rC37AH10a64Yr4APvvOSdwEPOVbKxu+K2pdKRTmdI3dqkPPVgbSTBGAY8AsATjWniBdx0QxJylOFCcr6HBiw1P/CDgU3EgEIMW52M8YkLolQRddIN1AyKWiBretf9MJQN6HsaCPxe4rvgDdHOcOxDIAcmDFDXvLnk4f7Yqt63gEIB/Yoj+4p9xaAbBHeUPM8qF2aRh84QQwNQYcGgdmx4C50WqCFngNsgSvQ+Dxu4MuiawhwIAXVk1O+e/A7CZgThY1dcno1nHL2oDIyZULpBsAFTBZ9pjT0QQgn2V6ufRicS8QRgbs5ZYpEsENDejBfpoLrwAOjgIzZMBRZ0AHoUC+SOA56xJwNlEyTFw5FxBPeWvlzpnbANCdQ1eSGTRybMuydgMggVBsKmtYoC6Mt8znZxsZMLzAxoAOvsh+ydDqtXx4FIDl8L/omQ7A0QqA82S/ERdTI22mNfaTuBIIxR4BhKe+y61punQC+MytI/Zz/c9EuvyBeetLAfGZ5WOMZ9j2/gqABB1fMLsHAVBqhfTcyH5d9MByEdzs+B50Z7voGZX+NzNSsd8cwUcG5ASRKYbdHRNYwhhDIHRgGmO0gFP+HJh15jOXjnyKblVT5Cbfoq+yJOszF8P8+VnNPlICkMAzds/YLxlYznrJwIpO6egTPMqA5ZNDAB6iCCYAyYBcBqTRQ0e4630SxZyQJQIvMJ8mSeLrYe+p/GzGfnTpEIBy6US/out+K1wg+brs88rHmDOgAVCMnrEfxxMte1Mt6j7u9zzKgIXzczEBOJIB0BnCJoqgIfDEhM58SWzJEPGJe9hfVH42un/Mfxl9bgSiBySIBWnAJBDGEDAB8QWFA8wO3/a+wH4+rg4RLPYLul8tCI8CsJmJMQAOuwFC9qMI9g9Z0CxhZz65K0wfFBPqu7PEyVdWAOTHVlTcpxhXHZLz1w0ZA6EDLhkCskRf0sw4dRYC0PQ/vVSRAYPo7QCdj7GqVOSMeBSAzUzMxZcDMwLgcKX/zbv45SQlHXDIgagJc+bjZBqAWhUoH/Y+B2D0J7rFa6LYDRmzomsAaOeKqxEvbWacHQB08JkRIteSXiSBLYJOLB+X4xrzAzY7vgfd2S4RAKkDDgPzNEAIxMASSWF38WsgkuXLyXTRSRCe/DduSZMBMwe6ObTd8JBj24Aot07uDObPP9XsIzUGFPs5+JJ/M6oT4buxHv9X7BeY8KgOWDg/Z58GTC9Xq5FxTXOw9c3Cm6k5fPcjgbHbgAlvVG2tH1T3Oavoq6BlniZ+12n5u/2sDbOvasqoFg8x2Lnbcd1GdhSAhXN+7qMrAC4sA8sORJ6yHwD28z+Ft4fdv8UyqUDrDmCEBcpZ39kLS6aq9l4D2rLb/KYsFTPWdfbvh86vQu2s1K/K+zIjTsXIVQ9a59Egs4Y6sZfIA/EcSp/jEXv8BWcAhxaA+SVgSQAkGAMICcwVlNLlqTc9Gbv/HAA7MrL4+f1VlXwrUq7SvCoyGcrrWpGhuur2fNGYwM8YT67hT3s1LaZvqn5MLM0bzmHMmIFSgdFNj/mIBct63NhFZwEzDsBFgpDPeanNgATfCtGsX9TIKwNrg9tuVkhlng7TI/YArX1VkXKrEe1l2SynN1RCsFJsqnQv3UIMxhwIRjU5AGN9QUteVz3BUAvahuNgjC3HxLAND7nBp/cgONXF5wCz8xUDGgCjKPbvevlzcKUHH2ag6cnYzepYBB9Zi2FxDJdjoXJv1WDFiLJ6MKqKZUzoQFTfj2HmwTKcTpVWvcxHKm6kKgoORAEvVclPD6NdzLXpMT8IYNPcLV7yJGB2AVhYrAC4SNA5AxKM9ryDPE5fs6eeVKWGZ2M3S3MQfEyJUKV8L1ZpJXpVJ9pLilmlAxWkVJHKwIhjjD9TtVXVm1HdOy/pJiaMFRWM+bo0rWl4yM1N7oPhTJecC8wRgAttBjQWdBBGESwgSiV0Pb9DRgu0TY19N+M1mRKh8niqFx3rRDsLqjgl9yaGXT80vcL1wnE252PAZCzAHQCoiqoW3yYWFIt664fUpKaREr1NPakH6XkuOQ+YDwy4FMSwgU8GSRSz0UJx3Vx/5vFNbrs/EiLRY+v4ACITww6iJEodQKwBIyBRv9vwhKzUW6z66TUGEwhDS3ezqusAyNxnJn8xa1KRPSFts9YfFB/QDZcAm78CnDBT5U8rCqjfc3yh8Gn/hGd/MsKf1+QzYJ4891Jye13iy1cAE9cDJ+6FpYrEkidxDN3OtXR+FwBGMezoMmxJLOumAuD4J4rxJrfdH/XCoLGFVKiUbw+LAPQqWWaMMLrd6/+JycSIm85w9lOpt1j1MwAwFTiqAWEUxeYH5ENn/jInUVHeMXQ/f/jRePvCa4DhTwLHfBc4frGqqaNJzLPw6iZxV+HTplFGvZrXZT45N39+HW3TujlZv8D6fp8HRq8Dts9XIOR5YtakgBgdrrrt5Qsq8Ssd0BhQ4HMwmVitAWHAY/LbLDQNQDaTVJ8Q6W4qVB51OOqDZDPVB3TLOBepW5jmqaLbec3jGgBGMSxvvemDYkQ9GoKF1ShUCSKCqBeQrvmfVZPC1keBjXcCmw911tTJ8q5XgOLaQgA+x/OdWA2EGZ98gbjleTHdQHQN+2iwls3nK3/Zhj3VeQhovYzdxmArSwQgDRA3QiSCJUrTnjfl4KozRCSCCeYmt90EoJJbVCk/1+FiCwFZxLk4dRfLFia6x8LbYkD9v9cXtLG6+O4AYQRfrgPygVIcqyhTXcWFOJH8fh3rz7EKwnUArq8mcGwK2MCC1i7WY7Zenh56feHT/jE3yliE4TZncd636gPFCKWavGhcRx2J+cvs9MlSw0Ty3cCm+c7n0G0MExdW4BMIbTXE9UCynvyCCX+Ovm4gbByA/xisVgJPpXrzLj4EoRJjJIZrWHArS9iprK+KcefgiyB0XVKGjOmCmW9xhRVMUSyRFnNeFGEdI2q+/HFXclkp9WsAbgTG9wGj08CI64WxRk/OTDcUAvBHXSLQxcVCDMQSWbzv+1e7WVbz+k5w2tJtsbcCYV6WJY7hmAsDA7r1Sz3OgOgoM+KTOJbcjSI5yGIaNE1uuwlAAU/MF+tF5/0sIghVLdVdM2S0bSzHx2Mi+FTxXf8X925NC4BycK8QwfmgVX1LlcFiykEMcL2BndJJ7aQfijKfxLGDwAhByM7aC5U4qwPzNwufNnNuOH4VZaCPlPo2AahqFqoPVFc14ga2m+WEEL0cAz9kdPrOmMu8r1o/rTsXz7f9oswFs+jO6LAqkvC3Ggg5Fg6mwW03CUI6X12h8lyfcz3QHqr3DIl64DbqaQKc9mI87QXACD6vpJqY0EVxz2CEyCI5eMSGX2e7VtI5J4yTRyZhscrvt1nQuivOAaNLlYESwcySgiVbr37Bfd0/u31yEgg2FVaiPCeVOguqAfGov0iR0R9JABJ0bnwk9nMxw+fOh55EbgRhzozrBUA1polN9CLwok5HEEUQBjFMQB7D+j656PW+IrJ8O/bBCo4sGFdGejqiyYCx3mKe9/JtTiBvmI5OFiTisg9LtJFF7gZGDrUbHKs79+hyu5hSaUvh1foFr3r/6vZJCiXgCDwVVFJ7MVmRLsrGltuFCc68yFdACMDAflwR4QM3HPoKgIExt4gz42SuaQb8hBOE2oZmlu+KFlKR3QSssMJxDPWbbjpfLoJrxG8CYT8MKGZSVTCxYFTIb84nkCxCIPLDiby30gXFghaF4c2ReR466Uu2fvoFr3r/fKAEFxvpqMcd9yonIrkuK5LLV7MVCM+/uDJCyIC2J8a0z1iwqyESgMl15Sa33QKgmtPEBnp11mwuXgO70Ud4DHWzfgDYC3zBEOk7HlA6XKyHQzb8HgGoCSQLqsxorIy1Bxie7Wx0rFaf+wr9Xv32C+56/7HbJ5VHtRYT+GJrsehHcya57PyKAQk6+vBkBZPpjPEExlwU59awg3C24W6KBsC6tqHR+MidyVG3i3rdAnAsH2T093XT+zLr197MTA80h3SfsZP2UqpCrPQ46oF317VrpeiKXTJ9MhMLkgGdCacKG/mupV9w1/vnwyGgCDCKWzJe3lqsyzLWZWe6/kc/oKzgKH4jC7oolhdC4jiuzM0WPo+cPQ2AsX1obFCTO5Jzn566PwbReiwnfTWjI4KvDoh1juh+aT+WKSYD3i8Aql2rJk+VsVQly5kkddv2FvHT61icqO7Fr71/IkLNXOi0FQjV0046oBy6wZ922Q95ICqDEaL4XWw3COcf9Mw73DFB9AqE6wZAAS8XuzGQIDKf+oVkqxt00ttAc+YT0PJ9qRFSB8xoye5Xu1ZVeCSgCLbYLVNswoncHxoeLwCzBGjBNki/4BX3z9lXgUCyIIGmhova83cRgO5Te9yLgP3MfmsBS8xs8/U67ePQOqy9umBUruDchqo8sHSd3PMfT5ifo+ack8eFHI6QEcnT5GvdOnVdXof+ptJ+BVPWceiaRHA8Us/nkACo8mzqlqmWrbFDppT5A5UIZm7CPA2Vgm3QfsEd909kKIqB1qJAKCBG8ZstZz3xHOAAiwmpDIdng1maZQAkZzsHZ537YfQrwNyxoQ+HakrnS0h1mUA1C96TdJTmORyhC3oeqdwROi+GDhkFI6bYNrcNDEDeAkXwQizPRpmnIs3OdqZPSaRFUcbchHlgie6agq2kX7Dd/+d8lUJVXuUzk8ERmS+2vfd4uvN2VOV5rSwb0y3JhgIh9wJeN3YMQCIgR78Q+nDEVYBYZUrUpbXFnM7COSdf7N4IPvtDnT2BY/h8Chh10MXQeYGS+7GGjaQiABpuNIFiECnzdWJMIUHcazLptC7YivsF8/7FgLFMqpiQL5TuNbKfA/DC46rqqAbAwIKWK+timRUBEiNGsOQsyQm+Gpjd4n046hbT84KPuYjOmHHyp92gcgDS2OoIuVIeh/xyUkaVwyEWdLrewHE3uBUDcKIwnq40HpDXL+n3CzbaKdguel5VnFJl2awaghLQBTzteZ0cjLq2A2n0M6EPh2pC57Wg41poLzZsAZNso0Hw6eVR/J8bF9YjWGmVCpGKwQLBRCcrbiSxNLgVAxCF8XSl8YDHHFPW7xeFBRwv/rGqOKUBkODzqgdWPYAM53vTASMQu4Bx9J+69OHIF+N71F1O1gUB+AsBfFqKC+4Wi4BWX+CYgOTAU36wdMVNVKka3MoBWBhPxyiuko3xkSX9fvGMkqsDlzzHC1N6SQ4DoINOe7KelWWTheziObeKCdARApD1AdVnRH048gKUAmAEYi6Oh4DJV4VoGDWqjq4XLbO5o1jBoimEPhPJmwu9FvnTLgdgYTwd2wyXbMyRKen3i2eXXB245FlVYUpVxUpGiLtmGBlrTEhVUwV8dEkVKAq3MHJ1uzRbRx+OOgDWFX6MsXJU/36lJoEoA2AKvw8+uwTEDIBbStdOs8ddDsDCeDom7ZdszBIs6fcL9ror2C75US9IxJJsEsHdGFBil4yYuUwknofJgF4XcEUfjrz+X7fKo4EJJ//PkMORO6FrVjQMeL5kJhZMMXzLwNZCt1nzDFgYT8cQwpLt4hDON0i/X7ys5OrAJVe0S/ISgFY7j9ZvnQ7I3+lyqpYaL98CWp/N+nDkZdhi6bW8An1kP3fRTLKVWlwF6RZCH2L4zDDR0k1IqeTNb2OQSYNbOQMWxtMxeqtkY6I+ny9VEz6btfb7xc+XXB249AoXv85+tIBVgJJ6n4lf6oV+mfjdDJNMH0wAVFX90GMk1f5TxlS3Fggh92DyN0IORy5665KIfCktsl+K3VsGtpVOWOMiuDCerlSnjQ2rB+n3C+pIBdulz8wqonrNPLKgwKaC5B3s53qhXVq6oDNg6sOhqvqhEr3V2VNLBjmnSSNdrOLJ1zkAu6VPRjFcFz4fXDJ8i45hG94Gt3IGjOFYA8TTlQZ/qGH1oP1+8ZtlT1MAtHK8mQg25zOZUSCLIliWcbw8wfW5Ln04ssqnHX04euiCk6/3de66MPpuAQVZAEFkw2MKFw6a1wEL4+lSBvmAOMhD8vkOkFX77feLNw14YT/ssmc4A6oOdHBEkwXlgjH2k4Nal6wB4fIuX9LzZjAmorNeHMo5Tc0OewHwDTUh9HXxfGJsYkAbAAAgAElEQVS/uvCpoAcew6zBBrdyBlQwwoDxdLZWXLDFkHyF8xGE/fb7xR8XXByAAVC1oB18HQYIT+8uGfP75SCUs1o64he8v4j6cIQ+IqkPhxrBCHjdjBH6AblQkAeY1ondukSiELmsUPpjbyp7XuvDgAXxdNZVvWCLIfmKg6Bbhrjup98v3lVwcQLw8gqA5v9zC9jErutltg8gMxDWWMBaMVkmANWFyEV6R0uH2I1IzW7ypbkQOTP5f2ch9KsFkwp0kQlDAOmxzHpscGuGAQvi6VD4RgmAg/b7xZVlT5MATNXwqQc6KGwf2U2uGV2uzg3D4ua7fDnPwZcKgIdq9GaIBPZb0YdD7hgyIFWMXiH0eQ5vXS5HcMkc++9lz2t9GLAgns7KxxZsCkgdtN8vWD+vYDMAUpcja7lOR9eLVcIP4tcuob/3AOHCdW02VTX62ApB4Mv1v24gnPy9HiH03fJ366KYHYTHsgBBg1s5AxbG0+HLZaOp65i+ln6/YM5EwdYBwGj1cmUkE7+8THLNdAHhwrUOXtcrO/pwhF4cct2oN68BMDCfmsJM/n6PEPoYPp8bH3kCkbtjji2tJJA962YAWBBPZ0WBCrbYsFoOf9pDAiENk179fkuvf9nTXewKcBSjsn7ldonWbgQpx+26otaLIwAlfi2QQSJY3Yjy5i9dmsFM/oEDMM/Z7Uf0RiYUA7J+ToNbOQC3e0WBBm9qLad6HICG1ZK1XB5PoxnuOOIcxSXe/Of8xHV/P+FpwN47gKUpYHmuSve0pKZgCKSq5wqniWE1WZz/xouBm74KTMwBI17lVBXwtWSs+8/vL45Ff3vhpcAnvwos8d48DZX3M2hx9XIAnu0IIO0chu35AOgLL0yuG/jOmwbg028G/mNz1YWdETbm4I5BrFlov+EtD2wIo7l+Atg8D2xY7iw3V5diEqO54mnj6XdMAYcU+6gon7A3NSO2qFjlyZYDkAX6uD5Iam44YaUfVNDNxaJcLIPXcGGpfi6PnZdVD1wPspQBX/wl4OaNwN6Jqg+xwrxslcVFuYJblehkcYYZGPS3L20BxueBcS8nwg5H5kZkx6TQSbXFZcCQKadx5Cz5mPurAFxrRaa17pAR2PFC+ElSHKQ/0QjQcgCyGyM9v3SnsDBRJgL6msWCf6IfWeUJac8UFlpY8500DcCfvgb43hiwZwyYVhd2D/VSrKGAmIDnBkiafEcN9cprHgKMzgNjS1V7rRjRlceyrqif6KAkMgXIM+6tAnDl+zSL36O9+U8p9jGHQo285/2XA/AnXeNnKAorDXH/AILwbSvLEz6Ql2+cAf/3XcCdw8DkKHBwpOpFbE2wadzIdyh3jjNQirYWEwYq+/zJwMh8pf+xKNSwM6DZMmzNRRbM2K+2Ii6TlFrAWfd5V3i/F7IgT2LBF5LbIdkqxLPWvtzlAGQ3RpU3Y7AiixMxLOUB2t7pKQ8M0qCTnp8HkojJgNqaMEJesQv4AR3Iw8DB4QqAs+6SWRiqgJgY0HVDAdBA4Ba4xN7ndlSFAAjAYX4IPO5dBDMAdS2i+Jx7XTf1eEdTDfgAQnR34p/wQkRmjNAoByDT/ugFphXAmjAEn8qaPQAgZCs0lSckCNmVigEbFMsPBBE3DcBX7gLuawH7hoAD7EM8DMw48AhATrjtQwiXoqkTEwWd7LOneXNCbz6Tiq/TInb2M8ZzIFrTQbGiy92oGz7pXl/7jvdAJnb2470IbB3T77Sai+hyAP5voTqW6sKwFAc/TAdc5+3dvcsTrvPVYSK4SQb8xV3+6IaAqSHg0FDVh3iOIFTIFxtit9orL5Z/LD1Q4s+B8OnHVuXwhhdd5DoLGsgCCJ04q66X/Ju/vSaeAxDPvbdtmdtKDV90gVEPIl/xySkviOhmAEjrlzSkwj40SlQZYZ39I+8JBMx8mZryhOsKwqYB+KpdVSDFvhYwPVR9BD7uyX4SwRS59nNI+bRck/DzJ05v12M0nY8fAk8iWL5BB5qASPGRCi8EVjzv3mqpkC9ACrrwhKukB67GhpqRRowQMqCiYbj8oOoHeUWpdYIBAUj8c8WjrjyhNIJ1unzjDPjqXdUjJAAP8TMEzLYq9uOHICQALe/EwWe+QgddAqCzzD8+vgIgg0qp+5nYjaDzCgjmnCYone0klqP4JSgvvK+6LoFPoFMlkPGh+0rPWta4RHTNJJQz4M8EAGoNTPVU8opS64CC9zoAWTFChcq7lCdch6s3L4J/2QFIEBKA1P9mHIBmhPh3Ai354RyAAmWsR/PRs6vOR8Z8FMPS97yxtIlYgVB/I7jC0rIKSfLXF1EEB+BFFjQ3jCLA49OWsRTTEPzvzQEwry7VrZ5KwzAQAPssT9jw1dcHgCrORQCS/bgn+1HsCYQSveaHkzvGv1scgU/6R55Y1YIxhvOm1EZekQWl8wVDxJgwc88QiJc6AKX/meHDawX9z16M/Em7bO8Q08GBP/jEkAEVjMBoAFWXUjRA3KtNwOBXW3EkAZhrALktpC6lKtTV4OU7RHB+3kHWgv/zrnYZl2kCkF4uF8MGQGc+MqEYUCA0n1tkwxbw4ScHAHr71Q7W4++c8czwcBAmHVB/c7Bcek9b3FuwbdD/kjGWgzJjQ3thGmVA3jhfOyU+RxB6FamOFp8NrhsTgLy8Cpzm5QlVptAU+6CiNgXCaIQ0BcDYV8b0P4pi30vfIxD5+w72C9aliegW8MHzqrmh/meuFhYi0pKbs6D9fsh/n1XFMrYMbPgUByCZz6J+uEknDA9AornWFRb01WZEsACoHhOqyC7wdetT0QAK2KqOb5MCUvPyhLE0oQxzqaYNXL5xBvyVXe12vByLADjXAvgxBvSPGFGMIjCmJbEW8HfntxtQmxT0cmxp9UPAdKAZ1upA6EB7qgDo6oCUxXRtPVSpAwJpnUhuxAqWCCYK1MBExZljY5S8SYr+pxAFAuBayhNG26jw8usCQLX0SAAkwwcAEngyQizaXoziIli+Oe7/9kJvNk1LmBMe9ECO3XRB7aPeF0EYHNVPdT8gj016YBcWtBfBVYJuz7mF7VgGY/pO8f5WdQ1/7U67nIKNS7j0wIbDPFZsyNHHY7od/xdlEHj8CcC3TgCWHgGAPSxiSdt4312u/8SPAl8/Dlh4pDeZW2PD4J1c9+uyDaIDkgEJQKnTfG/N8nUAmu5HUnMW5ARbPfEuIHy/ACjRK7FL5pOR4RaxgTHofKl8r/S1ZWBnAGDKefbn3AFIPRPXB7sFiVQimKVgGdl5ooNwLQ1/1U+DQGSXQ9r5Evy1q9rZbP1lGQDZsPpzI8APHgXgod7qUx11YtBbFzC+/C+BL7SAWwhgdoLkONSLqy5oLogYft3ZI1F7EAC+phsAnekokhP4HIzml/PvthQWmPB9LJ7jxkcSr14jWj4/0wFlgJD5eoDw6fe4DzAYPHokWhHJZ3TFSkn4h7YOSOBwEtiMTv1aY0uktFYTmI2/43EMQmCuAJmUE0gmVD8EFdPpdnxhVhqzDr8F4NMtYM9Jfg98EVTeNu9Q2OFZBX7vr9vtgm/lcezczZ61ZNN8DCvilYCdPXqNDQpAlfGTKm0M6AA0PTAyoMSx64cRfPQHXsniOTI+fEWDFGp+Qb9BeySRBV2kpl0QxxGAlHDmkI56X6z+EP7UDYSdRgh/IouwIZ36lHabBE0GJ0r10Rgb/xA/tt/j/6aMAf+7R4CxzuBXWRGULwBfIrY6UNfpvLae7n0I+LO/reoLMqiVMbW38oUhkNkQIzZO7tIweGePcmWlAFTjAYHPVGwXxWoLYblEDkLuTT8MDPhXLJ4jALpaJB+ggU6xfgJknT7IKXIQXh4Y0FZCog+wxiUTwSkXUbSMV1rB/A31OXWuFpPUda/mRHKi1e6U+hA7Zq7l+A+UAfDtHg/LrptkQpZ727cRWOL9542Pa3rOvuOqagUltgtmJM08j4/PILbIDKz6w5PAHsbraTnMGdZWIwIzxIfeK0rn578J3LAVuH8CODRahV/FFQ/1IumIvXP1QudNfyNT8oVqcHviPcBd48A0g2RDuoDqHdb2SalZAdG9dnfDkAE0gXnH5ijWCDbKCq5/MRiV0QD8HgHQ63jG0hdsLGxA3x9Bw1Asli7hO3BwApgng/Gjvq01IHrXJ7q3Cz7E++YziF2rs1ZLZ+8H9jJsSoECWXj6igmR87aLgfbGq4GvbgLu2gjsHwdmCEIPSI1h+SkCRjpfUC3iNWcpoRrcnrYbuGsUOMBo7QBCxSTG/igxVcBIVGPWM1h1JYQPnyKNExGZMDIJ9b66eEBGxPDY1Y5nv+GCjfGAxD+DDpiawphABWZPjwNzNLAEIH4XCH0M7/5c93bBfI8Yk2cgVAdvdT10ifDkBWC/r9lGH51NhIsnsWHOfPmEUKT94WeAG8eAO8aAfWPAwVEHISNQlKQUglJjJExqC+H6Nq93kOpUg9szbwLuHa66QzFWkaFieXxi6hgVHOMCYGRuJ+5V4jYJIDKI9KlsAvFDq8QDrnb8NWVPh9EwdFkQ79TlSMIsN0Mi5s9MoOGno4U6f3YAvefL7Y7rvdoFLxOANSA8f7xSgWmd0kCQbmZ6mTLEnJ0UqWLhUkxlrBn6n3wWuGkYuGukCsufGq2iojnRFpafsU7MDxErJuZhYCsJosHtWTcBe1oeq+hxigJgXBrMmTBPnJKLrr+VED54ibHYvZos8sO+DNcrHrDX8YVVyglAKud0LtMjFPtNMz6QLDY7VomLJd671AEH4Xu+3g7nWq28ISvX58/hguOBg8vtFQvV/hEzxfqOevuTfpjri8vAWz8L3NYCfjBc6ZYHmBcitnFd06pxyb8W4gPlgonBqffTtdTg9pybqiVNBssyUsdUD7eGO9amnf3sXtxQipl7Wg/sD4A8AwHIyZMYky50Tp/xgN2OL8y051qw2hXzwRCEdT2nmck1RxHG+w5jeO9NFQBpR6ldMIMXlFWgVndqF2dVFsJzuOgRwMElB6DcI6rznemD0RnbwQiSRS3g7Z+tVIl7PC9kahiYZm6IizuLigliT/VoUog+p8P9l3wJ7qGEanB77k3VczroUToWLCsABud4ypaLCUoxf9i/9w9ADiICULrQRWuIB6w7nuZrwaZwLBGwClSqSyz3AhHbaRGEFGOmC44D72UVgjW2C2Z4lIF4ArjodODQcqUGqAxfcpG4mJVuVqcL5tbs2z/veV0tYK/nhTAqesYNHdO5PCJZos+WuzxHJIViuXFyJxupNLg976ZK2lizUKodilGUgzyGhokF8yw5Mf+qRkjdjfuDtwkkm7DTkNaBaQ2ox1q3eMD8+B6O3H6em8Kx1Ccx9ptWl9iYIUAAWrI3I3nHgPdOtsO5eOuxXXBdj0V1vOL/so3Cxef60tlSpYwveKf0pAu6ohfdJ8k4CUqgvr5jV6VGTBKALeCAh+VbZLTnh5gu6D44A6H8cVlkNK95O1WkBrfn31R5HSy+JCwPplAxRegE/2T+AloGncNmbQyogUQx/KwB4gHj8YWNTwRAOW0FIIIndoqNkTAxz/bd09XDGLBdMM6/pLKi5whAX60gCK2ujxzEAqGL2pQ1Jis5AJEAFHvTujYAKjRf+SEugm1d2COQLU/DAwQ44caEw8AtZzSIPgAvuKkdrWMM6M7xCMBoiBn4YpCE2NCfxWAA5MEuwvCCEICwlnhAHV+YORfDsWJGgPpMKwg1b9QpFnzHbD2BK2JGul9s8KkYW17vLALQRTCBpzXZpS4gtCXXMAkduuAy8E7PijPWprXJ5CR38ygw1fJDohh2BlRAgq2OeN7uTWc1D0AFNtmL54ESBsCaJcLkDajxj5ZXRiCIGA0waDwgjy8sk5+HY+X9ppUbJSCp6TnFCMXwny1WAFQ8rUAc2wUrRL6mXTAefWnFfnz3FpbagQKLAqAzoZjAKkkpXkNO5GCEvOMLFXOnnC4xIKOjnQGNdWSM+GqHQGd7JSsxUf+JzQLwhTdV4je1nQvr1MkPGtlf9yP2Dy+gAqZ6rQytfvdHSDxgLwBF8AmAYjHWluEDiKGMiqOVvtejXTBOuRSYJwDJAARgZAGWL9Nk+IM3SzgTydE4eec1nZHbtDaNAf1Dpd/SMx2END6kD0oXtFhBXmcY+OY6AFChnKnzl7NfdMR3qCAae2B+VVMYXASvDs3/X/zHJZcB84vuiqABEo0QPnhnwqQLyRURmZBPytnwHde0M1vN2lR6picoKULaxHDIEdHkW2iWg4/7b5zb7DSQAVd0/griV2JYojfpwRGEYsGBrOBmx/OgP5sAKANkcbFzNWTRnX/GSGImMYH/LYlk+gGvdT+bW+SWH+Ig1GqL5QeTtR2EYj5LVHfjw/ZDwL8yJ6TB7UU3VVoTjTYxYDK+Ivv7dzNAZIxpZSiU8jjKgIWTcykZkBawDBBnQdMr5QeTKI5iWCB09AmEb7+ucnOQ/aTPWn6wuzyS4u+R0Ob6CUGqJpIDA97AdqINbgRgBJ69CG4Jp6q/ckjXqB/RKla4WpkO2ODgHoynigA0JiLwaNiEt95YQKJ4FRC+7brKzRH9jZbN6iJYuSHm9I5iOAOhHNJfZkh+gxsBKPbLu3+JgaWDdojhMO5kkDWSlNTg4B6MpyIAjf3IggJgMD4MCARjFMU9QCgAykhSKnUCYHB9JB0wy5aTRUxmup4h+Q1uAmDs+hpXgFLnB6ULONOn5xACNJqxghsc3IPxVBGAiQG9aLeilWUJW1FvVXEN0TKp1C6At19TMSCBpz1dHtT/JH7N9yaxp6QkF73KBxYIr10nAMproB44qQGTj6sjUrtOFPtLeFQHLES9AdDFrq1E6M13MaxVCTNAXNFThIylLcor40zxtgDAPKuVwDMrOKw+SBTbtR2MND7sZwC7Qvm4wqHa4T/uIrhb+7n0EgbQdTijoyg+agWXT8llDsAFWr/B8qP1K7bT0pvtVwHhW6+t2C/m8svvZlawi2CKe37nhFtapkDnILRqBQA+v04AjMyn79EIkXO/DnzyCBwVweX4wxs9B4rRZgyPVFqykgDd+5JSpBU5r0vHyHz+jsc3ub0KABsZMCyQgeExKyFPVIz3lmcM6OfPAGCADYPE67Jfs6h7G0o+xvi7oyK4cLZfOgpsXwC2Lq9MwuuVERonKn4nSJrcXnQKcM7dwMMXgYcsVxkSebJgzOWPqdB1ad2f3gpsnwK2LXWeR9m3danUIV1lBSCPArBwtp+7DThuBti6UDWDmWA/DvXk8LRptfPtNUlihYZTOPCi04GH3wFsnwGOW6iAs5n3GeJJ+KLoE+9VDClQ8R6vOQHYegDYwuY3S6H/iJ8jb11ck0q9Qhoc9QMWgPBZJwFbpoFN88DGRWBiqQIgWyJY3lPozaGJ1KTEPh36zpTkJrcXPRE44S7g+Cng2DlgyyKwaclfFoIwvCwx9Zn3Q1DmIPx/2/sSaMuusszvjfXq1ZRUElJkKsBEGQyYhJCBSkUqAW1tsBdpuxEVaBzowXZqe1g90G2LotjQdmMjKqtBxQERdAWUAkUlZNBGkQRNyIAEMAkxpFKpqjfUG3t9//m/c/+737njPq9uVeqcte66b7jnnn32/s6///3v//++Tz0dmD0KzC4DM6vAFpd/0L3Gh6yTDgnvLwKzAWDGiH/ThcC2OWDrErB1pRgQisIQhAa+AED+HEEY6uNLyrRnZLSl6tSbrgLOeBQ44yiw8ziwfaV4UGbdegmA5QMTLFlqsfn7XecDW+eAmePAltXiXnkuZSBkRcm4UGXtU2uo3xsAZgz6y54JzMwDWzkgBOAqMMVBCSAUObh8QuN/CiTgcWAuyWhL1amvvBbY+VgxbW477paa7gIBqCnUrbUBiQuhAKDUot13IbBlDtiyBEyvtO5VDxvvVfxW/JkWNFrCeK8NAGsY7BsvKQC4hQCkJNaKy2LRIsg6SJ3IQSe1onKKC2CsOYMeN+0Dtj0ObDsGbFsEZmWp5S74g2Ir2uA22BScAJGA+dJFwPQ8ML0ETAUAkgDTPq9zdK/+sMWpPF19NxYwA4g3PtsHxAE4SQC6FdSgmGWRRIJLZJll8EGKjHiX1jwaN10HzD4BbD0GzC4WrsKMW2pNobZoCu6CLCDfCTqzgg6sr+wFphaAKQfgZHKvpRSYg7HN5XCL2AbAZwPrZGaj6ippXhgn0kqmU1woxnHedg5AATuWHig2FE1uVRwoxoX+Wcbg89S3AqCKPONcCi8oPtVP+9++G3j+oSK2xRBFDElUxbTS+3nvc4FpDsjxllXQoJg8FgdCQoGJJTTicLcQ6vPL6wbg9cDM4cJv27oAzFA5ky9/UOSvmg8oP86n0dICBn25JwjARWDSAUgBHN6vfdbv10AbARh8X91vDM2ss+NvAECKPVLCsHoyUgRqrlbnRwB933OBc+4DXrIC0IEmiLnE75di8HsyAcjzWUVGUi6uICMpVwwJVMXdeOk3XAxc+Hng+vV2esAYw+sWoP31r3eLcLwQBeQUrEHh4Jo2h4vDmJPuAyMLGAeEn7uqbgB+I7DlSWBGCwe31Gb9aL20kGDb/EGRxY6WTz8f2wtM8l4pgL1SgM8esHCvsuylME4nn9cfQLtldg6TZ0kUKorAfij23vAPCmqp3fcCl60XFINid1PlZrf41/dnApB6wSQjutUfIDJR8CGIQOwWEH7DywpKrWc8CFzqRLHkVYrB2jS2FQH5vkuBycXCAlIUUAAkCM2iRBA6+ARCe7DjYmQduLYTleiQ/XTTS4DpI+6nLhZW2nzVCEBaMLd+soIGqjD1ampdugiYWCpeBKA9bBJC9ActAk8LES26SqsftInLZ44dQif4Igdhym5WLrPDyuYH/7HTCNwDnPko8LXrBccjQaioe6BiKad3+QY/MGTH6rS3OBvCnQDuAIyqhiDkQ9RX+29yE3on8IwjxQPI8zkTiApGU3oVkD/4fGDieAuAdMw5MFQjEgg1DYsUku+a3uI0TGBfV7PotwHwaOEmbHEATvuDIutni6UAQoFRIFRYhfe/dhEw7tbe9Of0Si1g8HkrwRcevDajz07gIJ7n05rYyWIpb4ya/7vv8PRdFpj/LXDmkQLAnA4jCCOlTBRN/rFMAJKgkkVHpGUjySSBSFeg7/azqk8EgbSEq8UDRACLKDXSyaQ7Br//DcA4LSCtwnKhTEkQcmAIQhtM+Uaajl0uS9NatITXWzpzfcdNB4DpY+6nBgDaCtanYLN6fCj4u1ay0QIqtML/EYC61wSA9tAJeP6eWsAoDysFpg1eB0HIQRCIIkVeCqQf/05P3WCB+UPA+CPAzvmCaFWDKEuYcl1yMN+Y2dckqGTeHPEvvWDSNhOAfbefX0A6rS8CUw8X9066bFIfdqMHJID++DJgLACQumyc3gyAEYRRKFCLD1eu5ODLF6QvXedx0w3A1BwwxdAJLTXjd8seQnGrZ9bPFxLyA7WIKON63tYtCQBN/sv9QPm6BkLp0vl9t/m6ietR6fbyBA4gnXtORwRRpNnTtPpW6gWLH83lKqcOFTEnDiKtoHwy8RNFhrefyeztbnrBfbWfgttsP+kIyO32ELD1cHHvInrlvWs6TsnB7qAUlg/suFtAWkE55zYQ0QpqcALoNCXTEt7A3KoaDwGQfqoAOEUBa7fUbKctltwCajVbxvSiyvoasM0BaBKwwdKb9fN7NfcqBWGiSWykWXER0umeacUEonQgCKRfIgDFjya5yq8Wfsfs8dYgiuMxgpAg/vnMzu6mF0z6Zj5APdvPQec0TEosnvQosGOhaLuIYvnwEYSithE52F1XFAA0p5yigD4otCqygFKnpHUpLYP0OcKURYv6Mj4MNR433QhM0gL6QongawOg+6rl9CswKoSkEIxPyTsuAPigCYBmAXVfYcVf+n0SRYw6dP1YwNgHsgSajiJP429RrpWOM6cxDiJB6NINM4w7LbUGMQUwB/M9mZ3dSy+YVG0EoBiDBST5ddZ+PkCsAiIlQZDa3LVatJ0WXG2PbL98AB+4omB3oP/HgTUhmGgBfRqWf2TTrUSjExDSP/qWzQDgfAFAWyzR8rkFtDAKX75jo6nUguZxZ8NByHbvvqBQ36T1swcsBaBAGGRg40Ir+rt9WUDhQ5ZAU7Es2e9LLzglqHRxNkbeuW+oQRRls5jaMjnK0a9ecNf2R4LAwO829kQB3LTtEYQPUwzQAWgW0AGo8AQH0ljp/V17pm0KRcEifGuNOnocO1rACQbKPXhs8TtNwVr5uh+n6Zf3wDgu29g2FdMtOc8B6PdpFj08ZFrplw+ZA5FTvAQQ0/BT36FPDkRqBT9Jag7xYlQItY0f88j78sZzCcKPZlrAQfSCK9uvB4h577SCotUiEJ8opq8IQFl/PUBPEoBLxbRE62LSqG4dFB8r5bHcOtiOQSqT5T7RKzYDgJx+BUCCTxZQCwhaQc9oKcEnEBKknj5FsJ1LAPo9xoWWPWDy+6IIoqbeaO0VA+zHB0zxIQDKkn1GgtXiRxMIAx0Vn0Db+lkuFjLRCt5WEwD71Qvu2H5OfekD5FaciQay/GIbFgBXriwAyGmJADR1ck3DwTE3TQ4B0LetzBJErTYAr2BBSI3HTS8tLKBZPo/fWQDZp197Z3scjGb5BDp/L3+njMweB6B83Gj9wj3atOsPWin9WgXCFlVO/3ctf4iD8XkBkH5USlAZlNPZAQqARr5vxu1yjmH0givbX0UQKI63o0Wun/xHuR8E4VnPK5JQLd4VNttTBvK2uoiKOUf/f+GjwMNBh0NMV6J0c0NpcRv7mrYv3kh8/uHxYp+bVpwLp3R7sts2YzouSq3KGa+q7+x7Co4nazAerRKsVlV1QitF59dyyFZaYY0HMu9mWL3gtvZXMbymBIFMZ1ov2h0B+LTLisxgW+Eq5uU92iZ72ud9vvR+4JFp4NjkRh2ONi0OB1/UBCkvEYRhfuNs4OmhhiPKnFQlx6aAjMnSXJUAACAASURBVPjmz1w41nnwO4cCIBvBwZgTAOUHRq3gyDExD4zRGVYEnpm5LqmQc0M5esFt7acFl0SlHiBxuTkYxxdaihUC4QVXFu5FCUD5QtJl85sjGA0ziQxqeu/fem+hw0F2fLLQGxFlYMRvo7v1WmIVtpt1DFkXvOR7LwJ2HSkyoZmEypoVVe8p7b6qEMnidGG/Vl/L2aPOIwuA1pAIQE3DAmFa4j9f7CPaFpCHKujr5xzZesGdHqAqKz5X+FLRAl58le+jui+kTBALMcgZ73CDBkpN2/7+bfcWOhwUyCEAjQTcAVhKdjkPc2RajewKyu/n1//qJcA2uhBMRGXQOcn9U6JIOjXHQqSYOsVoQp1HNgAvz8yny80H5PVz9H6RqVd849WtXQ/zA0Ow2ayGLJ474L0G79vvbulwkJi8BGCg4S01SKqofoNvSIC+5zkhFUupV8rUTpJN06KpaBkFQm5M1HlkA3AyM5/u9Zl38zrk6f0iU6/4hmscgK5ISUtCTowyDqb7UxwsqFJW3fo/vbuIBJEZ1YRgyHwQKNi0KEl1OKTCZJdxtPDn//v8ooaDaVgqFyiTD2IKfcjZS4Fo+7g+HXOPv84jG4DIzKfLzQf8KVfI/FNKrQ6h94tfz+vOA9cGAAbrpylY2SDlVTTt+uCnV3/V3a7DQQAysJAwobZJgUXi78Qayhd812WeiOAZzEyUiAkHMeu5BF5FwZQAWLPwknkLQy9CrPMy8+lIHZFzvN3T+YbV+8X7c64OHHix74V6zIxB+RJ0wQ+UU992tYoFy3fcXcTDxQkoPsCUhFIczKVCegSg5B8A/PILN9ZwxBSxtiKiUAOi7JW0dLTustF8AGbm0/1o3vjjnSGdj+lYlGwdRO8XN+c1wABIoHk6k61yuSCJITq3jDY9Vx0BqK++uwAfX6JkI/hME0SC1EGguiQ+isqcQRLrF6/0jO2w+6FMnZhyZYsQ1W50qOHgPX1NXndtODsfgMwHzMin+0+ZN0S9YOllMzWfLwKQSS396P3iY3kNOLDPM1y065H4gOW3p4uTDkB8zWdb7FgbdDhEgJkCUDRvogTmd/vPv3BVAUBuvylNzAAYi4hisVQnEHoIqWblrxqm4Mx8ujfljT+YjsWBYgIOc0oJPsq1slCpH71fKybJOEoAuuVTRSCnYlmU6P/Z4iSJEcbLv+Yu9/1EAh7JKEXDKxq4ChUiKymRbwjgHdcUWTARgLYXHSr2LOU+BV7MVwzxwOfkOWybYAGZD5iRT0edjpxD6VhcOQ6j94tP51wdOHBdMeXa9OqWRcmWXA1XLUIUH6zyCwlAs3z+YBkfs1u+VIejJEF3ckrjI9T0y/aMA2+/tgAg08VURKT8vbKMUgAMIGzzAcOi5HknHQAz8+l+MW/829KxhtH7tTz+jIMAJPCYMULAWd6fvi+EY9ouoZBM/Kx/4LUBgFLgNC5o16FrE8JJVJgkiFhaQQBv3+dVbMrWVsC8UxFRkjjaVsW2DtRdOJ/vAyohVYK7A+bTvTdj8HlqTMcaRu/XxHkzjgNkIOWuDr8jnYYDKDutgpUhra0uAlAyCCUAK8BXcjBXgLCk/h0D/hcByDxFAdAzoFUqUBYRJTUcMWdPP7ONL6i5bLQeALJRQ+bT/W7G4AuAOXq/lsGdcRgAY+glLkYclJVTsa6ptCX3uQjAKINQstFrAZKIwWxQIhIJuovB/Nx+r2LzFCwlj8Y0evl/MYk0kieVtcvrwGUnHQCVjjVkPl3mItQsIPuElx9G79dOzDgMgGkAWlNyBJn8xKprBRC+zgEo4LWRgcdVcOCjjlNvmx84DrzNAahaFZWLygKWxUNibIhTcPD9BMLLa65bzreAMSGVoXvJ/Cgh1WUfO+XTZS5CDYDs9GH1fnOrIDcAkABTTDCCLYK0Cwi/586WcKJUiEpC8CCBYDsiiSplqUIUmOjf+o2tIiKVUJbgU5uSWl4DWwX4+PcXnrQATBNS+8yny1yEopdcay+930y5YhgAg+9n2OoUeI5TdQer+32fdhmGoOBZanBo+g1yEKU4dYgFSvqB//vZBIBt9RshkTbW8ZZZ2hUgvDL3iU3uux4LSBM0ZD7dPRnTH08VAIfV+2XAOucQAMuVcKfFSD/+IAABsEoGwYAoHZIKEEYxRIHwLS8pUuhjFVs6/ZZhIVWyxVKBBIRXnbQATBNS+8ynI4tBzkEACv+chlUVIKE/5cRGsWmlKfIzudc3APLQSlg3E2OCyVRc1kpU3DgBmKoQsWtlBcswjPu+nfTYtBL+GQdgOf16GCZW6pXlBCqWSgqJypoOAFfXXDifbwFJLvi5HAjlnUsiIe6AjOp4iQNQHRlT2PlgJCUbbc2s+v/hFwFb/q7gm6HlYpBbmTV2sscQyy/qFBj2v0/cAdz/HGD7NDA1AUyOOU+1CwWOewNjKj6/O03F1/WuugW4/XJgfBoYmwDGdH7IxB5kLPIB+I8AfNwZgga5ck2fJbEm8V9zNWPfrasbgMuPAcuseJ8Exsb9FdBhA+7gaQNKB6TfcgCYug+YJT+g89aoBDMmIMScP12uTKj13uDv8zsKig/uJ1uQOsnojm3qB5P5ACRBH3OhPuzzRN9DV88HqQLEWPJnvTy5nm/t/1s4BcuSpRZtGAu4fi+wtBVYEyccrYwn6hF8/FkJp9bKxAKVFsn/d8urgbHPA9NPOEOWl4+2cfoFHhfVrJTZPKHSj5daOtup6JyCpPx8rHWRVQ7WOlrYCMx8AHIzlxkALPD9c0VB+x/A3E/+E2fUYHXdF7KTGwdvTd0AHP9r4PgWYG0KWBdfsBdsMPfPrKKsoL9XAVLAvO2fFylCE4cKliyrDVZNcGS1CqEYhWFiAZV+XntaURdTLmpCEbpchTYLqi6NrkMCzLzt5Xc4HwyJmmkJ+Z73jQOh4NWeDUZiK1K08f0EXt7CMHVawIk7gaVpYJUA9LI1Ao8bzKX1cytoFtFfpdCIWz7rgzHgth8u0oPGDwETc8CEMySUzFaikgtlpW1Ta8JqNba7lVljSRgW+Q6ZP/57WQvj6fydBjXfAjKbgEvMLwWCvhNoipgNpnQshlS4IGFWzIk6ylWwAz93ETLxGWB5ClidLABoIOS7pmGfG+33YAG5mND0G8F4678vkiPJczNOAC4UyQm2N8w94kirFlfIAl7i402d6dbPWWAtrsjOFiuCvAJZOQE0pHTFsckHYDeCvhNgipQNxoAz8/8IPr5nbvH2jd+6AThJAE4AqwTdZKEBLDoDgU4+YVkPHIBoPwareOt/BkDexsMFAFnbzNJYm0IDnVwbt4uyur1kwL7Tp+iZM/08WT9Rc7DHUmuYTr/x+6o4ovvu9fjBbgR9JyA+omwwxvZI5ULg6ZW7y9FPf9QNwKm/CgCcKABovh8ByVy/UCtJq2f+X1yYJPGU27lIZLbuEWDsWBHesZeDz4iURLUWa1TE47LqK12fZmd3OXidFctqm92KatVs1jAEsNv6sdymaa2g8+xUL4I+Pn2beCgbLGWHI/h8G3oTr45iK86POlbBU9yKI/AcfLR+ouQwH9BfmmbLlTHboOnZ/T9+5vaf8FUaAThXsFOQ45mUcgZCWTAxe0UQ+urYMO1/37GtxQmoLCBtRSp30LrDp2SFdzYMgk/R+VNwvwR9mwQDsaspGSfJgYDYNTbp8psCQFJxEIBkQjDrxt8dXCUIY+COH5MVFPi8SOn2n/QYLZ9Gp0cxANIP5IvAkzVzxivRydnKNzBa8fddM84b6AFyAriMF2pajk9kYIeoClXmA3AQgr5NQEHMBqMVFMNaIOayNRL/vhlH3RZwmhbQQUcAasrVVGz4EtjCu/3dfb/ID3PbT7uKAZ/MhcIC0vqRTo4W0IBIEAmEtFwCYqjW03bcmdwBYeoWgetUbrR8snrloiR2drpACf+rD4D9EvTVjIJu7HBV+781X752Czj9lwUZkTEgcPoNPp5Nv4oBRhCG6dd+1DkMz1JIhR1BAHJ7zwqO3fIRRM5tmDK5CoQKsSgOeBYBKFZULTqcB9r6Ni5KYmd3WKDUA0BlhNLM8EbT1QBXBU72aI5ZjUcVOxz7WLkQ8d37vsart/uA6RcPsxNSAtAXHDYNC1AEpf9s01kKwuBwGU7HgVt/1jtD1e60fgQigSe/j5bQp+KYpGB+H62jT7P8/ZypBIC8Dhcx8eY9wF015abhmnoAyJ5WSrKeNgKO9SHxnT/LSasJBim5lRjWBEIVeROInKL1qunybRawLgASdEy74qjaNNzJCgqEEYzBGvK0297mAFSHEIB6ebKDgc8J1ksmV8t29f1en6L5v6cxIK5iK6Xne/5jCTiFcTqVn/r/tWDPWwXnEPTVgIKUHU7ljASawKefIwDpMdRxRB+wFgD+RREDJABpwSzz2c0LfxczVjkVKwaYgtBBezu3SvX08d39P5uO3QKahXMQciourZRAGKZWar/YZ1xXRPe8wQr2AUK7TvbOVTZBXx4MBECRnConUBSFEXT6mf/TK+/qmzAF/0UBOPqBZYF52HrTFCw2LH5G8UCzJEko5nZqmRnPh/uCXmpnVpDTsIPPwKApOaSA2QLDLSHf97iPx0tpISLfz7bl4iFfsUsnj+HZWEeOYDCDnDmCvZkEgedcCjxGseIhBYt3vx049HwMLRh8gA9gh2MoH9ABqKJzxf0McO7XlSAU4HzhYYFq+5D7hwBu/98OQLlIBCKnW39SlXNY+nqeiq2dkQg+gnGPb9/ZpT0lq6MV5D96gLCwgDmCwbdnCvZmCgY/dxy47xxg5SWuUjigYPHFbwA+fyGwfr2rXrMvPB+vp3L3GHCgi9JOHQCkRVPppeUBigXLFymyejYTB4YsgfA20ofRAlYB0FfAlvQqP0/TsX5PLOB5DNu471cmIwiBaRww/F01J+mz2pqChxUMZvpJlmBv3iTocsW4dzewfhkGFix+2febXDAeJO/YEILBB7pU1g8LQFo98QASVGYNQ6DZfEG3fnEqrgLhbf/HV15anbkFNCvohWSl9XPQ2XTM/2s3I4DwPIZwBEDfgitH0Ek6N6x+u/iD7T4g/YdBBYPpWHEaHlqwNw+AQa4Yj54JrJO+aQDB4pt+oCAyYvOPEIQDCgYfeF/9U3AbAMX7ItAlVtAspKZdz5SOlvA2pstxjES3wJ+92NgAGK2gwi78QoVfEhBeQACqNNP1RdoA18kKdgDhxkUI/zKIYDCnqyzB3jwAJnLFOEIW7QEEi1/1Y21ywVglCAcQDD5/Efj7M4CVrZ5AKlkhxeQUaxBI4nvFzxf8IfCVC4HV7cC6ZEX5nen3VX1vAGLZq8ysrvHY+QBwbGfI2E6JpLvdX+ksthpUvQrmX/sVDGZVUJZgb17vJHLFeGQcmCdVb5+Cxd/5xjZ6QzzMLOQBBIOfTV2Ps4HFHQ7CLQUQmUrV0rgKJMsCjsxGAqTn/hzw0EXA4tnAyg5gbTYBorKkUyLnkB9YVhTxu+kT13iccwtwdBewPAus+b2ar9xJAafqfgMQO4dh+J9+BHe5gqZZZzYok1JJUcpaR6bp93P+W/N6p0KuGIemgEWKgPQhWPxdP7NBLhiHKYHUp2DwpZ8rLOD8tmJQVplOLxAqmbRKC6EDYC7/CeCRPcCx3cDSrsISrs04CPm9ArZk55UvKAspYLqPaPdR4/H0g8DRHcDyVr/X6VabLHk2PhjpPVZY7d5xwF6CwS9y/4LbbVyQsEKIufGiKe0p2JvXOx3kinF0GjhOQY+oNRtljji9TQPf/fOV9IZY4Gq4D8Hgy/4W+Oo2YG5bUUy04vUcLCqSJVRWszJbNgxSmMau+q/Ao2cBR88EjtOqbgNWWaTkIFz3YiWrF4nAjtN0nBZrJnU+/8PA3CxwfMYB6LUra3oglL0tps6wlVha5rLiqd9AdDfB4Je6U0s/0BXTDYh80Sr2FOzNA2AXuWIszABL1JaKWq1R+nwGeM17OsoFY5XTVw/B4Cv+Djg0C8xvLYqJCECzgsxmZlq9T8e0XGUyaUizavPtxoFr/zvw2BnA0Z3A8e2FVV3x6c4sqwObckeyhiXAowUSADhD1XhceDMwx37lvU4XxVN2n3rJIocygkr/Vbs7fe+EdBLcfaXXQ3IPWIrpBB6XlnwpR76jYG9e7/SQKzarxM7qJFj8mg8UarMV9IZ4gvNDD8HgKx8HDs8A8zMFAFnPYQPDl0Co2g4fpDZLqKCxT0/7fhJ4fCdwbFvhRiwRgJruCOwUgCpeCvUjZmEFxhfk9W969kW/B8xvKQqnVgg+B6CB0MsI7P70AHgmd2n1NQ0rv7FvALIlVYK73MnQCDLThSGZoDpuP7uCeuX5n8zroB5yxThGnQ0CgyBMxY63Aq/5aBHG6EBviDlOLV0Eg1+0AByZLgbl+HRxnZXJoqqttA4ODovlJZVuSjTQFtq+NwNPbHMAzramdVpVs6wEoPtdNg37wJfvsYiJP9NFqvHY+7vAwjSwxAeNxVO8T6aNVRRRlT6hHrJ0Ovaw0WDJCKng7g86APvNB9wg2JvXO33IFWOBgn8EIf2nRLD4tbe1+AU7yAWbZeskGHwVdd2mgAUCcNKnJgLQrZ/V9/Jnn5JUYmnAE3hCmv3+t8AWQfSzyPK/POOgJgDdsgqA5nfJAvLdLV+bz0kK4RqPZ3wQWJxyAPqDVhZQyQr7gyaXI9axWCFVAGLvRUhV46PgLnUWBs0HbBPszeudPuWKsTRZAJDTo8l8ui/42juL5veQC7ZpsEow+OrZQlqVVuH4FLA8WVyDAOTAmHUQCAWQkOlsQAwDt/9/AE8SgPQpNa07+AhAA6HLXbb5Xr4IaAMfv/eGvP5NzyYA7UGjBWTWjh40v9fSyscHLtaxhJWxFVsNNAXH1khw983+DYPmA5aCvXkdNIBccemfceooAfhAAcA+6A2xLuAGucxrzgKOMexDfV9OwbS2BB/BEoqLSrBoYGgJ3E8qLcIEsP/ngCPuUy7S13L3wb6PU56/m/Xj4Ps0TKCXQA6AXuNeZY3HMz5QANAeND1kwcKXlj6wOZQ+b7R+Pi0PD0DeFAfk590CKg8qncfoFzIRVWVqfFfBhgn25vXOAHLFWCDbvPstBsJZ4LUPt+jdesgFg+qVptWq11bg2gtgfuLiRAAgQeg+oEmsOujsXb5SsAoCIN/3vx04OlNM6Yv0tdx1MKvK7/TFjVmeCD4HQQQhf159eV7/pmc/kwCcKABoeYvR0oept7SEoZQ0Tr1lPuPQFlAtO0nyAcWhpzw/FSjFzGjLx+RGvxzoSeC1hwsA9klvaFN5FAy+9mJgnhaQ0qqagglADo4c9AhCDpJPl5ZommQ8738HcGw6AJBW1VecZv0cePwOY0/wl1lAD/WUCx0mMlDLr8bjmb+Dwp3x4nkDYbD0thIO5aNtfmDi/xGEeRawxhs7Vb/q2huABQJwAlhyy2cC0xoggjAAUCWWAkksOiIY978TmOOqeqqwqAx3WGhHK06n7TDwOcAV/iipPAKjwgrZm2o8nkUA0gKmAHTrp+o9MTrEYvq44o9pZIOtgmu8mafCV72YAKT/RwAy5OPOuVlAAk9Oule6xQRTWUKlWtkU/IvAHAHti5oIwDK841ZPFtCmdr0U8PaC9hVultd4CIC8P2Ztt/m5/qC11TJXlJDGGpfGAmYODgFoCxACkLpuWh3KCgqE8gNVZK4KtxgjJAB/2X1Krao1rfN7CWZf3LSBT4uAEIyWBVpipL7GgwA0AW25GbGENBTRx3rm1M2w39mmrFVwjTd1Kn+VAZALEE5LtIDyMWUBvbLNLGHgd5H/V07BDp7r3uU+Jadgn3ptxekA5MBri0/Wp4wzBjDbCnkMWMqVpE8GJwLQqvfc0pqbkVj5aNk7gbCxgJno30cAjntowtXNaZ1suvSKNhsYTcVKmw9F5xGE+94dfEoP+JYhD/8OC8eIPUsUHokVVKB78XszbzAF4Pvd//PCKVGIpOAr78mn4DZOm8YC1jco+w6EFTDDPJqeCEBZBa5GffVbhmQ8DtZW5TYOvPhXip0GTuu22lTMLSw+aAVl9QhEWjurI/aQiLJkTMLsX9R3r/ymZ73fp1+37OU9hunXSkdl7T3QrhKCtlCM59k2i5CMMSIAGdqxEIwrmptzTsCEut5yilKoJLAcxCq3fe8tLCDBFwO+tKjyuxSCMdYEXoeDrHcHvu0tTwLzmwHA4N/Gh6zNCqqeOSxC2lb8tQSiMwbuqXIqAcjFh2JjBKGJyShQG6ygVbfJegULWBYcMR3rvb6oCRaQwFPgl1M5rR7/JtBZOIZWx/0+s4QeY5z/1/X2tFnAxPpFELaVkdLN8MWGVr4pCBsfMHN8bmTKfCjZ0Ncp456/x58zLzfw6Qf3ABd8pUgEYmqk5bGyek06IQl1bkXScnlN/u8L24Gdx1qVq91KQvrpgwaAAw9p+wnXPw1YjyWMGtDo2ASOFGMU7SIEUzdYD34vMPmXwLbHgdkFYAtlGiim6DpxJtvq9LtlVr/aWKEB8pUXAOOPAFPzwBTZ9r04vdQ9Ts4pAZ3cd+yHxgfMAOH+vcA69/9Uxijmz/AerYpdar1lNSMYzV+vWY/34I8DY58Gph8Bpo8A04vAFEFIknIHohGVR62QhFRSYjQE6qFri2z3iaPAhHNNlxKwArI0Q1IAxwfReacbC5gBPp66/5ICgLKCtqnsrKKlrFZUFPKOr7osMTtdsxzqQRZ93Q1MPARMPllohUxRqkEK6gShOP0S+dY2hlRv99y+ovRi7IiTnTvLqmg6xDPYpqAUgRgsoR7MxgJmgHD/c4E1FXu7FRRbvEgd7evXWlbPpp9EgUjiJpwe6zwOMlvpAWCMVusJYPIYMOlSDZRpoGiNxKzbdIQlXONMWJbGtw4svdgz3El47nzTRvPrrKptAJT6ZrzfintvAJgx4vsvdQvIXK5VYF3sUZxmJUvgA1FOvwF8spKyBtM1y6EepI4LqVMedbEaTp0EIKdPKh5FqYYqSxgo2jgFr13j6XXHnOiSZOeBVSvyC8qC2r05FVvVw9cAMAOA178AWPMp2LJaaekiCPXExwHw660n1oB/niGQazwOkkSepbJ/72I1x4CJ+cJ6lYI1riccrVicUuVSmIW82pkwnHHVOKbFsOozQGkFkwewnBES37ABYMaAX39ZAUCCb82nIlo+40p2gNnvsoKunxH1xGwA/LOzdQOQJPIuHzV2GBg7Cow7AI0l33XfjOsv6oVodes6ISbBsAZMX+kJxU56KY7pkmFVhOciuvTzSt05v0+ryuT/9gDrZNe4wPMsI7VJP3GcP7gUOOdvgL1rRYJ0ZI5IV3hV4/wrGYPPU3/AiRhYusy2K7mU999P+z90ObD7LuBZK0Xdkeq9NSX2+o4HLwfWlopFCC0fgciBMtAFC8CGrYXVoVjnU2G7rTXrzh4kfRzLY1kyGwBoeiGcPiXb5eAzdXWnazPCSScb4j3xfmav8Cx2p50lAMW0VXINitCogl2r9H2dcctWwQxQsn6ZTBbMNtcgdKIbiZj51VcBk38CXPxoQcfCUg8pjcYgZScw/momACnXyr4leBhs5QaBTHpf7X8dMPYJYO8XgAv9e8QJlAZZq8D4xSuANYKPJQn0AR2AHKy1MACKe9nfFI6IEqduEWoHIJ9wlsVKLekoMCa9EAegSTYQeM4TXco2SEMkAHEbBZoj4bbYtdyCVrFqGXgTSxgXYTZeHLi9AMjEQRCVUXP/n4KUaaT8vVTi+Rtg7GPAuYcAWlMCgUVkQfJ2Q12yBvPXMwHImhDWwf81imsTiLSEvHZkr+jY/p9CQRD4p8DOBwteItai05qn31FFdfLlFxYWgCDUIkRkj/TxbCEi/89jfPZ3X2VqYSJQbmUNQY3HQT7hbv2sLoerVwKQHNEEoCsm8R4MhPRjXUGzVEIKIoY7yaEYuY4dgGb5RXruoSgtSCLLarkICQ9f6QNykGjFdjsIBaI4kGlt8W+Rg5g0HJ8qAp47nihAzFpuWtPIMBZJlASILvR6fQ0DCVbJCkJOJCqnk4pGpb99tZ8MopyiKDX7WWDiwYKXiEQOehCrgKh+eJQ+EQHo1Lby/zRlyf8TIbf9XS5ftIb8I92YugH4ay2pLusorl7dAoonWtMwQSTdOFuQSLTGHyIC8kxSIQuA4hwU2WUAoO4/grBcDbsfWElSzg+JCoYDoEGM1ixSkHzgF/wG7y8sIa3J7JPAGWuFJSQIaU01iJHUiYP4e33BrPOHmG/JMaOfTZVYRhwGav87vWKPJ9/rSH4IOGO5sITqg/ggxXs4TOaBAECbeoOsgfl+DrQShFqcEIhyyt0MbMusEkx76iAZXKM8BvXiZAGlF+KaIbaadYpem4aDgpJZQz6YJABV5VcHAJZ0v4FxX6KG5UpYs0KnqjhRuagEVgPglYAl9ciHf8mdUrJh0Qx9vkDBzBywfbkYQIGwahA/kglATsHsDzKA0BATiPyZ4NEDwIeoa/uFYKKXL2f24nQoIgd9R3yQCMTFqwIAfdBWI7+yB5ZLECYLETd85YJl+2YAUNosLIel/xYlu4Jsl6bhNhD6it4WJCvA2Zc4Gxo73RcgJeOqFmGR6rcChLYACyGojmEYdj59KnZ+tIQRhH9IvWA2hiREjDeRI9Cly7fMF3EtWRFawhQIf5IJwE56wdTIYdt7tp9ys1K8JnoJvod9Wn682PNkP4hUy1ndWgstAtBDMLYN5/6PAc5DGNoF4SrZfN+4+IhT8jqwg2Cp8ThIJ5vfSWBXAVCrWN9SMxDK+skaOvhoAc8me654pmUB3f0wyt+E8FyRAGmPlOEoiSD2qgvmAKoOm52fAuiTDHSyIRxx+lI0QxxADubfF5vffMmSajrWlP7nmZ3dSy+4r/ZzAUEHnQ8R70HsXlK+PgJsW68G4XYGZj0EY2EYATCAT6tAhmE0DXcC4faapcwMgAIfLb0kuzT9Qmw5uwAAIABJREFUSi+EfeALkSrpBovbrQDnkm8wAo8/E3i+CCsZ98NCpAp8cUekZyBavI4ET/TnaAk/RQCyAXy6uNSPA0i+wMeB6ePA5HFgZq2wpNGK3FUDAHmv3fSCe7afX8CB4UNEEOolVi/3obastNwJ9cO5BOBKEQMsAcifHWzRAigWWAlCn5K2bQYAOe1KMjTIR2kRUhKVS7IrLia0v+3xwHMZMCbYNP0KfG79zAqK5DxOvyEuWu6VD5KSHy2YAEQAfpaRdl5UkuUctIpBnCIIl4psD03FtIIP1ADAlBuJM47EqqUX3LX9kSBQcuuyftK78xUkHyQ+RLqHZ3Fv1KcgLj5kAQ1s0Qo6IA1nHhNLQzA8ZxvBXuNx8DcS5UYpNnoYxsCnUIqvZo0F3wPTMa7Hv53HOJVbS/l+5bumX7d+5WLE44hxIRJB2NMCqj9ixwuE90svWCaIA6bAp959EKeWChAyA0PTOV2unGMQveCO7bfqHbcS4rJR7Ewqnw5AWhLuImg2uFQAXAVs8RGmntW4+g2hB3P79L/EJ9zGvqrxOPibiVihAOgrWQOf/EBfBcsPNBBqW9Hv6zzGqFzmoXz3B9AePgXiq6bgiv4YOB9QHS8AfpkAFMMjrWAcQA0iO9XJiQyAnos2vV7ESHOOQfWCO7Zf7F40mZFQScRKAYBaSU6vAVcTgN7xXHiUFpDTMK2dFh56912BTiDcvpkATIXzCL4g3WXTZ4jpGfjoF/oihL+fx+0yWUABLwIwtYKKIabgCzHQvi2ggBKn0McEQDaKT5cGkIOo6SuyYzEfjQB0EM5nZgAPoxe8of3sgSqCQM3jkdFLvpRvR13+7UVRuhUFSavNO6otwp88ZZ3+t4M6HLtch6OT9AG/q9cmtf//gV1JDYcnQ2zY6/YakfSrU+Pg1M45NqPt3IEtoM7WFHokyrWKkooglCMWLYjiUXMtK3g8Uzd1WL3gDe3vRRCoUEYCwGtYFxxqgA2E/jI20F5hhmQod98BHNnlxOTig1aGiDanO21yV4DygWuB8YeB6fnC9WEtiKVVKeE0ZGiXWczeJoWMIig5a9V5DA1ANoKDeDylZ9NSXxyAsiKawrQqmCv2HVf5e8aRoxfc1n7xs+khItAUvojvyWryxVcWJZksVSyZoQRA3dcAoHzax4Gj2wtu6FVKM7gMgti02jbV476oUJJs1j/AbA1mQ3Pm8eTRsoZDtR+xZKCiEKmMXTIeXHPGdhYArX8FwG4DGMEnAHIK4yvT58nWC2b73cexaZgWWaEKgU1gjNbPP7PvOYGsUSBkv3hBtmRWNzxjTk9RWktvxp6POj0vARjY9sWkFel8RWxegjIF4RjwAOnZWMPBTGjqvHmszxJOBUD3xyznL2bqROvoP3N3q84jG4C7M/PpcvMBef0cvV9k6hXv+2Yno5QfGArRbaCC0mWv2YtF3ecerNDhkNZIIsXQRv5dlTtGADJSz2gEE1EJQM//026HdIEZLC8B6A0tk0g1Ja8DuzJdphS82QBEZj5dbj7gxZN5er/IZI+67pscgE7QaDOUMyC0Wb8+gXjuR4F5J6YsaXnFhBoAGEVvUhb60jISgCQnoh/OLBgvIrL8v7DdFkEYM5dtNg97tvz5zJqzdfIBmJlPl5sP+DJP5xtW7xffnzeh7H+Z+3+RpkyWT1YxuURJYVtx6T0fCTocouQV85VkHRIGegEuEv/YKpkA/JceVmL8kv6t5/9pu62tfiPWcFQVEa0DZ9WcLJEPwMx8uvfnjT9IgZyj94t/ldeA/S9tMaGa9SNdmsIxbvVscVJ1GScoMt4UPwhAsmMZ0aXzQBsvdGRBjQz0FUpEJRAJQOq4KAnBdz+sfiPJ3bOYn8fsykyVWMfiN3BOzckS+QDMzKe7OW/88aqQzsfE5kH1fvGjeQ0wADodmVGwOeiMsUqHrGOnS4UFy9P/wAEojkEnI+IqOIJQNLgpCXhcmLAtD/D+kgQE235L93tj+YBqgTX9BiCeW/NedT4AmQ+YkU/3sbzxBymQuZhm8g1T+QbV+wWFdjKO/Te2mEFNlCb6gPF708VJ1TXHgKd91GnZpDfi1k/gM2vqU3DUnCuBmNQe3P9vw6pe229KOvB0K1k+ZS+rnrfM2AlA3JMZtah/EZKZT3drxuDz1O/yxAwu9JgJxr3lQfR+8aa8Buy/wdWQZAVl+ZzCrG3q9c/YrkmHy3IRYryAAqAkEBIlopJxNNUbER+fA/H+/+AAdP9PmS9dazicJybm7mlB8nR2dI1HvgVkOlZGPt2nM29GCamcGZjAwlQ+vvrV+8X/zGsAAUiLVPp/wd+zaTMFWw+/kAA0GQQnpCw5mDsAMIrcRB5mC/+MAffTwgfwKY2KfmCZ6ZIkUShrxXxBX4yYaV8Hzmcn13jUA8CMfDqWYeQcSkhVOl8U6uxH7xekrsg49h8oiCENgC5TUG5vKxxT8f2aRtOtcAKQ1s8soPuOVUIwpchNlEEIOyNSIrrvv3hwnckWIZPZsnbcDyzTpvg3lU8mpZQqozyfK74aj3wAKh1LgrsD5tMxiz/nkGD1sHq/YNFOxkEAcuW7oqmXlisuQOT7VV2jwi/kTgj1RkoZhBje8Z83SCAEEJZW0C3gff8tADCt4VASaWIBK0HI9q8BF5yUAMzIp8tNx5Jg9bB6v/jdDPSRns0BWIZeUitIo9IhHmhXTvzCPQddccnZ76U1V/IvC4SBCFyg26DFNg7c++Mhhb6qiCikT7WVUmr6lYn2nRKyrdZ51GMBlZIc07GUBdMjny6XCiUmpA6j94vMZbgBMFo552pu27PXAqXTyAUQcitOQjAm9xX0N9pIwIPmSCmH5QuPqER0L4kDYgp9zOUL6fYxkbZcFceyAreAF3GlV+NRDwAz8uksnT3jiILVSmpWNlhMze+k94vMZfgGAPJeHDjpCrgM01Tdry9OzvmYAzAqLVWIwEShwzbRwwSEn+MqP6bQK5tZlWyhjCCCsC19Xv7gOnBRbgp7cu/5AOyVjqVMmA75dJZ9nHF0yohWNlhMxKnS+0XmMtwAmFq4imnYbrEqNJPc+9kfd62RKh0On8qV9hXZ9askEPgAfI56ziocUgVbzGT28lEtRMoKtg7lBHtznfZNA+CQ+XQWM8k4uglWK/NLYKzS+8U9GReXD0g/Tyvh4Ne17Yb4Zbr6g6y7/aNWcoPpjKRTsJIags5IJwkEAv6en05S6GUBfRWsUExZyVZVQCQwrgN7Wfdd41GPBczIp8ODeXfTSbBa6YYxlY8/p3q/udc3C+jTbtvqt2oadnB2m4oNgMn0W0p+hYWHWbwg9yU/0Kb9EIy+5y2hiCit4UgKyTeAkN8Valk4Le/ldlONRz4AWWBRM6fdIPfHstw/G+SE5rMnVQ/kA5AkLHS0ak7V7reXfhgACaBqDtD3e/nmc5k9kA/A80JReq+U38zGVp3ObJo/BvAOD3dtwiWar9zEHsgHIGlFubqSx7+Jja36anLLcDvvgwA+NDpDfILv+qlzuXwAXuSjrkKemlO2e3U1uWUYnL8dwB/5e2apca9LNv+vsQfyAUheX4VguB+mzIsaG9ntqxhF4Xbe3QD+n7/uHLAW9wQ1tblMRQ/UA0CaHC7plXEh+q4T0OWcfhleYTSHBK0EH/mi+fcRuKQn4I6fWpeoB4AevCz3HOOm9yb3F5mBlZBNclYCj1aRfyfrbgPCTR6AzK+vD4CyglX7jpmN7HY66d1E0ctdIrEEE4wEIMlam+Pk7YF6AMj7EwAVbU82vTerCwhAXopJN9zVI+AYrOeULLZgErY2x8nZA/kAJGWr0naUWdFpy2cT+oCWjpdjLFxE5UzYIBBpEUX5nLnlvAktb76SPVAfAOUHpiAMm96bsVtCAMaKALICMyxDq6cXfycA+b/mOLl6oF4AiqBRIEzBp7/X2Af0+fi1XIioMIlAI+AIPIGPmeROWV3j1Zuvyu2B+gHoFfZiDS2lC0LiY52WUADkQoTTMH1BFSYRdHoRfKSu5v9qrizMHYPT+vx6ARhSuDcAzzmDo5ZGHT1PAKYMwQxME2jiSo/gEwBrrq+u41ZOy++oD4BaCcsXTPiSI3ey8s4KGoG8QwCMFM+0ggQhLR0BF19SXuD/ayakz7uR0/TsMcxg3SjfqWNA0hsrga/ojaq/8WPcC+YIk4Ke4CMSuB2XVht1Oj8zIfXlU8BtU8DhmYRXWdfrdF1fgr3+S8At48CD04DVjXQSDO70PTUnaJ5uOCwsIIFHSSFy1pKPWCDsZxCpw8UVgKSPxLXM937OzxxAljzcPAbcswU4Qh4V3UN8mKoeKm/bu78IfKJQa8VD48CylHQiL3O3/qg5Rf30BKACMtJXjXKQcfBSK8Dfqc3KVCwuN2VFGRnm/yKZtq4Re5ifyQQgM2A+BeB3GHaZBo5MAIue0l7Kt3cC4xhw+5eL7TuCkJk1jBtyerbUfYG5ExjZ/pqrxE5fAOrOq5SmowVIrRp1IyT2R6+fg0bgVYG4CsyZe2UsaiOGKXr4Sfp9k8CxCYAFSKyvXeY1o1BxQux91yMtfsHPutgnnyUuUvhc0ZsgUXib+nVkq6+ZKaABIHsgVZnuwD9sVo66rrR4ImdhLGSQ8zPL/JgBQxeU1ouWkO9PTgDzbgmXxrzMkatl3keivfG5x4r4IRcz5BfkO5vEZ0kgpIfBZ8yKjlL17syy0tMNcOn9dl4Fy6dLFabj1Mpvow9Ify+I4Nlo9Xt+ZqU9VdJpqZh4QDDyxUyYOYJwHDg+DhgI/WUVZl7aSEt93+GO9Ia2iuZKOfA7lhp9JpvAVy61w2mOwO5hmCgMHC1H9O24gu6UD9jP+ZmbtLRaSsei9SL4XDPbAEh/kGQ/pSUcc0lbApFWb67lQUhpVnLBsoKqqZclFMmUtrxPcwxl3X7vOCAtYLSCcugFQmqhdssH7HU+RznjiOlYXA8wqkOfkItTAom+oKygca4ES8jY+N3z7fSG4hfUtp3ihUHruVSsFy1iRvNP+1N7A5BdJACmVpAgZPhGOyCigEjlPLudn7kvFtOxuB4g6OjD8UWLRkCZFRwrLCEXJQQhp2K+37lQeBCRX1A7KPQto1prFEmSYn2mB9EAsO+kYfk8KQhZF8yjVz5gp/MztyOUjiW9bCUhEBhKRCCgSis45uQ/PhX/xfFWMgOnWu2gxB0TF/o0kEZ/kCDM1Ts+3RHYnwVUL6XhDFrAswfIB6w6P1MrTulY0sum1VICglKwCEACqvQFCUK3gHcsFQCM/ILayqP1k9JshVqrncMalOYYvgcGAyCvIwuod8YBJQmZpmGJeyRwkGw4n8jJOJQNw3idLFhMRNB0SgASTJyKoy/4ieXCeFfJBUeV2SoAclFyR0bbm1OHTUiN0/DTAwD7zQeM52dqj8VsGEkVE2jKetG7AEhQ0frJAv6RC0trC1skl+IWlNinGLbSaZg7Mc0xfA8MbgF1LQV1z08A2G8+oM7PVF9Ms2GUE0gQyp+Lwu2yagLgR9ZaYpkSypQ6a6Q2DCqzpkvietXIFdoZfuieGmcOD0DeP0HEbBhNwYPmA/L8zJQsATAKnguEqS+XTqkE4YfWWwCUFZTksYAYwZfIBeN9Tw0cjOwu8gDIZqsoSSvhEeQDiiGYFoyWiSDRypWgi69UP5sc5fIcquSCNeXqe2X9ZAHfM7Khe2pcOB+AT41+aO5iRD3QAHBEHd9ctuiBBoANEkbaAw0AR9r9zcUbADYYGGkPNAAcafc3F28A2GBgpD3QAHCk3d9cvAFgg4GR9kADwJF2f3PxBoANBkbaAw0AR9r9zcUbADYYGGkPNAAcafc3F28A2GBgpD3QAHCk3d9cfOxqYJ2au9RdPtdp/khoEOlglDYT39V1PzQFXLsMXAlgt9PCxJKPbufyf8/KHIPfBPAZABf79Xc5XQ0ZQ1Q7360NbxoHrlsDvs5ZRsgo0une06by6X1mZvtP99PNAp4F4LsBXA5gjw8EGTeqaGF4QhzQF80CX7cAvGIdeDYAfhdZ2sTKUcVrpE7nd31N5gj8e2dIo2osk7NZpMdK0Z19tv+bJ4F9K8D1ACj8yfNSikHeg+5Z969m57Y/8/ZP+dPLKZhP/rcA+AYAF7g1oRUhEMUzFMt6eSJfX78b2DkPfM0i8GIAX+uWlAMppreUUErn8p2gzTl+2flg/sDbTkvIOik+CP20//mzwAXzwDcCuNTPJeFXpEpM6QEjIHm/zTF8D7T5gATYNQCe69aAloRTGulfBESBSYNyxR5g/Bhw7hKwZwl4vk9LnM5JmsBzUyDGAX3B8G23Mz/g9BuUa/0IiutfMkj7zwKmngAuXSvOpUvAWYBtF4BTnspIj/O8zPaf7qdvWITw6eZA0JLQEhKEGgxZhUj/dz3NzSKwbR44exnYvVKcy+mM5Km0JhxInUtrGkmzCPicg3W5LMGkQiZZTm9xS9Z3+4m2o8C5c4X15pTKW2Lb+fCx7WLtjYxzqiql29Icw/dA5SqYf6RTTilg+lYCIXmICKQ4IK9wxfSJY8AZK8CuFWDnanEua9ZTAMsaCog3Dt92O/MvnRGBtGwkqKRmMEkqCaa+2k+0LQDTh4rP88UHj74kF1WaATo9QHQ7mmP4HugYhtEKj4PB6ZQ+FS0hQahpldPya1kXTOqNY8DscgG+HavAttUCvBxInitrkgL4lcO33c7spBdM3kAuSnq2nx9gQfAh4JyVwvrxwel2z3p4aMlzH6DM2z/lT+8aB+Q/OT4EEqckWQSBkGD6EQKQnDCLwBSnYgcf32fXioGUFawC4esyu7CXXnDP9tOCsyD4KLB1rmgvX7zfbu2WG/Jtme0/3U/vKxBNAMoi0KcjkATCN3HOEr3UAjDrwOP71rXixYEkeKMFlSX8ocwR6KUXTJ7AaNE2tF8WfA4Ye7Kw1mwvX/yZn+eKnvcrfzC6IK/ObP/pfnpfAGQnySoISBqUXyAASS1AK0JfagWYcRDOrAF66TxZQU7jBOEbM0egH71gcgXSFZAV54NQtj9YcNIpbONCyh8Ygi8CVospApDuB63g92W2/3Q/vW8AsqM4gLIKBBIH8bcJwMCNMX68BTqBb8s6sGWtsIA6jwDk662ZI9CvXjA5A6NVa2t/IAicnC/aGV+8T74IQPm/AmGuBc+8/VP+9IEAyLslAKMV/LgAyIUInfnjwPQqMOOgI/DstQ5Mr7UAqMF8V2YXDqoXXNl+EQQ6N9v29aKdesUpWJZbAPyPme0/3U8fGIDssDid/pUASCvCaXgJmFguAEfgEXT27gDkuwaUg/nbmSMwjF7whvbLhSDL5TwwvdRqo9oqHzACkCB8U2b7T/fThwIgO01T1IMCoAZxGRhbKoAXQUcQTjkI+a4B5e5FzjGsXvCG9gdqrLGFYrpVG/UuHzBOw2/LaXxzbh43DKeoJwlAHqLndSs4udoCoIBHQE45EPk3DuitmYOQoxdctp8+rFwIWsGFYiFFoLGNchcEQC6e+OJC5J2Z7T/dTx/aApYdJ37AyJK/DIwvFxYvWr0IwEn/H1Opco5sveDUhSAAF4HJpQJkWixp6k2n4IYfMGf0amDHev2I8+l4/UbvNw8Eozw72wJePOJ8und7EkKj9ztKGA1/7WwATo44n45pWI3e7/AAGPWZ2QBkYHCU+XTMfGGQmYIxjd7vqOE0+PXzATjifDrKtTZ6v4MP/MlyRj4AR5xPF+VaqZLJF1UzKdPV6P2eLDDr3I58AI44n07ZMARbo/d78gMubWE+AEecT8e9YOn2Uheu0fs9tUCYD8AR59MpG6bR+z21gKfW1gNAz4geRT5dTEZo9H5PPRDmAzBmRM8BJzqfLiYjSKKr0fs9dYBYDwBHmE9XtRfMsIz04aQZ1+j9npygrA+Akqs8wfl0BCCTWRq935MTYL1aVQ8Ao1zlAnAi8+kEQGZTNXq/vYb75Pt/fQAcUT5dBGCj93vyAaxXi+oDoFLyT3A+3Rcavd9eY3xS/z8fgCQX/LPR3SOzkon55jg1eyAfgD8M4NcAPD6aDmBtB1e4NMDNcer1QD4AbwbwxwDe4UvRE9wHZG1gNSXDLlwLNcep1QP5APxzzwj9IIAPnXhT5ORc5EYCA9HNcWr1QD4AmRH6FQBMTSZZH98ZmD5Bh5g1FopiNns1x6nTA/kAvAfAEwDudnI+EvQxPfkEzYfaCXRSBluQMB7YHKdGD+QDsBNBH/9+AkAobqTADGK7Inw1x8nfA/kA7EXQt8kgrGAGMfBxZ5Cv5ji5eyAfgL0I+r68uR0QmUFoBQU8vfNvzXHy9kA9AORoMw7CdGQCjoUZDwL4kv/+8OZ1gJhBIjGDgMh3vTavBc035/RAPgD7JegjODfhiMwgoqeJwNPPTaB6Ezq/hq+sB4AcXeXEP+ZhGVo9vRimIQD5v5oPAZCupgDI9wg8/qz/1Xz55usyeyAfgMMQ9GU2Op4eAchpOIJQQEz/VuPlm6/K7IH6AMjgGzdl6QtyX5jWjpQFevF3lq3xf6yhrOlIAUgQCojR8gmE+l9Nl2++JrMH6gEgR5UA5KYsc+AZmCbQCDi+IvgEQMob1XBEAHIajgBMLV+0kCdws6aGu3zqfkV9AGTwjftg3JRVVRAtHQEXX/wbAcoXP5d5CID8GoJKvqDAloKOoIz/y7x8c3pmD4zhaqwjRzCYyQg5gr2ZgsFTLweWr8XQgsXjbwLWrnNtMlKgNoLBmZAa7PTCAuYIBlMvlWQswwr2UlUw45jdDSx8HbD+Ctd+HVCwePKbgJV9aASDM8Yg59TWFDysYPBtmYK91IbNOHaPA/M7gUXKXA4hWDz79cA8+W0aweCMURj+1HYfcBjBYO54MMY3tGDv8I3nmWSHOzYOLJ0LLPGXAQWLz3oB8MQUsEa16kYwOG8whjh74yJkUMFgbsNlCfYO0epwissVY34bsHw2sEIRkAEEi/dcU0SP5qhF1ggG5w3GEGdXr4L5134Fg4kAjuDQgr1DtDqcUmZETwArZwAru4BVqsv0KVh8/o3F4v0QXZBGMDhvMIY4u3MYhv95Zh+Cu1xBcxuOU/HfeDIq5cv7FuwdotXhlCBXjOXZAnyrO4BV6in0IVh8wStLuWCsUAyvEQzOG5ABz+4eB+R/ewnu/kOP/3G/l4kJTERlljQtIot2e53/IwO2OPl4FLtcnCqAp9cahT56CBZf+LpSLhhz1N5qBIPzBmTAs/sLRHcTDKbiNHdBGGymOC/3hglEvgjAnoK9A7Y4+XgiV4zVWYDAs/etxaubYPFFP1QkLtCIP8neaASD8wZkwLP7AyC/tJNg8L/xLNBu+YBdBXsHbHEFAINcMVamgdWZAoRrfPdXm8KitLdmgYveWAq+2y7iMqfuRjA4b1AGOLt/APJLqwSD3+y5T1yI0AoSbAxMMzGV1o8/My2ro2DvAK2t+GgiV4zj4+3AIwDXtwBrVJeuECze+9aW4Dut4PxkIhYsdetGMDhvoDqcPRgA+SWp4O4veQ5Uv/mAGwR78+6rQq4Yq9PAOi2fA4/vBkKudKVU7VZw77uKvWFuZbtcMNb5v0YwOG9g+jx7cADyi6Pg7gccgIxlcA5TKhaD01yYKBmVFpBZMfx/m2Bvny3t8LGqoqTliZbVI+gMgHwnMAnCIFi897cLAAZ6QyzFzzSCwXkD1OPs4QDIL5XgLmk5JHk/SD5gKdibd38VcsVYGmuBTaAzEHLHgyCcaokB7/1IkUET5IKxwF5pBIPzBqbPs4cHIC/AaeqvPL9pmHxAE+zts6VdLCD/lcgVY3UyWD0Bj1ZwqgCggXA7sPfWAoAJvaEtZBrB4Lyx6efsPADyCtmCvf00s/NnOsgVY3m8BTRZPZuGBUACdArY+5lWDqGmYbIrLHEx0ggG5w1OH2fnA7CPizQfaXqgUw80AGywMdIeaAA40u5vLt4AsMHASHugAeBIu7+5eAPABgMj7YEGgCPt/ubiDQAbDIy0BxoAjrT7m4s3AGwwMNIeaAA40u5vLt4AsMHASHugAeBIu7+5eAPABgMj7YEGgCPt/ubiDQAbDIy0B8ZYNMbkX+ZekpuIiOQrPar+xs889HJg6jZg5jAwvVZ8B+ll9PlO5/Fc/o+ECjnHfi8zYfkvM5ulmp4qJXVqx5deD4zfAkw/CGxdAZgoHfuh131QkaI5hu8Bs4Ds8B0AWLnIRGCBsFfn87JffDMwdjOw5R5g8giwZa34jnQQUwDo99wBfJ4TM7COiNdlaj2rA/jeV/vfDeATAP4UGH8I2Lrc6gc+SHqY4oMZ74VSKM0xfA+UUzB/oBUUCKMl6zSQ/PsXqZD5KQC/A0w/DEwcAcYXgYnVwppwADuBkefnCim90FmBWXwnK87Uen53BI8sbuwqaz9p5UgnQhBS+ZN1zE8Ak0utviCwq8DI8/nx5hi+Bzb4gJzKZE1SEFZZgS9/2pWR/gTAJ4HJQ8DEMWB8ARhfBsaWCwDquwQKvvNgHXvOcYVbPFJPkw+dDxC/W1Y4tWDpw/Rlgo4lo1T4/KxTihDNpJwj3/UiMLXemprjffC7eWpzDN8DlYsQDiKtVxzEqoHkyX9HRizW+nIgaQnvAiaeBCbmC0s4tgSMu2rMePAR9X252jXklaTFU108K0MHav/nvJ6ZxVVk9OI7GR2IZoGQNc/HgbHgIwqILIVujuF7oOMqWFawCoRxkfEIB5CWgkREBCNf9wMTc8A4QciBWyoGz16rwNgaML5eWKpctYZL3N+TWLX0gvtuP0HHk2n16JDyxXmVhfU0qywbJbr5GSuXKxA/sV5Y9UYWdnjwyS3qKKgarWA69Wg6fjQOIK0HadnIjPVFB+AiME4AuiUkCFnESyCSkmAuU7Cjm15wX+2X2ifBRn9A8mKcW2UFjULVQcgVDl80u40SYh763FfvquhLCxitoBYUsoJfjXKttByMq9CKcHn4sPuCbgXNJwyWkECcz5Q376UX3LNncZyQAAADEklEQVT9fFgIJs6lBBwtn3Tt6FpIz4RWnuQxPh2XIGzm4CwQ9hWIFgBTK0gQHiIAJddKq0ELQh+KL1qUR4MvSEsoENIKrgALHNiMox+94K7tl9qnnMio8MSf6SNwGpYVjCDk/Ju7isq496fCqX0BkDeqlWwKwic1gAQSpzGREnFgREz01eALLvvq2Kfi45m6cf3qBXdsfxRbJMho8dimqOhEK8cXQRr9QVpvPoDNMXQP9A3ACELFxPh+jACkP0fLIKFCCRRqKuPUdqjlC9o07JZwKVNHeBC94DQcZO0XAAkmgotAk9QYrR9f/BvByYfMSATDVMzwTXMM3QMDAVAgVHCZ7/MaQK4QZUHiNCbBQlqUw74YCb7gcmYkelC9YFlwvVv7RRAorTuBkECU9asCID9/x9B935zYzyKkqpfiNHxcA0gLQgvBAaPVkCqm3h2AtC5m/RyEqzw/4xhGL3hD++MmslgqCbgUfLKAcRrmTlBzDN0DA1tAXUlWcDm1IOIIJAjlT/Fd05lbFQFwjdtgGcewesFt7Rc/Gx8iWjUCjGCT1YvWT1MwgUqrf3NG45tTbcu0aximWx9xENcEQHGbcYAEwtSXSqY0gnCdgeuMI0cvuGx/FUGgFhwEYrR80QckWN+X0fjm1DwAWv8RgJFilJZBznz0pQg+AZAAlVWh1GvGka0XzB0cCQi30aSGVa9AF62fLOB7MhrfnJoPwPER59Px+o3e76mL5Kwp2G57xPl0kxc3er+nLvyKtLmhfUC78RHn081ONnq/pzcAR5xPR9mRRu/31IVgvgUccT4dNaobvd/TGYAjzqejumqj93s6A3DE+XRUg2VSCjdaGr3fUw+I+VPwiPPpqJjO8J1Nw43e7ymHwHoAKMFd7QErAeEE5NNJMb3R+z3lsGcNzgfgiPPpomJ6o/d76oGwPgCOKJ8uKqY3er+nKwBHmE+noqRG7/fUA199U/AI8+kEwEbv93QHoEhZTnA+nYqSGr3fBoAtaiqBUImdm5hPJwA2er+nKwBHnE+X1gUzSbnR+z11wPj/AeCpPDD3t7rvAAAAAElFTkSuQmCC",kde="uniform sampler2D weightMap;varying vec2 vOffset0;varying vec2 vOffset1;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 a;a.x=texture2D(weightMap,vOffset0).a;a.y=texture2D(weightMap,vOffset1).g;a.wz=texture2D(weightMap,uv).rb;vec4 color=inputColor;if(dot(a,vec4(1.0))>=1e-5){bool h=max(a.x,a.z)>max(a.y,a.w);vec4 blendingOffset=vec4(0.0,a.y,0.0,a.w);vec2 blendingWeight=a.yw;movec(bvec4(h),blendingOffset,vec4(a.x,0.0,a.z,0.0));movec(bvec2(h),blendingWeight,a.xz);blendingWeight/=dot(blendingWeight,vec2(1.0));vec4 blendingCoord=blendingOffset*vec4(texelSize,-texelSize)+uv.xyxy;color=blendingWeight.x*texture2D(inputBuffer,blendingCoord.xy);color+=blendingWeight.y*texture2D(inputBuffer,blendingCoord.zw);}outputColor=color;}",Nde="varying vec2 vOffset0;varying vec2 vOffset1;void mainSupport(const in vec2 uv){vOffset0=uv+texelSize*vec2(1.0,0.0);vOffset1=uv+texelSize*vec2(0.0,1.0);}",sc={LOW:0,MEDIUM:1,HIGH:2,ULTRA:3},Pk=class extends ba{constructor({preset:e=sc.MEDIUM,edgeDetectionMode:t=s1.COLOR,predicationMode:r=Oue.DISABLED}={}){super("SMAAEffect",kde,{vertexShader:Nde,blendFunction:Ct.NORMAL,attributes:da.CONVOLUTION|da.DEPTH,uniforms:new Map([["weightMap",new we(null)]])});let i,n;arguments.length>1&&(i=arguments[0],n=arguments[1],arguments.length>2&&(e=arguments[2]),arguments.length>3&&(t=arguments[3])),this.renderTargetEdges=new Ut(1,1,{minFilter:vt,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetEdges.texture.name="SMAA.Edges",this.renderTargetWeights=this.renderTargetEdges.clone(),this.renderTargetWeights.texture.name="SMAA.Weights",this.uniforms.get("weightMap").value=this.renderTargetWeights.texture,this.clearPass=new OA(!0,!1,!1),this.clearPass.overrideClearColor=new $e(0),this.clearPass.overrideClearAlpha=1,this.edgeDetectionPass=new Js(new Rue),this.edgeDetectionMaterial.edgeDetectionMode=t,this.edgeDetectionMaterial.predicationMode=r,this.weightsPass=new Js(new Hue);let s=new HR;s.onLoad=()=>{let a=new jr(i);a.name="SMAA.Search",a.magFilter=Xt,a.minFilter=Xt,a.generateMipmaps=!1,a.needsUpdate=!0,a.flipY=!0,this.weightsMaterial.searchTexture=a;let o=new jr(n);o.name="SMAA.Area",o.magFilter=vt,o.minFilter=vt,o.generateMipmaps=!1,o.needsUpdate=!0,o.flipY=!1,this.weightsMaterial.areaTexture=o,this.dispatchEvent({type:"load"})},s.itemStart("search"),s.itemStart("area"),i!==void 0&&n!==void 0?(s.itemEnd("search"),s.itemEnd("area")):typeof Image<"u"&&(i=new Image,n=new Image,i.addEventListener("load",()=>s.itemEnd("search")),n.addEventListener("load",()=>s.itemEnd("area")),i.src=KD,n.src=ZD),this.applyPreset(e)}get edgesTexture(){return this.renderTargetEdges.texture}getEdgesTexture(){return this.edgesTexture}get weightsTexture(){return this.renderTargetWeights.texture}getWeightsTexture(){return this.weightsTexture}get edgeDetectionMaterial(){return this.edgeDetectionPass.fullscreenMaterial}get colorEdgesMaterial(){return this.edgeDetectionMaterial}getEdgeDetectionMaterial(){return this.edgeDetectionMaterial}get weightsMaterial(){return this.weightsPass.fullscreenMaterial}getWeightsMaterial(){return this.weightsMaterial}setEdgeDetectionThreshold(e){this.edgeDetectionMaterial.edgeDetectionThreshold=e}setOrthogonalSearchSteps(e){this.weightsMaterial.orthogonalSearchSteps=e}applyPreset(e){let t=this.edgeDetectionMaterial,r=this.weightsMaterial;switch(e){case sc.LOW:t.edgeDetectionThreshold=.15,r.orthogonalSearchSteps=4,r.diagonalDetection=!1,r.cornerDetection=!1;break;case sc.MEDIUM:t.edgeDetectionThreshold=.1,r.orthogonalSearchSteps=8,r.diagonalDetection=!1,r.cornerDetection=!1;break;case sc.HIGH:t.edgeDetectionThreshold=.1,r.orthogonalSearchSteps=16,r.diagonalSearchSteps=8,r.cornerRounding=25,r.diagonalDetection=!0,r.cornerDetection=!0;break;case sc.ULTRA:t.edgeDetectionThreshold=.05,r.orthogonalSearchSteps=32,r.diagonalSearchSteps=16,r.cornerRounding=25,r.diagonalDetection=!0,r.cornerDetection=!0;break}}setDepthTexture(e,t=vo){this.edgeDetectionMaterial.depthBuffer=e,this.edgeDetectionMaterial.depthPacking=t}update(e,t,r){this.clearPass.render(e,this.renderTargetEdges),this.edgeDetectionPass.render(e,t,this.renderTargetEdges),this.weightsPass.render(e,this.renderTargetEdges,this.renderTargetWeights)}setSize(e,t){this.edgeDetectionMaterial.setSize(e,t),this.weightsMaterial.setSize(e,t),this.renderTargetEdges.setSize(e,t),this.renderTargetWeights.setSize(e,t)}dispose(){let{searchTexture:e,areaTexture:t}=this.weightsMaterial;e!==null&&t!==null&&(e.dispose(),t.dispose()),super.dispose()}static get searchImageDataURL(){return KD}static get areaImageDataURL(){return ZD}},Fde=`uniform float offset;uniform float darkness;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){const vec2 center=vec2(0.5);vec3 color=inputColor.rgb;
#if VIGNETTE_TECHNIQUE == 0
float d=distance(uv,center);color*=smoothstep(0.8,offset*0.799,d*(darkness+offset));
#else
vec2 coord=(uv-center)*vec2(offset);color=mix(color,vec3(1.0-darkness),dot(coord,coord));
#endif
outputColor=vec4(color,inputColor.a);}`,ev={DEFAULT:0,ESKIL:1},Ude=class extends ba{constructor({blendFunction:e=Ct.NORMAL,technique:t=ev.DEFAULT,eskil:r=!1,offset:i=.5,darkness:n=.5}={}){super("VignetteEffect",Fde,{blendFunction:e,defines:new Map([["VIGNETTE_TECHNIQUE",t.toFixed(0)]]),uniforms:new Map([["offset",new we(i)],["darkness",new we(n)]])})}get technique(){return Number(this.defines.get("VIGNETTE_TECHNIQUE"))}set technique(e){this.technique!==e&&(this.defines.set("VIGNETTE_TECHNIQUE",e.toFixed(0)),this.setChanged())}get eskil(){return this.technique===ev.ESKIL}set eskil(e){this.technique=e?ev.ESKIL:ev.DEFAULT}getTechnique(){return this.technique}setTechnique(e){this.technique=e}get offset(){return this.uniforms.get("offset").value}set offset(e){this.uniforms.get("offset").value=e}getOffset(){return this.offset}setOffset(e){this.offset=e}get darkness(){return this.uniforms.get("darkness").value}set darkness(e){this.uniforms.get("darkness").value=e}getDarkness(){return this.darkness}setDarkness(e){this.darkness=e}},yo=class{constructor(e,t){this.enabled=!1,this.effect=new e(t),Object.defineProperty(this,"opacity",{enumerable:!0,set(r){this.effect.blendMode.opacity.value=r},get(){return this.effect.blendMode.opacity.value}}),Object.defineProperty(this,"blendFunction",{enumerable:!0,set(r){this.effect.blendMode.setBlendFunction(Number(r))},get(){return this.effect.blendMode.blendFunction}}),this.blendFunction=Ct.NORMAL}},jde=class extends yo{constructor(){super(bde),this.blendFunction=Ct.SCREEN}set intensity(e){this.effect.intensity=e}get intensity(){return this.effect.intensity}set luminanceThreshold(e){this.effect.luminanceMaterial.threshold=e}get luminanceThreshold(){return this.effect.luminanceMaterial.threshold}set luminanceSmoothing(e){this.effect.luminanceMaterial.smoothing=e}get luminanceSmoothing(){return this.effect.luminanceMaterial.smoothing}set blurScale(e){this.effect.blurPass.scale=e}get blurScale(){return this.effect.blurPass.scale}set kernelSize(e){this.effect.blurPass.kernelSize=e}get kernelSize(){return this.effect.blurPass.kernelSize}},Vde=class extends yo{constructor(){super(Sde)}set contrast(e){this.effect.uniforms.get("contrast").value=e}get contrast(){return this.effect.uniforms.get("contrast").value}set brightness(e){this.effect.uniforms.get("brightness").value=e}get brightness(){return this.effect.uniforms.get("brightness").value}},Hde=class extends yo{constructor(){super(Tde),this.effect.offset=new W(.01,.01)}set offset(e){this.effect.offset.set(e[0]/1e3,e[1]/1e3)}get offset(){return[this.effect.offset.x*1e3,this.effect.offset.y*1e3]}},Gde=class extends yo{constructor(){super(Cde)}},Wde=class extends yo{constructor(){super(Ide),this._hue=0}set hue(e){this._hue=e,this.effect.setHue(e)}get hue(){return this._hue}set saturation(e){this.effect.uniforms.get("saturation").value=e}get saturation(){return this.effect.uniforms.get("saturation").value}},qde=class extends yo{constructor(){super(Rde),this.blendFunction=Ct.OVERLAY}},Xde=class extends yo{constructor(){super(Ude)}get eskil(){return this.effect.eskil}set eskil(e){this.effect.eskil=e}get darkness(){return this.effect.uniforms.get("darkness").value}set darkness(e){this.effect.uniforms.get("darkness").value=e}get offset(){return this.effect.uniforms.get("offset").value}set offset(e){this.effect.uniforms.get("offset").value=e}},Yde=class extends yo{constructor(e){super(Dde,e)}set focalLength(e){this.effect.circleOfConfusionMaterial.uniforms.focalLength.value=e}get focalLength(){return this.effect.circleOfConfusionMaterial.uniforms.focalLength.value}set focusDistance(e){this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value=e}get focusDistance(){return this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value}get bokehScale(){return this.effect.bokehScale}set bokehScale(e){this.effect.bokehScale=e}},Qde=class extends yo{constructor(){super(zde)}get granularity(){return this.effect.getGranularity()}set granularity(e){this.effect.setGranularity(e)}},Kde=`#define GLSLIFY 1
varying vec2 vUv;varying vec2 vTexCoords[9];uniform vec2 resolution;void main(){vUv=position.xy*0.5+0.5;vec2 texelSize=vec2(1.0)/resolution;vTexCoords[0]=vUv+vec2(-texelSize.x,-texelSize.y);vTexCoords[1]=vUv+vec2(0.0,-texelSize.y);vTexCoords[2]=vUv+vec2(texelSize.x,-texelSize.y);vTexCoords[3]=vUv+vec2(-texelSize.x,0.0);vTexCoords[4]=vUv+vec2(0.0,0.0);vTexCoords[5]=vUv+vec2(texelSize.x,0.0);vTexCoords[6]=vUv+vec2(-texelSize.x,texelSize.y);vTexCoords[7]=vUv+vec2(0.0,texelSize.y);vTexCoords[8]=vUv+vec2(texelSize.x,texelSize.y);gl_Position=vec4(position.xy,1.0,1.0);}`,Zde=`#define GLSLIFY 1
#include <common>
varying vec2 vUv;varying vec2 vTexCoords[9];uniform sampler2D inputBuffer;uniform sampler2D historyBuffer;uniform sampler2D velocityBuffer;uniform sampler2D depthBuffer;uniform vec2 resolution;
#define USE_YCOCG
#define USE_CATMULL_ROM
const float feedback_min=0.5;const float feedback_max=0.95;vec3 RGB_YCoCg(vec3 c){return vec3(c.x/4.0+c.y/2.0+c.z/4.0,c.x/2.0-c.z/2.0,-c.x/4.0+c.y/2.0-c.z/4.0);}vec3 YCoCg_RGB(vec3 c){return clamp(vec3(c.x+c.y-c.z,c.x+c.z,c.x-c.y-c.z),vec3(0.0),vec3(1.0));}vec4 sample_color(sampler2D tex,vec2 uv){
#ifdef USE_YCOCG
vec4 c=texture(tex,uv);return vec4(RGB_YCoCg(c.rgb),c.a);
#else
return texture(tex,uv);
#endif
}vec4 sample_catmull_rom(sampler2D tex,vec2 uv,vec2 texSize){vec2 samplePos=uv*texSize;vec2 texPos1=floor(samplePos-0.5)+0.5;vec2 f=samplePos-texPos1;vec2 w0=f*(-0.5+f*(1.0-0.5*f));vec2 w1=1.0+f*f*(-2.5+1.5*f);vec2 w2=f*(0.5+f*(2.0-1.5*f));vec2 w3=f*f*(-0.5+0.5*f);vec2 w12=w1+w2;vec2 offset12=w2/(w1+w2);vec2 texPos0=texPos1-1.0;vec2 texPos3=texPos1+2.0;vec2 texPos12=texPos1+offset12;texPos0/=texSize;texPos3/=texSize;texPos12/=texSize;vec4 result=vec4(0.0);result+=texture2D(tex,vec2(texPos12.x,texPos0.y))*w12.x*w0.y;result+=texture2D(tex,vec2(texPos0.x,texPos12.y))*w0.x*w12.y;result+=texture2D(tex,vec2(texPos12.x,texPos12.y))*w12.x*w12.y;result+=texture2D(tex,vec2(texPos3.x,texPos12.y))*w3.x*w12.y;result+=texture2D(tex,vec2(texPos12.x,texPos3.y))*w12.x*w3.y;return result;}vec3 choose_motion_vector(){
#ifdef CHOOSE_LONGEST_MOTION_VECTOR
float longest=-1.0;vec3 v_choose=vec3(-1.0);for(int i=0;i<9;i++){vec3 v=texture2D(velocityBuffer,vTexCoords[i]).rgb;float l=length(v.xy);if(l>longest){longest=l;v_choose=v;}}return v_choose;
#else
float closest_depth=1000.0;vec2 closest_uv_offset=vec2(0.0);for(int i=0;i<9;i++){float neighbor_depth=texture2D(depthBuffer,vTexCoords[i]).r;if(neighbor_depth<closest_depth){closest_uv_offset=vTexCoords[i];closest_depth=neighbor_depth;}}return texture2D(velocityBuffer,closest_uv_offset).rgb;
#endif
}vec4 clipAabb(vec3 aabb_min,vec3 aabb_max,vec4 avg,vec4 input_texel){const float FLT_EPS=0.00000001;vec3 p_clip=0.5*(aabb_max+aabb_min);vec3 e_clip=0.5*(aabb_max-aabb_min)+FLT_EPS;vec4 v_clip=input_texel-vec4(p_clip,avg.w);vec3 v_unit=v_clip.xyz/e_clip;vec3 a_unit=abs(v_unit);float ma_unit=max(a_unit.x,max(a_unit.y,a_unit.z));if(ma_unit>1.0){return vec4(p_clip,avg.w)+v_clip/ma_unit;}else{return input_texel;}}vec3 clip_aabb_variance(in vec3 cOld,in vec3 cNew,in vec3 centre,in vec3 halfSize){if(all(lessThanEqual(abs(cOld-centre),halfSize))){return cOld;}vec3 dir=(cNew-cOld);vec3 near=centre-sign(dir)*halfSize;vec3 tAll=(near-cOld)/dir;float t=0.0001;for(int i=0;i<3;i++){if(tAll[i]>=0.0&&tAll[i]<t){t=tAll[i];}}if(t>=0.0001){return cOld;}return cOld+dir*t;}void main(){vec3 v=choose_motion_vector();vec2 velocity=v.rg;vec2 previousPixelPos=vUv-velocity;vec4 currentColor=sample_color(inputBuffer,vUv);
#ifdef USE_CATMULL_ROM
vec4 previousColor=sample_catmull_rom(historyBuffer,previousPixelPos,resolution);
#else
vec4 previousColor=sample_color(historyBuffer,previousPixelPos);
#endif
#ifdef USE_YCOCG
previousColor=vec4(RGB_YCoCg(previousColor.rgb),previousColor.a);
#endif
vec4 ctl=sample_color(inputBuffer,vTexCoords[0]);vec4 ctc=sample_color(inputBuffer,vTexCoords[1]);vec4 ctr=sample_color(inputBuffer,vTexCoords[2]);vec4 cml=sample_color(inputBuffer,vTexCoords[3]);vec4 cmc=sample_color(inputBuffer,vTexCoords[4]);vec4 cmr=sample_color(inputBuffer,vTexCoords[5]);vec4 cbl=sample_color(inputBuffer,vTexCoords[6]);vec4 cbc=sample_color(inputBuffer,vTexCoords[7]);vec4 cbr=sample_color(inputBuffer,vTexCoords[8]);vec4 cmin=min(ctl,min(ctc,min(ctr,min(cml,min(cmc,min(cmr,min(cbl,min(cbc,cbr))))))));vec4 cmax=max(ctl,max(ctc,max(ctr,max(cml,max(cmc,max(cmr,max(cbl,max(cbc,cbr))))))));vec4 cavg=(ctl+ctc+ctr+cml+cmc+cmr+cbl+cbc+cbr)/9.0;vec4 cmin5=min(ctc,min(cml,min(cmc,min(cmr,cbc))));vec4 cmax5=max(ctc,max(cml,max(cmc,max(cmr,cbc))));vec4 cavg5=(ctc+cml+cmc+cmr+cbc)/5.0;cmin=0.5*(cmin+cmin5);cmax=0.5*(cmax+cmax5);cavg=0.5*(cavg+cavg5);
#ifdef USE_YCOCG
vec2 chroma_extent=vec2(0.25*0.5*(cmax.r-cmin.r));vec2 chroma_center=currentColor.gb;cmin.yz=chroma_center-chroma_extent;cmax.yz=chroma_center+chroma_extent;cavg.yz=chroma_center;
#endif
vec4 previousColorClipped=clamp(previousColor,cmin,cmax);
#ifdef LUMINANCE_DIFFERENCES
#ifdef USE_YCOCG
float lum0=currentColor.r;float lum1=previousColorClipped.r;
#else
float lum0=luminance(currentColor.rgb);float lum1=luminance(previousColorClipped.rgb);
#endif
float unbiased_diff=abs(lum0-lum1)/max(lum0,max(lum1,0.2));float unbiased_weight=1.0-unbiased_diff;float unbiased_weight_sqr=unbiased_weight*unbiased_weight;float k_feedback=mix(feedback_min,feedback_max,unbiased_weight_sqr);vec4 result=mix(currentColor,previousColorClipped,vec4(k_feedback));
#else
const float alpha=0.1;vec4 result=mix(currentColor,previousColorClipped,1.0-alpha);
#endif
#ifdef USE_YCOCG
gl_FragColor=vec4(YCoCg_RGB(result.rgb).rgb,result.a);
#else
gl_FragColor=result;
#endif
}`,$de=`#define GLSLIFY 1
varying vec2 vUv;void main(){gl_Position=vec4(position.xy,1.0,1.0);vUv=position.xy*0.5+0.5;}`,Jde=`#define GLSLIFY 1
layout(location=1)out vec4 gVelocity;varying vec2 vUv;uniform sampler2D inputBuffer;void main(){gl_FragColor=texture2D(inputBuffer,vUv);gVelocity=vec4(0.0);}`,L_=class extends Yt{constructor(){super({name:"PassthroughMaterial",uniforms:{inputBuffer:new we(null)},blending:Ir,depthWrite:!1,depthTest:!1,vertexShader:$de,fragmentShader:Jde})}set inputBuffer(e){this.uniforms.inputBuffer.value=e}},epe=class extends Vi{constructor(){super("TAAResolvePass"),this.MRTCompatible=!0,this.needsSwap=!1,this.passThroughMaterial=new L_,this.resolutionVector=new W,this.resolveMaterial=new Yt({name:"TAAResolveMaterial",uniforms:{inputBuffer:new we(null),historyBuffer:new we(null),velocityBuffer:new we(null),depthBuffer:new we(null),resolution:new we(new W)},blending:Ir,depthWrite:!1,depthTest:!1,vertexShader:Kde,fragmentShader:Zde}),this.historyRenderTarget=new Ut(1024,1024,{minFilter:vt,stencilBuffer:!1,depthBuffer:!1}),this.historyRenderTarget.texture.name="TAA.History",this.resultRenderTarget=new Ut(1024,1024,{minFilter:vt,stencilBuffer:!1,depthBuffer:!1}),this.resultRenderTarget.texture.name="TAA.Output"}setSize(e,t){this.historyRenderTarget.setSize(e,t),this.resultRenderTarget.setSize(e,t)}render(e,t){this.fullscreenMaterial=this.resolveMaterial,this.resolveMaterial.uniforms.inputBuffer.value=t.texture[0],this.resolveMaterial.uniforms.velocityBuffer.value=t.texture[1],this.resolveMaterial.uniforms.depthBuffer.value=t.depthTexture,this.resolveMaterial.uniforms.historyBuffer.value=this.historyRenderTarget.texture,this.resolveMaterial.uniforms.resolution.value.set(t.width,t.height),e.setRenderTarget(this.resultRenderTarget),e.render(this.scene,this.camera),this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=this.resultRenderTarget.texture,e.setRenderTarget(this.historyRenderTarget),e.render(this.scene,this.camera);let r=this.renderToScreen?null:t;this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=this.resultRenderTarget.texture,e.setRenderTarget(r),e.render(this.scene,this.camera)}dispose(){this.resultRenderTarget.dispose(),this.historyRenderTarget.dispose(),this.resolveMaterial.dispose(),this.passThroughMaterial.dispose()}},tpe=class extends Vi{constructor(e,t,r){super("TransmissionPass",void 0,t),this.MRTCompatible=!0,this.depthPass=new YD(e,t,{renderTarget:r.transmissionDepthTarget}),this.passThroughMaterial=new L_,this.splineScene=e,this.needsSwap=!1}updatePasses(e){this.passThroughMaterial=new L_,this.depthPass=new YD(this.splineScene,this.camera,{renderTarget:e.transmissionDepthTarget})}setCamera(e){this.camera=e}setScene(e){this.splineScene=e}render(e,t,r){let i=this.camera.layers.mask,n=e;n.setRenderTarget(n.transmissionRenderTarget),this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=t.texture[0],n.clear(),n.render(this.scene,this.camera),this.camera.layers.disable(3),this.depthPass.render(e,t,r),n.shadowMap.needsUpdate=!1,n.shadowMap.autoUpdate=!1;let s=this.renderToScreen?null:t;this.camera.layers.set(3),e.setRenderTarget(s),e.render(this.splineScene,this.camera),this.camera.layers.mask=i}},$D=new pl,rpe=new Yt({transparent:!0,vertexShader:`
        void main() {
            gl_Position = vec4(0.0);
        }
    `,fragmentShader:`
        layout(location = 1) out vec4 gVelocity;

        void main() {
            gl_FragColor = vec4(0.0);
			gVelocity = vec4(0.0);
        }
    `}),I_=class extends Vi{constructor(e,t,r){super("OpaquePass",t??$D,r),this.MRTCompatible=!0,this.hasTransmissionPass=!1,this.clear=!0,this.clearColorOnly=!1,this.clearDepth=!1,this.needsSwap=!1,this.originalMaterials=new Map,this.MRTCompatible=e}setCamera(e){this.camera=e}setScene(e){this.scene=e??$D}getScene(){return this.scene}render(e,t){this.camera.layers.enable(3),this.hasTransmissionPass&&(this.originalMaterials.clear(),this.scene.traverse(i=>{i.layers.isEnabled(3)&&i instanceof an&&(this.originalMaterials.set(i.id,i.material),i.material=rpe)}),e.shadowMap.needsUpdate=!0,e.shadowMap.autoUpdate=!0),this.camera.layers.enable(8);let r=this.renderToScreen?null:t;e.setRenderTarget(r),this.clearColorOnly&&e.clear(!0,!1,!0),this.clear&&e.clear(),e.render(this.scene,this.camera),this.clearDepth&&e.clear(!1,!0,!1),this.hasTransmissionPass&&this.originalMaterials.forEach((i,n)=>{let s=this.scene.getObjectById(n);s&&(s.material=i)})}},ipe=class{constructor(e,{depthBuffer:t=!0,stencilBuffer:r=!1,multisampling:i=0,frameBufferType:n=0}={}){this.renderer=e,this.helperStartIndex=0,this.copyPass=new D_,this.depthTexture=null,this.timer=new xde,this._width=1,this._height=1,this.passes=[],this.helperPasses=[],this.autoRenderToScreen=!0,this.inputBuffer=this.createBuffer(t,r,n,i,!0,"input buffer mrt"),this.inputBufferSingle=this.createBuffer(t,r,n,i,!1," input buffer single"),this.inputBufferSingle.texture.dispose(),this.inputBufferSingle.depthTexture.dispose(),this.inputBufferSingle.texture=this.inputBuffer.texture[0],this.inputBufferSingle.depthTexture=this.inputBuffer.depthTexture,this.outputBuffer=this.inputBuffer.clone(),this.outputBuffer.name="output buffer mrt",this.outputBufferSingle=this.createBuffer(t,r,n,i,!1,"output buffer single"),this.outputBufferSingle.texture.dispose(),this.outputBufferSingle.depthTexture.dispose(),this.outputBufferSingle.texture=this.outputBuffer.texture[0],this.outputBufferSingle.depthTexture=this.outputBuffer.depthTexture,this.setRenderer(e)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(e){let t=this.inputBuffer,r=this.multisampling;r>0&&e>0?(this.inputBuffer.samples=e,this.outputBuffer.samples=e,this.inputBuffer.dispose(),this.outputBuffer.dispose()):r!==e&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),console.log("creating new input buffer"),this.inputBuffer=this.createBuffer(t.depthBuffer,t.stencilBuffer,t.texture.type,e,!0,"new input buffer"),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(e){var t;if(this.renderer=e,e!==null){let r=e.getSize(new W),i=((t=e.getContext().getContextAttributes())==null?void 0:t.alpha)??!1,n=this.inputBuffer.texture[0].type;n===Si&&e.outputEncoding===ut&&(this.inputBuffer.texture[0].encoding=ut,this.outputBuffer.texture[0].encoding=ut,this.inputBuffer.dispose(),this.outputBuffer.dispose(),console.log("doing some kinda dispose??")),e.autoClear=!1,this.setSize(r.width,r.height,!1);for(let s of this.passes)s.initialize(e,i,n)}}replaceRenderer(e,t=!0){let r=this.renderer,i=r.domElement.parentNode;return this.setRenderer(e),t&&i!==null&&(i.removeChild(r.domElement),i.appendChild(e.domElement)),r}createDepthTexture(){let e=this.depthTexture=new Wu(this._width,this._height);return this.inputBuffer.depthTexture=e,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(e.format=Oc,e.type=yc):e.type=Yo,e}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(let e of this.passes)e.setDepthTexture(null)}}createBuffer(e,t,r,i,n,s){let a=this.renderer,o=a===null?new W:a.getDrawingBufferSize(new W),l={minFilter:vt,magFilter:vt,wrapS:br,wrapT:br,stencilBuffer:t,depthBuffer:e},c;return i>0?(c=new Ut(o.width,o.height,l),c.samples=i):(n?(c=new zW(o.width,o.height,2,l),c.texture[1].type=Hu):c=new Ut(o.width,o.height,l),c.depthTexture=new Wu(2048,2048),c.depthTexture.type=xn),r===Si&&a!==null&&a.outputEncoding===ut&&(Array.isArray(c.texture)?c.texture.forEach(u=>u.encoding=ut):c.texture.encoding=ut),Array.isArray(c.texture)?c.texture.forEach((u,h)=>{u.name=`EffectComposer.Buffer ${n} ${h}`,u.generateMipmaps=!1}):(c.texture.name=`EffectComposer.Buffer ${n}`,c.texture.generateMipmaps=!1),c.name=s,c}addPass(e,t){var o;let r=this.passes,i=this.renderer,n=i.getDrawingBufferSize(new W),s=((o=i.getContext().getContextAttributes())==null?void 0:o.alpha)??!1,a;if(e.MRTCompatible&&(a=this.inputBuffer.texture[0].type),e.MRTCompatible||(a=this.inputBuffer.texture.type),e.setRenderer(i),e.setSize(n.width,n.height),e.initialize(i,s,a),this.autoRenderToScreen&&(r.length>0&&(r[r.length-1].renderToScreen=!1),e.renderToScreen&&(this.autoRenderToScreen=!1)),t!==void 0?r.splice(t,0,e):r.push(e),this.autoRenderToScreen&&(r[r.length-1].renderToScreen=!0),e.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){let l=this.createDepthTexture();for(e of r)e.setDepthTexture(l)}else e.setDepthTexture(this.depthTexture)}setHelperStartIndex(e){this.helperStartIndex=e}removePass(e){let t=this.passes,r=t.indexOf(e);if(r!==-1&&t.splice(r,1).length>0){if(this.depthTexture!==null){let i=(n,s)=>n||s.needsDepthTexture;t.reduce(i,!1)||(e.getDepthTexture()===this.depthTexture&&e.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&r===t.length&&(e.renderToScreen=!1,t.length>0&&(t[t.length-1].renderToScreen=!0))}}removeAllPasses(){let e=this.passes;this.deleteDepthTexture(),e.length>0&&(this.autoRenderToScreen&&(e[e.length-1].renderToScreen=!1),this.passes=[])}render(e){let t=this.renderer,r=this.copyPass,i=this.inputBuffer,n=this.outputBuffer,s=this.inputBufferSingle,a=this.outputBufferSingle,o=!1,l,c,u,h;e===void 0&&(e=this.timer.update().getDelta());for(let d of this.passes)d.enabled&&(d.MRTCompatible?d.render(t,i,n,e,o):d.render(t,s,a,e,o),d.needsSwap&&(o&&(r.renderToScreen=d.renderToScreen,l=t.getContext(),c=t.state.buffers.stencil,c.setFunc(l.NOTEQUAL,1,4294967295),r.render(t,i,n,e,o),c.setFunc(l.EQUAL,1,4294967295)),u=i,h=s,i=n,s=a,n=u,a=h),d instanceof vde?o=!0:d instanceof que&&(o=!1))}setSize(e,t,r){let i=this.renderer;if(this._width=e,this._height=t,e===void 0||t===void 0){let s=i.getSize(new W);e=s.width,t=s.height}i.setSize(e,t,r);let n=i.getDrawingBufferSize(new W);this.inputBuffer.setSize(n.width,n.height),this.outputBuffer.setSize(n.width,n.height),this.inputBufferSingle.setSize(n.width,n.height),this.outputBufferSingle.setSize(n.width,n.height);for(let s of this.passes)s.setSize(n.width,n.height)}reset(){let e=this.timer.isAutoResetEnabled();this.dispose(),this.autoRenderToScreen=!0,this.timer.setAutoResetEnabled(e)}dispose(){for(let e of this.passes)e.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.inputBufferSingle!==null&&this.inputBufferSingle.dispose(),this.outputBufferSingle!==null&&this.outputBufferSingle.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose()}},npe=new Yt({name:"CombineMaterial",uniforms:{inputBufferA:new we(null),inputBufferB:new we(null)},blending:Ir,depthWrite:!1,depthTest:!1,vertexShader:`
varying vec2 vUv;
void main() {
    gl_Position = vec4(position.xy, 1.0, 1.0);
    vUv = position.xy * 0.5 + 0.5;
}
`,fragmentShader:`
    varying vec2 vUv;
    uniform sampler2D inputBufferA;
    uniform sampler2D inputBufferB;

    // TODO: Why do we need these when postpro of framemode is enabled???
    layout(location = 1) out vec4 gVelocity;

    void main() {
	vec4 resA = texture2D(inputBufferA, vUv);
	vec4 resB = texture2D(inputBufferB, vUv);
    float a = resA.a + resB.a * ( 1.0 - resA.a );

	vec4 res;
	res.rgb =  resA.rgb + (resB.rgb * (1.0 - resA.a));
	res.a = resA.a + resB.a * (1.0 - resA.a);
	gl_FragColor = res;
    gVelocity = vec4(0.0);
    }
`}),spe=class extends Vi{constructor(e){super("HelperPass",void 0,e),this.MRTCompatible=!1,this.fullscreenMaterial=npe,this.helperPass=new I_(!1,void 0,this.camera),this.helperPass.hasTransmissionPass=!1,this.helperPass.clear=!1,this.helperPass.renderToScreen=!1,this.helperPassOnTop=new I_(!1,void 0,this.camera),this.helperPassOnTop.hasTransmissionPass=!1,this.helperPassOnTop.clear=!1,this.helperPassOnTop.renderToScreen=!1;let t=new Pk({preset:sc.LOW,edgeDetectionMode:s1.COLOR});this.effectPass=new ay(this.camera,t),this.rt=new Ut(10,10,{minFilter:vt,magFilter:vt,wrapS:br,wrapT:br,depthBuffer:!0})}setSize(e,t){this.rt.setSize(e,t),this.effectPass.setSize(e,t)}set sceneHelpers(e){this.helperPass.setScene(e)}get sceneHelpers(){return this.helperPass.getScene()}set sceneHelpersOnTop(e){this.helperPassOnTop.setScene(e)}get sceneHelpersOnTop(){return this.helperPassOnTop.getScene()}setCamera(e){this.helperPass.setCamera(e),this.helperPassOnTop.setCamera(e)}initialize(e,t,r){super.initialize(e,t,r),this.effectPass.initialize(e,t,r)}dispose(){super.dispose(),this.rt.dispose(),this.effectPass.dispose()}render(e,t,r){this.rt.depthTexture=t.depthTexture;let i=e.getClearAlpha();e.setClearAlpha(0),this.helperPass.clearDepth=!0,this.helperPass.clearColorOnly=!0,this.helperPass.render(e,this.rt),this.helperPassOnTop.render(e,this.rt),this.effectPass.renderToScreen=!1,this.effectPass.render(e,this.rt,r),this.fullscreenMaterial.uniforms.inputBufferA.value=r.texture,this.fullscreenMaterial.uniforms.inputBufferB.value=t.texture,e.setClearAlpha(i),e.setRenderTarget(null),e.clear(),e.render(this.scene,this.camera)}},ape=`#define GLSLIFY 1
#include <skinning_pars_vertex>
out vec3 n;void main(){
#include <beginnormal_vertex>
#include <skinbase_vertex>
#include <skinnormal_vertex>
#include <defaultnormal_vertex>
#include <begin_vertex>
#include <skinning_vertex>
vec4 view_space=viewMatrix*modelMatrix*vec4(transformed,1.0);gl_Position=projectionMatrix*view_space;n=normalize(transformedNormal);}`,ope=`#define GLSLIFY 1
in vec3 n;void main(){gl_FragColor=vec4(n,1.0);}`,lpe=`#define GLSLIFY 1
out vec2 v_uv;void main(){v_uv=uv;gl_Position=vec4(position.xy,1.0,1.0);}`,cpe=`#define GLSLIFY 1
in vec2 v_uv;const float pi=3.14159265;const float num_steps=4.0;const float num_directions=4.0;uniform float near;uniform float far;uniform float fov;uniform vec4 proj_info;uniform bool is_ortho;uniform vec2 resolution;uniform float radius_of_influence;uniform float radius_in_screen_space;uniform float exponent;uniform vec3 ao_color;uniform float bias;uniform sampler2D texture_depth;uniform sampler2D texture_normals;uniform sampler2D texture_blue_noise;uniform sampler2D texture_blue_noise_in_disk;uniform sampler2D texture_color_pass;uniform int frame_index;uniform bool fog_enabled;uniform float fog_near;uniform float fog_far;vec3 uv_to_view_space(vec2 uv,float eye_z){return vec3((uv*proj_info.xy+proj_info.zw)*(is_ortho ? 1.0 : eye_z),eye_z);}float linearize_depth(float depth_sampled){float z=is_ortho ? depth_sampled : depth_sampled*2.0-1.0;return mix((2.0*near*far)/(far+near-z*(far-near)),near+z*(far-near),float(is_ortho));}vec3 get_view_position(vec2 uv_coords){float linear_depth=linearize_depth(texture(texture_depth,uv_coords).x);return uv_to_view_space(uv_coords,linear_depth);}vec3 min_difference(vec3 p,vec3 right,vec3 left){vec3 v1=right-p;vec3 v2=p-left;return(dot(v1,v1)<dot(v2,v2))? v1 : v2;}vec3 rebuild_normal(in vec2 uv,in vec3 p){vec2 one_over_resolution=1.0/resolution;vec3 r=get_view_position(uv+vec2(one_over_resolution.x,0));vec3 l=get_view_position(uv+vec2(-one_over_resolution.x,0));vec3 t=get_view_position(uv+vec2(0,one_over_resolution.y));vec3 b=get_view_position(uv+vec2(0,-one_over_resolution.y));return normalize(cross(min_difference(p,r,l),min_difference(p,t,b)));}float falloff(float distance_squared){float neg_inv_r2=-1.0/(radius_of_influence*radius_of_influence);return distance_squared*neg_inv_r2+1.0;}float ao_contribution(vec3 P,vec3 N,vec3 S){vec3 to_sample=S-P;float norm_squared=dot(to_sample,to_sample);float norm=sqrt(norm_squared);float cos_theta=dot(N,to_sample)/norm;return clamp(cos_theta-bias,0.0,1.0)*clamp(falloff(norm_squared),0.0,1.0);}float compute_ambient_occlusion(vec2 uv,float radius_in_screen_space,vec3 pc,vec3 view_space_n){vec2 one_over_resolution=1.0/resolution;ivec2 noise_uv=ivec2(int(mod(gl_FragCoord.x,128.0)),int(mod(gl_FragCoord.y,128.0)));float noise=texelFetch(texture_blue_noise,noise_uv,0).r;noise=fract(noise+0.61803398875*float(frame_index));float theta=noise*2.0*3.1415;float ct=cos(theta);float st=sin(theta);float step_size=radius_in_screen_space/(num_steps+1.0);const float angle_step=2.0*pi/num_directions;float contribution=0.0;for(int i=0;i<int(num_directions);++i){float current_pixel=step_size+1.0;for(int j=0;j<int(num_steps);++j){int index=i*int(num_steps)+j;vec2 blue_noise_sample=texelFetch(texture_blue_noise_in_disk,ivec2(index,0),0).rg;vec2 disk_point;disk_point.x=blue_noise_sample.x*ct-blue_noise_sample.y*st;disk_point.y=blue_noise_sample.x*st+blue_noise_sample.y*ct;vec2 sample_direction=disk_point;vec2 snapped_uv=round(current_pixel*sample_direction)*one_over_resolution+uv;vec3 ps=get_view_position(snapped_uv);current_pixel+=step_size;contribution+=ao_contribution(pc,view_space_n,ps);}}float mult=1.0/(1.0-bias);contribution*=mult/(num_directions*num_steps);return clamp(1.0-contribution*2.0,0.0,1.0);}
#define USE_GBUFFER_NORMALS
void main(){vec3 view_space_p=get_view_position(v_uv);
#ifdef USE_GBUFFER_NORMALS
vec3 view_space_n=texture(texture_normals,v_uv).rgb;view_space_n.z*=-1.0;
#else
vec3 view_space_n=-rebuild_normal(v_uv,view_space_p);
#endif
float radius_ss=radius_in_screen_space/(is_ortho ? 1.0 : view_space_p.z);float ao=compute_ambient_occlusion(v_uv,radius_ss,view_space_p,view_space_n);float final=pow(ao,exponent);if(view_space_p.z>=far){final=1.0;}vec3 color=mix(ao_color,vec3(1.0),final);if(fog_enabled){float fog_factor=smoothstep(fog_near,fog_far,view_space_p.z);color=mix(color,vec3(1.0),fog_factor);}gl_FragColor=vec4(color,1.0);}`,hpe=`#define GLSLIFY 1
out vec2 v_uv;void main(){gl_Position=vec4(position.xy,1.0,1.0);v_uv=uv;}`,upe=`#define GLSLIFY 1
in vec2 v_uv;uniform sampler2D texture_ao_lrez;uniform sampler2D texture_depth_lrez;uniform sampler2D texture_depth_hrez;uniform float near;uniform float far;float linearize_depth(float depth_sampled){float z=depth_sampled*2.0-1.0;return(2.0*near*far)/(far+near-z*(far-near));}vec2 nearest_depth_filter(in vec2 uv){vec2 resolution=vec2(textureSize(texture_depth_lrez,0));vec2 texel_size=1.0/resolution;vec2 offset=uv-0.5*texel_size;float d_hrez=texture(texture_depth_hrez,uv).r;float a=abs(d_hrez-texture(texture_depth_lrez,offset).r);float b=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(texel_size.x,0.0)).r);float c=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(0.0,texel_size.y)).r);float d=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(texel_size.x,texel_size.y)).r);float min_diff=min(a,min(b,min(c,d)));if(min_diff==a)return offset;if(min_diff==b)return offset+vec2(texel_size.x,0.0);if(min_diff==c)return offset+vec2(0.0,texel_size.y);if(min_diff==d)return offset+vec2(texel_size.x,texel_size.y);}void main(){
#ifdef DEBUG
float d_lrez=texture(texture_depth_lrez,v_uv).r;float d_hrez=texture(texture_depth_hrez,v_uv).r;float output_d=mix(linearize_depth(d_lrez)/far,linearize_depth(d_hrez)/far,step(0.5,v_uv.x));gl_FragColor=vec4(vec3(output_d),1.0);
#else
vec2 filtered_uv=nearest_depth_filter(v_uv);vec4 ao=texture(texture_ao_lrez,filtered_uv);gl_FragColor=vec4(ao.rgb,1.0);gl_FragColor=ao;
#endif
}`,up=[[.478712,.875764],[-.337956,-.793959],[-.955259,-.028164],[.864527,.325689],[.209342,-.395657],[-.106779,.672585],[.156213,.235113],[-.413644,-.082856],[-.415667,.323909],[.141896,-.93998],[.954932,-.182516],[-.766184,.410799],[-.434912,-.458845],[.415242,-.078724],[.728335,-.491777],[-.058086,-.066401],[.20299,.686837],[-.808362,-.556402],[.507386,-.640839],[-.723494,-.22924],[.48974,.317826],[-.622663,.765301],[-.01064,.929347],[.663146,.647618],[-.096674,-.413835],[.525945,-.321063],[-.122533,.366019],[.195235,-.687983],[-.563203,.098748],[.418563,.561335],[-.378595,.800367],[.826922,.001024],[-.085372,-.766651],[-.92192,.183673],[-.590008,-.721799],[.167751,-.164393],[.032961,-.56253],[.6329,-.107059],[-.46408,.569669],[-.173676,-.958758],[-.242648,-.234303],[-.275362,.157163],[.382295,-.795131],[.562955,.115562],[.190586,.470121],[.770764,-.297576],[.237281,.93105],[-.666642,-.455871],[-.905649,-.298379],[.33952,.157829],[.701438,-.7041],[-.062758,.160346],[-.220674,.957141],[.642692,.432706],[-.77339,-.015272],[-.671467,.24688],[.158051,.062859],[.806009,.527232],[-.05762,-.247071],[.333436,-.51671],[-.550658,-.315773],[-.652078,.589846],[.008818,.530556],[-.210004,.519896]],dpe=new Yt({vertexShader:ape,fragmentShader:ope}),tv=new Yt({vertexShader:hpe,fragmentShader:upe,uniforms:{texture_ao_lrez:new we(null),texture_depth_lrez:new we(null),texture_depth_hrez:new we(null),near:new we(null),far:new we(null)}}),ppe=class extends Vi{constructor(e,t){super("AmbientOcclusionPass",void 0,t),this.fogEnabled=!1,this.fogNear=1,this.fogFar=1e3,this.frameIndex=0,this._runHalfRes=!0,this._width=1,this._height=1;let r=1024,i=1024;this.gBuffer=new Ut(r,i,{type:xn,depthTexture:new Wu(r,i),minFilter:vt,magFilter:vt}),this.depthBufferHighRes=new Ut(r,i,{depthTexture:new Wu(r,i)}),this.aoBuffer=new Ut(r,i,{minFilter:vt,magFilter:vt}),this.splineScene=e,this.splineCamera=t;let n=new Float32Array(up.length*2);for(let a=0;a<up.length;a++){let o=a*2;n[o+0]=up[a][0],n[o+1]=up[a][1]}this.blueNoiseInDiskTexture=new _0(n,up.length,1,oR,xn),this.blueNoiseInDiskTexture.wrapS=Za,this.blueNoiseInDiskTexture.wrapT=Za,this.blueNoiseInDiskTexture.needsUpdate=!0,this.hbaoMaterial=new Yt({vertexShader:lpe,fragmentShader:cpe,uniforms:{near:new we(null),far:new we(null),fov:new we(null),proj_info:new we(new dt),is_ortho:new we(!1),resolution:new we(new W),radius_of_influence:new we(8),radius_in_screen_space:new we(1),exponent:new we(1),ao_color:new we(new E),bias:new we(.5),texture_depth:new we(null),texture_normals:new we(null),texture_blue_noise:new we(null),texture_blue_noise_in_disk:new we(this.blueNoiseInDiskTexture),frame_index:new we(0),fog_enabled:new we(!1),fog_near:new we(1),fog_far:new we(1e3)}}),this.radius=128,this.aoColor={r:0,g:0,b:0},this.bias=.5,this.hbaoMaterial.uniforms.texture_depth.value=this.gBuffer.depthTexture,this.hbaoMaterial.uniforms.texture_normals.value=this.gBuffer.texture,this.needsSwap=!0,this.aaBuffer=new Ut(r,i,{minFilter:vt,magFilter:vt,wrapS:br,wrapT:br,depthBuffer:!1,type:xn});let s=new Pk({preset:sc.ULTRA,edgeDetectionMode:s1.COLOR});this.effectPass=new ay(this.camera,s)}initialize(e,t,r){super.initialize(e,t,r),this.effectPass.initialize(e,t,r)}setBlueNoiseTexture(e){this.hbaoMaterial.uniforms.texture_blue_noise.value=e}setSize(e,t){this._width=e,this._height=t,this.depthBufferHighRes.setSize(e,t);let r=this._runHalfRes?.5:1,i=e*r,n=t*r;this.gBuffer.setSize(i,n),this.aoBuffer.setSize(i,n),this.hbaoMaterial.uniforms.resolution.value.set(i,n),this.aaBuffer.setSize(i,n),this.effectPass.setSize(i,n)}get runHalfRes(){return this._runHalfRes}set runHalfRes(e){this._runHalfRes=e,this.setSize(this._width,this._height)}setCamera(e){this.splineCamera=e}setScene(e){this.splineScene=e}render(e,t,r){this.splineScene.overrideMaterial=dpe;let i=this.splineCamera.layers.mask;if(this.splineCamera.layers.set(5),e.setRenderTarget(this.gBuffer),e.clear(),e.render(this.splineScene,this.splineCamera),e.setRenderTarget(this.depthBufferHighRes),e.clear(),e.render(this.splineScene,this.splineCamera),this.splineScene.overrideMaterial=null,this.splineCamera.layers.mask=i,this.hbaoMaterial.uniforms.radius_of_influence.value=this.radius,this.hbaoMaterial.uniforms.ao_color.value.set(this.aoColor.r,this.aoColor.g,this.aoColor.b),this.hbaoMaterial.uniforms.bias.value=this.bias,this.hbaoMaterial.uniforms.fog_enabled.value=this.fogEnabled,this.hbaoMaterial.uniforms.fog_near.value=this.fogNear,this.hbaoMaterial.uniforms.fog_far.value=this.fogFar,this.hbaoMaterial.uniforms.frame_index.value=this.frameIndex,this.frameIndex++,this.splineCamera.isPerspectiveCamera){this.hbaoMaterial.uniforms.near.value=this.splineCamera.perspCamera.near,this.hbaoMaterial.uniforms.far.value=this.splineCamera.perspCamera.far;let n=this.splineCamera.perspCamera.projectionMatrix.elements,s=2/n[0],a=2/n[5],o=-(1-n[8])/n[0],l=-(1+n[9])/n[5];this.hbaoMaterial.uniforms.proj_info.value.set(s,a,o,l);let c=this.splineCamera.perspCamera.fov*(Math.PI/180),u=this.hbaoMaterial.uniforms.resolution.value.y/(Math.tan(c*.5)*2),h=this.hbaoMaterial.uniforms.radius_of_influence.value*.5*u;this.hbaoMaterial.uniforms.radius_in_screen_space.value=h,this.hbaoMaterial.uniforms.is_ortho.value=!1}else{this.hbaoMaterial.uniforms.near.value=this.splineCamera.orthoCamera.near,this.hbaoMaterial.uniforms.far.value=this.splineCamera.orthoCamera.far;let n=this.splineCamera.orthoCamera.projectionMatrix.elements,s=2/n[0],a=2/n[5],o=-(1+n[12])/n[0],l=-(1-n[13])/n[5];this.hbaoMaterial.uniforms.proj_info.value.set(s,a,o,l);let c=.5*(this.hbaoMaterial.uniforms.resolution.value.y/a),u=this.hbaoMaterial.uniforms.radius_of_influence.value*c;this.hbaoMaterial.uniforms.radius_in_screen_space.value=u,this.hbaoMaterial.uniforms.is_ortho.value=!0}this.runHalfRes?(this.fullscreenMaterial=this.hbaoMaterial,e.setRenderTarget(this.aoBuffer),e.clear(),e.render(this.scene,this.camera),this.fullscreenMaterial=tv,tv.uniforms.texture_ao_lrez.value=this.aoBuffer.texture,tv.uniforms.texture_depth_lrez.value=this.gBuffer.depthTexture,tv.uniforms.texture_depth_hrez.value=this.depthBufferHighRes.depthTexture,e.setRenderTarget(e.aoRenderTarget),e.clear(),e.render(this.scene,this.camera)):(this.fullscreenMaterial=this.hbaoMaterial,e.setRenderTarget(this.aaBuffer),e.clear(),e.render(this.scene,this.camera),this.effectPass.renderToScreen=!1,this.effectPass.render(e,this.aaBuffer,e.aoRenderTarget))}dispose(){this.gBuffer.dispose(),this.depthBufferHighRes.dispose(),this.aoBuffer.dispose()}},fpe=`
varying vec2 vUv;
void main() {
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,mpe=`
uniform sampler2D tInput;
uniform sampler2D tMap;
uniform vec2 resolution;
varying vec2 vUv;

uniform vec2 uResolution;
uniform vec2 uCoords;

// Draws a rectangle at center <st> with size <size>
float rectangle(vec2 st, vec2 size) {
    size = vec2(0.5) - size * 0.5;
    vec2 uv = vec2(step(size.x, st.x), step(size.y, st.y));
    uv *= vec2(step(size.x, 1.0 - st.x), step(size.y, 1.0 - st.y));

    return uv.x * uv.y;
}

uniform vec2 uSize;
uniform float uScale;
uniform float uDPR;
uniform float uCurrent;
uniform vec3 uSceneColor;

void main() {
    vec2 screenUv = gl_FragCoord.xy / uResolution.xy;
    screenUv *= 1.0 / uDPR;

    vec2 center = vec2(0.5, -0.5);
    vec2 outsideUv = screenUv;
    outsideUv += center;
    outsideUv -= uCoords.xy / uResolution.xy;
    outsideUv = (outsideUv - 0.5) + 0.5;
    outsideUv -= center;
    vec2 s = (uSize / uResolution) * uScale;
    float isOutside = 1.0 - rectangle(outsideUv, s);
    
    vec2 mid = vec2(0.5);
    vec2 insideUv = (screenUv - mid + s * mid) / s;
    vec4 background = texture2D(tInput, screenUv);
    vec4 image = texture2D(tMap, insideUv);
    gl_FragColor = mix(image, background, isOutside);
}
`,gpe=class extends Js{constructor(){super(new Yt({vertexShader:fpe,fragmentShader:mpe,uniforms:{tInput:new we(null),tMap:new we(null),uResolution:new we(new W),uSize:new we(new W),uCoords:new we(new W),uScale:new we(1),uSceneColor:new we(new $e(16711680)),uDPR:new we(1),uCurrent:new we(0)}}),"tInput"),this.needsSwap=!0}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.tMap.value}set texture(e){this.uniforms.tMap.value=e}},vpe=`
void main() {
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,ype=`
uniform sampler2D toScene;
uniform sampler2D fromScene;
uniform vec2 resolution;

uniform vec2 uResolution;
uniform float uDPR;

uniform float mixRatio;
uniform sampler2D tMixTexture;
uniform int useTexture;
uniform float threshold;

void main() {
	vec2 screenUv = gl_FragCoord.xy / uResolution.xy;
	screenUv *= 1.0 / uDPR;

	vec4 texel1 = texture2D( fromScene, screenUv );
	vec4 texel2 = texture2D( toScene, screenUv );

	if (useTexture==1) {
		
		vec4 transitionTexel = texture2D( tMixTexture, screenUv );
		float r = mixRatio * (1.0 + threshold * 2.0) - threshold;
		float mixf=clamp((transitionTexel.r - r)*(1.0/threshold), 0.0, 1.0);
		
		gl_FragColor = mix( texel1, texel2, mixf );
	} else {
		
		gl_FragColor = mix( texel1, texel2, mixRatio );
		
	}
}
`,xpe=[],wpe=class extends Js{constructor(){super(new Yt({vertexShader:vpe,fragmentShader:ype,uniforms:{toScene:new we(null),fromScene:new we(null),uResolution:new we(new W),uDPR:new we(1),mixRatio:new we(0),threshold:new we(.1),useTexture:new we(0),tMixTexture:{value:xpe[0]}}}),"toScene"),this.needsSwap=!0}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.fromScene.value}set texture(e){this.uniforms.fromScene.value=e}};function JD(e,t){return t&&t.enabled&&e.push(t.effect),e}var bpe=e=>Object.values(Ct).includes(e)?e:Ct.NORMAL,_pe=class extends ui{constructor(e){super(),this.postprocessingState=X0.defaultData,this._scene=new pl,this._camera=new bi,this.effects=new Map,this.blueNoiseTexture=new _0,this._renderToScreen=!0,this.clock=new CZ,this.renderer=e,this.debug=!1,this.effects.set("bloom",new jde),this.effects.set("chromaticAberration",new Hde),this.effects.set("vignette",new Xde),this.effects.set("noise",new qde),this.effects.set("colorAverage",new Gde),this.effects.set("hueSaturation",new Wde),this.effects.set("brightnessContrast",new Vde),this.effects.set("depthOfField",new Yde),this.effects.set("pixelation",new Qde),this.effectComposer=new ipe(this.renderer),this.effectComposer.autoRenderToScreen=!1,this.opaquePass=new I_(!0,this.scene,this.camera),this.opaquePass.clear=!0,this.transmissionPass=new tpe(this.scene,this.camera,this.renderer),this.aoPass=new ppe(this.scene,this.camera),this.taaPass=new epe,this.taaPass.renderToScreen=!1,this.helperPass=new spe(this.camera),this.helperPass.renderToScreen=!1,this.overlayPass=new gpe,this.overlayPass.enabled=!1,this.sceneTransitionPass=new wpe,this.sceneTransitionPass.enabled=!1,this._initCopyPass(),this._initPasses()}set overlayTexture(e){e!==void 0?(this.overlayPass.texture=e,this.overlayPass.enabled=!0):this.overlayPass.enabled=!1}get overlayTexture(){return this.overlayPass.texture}set sceneHelpers(e){this.helperPass.sceneHelpers=e}get sceneHelpers(){return this.helperPass.sceneHelpers}set sceneHelpersOnTop(e){this.helperPass.sceneHelpersOnTop=e}get sceneHelpersOnTop(){return this.helperPass.sceneHelpersOnTop}get scene(){return this._scene}set scene(e){this._scene=e,this.opaquePass.setScene(e),this.transmissionPass.setScene(e),this.aoPass.setScene(e)}get camera(){return this._camera}set camera(e){this._camera=e,this.opaquePass.setCamera(e),this.transmissionPass.setCamera(e),this.aoPass.setCamera(e),this.helperPass.setCamera(e)}updateRenderToScreen(){let e=!1;for(let t=this.effectComposer.passes.length-1;t>=0;t--){let r=this.effectComposer.passes[t];if(r.enabled===!0&&!e&&this._renderToScreen){r.renderToScreen=!0,e=!0;continue}r.renderToScreen=!1}}disableHelpers(){this.helperPass.enabled=!1,this.updateRenderToScreen()}enableHelpers(){this.helperPass.enabled=!0,this.updateRenderToScreen()}updateBlueNoiseTexture(e){this.blueNoiseTexture=new _0(e,128,128),this.blueNoiseTexture.wrapS=Za,this.blueNoiseTexture.wrapT=Za,this.blueNoiseTexture.minFilter=Xt,this.blueNoiseTexture.magFilter=Xt,this.blueNoiseTexture.needsUpdate=!0}setAmbientOcclusionParams(e,t,r,i,n,s,a,o){this.aoPass.enabled=e,this.aoPass.radius=t,this.aoPass.bias=r,this.aoPass.aoColor=i,this.aoPass.fogEnabled=n,this.aoPass.fogNear=s,this.aoPass.fogFar=a,this.aoPass.runHalfRes!==!o&&(this.aoPass.runHalfRes=!o)}setTransmissionPassEnabled(e){this.transmissionPass.enabled=e,this.opaquePass.hasTransmissionPass=e}_initPasses(){var e,t;if((e=this.uvEffectPass)==null||e.dispose(),(t=this.effectPass)==null||t.dispose(),this.effectComposer.removeAllPasses(),this.transmissionPass.updatePasses(this.renderer),this.effectComposer.addPass(this.aoPass),this.effectComposer.addPass(this.opaquePass),this.effectComposer.addPass(this.transmissionPass),this.effectComposer.addPass(this.taaPass),this.postprocessingState.enabled){let r=[this.effects.get("pixelation")].reduce(JD,[]);r.length>0&&(this.uvEffectPass=new ay(this.camera,...r),this.uvEffectPass.renderToScreen=!1,this.effectComposer.addPass(this.uvEffectPass));let i=[this.effects.get("chromaticAberration"),this.effects.get("bloom"),this.effects.get("colorAverage"),this.effects.get("hueSaturation"),this.effects.get("brightnessContrast"),this.effects.get("vignette"),this.effects.get("noise")].reduce(JD,[]);i.length>0&&(this.effectPass=new ay(this.camera,...i),this.effectPass.renderToScreen=!1,this.effectComposer.addPass(this.effectPass))}this.effectComposer.addPass(this.overlayPass),this.effectComposer.addPass(this.sceneTransitionPass),this.effectComposer.addPass(this.helperPass)}_initCopyPass(){if(this._savePass)return;let e=new W;this.renderer.getDrawingBufferSize(e),this._rt=new Ut(e.x,e.y,{depthBuffer:!1,stencilBuffer:!1,wrapS:Za,wrapT:Za}),this._rt.samples=0,this._savePass=new D_(this._rt,!1),this._savePass.renderToScreen=!1}setCopyPass(e){this._rt=e,this._savePass=new D_(this._rt,!1),this.renderToScreen=!1}get renderToScreen(){return this._renderToScreen}set renderToScreen(e){if(this._renderToScreen===e)return;let t=this.effectComposer;!t||(e===!0?t.removePass(this._savePass):t.addPass(this._savePass),this._renderToScreen=e,this.updateRenderToScreen())}set sceneTransitionFromTexture(e){e!==this.sceneTransitionPass.texture&&(e!==null?this.sceneTransitionPass.enabled=!0:(this.sceneTransitionPass.enabled=!1,this.updateRenderToScreen()),this.sceneTransitionPass.texture=e)}get texture(){return this._rt&&this._rt.texture}get renderTarget(){return this._rt}updatePostprocessing(e){let{enabled:t,...r}=e,i=!1;t!==this.postprocessingState.enabled&&(i=!0);for(let n of Object.entries(r)){let s=n[1],a=this.effects.get(n[0]);if(a){a.enabled!==s.enabled&&(i=!0),a.enabled=s.enabled;for(let[o,l]of Object.entries(s))o==="blendFunction"?a.blendFunction=bpe(l):a[o]=l}}this.postprocessingState=e,i&&this._initPasses()}render(){this.effectComposer.render(this.clock.getDelta())}setScissor(e,t,r,i){e instanceof dt?(this.effectComposer.inputBuffer.scissor.set(e.x,e.y,e.z,e.w),this.effectComposer.outputBuffer.scissor.set(e.x,e.y,e.z,e.w)):(this.effectComposer.inputBuffer.scissor.set(e,t,r,i),this.effectComposer.outputBuffer.scissor.set(e,t,r,i));let n=this.renderer.getPixelRatio();this.effectComposer.inputBuffer.scissor.multiplyScalar(n),this.effectComposer.outputBuffer.scissor.multiplyScalar(n),this.renderer.setScissor(e,t,r,i)}setScissorTest(e){this.effectComposer.inputBuffer.scissorTest=e,this.effectComposer.outputBuffer.scissorTest=e,this.renderer.setScissorTest(e)}setViewport(e,t,r,i){e instanceof dt?(this.effectComposer.inputBuffer.viewport.copy(e),this.effectComposer.outputBuffer.viewport.copy(e)):(this.effectComposer.inputBuffer.viewport.set(e,t,r,i),this.effectComposer.outputBuffer.viewport.set(e,t,r,i))}resize(e,t,r){if(this.effectComposer.setSize(e,t,r),this._rt){let i=this.renderer.getPixelRatio();this._rt.setSize(e*i,t*i)}}dispose(){var e,t;(e=this.uvEffectPass)==null||e.dispose(),(t=this.effectPass)==null||t.dispose(),this.effectComposer.dispose()}},Spe=e=>`

// PCSS implementation based on:
// https://www.gamedev.net/articles/programming/graphics/contact-hardening-soft-shadows-made-fast-r4906/
// NOTE: This number affects how big the shadow blur can
// possibly get. Bigger number == bigger blur, but less precise results

const float  gPenumbraFilterSize = 80.0;
const int   gPenumbraSamples = ${e};
const int gShadowSamples = ${e};
const float gShadowSamplesRpc = 1.0f / float(gShadowSamples);

#ifdef USE_SHADOWMAP
    #if NUM_DIR_LIGHT_SHADOWS > 0

        uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
        varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];

        struct DirectionalLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
        };

        uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];

    #endif

    #if NUM_SPOT_LIGHT_SHADOWS > 0

        uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
        varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_SHADOWS ];

        struct SpotLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
        };

        uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];

    #endif

    #if NUM_POINT_LIGHT_SHADOWS > 0

        uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
        varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];

        struct PointLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
            float shadowCameraNear;
            float shadowCameraFar;
        };

        uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];

    #endif

    /*
    #if NUM_RECT_AREA_LIGHTS > 0

        // TODO (abelnation): create uniforms for area light shadows

    #endif
    */

float computePenumbra(int index, sampler2D shadowMap, float temporalAngle, float texelSize, vec2 uv, float compare, float texelScalar, float shadowRadius)
{
    float penumbra = 1.0;
    float blockerDepthAvg = 0.0;
    float blockerCount = 0.0;

    #pragma unroll_loop_start
    for(int i = 0; i < gPenumbraSamples; i ++)
    {
        vec2 offset = (vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize) * texelScalar;
        float depth = unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) );

        if(depth < compare + 0.0001)
        {
            blockerDepthAvg += depth;
            blockerCount++;
        }
    }
    #pragma unroll_loop_end

    if (blockerCount > 0.0)
    {
        blockerDepthAvg /= blockerCount;

        // Compute penumbra
        penumbra = (compare - blockerDepthAvg) / (blockerDepthAvg);
        penumbra *= penumbra;
        penumbra *= 200.0 * penumbraSize[min(index, 5 - 1)]; // Magic number that affects how quickly the penumbra grows

        return clamp(penumbra, 0.00, 1.0);
    }
    return 0.0;
}

float vogelShadow(int index, sampler2D shadowMap, vec2 uv, float texelSize, float compare, float shadowRadius)
{
    float shadow         = 0.0f;

    // NOTE: When using TAA, we should use screen space interleaved gradient noise
    vec2 halton = haltonSequence[frameIndex];
    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
    float temporalAngle  = temporalOffset * PI2;

    float texelScalar = (gPenumbraFilterSize) / (texelSize * 1024.);
    float penumbra = computePenumbra(index, shadowMap, temporalAngle, texelSize, uv, compare, texelScalar, shadowRadius);
    if (penumbra == -1.0) {
        return 1.0;
    }

    #pragma unroll_loop_start
    for (int i = 0; i < gShadowSamples; i++)
    {
        vec2 vogelSample =  vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;
        // Overall blurring offset
        vec2 offset = vogelSample * (shadowRadius * 2.);

        // Penumbra offset
        offset += vogelSample * (penumbra * texelScalar);

        shadow += step( compare, unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) ) );
    }
    #pragma unroll_loop_end

    return shadow * gShadowSamplesRpc;
}


    float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {

        return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );

    }

    vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {

        return unpackRGBATo2Half( texture2D( shadow, uv ) );

    }

    float VSMShadow (sampler2D shadow, vec2 uv, float compare ){

        float occlusion = 1.0;

        vec2 distribution = texture2DDistribution( shadow, uv );

        float hard_shadow = step( compare , distribution.x ); // Hard Shadow

        if (hard_shadow != 1.0 ) {

            float distance = compare - distribution.x ;
            float variance = max( 0.00000, distribution.y * distribution.y );
            float softness_probability = variance / (variance + distance * distance ); // Chebeyshevs inequality
            softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 ); // 0.3 reduces light bleed
            occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );

        }
        return occlusion;

    }

    float getShadow( int i, sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {

        float shadow = 1.0;

        shadowCoord.xyz /= shadowCoord.w;
        shadowCoord.z += shadowBias;

        // if ( something && something ) breaks ATI OpenGL shader compiler
        // if ( all( something, something ) ) using this instead

        bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
        bool inFrustum = all( inFrustumVec );

        bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );

        bool frustumTest = all( frustumTestVec );

        if ( frustumTest ) {

        #if defined( SHADOWMAP_TYPE_PCF )

            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
            return vogelShadow(i, shadowMap, shadowCoord.xy, texelSize.x, shadowCoord.z, shadowRadius );

        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )

            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
            float dx = texelSize.x;
            float dy = texelSize.y;

            vec2 uv = shadowCoord.xy;
            vec2 f = fract( uv * shadowMapSize + 0.5 );
            uv -= f * texelSize;

            shadow = (
                texture2DCompare( shadowMap, uv, shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
                mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
                     f.x ) +
                mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
                     f.x ) +
                mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
                     f.y ) +
                mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
                     f.y ) +
                mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
                          f.x ),
                     mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
                          f.x ),
                     f.y )
            ) * ( 1.0 / 9.0 );

        #elif defined( SHADOWMAP_TYPE_VSM )

            shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );

        #else // no percentage-closer filtering:

            shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );

        #endif

        }

        return shadow;

    }

    // cubeToUV() maps a 3D direction vector suitable for cube texture mapping to a 2D
    // vector suitable for 2D texture mapping. This code uses the following layout for the
    // 2D texture:
    //
    // xzXZ
    //  y Y
    //
    // Y - Positive y direction
    // y - Negative y direction
    // X - Positive x direction
    // x - Negative x direction
    // Z - Positive z direction
    // z - Negative z direction
    //
    // Source and test bed:
    // https://gist.github.com/tschw/da10c43c467ce8afd0c4

    vec2 cubeToUV( vec3 v, float texelSizeY ) {

        // Number of texels to avoid at the edge of each square

        vec3 absV = abs( v );

        // Intersect unit cube

        float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
        absV *= scaleToCube;

        // Apply scale to avoid seams

        // two texels less per square (one texel will do for NEAREST)
        v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );

        // Unwrap

        // space: -1 ... 1 range for each square
        //
        // #X##         dim    := ( 4 , 2 )
        //  # #         center := ( 1 , 1 )

        vec2 planar = v.xy;

        float almostATexel = 1.5 * texelSizeY;
        float almostOne = 1.0 - almostATexel;

        if ( absV.z >= almostOne ) {

            if ( v.z > 0.0 )
                planar.x = 4.0 - v.x;

        } else if ( absV.x >= almostOne ) {

            float signX = sign( v.x );
            planar.x = v.z * signX + 2.0 * signX;

        } else if ( absV.y >= almostOne ) {

            float signY = sign( v.y );
            planar.x = v.x + 2.0 * signY + 2.0;
            planar.y = v.z * signY - 2.0;

        }

        // Transform to UV space

        // scale := 0.5 / dim
        // translate := ( center + 0.5 ) / dim
        return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );

    }

    float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {

        float shadow = 1.0;
        vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );

        // for point lights, the uniform @vShadowCoord is re-purposed to hold
        // the vector from the light to the world-space position of the fragment.
        vec3 lightToPosition = shadowCoord.xyz;

        // dp = normalized distance from light to fragment position
        float compare = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear ); // need to clamp?
        compare += shadowBias;

        // bd3D = base direction 3D
        vec3 bd3D = normalize( lightToPosition );

        vec2 halton = haltonSequence[frameIndex];
        float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
        float temporalAngle  = temporalOffset * PI2;

        #if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_VSM )
            for (int i = 0; i < gShadowSamples; i++) {
                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;

                // Overall blurring offset
                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);

                // NOTE: Removed for now
                // Penumbra offset
                //offset += vec3(vogelSample.x, vogelSample.y, vogelSample.y)  * (penumbra * gPenumbraFilterSize);

                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );

            }
            return shadow * gShadowSamplesRpc;

        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )
            for (int i = 0; i < 16; i++) {
                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;

                // Overall blurring offset
                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);

                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );

            }
            return shadow * (1.0 / 16.0);
        #else // no percentage-closer filtering

            return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), compare );

        #endif

    }

#endif
`,Ape=pt.lights_fragment_begin,Cpe=pt.shadowmask_pars_fragment,e5=null,Mpe=e=>{switch(e){case"low":return 8;case"medium":return 16;case"high":return 32;default:return 16}},Epe=(e="medium")=>{if(e5===e)return!1;e5=e;let t=Mpe(e);pt.shadowmap_pars_fragment=Spe(t);let r=Ape.slice();r=r.replace("getShadow( spotShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX + 3, spotShadowMap[ i ]"),r=r.replace("getShadow( directionalShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX, directionalShadowMap[ i ]"),pt.lights_fragment_begin=r;let i=Cpe.slice();return i=i.replaceAll("getShadow(","getShadow( UNROLLED_LOOP_INDEX, "),pt.shadowmask_pars_fragment=i,!0},Tpe=`
attribute vec3 randomColor;
varying vec3 vNormal;
flat out vec3 vColor;

void main()
{
vNormal = normal;
vColor = randomColor;
gl_Position = projectionMatrix * (modelViewMatrix * vec4(position, 1.0));
}
`,Ppe=`
uniform float depthContrast;
varying vec3 vNormal;
flat in vec3 vColor;
void main()
{
vec3 normal = (normalize(vNormal)).rgb;

float contrastDepth = (gl_FragCoord.z - 0.5) * depthContrast + 0.5;

vec3 resultColor = mix(mix(vColor, normal, 0.2), vec3(contrastDepth), 0.4);
gl_FragColor = vec4(resultColor, vColor.r);
}
`,Ew=new Yt({vertexShader:Tpe,fragmentShader:Ppe,uniforms:{depthContrast:{value:1}}}),t5=new jr,Dpe=class extends CR{constructor(e){super(e),this._pixelRatio=this.getPixelRatio(),this.viewportWidth=1,this.viewportHeight=1,this.resolution=new W,this.pipeline=new _pe(this),this.dummyCamra=new bi,this.sceneTransitionDuration=0,this.sceneTransitionTimeRemaining=-1,this.isXRCopyPassSet=!1,this.clear=(n=!0,s=!0,a=!0)=>{let o=this.getContext(),l=0;n&&(l|=o.COLOR_BUFFER_BIT),s&&(l|=o.DEPTH_BUFFER_BIT),a&&(l|=o.STENCIL_BUFFER_BIT),o.clear(l),o.clearBufferfv(o.COLOR,1,[0,0,0,1])},this.autoClear=!1;let t=this.setPixelRatio.bind(this),r=this.setSize.bind(this);this.shadowMap.enabled=!0,this.shadowMap.type=x3;let i=this.getContext();if(i&&"drawingBufferColorSpace"in i)try{i.drawingBufferColorSpace="display-p3"}catch(n){console.warn(n)}this.setPixelRatio=n=>{this._pixelRatio!==n&&(this._pixelRatio=n,t(n))},this.setSize=(n,s,a=!0)=>{var o,l;(this.viewportWidth!==n||this.viewportHeight!==s)&&(this.viewportWidth=n,this.viewportHeight=s,r(n,s,a),(o=this.normalRenderTarget)==null||o.setSize(n*this._pixelRatio,s*this._pixelRatio),this._resizeTransmission(n,s),(l=this.transmissionDepthTarget)==null||l.setSize(n*this._pixelRatio/2,s*this._pixelRatio/2),this.pipeline.resize(n,s,a))},this._superDispose=this.dispose,this.dispose=this._currentDispose}createAORenderTarget(){this.aoRenderTarget===void 0&&(this.aoRenderTarget=new Ut(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio,{generateMipmaps:!1,minFilter:vt,magFilter:vt,wrapS:br,wrapT:br,depthBuffer:!1}))}_resizeTransmission(e,t){var r,i;(r=this.transmissionRenderTarget)==null||r.setSize(e*this._pixelRatio/(this.hdTransmission?1:2),t*this._pixelRatio/(this.hdTransmission?1:2)),(i=this.aoRenderTarget)==null||i.setSize(e*this._pixelRatio/1,t*this._pixelRatio/1)}get hdTransmission(){return Ze.transmissionLod.value===1}set hdTransmission(e){Ze.transmissionLod.value=e===!0?1:2,this._resizeTransmission(this.viewportWidth,this.viewportHeight)}createTransmissionRenderTarget(){this.transmissionRenderTarget===void 0&&(this.transmissionRenderTarget=new Ut(this.viewportWidth*this._pixelRatio/(this.hdTransmission?1:2),this.viewportHeight*this._pixelRatio/(this.hdTransmission?1:2),{generateMipmaps:!0,minFilter:Vu,magFilter:vt,wrapS:br,wrapT:br,depthBuffer:!1}),this.transmissionDepthTarget=new Ut(this.viewportWidth*this._pixelRatio/2,this.viewportHeight*this._pixelRatio/2,{minFilter:Xt,magFilter:Xt,depthBuffer:!1}))}createNormalRenderTarget(){this.normalRenderTarget===void 0&&(this.normalRenderTarget=new Ut(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio,{generateMipmaps:!1,minFilter:Xt,magFilter:Xt,type:xn,depthTexture:new Wu(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio)}))}renderNormal(e,t,r){this.normalRenderTarget&&(this.setClearColor(0),r.layers.enable(8),r.layers.disable(0),r.layers.disable(3),t.traverseEntity(i=>{i.layers.isEnabled(8)&&(i.copyPreviousMatrix=!1)}),this.setRenderTarget(this.normalRenderTarget),this.clear(),r instanceof bi?Ew.uniforms.depthContrast.value=(r.far-r.near)/1e4:Ew.uniforms.depthContrast.value=1,t.overrideMaterial=Ew,this.render(t,r),this.setClearColor(t.bgColor,t.bgColor.a),this.setRenderTarget(null),t.overrideMaterial=e.wireframeState?B_:null,r.layers.enable(0),r.layers.enable(3),t.traverseEntity(i=>{i.layers.isEnabled(8)&&(i.copyPreviousMatrix=!0)}))}renderSplineSceneWithDummyCamera(e,t,r=1){this.dummyCamra.updateCameraState(t.dataPatched);let i=t.height,n=t.width,s=this.viewportWidth/this.viewportHeight;n<i?n=i*s:i=n/s,this.dummyCamra.setViewplaneSize(n,i);for(let a=0;a<r;a++)this.renderSplineScene(e,this.dummyCamra)}renderSplineScene(e,t,{sceneHelpers:r=void 0,sceneHelpersOnTop:i=void 0,overrideTransmission:n=void 0,overrideNormal:s=void 0}={}){let a=e instanceof NA?e.activePage:e,o=a.visible;a.visible=!0;let l=a.scene;this.xr.enabled&&(this.isXRCopyPassSet===!1&&this.getRenderTarget()!==null&&(this.pipeline.setCopyPass(this.getRenderTarget()),this.isXRCopyPassSet=!0),this.xr.updateCamera(t)),this.setClearColor(a.bgColor,a.bgColor.a),a.penumbraSizeArray.forEach((d,p)=>{Ze.penumbraSize.value[p]=d}),Ze.pixelRatioNode.value=this.getPixelRatio(),this.resolution.x!==0&&this.resolution.y!==0?Ze.resolution.value.set(this.resolution.x,this.resolution.y):Ze.resolution.value.set(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio),s!==void 0?(Ze.normalRenderTarget.value=s,Ze.normalRenderTargetDepth.value=t5):l.needsNormal()&&(this.createNormalRenderTarget(),Ze.normalRenderTarget.value=this.normalRenderTarget.texture,Ze.normalRenderTargetDepth.value=this.normalRenderTarget.depthTexture,this.renderNormal(l,a,t));let c=a.data.ao,u=c.occlusion;u&&(this.createAORenderTarget(),Ze.aoRenderTarget.value=this.aoRenderTarget.texture),Ze.aoEnabled.value=u,this.pipeline.setAmbientOcclusionParams(c.occlusion,c.radius,c.bias,a.aoColor,a.fog!==null,a.backupFog.near,a.backupFog.far,c.aoFullRes),this.pipeline.aoPass.setBlueNoiseTexture(this.pipeline.blueNoiseTexture);let h=!1;if(n!==void 0)Ze.transmissionRenderTarget.value=n,Ze.transmissionRenderTargetDepth.value=t5,this.pipeline.setTransmissionPassEnabled(!1);else{let d=l.needsTransmission();d&&(this.transmissionRenderTarget===void 0&&(h=!0),this.createTransmissionRenderTarget(),Ze.transmissionRenderTarget.value=this.transmissionRenderTarget.texture,Ze.aspectRatio.value=hhe(this.viewportWidth,this.viewportHeight),Ze.transmissionRenderTargetDepth.value=this.transmissionDepthTarget.texture),this.pipeline.setTransmissionPassEnabled(d)}t.layers.enable(3),t.layers.enable(8),this.pipeline.sceneHelpers=r,this.pipeline.sceneHelpersOnTop=i,this.pipeline.scene=a,this.pipeline.camera=t,h&&this.pipeline.transmissionPass.updatePasses(this),this.pipeline.postprocessingState!==a.postprocessing&&(this.pipeline.updatePostprocessing(a.postprocessing),!r&&!i&&this.pipeline.disableHelpers()),this.clearAlphaOverride!==void 0&&this.setClearAlpha(this.clearAlphaOverride),a.overrideMaterial=l.wireframeState?B_:null,this.pipeline.render(),Ze.frameIndex.value=(Ze.frameIndex.value+1)%16,t instanceof bi&&t.copyHistory(),a.visible=o}renderFromSceneForSceneTransitionPass(e,t,r){this.pipeline.renderToScreen=!1,this.pipeline.renderTarget,this.renderSplineScene(e,t),this.pipeline.sceneTransitionFromTexture=this.pipeline.renderTarget.texture,this.sceneTransitionDuration=r,this.sceneTransitionTimeRemaining=r,this.pipeline.renderToScreen=!0;let i=this.pipeline.sceneTransitionPass.uniforms;i.uDPR.value=window.devicePixelRatio,i.uResolution.value.set(this.domElement.width,this.domElement.height).divideScalar(window.devicePixelRatio)}_currentDispose(){var e,t,r,i,n,s;this._superDispose(),this.pipeline.dispose(),(e=this.aoRenderTarget)==null||e.dispose(),(t=this.transmissionRenderTarget)==null||t.dispose(),(r=this.transmissionDepthTarget)==null||r.dispose(),(i=this.normalRenderTarget)==null||i.dispose(),(s=(n=this.normalRenderTarget)==null?void 0:n.depthTexture)==null||s.dispose()}},Dk=class extends ym(VZ){constructor(e,t=15,r=10066329){super(e,t,r),this.object=e,this.added=!1,this.name=`DirectionalLightHelper: ${e.uuid}`}raycast(e,t){xm(this.object,Dk.geometryHelper,e,t)}},Lk=class extends ym(jZ){constructor(e,t=15,r=6710886){super(e,t,r),this.object=e,this.name=`PointLightHelper: ${e.uuid}`}raycast(e,t){xm(this.object,Lk.geometryHelper,e,t)}},O_=class extends ym(UZ){constructor(e,t=6710886){super(e,t),this.object=e,this.name=`SpotLightHelper: ${e.uuid}`}raycast(e,t){xm(this.object,O_.geometryHelper,e,t)}update(){if(this.object!==void 0){let e=O_._vector,t=this.object.distance?this.object.distance:1e3,r=t*Math.tan(this.object.angle);this.cone.scale.set(r,r,t),e.setFromMatrixPosition(this.object.target.matrixWorld),this.cone.lookAt(e);let i=this.color!==void 0?this.color:this.light.color;if(this.cone.material instanceof Array)for(let n=0,s=this.cone.material.length;n<s;n++)this.cone.material[n].color.set(i);else this.cone.material.color.set(i)}}},Ik=O_;Ik._vector=new E;function Lpe(e,t){e.shadow.camera.right=t/2,e.shadow.camera.left=-t/2,e.shadow.camera.top=t/2,e.shadow.camera.bottom=-t/2,e.shadow.needsUpdate=!0}var Ok=class extends IA(SZ,Dk){constructor(e,t,r){super(),this.super_Entity(e,t),this.castShadow=!0,this.shadow.mapSize.width=2048,this.shadow.mapSize.height=2048,this.shadow.normalBias=1,this.layers.enable(3);let i=this.shadow.camera;i.top=1250,i.bottom=-1250,i.right=1250,i.left=-1250,i.near=-1e4,i.far=2500;let n=new T0(this.shadow.camera);n.visible=!1,this.gizmos.shadowmap=n}update(){this.shadow.camera.updateProjectionMatrix();for(let e in this.gizmos){let t=this.gizmos[e];t instanceof T0&&t.update()}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.objectHelper&&this.objectHelper.update()}updateState(e,t){this.updateState_Light(e,t);let r=e.depth!==void 0&&e.depth!==this.shadow.camera.far||e.size!==void 0&&e.size/2!==this.shadow.camera.right;e.size!==void 0&&Lpe(this,e.size),e.shadowRadius!==void 0&&(this.shadow.radius=e.shadowRadius),e.shadowResolution!==void 0&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null)),e.penumbraSize!==void 0&&t.scene.markPenumbraSizeDirty(),r&&this.update()}},r5=new E,i5=new E,n5=new ft,Rk=class extends IA(xZ,Ik){constructor(e,t,r){super(),this.super_Entity(e,t),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let i=this.shadow.camera;i.fov=mt.RAD2DEG*2*this.angle,i.aspect=1,i.near=100,i.far=2500;let n=new T0(this.shadow.camera);n.visible=!1,this.gizmos.shadowmap=n,this.update()}update(){this.shadow.camera.updateProjectionMatrix();for(let e in this.gizmos){let t=this.gizmos[e];t instanceof T0&&t.update()}}updateMatrixWorld(e){super.updateMatrixWorld(e),i5.setFromMatrixPosition(this.matrixWorld),n5.setFromRotationMatrix(this.matrixWorld),r5.copy(this.up).applyQuaternion(n5).negate().multiplyScalar(this.distance),this.target.position.copy(i5).add(r5),this.target.updateMatrixWorld(),this.objectHelper&&this.objectHelper.update()}updateState(e,t){this.updateState_Light(e,t),e.distance!==void 0&&(this.distance=e.distance),e.decay!==void 0&&(this.decay=e.decay),e.angle!==void 0&&(this.angle=e.angle),e.penumbra!==void 0&&(this.penumbra=e.penumbra),e.shadowRadius!==void 0&&(this.shadow.radius=e.shadowRadius),e.penumbraSize!==void 0&&t.scene.markPenumbraSizeDirty(),e.shadowResolution!==void 0&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}},yl=class extends mA(pl){constructor(e,t){super(),this.data=t,this.bgColor=new nn(1,1,1,1),this.fog=null,this.backupFog=new MR(16777215,.1,2e3),this.fogUseBGColor=!1,this.isActive=!1,this.aoColor=new $e,this.penumbraSizeArrayCache=null,this.super_Entity(e,t),this.personalCamera=new bi(_d,{...Hf.defaultData,...t.camera,name:"Personal Camera"}),this.personalCamera.objectHelper.visible=!1,this.add(this.personalCamera),this.activeCamera=this.personalCamera,this.ambientLight=new vZ(13882323,8553090,.75),this.ambientLight.name="Default Ambient Light",this.ambientLight.layers.enable(3),this.ambientLight.removeFromParent(),this.add(this.ambientLight)}get scene(){return this.parent}get postprocessing(){return this.data.postprocessing}updateVisible(){}setBackgroundColor(e){this.bgColor=e,this.fogUseBGColor===!0&&(this.backupFog.color=e)}updateAmbientLight(e,t){e.color!==void 0&&(this.ambientLight.color=Bi(e.color,t)),e.intensity!==void 0&&(this.ambientLight.intensity=e.intensity),e.enabled!==void 0&&(e.enabled?this.add(this.ambientLight):this.remove(this.ambientLight))}onDeactive(){this.isActive=!1}onActive(e){this.isActive=!0,e.fog=this.fog,this.updateShadow(this.data.shadow)}forceMaterialsUpdate(){this.traverseEntity(e=>{if(e instanceof Cd)if(Array.isArray(e.material))for(let t of e.material)t.needsUpdate=!0;else e.material.needsUpdate=!0,e.material.dispose()})}updateShadow(e){e.softShadowQuality!==void 0&&this.isActive&&Epe(e.softShadowQuality)&&this.forceMaterialsUpdate()}updateFog(e,t){if(e.enabled?this.fog=this.backupFog:this.fog=null,this.isActive){let r=this.scene;r.fog=this.fog}this.fogUseBGColor=e.useBackgroundColor,e.useBackgroundColor?this.backupFog.color.set(this.bgColor):this.backupFog.color=Bi(e.color,t),this.backupFog.near=e.near,this.backupFog.far=e.far}updateAo(e,t){e.aoColor!==void 0&&(this.aoColor=Bi(e.aoColor,t))}updateByOp(e,t,r,i){super.updateByOp(e,t,r,i);let n=t;qn(e.path,["fog"])?this.updateFog(n.fog,r.shared):qn(e.path,["ao"])?this.updateAo(n.ao,r.shared):qn(e.path,["ambient"])?this.updateAmbientLight(n.ambient,r.shared):qn(e.path,["shadow"])&&this.updateShadow(n.shadow)}updateState(e,t){this.updateState_Entity(e,t),e.backgroundColor!==void 0&&this.setBackgroundColor(Bi(e.backgroundColor,t.shared)),e.fog!==void 0&&this.updateFog(e.fog,t.shared),e.ambient!==void 0&&this.updateAmbientLight(e.ambient,t.shared),e.ao!==void 0&&this.updateAo(e.ao,t.shared),e.shadow!==void 0&&this.updateShadow(e.shadow)}raycast(e,t){super.raycast(e,t)}switchActiveCamera(e){e&&e.isDescendantOf(this)&&(this.activeCamera!==this.personalCamera&&(this.activeCamera.objectHelper.visible=!0),this.activeCamera=e,e.objectHelper.visible=!1)}get playCamera(){var e;return((e=this.scene)==null?void 0:e.find(this.data.publish.playCamera))??this.personalCamera}switchToPlayCamera(){this.switchActiveCamera(this.playCamera)}get penumbraSizeArray(){return this.penumbraSizeArrayCache===null&&this.updatePenumbraSizeArray(),this.penumbraSizeArrayCache}updatePenumbraSizeArray(){this.penumbraSizeArrayCache=new Array(5).fill(.5);let e=0,t=0;this.traverseEntity(r=>{if(!r.visible)return!0;r instanceof Ok&&r.visible&&e<3&&(this.penumbraSizeArrayCache[e]=r.data.penumbraSize,e+=1),r instanceof Rk&&r.visible&&e<5-3&&(this.penumbraSizeArrayCache[3+t]=r.data.penumbraSize,t+=1)})}raycastWithClones(e){let t=[],r=i=>{for(let n of i.children){let s=n.cloner;Mt.is(n)&&(n.visible||s!=null&&s.object.data.visible)&&((ws(n)||E_(n)&&this.scene.enableHelpers&&n.objectHelper.visible)&&(e.intersectObject(n,!1,t),R_(n,e,t,!0)),r(n))}};return r(this),t}},Ipe=class extends IA(bZ,Lk){constructor(e,t,r){super(),this.super_Entity(e,t),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let i=this.shadow.camera;i.fov=90,i.aspect=1,i.near=100,i.far=2500;let n=new E(-i.far+this.position.x,-i.far+this.position.y,-i.far+this.position.z),s=new E(i.far+this.position.x,i.far+this.position.y,i.far+this.position.z),a=new Ar(n,s),o=new P0(a,new $e(16755200));o.visible=!1,this.gizmos.shadowmap=o,this.update()}update(){if(this.shadow&&(this.shadow.camera.updateProjectionMatrix(),this.gizmos))for(let e in this.gizmos){let t=this.gizmos[e];if(t instanceof P0){let r=this.shadow.camera,i=new E(-r.far+this.position.x,-r.far+this.position.y,-r.far+this.position.z),n=new E(r.far+this.position.x,r.far+this.position.y,r.far+this.position.z);t.box.set(i,n),t.updateMatrixWorld(!0)}}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.objectHelper&&this.objectHelper.update()}updateState(e,t){this.updateState_Light(e,t),e.distance!==void 0&&(this.distance=e.distance),e.decay!==void 0&&(this.decay=e.decay),e.shadowRadius!==void 0&&(this.shadow.radius=e.shadowRadius),e.shadowResolution!==void 0&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}},Ope=class extends zi{get forceComputeSize(){return!0}get shape(){return this.geometry.userData.shape}updateEntityBoxSize(e,t){let r=this.geometry.getAttribute("position");r!==void 0?SA(r,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:r.count,e,t):super.updateEntityBoxSize(e,t)}},BA=class extends zi{constructor(e,t,r){super(e,t,r),this._shapeId=null,this._context=r}updateState(e,t){super.updateState(e,t),this.updateShape()}updateShape(){var i;let e=this.data.geometry.extrusion.shape,t;if(e.type==="Custom"){let n=e.shapeId;if(n!==this._shapeId&&this.detachShape(),n){this._shapeId=n;let s=this._context.scene.find(n);s!=null&&s.data&&(s.attachedPaths.add(this),t=(i=s.geometry.userData)==null?void 0:i.shape),t||this._context.scene.addPendingCommand(()=>this.updateShape())}}else{let n;switch(e.type){case"Rectangle":n=Rz;break;case"Ellipse":n=bA;break;case"Polygon":n=Oz;break;case"Star":n=Bz;break;default:throw new Error(`Unknown shape type: ${e.type}`)}t=n.create({parameters:e}).userData.shape}let r=this.geometry;t&&r.inputs&&(r.inputs.shapeData=t,r.build(),this.attachedSurfaceCloners.forEach(n=>n.update()))}detachShape(){var e;this._shapeId!==null&&((e=this._context.scene.find(this._shapeId))==null||e.attachedPaths.delete(this))}createGeometryDelayed(e){this.geometryCreateDeleyed=e.shared,this.updateShape(),this.refreshAttachedPaths(e)}updateTransformState(e){return super.updateTransformState(e)}updateGeometryInteractions(e,t){super.updateGeometryInteractions(e,t),this.updateShape()}updateEntityBoxSize(e,t){let r=this.geometry.getAttribute("position");r!==void 0?SA(r,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:r.count,e,t):super.updateEntityBoxSize(e,t)}},Pu=class extends wm(ru,n1){constructor(e,t,r){super(),t.type==="Instance"&&typeof e=="string"&&(t=this.transformAssignData(t,r)),this.super_Entity(e,t),this.objectHelper.update()}get isComponentRoot(){return this.data.type==="Component"&&typeof this.identity=="string"}get isInstanceRoot(){return this.data.type==="Instance"&&typeof this.identity=="string"}transformAssignData(e,t){let r=$0.getComponentData({scene:t.scene.data,shared:t.shared.data},e.component);if(r){let i,n;for(let s of $o.rootOverrideProps)e[s]===void 0?(i===void 0&&(i={...e}),i[s]=r.data[s]):(n===void 0&&(n={}),n[s]=e[s],i===void 0&&(i={...e}),i[s]=fl.apply(r.data[s],e[s]));return this.overrideData=n,i}else return{...Ni.defaultData,...e,...no(Ni.defaultData,$o.rootOverrideProps)}}updateByOp(e,t,r,i){let n;if(this.isInstanceRoot&&!i){if(t=this.transformAssignData(t,r),e.type===0&&e.path.length===0&&this.component)for(let s of $o.rootOverrideProps)s in e.props&&e.props[s]===void 0&&(n===void 0&&(n={...e,props:{...e.props}}),n.props[s]=this.component.data[s]);else if(e.type===0&&e.path.length>0&&$o.rootOverrideProps.includes(e.path[0])){let s=e.path[0];n===void 0&&(n={...e,path:[],props:{[s]:t[s]}})}}super.updateByOp(n??e,t,r,i)}updateState(e,t){this.updateState_Entity(e,t)}expandInstanceChildren(e){let t=this.data;if(this.component===void 0){let r=e.scene.find(t.component)??null,i=!1;if(r!==this.oldComponent){if(this.oldComponent){let n=0;for(let s of this.children)if(Mt.is(s))e.scene.disposeAndUnregisterEntityRecursivelyIfNotReregistered(s),zA(s),n+=1;else break;this.children.splice(0,n)}i=!0}if(r){let n={};Bk(e,[this.uuid],t.overrides,this,r,r,0,i,n);for(let s of this.children)if(Mt.is(s)){let a=s.data;a.type==="Empty"&&a.animations&&s.traverseEntity(o=>{if(o instanceof zi&&o.isSkinnedMesh){let l=o.dataPatched;if(l.bones&&l.boneInverses){let c=l.bones.map(d=>e.scene.find(n[d])),u=l.boneInverses.map(d=>new _e().fromArray(d)),h=new T3(c,u);o.bind(h,o.bindMatrix)}}else o.matrixAutoUpdate=!0})}}this.oldComponent=this.component}}};function zA(e){if(e.component){let t=e.component.instances.indexOf(e);t>=0&&e.component.instances.splice(t,1);for(let r of e.children)Mt.is(r)&&zA(r)}}function s5(e,t,r,i){return e.component===t&&rA(e.identity,i)?e.overrideData===r?2:1:0}function Bk(e,t,r,i,n,s,a,o,l){if(a>50)return!1;if(i.component!==n){if(i.component){let u=i.component.instances.indexOf(i);u>=0&&i.component.instances.splice(u,1)}n.instances.push(i),i.component=n}n instanceof Pu&&n.isInstanceRoot&&n.expandInstanceChildren(e);let c=0;for(let u of n.children)if(Mt.is(u)){let h=[...t,...typeof u.identity=="string"?[u.identity]:u.identity],d=Y0.resolve(r,h,1);d!=null&&!(d instanceof Vr)&&(Object.setPrototypeOf(d,Vr.prototype),console.error("wrong prototype"));let p=null,f;if(!o){let m=i.children[c];if(p=Mt.is(m)?m:null,p!==null){let g=s5(p,u,d,h);f=g>=1?p.stateSelection:void 0,g!==2&&(p=null)}if(p===null&&(p=e.scene.findInstance(h)??null,p!==null)){let g=s5(p,u,d,h);if(f=g>=1?p.stateSelection:void 0,g!==2)p=null;else{let v=p.parent.children.indexOf(p);p.parent.children.splice(v,1),i.children.splice(c,0,p),p.parent===i?v<=c&&console.error("not possible"):(p.parent=i,p.matrixWorldNeedsUpdate=!0,p.resetBBoxNeedsUpdate(),p.updateVisible(),e.pendingDeletes.delete(p))}}}if(p===null){let m=d?fl.apply(u.data,d):u.data;zc.is(m.type)&&(m={...m,type:"Empty"}),p=Jo.createEntity(h,m,e),p.overrideData=d,i.add(p),i.children.splice(i.children.length-1,1),i.children.splice(c,0,p),p.updateState(p.data,e),f&&p.changeSelectedState(f,e),e.scene.registerInstanceAndSetUuid(p)}if(p.isBone){let m=p.identity[p.identity.length-1];l[m]=p.uuid}c+=1,Bk(e,t,r,p,u,s,a+1,o,l)}if(!o){let u=c;for(;;){let h=i.children[c];if(Mt.is(h))e.pendingDeletes.add(h);else break;c+=1}i.children.splice(u,c-u)}return!0}var Rpe=class extends wm(ER,n1){constructor(e,t){super(),this.super_Entity(e,t),this.objectHelper.update(),this.matrixAutoUpdate=!0}updateState(e,t){this.updateState_Entity(e,t)}};function Bpe(e,t,r){let i;return t.geometry.type==="TextGeometry"?new _k(e,t,r):(t.geometry.type==="SubdivGeometry"?i=new Kf(e,t,r):t.geometry.type==="PathGeometry"?i=new BA(e,t,r):t.geometry.type==="VectorGeometry"?i=new Ope(e,t,r):t.geometry.type==="BooleanGeometry"?i=new rd(e,t,r):i=new zi(e,t,r),i)}function kA(e,t,r){return t.type==="Mesh"?Bpe(e,t,r):t.type==="Empty"?new Zf(e,t):t.type==="Bone"?new Rpe(e,t):t.type==="Page"?new yl(e,t):t.type==="PointLight"?new Ipe(e,t,r):t.type==="SpotLight"?new Rk(e,t,r):t.type==="DirectionalLight"?new Ok(e,t,r):t.type==="Component"||t.type==="Instance"?new Pu(e,t,r):zc.is(t.type)?new bi(e,t):(console.error(t),new Zf(e,t))}Jo.createEntity=kA;function zpe(e,t,r){let i=kA(e.identity,t,r),n=e.children,s=e.attachedPaths,a=e.parent,o=e.component,l=e.instances,c=e.overrideData,u=e.uuid,h=e.stateSelection;e.dispose();for(let d of Object.keys(e))delete e[d];Object.setPrototypeOf(e,Object.getPrototypeOf(i));for(let d of Object.keys(i))e[d]=i[d];e.children=[...e.children,...n],e.attachedPaths=s,e.parent=a,e.component=o,e.instances=l,e.uuid=u,e.overrideData=c,e.updateState(e.data,r),h&&e.changeSelectedState(h,r),e.resetBBoxNeedsUpdate()}Jo.changeEntityProptotype=zpe;Jo.Cloner=As;function kpe(e,t,r,i){e.updateByOp(t,r,i,!1)}function a5(e,t){let r=!1,i=t.getLayersOfType("transmission"),n=t.getLayersOfType("outline");return n.length>0&&(e.layers.set(8),i.length>0&&e.layers.enable(3),r=!0,LA(e),DA(e)),i.length===0&&n.length===0&&e.layers.set(0),e instanceof Cd&&e.needsAO&&e.layers.enable(5),r}function o5(e,t){if(!t.layers)return!1;let r=!1,i=t.getLayersOfType("transmission").filter(s=>s.data.visible),n=t.getLayersOfType("outline").filter(s=>s.data.visible);return i.length>0&&(e.layers.set(3),n.length>0&&e.layers.enable(8),r=!0),i.length===0&&n.length===0&&e.layers.set(0),e.needsAO&&e.layers.enable(5),r}function Npe(e){let t=!1;return e.traverseEntity(r=>{if(r instanceof Cd)if(Array.isArray(r.material))for(let i=0;i<r.material.length;i++)a5(r,r.material[i])&&(t=!0);else a5(r,r.material)&&(t=!0)}),t}function Fpe(e){let t=!1;return e.traverseEntity(r=>{if(r instanceof Cd)if(Array.isArray(r.material))for(let i=0;i<r.material.length;i++)o5(r,r.material[i])&&(t=!0);else o5(r,r.material)&&(t=!0)}),t}var Upe=new WR,jpe=new _e,Vpe=new hd;function R_(e,t,r,i=!1){let n=e.cloner;if(n)for(let s of n.children){let a=jpe.copy(s.matrixWorld).invert(),o=Vpe.copy(t.ray).applyMatrix4(a),l=e.matrixWorld;o.applyMatrix4(l);let c=Upe;c.set(o.origin,o.direction),c.near=t.near,c.far=t.far;let u=c.intersectObject(e,!1);u.length>0&&r.push({...u[0],object:i?s:e})}}var Hpe=class{constructor(){this._constraints=new Map}setConstraint(e,t){t===null?this._constraints.delete(e):this._constraints.set(e,t)}removeDependencies(e){this._constraints.delete(e)}applyConstraints(e){let t=new Set;this._constraints.forEach((r,i)=>{let n=[i,r],s=r;for(;this._constraints.has(s);)s=this._constraints.get(s),t.has(s)||n.push(s);for(let a=n.length-2;a>=0;a--)if(!t.has(n[a])){let o=e.find(n[a]);o?o.applyPathSnapping(e):console.warn(`missing entity ${n[a]}`),t.add(n[a])}})}findDependency(e,t){let r=e;for(;this._constraints.has(r);)if(r=this._constraints.get(r),r===t)return!0;return!1}},B_=new dm;B_.wireframe=!0;var l5=new E,NA=class extends pl{constructor(e,t){super(),this.data=e,this.enableHelpers=!1,this.wireframeState=!1,this.needsTransmissionDirty=!0,this.needsNormalDirty=!0,this._needsTransmission=!1,this._needsNormal=!1,this.geometryCacheChanged=!1,this.entityByUuid={},this.entityIdentityToEntity={},this.toExpandCloner=new Set,this.toUpdateCloner=new Set,this.pendingCommands=[],this.pathConstraints=new Hpe,this.errorPage=new yl("fdasfa",{...ed.defaultData,name:""}),this.invisibleObjects=new Zf("jflkdsafjasdifjaslk",{...r_.defaultData,visible:!1,name:"buildin invisible"}),this.needsRecomputeInstances=!1,this.init(e,t),this.matrixAutoUpdate=!1}markGeometryCacheDirty(){this.geometryCacheChanged=!0}markNeedsUpdateRendererDirty(){this.needsTransmissionDirty=!0,this.needsNormalDirty=!0}needsTransmission(){return this.needsTransmissionDirty&&(this._needsTransmission=Fpe(this),this.needsTransmissionDirty=!1),this._needsTransmission}needsNormal(){return this.needsNormalDirty&&(this._needsNormal=Npe(this),this.needsNormalDirty=!1),this._needsNormal}registerInstanceAndSetUuid(e){let t=e.identity.join("-"),r=this.entityIdentityToEntity[t];r&&(e.uuid=r.uuid),this.entityIdentityToEntity[t]=e,this.entityByUuid[e.uuid]=e}markPenumbraSizeDirty(){for(let e of this.children)e instanceof yl&&(e.penumbraSizeArrayCache=null)}findInstance(e){return this.entityIdentityToEntity[e.join("-")]}get bgColor(){return this.activePage.bgColor}get postprocessing(){return this.activePage.data.postprocessing}getWithSortKey(e){let t=this.find(e);if(t===void 0)return;let r=[],i=t;for(;i!==this;){let n=i;i=i.parent;let s=i.children.indexOf(n);r.splice(0,0,s)}return{entity:t,sortKey:r}}getAllSorted(e){let t=[];for(let r of e){let i=this.getWithSortKey(r.id);i!==void 0&&t.push(i)}return t.sort((r,i)=>fae(r.sortKey,i.sortKey)),t.map(r=>r.entity)}nonExistOrDescendantOf(e,t){let r=this.find(e);if(r===void 0)return!0;for(;r;){if(r.uuid===t)return!0;r=r.parent}return!1}find(e){if(this.activePage&&this.activePage.personalCamera.parent){if(e==="f23858d0-4a3b-4bd8-8173-66ed0af7f6fb-personalCamera")return this.activePage.personalCamera;if(e===_d)return this.activePage.personalCamera}if(e===""||e===void 0)return;let t=this.entityByUuid[e];return t===void 0?this.getObjectByProperty("uuid",e):t}debugEnsureEntity(e){let t=this.find(e);if(t){if(Array.isArray(t.identity)&&this.findInstance(t.identity)===void 0){console.error("not found instance");debugger}}else{console.error("not found");debugger}}addPendingExpandCloner(e){this.toExpandCloner.add(e)}addPendingUpdateCloner(e){this.toUpdateCloner.add(e)}markToExpandCloner(e){this.toExpandCloner.add(e),e.traverseEntityAncestors(t=>{this.toExpandCloner.add(t)})}doPendingExpandCloner(){this.toExpandCloner.forEach(e=>{e.expandCloner(this)}),this.toExpandCloner.clear()}doPendingUpdateCloner(){this.toUpdateCloner.forEach(e=>{var t;(t=e.cloner)==null||t.update()}),this.toUpdateCloner.clear()}doPendingUpdates(){this.doPendingExpandCloner(),this.doPendingUpdateCloner(),this.applyPendingCommands()}addPendingCommand(e){this.pendingCommands.push(e)}applyPendingCommands(){this.pendingCommands.forEach(e=>e()),this.pendingCommands.length=0}updateByLibOp(e,t){e.path.length===1&&e.path[0]==="components"&&e.type===1&&this.createChildrenObjects([{...e.data.asset,id:e.id}],this.invisibleObjects,t)}updateTreeByOp(e,t){var r;if(e.path.length===0&&e.type===7){let i=e.parent===null?this:this.find(e.parent);if(i===void 0)throw new Error("unexpected");let n=this.createObject(e.id,e.data,e.children,i,e.localIndex,t);n.updateVisible(),n.resetBBoxNeedsUpdate(),ws(n)&&na(n.parent)&&(n.invalidateUpstreamBooleanData(),n.parent.invalidateDownstreamBooleanData().recomputeBoolean()),this.markNeedsRecomputeInstancesForAncessors(i),this.markNeedsRecomputeInstancesForChildren(n),this.markToExpandCloner(n),this.markPenumbraSizeDirty()}else if(e.path.length===0&&e.type===8){let i=this.find(e.id);if(i===void 0)throw new Error("unexpected");this.markToExpandCloner(i),i.resetBBoxNeedsUpdate(),this.unregisterObject(i);let n=i.parent;this.markNeedsRecomputeInstancesForAncessors(n),this.markNeedsRecomputeInstancesForChildren(i),this.markPenumbraSizeDirty(),i.parent.remove(i),na(i.parent)&&(i.parent.invalidateUpstreamBooleanData(),i.parent.invalidateDownstreamBooleanData().recomputeBoolean()),ws(i)&&(i.freeBooleanPointer(),n instanceof rd&&n.invalidateDownstreamBooleanData().recomputeBoolean()),i instanceof BA&&i.detachShape(),this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(i),this.pathConstraints.removeDependencies(i.uuid)}else if(e.path.length===0&&e.type===9){let i=this.find(e.id);if(i===void 0)throw new Error("unexpected");this.markNeedsRecomputeInstancesForChildren(i);let n=i.parent;this.markNeedsRecomputeInstancesForAncessors(n),(r=i.cloner)==null||r.resetOnMove(),this.markToExpandCloner(i);let s=e.parent===null?this:this.find(e.parent);if(s===void 0)throw new Error("unexpected");s.add(i),this.markNeedsRecomputeInstancesForAncessors(s),this.markToExpandCloner(i),i.invalidateClonerTransform(i),i.updateVisible(),i.resetBBoxNeedsUpdate(),this.markPenumbraSizeDirty();let a=e.localIndex;s.children.splice(a,0,s.children.pop()),ws(i)&&(i.invalidateUpstreamBooleanData(),na(i.parent)?i.parent.invalidateDownstreamBooleanData().recomputeBoolean():n instanceof rd&&n.invalidateDownstreamBooleanData().recomputeBoolean())}this.markNeedsUpdateRendererDirty(),this.markGeometryCacheDirty()}get playPage(){return this.find(this.data.publish.playPage)??this.errorPage}updatePage(e){this.activePage&&this.activePage.onDeactive(),this.activePage=this.errorPage;for(let t of this.children)t instanceof yl&&(t.visible=t.uuid===e,t.visible&&(this.activePage=t,this.activePage.onActive(this)))}updateEntityByOp(e,t,r,i){if(t.type===0){if(("overrides"in t.props||"component"in t.props)&&this.markNeedsRecomputeInstances(),"visible"in t.props&&this.markPenumbraSizeDirty(),t.path.includes("overrides")&&"states"in t.props){let{rest:s}=t.props;t={...t,props:s},this.markNeedsRecomputeInstances()}t.path[0]==="pathSnapping"&&t.props.pathId!==void 0&&this.pathConstraints.setConstraint(e,t.props.pathId)}let n=this.find(e);if(n)try{kpe(n,t,r,{scene:this,shared:i}),n instanceof zi&&n.updateGeometryGroupsIfNeeded()}catch(s){console.error(s)}}get activeCamera(){return this.activePage.activeCamera}switchActiveCamera(e){this.activePage.switchActiveCamera(e)}isInvisibleObjects(e){return e===this.invisibleObjects||e.hasAnccestor(this.invisibleObjects)}init(e,t){let r=Object.entries(t.data.lib.components).map((i,n)=>({data:i[1].asset.data,children:i[1].asset.children,id:i[0],fi:n}));this.invisibleObjects.updateState(this.invisibleObjects.data,{scene:this,shared:t}),this.add(this.invisibleObjects),this.createChildrenObjects(r,this.invisibleObjects,t),this.createChildrenObjects(e.objects,this,t),this.updatePage(e.publish.playPage),this.activePage.switchToPlayCamera(),this.expandInstances(t,!0),this.traverseEntity(i=>{na(i)&&i.recomputeBoolean(),i instanceof bi&&i.updateUp()}),this.doPendingExpandCloner(),this.applyPendingCommands()}markNeedsRecomputeInstances(){this.needsRecomputeInstances=!0}markNeedsRecomputeInstancesForChildren(e){e.traverseEntity(t=>{(t.data.type==="Component"||t.data.type==="Instance")&&this.markNeedsRecomputeInstances()})}markNeedsRecomputeInstancesForAncessors(e){Mt.is(e)&&(e.data.type==="Component"&&this.markNeedsRecomputeInstances(),e.traverseAncestors(t=>{Mt.is(t)&&t.data.type==="Component"&&this.markNeedsRecomputeInstances()}))}relativeizeInner(e,t,r,i,n,s,a){if(e){let o=i.find(e);o&&o!==i&&n.forInstancesRec(l=>{l.data=Vf(l.data,c=>{let u=c.events.data(a.id),h=l.goUp(s);if(h){let d=[...TB(h.identity),e].join("-"),p=this.entityIdentityToEntity[d];if(p){let f=p.uuid,m=ua.zoom(u,t);m[r]=f}else console.warn("cannot find instance")}}).data})}}rewriteActions(e,t,r,i,n,s){e.forEach(a=>{a.data.type==="Transition"?this.relativeizeInner(a.data.object,[...t,a.id],"object",r,i,n,s):a.data.type==="Animation"&&this.relativeizeInner(a.data.object,[...t,a.id],"object",r,i,n,s)})}rewriteEventsBeforeGoToPlayMode(){this.traverseEntity(e=>{if(e instanceof Pu&&typeof e.identity=="string"&&e.data.type==="Component")return e.traverseEntity((t,r)=>{t.data.events.forEach(i=>{if(i.data.type==="GameControl"){let n=!1;if(t.forInstancesRec(s=>{s.data=Vf(s.data,a=>{s.isInstanceRoot||(a.events.delete(i.id),n=!0)}).data}),n===!1)for(let s of l_.list)this.rewriteActions(i.data.gameActions[s],["gameActions",s],e,t,r,i)}else i.data.type==="Conditional"?(i.data.condition.type==="Distance"?(this.relativeizeInner(i.data.condition.fromObject,["condition"],"fromObject",e,t,r,i),this.relativeizeInner(i.data.condition.toObject,["condition"],"toObject",e,t,r,i)):i.data.condition.type==="State"?this.relativeizeInner(i.data.condition.object,["condition"],"object",e,t,r,i):i.data.condition.type==="Comparison"&&(i.data.condition.lOperand.type==="Property"&&this.relativeizeInner(i.data.condition.lOperand.value[0],["condition","lOperand","value"],0,e,t,r,i),i.data.condition.rOperand.type==="Property"&&this.relativeizeInner(i.data.condition.rOperand.value[0],["condition","rOperand","value"],0,e,t,r,i)),this.rewriteActions(i.data.inActions,["inActions"],e,t,r,i),this.rewriteActions(i.data.outActions,["outActions"],e,t,r,i)):"actions"in i.data&&this.rewriteActions(i.data.actions,["actions"],e,t,r,i)})}),!0})}expandInstances(e,t,r){let i=new Set;this.traverseEntity(n=>{if(n instanceof Pu&&n.isInstanceRoot)return n.expandInstanceChildren({scene:this,shared:e,pendingDeletes:i}),t||n.resetBBoxNeedsUpdate(),r&&n.traverseEntity(s=>{r.addClip(s)}),!0});for(let n of i)this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(n),zA(n)}recomputeInstances(e,t){this.needsRecomputeInstances&&(this.needsRecomputeInstances=!1,this.traverseEntity(r=>{r instanceof Pu&&r.isInstanceRoot&&(r.component=void 0)}),this.expandInstances(e,!1,t))}disposeAndUnregisterEntityRecursivelyIfNotReregistered(e){e.traverseEntity(t=>{let r=typeof t.identity=="string"?t.identity:t.identity.join("-");this.entityIdentityToEntity[r]===t&&(delete this.entityByUuid[t.uuid],delete this.entityIdentityToEntity[r]),t.dispose()})}clearScene(){for(let e of this.children)Mt.is(e)&&e.disposeRecursively();this.children.length=0}resetAfterClear(e,t){this.init(e,t)}raycast(e){return this.raycast1(e,!1)}raycast1(e,t){let r=[],i=n=>{for(let s of n.children){let a=s.cloner;if(Mt.is(s)&&!s.raycastLock&&(s.visible||a!=null&&a.object.data.visible))if(t===!0&&s.isInstanceRoot){let o=[];if(e.intersectObject(s,!0,o),o.length){let l=o[0];l.object=s,l.point.applyMatrix4(l.object.matrixWorld);let c=s.matrixWorld.clone().invert();l.point.applyMatrix4(c),r.push(l)}}else(ws(s)||E_(s)&&this.enableHelpers&&s.objectHelper.visible)&&(e.intersectObject(s,!1,r),R_(s,e,r)),i(s)}};return i(this),r}raycastWithClones(e){let t=[],r=i=>{for(let n of i.children){let s=n.cloner;Mt.is(n)&&(n.visible||s!=null&&s.object.data.visible)&&((ws(n)||E_(n)&&this.enableHelpers&&n.objectHelper.visible)&&(e.intersectObject(n,!1,t),R_(n,e,t,!0)),r(n))}};return r(this),t}forEachEntity(e){for(let t of this.children)Mt.is(t)&&e(t)}traverseConcreteEntity(e){for(let t of this.children)Mt.is(t)&&t.isConcreteEntity&&t.traverseEntity(e)}traverseEntity(e){for(let t of this.children)Mt.is(t)&&t.traverseEntity(e)}updateFont(e,t){this.traverseEntity(r=>{if(r instanceof zi&&r.data.type==="Mesh"&&r.data.geometry.type==="TextGeometry"&&r.data.geometry.font===e){let i=r.geometry,n=r.data.geometry;i.updateFont(e,t).then(()=>{i.update(n);let s=r.invalidateDownstreamBooleanData();na(s)&&s.recomputeBoolean()})}})}traverseObject(e){for(let t of this.children)Qf.is(t)&&t.traverseObject(e)}traverseVisibleEntity(e){for(let t of this.children)Mt.is(t)&&t.visible&&t.traverseVisibleEntity(e)}dispose(){this.clearScene()}createChildrenObjects(e,t,r){let i=0;for(let n of e)this.createObject(n.id,n.data,n.children,t,i,r),i+=1}registerObjectCreatedInLegacy(e){this.entityByUuid[e.uuid]=e}unregisterObject(e){delete this.entityByUuid[e.uuid];for(let t of e.children)this.unregisterObject(t)}createObject(e,t,r,i,n,s){var l;let a={scene:this,shared:s},o=kA(e,t,a);return o&&(this.entityByUuid[e]=o,i.add(o),i.children.splice(n,0,i.children.pop()),r.length>0&&(o.isInstanceRoot?console.error("instance should not have children!"):this.createChildrenObjects(r,o,s)),o.updateState(t,a),o instanceof zi&&o.updateGeometryGroupsIfNeeded(),o.updateVisible(),o.cloner&&this.toExpandCloner.add(o),(l=t.pathSnapping)!=null&&l.pathId&&this.pathConstraints.setConstraint(e,t.pathSnapping.pathId)),t.type==="Empty"&&t.animations&&o.traverseEntity(c=>{if(c instanceof zi&&c.isSkinnedMesh){let u=c.dataPatched;if(u.bones&&u.boneInverses){let h=u.bones.map(f=>this.find(f)),d=u.boneInverses.map(f=>new _e().fromArray(f)),p=new T3(h,d);c.bind(p,c.bindMatrix)}}else c.matrixAutoUpdate=!0}),o}getCenter(e){let t=[];for(let i=0,n=e.length;i<n;++i){let{id:s,recursive:a}=e[i],o=this.find(s),l=a?o.recursiveBBox:o.singleBBox;t.push(...l.vertices)}let r=new Ar;return r.setFromPoints(t),r.getCenter(l5),l5}copyMatrixWorld(e,t){if(e===null){t.identity();return}let r=this.find(e);r?t.copy(r.matrixWorld):t.identity()}copyParentMatrixWorld(e,t){var i;if(e===null){t.identity();return}let r=(i=this.find(e))==null?void 0:i.parent;r?t.copy(r.matrixWorld):t.identity()}traverseMaterial(e){this.traverseEntity(t=>{if(t instanceof an)if(Array.isArray(t.material))for(let r=0;r<t.material.length;r++)t.material[r]instanceof Cl&&e(t.material[r]);else t.material instanceof Cl&&e(t.material)})}updateViewPlaneSize(e,t,r=!1){this.traverseConcreteEntity(i=>{i instanceof bi&&i.setViewplaneSize(e,t,r)})}},Ov=(e,t)=>{let r=t.x-e.x,i=t.y-e.y;return Math.sqrt(r*r+i*i)},Gpe=(e,t)=>{let r=t.x-e.x,i=t.y-e.y;return qpe(Math.atan2(i,r))},Wpe=(e,t,r)=>{let i={x:0,y:0};return r=z_(r),i.x=e.x-t*Math.cos(r),i.y=e.y-t*Math.sin(r),i},z_=e=>e*(Math.PI/180),qpe=e=>e*(180/Math.PI),Xpe=e=>isNaN(e.buttons)?e.pressure!==0:e.buttons!==0,Tw=new Map,c5=e=>{Tw.has(e)&&clearTimeout(Tw.get(e)),Tw.set(e,setTimeout(e,100))},oy=(e,t,r)=>{let i=t.split(/[ ,]+/g),n;for(let s=0;s<i.length;s+=1)n=i[s],e.addEventListener?e.addEventListener(n,r,!1):e.attachEvent&&e.attachEvent(n,r)},h5=(e,t,r)=>{let i=t.split(/[ ,]+/g),n;for(let s=0;s<i.length;s+=1)n=i[s],e.removeEventListener?e.removeEventListener(n,r):e.detachEvent&&e.detachEvent(n,r)},zk=e=>(e.preventDefault(),e.type.match(/^touch/)?e.changedTouches:e),u5=()=>{if(typeof window>"u")return;let e=window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,t=window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;return{x:e,y:t}},k_=(e,t)=>{t.top||t.right||t.bottom||t.left?(e.style.top=t.top,e.style.right=t.right,e.style.bottom=t.bottom,e.style.left=t.left):(e.style.left=t.x+"px",e.style.top=t.y+"px")},FA=(e,t,r)=>{let i=kk(e);for(let n in i)if(i.hasOwnProperty(n))if(typeof t=="string")i[n]=t+" "+r;else{let s="";for(let a=0,o=t.length;a<o;a+=1)s+=t[a]+" "+r+", ";i[n]=s.slice(0,-2)}return i},Ype=(e,t)=>{let r=kk(e);for(let i in r)r.hasOwnProperty(i)&&(r[i]=t);return r},kk=e=>{let t={};return t[e]="",["webkit","Moz","o"].forEach(function(r){t[r+e.charAt(0).toUpperCase()+e.slice(1)]=""}),t},Pw=(e,t)=>{for(let r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e},Qpe=(e,t)=>{let r={};for(let i in e)e.hasOwnProperty(i)&&t.hasOwnProperty(i)?r[i]=t[i]:e.hasOwnProperty(i)&&(r[i]=e[i]);return r},N_=(e,t)=>{if(e.length)for(let r=0,i=e.length;r<i;r+=1)t(e[r]);else t(e)},Kpe=(e,t,r)=>({x:Math.min(Math.max(e.x,t.x-r),t.x+r),y:Math.min(Math.max(e.y,t.y-r),t.y+r)});typeof window<"u"&&(Nk="ontouchstart"in window,Fk=!!window.PointerEvent,Uk=!!window.MSPointerEvent);var Nk,Fk,Uk,dp={touch:{start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},mouse:{start:"mousedown",move:"mousemove",end:"mouseup"},pointer:{start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"},MSPointer:{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}},au,$f={};Fk?au=dp.pointer:Uk?au=dp.MSPointer:Nk?(au=dp.touch,$f=dp.mouse):au=dp.mouse;function Yc(){}Yc.prototype.on=function(e,t){var r=this,i=e.split(/[ ,]+/g),n;r._handlers_=r._handlers_||{};for(var s=0;s<i.length;s+=1)n=i[s],r._handlers_[n]=r._handlers_[n]||[],r._handlers_[n].push(t);return r};Yc.prototype.off=function(e,t){var r=this;return r._handlers_=r._handlers_||{},e===void 0?r._handlers_={}:t===void 0?r._handlers_[e]=null:r._handlers_[e]&&r._handlers_[e].indexOf(t)>=0&&r._handlers_[e].splice(r._handlers_[e].indexOf(t),1),r};Yc.prototype.trigger=function(e,t){var r=this,i=e.split(/[ ,]+/g),n;r._handlers_=r._handlers_||{};for(var s=0;s<i.length;s+=1)n=i[s],r._handlers_[n]&&r._handlers_[n].length&&r._handlers_[n].forEach(function(a){a.call(r,{type:n,target:r},t)})};Yc.prototype.config=function(e){var t=this;t.options=t.defaults||{},e&&(t.options=Qpe(t.options,e))};Yc.prototype.bindEvt=function(e,t){var r=this;return r._domHandlers_=r._domHandlers_||{},r._domHandlers_[t]=function(){typeof r["on"+t]=="function"?r["on"+t].apply(r,arguments):console.warn('[WARNING] : Missing "on'+t+'" handler.')},oy(e,au[t],r._domHandlers_[t]),$f[t]&&oy(e,$f[t],r._domHandlers_[t]),r};Yc.prototype.unbindEvt=function(e,t){var r=this;return r._domHandlers_=r._domHandlers_||{},h5(e,au[t],r._domHandlers_[t]),$f[t]&&h5(e,$f[t],r._domHandlers_[t]),delete r._domHandlers_[t],this};var UA=Yc;function Wr(e,t){return this.identifier=t.identifier,this.position=t.position,this.frontPosition=t.frontPosition,this.collection=e,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:1,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(t),this.options.mode==="dynamic"&&(this.options.restOpacity=0),this.id=Wr.id,Wr.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}Wr.prototype=new UA;Wr.constructor=Wr;Wr.id=0;Wr.prototype.buildEl=function(e){return this.ui={},this.options.dataOnly?this:(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front),this)};Wr.prototype.stylize=function(){if(this.options.dataOnly)return this;var e=this.options.fadeTime+"ms",t=Ype("borderRadius","50%"),r=FA("transition","opacity",e),i={};return i.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},i.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:"rgba(255, 255, 255, .4)",border:"solid 2px rgba(0, 0, 0, .1)"},i.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:"rgba(255, 255, 255, .8)",border:"solid 2px rgba(0, 0, 0, .1)"},Pw(i.el,r),this.options.shape==="circle"&&Pw(i.back,t),Pw(i.front,t),this.applyStyles(i),this};Wr.prototype.applyStyles=function(e){for(var t in this.ui)if(this.ui.hasOwnProperty(t))for(var r in e[t])this.ui[t].style[r]=e[t][r];return this};Wr.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)?this:(this.options.zone.appendChild(this.ui.el),this)};Wr.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)?this:(this.options.zone.removeChild(this.ui.el),this)};Wr.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()};Wr.prototype.show=function(e){var t=this;return t.options.dataOnly||(clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.addToDom(),t.restCallback(),setTimeout(function(){t.ui.el.style.opacity=1},0),t.showTimeout=setTimeout(function(){t.trigger("shown",t.instance),typeof e=="function"&&e.call(this)},t.options.fadeTime)),t};Wr.prototype.hide=function(e){var t=this;if(t.options.dataOnly)return t;if(t.ui.el.style.opacity=t.options.restOpacity,clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.removeTimeout=setTimeout(function(){var r=t.options.mode==="dynamic"?"none":"block";t.ui.el.style.display=r,typeof e=="function"&&e.call(t),t.trigger("hidden",t.instance)},t.options.fadeTime),t.options.restJoystick){let r=t.options.restJoystick,i={};i.x=r===!0||r.x!==!1?0:t.instance.frontPosition.x,i.y=r===!0||r.y!==!1?0:t.instance.frontPosition.y,t.setPosition(e,i)}return t};Wr.prototype.setPosition=function(e,t){var r=this;r.frontPosition={x:t.x,y:t.y};var i=r.options.fadeTime+"ms",n={};n.front=FA("transition",["top","left"],i);var s={front:{}};s.front={left:r.frontPosition.x+"px",top:r.frontPosition.y+"px"},r.applyStyles(n),r.applyStyles(s),r.restTimeout=setTimeout(function(){typeof e=="function"&&e.call(r),r.restCallback()},r.options.fadeTime)};Wr.prototype.restCallback=function(){var e=this,t={};t.front=FA("transition","none",""),e.applyStyles(t),e.trigger("rested",e.instance)};Wr.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}};Wr.prototype.computeDirection=function(e){var t=e.angle.radian,r=Math.PI/4,i=Math.PI/2,n,s,a;if(t>r&&t<r*3&&!e.lockX?n="up":t>-r&&t<=r&&!e.lockY?n="left":t>-r*3&&t<=-r&&!e.lockX?n="down":e.lockY||(n="right"),e.lockY||(t>-i&&t<i?s="left":s="right"),e.lockX||(t>0?a="up":a="down"),e.force>this.options.threshold){var o={},l;for(l in this.direction)this.direction.hasOwnProperty(l)&&(o[l]=this.direction[l]);var c={};this.direction={x:s,y:a,angle:n},e.direction=this.direction;for(l in o)o[l]===this.direction[l]&&(c[l]=!0);if(c.x&&c.y&&c.angle)return e;(!c.x||!c.y)&&this.trigger("plain",e),c.x||this.trigger("plain:"+s,e),c.y||this.trigger("plain:"+a,e),c.angle||this.trigger("dir dir:"+n,e)}else this.resetDirection();return e};var Zpe=Wr;function Sr(e,t){var r=this;r.nipples=[],r.idles=[],r.actives=[],r.ids=[],r.pressureIntervals={},r.manager=e,r.id=Sr.id,Sr.id+=1,r.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:1,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},r.config(t),(r.options.mode==="static"||r.options.mode==="semi")&&(r.options.multitouch=!1),r.options.multitouch||(r.options.maxNumberOfNipples=1);let i=getComputedStyle(r.options.zone.parentElement);return i&&i.display==="flex"&&(r.parentIsFlex=!0),r.updateBox(),r.prepareNipples(),r.bindings(),r.begin(),r.nipples}Sr.prototype=new UA;Sr.constructor=Sr;Sr.id=0;Sr.prototype.prepareNipples=function(){var e=this,t=e.nipples;t.on=e.on.bind(e),t.off=e.off.bind(e),t.options=e.options,t.destroy=e.destroy.bind(e),t.ids=e.ids,t.id=e.id,t.processOnMove=e.processOnMove.bind(e),t.processOnEnd=e.processOnEnd.bind(e),t.get=function(r){if(r===void 0)return t[0];for(var i=0,n=t.length;i<n;i+=1)if(t[i].identifier===r)return t[i];return!1}};Sr.prototype.bindings=function(){var e=this;e.bindEvt(e.options.zone,"start"),e.options.zone.style.touchAction="none",e.options.zone.style.msTouchAction="none"};Sr.prototype.begin=function(){var e=this,t=e.options;if(t.mode==="static"){var r=e.createNipple(t.position,e.manager.getIdentifier());r.add(),e.idles.push(r)}};Sr.prototype.createNipple=function(e,t){var r=this,i=r.manager.scroll,n={},s=r.options,a={x:r.parentIsFlex?i.x:i.x+r.box.left,y:r.parentIsFlex?i.y:i.y+r.box.top};if(e.x&&e.y)n={x:e.x-a.x,y:e.y-a.y};else if(e.top||e.right||e.bottom||e.left){var o=document.createElement("DIV");o.style.display="hidden",o.style.top=e.top,o.style.right=e.right,o.style.bottom=e.bottom,o.style.left=e.left,o.style.position="absolute",s.zone.appendChild(o);var l=o.getBoundingClientRect();s.zone.removeChild(o),n=e,e={x:l.left+i.x,y:l.top+i.y}}var c=new Zpe(r,{color:s.color,size:s.size,threshold:s.threshold,fadeTime:s.fadeTime,dataOnly:s.dataOnly,restJoystick:s.restJoystick,restOpacity:s.restOpacity,mode:s.mode,identifier:t,position:e,zone:s.zone,frontPosition:{x:0,y:0},shape:s.shape});return s.dataOnly||(k_(c.ui.el,n),k_(c.ui.front,c.frontPosition)),r.nipples.push(c),r.trigger("added "+c.identifier+":added",c),r.manager.trigger("added "+c.identifier+":added",c),r.bindNipple(c),c};Sr.prototype.updateBox=function(){var e=this;e.box=e.options.zone.getBoundingClientRect()};Sr.prototype.bindNipple=function(e){var t=this,r,i=function(n,s){r=n.type+" "+s.id+":"+n.type,t.trigger(r,s)};e.on("destroyed",t.onDestroyed.bind(t)),e.on("shown hidden rested dir plain",i),e.on("dir:up dir:right dir:down dir:left",i),e.on("plain:up plain:right plain:down plain:left",i)};Sr.prototype.pressureFn=function(e,t,r){var i=this,n=0;clearInterval(i.pressureIntervals[r]),i.pressureIntervals[r]=setInterval((function(){var s=e.force||e.pressure||e.webkitForce||0;s!==n&&(t.trigger("pressure",s),i.trigger("pressure "+t.identifier+":pressure",s),n=s)}).bind(i),100)};Sr.prototype.onstart=function(e){var t=this,r=t.options,i=e;e=zk(e),t.updateBox();var n=function(s){t.actives.length<r.maxNumberOfNipples?t.processOnStart(s):i.type.match(/^touch/)&&(Object.keys(t.manager.ids).forEach(function(a){if(Object.values(i.touches).findIndex(function(l){return l.identifier===a})<0){var o=[e[0]];o.identifier=a,t.processOnEnd(o)}}),t.actives.length<r.maxNumberOfNipples&&t.processOnStart(s))};return N_(e,n),t.manager.bindDocument(),!1};Sr.prototype.processOnStart=function(e){var t=this,r=t.options,i,n=t.manager.getIdentifier(e),s=e.force||e.pressure||e.webkitForce||0,a={x:e.pageX,y:e.pageY},o=t.getOrCreate(n,a);o.identifier!==n&&t.manager.removeIdentifier(o.identifier),o.identifier=n;var l=function(u){u.trigger("start",u),t.trigger("start "+u.id+":start",u),u.show(),s>0&&t.pressureFn(e,u,u.identifier),t.processOnMove(e)};if((i=t.idles.indexOf(o))>=0&&t.idles.splice(i,1),t.actives.push(o),t.ids.push(o.identifier),r.mode!=="semi")l(o);else{var c=Ov(a,o.position);if(c<=r.catchDistance)l(o);else{o.destroy(),t.processOnStart(e);return}}return o};Sr.prototype.getOrCreate=function(e,t){var r=this,i=r.options,n;return/(semi|static)/.test(i.mode)?(n=r.idles[0],n?(r.idles.splice(0,1),n):i.mode==="semi"?r.createNipple(t,e):(console.warn("Coudln't find the needed nipple."),!1)):(n=r.createNipple(t,e),n)};Sr.prototype.processOnMove=function(e){var t=this,r=t.options,i=t.manager.getIdentifier(e),n=t.nipples.get(i),s=t.manager.scroll;if(!Xpe(e)){this.processOnEnd(e);return}if(!n){console.error("Found zombie joystick with ID "+i),t.manager.removeIdentifier(i);return}if(r.dynamicPage){var a=n.el.getBoundingClientRect();n.position={x:s.x+a.left,y:s.y+a.top}}n.identifier=i;var o=n.options.size/2,l={x:e.pageX,y:e.pageY};r.lockX&&(l.y=n.position.y),r.lockY&&(l.x=n.position.x);var c=Ov(l,n.position),u=Gpe(l,n.position),h=z_(u),d=c/o,p={distance:c,position:l},f,m;if(n.options.shape==="circle"?(f=Math.min(c,o),m=Wpe(n.position,f,u)):(m=Kpe(l,n.position,o),f=Ov(m,n.position)),r.follow){if(c>o){let x=l.x-m.x,w=l.y-m.y;n.position.x+=x,n.position.y+=w,n.el.style.top=n.position.y-(t.box.top+s.y)+"px",n.el.style.left=n.position.x-(t.box.left+s.x)+"px",c=Ov(l,n.position)}}else l=m,c=f;var g=l.x-n.position.x,v=l.y-n.position.y;n.frontPosition={x:g,y:v},r.dataOnly||k_(n.ui.front,n.frontPosition);var y={identifier:n.identifier,position:l,force:d,pressure:e.force||e.pressure||e.webkitForce||0,distance:c,angle:{radian:h,degree:u},vector:{x:g/o,y:-v/o},raw:p,instance:n,lockX:r.lockX,lockY:r.lockY};y=n.computeDirection(y),y.angle={radian:z_(180-u),degree:180-u},n.trigger("move",y),t.trigger("move "+n.id+":move",y)};Sr.prototype.processOnEnd=function(e){var t=this,r=t.options,i=t.manager.getIdentifier(e),n=t.nipples.get(i),s=t.manager.removeIdentifier(n.identifier);!n||(r.dataOnly||n.hide(function(){r.mode==="dynamic"&&(n.trigger("removed",n),t.trigger("removed "+n.id+":removed",n),t.manager.trigger("removed "+n.id+":removed",n),n.destroy())}),clearInterval(t.pressureIntervals[n.identifier]),n.resetDirection(),n.trigger("end",n),t.trigger("end "+n.id+":end",n),t.ids.indexOf(n.identifier)>=0&&t.ids.splice(t.ids.indexOf(n.identifier),1),t.actives.indexOf(n)>=0&&t.actives.splice(t.actives.indexOf(n),1),/(semi|static)/.test(r.mode)?t.idles.push(n):t.nipples.indexOf(n)>=0&&t.nipples.splice(t.nipples.indexOf(n),1),t.manager.unbindDocument(),/(semi|static)/.test(r.mode)&&(t.manager.ids[s.id]=s.identifier))};Sr.prototype.onDestroyed=function(e,t){var r=this;r.nipples.indexOf(t)>=0&&r.nipples.splice(r.nipples.indexOf(t),1),r.actives.indexOf(t)>=0&&r.actives.splice(r.actives.indexOf(t),1),r.idles.indexOf(t)>=0&&r.idles.splice(r.idles.indexOf(t),1),r.ids.indexOf(t.identifier)>=0&&r.ids.splice(r.ids.indexOf(t.identifier),1),r.manager.removeIdentifier(t.identifier),r.manager.unbindDocument()};Sr.prototype.destroy=function(){var e=this;e.unbindEvt(e.options.zone,"start"),e.nipples.forEach(function(r){r.destroy()});for(var t in e.pressureIntervals)e.pressureIntervals.hasOwnProperty(t)&&clearInterval(e.pressureIntervals[t]);e.trigger("destroyed",e.nipples),e.manager.unbindDocument(),e.off()};var $pe=Sr;function ri(e){var t=this;t.ids={},t.index=0,t.collections=[],t.scroll=u5(),t.config(e),t.prepareCollections();var r=function(){var n;t.collections.forEach(function(s){s.forEach(function(a){n=a.el.getBoundingClientRect(),a.position={x:t.scroll.x+n.left,y:t.scroll.y+n.top}})})};if(typeof window>"u")return t.collections;oy(window,"resize",function(){c5(r)});var i=function(){t.scroll=u5()};return oy(window,"scroll",function(){c5(i)}),t.collections}ri.prototype=new UA;ri.constructor=ri;ri.prototype.prepareCollections=function(){var e=this;e.collections.create=e.create.bind(e),e.collections.on=e.on.bind(e),e.collections.off=e.off.bind(e),e.collections.destroy=e.destroy.bind(e),e.collections.get=function(t){var r;return e.collections.every(function(i){return r=i.get(t),!r}),r}};ri.prototype.create=function(e){return this.createCollection(e)};ri.prototype.createCollection=function(e){var t=this,r=new $pe(t,e);return t.bindCollection(r),t.collections.push(r),r};ri.prototype.bindCollection=function(e){var t=this,r,i=function(n,s){r=n.type+" "+s.id+":"+n.type,t.trigger(r,s)};e.on("destroyed",t.onDestroyed.bind(t)),e.on("shown hidden rested dir plain",i),e.on("dir:up dir:right dir:down dir:left",i),e.on("plain:up plain:right plain:down plain:left",i)};ri.prototype.bindDocument=function(){var e=this;e.binded||(e.bindEvt(document,"move").bindEvt(document,"end"),e.binded=!0)};ri.prototype.unbindDocument=function(e){var t=this;(!Object.keys(t.ids).length||e===!0)&&(t.unbindEvt(document,"move").unbindEvt(document,"end"),t.binded=!1)};ri.prototype.getIdentifier=function(e){var t;return e?(t=e.identifier===void 0?e.pointerId:e.identifier,t===void 0&&(t=this.latest||0)):t=this.index,this.ids[t]===void 0&&(this.ids[t]=this.index,this.index+=1),this.latest=t,this.ids[t]};ri.prototype.removeIdentifier=function(e){var t={};for(var r in this.ids)if(this.ids[r]===e){t.id=r,t.identifier=this.ids[r],delete this.ids[r];break}return t};ri.prototype.onmove=function(e){var t=this;return t.onAny("move",e),!1};ri.prototype.onend=function(e){var t=this;return t.onAny("end",e),!1};ri.prototype.oncancel=function(e){var t=this;return t.onAny("end",e),!1};ri.prototype.onAny=function(e,t){var r=this,i,n="processOn"+e.charAt(0).toUpperCase()+e.slice(1);t=zk(t);var s=function(o,l,c){c.ids.indexOf(l)>=0&&(c[n](o),o._found_=!0)},a=function(o){i=r.getIdentifier(o),N_(r.collections,s.bind(null,o,i)),o._found_||r.removeIdentifier(i)};return N_(t,a),!1};ri.prototype.destroy=function(){var e=this;e.unbindDocument(!0),e.ids={},e.index=0,e.collections.forEach(function(t){t.destroy()}),e.off()};ri.prototype.onDestroyed=function(e,t){var r=this;if(r.collections.indexOf(t)<0)return!1;r.collections.splice(r.collections.indexOf(t),1)};var Jpe=ri,d5=new Jpe,efe={create:function(e){return d5.create(e)},factory:d5},jk=new Map,sf=new Map,fc=class{constructor(e,t,r,i){this.data=t;let{audio:n,volume:s,delay:a,loop:o}=t;if(!n)throw new Error("Missing property");let l=typeof n=="string"?i.getAudio(n).src:n.data;this.audioPlayer=new Op({src:l,volume:s,delay:a,loop:o}),sf.has(r.uuid)?sf.get(r.uuid).push(this):sf.set(r.uuid,[this]),jk.set(e,this)}playByToggle(){this.data.toggle==="stop"?this.audioPlayer.status==="playing"?this.audioPlayer.stop():(this.audioPlayer.stop(),this.audioPlayer.play()):this.data.toggle==="pause"?this.audioPlayer.status==="playing"?this.audioPlayer.pause():this.audioPlayer.play():(this.audioPlayer.stop(),this.audioPlayer.play())}dispose(){this.audioPlayer.stop()}},F_=class{constructor(e){this.data=e}dispatch(){this.data.playAudio?this.pauseAudio(this.data.playAudio):this.data.object?this.pauseAllAudiosFromObject(this.data.object):this.pauseAllAudios()}pauseAudio(e){let t=jk.get(e);!t||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.audioPlayer[this.data.interaction](),this.disposeDelay()},this.data.delay)):t.audioPlayer[this.data.interaction]())}pauseAllAudiosFromObject(e){let t=sf.get(e);!(t!=null&&t.length)||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.forEach(r=>r.audioPlayer[this.data.interaction]()),this.disposeDelay()},this.data.delay)):t.forEach(r=>r.audioPlayer[this.data.interaction]()))}pauseAllAudios(){let e=[...sf.values()];!e.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{e.forEach(t=>{t.forEach(r=>{r.audioPlayer[this.data.interaction]()})}),this.disposeDelay()},this.data.delay)):e.forEach(t=>{t.forEach(r=>{r.audioPlayer[this.data.interaction]()})}))}disposeDelay(){clearTimeout(this.timeoutId),delete this.timeoutId}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},af=class{constructor(e,t,r,i){if(this.data=t,t.interaction==="play")this.interaction=new fc(e,t,r,i);else if(t.interaction==="pause"||t.interaction==="stop")this.interaction=new F_(t);else throw new Error("Missing property")}dispatchBasic(){this.interaction instanceof fc?this.interaction.playByToggle():this.interaction.dispatch()}dispatchConditional(){this.interaction instanceof fc?this.interaction.audioPlayer.play():this.interaction.dispatch()}dispatchGameControl(e){this.interaction instanceof fc&&(e==="start"?this.interaction.audioPlayer.play():this.interaction.audioPlayer.stop())}dispose(){this.interaction.dispose()}},tfe="text/plain",rfe="us-ascii",p5=(e,t)=>t.some(r=>r instanceof RegExp?r.test(e):r===e),ife=(e,{stripHash:t})=>{let r=/^data:(?<type>[^,]*?),(?<data>[^#]*?)(?:#(?<hash>.*))?$/.exec(e);if(!r)throw new Error(`Invalid URL: ${e}`);let{type:i,data:n,hash:s}=r.groups,a=i.split(";");s=t?"":s;let o=!1;a[a.length-1]==="base64"&&(a.pop(),o=!0);let l=(a.shift()||"").toLowerCase(),c=[...a.map(u=>{let[h,d=""]=u.split("=").map(p=>p.trim());return h==="charset"&&(d=d.toLowerCase(),d===rfe)?"":`${h}${d?`=${d}`:""}`}).filter(Boolean)];return o&&c.push("base64"),(c.length>0||l&&l!==tfe)&&c.unshift(l),`data:${c.join(";")},${o?n.trim():n}${s?`#${s}`:""}`};function nfe(e,t){if(t={defaultProtocol:"http:",normalizeProtocol:!0,forceHttp:!1,forceHttps:!1,stripAuthentication:!0,stripHash:!1,stripTextFragment:!0,stripWWW:!0,removeQueryParameters:[/^utm_\w+/i],removeTrailingSlash:!0,removeSingleSlash:!0,removeDirectoryIndex:!1,sortQueryParameters:!0,...t},e=e.trim(),/^data:/i.test(e))return ife(e,t);if(/^view-source:/i.test(e))throw new Error("`view-source:` is not supported as it is a non-standard protocol");let r=e.startsWith("//");!r&&/^\.*\//.test(e)||(e=e.replace(/^(?!(?:\w+:)?\/\/)|^\/\//,t.defaultProtocol));let i=new URL(e);if(t.forceHttp&&t.forceHttps)throw new Error("The `forceHttp` and `forceHttps` options cannot be used together");if(t.forceHttp&&i.protocol==="https:"&&(i.protocol="http:"),t.forceHttps&&i.protocol==="http:"&&(i.protocol="https:"),t.stripAuthentication&&(i.username="",i.password=""),t.stripHash?i.hash="":t.stripTextFragment&&(i.hash=i.hash.replace(/#?:~:text.*?$/i,"")),i.pathname){let s=/\b[a-z][a-z\d+\-.]{1,50}:\/\//g,a=0,o="";for(;;){let c=s.exec(i.pathname);if(!c)break;let u=c[0],h=c.index,d=i.pathname.slice(a,h);o+=d.replace(/\/{2,}/g,"/"),o+=u,a=h+u.length}let l=i.pathname.slice(a,i.pathname.length);o+=l.replace(/\/{2,}/g,"/"),i.pathname=o}if(i.pathname)try{i.pathname=decodeURI(i.pathname)}catch{}if(t.removeDirectoryIndex===!0&&(t.removeDirectoryIndex=[/^index\.[a-z]+$/]),Array.isArray(t.removeDirectoryIndex)&&t.removeDirectoryIndex.length>0){let s=i.pathname.split("/"),a=s[s.length-1];p5(a,t.removeDirectoryIndex)&&(s=s.slice(0,-1),i.pathname=s.slice(1).join("/")+"/")}if(i.hostname&&(i.hostname=i.hostname.replace(/\.$/,""),t.stripWWW&&/^www\.(?!www\.)[a-z\-\d]{1,63}\.[a-z.\-\d]{2,63}$/.test(i.hostname)&&(i.hostname=i.hostname.replace(/^www\./,""))),Array.isArray(t.removeQueryParameters))for(let s of[...i.searchParams.keys()])p5(s,t.removeQueryParameters)&&i.searchParams.delete(s);if(t.removeQueryParameters===!0&&(i.search=""),t.sortQueryParameters){i.searchParams.sort();try{i.search=decodeURIComponent(i.search)}catch{}}t.removeTrailingSlash&&(i.pathname=i.pathname.replace(/\/$/,""));let n=e;return e=i.toString(),!t.removeSingleSlash&&i.pathname==="/"&&!n.endsWith("/")&&i.hash===""&&(e=e.replace(/\/$/,"")),(t.removeTrailingSlash||i.pathname==="/")&&i.hash===""&&t.removeSingleSlash&&(e=e.replace(/\/$/,"")),r&&!t.normalizeProtocol&&(e=e.replace(/^http:\/\//,"//")),t.stripProtocol&&(e=e.replace(/^(?:https?:)?\/\//,"")),e}var sfe=class{constructor({url:e,context:t},r){if(this.eventManager=r,!e)throw new Error("Missing property");this.url=e.startsWith("mailto:")?e:nfe(e,{removeTrailingSlash:!1,removeSingleSlash:!1}),this.context=t??"tab"}dispatch(){var e;EB?window.location.assign(this.url):(this.context==="tab"?window.open(this.url,"_blank"):this.context==="window"?window.open(this.url,"_blank",`width=${window.innerWidth}, height=${window.innerHeight}`):window.open(this.url,"_parent"),(e=this.eventManager.controlsManager.orbitControls)==null||e.onPointerUp(et[0]),mae())}},Vk=class{constructor(e,t,r){this.data=e,this.page=t,this.eventManager=r,this.timeoutIdQueue=[],this.dispatchInner=()=>{this.objects.forEach(this.destroyCallback)},this.destroyCallback=i=>{var o,l;this.timeoutIdQueue.shift();let n=this.page.scene.find(i);if(n===void 0)return;let s=this.controlsManager.sharedGameControlGlobals.rapierWorld,a=s?(o=n.dataPatched.physics)==null?void 0:o.fusedBody:!0;if(n.cloner){for(let c of n.cloner.children)a?(c.playModeVisible=!1,c.rigidBody&&((l=n.dataPatched.physics)==null?void 0:l.rigidBody)==="positioned"&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(c.rigidBody.collider(0).handle),s.removeRigidBody(c.rigidBody),c.rigidBody=void 0),c.bvhGeometry&&(c.bvhGeometry=void 0)):this.clone===void 0||this.clone===c?(c.playModeVisible=!1,c.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(c.rigidBody.collider(0).handle),s.removeRigidBody(c.rigidBody),c.rigidBody=void 0)):c.playModeVisible===void 0&&(c.playModeVisible=!0);(a||this.clone===void 0||this.clone===!1)&&(n.visible=!1,n.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(n.rigidBody.collider(0).handle),s.removeRigidBody(n.rigidBody),n.rigidBody=void 0),n.bvhGeometry&&(n.bvhGeometry=void 0))}else n.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(n.rigidBody.collider(0).handle),s.removeRigidBody(n.rigidBody),n.rigidBody=void 0),n.bvhGeometry&&(n.bvhGeometry=void 0),n.visible=!1;s===void 0?this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim=this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.filter(c=>c.bvhGeometry!==void 0):this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim=this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.filter(c=>c.rigidBody!==void 0),this.eventManager.requestRender()},this.objects=[...e.objects],this.controlsManager=r.controlsManager}dispatch(e){this.clone=e,this.data.delay?this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3)):this.dispatchInner()}dispatchFromStart(){this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3))}dispose(){this.timeoutIdQueue.forEach(e=>window.clearTimeout(e))}},Hk=class{constructor(e,t,r,i){this.data=e,this.page=t,this.eventManager=i,this.sharedAssets=r}dispatch(){clearTimeout(this.timeoutId),delete this.timeoutId,this.timeoutId=window.setTimeout(()=>{var e;KA(this.page,this.sharedAssets,!0),this.eventManager.reset(),(e=this.eventManager.controlsManager.gameControl)==null||e.reset(!0),this.page.switchToPlayCamera(),this.eventManager.controlsManager.requestRender(),delete this.timeoutId},(this.data.delay??0)*1e3)}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},Gk={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,timelineChangeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0,rewind:!0},jA={duration:1e3,delay:0,endDelay:0,startOnceDelay:0,pingPongDelayCorrection:0,pingPongEndDelayCorrection:0,easing:"easeOutElastic(1, .5)",round:0},afe=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective","matrix","matrix3d"],ly={CSS:{},springs:{}};function Cs(e,t,r){return Math.min(Math.max(e,t),r)}function of(e,t){return e.indexOf(t)>-1}function Dw(e,t){return e.apply(null,t)}var rt={arr:function(e){return Array.isArray(e)},obj:function(e){return of(Object.prototype.toString.call(e),"Object")},pth:function(e){return rt.obj(e)&&e.hasOwnProperty("totalLength")},svg:function(e){return e instanceof SVGElement},inp:function(e){return e instanceof HTMLInputElement},dom:function(e){return!("isNode"in e)&&(e.nodeType||rt.svg(e))},str:function(e){return typeof e=="string"},fnc:function(e){return typeof e=="function"},und:function(e){return typeof e>"u"},hex:function(e){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e)},rgb:function(e){return/^rgb/.test(e)},hsl:function(e){return/^hsl/.test(e)},col:function(e){return rt.hex(e)||rt.rgb(e)||rt.hsl(e)},key:function(e){return!Gk.hasOwnProperty(e)&&!jA.hasOwnProperty(e)&&e!=="targets"&&e!=="keyframes"}};function Wk(e){var t=/\(([^)]+)\)/.exec(e);return t?t[1].split(",").map(function(r){return parseFloat(r)}):[]}function qk(e,t){var r=Wk(e),i=Cs(rt.und(r[0])?1:r[0],.1,100),n=Cs(rt.und(r[1])?100:r[1],.1,100),s=Cs(rt.und(r[2])?10:r[2],.1,100),a=Cs(rt.und(r[3])?0:r[3],.1,100),o=Math.sqrt(n/i),l=s/(2*Math.sqrt(n*i)),c=l<1?o*Math.sqrt(1-l*l):0,u=1,h=l<1?(l*o+-a)/c:-a+o;function d(f){var m=t?t*f/1e3:f;return l<1?m=Math.exp(-m*l*o)*(u*Math.cos(c*m)+h*Math.sin(c*m)):m=(u+h*m)*Math.exp(-m*o),f===0||f===1?f:1-m}function p(){var f=ly.springs[e];if(f)return f;for(var m=1/6,g=0,v=0;;)if(g+=m,d(g)===1){if(v++,v>=16)break}else v=0;var y=g*m*1e3;return ly.springs[e]=y,y}return t?d:p}function ofe(e){return e===void 0&&(e=10),function(t){return Math.ceil(Cs(t,1e-6,1)*e)*(1/e)}}var lfe=function(){var e=11,t=1/(e-1);function r(u,h){return 1-3*h+3*u}function i(u,h){return 3*h-6*u}function n(u){return 3*u}function s(u,h,d){return((r(h,d)*u+i(h,d))*u+n(h))*u}function a(u,h,d){return 3*r(h,d)*u*u+2*i(h,d)*u+n(h)}function o(u,h,d,p,f){var m,g,v=0;do g=h+(d-h)/2,m=s(g,p,f)-u,m>0?d=g:h=g;while(Math.abs(m)>1e-7&&++v<10);return g}function l(u,h,d,p){for(var f=0;f<4;++f){var m=a(h,d,p);if(m===0)return h;var g=s(h,d,p)-u;h-=g/m}return h}function c(u,h,d,p){if(!(0<=u&&u<=1&&0<=d&&d<=1))return;var f=new Float32Array(e);if(u!==h||d!==p)for(var m=0;m<e;++m)f[m]=s(m*t,u,d);function g(v){for(var y=0,x=1,w=e-1;x!==w&&f[x]<=v;++x)y+=t;--x;var b=(v-f[x])/(f[x+1]-f[x]),_=y+b*t,A=a(_,u,d);return A>=.001?l(v,_,u,d):A===0?_:o(v,y,y+t,u,d)}return function(v){return u===h&&d===p||v===0||v===1?v:s(g(v),h,p)}}return c}(),Xk=function(){var e={linear:function(){return function(i){return i}}},t={Sine:function(){return function(i){return 1-Math.cos(i*Math.PI/2)}},Circ:function(){return function(i){return 1-Math.sqrt(1-i*i)}},Back:function(){return function(i){return i*i*(3*i-2)}},Bounce:function(){return function(i){for(var n,s=4;i<((n=Math.pow(2,--s))-1)/11;);return 1/Math.pow(4,3-s)-7.5625*Math.pow((n*3-2)/22-i,2)}},Elastic:function(i,n){i===void 0&&(i=1),n===void 0&&(n=.5);var s=Cs(i,1,10),a=Cs(n,.1,2);return function(o){return o===0||o===1?o:-s*Math.pow(2,10*(o-1))*Math.sin((o-1-a/(Math.PI*2)*Math.asin(1/s))*(Math.PI*2)/a)}}},r=["Quad","Cubic","Quart","Quint","Expo"];return r.forEach(function(i,n){t[i]=function(){return function(s){return Math.pow(s,n+2)}}}),Object.keys(t).forEach(function(i){var n=t[i];e["easeIn"+i]=n,e["easeOut"+i]=function(s,a){return function(o){return 1-n(s,a)(1-o)}},e["easeInOut"+i]=function(s,a){return function(o){return o<.5?n(s,a)(o*2)/2:1-n(s,a)(o*-2+2)/2}}}),e}();function VA(e,t){if(rt.fnc(e))return e;var r=e.split("(")[0],i=Xk[r],n=Wk(e);switch(r){case"spring":return qk(e,t);case"cubicBezier":return Dw(lfe,n);case"steps":return Dw(ofe,n);default:return Dw(i,n)}}function Yk(e){try{var t=document.querySelectorAll(e);return t}catch{return}}function a1(e,t){for(var r=e.length,i=arguments.length>=2?arguments[1]:void 0,n=[],s=0;s<r;s++)if(s in e){var a=e[s];t.call(i,a,s,e)&&n.push(a)}return n}function o1(e){return e.reduce(function(t,r){return t.concat(rt.arr(r)?o1(r):r)},[])}function f5(e){return rt.arr(e)?e:(rt.str(e)&&(e=Yk(e)||e),e instanceof NodeList||e instanceof HTMLCollection?[].slice.call(e):[e])}function HA(e,t){return e.some(function(r){return r===t})}function GA(e){var t={};for(var r in e)t[r]=e[r];return t}function U_(e,t){var r=GA(e);for(var i in e)r[i]=t.hasOwnProperty(i)?t[i]:e[i];return r}function l1(e,t){var r=GA(e);for(var i in t)r[i]=rt.und(e[i])?t[i]:e[i];return r}function cfe(e){var t=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(e);return t?"rgba("+t[1]+",1)":e}function hfe(e){var t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,r=e.replace(t,function(o,l,c,u){return l+l+c+c+u+u}),i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(r),n=parseInt(i[1],16),s=parseInt(i[2],16),a=parseInt(i[3],16);return"rgba("+n+","+s+","+a+",1)"}function ufe(e){var t=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(e)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(e),r=parseInt(t[1],10)/360,i=parseInt(t[2],10)/100,n=parseInt(t[3],10)/100,s=t[4]||1;function a(d,p,f){return f<0&&(f+=1),f>1&&(f-=1),f<1/6?d+(p-d)*6*f:f<1/2?p:f<2/3?d+(p-d)*(2/3-f)*6:d}var o,l,c;if(i==0)o=l=c=n;else{var u=n<.5?n*(1+i):n+i-n*i,h=2*n-u;o=a(h,u,r+1/3),l=a(h,u,r),c=a(h,u,r-1/3)}return"rgba("+o*255+","+l*255+","+c*255+","+s+")"}function dfe(e){if(rt.rgb(e))return cfe(e);if(rt.hex(e))return hfe(e);if(rt.hsl(e))return ufe(e)}function ao(e){var t=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(e);if(t)return t[1]}function pfe(e){if(of(e,"translate")||e==="perspective")return"px";if(of(e,"rotate")||of(e,"skew"))return"deg"}function j_(e,t){return rt.fnc(e)?e(t.target,t.id,t.total):e}function oa(e,t){return e.getAttribute(t)}function WA(e,t,r){var i=ao(t);if(HA([r,"deg","rad","turn"],i))return t;var n=ly.CSS[t+r];if(!rt.und(n))return n;var s=100,a=document.createElement(e.tagName),o=e.parentNode&&e.parentNode!==document?e.parentNode:document.body;o.appendChild(a),a.style.position="absolute",a.style.width=s+r;var l=s/a.offsetWidth;o.removeChild(a);var c=l*parseFloat(t);return ly.CSS[t+r]=c,c}function Qk(e,t,r){if(t in e.style){var i=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),n=e.style[t]||getComputedStyle(e).getPropertyValue(i)||"0";return r?WA(e,n,r):n}}function qA(e,t){if(rt.dom(e)&&!rt.inp(e)&&(oa(e,t)||rt.svg(e)&&e[t]))return"attribute";if(rt.dom(e)&&HA(afe,t))return"transform";if(rt.dom(e)&&t!=="transform"&&Qk(e,t))return"css";if(e[t]!=null)return"object"}function Kk(e){if(rt.dom(e)){for(var t=e.style.transform||"",r=/(\w+)\(([^)]*)\)/g,i=new Map,n;n=r.exec(t);)i.set(n[1],n[2]);return i}}function ffe(e,t,r,i){var n=of(t,"scale")?1:0+pfe(t),s=Kk(e).get(t)||n;return r&&(r.transforms.list.set(t,s),r.transforms.last=t),i?WA(e,s,i):s}function XA(e,t,r,i){switch(qA(e,t)){case"transform":return ffe(e,t,i,r);case"css":return Qk(e,t,r);case"attribute":return oa(e,t);default:return e[t]||0}}function YA(e,t){var r=/^(\*=|\+=|-=)/.exec(e);if(!r)return e;var i=ao(e)||0,n=parseFloat(t),s=parseFloat(e.replace(r[0],""));switch(r[0][0]){case"+":return n+s+i;case"-":return n-s+i;case"*":return n*s+i}}function Zk(e,t){if(rt.col(e))return dfe(e);if(/\s/g.test(e))return e;var r=ao(e),i=r?e.substr(0,e.length-r.length):e;return t?i+t:i}function QA(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function mfe(e){return Math.PI*2*oa(e,"r")}function gfe(e){return oa(e,"width")*2+oa(e,"height")*2}function vfe(e){return QA({x:oa(e,"x1"),y:oa(e,"y1")},{x:oa(e,"x2"),y:oa(e,"y2")})}function $k(e){for(var t=e.points,r=0,i,n=0;n<t.numberOfItems;n++){var s=t.getItem(n);n>0&&(r+=QA(i,s)),i=s}return r}function yfe(e){var t=e.points;return $k(e)+QA(t.getItem(t.numberOfItems-1),t.getItem(0))}function Jk(e){if(e.getTotalLength)return e.getTotalLength();switch(e.tagName.toLowerCase()){case"circle":return mfe(e);case"rect":return gfe(e);case"line":return vfe(e);case"polyline":return $k(e);case"polygon":return yfe(e)}}function xfe(e){var t=Jk(e);return e.setAttribute("stroke-dasharray",t),t}function wfe(e){for(var t=e.parentNode;rt.svg(t)&&rt.svg(t.parentNode);)t=t.parentNode;return t}function e8(e,t){var r=t||{},i=r.el||wfe(e),n=i.getBoundingClientRect(),s=oa(i,"viewBox"),a=n.width,o=n.height,l=r.viewBox||(s?s.split(" "):[0,0,a,o]);return{el:i,viewBox:l,x:l[0]/1,y:l[1]/1,w:a/l[2],h:o/l[3]}}function bfe(e,t){var r=rt.str(e)?Yk(e)[0]:e,i=t||100;return function(n){return{property:n,el:r,svg:e8(r),totalLength:Jk(r)*(i/100)}}}function _fe(e,t){function r(o){o===void 0&&(o=0);var l=t+o>=1?t+o:0;return e.el.getPointAtLength(l)}var i=e8(e.el,e.svg),n=r(),s=r(-1),a=r(1);switch(e.property){case"x":return(n.x-i.x)*i.w;case"y":return(n.y-i.y)*i.h;case"angle":return Math.atan2(a.y-s.y,a.x-s.x)*180/Math.PI}}function m5(e,t){var r=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/g,i=Zk(rt.pth(e)?e.totalLength:e,t)+"";return{original:i,numbers:i.match(r)?i.match(r).map(Number):[0],strings:rt.str(e)||t?i.split(r):[]}}function t8(e){var t=e?o1(rt.arr(e)?e.map(f5):f5(e)):[];return a1(t,function(r,i,n){return n.indexOf(r)===i})}function r8(e){var t=t8(e);return t.map(function(r,i){return{target:r,id:i,total:t.length,transforms:{list:Kk(r)}}})}function Sfe(e,t){var r=GA(t);if(/^spring/.test(r.easing)&&(r.duration=qk(r.easing)),rt.arr(e)){var i=e.length,n=i===2&&!rt.obj(e[0]);n?e={value:e}:rt.fnc(t.duration)||(r.duration=t.duration/i)}var s=rt.arr(e)?e:[e];return s.map(function(a,o){var l=rt.obj(a)&&!rt.pth(a)?a:{value:a};return rt.und(l.delay)&&(l.delay=o?0:t.delay),rt.und(l.endDelay)&&(l.endDelay=o===s.length-1?t.endDelay:0),l}).map(function(a){return l1(a,r)})}function Afe(e){for(var t=a1(o1(e.map(function(s){return Object.keys(s)})),function(s){return rt.key(s)}).reduce(function(s,a){return s.indexOf(a)<0&&s.push(a),s},[]),r={},i=function(s){var a=t[s];r[a]=e.map(function(o){var l={};for(var c in o)rt.key(c)?c==a&&(l.value=o[c]):l[c]=o[c];return l})},n=0;n<t.length;n++)i(n);return r}function Cfe(e,t){var r=[],i=t.keyframes;i&&(t=l1(Afe(i),t));for(var n in t)rt.key(n)&&r.push({name:n,tweens:Sfe(t[n],e)});return r}function Mfe(e,t){var r={};for(var i in e){var n=j_(e[i],t);rt.arr(n)&&(n=n.map(function(s){return j_(s,t)}),n.length===1&&(n=n[0])),r[i]=n}return r.duration=parseFloat(r.duration),r.delay=parseFloat(r.delay),r}function Efe(e,t){var r;return e.tweens.map(function(i){var n=Mfe(i,t),s=n.value,a=rt.arr(s)?s[1]:s,o=ao(a),l=XA(t.target,e.name,o,t),c=r?r.to.original:l,u=rt.arr(s)?s[0]:c,h=ao(u)||ao(l),d=o||h;return rt.und(a)&&(a=c),n.from=m5(u,d),n.to=m5(YA(a,u),d),n.start=r?r.end:0,n.end=n.start+n.delay+n.duration+n.endDelay,n.easing=VA(n.easing,n.duration),n.isPath=rt.pth(s),n.isColor=rt.col(n.from.original),n.isColor&&(n.round=1),r=n,n})}var i8={css:function(e,t,r){return e.style[t]=r},attribute:function(e,t,r){return e.setAttribute(t,r)},object:function(e,t,r){return e[t]=r},transform:function(e,t,r,i,n){if(i.list.set(t,r),t===i.last||n){var s="";i.list.forEach(function(a,o){s+=o+"("+a+") "}),e.style.transform=s}}};function n8(e,t){var r=r8(e);r.forEach(function(i){for(var n in t){var s=j_(t[n],i),a=i.target,o=ao(s),l=XA(a,n,o,i),c=o||ao(l),u=YA(Zk(s,c),l),h=qA(a,n);i8[h](a,n,u,i.transforms,!0)}})}function Tfe(e,t){var r=qA(e.target,t.name);if(r){var i=Efe(t,e),n=i[i.length-1];return{type:r,property:t.name,animatable:e,tweens:i,duration:n.end,delay:i[0].delay,endDelay:n.endDelay}}}function Pfe(e,t){return a1(o1(e.map(function(r){return t.map(function(i){return Tfe(r,i)})})),function(r){return!rt.und(r)})}function s8(e,t){var r=e.length,i=function(s){return s.timelineOffset?s.timelineOffset:0},n={};return n.duration=r?Math.max.apply(Math,e.map(function(s){let a=s.startOnceDelay??0,o=s.pingPongDelayCorrection??0,l=s.pingPongEndDelayCorrection??0;return i(s)+a+o+l+s.duration*(s.loop??1)})):t.duration,n.delay=r?Math.min.apply(Math,e.map(function(s){let a=s.startOnceDelay??0,o=s.pingPongDelayCorrection??0;return i(s)+a+o+s.delay})):t.delay,n.endDelay=r?n.duration-Math.max.apply(Math,e.map(function(s){let a=s.startOnceDelay??0,o=s.pingPongDelayCorrection??0,l=s.pingPongEndDelayCorrection??0;return i(s)+a+o+s.duration*(s.loop??1)-s.endDelay-l})):t.endDelay,n}var g5=0;function Dfe(e){var t=U_(Gk,e),r=U_(jA,e),i=Cfe(r,e),n=r8(e.targets),s=Pfe(n,i),a=s8(s,r),o=g5;return g5++,l1(t,{id:o,children:[],animatables:n,animations:s,duration:a.duration,delay:a.delay,endDelay:a.endDelay,startOnceDelay:r.startOnceDelay,pingPongDelayCorrection:r.pingPongDelayCorrection,pingPongEndDelayCorrection:r.pingPongEndDelayCorrection})}var $n=[],v5=[],Rv,Lfe=function(){function e(){Rv=requestAnimationFrame(t)}function t(r){var i=$n.length;if(i){for(var n=0;n<i;){var s=$n[n];s.paused?($n.splice(n,1),i-=1):(s.tick(r),n++)}e()}else Rv=cancelAnimationFrame(Rv)}return e}();function Ife(e){document.hidden?($n.forEach(function(t){return t.pause(e.timeStamp)}),v5=$n.slice(0),_r.running=$n=[]):v5.forEach(function(t){return t.play(e.timeStamp)})}typeof document<"u"&&document.addEventListener("visibilitychange",Ife);function _r(e){e===void 0&&(e={});var t=0,r=0,i=0,n,s,a=0,o=null;function l(_){var A=window.Promise&&new Promise(function(S){return o=S});return _.finished=A,A}var c=Dfe(e);l(c);function u(){var _=c.direction;_!=="alternate"&&(c.direction=_!=="normal"?"normal":"reverse"),c.reversed=!c.reversed,s.forEach(function(A){(A.loop===1||A.loop%2===0)&&(A.reversed=c.reversed)})}function h(){c.direction="normal",c.reversed=!1,s.forEach(function(_){return _.reversed=!1})}function d(_){return c.reversed?c.duration-_:_}function p(){t=0,r=d(c.currentTime)*(1/_r.speed)}function f(_,A,S=!1){A&&(c.reversed?A.seek(A.duration*A.loop-(_-A.timelineOffset-A.pingPongDelayCorrection),S):A.seek(_-A.timelineOffset-A.startOnceDelay-A.pingPongDelayCorrection,S))}function m(_,A=!1){if(c.reversed)for(var S=a;S--;)f(_,s[S],A);else for(var C=0;C<a;C++)f(_,s[C],A)}function g(_){var ie,J,ee,se,ce,ue,ye,Re,Se,ke;var A=0,S=c.animations,C=S.length;for(c.direction!=="alternate"&&((ie=c.parent)==null?void 0:ie.direction)==="alternate"?((J=c.parent)==null?void 0:J.rewind)===!1&&c.reversePlayback===!0&&c.rewind===!1&&((ee=c.parent)!=null&&ee.reversed&&c.direction==="alternate"?_=c.duration-c.delay+c.endDelay-_:_=c.duration+c.delay-c.endDelay-_):w(!1,(se=c.parent)==null?void 0:se.rewind,c.rewind,(ce=c.parent)==null?void 0:ce.reversePlayback,c.reversePlayback)&&((ue=c.parent)!=null&&ue.reversed&&c.direction==="alternate"?_=c.duration-c.delay+c.endDelay-_:_=c.duration+c.delay-c.endDelay-_);A<C;){var M=S[A],T=M.animatable,P=M.tweens,D=P.length-1,I=P[D];D&&(I=a1(P,function(Ce){return _<Ce.end})[0]||I);let Oe;(ye=c.parent)!=null&&ye.reversed&&c.direction==="alternate"?Oe=Cs(_-I.start-I.endDelay,0,I.duration)/I.duration:Oe=Cs(_-I.start-I.delay,0,I.duration)/I.duration;for(var B=isNaN(Oe)?1:I.easing(Oe),X=I.to.strings,H=I.round,R=[],q=I.to.numbers.length,F=void 0,N=0;N<q;N++){var j=void 0;let Ce,Ae;c.direction!=="alternate"?((Re=c.parent)==null?void 0:Re.rewind)===!1&&c.reversePlayback===!0&&c.rewind===!1?(Ce=I.to.numbers[N],Ae=I.from.numbers[N]||0):(Ae=I.to.numbers[N],Ce=I.from.numbers[N]||0):w(!0,(Se=c.parent)==null?void 0:Se.rewind,c.rewind,(ke=c.parent)==null?void 0:ke.reversePlayback,c.reversePlayback)?(Ce=I.to.numbers[N],Ae=I.from.numbers[N]||0):(Ae=I.to.numbers[N],Ce=I.from.numbers[N]||0),I.isPath?j=_fe(I.value,B*Ae):j=Ce+B*(Ae-Ce),H&&(I.isColor&&N>2||(j=Math.round(j*H)/H)),R.push(j)}var K=X.length;if(!K)F=R[0];else{F=X[0];for(var U=0;U<K;U++){X[U];var Y=X[U+1],V=R[U];isNaN(V)||(Y?F+=V+Y:F+=V+" ")}}i8[M.type](T.target,M.property,F,T.transforms),M.currentValue=F,A++}}function v(_){c[_]&&!c.passThrough&&c[_](c)}function y(){c.remaining&&c.remaining!==!0&&c.remaining--}let x={0:!1,1:!0,2:!1,3:!0,4:!1,5:!1,6:!1,7:!1,8:!1,9:!0,10:!0,11:!1,12:!1,13:!1,14:!0,15:!0,16:!1,17:!0,18:!0,19:!1,20:!1,21:!1,22:!0,23:!0,24:!1,25:!0,26:!1,27:!0,28:!1,29:!1,30:!1,31:!1};function w(_,A,S,C,M){return x[_<<4|A<<3|S<<2|C<<1|M]}function b(_,A=!1){var P;var S=c.duration;let C=c.delay,M=S-c.endDelay;(P=c.parent)!=null&&P.reversed&&c.direction==="alternate"&&(C=c.endDelay,M=S-c.delay);var T=d(_);if(c.progress=Cs(T/S*100,0,100),A||(c.reversePlayback=T<c.currentTime),a&&m(T,A),!c.began&&c.currentTime>=0&&(c.began=!0,v("begin")),!c.loopBegan&&c.currentTime>0&&(c.loopBegan=!0,v("loopBegin")),(c.reversed||T>=0)&&T<=C&&c.currentTime!==0&&(g(0),v("change")),(T>=M&&c.currentTime!==S+c.pingPongDelayCorrection||!S)&&(g(S),v("change")),T>C&&T<M?(c.changeBegan||(c.changeBegan=!0,c.changeCompleted=!1,v("changeBegin")),g(T),v("change")):c.changeBegan?(c.changeCompleted=!0,c.changeBegan=!1,v("change"),a&&v("timelineChangeComplete")):c.began&&T>M&&v("changeComplete"),c.currentTime=Cs(T,0,S+c.pingPongDelayCorrection),c.began&&v("update"),_>=S)if(y(),!c.remaining)c.paused=!0,c.completed||(c.completed=!0,v("loopComplete"),v("complete"),!c.passThrough&&"Promise"in window&&(o(),l(c)));else{a?t+=c.duration/_r.speed:t+=c.duration;for(let D of s)D.setStartTime(0),D.remaining=D.loop;v("loopComplete"),c.loopBegan=!1,c.direction==="alternate"?u():a&&h()}}return c.reset=function(){var _=c.direction;c.passThrough=!1,c.currentTime=0,c.progress=0,c.paused=!0,c.began=!1,c.loopBegan=!1,c.changeBegan=!1,c.completed=!1,c.changeCompleted=!1,c.reversePlayback=!1,c.reversed=_==="reverse",c.remaining=c.loop,s=c.children,a=s.length;for(var A=a;A--;)c.children[A].reset();(c.reversed&&c.loop!==!0||_==="alternate"&&c.loop===1)&&c.remaining++,g(c.reversed?c.duration:0)},c.setStartTime=function(_){t=_},c.set=function(_,A){return n8(_,A),c},c.tick=function(_){i=_,t||(t=i),b((i+(r-t))*_r.speed)},c.seek=function(_,A=!1){b(_-t,A)},c.pause=function(_){c.paused=!0,a&&(n=_??performance.now())},c.play=function(_){!c.paused||(c.completed&&c.reset(),c.paused=!1,$n.push(c),a&&n!==void 0&&(t+=(_??performance.now())-n),Rv||Lfe())},c.reverse=function(){u(),c.completed=!c.reversed,p()},c.restart=function(){c.reset(),c.play()},c.reset(),c.autoplay&&c.play(),c}function y5(e,t){for(var r=t.length;r--;)HA(e,t[r].animatable.target)&&t.splice(r,1)}function Ofe(e){for(var t=t8(e),r=$n.length;r--;){var i=$n[r],n=i.animations,s=i.children;y5(t,n);for(var a=s.length;a--;){var o=s[a],l=o.animations;y5(t,l),!l.length&&!o.children.length&&s.splice(a,1)}!n.length&&!s.length&&i.pause()}}function Rfe(e,t){t===void 0&&(t={});var r=t.direction||"normal",i=t.easing?VA(t.easing):null,n=t.grid,s=t.axis,a=t.from||0,o=a==="first",l=a==="center",c=a==="last",u=rt.arr(e),h=parseFloat(u?e[0]:e),d=u?parseFloat(e[1]):0,p=ao(u?e[1]:e)||0,f=t.start||0+(u?h:0),m=[],g=0;return function(v,y,x){if(o&&(a=0),l&&(a=(x-1)/2),c&&(a=x-1),!m.length){for(var w=0;w<x;w++){if(!n)m.push(Math.abs(a-w));else{var b=l?(n[0]-1)/2:a%n[0],_=l?(n[1]-1)/2:Math.floor(a/n[0]),A=w%n[0],S=Math.floor(w/n[0]),C=b-A,M=_-S,T=Math.sqrt(C*C+M*M);s==="x"&&(T=-C),s==="y"&&(T=-M),m.push(T)}g=Math.max.apply(Math,m)}i&&(m=m.map(function(D){return i(D/g)*g})),r==="reverse"&&(m=m.map(function(D){return s?D<0?D*-1:-D:Math.abs(g-D)}))}var P=u?(d-h)/g:h;return f+P*(Math.round(m[y]*100)/100)+p}}function Bfe(e){e===void 0&&(e={});var t=_r(e);return t.duration=0,t.add=function(r,i){var n=$n.indexOf(t),s=t.children;n>-1&&$n.splice(n,1);function a(d){d.passThrough=!0}for(var o=0;o<s.length;o++)a(s[o]);var l=l1(r,U_(jA,e));l.targets=l.targets||e.targets;var c=t.duration;l.autoplay=!1,l.timelineOffset=rt.und(i)?c:YA(i,c),a(t);var u=_r(l);a(u),s.push(u),u.parent=t;var h=s8(s,e);return t.delay=h.delay,t.endDelay=h.endDelay,t.duration=h.duration,u.loop===!0&&(t.duration=1/0),t.seek(0),t.reset(),t.autoplay&&t.play(),t},t}_r.version="3.2.0";_r.speed=1;_r.running=$n;_r.remove=Ofe;_r.get=XA;_r.set=n8;_r.convertPx=WA;_r.path=bfe;_r.setDashoffset=xfe;_r.stagger=Rfe;_r.timeline=Bfe;_r.easing=VA;_r.penner=Xk;_r.random=function(e,t){return Math.floor(Math.random()*(t-e+1))+e};var a8=_r,x5=new E,w5=new E,b5=new ft;function zfe(e,t,r,i){if(i===0)return r.copy(e);if(i===1)return r.copy(t);let n=e.w*t.w+e.x*t.x+e.y*t.y+e.z*t.z;if(n>=1)return r.copy(e);let s=1-n*n;if(s<=Number.EPSILON){let u=1-i;return r.w=u*e.w+i*t.w,r.x=u*e.x+i*t.x,r.y=u*e.y+i*t.y,r.z=u*e.z+i*t.z,r.normalize(),r}let a=Math.sqrt(s),o=Math.atan2(a,n),l=Math.sin((1-i)*o)/a,c=Math.sin(i*o)/a;return r.w=e.w*l+t.w*c,r.x=e.x*l+t.x*c,r.y=e.y*l+t.y*c,r.z=e.z*l+t.z*c,r}function kc(e,t,r,i,n){let s=r[e]?r[e]:void 0,a=i[e];if(a==null)return;let o=s??t[e],l=a;if(o!==l)return{update:c=>{let u=mt.lerp(o,l,c);n?t[e]=Math.trunc(u):t[e]=u},start:()=>{t[e]=o},end:()=>{t[e]=l}}}function o8(e,t,r,i,n){let s=r[e]?r[e]:void 0,a=i[e];if(!a)return;let o=t[e],l=[...s??o],c=[...a];if(!(l.length!==c.length||rA(l,c)))return{update:u=>{l.forEach((h,d)=>{let p=mt.lerp(h,c[d],u);t[e][d]=n?Math.trunc(p):p})},start:()=>{Object.assign(t[e],l)},end:()=>{Object.assign(t[e],c)}}}function _5(e,t,r,i){let n=r[e]?r[e]:void 0,s=i[e];if(!s)return;let a=t[e],o=n?new E().fromArray(n):a.clone(),l=new E().fromArray(s);if(!o.equals(l))return{update:c=>{a.lerpVectors(o,l,c)},start:()=>{a.copy(o)},end:()=>{a.copy(l)}}}function kfe(e,t,r,i){let n=r[e]?r[e]:void 0,s=i[e];if(!s)return;let a=t[e],o=n?new _e().fromArray(n):a.clone(),l=new E,c=new ft,u=new E;o.decompose(l,c,u);let h=new _e().fromArray(s),d=new E,p=new ft,f=new E;if(h.decompose(d,p,f),!o.equals(h))return{update:m=>{b5.slerpQuaternions(c,p,m),x5.lerpVectors(l,d,m),w5.lerpVectors(u,f,m),a.compose(x5,b5,w5)},start:()=>{a.compose(l,c,u)},end:()=>{a.compose(d,p,f)}}}function Nfe(e,t,r,i,n){let s=r[e]?r[e]:void 0,a=i[e];if(!a)return;let o=t[e],l=s?typeof s=="string"?n.getColor(s).clone():new $e().setRGB(s.r,s.g,s.b):o.clone(),c=typeof a=="string"?n.getColor(a).clone():new $e().setRGB(a.r,a.g,a.b);if(l.equals(c))return;let u=o.clone();return t[e]=u,{update:h=>{u.lerpColors(l,c,h)},start:()=>{u.copy(l)},end:()=>{u.copy(c)}}}function Ol(e,t,r,i){if(typeof t[e]=="number")return kc(e,t,r??{},i);if(Array.isArray(t[e]))return o8(e,t,r??{},i)}function Ffe(e,t,r){var a,o,l,c;let i=[],n=e.cameraType==="OrthographicCamera"?(a=t.orthographic)==null?void 0:a.zoom:(o=t.perspective)==null?void 0:o.zoom,s=e.cameraType==="OrthographicCamera"?(l=r.orthographic)==null?void 0:l.zoom:(c=r.perspective)==null?void 0:c.zoom;if(s!==void 0){let u=n??e.zoom,h=s;u!==h&&i.push({update:d=>{e.zoom=mt.lerp(u,h,d),e.updateProjectionMatrix()},start:()=>{e.zoom=u,e.updateProjectionMatrix()},end:()=>{e.zoom=h,e.updateProjectionMatrix()}})}if(r.targetOffset!==void 0){let u=kc("targetOffset",e,t,r);u&&i.push(u)}return i}function Ufe(e,t,r,i){if(r.scaleBaked===void 0)return;let n=t.scaleBaked??e.data.geometry.scaleBaked,s=r.scaleBaked;if(bc.isEqual(n,s))return;let a=[];return a.push({update:o=>{e.updateGeometryInteractions({scaleBaked:[mt.lerp(n[0],s[0],o),mt.lerp(n[1],s[1],o),mt.lerp(n[2],s[2],o)]},i),e.invalidateDownstreamBooleanData()},start:()=>{e.updateGeometryInteractions({scaleBaked:n},i),e.invalidateDownstreamBooleanData()},end:()=>{e.updateGeometryInteractions({scaleBaked:s},i),e.invalidateDownstreamBooleanData()}}),a}function jfe(e,t,r){if(!r.extrusion)return;let i=e.extrusion,n=t.extrusion??{},s=r.extrusion,a=[];return cz.forEach(o=>{let l=Ol(o,i,n,s);l&&a.push(l)}),a}function Vfe(e,t,r,i){let n=[];if(!("geometry"in r))return n;let s=e.geometry.userData.parameters,a="geometry"in t?t.geometry:{},o=r.geometry;if(e instanceof Kf){let l=Ufe(e,a,o,i);l&&n.push(...l)}else{let l={};if(Object.assign(l,no(s,T4)),T4.forEach(c=>{let u=Ol(c,l,a,o);u&&n.push(u)}),e instanceof BA){Object.assign(l,{extrusion:{...s.extrusion}});let c=jfe(l,a,o);c&&n.push(...c)}n.length&&n.push({update:c=>{e.updateGeometryInteractions(l,i),e.updateGeometryGroupsIfNeeded()},start:c=>{e.updateGeometryInteractions(l,i),e.updateGeometryGroupsIfNeeded()},end:c=>{e.updateGeometryInteractions(l,i),e.updateGeometryGroupsIfNeeded()}})}return n}function Hfe(e,t,r,i){let n=[];if(r.intensity!==void 0){let s=kc("intensity",e,t,r);s&&n.push(s)}if(r.color!==void 0){let s=Nfe("color",e,t,r,i);s&&n.push(s)}return n}function Gfe(e,t,r,i){let n=[];if(Array.isArray(e.material)){if(!("materials"in r&&r.materials))return n;let s="materials"in t&&t.materials?t.materials:[],a=r.materials;e.material.forEach((o,l)=>{if(!a[l])return;let c=s[l]??{},u=a[l];typeof c=="string"||typeof u=="string"||n.push(...S5(o,c,u,i))})}else{if(!("material"in r&&r.material))return n;let s="material"in t&&t.material?t.material:{},a=r.material;if(typeof s=="string"||typeof a=="string")return n;n.push(...S5(e.material,s,a,i))}return n}function S5(e,t,r,i){var a;let n=[],s=ny(r,i)||!!t.layers&&ny(t,i);n.push(Jfe(e,s));for(let o of e.layers){let l=(a=t.layers)==null?void 0:a.data(o.uuid),c=r.layers.data(o.uuid);if(!c||!(o.visible??!0)||!(c.visible??!0))continue;let u=o.getNames().filter(h=>!az.some(d=>h.includes(d)));for(let h of u)try{let d=o.getValue(h),p;if(h==="colors")p=Zfe(o,l,c,h);else if(Array.isArray(d))h==="steps"&&(p=Kfe(o,l,c,h));else if(typeof d=="number")p=Wfe(o,l,c,h);else{if(typeof d=="boolean")continue;d instanceof W?p=qfe(o,l,c,h):d instanceof E?p=Xfe(o,l,c,h):d instanceof nn?p=Qfe(o,l,c,h,i):d instanceof $e?p=Yfe(o,l,c,h,i):"isTexture"in d&&(p=$fe(o,l,c,h))}p&&(Array.isArray(p)?n.push(...p):n.push(p))}catch(d){console.error(`lerpMaterial: unexpected material layer for ${h}`,d)}}return n}function Wfe(e,t,r,i){if(!e.hasValue(i)||!(i in r))return;let n=t?t[i]:e.getValue(i),s=r[i];if(n!==s)return{update:a=>{e.setValue(i,mt.lerp(n,s,a))},start:()=>{e.setValue(i,n)},end:()=>{e.setValue(i,s)}}}function qfe(e,t,r,i){if(!e.hasValue(i)||!(i in r))return;let n=e.getValue(i),s=t?new W().fromArray(t[i]):n.clone(),a=new W().fromArray(r[i]);if(!s.equals(a))return{update:o=>{n.lerpVectors(s,a,o)},start:()=>{n.copy(s)},end:()=>{n.copy(a)}}}function Xfe(e,t,r,i){if(!e.hasValue(i)||!(i in r))return;let n=e.getValue(i),s=t?new E().fromArray(t[i]):n.clone(),a=new E().fromArray(r[i]);if(!s.equals(a))return{update:o=>{n.lerpVectors(s,a,o)},start:()=>{n.copy(s)},end:()=>{n.copy(a)}}}function Yfe(e,t,r,i,n){if(!e.hasValue(i)||!(i in r))return;let s=t?t[i]:void 0,a=r[i],o=e.getValue(i),l=s?typeof s=="string"?n.getColor(s).clone():new $e().setRGB(s.r,s.g,s.b):o.clone(),c=typeof a=="string"?n.getColor(a).clone():new $e().setRGB(a.r,a.g,a.b);if(l.equals(c))return;let u=o.clone();return{update:h=>{e.getValue(i)!==u&&e.setValue(i,u),u.lerpColors(l,c,h)},start:()=>{u.copy(l)},end:()=>{u.copy(c)}}}function Qfe(e,t,r,i,n){if(!e.hasValue(i)||!(i in r))return;let s=t?t[i]:void 0,a=r[i],o=e.getValue(i),l=s?typeof s=="string"?n.getColor(s).clone():new $e().setRGB(s.r,s.g,s.b):o.clone(),c=typeof a=="string"?n.getColor(a).clone():new nn(a.r,a.g,a.b,a.a);if(l.equals(c))return;let u=o.clone();return{update:h=>{e.getValue(i)!==u&&e.setValue(i,u),u.lerpColors(l,c,h)},start:()=>{u.copy(l)},end:()=>{u.copy(c)}}}function Kfe(e,t,r,i="steps"){if(!e.hasValue(i)||!(i in r))return;let n=[],s=e.getValue(i),a=t?t[i]:s,o=r[i];for(let l=0;l<s.length;++l){let c=a[l],u=o[l];c!==u&&n.push({update:h=>{s[l]=mt.lerp(c,u,h)},start:()=>{s[l]=c},end:()=>{s[l]=u}})}return n.length?n:void 0}function Zfe(e,t,r,i="colors"){if(!e.hasValue(i)||!(i in r))return;let n=[],s=e.getValue(i),a=t?t[i]:s.map(l=>l.toArray()),o=r[i];for(let l=0;l<s.length;++l){let c=[...a[l]],u=[...o[l]];V0.isEqual(c,u)||n.push({update:h=>{s[l].fromArray(V0.lerp(c,u,h))},start:()=>{s[l].fromArray(c)},end:()=>{s[l].fromArray(u)}})}return n.length?n:void 0}function $fe(e,t,r,i="texture"){if(!e.hasValue(i)||!(i in r))return;let n=e.getNode("mat");if(!n)return;let s=t?t[i]:n,a=r[i],o=[...s.repeat],l=[...s.offset],c=[...a.repeat],u=[...a.offset];if(!nu.isEqual(o,c)||!nu.isEqual(l,u))return{update:h=>{n.repeat=nu.lerp(o,c,h),n.offset=nu.lerp(l,u,h),n.updateMatrix()},start:()=>{n.repeat=[...o],n.offset=[...l],n.updateMatrix()},end:()=>{n.repeat=[...c],n.offset=[...u],n.updateMatrix()}}}function Jfe(e,t){return{update:()=>{e.transparent=t}}}var Lw=new E,A5=new Zr;function eme(e,t,r,i){let n=[],s,a,o,l,c,u,h={slide:(t.pathSnapping??e.updatedPathSnapping??e.dataPatched.pathSnapping).slide,offset:(t.pathSnapping??e.updatedPathSnapping??e.dataPatched.pathSnapping).offset};if(c=kc("slide",h,t.pathSnapping??e.updatedPathSnapping??e.dataPatched.pathSnapping,r.pathSnapping??e.dataPatched.pathSnapping),c&&n.push(c),u=kc("offset",h,t.pathSnapping??e.updatedPathSnapping??e.dataPatched.pathSnapping,r.pathSnapping??e.dataPatched.pathSnapping),u&&n.push(u),!c&&!u&&(s=_5("position",e,t,r),s&&n.push(s),a=_5("scale",e,t,r),a&&n.push(a),o=tme(e,t,r,i),o&&n.push(o),l=kfe("hiddenMatrix",e,t,r),l&&n.push(l)),s||a||o||l||c||u){let d=()=>{var p;e.updateMatrix(),e.hasNonUniformScale&&(e.updateMatrixWorld(),e.updateMatrixWorldSVD()),(p=e.parent)!=null&&p.matrixWorldFusedFalse&&(e.matrixWorld.multiplyMatrices(e.parent.matrixWorldFusedFalse,e.matrix),e.matrixWorldNeedsUpdate=!1),ws(e)&&na(e.parent)&&e.invalidateDownstreamBooleanData(!0),e.updatePathSnapping(Object.assign({},t.pathSnapping,h))};n.push({update:d,start:d,end:d})}return n}function tme(e,t,r,i){let n=t!=null&&t.rotation?t.rotation:void 0,s=r.rotation;if(!s)return;let a=n?new E().fromArray(n):new E().setFromEuler(e.rotation),o=new E().fromArray(s);if(a.equals(o))return;let l=Lw.subVectors(o,a);if(i&&l.toArray().every(c=>Math.abs(c)<2*Math.PI)){let c=new ft().setFromEuler(A5.setFromVector3(a)),u=new ft().setFromEuler(A5.setFromVector3(o));return{update:h=>{zfe(c,u,e.quaternion,h)},start:()=>{e.rotation.setFromVector3(a)},end:()=>{e.rotation.setFromVector3(o)}}}else return{update:c=>{Lw.lerpVectors(a,o,c),e.rotation.setFromVector3(Lw)},start:()=>{e.rotation.setFromVector3(a)},end:()=>{e.rotation.setFromVector3(o)}}}function rme(e,t,r){let i=[];if(!("cloner"in r)||!e.cloner)return i;let n=e.cloner,s="cloner"in t?t.cloner:{},a=r.cloner;ez.forEach(d=>{let p;d==="count"?p=kc("count",n.parameters,s,a,!0):p=Ol(d,n.parameters,s??{},a),p&&i.push(p)});let o=ime(n,s,a);o!=null&&o.length&&i.push(...o);let l=nme(n,s,a);l!=null&&l.length&&i.push(...l);let c=sme(n,s,a);c!=null&&c.length&&i.push(...c);let u=ame(n,s,a);u!=null&&u.length&&i.push(...u);let h=ome(n,s,a);return h!=null&&h.length&&i.push(...h),i.length&&i.push({update:()=>{n.update()}}),i}function ime(e,t,r){if(e.parameters.type!=="radial")return;let i=t.radial,n=r.radial;if(!n)return;let s=e.parameters.radial,a=[];return tz.forEach(o=>{let l=Ol(o,s,i??{},n);l&&a.push(l)}),a}function nme(e,t,r){if(e.parameters.type!=="linear")return;let i=t.linear,n=r.linear;if(!n)return;let s=[],a=e.parameters.linear;return rz.forEach(o=>{let l=Ol(o,a,i??{},n);l&&s.push(l)}),s}function sme(e,t,r){if(e.parameters.type!=="grid")return;let i=t.grid,n=r.grid;if(!n)return;let s=[],a=e.parameters.grid;return iz.forEach(o=>{let l;o==="count"?l=o8(o,a,i??{},n,!0):l=Ol(o,a,i??{},n),l&&s.push(l)}),s}function ame(e,t,r){if(e.parameters.type!=="toObject")return;let i=t.toObject,n=r.toObject;if(!n)return;let s=[],a=e.parameters.toObject;return nz.forEach(o=>{let l;o==="count"?l=kc(o,a,i??{},n,!0):l=Ol(o,a,i??{},n),l&&s.push(l)}),s}function ome(e,t,r){if(!e.parameters.randomness)return;let i=t.randomnessObject,n=r.randomnessObject;if(!n)return;let s=[],a=e.parameters.randomnessObject;return sz.forEach(o=>{let l=Ol(o,a,i??{},n);l&&s.push(l)}),s}function C5(e,t,r,i,n){let s=[];return e.data.visible&&s.push(...eme(e,t,r,n)),e.data.visible&&s.push(...rme(e,t,r)),ws(e)?(e instanceof zi&&e.data.visible&&s.push(...Vfe(e,t,r,i)),e.data.visible&&s.push(...Gfe(e,t,r,i))):Sue(e)?e.data.visible&&s.push(...Hfe(e,t,r,i)):_ue(e)&&s.push(...Ffe(e,t,r)),s.length?{update:a=>{s.forEach(o=>o.update(a))},start:a=>{s.forEach(o=>{var l;return(l=o.start)==null?void 0:l.call(o,a)})},end:a=>{s.forEach(o=>{var l;return(l=o.end)==null?void 0:l.call(o,a)})}}:void 0}var M5=new E;function KA(e,t,r=!1){let i=[];e.traverseChildren(n=>{var l,c,u,h,d;if(r&&((l=n.rigidBody)==null||l.setTranslation(n.position0,!0),(c=n.rigidBody)==null||c.setRotation(n.rotation0,!0),(u=n.rigidBody)==null||u.setLinvel(M5,!0),(h=n.rigidBody)==null||h.setAngvel(M5,!0)),!Mt.is(n))return;let s=n.uuid,a=n.data;if(delete n.states,n.uuid===_d)return;let o=!1;i.some(p=>{var f;return(f=e.scene.find(s))==null?void 0:f.isDescendantOf(p)})?o=!0:((d=a.physics)==null?void 0:d.fusedBody)===!0&&a.physics.rigidBody==="dynamic"&&i.push(s),n.data=a,n.currentState=null,n.reversibleToState=null,n.currentTransitionEvent=null;for(let p of a.states){let f={...p.data};e.data.globalPhysics.usePhysics===!0&&a.physics&&(a.physics.rigidBody==="dynamic"||o)&&(p.data.position!==void 0&&delete f.position,p.data.rotation!==void 0&&delete f.rotation,p.data.hiddenMatrix!==void 0&&delete f.hiddenMatrix),n.states||(n.states={}),n.states[p.id]=uc.patch(a,f)}cme(e.scene,n,null,t,a.events.find(p=>p.data.type==="Follow"||p.data.type==="LookAt")!==void 0),lme(e)})}function lme(e){e.traverseEntity(t=>{for(let r of t.data.events){let i=[];switch(r.data.type){case"Follow":case"MouseHover":case"Scroll":case"MouseDown":case"MouseUp":case"MousePress":case"KeyUp":case"KeyDown":case"KeyPress":case"Collision":i.push(...r.data.actions);break;case"GameControl":for(let n of Object.values(r.data.gameActions))i.push(...n);break;case"DragDrop":i.push(...r.data.dragDropActions.drag,...r.data.dragDropActions.drop);break;case"Conditional":i.push(...r.data.inActions,...r.data.outActions);break}for(let n of i)if(n.data.type==="Create"&&n.data.hideBase==="Yes"){let s=e.scene.find(n.data.object);s&&(s.visible=!1)}}})}function cme(e,t,r,i,n=!1){if(t instanceof zi&&t.removeInteractionGeometry(),t.changeSelectedState(r,{scene:e,shared:i},n),t instanceof zi&&t.updateGeometryGroupsIfNeeded(),t instanceof bi&&t.updateCameraState(t.dataPatched,{scene:e,shared:i}),t.cloner)for(let s of t.cloner.children)s.playModeVisible=void 0;t.updateVisible()}function l8(e){let t;if(e.easing===5){let{control1:r,control2:i}=e;t=`cubicBezier(
			${r[0]}, ${r[1]}, ${i[0]}, ${i[1]}
		)`}else if(e.easing===6){let{mass:r,stiffness:i,damping:n,velocity:s}=e;t=`spring( ${r}, ${i}, ${n}, ${s} )`}else{let r;switch(e.easing){case 0:r=Uo.linear;break;case 1:r=Uo.ease;break;case 2:r=Uo.easeIn;break;case 3:r=Uo.easeOut;break;case 4:r=Uo.easeInOut;break;default:r=Uo.linear}let[i,n,s,a]=r;t=`cubicBezier( ${i}, ${n}, ${s}, ${a} )`}return{duration:e.duration,easing:t}}function c8(e){let t={delay:0,loop:e.repeat===-1?!0:e.repeat+1};if(e.repeat===0)t.direction="normal",t.rewind=!1;else switch(e.direction){case"pingpong":t.direction="alternate",t.rewind=!1;break;case"pingpong-rewind":t.direction="alternate",t.rewind=!0;break;default:t.direction="normal",t.rewind=!1;break}switch(t.delay=0,t.endDelay=0,t.startOnceDelay=0,t.pingPongDelayCorrection=0,t.pingPongEndDelayCorrection=0,e.delayDirection){case"start-once":t.startOnceDelay=e.delay;break;case"start":t.delay=e.delay;break;case"end":t.endDelay=e.delay;break;case"start-end":case void 0:t.delay=e.delay,t.endDelay=e.delay;break}return t.direction==="alternate"&&(t.delay/=2,t.endDelay/=2,e.delayDirection==="start"?(t.pingPongDelayCorrection=t.delay,typeof t.loop=="number"&&t.loop%2===0&&(t.pingPongEndDelayCorrection=t.delay)):e.delayDirection==="end"?typeof t.loop=="number"&&t.loop%2!==0&&(t.pingPongEndDelayCorrection=t.endDelay):e.delayDirection==="start-end"&&(t.pingPongDelayCorrection=t.delay,t.pingPongEndDelayCorrection=t.endDelay)),t}var hme={type:"beginState"},ume={type:"completeState",isfromEntity:!1},E5=class{constructor(e,t,r,i,n,s){if(this.object=e,this.data=i,this.sharedAssets=n,this.allowSlerp=s,this.targets={t:0},this.firstLoop=!0,this._changeBegan=!1,this._changeCompleted=!0,this.onChange=()=>{this.callback&&(this.callback.update(this.targets.t),this.object.dispatchEvent({type:"requestRender"})),this.targets.t===0||this.targets.t===1?this._changeCompleted||(this._changeCompleted=!0,this._changeBegan=!1,this.onChangeComplete()):(this._changeCompleted&&(this._changeCompleted=!1),this._changeBegan||(this._changeBegan=!0,this.onChangeBegin()))},this.onChangeBegin=()=>{this.object.reversibleToState=this.to.id;let a=this.targets.t>.5?this.from.id:this.to.id;this.object.prevState!==this.object.currentState&&(this.object.prevState=this.object.currentState),this.object.currentState=a,this.object.dispatchEvent({type:"beginState",state:a}),this.object.traverseEntity(o=>{o!==this.object&&o instanceof bi&&o.dispatchEvent(hme)})},this.onChangeComplete=()=>{this.firstLoop&&(this.onFirstLoop(),this.firstLoop=!1),this.object.reversibleToState=this.to.id;let a=this.targets.t<.5?this.from.id:this.to.id;this.object.prevState!==this.object.currentState&&(this.object.prevState=this.object.currentState),this.object.currentState=a,this.object.dispatchEvent({type:"completeState",state:a}),this.object.traverseEntity(o=>{o!==this.object&&o instanceof bi&&o.dispatchEvent(ume)})},this.onFirstLoop=()=>{this.useCurrentState&&(this.callback=C5(this.object,this.from.data,this.to.data,this.sharedAssets,this.allowSlerp))},t===void 0){let a=Bv(this.object,this.object.currentState===r?this.object.prevState:this.object.currentState);if(!a)throw new Error("Missing property");this.from=a}else{let a=Bv(this.object,t);if(!a)throw new Error("Missing property");this.from=a}if(r===void 0)throw new Error("Missing property");{let a=Bv(this.object,r);if(!a)throw new Error("Missing property");this.to=a}this.useCurrentState=t===void 0||r===void 0,this.params={targets:this.targets,t:1,autoplay:!1,...c8(i),...l8(i),change:this.onChange},this.callback=C5(this.object,t===void 0?{}:this.from.data,r===void 0?{}:this.to.data,this.sharedAssets,this.allowSlerp)}get changeBegan(){return this._changeBegan}get changeCompleted(){return this._changeCompleted}},lf=class extends ui{constructor(e,t,r){if(super(),this.data=e,this.page=t,this.sharedAssets=r,this.toggleIsForward=!1,this.timelineNeedsRebuild=!1,this.useToggle=!1,this.onTimelineChangeComplete=()=>{var n;this.data.tweens[0].data.direction!=="normal"&&(this.toggleIsForward=!this.toggleIsForward),this.timelineNeedsRebuild!==!1&&((n=this.timeline)==null||n.pause(),this.buildTimeline({isForward:this.toggleIsForward,isRebuild:!0}),this.timeline.play())},!e.object)throw new Error("Missing property");let i=this.page.scene.find(e.object);if(!i)throw new Error("Missing property");if(!i.states)throw new Error("Missing property");if(this.object=i,e.tweens.length<2)throw new Error("Missing property");this.tweens=Array(this.data.tweens.length-1),this.startOnceDelay=e.tweens[0].data.delayDirection==="start-once"?e.tweens[0].data.delay:0,this.init()}get playing(){return this.tweens.some(e=>e.changeBegan)??!1}init(){this.initialCurrentState=Bv(this.object,this.object.currentState).id,this.toggleIsForward=!1}get currentState(){return this.useToggle?this.initialCurrentState:this.object.currentState}buildTimeline({isForward:e=!0,isRebuild:t=!1}={}){var r,i,n,s;try{let a=c8(this.data.tweens[0].data),o=a.loop;t&&typeof a.loop=="number"&&a.loop--,(r=this.timeline)==null||r.pause(),this.timeline=a8.timeline({autoplay:!1,...a,...o===!0||o>1?{timelineChangeComplete:this.onTimelineChangeComplete}:{}});let l=this.tweens.findIndex(c=>c==null?void 0:c.changeBegan);if(this.timelineNeedsRebuild=l!==-1&&(o===!0||o>1),a.pingPongDelayCorrection&&t===!1&&(this.timelineNeedsRebuild=!0),e){let c=l===-1?0:l;for(let u=c;u<this.data.tweens.length-1;u++){let h=this.data.tweens[u],d=this.data.tweens[u+1],p;u===c&&(this.object.wasMovedByUser===!0||((i=this.object.previousAction)==null?void 0:i.playing)===!0)?(p=void 0,this.object instanceof bi&&(this.object.wasMovedByUser=!1)):p=h.data.state===void 0?this.currentState:h.data.state;let f=new E5(this.object,p,d.data.state===void 0?this.currentState:d.data.state,d.data,this.sharedAssets,this.data.allowSlerp??!1);l!==-1&&u===c&&Object.assign(f.params,{startOnceDelay:0}),this.tweens[u]=f,this.timeline.add(f.params,this.timeline.duration+(u===c?a.delay:0)+(u===c&&!t?a.pingPongDelayCorrection:0))}this.timeline.duration+=a.endDelay}else{let c=l===-1?this.data.tweens.length-1:l+1;for(let u=c;u>0;u--){let h=this.data.tweens[u],d=this.data.tweens[u-1],p;u===c&&(this.object.wasMovedByUser===!0||((n=this.object.previousAction)==null?void 0:n.playing)===!0)?(p=void 0,this.object instanceof bi&&(this.object.wasMovedByUser=!1)):p=h.data.state===void 0?this.currentState:h.data.state;let f=new E5(this.object,p,d.data.state===void 0?this.currentState:d.data.state,h.data,this.sharedAssets,this.data.allowSlerp??!1);l!==-1&&u===c&&Object.assign(f.params,{startOnceDelay:0}),this.tweens[u-1]=f,this.timeline.add(f.params,this.timeline.duration+(u===c?a.endDelay:0))}this.timeline.duration+=a.delay+(t?0:a.pingPongDelayCorrection)}}catch(a){a instanceof Error&&console.error(a.message)}((s=this.object.previousAction)==null?void 0:s.playing)===!0&&this.object.previousAction.pause(),this.object.previousAction=this}play(){if(this.playing)return!1;clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{try{this.buildTimeline(),this.timeline.play()}catch(e){e instanceof Error&&console.error(e.message)}},this.startOnceDelay)}pause(){var e;(e=this.timeline)==null||e.pause(),clearTimeout(this.timeoutId),this.tweens=Array(this.data.tweens.length-1),delete this.timeoutId}stop(){this.pause();let e=this.data.tweens[0].data.state===void 0?this.initialCurrentState:this.data.tweens[0].data.state;this.object.changeSelectedState(e,{scene:this.page.scene,shared:this.sharedAssets}),this.object.currentState=e}seek(e){var t;this.timeline===void 0&&this.buildTimeline(),(t=this.timeline)==null||t.seek(e*this.timeline.duration,!0)}toggle(e){var t;this.useToggle=!0,clearTimeout(this.timeoutId),this.toggleIsForward=e??!this.toggleIsForward,this.playing?((t=this.timeline)==null||t.pause(),this.buildTimeline({isForward:this.toggleIsForward}),this.timeline.play()):this.timeoutId=window.setTimeout(()=>{var r;(r=this.timeline)==null||r.pause(),this.buildTimeline({isForward:this.toggleIsForward}),this.timeline.play()},this.startOnceDelay)}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){this.pause()}};function Bv(e,t){var n;let r,i;if(typeof t=="string"?(r=t,i=(n=e.states)==null?void 0:n[r]):t===null&&(r=null,i=e.data),!(r===void 0||i===void 0))return{id:r,data:i}}var dme={type:"beginState"},T5={type:"completeState",isfromEntity:!1},P5={type:"requestRender"},h8=class extends ui{constructor(e,t){super(),this.data=e,this.page=t,this.toggleIsForward=!1,this.useToggle=!1,this.posStart=new E,this.posEnd=new E,this.qStart=new ft,this.qEnd=new ft,this.zoomStart=1,this.zoomEnd=1}init(){}get playing(){return this.animation&&this.animation.began&&!this.animation.completed}buildAnimation(e=!1){if(!this.data.animate)return;let t=this.page.scene.find(this.data.targetCamera);if(!t||!t.visible)throw new ReferenceError("Target camera not founded or not visible");let r={t:0};this.posStart.copy(this.page.activeCamera.position),this.qStart.copy(this.page.activeCamera.quaternion),this.zoomStart=this.page.activeCamera.zoom,this.animation=a8({targets:r,t:1,...l8(this.data),update:()=>{r.t===0&&(this.useToggle&&!this.toggleIsForward?(this.posEnd.copy(this.fromCamera.position),this.qEnd.copy(this.fromCamera.quaternion),this.zoomEnd=this.fromCamera.zoom,this.switchCamera(this.fromCamera.uuid)):(this.posEnd.copy(t.position),this.qEnd.copy(t.quaternion),this.zoomEnd=t.zoom,this.fromCamera=this.page.activeCamera,this.switchCamera(t.uuid)),this.page.activeCamera.dispatchEvent(dme));let i=this.page.activeCamera;i.position.lerpVectors(this.posStart,this.posEnd,r.t),i.quaternion.slerpQuaternions(this.qStart,this.qEnd,r.t),i.zoom=this.zoomStart+(this.zoomEnd-this.zoomStart)*r.t,i.wasMovedBySwitchCameraAction=!0,i.updateMatrix(),i.updateMatrixWorld(),i.updateProjectionMatrix(),i.dispatchEvent(P5),r.t===1&&i.dispatchEvent(T5)}})}switchCamera(e){let t=this.page.scene.find(e);if(!t||!t.visible)throw new ReferenceError("Target camera not founded or not visible");this.page.switchActiveCamera(t),this.page.activeCamera.dispatchEvent({type:"cameraChange",camera:t})}play(){if(!this.playing&&this.page.activeCamera.uuid!==this.data.targetCamera)try{clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{var e;delete this.timeoutId,this.data.animate?(this.buildAnimation(),(e=this.animation)==null||e.play()):this.switchCamera(this.data.targetCamera)},this.data.delay*1e3)}catch{}}pause(){var e;(e=this.animation)==null||e.pause(),clearTimeout(this.timeoutId),delete this.timeoutId}toggle(e){var t,r;this.useToggle=!0,clearTimeout(this.timeoutId),this.toggleIsForward=e??!this.toggleIsForward;try{this.playing?((t=this.animation)==null||t.pause(),this.buildAnimation(!0),(r=this.animation)==null||r.play()):this.timeoutId=window.setTimeout(()=>{var i,n;delete this.timeoutId,this.data.animate?((i=this.animation)==null||i.pause(),this.buildAnimation(),(n=this.animation)==null||n.play()):(this.toggleIsForward?(this.fromCamera=this.page.activeCamera,this.switchCamera(this.data.targetCamera)):this.switchCamera(this.fromCamera.uuid),this.page.activeCamera.dispatchEvent(T5),this.page.activeCamera.dispatchEvent(P5))},this.data.delay*1e3)}catch{}}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){this.pause(),this.toggleIsForward=!1}},cf=class extends ui{constructor(e,t,r){var o,l,c;super(),this.page=t,this.animationControls=r,this.startOnceDelay=0,this.toggleIsForward=!1;let i=e.object,n=t.scene.find(e.object);n&&Array.isArray(n.identity)&&(i=n.identity[0]),this.data={...e,object:i};let s=this.animationControls.clipIdToAction[e.clipId+"/"+i];this.duration=((o=s==null?void 0:s.getClip())==null?void 0:o.duration)??1;let a=((c=(l=s==null?void 0:s.getClip())==null?void 0:l.tracks[0])==null?void 0:c.times.length)??1/0;this.leftFrameTime=this.data.crop[0]/a*this.duration,this.rightFrameTime=this.data.crop[1]/a*this.duration,this.startOnceDelay=e.delay}get playing(){var e;return((e=this.threeAnimAction)==null?void 0:e.isRunning())??!1}play(e=!1){window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{var r;if(this.threeAnimAction=this.animationControls.play(this.data),!this.threeAnimAction)return;this.threeAnimAction.reset(),this.threeAnimAction.time=this.leftFrameTime,this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime;let t=this.data.object;Object.entries(this.animationControls.clipIdToAction).forEach(([i,n])=>{let s=i.split("/")[1];this.threeAnimAction!==n&&s===t&&n.isRunning()&&(e?n.fadeOut(.2):n.stop())}),e&&((r=this.threeAnimAction)==null||r.fadeIn(.2))},this.startOnceDelay)}pause(){this.threeAnimAction&&(this.threeAnimAction.paused=!0),window.clearTimeout(this.timeoutId),delete this.timeoutId}stop(){var e;(e=this.threeAnimAction)==null||e.fadeOut(.2)}seek(e){this.threeAnimAction=this.animationControls.play(this.data),this.threeAnimAction&&(this.threeAnimAction.paused=!0,this.threeAnimAction.time=mt.clamp(this.threeAnimAction.time+1/60*e,this.leftFrameTime,this.rightFrameTime-16e-5),this.animationControls.needsUpdate=!0,this.animationControls.requestRender())}toggle(e,t=!1){this.toggleIsForward=e??!this.toggleIsForward,this.threeAnimAction&&(this.threeAnimAction._loopCount=0),this.playing?this.threeAnimAction&&(this.threeAnimAction.timeScale=this.toggleIsForward?1:-1,this.toggleIsForward?(this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime):(this.threeAnimAction._clip.start=this.rightFrameTime,this.threeAnimAction._clip.duration=this.leftFrameTime)):this.timeoutId=window.setTimeout(()=>{var r;if(this.threeAnimAction=this.animationControls.play(this.data),this.threeAnimAction){this.toggleIsForward?(this.threeAnimAction.time=this.leftFrameTime,this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime):(this.threeAnimAction.time=this.rightFrameTime,this.threeAnimAction._clip.start=this.rightFrameTime,this.threeAnimAction._clip.duration=this.leftFrameTime),this.threeAnimAction.paused=!1,this.threeAnimAction.timeScale=this.toggleIsForward?1:-1;let i=this.data.clipId.split("/")[1];Object.entries(this.animationControls.clipIdToAction).forEach(([n,s])=>{let a=n.split("/")[1];this.threeAnimAction!==s&&a===i&&s.isRunning()&&(t?s.fadeOut(.2):s.stop())}),t&&((r=this.threeAnimAction)==null||r.fadeIn(.2))}},this.startOnceDelay)}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){var t;let e=(t=this.animationControls.clipIdToAction[this.data.clipId+"/"+this.data.object])==null?void 0:t.getClip();e&&(e.duration=this.duration),this.pause()}},u8=class{constructor(e,t,r,i){this.data=e,this.page=t,this.eventManager=r,this.shared=i,this.timeOutId=-1,this.scene=t.scene}dispatch(){this.data.target!==this.page.uuid&&(window.clearTimeout(this.timeOutId),this.timeOutId=window.setTimeout(()=>{this.play()},this.data.delay*1e3))}dispose(){window.clearTimeout(this.timeOutId)}play(){if(this.scene.children.every(t=>t.uuid!==this.data.target))return;this.data.transition==="fade"&&this.data.duration>0&&this.eventManager.eventContext.renderer.renderFromSceneForSceneTransitionPass(this.scene,this.scene.activeCamera,this.data.duration*1e3),this.eventManager.deactivate(),this.eventManager.controlsManager.deactivate();let e=this.scene.activeCamera;this.scene.updatePage(this.data.target),this.scene.activePage.switchToPlayCamera(),this.scene.activeCamera.copyViewPlaneSize(e),KA(this.scene.activePage,this.shared),this.eventManager.activate(),this.eventManager.controlsManager.activate(this.eventManager)}};function En(e,t,r,i,n,s){let a={Audio:[],Video:[],Link:[],Destroy:[],Create:[],Reset:[],Transition:[],SwitchCamera:[],Animation:[],SceneTransition:[]};return t.forEach(({id:o,data:l})=>{try{l.type==="Audio"?ks[e.type].includes("Audio")&&a.Audio.push(new af(o,l,s,i)):l.type==="Video"?ks[e.type].includes("Video")&&a.Video.push(new ZA(o,l,s)):l.type==="Link"?ks[e.type].includes("Link")&&a.Link.push(new sfe(l,n)):l.type==="Create"?ks[e.type].includes("Create")&&a.Create.push(new uf(l,r,n.controlsManager)):l.type==="Destroy"?ks[e.type].includes("Destroy")&&a.Destroy.push(new Vk(l,r,n)):l.type==="Reset"?ks[e.type].includes("Reset")&&a.Reset.push(new Hk(l,r,i,n)):l.type==="Transition"?ks[e.type].includes("Transition")&&a.Transition.push(new lf(l,r,i)):l.type==="SwitchCamera"?ks[e.type].includes("SwitchCamera")&&a.SwitchCamera.push(new h8(l,r)):l.type==="SceneTransition"?ks[e.type].includes("SceneTransition")&&a.SceneTransition.push(new u8(l,r,n,i)):l.type==="Animation"&&ks[e.type].includes("Animation")&&a.Animation.push(new cf(l,r,n.animationControls))}catch{}}),a}function on(e){Object.values(e).forEach(t=>{t.forEach(r=>{(r instanceof af||r instanceof ZA||r instanceof cf||r instanceof lf||r instanceof uf||r instanceof Vk||r instanceof h8||r instanceof u8||r instanceof Hk)&&r.dispose()})})}function pme(e,t){let r;if("material"in e){let i=e.material;Array.isArray(i)?r=e.material[0].layers.find(n=>n.uuid===t):r=e.material.layers.find(n=>n.uuid===t)}if(r)return r.color.texture.image.img instanceof HTMLVideoElement?r.color.texture.image.img:void 0}var d8=new Map,hf=new Map,Du=class{constructor(e,t,r){this.data=t,this.delay=0,this.status="stopped";let{layerId:i,loop:n,volume:s,delay:a}=t;if(this.object=r,i===void 0)throw new Error("Missing property");let o=pme(r,i);o&&(this.videoElement=o,this.videoElement.loop=n===1/0,this.videoElement.autoplay=!0,s!==void 0&&(this.videoElement.volume=s)),a!==void 0&&(this.delay=a),hf.has(r.uuid)?hf.get(r.uuid).push(this):hf.set(r.uuid,[this]),d8.set(e,this),this.pause()}mute(){!this.videoElement||(this.videoElement.muted=!0)}unMute(){!this.videoElement||(this.videoElement.muted=!1)}play(e){if(!this.videoElement)return;let t=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);e?(this.mute(),this.delay+=150):t?(this.mute(),window.setTimeout(()=>{this.unMute()},100)):this.unMute(),this.delayTimerId=window.setTimeout(()=>{if(!this.videoElement)return;let r=this.videoElement.play();r!==void 0&&r.then(i=>{}).catch(i=>{this.play()}),this.clearDelay()},this.delay),this.status="playing"}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}pause(){!this.videoElement||(this.videoElement.pause(),this.status="paused")}stop(){!this.videoElement||(this.videoElement.pause(),this.videoElement.currentTime=0,this.status="stopped",this.clearDelay())}playByToggle(){this.data.toggle==="stop"?this.status==="playing"?this.stop():(this.stop(),this.play()):this.data.toggle==="pause"?this.status==="playing"?this.pause():this.play():(this.stop(),this.play())}dispose(){!this.videoElement||(this.stop(),this.videoElement.muted=!0)}},V_=class{constructor(e){this.data=e}dispatch(){this.data.playVideo?this.pauseVideo(this.data.playVideo):this.data.object?this.pauseAllVideosFromObject(this.data.object):this.pauseAllVideos()}pauseVideo(e){let t=d8.get(e);!t||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t[this.data.interaction](),this.disposeDelay()},this.data.delay)):t[this.data.interaction]())}pauseAllVideosFromObject(e){let t=hf.get(e);!(t!=null&&t.length)||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.forEach(r=>r[this.data.interaction]()),this.disposeDelay()},this.data.delay)):t.forEach(r=>r[this.data.interaction]()))}pauseAllVideos(){let e=[...hf.values()];!e.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{e.forEach(t=>{t.forEach(r=>{r[this.data.interaction]()})}),this.disposeDelay()},this.data.delay)):e.forEach(t=>{t.forEach(r=>{r[this.data.interaction]()})}))}disposeDelay(){clearTimeout(this.timeoutId),delete this.timeoutId}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},ZA=class{constructor(e,t,r){if(this.data=t,t.interaction==="play")this.interaction=new Du(e,t,r);else if(t.interaction==="pause"||t.interaction==="stop")this.interaction=new V_(t);else throw new Error("Missing property")}dispatchBasic(){this.interaction instanceof Du?this.interaction.playByToggle():this.interaction.dispatch()}dispatchConditional(){this.interaction instanceof Du?this.interaction.play():this.interaction.dispatch()}dispose(){this.interaction.dispose()}},D5=(()=>{let e,t,r,i;function n(o){!e&&!L5()&&(t==null?void 0:t.sharedGameControlGlobals.createdObjects.length)>0&&(e=requestAnimationFrame(s)),o&&(t=o,i=o.requestRender)}function s(o){let l=r?o-r:0,c=t.sharedGameControlGlobals.createdObjects,u=t.sharedGameControlGlobals.nCreatedPerAction,h=c.length,d=0;for(;d<h;){let p=c[d];p.userData.createdTime===void 0&&(p.userData.createdTime=o),p.userData.lifetime===void 0&&p.userData.quantity===void 0||p.userData.lifetime&&o-p.userData.createdTime<p.userData.lifetime||p.userData.quantity&&u[p.userData.actionId]<=p.userData.quantity?(p.userData.velocity&&(p.position.addScaledVector(p.userData.velocity,l/1e3),p.updateMatrix(),i()),d++):(u[p.userData.actionId]>p.userData.quantity&&u[p.userData.actionId]--,c.splice(d,1),p.removeFromParent(),t.sharedGameControlGlobals.rapierWorld&&p.rigidBody?(t.sharedGameControlGlobals.colliderToEntity.delete(p.rigidBody.collider(0).handle),t.sharedGameControlGlobals.rapierWorld.removeRigidBody(p.rigidBody)):(p.bvhGeometry=void 0,t.sharedGameControlGlobals.entitiesWithTransformAnim=t.sharedGameControlGlobals.entitiesWithTransformAnim.filter(f=>f.bvhGeometry!==void 0)),h--,i())}e=d>0?requestAnimationFrame(s):void 0,r=d>0?o:void 0}function a(){L5()?e&&(cancelAnimationFrame(e),e=void 0,r=void 0):n()}return typeof document<"u"&&document.addEventListener("visibilitychange",a),n})();function L5(){return!!document&&document.hidden}var I5=new ft,fme=new E,mme=new E,uf=class{constructor(e,t,r){this.data=e,this.page=t,this.controlsManager=r,this.intervalId=null,this.timeoutIdQueue=[],this.uniqueId=mt.generateUUID(),this.dispatch=()=>{this.data.delay?this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3)):this.dispatchInner()},this.dispatchFromStart=()=>{this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3))},this.dispatchThrottled=rae(this.dispatch,1e3/this.data.creationSpeed),this.dispatchStart=()=>{this.intervalId===null&&(this.intervalId=window.setInterval(this.dispatch,1e3/this.data.creationSpeed))},this.dispatchStop=()=>{this.intervalId!==null&&(window.clearInterval(this.intervalId),this.intervalId=null)},this.dispatchInner=()=>{this.timeoutIdQueue.shift();let n=new xi(this.object);if(n.playModeVisible=!0,n.expand(),this.data.coordinateSystem!=="world"){let a=this.data.coordinateSystem,o=this.page.scene.find(a);o&&(o.updateMatrixWorldSVD(),n.hiddenMatrix.copy(o.matrixWorldRigid))}n.position.fromArray(this.data.position),n.rotation.fromArray(this.data.rotation),n.updateMatrix(),this.page.add(n);let s=this.controlsManager.sharedGameControlGlobals;s.createdObjects.push(n),s.nCreatedPerAction[this.uniqueId]===void 0?s.nCreatedPerAction[this.uniqueId]=1:s.nCreatedPerAction[this.uniqueId]++,n.updateWorldMatrix(!0,!0),n.traverseObject(this.traverseObjectCB),D5(),this.controlsManager.requestRender()},this.traverseObjectCB=n=>{var l,c,u,h;n.hasNonUniformScale&&n.updateMatrixWorldSVD();let s;if(this.controlsManager.sharedGameControlGlobals.rapierWorld){if(n instanceof As)if(n.objectForSample){if(n.objectForSample.dataPatched.physics.fusedBody)return;s=n.object}else return n.object.dataPatched.physics.fusedBody===!0&&n.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(n instanceof xi)s=n.object;else if(s=n,(l=s.dataPatched.cloner)==null?void 0:l.hideBase)return!0}else{if(n instanceof As)return;n instanceof xi?s=n.object:s=n}this.data.destroy==="Time"?n.userData.lifetime=this.data.lifetime*1e3:this.data.destroy==="Quantity"&&(n.userData.quantity=this.data.destroyAfterQuantity,n.userData.actionId=this.uniqueId);let a=new E().fromArray(this.data.velocity),o=s.dataPatched;if(!(o.physics.enabled==="visibility"?!o.visible:!o.physics.enabled)&&(this.controlsManager.sharedGameControlGlobals.rapierWorld?(this.controlsManager.addRigidBody(n,s,{fromCreate:!0,dynamic:this.data.dynamic}),this.data.destroy==="Collision"&&((c=n.rigidBody)==null||c.collider(0).setActiveEvents(1),n.userData.hasCollisionDestroy=!0),n.matrixWorld.decompose(fme,I5,mme),a.applyQuaternion(I5),this.data.velocity.some(d=>d!==0)&&this.data.dynamic&&((u=n.rigidBody)==null||u.setLinvel(a.divideScalar(this.controlsManager.pixelsPerMeter),!0))):("geometry"in n.object&&this.controlsManager.addBoundsTree(n),this.data.velocity.some(d=>d!==0)&&this.data.dynamic&&(n.userData.velocity=a)),((h=s.dataPatched.physics)==null?void 0:h.fusedBody)===!0))return!0};let i=this.page.scene.find(this.data.object);if(!i)throw new Error("Missing Property");if(this.object=i,this.data.coordinateSystem!=="world"&&!this.page.scene.find(this.data.coordinateSystem))throw new Error("Missing Property");D5(r)}dispose(){this.intervalId!==null&&(window.clearInterval(this.intervalId),this.intervalId=null),this.timeoutIdQueue.forEach(e=>window.clearTimeout(e)),this.dispatchThrottled.cancel(),this.page.remove(...this.controlsManager.sharedGameControlGlobals.createdObjects),this.controlsManager.sharedGameControlGlobals.createdObjects=[]}},p8=200,Iw=.02,Ow=.3,gme=65;new E;var O5=new E,R5=new E,vme=new E,si=new E,Ei=new E,Do=new E,rv=new _e,Rw=new _e,yme=new _e;new _e;var pn=new ft,La=new ft,Hs=new Zr(0,0,0,"YXZ"),xme=new E(1,0,0),ds=new E(0,1,0),wme=new E(0,0,1),Bw=new E(1,1,1),zw=new Mn,bme=1,_me=.025,Sme=16e-6,B5=12,Ame=20,Yr=new Zn,Bn=new Ar,Cme={type:"requestRender"},Mme={type:"updateMatrix"},z5=Math.PI/6,H_=class extends ui{constructor(e,t,r,i,n,s,a,o,l){var f;super(),this.object=e,this.domElement=t,this.data=r,this.gloabalPhysics=i,this.controlsManager=n,this.cameraFollow=s,this.camera=a,this.page=o,this.sharedAssets=l,this.enableDamping=!0,this.hiddenMatrix0=new _e,this.target0=new E,this.zoom0=1,this.rotForce=1,this.moveForce=1,this.pixelsPerMeter=p8,this.euler0=new Zr(0,0,0,"YXZ"),this.position0Cam=new E,this.quat0Cam=new ft,this.scale0Cam=new E,this.hiddenMatrix0Cam=new _e,this.threshEndTranslate=.01,this.threshEndRotate=1e-8,this.threshEndRotVel=.005,this.collider={type:"capsule",radius:40,segment:new Zn(new E(0,-40,0),new E(0,40,0)),matrix:new _e,position:new E,rotation:new ft},this.euler=new Zr(0,0,0,"YXZ"),this.eulerDelta=new E,this.lastPosition=new E,this.lastCameraQuaternion=new ft,this.lastCameraPosition=new E,this.PI_2=Math.PI/2,this.prevMouse=new W,this.velocityTarget=new E,this.velocity=new E,this.directionXZ=new E,this.rotVelocityStick=new E,this.rotVelocityTarget=new E,this.rotVelocity=new E,this.rotDirection=new E,this.nonColliderRotOffset=new _e,this.nonColliderPosOffset=new _e,this.firstPointerId=-1,this.rot=new E,this.path=[],this.movementState={moveNegZ:0,movePosZ:0,moveNegX:0,movePosX:0,moveNegY:0,movePosY:0,rotPosX:0,rotNegX:0,rotPosY:0,rotNegY:0,jump:0,run:0},this.vrEulerYOffset=0,this.onObject=!1,this.actionState={},this.keyAssignments=[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX","ArrowUp"],["rotPosY","ArrowLeft"],["rotNegX","ArrowDown"],["rotNegY","ArrowRight"],["jump"," "]],this.collisionEnabled=!0,this.offsetMatrix=new _e,this.objectToTarget=new E,this.objectToTarget0=new E,this.objectToCamXZ=new E,this.objectToCamXZ0=new E,this.targetToCamera=new E,this.targetToCamera0=new E,this.cameraPolarAxis0=new E,this.targetPos=new E,this.targetQuat=new ft,this.lerpFactorPos=new E().setScalar(.3),this.lerpFactorPosStart=.3,this.lerpFactorPosEnd=.3,this.lerpFactorRotStart=.3,this.lerpFactorRotEnd=.3,this.lerpFactorPosCamera=.3,this.lerpFactorRotCamera=.3,this.objXZQuat=new ft,this.objXZQuatInv=new ft,this.objXZRotMat=new _e,this.isFirstPerson=!1,this.actions={},this.didHit=!1,this.groundVelocity=new E,this.pushedVelocity=new E,this.groundYRotation=0,this.objectRealQuat=new ft,this.colliderWorldQuat=new ft,this.groundNormal=new E,this.groundTilt=new ft,this.groundTiltInv=new ft,this.lastHitObj=null,this.isFirstFrame=!0,this.rotationAccumWhenOrientWithCamera=0,this.navMeshPathDest=null,this.position=new E,this.quaternion=new ft,this.scale=new E,this.initialAction=!0,this.onPointerDown=m=>{m.target!==this.domElement||this.firstPointerId!==-1||(this.firstPointerId=m.pointerId,this.domElement.ownerDocument.addEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.addEventListener("pointerup",this.onPointerUp),this.rotBy!=="keys"&&!wn&&(!e4||t4>=15.5)&&this.domElement.requestPointerLock(),this.prevMouse.set(m.clientX,m.clientY))},this.onPointerUp=m=>{this.firstPointerId=-1,this.domElement.ownerDocument.removeEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this.onPointerUp),m.pointerType==="mouse"&&this.domElement.ownerDocument.exitPointerLock()},this.onPointerMove=m=>{if(m.pointerId!==this.firstPointerId)return;let g=m.clientX-this.prevMouse.x,v=m.clientY-this.prevMouse.y;this.prevMouse.set(m.clientX,m.clientY),m.pointerType==="mouse"&&this.rotBy!=="keys"&&(e4&&t4<15.5&&!wn?(this.eulerDelta.y=-g*this.mouseOrbitSensitivity,this.eulerDelta.x=-v*this.mouseOrbitSensitivity):(this.eulerDelta.y=-m.movementX*this.mouseOrbitSensitivity,this.eulerDelta.x=-m.movementY*this.mouseOrbitSensitivity)),m.pointerType!=="mouse"&&this.rotByTouch==="drag"&&(this.eulerDelta.y=-g*this.mouseOrbitSensitivity*5,this.eulerDelta.x=-v*this.mouseOrbitSensitivity*5),this.controlsManager.requestRender()},this.onPointerlockChange=m=>{this.domElement.ownerDocument.pointerLockElement===this.domElement?H_.isLocked=!0:H_.isLocked=!1},this.onPointerlockError=()=>{console.error("SPE.GameControls: Unable to use Pointer Lock API")},this.handleVisibilityChange=()=>{if(document!=null&&document.hidden)for(let m in this.movementState)this.movementState[m]=0},this.onKeyDown=m=>{!(m.target instanceof HTMLInputElement)&&(m.code==="ArrowLeft"||m.code==="ArrowUp"||m.code==="ArrowRight"||m.code==="ArrowDown"||m.code==="Space")&&m.preventDefault();for(let g of this.keyAssignments)if(m.key.toUpperCase()===g[1]||m.key===g[1]){this.movementState[g[0]]=1;break}this.controlsManager.requestRender()},this.onKeyUp=m=>{for(let g of this.keyAssignments)if(m.key.toUpperCase()===g[1]||m.key===g[1]||m.code.slice(3,m.code.length).toUpperCase()===g[1]){this.movementState[g[0]]=0;break}},this.copyVRGamePadValues=(m,g)=>{for(let v=2;v<4;v++){let y=m.axes[v];g===0?v===2?this.movementState.movePosX=y:this.movementState.movePosZ=y:(m.buttons[3].pressed?this.movementState.jump=1:this.movementState.jump=0,v===2?(Math.abs(this.movementState.rotPosY)<.3&&Math.abs(y)>=.3&&(this.vrEulerYOffset+=y<0?1:-1),this.movementState.rotPosY=y):this.moveMode==="fly"&&(this.movementState.moveNegY=y))}},this.sharedGameControlGlobals=n.sharedGameControlGlobals,e===a&&(this.isFirstPerson=!0),this.hiddenMatrix0.copy(this.object.hiddenMatrix),this.object.parent?this.object.hiddenMatrix.copy(this.object.parent.matrixWorld).invert():this.object.hiddenMatrix.identity(),this.object.matrix.copy(this.object.matrixWorld),this.object.matrix.decompose(this.position,this.quaternion,this.scale),this.euler0.setFromQuaternion(this.quaternion,"YXZ");let c=this.euler0.clone(),u=c.y;if(this.objectRealQuat.copy(this.quaternion),c.y=0,this.quaternion.setFromEuler(c),this.objXZQuat.copy(this.quaternion),this.objXZQuatInv.copy(this.objXZQuat).invert(),this.objXZRotMat.makeRotationFromQuaternion(this.quaternion),c.set(0,u,0),this.quaternion.setFromEuler(c),this.rot.setFromEuler(c),this.object.matrixAutoUpdate=!1,(this.isFirstPerson||this.cameraFollow===!0)&&(this.target0.copy(this.camera.getTarget()),this.zoom0=this.camera.zoom),this.cameraFollow===!0){this.position0Cam.copy(this.camera.position),this.quat0Cam.copy(this.camera.quaternion),this.scale0Cam.copy(this.camera.scale),this.hiddenMatrix0Cam.copy(this.camera.hiddenMatrix),this.camera.parent?(this.camera.hiddenMatrix.copy((f=this.camera)==null?void 0:f.parent.matrixWorld),this.camera.matrix.copy(this.camera.matrixWorld)):this.camera.hiddenMatrix.identity(),this.camera.matrix.copy(this.camera.matrixWorld),this.camera.matrix.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.matrixAutoUpdate=!1,this.offsetMatrix.copy(this.object.matrix).invert().multiply(this.camera.matrix);let m=new E(0,0,-1).applyQuaternion(this.camera.quaternion),g=new E().subVectors(this.position,this.camera.position);this.objectToCamXZ.copy(g),this.objectToCamXZ.y=0,this.objectToCamXZ0.copy(this.objectToCamXZ);let v,y;Math.abs(m.y)<1e-6?(g.y=0,m.y=0,y=g.projectOnVector(m)):g.y/m.y>0?y=m.multiplyScalar(g.y/m.y):y=m.multiplyScalar(g.length()),this.targetToCamera0.copy(y).negate(),v=this.camera.position.clone().add(y),this.objectToTarget0.subVectors(v,this.position);let x=new Zr().setFromQuaternion(this.camera.quaternion,"YXZ");this.cameraPolarOffset=-x.x,x.x=0,x.z=0,x.y-=Math.PI/2,this.cameraPolarAxis0.set(0,0,-1).applyEuler(x)}if(this.object instanceof bi&&(this.object.matrixAutoUpdate=!1),this.euler.setFromQuaternion(this.quaternion,"YXZ"),this.rotByTouch=r.rotByTouch??"joystick",this.rotBy=r.rotBy??"keys",this.rotationMode=r.rotationMode??"normal",this.moveMode=r.moveMode??"walk",this.collisionEnabled=r.collisionEnabled,this.speedTranslate=(r.speedTranslate??250)*bme,this.speedOrbit=(r.speedRotate??100)*_me,this.mouseOrbitSensitivity=(r.speedRotate??100)*Sme,this.keyAssignments=r.keyAssignments.map(m=>{let g=[m[0],m[1]];return g[1]==="▲"?g[1]="ArrowUp":g[1]==="◀"?g[1]="ArrowLeft":g[1]==="▼"?g[1]="ArrowDown":g[1]==="▶"?g[1]="ArrowRight":g[1]==="⇧"?g[1]="Shift":g[1]==="↵"?g[1]="Enter":g[1]==="Space"?g[1]=" ":g[1]==="⌘"?g[1]="Meta":g[1]==="Ctrl"?g[1]="Control":g[1]==="Esc"&&(g[1]="Escape"),g}),r.rotBy==="mouse"){let m;m=this.keyAssignments.findIndex(g=>g[0]==="rotNegX"),m!==-1&&(this.keyAssignments[m][1]=""),m=this.keyAssignments.findIndex(g=>g[0]==="rotPosX"),m!==-1&&(this.keyAssignments[m][1]=""),m=this.keyAssignments.findIndex(g=>g[0]==="rotPosY"),m!==-1&&(this.keyAssignments[m][1]=""),m=this.keyAssignments.findIndex(g=>g[0]==="rotNegY"),m!==-1&&(this.keyAssignments[m][1]="")}this.lerpFactorPosStart=1-.02**(1/((r.delayPos[0]??.3)*60)),this.lerpFactorPosEnd=1-.02**(1/((r.delayPos[1]??.3)*60)),this.lerpFactorPos.setScalar(this.lerpFactorPosStart),this.lerpFactorRotStart=1-.02**(1/((r.delayRot[0]??.3)*60)),this.lerpFactorRotEnd=1-.02**(1/((r.delayRot[1]??.3)*60)),this.lerpFactorPosCamera=1-.02**(1/((r.delayPosCamera??.3)*60)),this.lerpFactorRotCamera=1-.02**(1/((r.delayRotCamera??.3)*60)),this.gravity=(this.gloabalPhysics.gravity??$u.defaultData.gravity)*B5,this.usePhysics=this.gloabalPhysics.usePhysics??$u.defaultData.usePhysics,this.jumpPower=r.jumpPower*Ame,this.resetYPosition=this.position.y+Math.abs(r.resetYPosition)*(this.gravity>0?1:-1),this.alignToGround=r.alignToGround??!1,this.orientMode=r.autoOrientMove?r.orientMode:"none",this.orientWith=r.orientWith??Z0.defaultDataThirdPerson.orientWith,this.slopeThresh=gme*Math.PI/180,r.collider.type==="capsule"?(this.collider.radius=r.collider.radius,this.collider.segment.start.y=r.collider.height/2-r.collider.radius,this.collider.segment.end.y=-this.collider.segment.start.y,this.offset=r.collider.height*Iw/this.pixelsPerMeter,this.stepThresh=r.collider.height*Ow/this.pixelsPerMeter,this.colliderHeight=r.collider.height):r.collider.type==="sphere"?(this.collider.radius=r.collider.radius,this.collider.segment.start.y=0,this.collider.segment.end.y=0,this.offset=2*r.collider.radius*Iw/this.pixelsPerMeter,this.stepThresh=2*r.collider.radius*Ow/this.pixelsPerMeter,this.colliderHeight=r.collider.radius*2):(this.offset=r.collider.height*Iw/this.pixelsPerMeter,this.stepThresh=r.collider.height*Ow/this.pixelsPerMeter,this.colliderHeight=r.collider.height),this.collider.type=r.collider.type;let h=new E().fromArray(r.collider.position),d=new ft().setFromEuler(new Zr().fromArray([...r.collider.rotation,"XYZ"]));this.collider.position.copy(h).multiply(this.scale),this.collider.rotation.copy(d),this.collider.matrix.compose(h,d,Bw),r.cameraXAxis!==void 0&&(this.cameraXAxis=r.cameraXAxis,this.cameraYAxis=r.cameraYAxis,this.minPolarAngle=r.cameraRotXLimits[0],this.maxPolarAngle=r.cameraRotXLimits[1],this.minAzimuthAngleRel=r.cameraRotYLimits[0],this.maxAzimuthAngleRel=r.cameraRotYLimits[1]),this.forwardDir=r.forwardDirection??"-z",this.runMultiplier=r.runMultiplier??2;let p=r.navmesh.destinationHelperRadius*2;if(p>0){let m=new st;m.push({fi:0,data:{...Wi.defaultData("light","phong"),alpha:0},id:"layer1"}),m.push({fi:0,data:{...Wi.defaultData("color"),color:r.navmesh.destinationHelperColor,alpha:r.navmesh.destinationHelperColor.a},id:"layer2"});let g=new TA({layers:m},{scene:this.page.scene,shared:this.sharedAssets});this.navMeshPathDest=new Ki(gz.create({parameters:{width:p,height:p/10,hollow:.7}}),g),this.navMeshPathDest.material.userData.opacity0=r.navmesh.destinationHelperColor.a}this.activate()}reset(e=!1){if(this.object.hiddenMatrix.copy(this.hiddenMatrix0),e){this.object.updateMatrix(),this.object.updateMatrixWorld(),this.object.matrix.copy(this.object.matrixWorld),this.object.matrix.decompose(this.position,this.quaternion,this.scale),this.object.parent?this.object.hiddenMatrix.copy(this.object.parent.matrixWorld).invert():this.object.hiddenMatrix.identity();let t=new Zr().setFromQuaternion(this.quaternion,"YXZ"),r=t.y;this.objectRealQuat.copy(this.quaternion),t.y=0,this.quaternion.setFromEuler(t),this.objXZQuat.copy(this.quaternion),this.objXZQuatInv.copy(this.objXZQuat).invert(),this.objXZRotMat.makeRotationFromQuaternion(this.quaternion),t.set(0,r,0),this.quaternion.setFromEuler(t),this.rot.setFromEuler(t),this.euler.setFromQuaternion(this.quaternion,"YXZ"),this.velocityTarget.set(0,0,0),this.velocity.set(0,0,0)}else this.object instanceof bi?this.object.matrixAutoUpdate=!0:this.object.updateMatrix();this.cameraFollow===!0&&(this.camera.quaternion.copy(this.quat0Cam),this.camera.position.copy(this.position0Cam),this.camera.scale.copy(this.scale0Cam),this.camera.hiddenMatrix.copy(this.hiddenMatrix0Cam),this.camera.matrixAutoUpdate=!0),this.controlsManager.requestRender()}activate(){this.instantiateActions(),this.domElement.ownerDocument.addEventListener("pointerdown",this.onPointerDown),this.domElement.ownerDocument.addEventListener("keydown",this.onKeyDown),this.domElement.ownerDocument.addEventListener("keyup",this.onKeyUp),this.domElement.ownerDocument.addEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.addEventListener("pointerlockerror",this.onPointerlockError),this.domElement.ownerDocument.addEventListener("visibilitychange",this.handleVisibilityChange)}deactivate(){this.disposeActions(),this.domElement.ownerDocument.removeEventListener("pointerdown",this.onPointerDown),this.domElement.ownerDocument.removeEventListener("keydown",this.onKeyDown),this.domElement.ownerDocument.removeEventListener("keyup",this.onKeyUp),this.domElement.ownerDocument.removeEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.removeEventListener("pointerlockerror",this.onPointerlockError),this.domElement.ownerDocument.removeEventListener("visibilitychange",this.handleVisibilityChange)}dispose(){var e;this.deactivate(),(e=this.navMeshPathDest)!=null&&e.parent&&this.page.remove(this.navMeshPathDest)}instantiateActions(){let e=this.data,t=this.page,r=this.sharedAssets,i=this.object;e.gameActions!==void 0&&Object.entries(e.gameActions).forEach(([n,s],a)=>{s.forEach(({id:o,data:l})=>{try{this.actions[n]===void 0&&(this.actions[n]=[]),l.type==="Transition"?this.actions[n].push(new lf(l,t,r)):l.type==="Animation"?this.actions[n].push(new cf(l,t,this.controlsManager.eventManager.animationControls)):l.type==="Audio"?this.actions[n].push(new af(o,l,i,r)):l.type==="Video"?this.actions[n].push(new ZA(o,l,i)):l.type==="Create"&&this.actions[n].push(new uf(l,t,this.controlsManager))}catch{}})}),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),this.dispatchStartEvent("idle"),this.initialAction&&(this.initialAction=!1)}disposeActions(){this.initialAction=!1,this.dispatchStopEvent("idle"),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),on(this.actions)}dispatchStartEvent(e){this.actions[e]!==void 0&&(this.actionState[e]||(this.actionState[e]=!0,this.actions[e].forEach(t=>{t instanceof lf?t.play():t instanceof cf?t.play(this.initialAction===!1):t instanceof uf?t.dispatchStart():t instanceof af&&t.dispatchGameControl("start")})))}dispatchStopEvent(e){this.actions[e]!==void 0&&(!this.actionState[e]||(this.actionState[e]=!1,this.actions[e].forEach(t=>{t instanceof lf?(t.stop(),t.object.currentState!==null&&t.object.changeSelectedState(null,{scene:this.page.scene,shared:this.sharedAssets})):t instanceof cf||(t instanceof uf?t.dispatchStop():t instanceof af&&t.dispatchGameControl("stop"))})))}get colliderWorldPosition(){return si.copy(this.collider.position).applyQuaternion(this.objectRealQuat).add(this.position)}update(e,t,r){var o,l,c,u,h,d,p,f,m,g,v;if(this.gravity<0?this.position.y<this.resetYPosition:this.position.y>this.resetYPosition)return this.reset(!0),!0;this.sharedGameControlGlobals.gamePads.forEach(this.copyVRGamePadValues);let i=(this.isFirstFrame?16.6:e)/1e3;this.isFirstFrame&&(this.isFirstFrame=!1);let n=i*60,s=!1;if(this.usePhysics&&this.collisionEnabled){let y=Ei.set(0,(this.velocity.y===0?this.pixelsPerMeter*Math.max(Math.abs(this.gravity)/(10*B5),1)*(this.gravity>0?1:-1):this.velocity.y)*i,0).divideScalar(this.pixelsPerMeter),x=this.sharedGameControlGlobals.rapierWorld.castShape(this.colliderWorldPosition.divideScalar(this.pixelsPerMeter),this.colliderWorldQuat,y,(o=this.object.rigidBody)==null?void 0:o.collider(0).shape,1,!1,16,void 0,void 0,this.object.rigidBody);if(x){this.onObject=!0,this.groundNormal.set(x.normal2.x,x.normal2.y,x.normal2.z).applyQuaternion(this.colliderWorldQuat).negate(),this.alignToGround&&this.groundTiltAdjustment(this.groundNormal),Math.acos(this.groundNormal.y)<this.slopeThresh&&(s=!0),((l=x.collider.parent())==null?void 0:l.bodyType())===0&&Math.acos(this.groundNormal.y)*(180/Math.PI)>45&&(this.onObject=!1);let w=x.collider.parent();this.groundYRotation=0,this.groundVelocity.set(0,0,0);for(let b of this.sharedGameControlGlobals.entitiesWithTransformAnim)if(b.rigidBody===w&&b.userData.isFollowingObj!==this.object.uuid){(b.hasNonUniformScale?b.matrixWorldRigid:b.matrixWorld).decompose(si,La,Ei),this.groundVelocity.subVectors(si,b.prevT),this.object.getWorldPosition(Ei).add(this.collider.position).sub(si),this.groundYRotation=Hs.setFromQuaternion(La).y-b.prevR.y,Do.copy(Ei).applyAxisAngle(ds,this.groundYRotation),this.groundVelocity.add(Do.sub(Ei)).divideScalar(i);break}}else this.onObject=!1}if(this.moveMode==="walk"&&this.collisionEnabled&&(this.movementState.jump===1&&this.onObject&&(this.velocityTarget.y=this.jumpPower,this.movementState.jump=0,this.dispatchStopEvent("idle"),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),this.dispatchStartEvent("jump"),this.onObject=!1),this.onObject?this.velocityTarget.y/=2:this.velocityTarget.y+=this.gravity*n),this.moveMode==="fly"&&(this.velocityTarget.y=(this.movementState.movePosY-this.movementState.moveNegY)*this.speedTranslate),this.directionXZ.z=this.movementState.movePosZ-this.movementState.moveNegZ,this.directionXZ.x=this.movementState.movePosX-this.movementState.moveNegX,this.forwardDir==="+z"&&this.directionXZ.multiplyScalar(-1),this.directionXZ.manhattanLength()>0&&(this.path=[]),this.navMeshPathDest){let y=this.navMeshPathDest.material;if(this.moveMode==="walk"&&this.path.length>1){this.navMeshPathDest.position.copy(this.path[this.path.length-1]),this.navMeshPathDest.parent||this.page.add(this.navMeshPathDest);let x=si.subVectors(this.path[1],this.position),w=Ei.subVectors(this.path[1],this.path[0]);x.dot(w)<0?this.path.shift():(this.directionXZ.x=w.x,this.directionXZ.z=w.z),y.opacity=y.userData.opacity0}else y.opacity-=.05*y.userData.opacity0,this.navMeshPathDest.material.opacity<=0&&this.navMeshPathDest.parent&&this.page.remove(this.navMeshPathDest)}this.directionXZ.normalize(),this.movementState.run?this.moveForce=this.runMultiplier:this.moveForce=1,this.velocityTarget.z=this.directionXZ.z*this.speedTranslate*this.moveForce,this.velocityTarget.x=this.directionXZ.x*this.speedTranslate*this.moveForce,(this.moveMode==="walk"?this.velocityTarget.x+this.velocityTarget.z===0:this.velocityTarget.manhattanLength()===0)?this.lerpFactorPos.setScalar(this.lerpFactorPosEnd):this.lerpFactorPos.setScalar(this.lerpFactorPosStart),this.moveMode==="walk"&&(this.lerpFactorPos.y=1),this.didHit===!1&&this.pushedVelocity.manhattanLength()===0||this.usePhysics===!1?(this.velocity.x+=(this.velocityTarget.x-this.velocity.x)*(1-(1-this.lerpFactorPos.x)**n),this.velocity.y+=(this.velocityTarget.y-this.velocity.y)*(1-(1-this.lerpFactorPos.y)**n),this.velocity.z+=(this.velocityTarget.z-this.velocity.z)*(1-(1-this.lerpFactorPos.z)**n)):this.velocity.copy(this.velocityTarget),(this.moveMode==="walk"?this.velocity.x**2+this.velocity.z**2<this.speedTranslate:this.velocity.lengthSq()<this.speedTranslate)?(this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.onObject&&(this.dispatchStopEvent("jump"),this.dispatchStartEvent("idle"))):(this.dispatchStopEvent("idle"),this.onObject&&(this.dispatchStopEvent("jump"),this.movementState.run?(this.dispatchStopEvent("move"),this.dispatchStartEvent("run")):(this.dispatchStopEvent("run"),this.dispatchStartEvent("move"))));let a=vme.copy(this.velocity);if(this.orientMode!=="none"&&this.isFirstPerson===!1){let y=Ei.copy(a);y.y=0,a.set(0,a.y,y.length()*(this.forwardDir==="+z"?1:-1))}if(this.directionXZ.manhattanLength()>0&&this.orientMode!=="none")if(this.orientWith==="camera"&&this.path.length<=1){let y=si;this.camera.getWorldDirection(y);let x=Do.copy(ds).multiplyScalar(y.dot(ds));y.sub(x);let w=Ei.copy(this.directionXZ);w.x*=-1,this.rot.y=y.angleTo(w)*(y.cross(w).y>0?-1:1)+this.rotationAccumWhenOrientWithCamera}else this.rot.y=(this.path.length>1?0:this.euler.y)+Math.atan2(-this.directionXZ.z,this.directionXZ.x)+Math.PI/2*(this.forwardDir==="+z"?1:-1);if(Hs.setFromVector3(this.rot),this.moveMode==="walk"&&(Hs.x=0),a.applyEuler(Hs),s&&(La.setFromUnitVectors(ds,this.groundNormal),a.applyQuaternion(La)),r){let y=Hs.set(0,this.vrEulerYOffset*z5,0);r.applyEuler(y),a.x+=r.x,a.z+=r.z,this.nonColliderPosOffset.elements[13]+=r.y*i}if(this.usePhysics===!0){let y=Ei;this.pushedVelocity.set(0,0,0);for(let x of this.sharedGameControlGlobals.entitiesWithTransformAnim){let w=Do.setFromMatrixPosition(x.matrixWorld).sub(x.prevT).divideScalar(i).divideScalar(this.pixelsPerMeter),b=x.rigidBody.collider(0).castCollider(w,this.object.rigidBody.collider(0),si.copy(a).divideScalar(this.pixelsPerMeter),i,!1);w.multiplyScalar(this.pixelsPerMeter);let _=Mt.is(x)?x:x.object;if(b!==null&&this.lastHitObj!==_){let A;x instanceof xi&&(A=x);let S=this.sharedGameControlGlobals.entityToCollisionEvents[_.uuid];if(S)for(let C of S)C.data.target==="character"&&(C.dispatch(A),_.dispatchEvent(q_));this.lastHitObj=_}if(b!==null){this.pushedVelocity.copy(w),y.copy(b.normal1).applyQuaternion(x.quaternion);break}}if(this.pushedVelocity.manhattanLength()!==0){let x=y.dot(a);x<0&&a.addScaledVector(y,-x),a.add(this.pushedVelocity)}else a.add(this.groundVelocity)}if(this.rotDirection.y=Number(this.movementState.rotPosY)-Number(this.movementState.rotNegY),this.rotDirection.x=Number(this.movementState.rotPosX)-Number(this.movementState.rotNegX),this.rotDirection.normalize(),this.rotationMode==="normal"&&(this.movementState.rotPosX||this.movementState.rotNegX)||this.rotationMode==="steer"&&(this.movementState.rotPosX||this.movementState.rotNegX)&&(this.movementState.movePosZ||this.movementState.moveNegZ||this.moveMode==="walk")?this.rotVelocityStick.x=-this.rotDirection.x*this.speedOrbit*this.rotForce:this.rotVelocityStick.x=0,this.rotationMode==="normal"&&(this.movementState.rotPosY||this.movementState.rotNegY)||this.rotationMode==="steer"&&(this.movementState.rotPosY||this.movementState.rotNegY)&&(this.movementState.movePosZ||this.movementState.moveNegZ)?this.rotVelocityStick.y=-this.rotDirection.y*this.speedOrbit*this.rotForce:this.rotVelocityStick.y=0,this.rotVelocityTarget.subVectors(this.eulerDelta.divideScalar(i),this.rotVelocityStick),this.rotVelocityTarget.manhattanLength()===0?this.rotVelocity.lerp(this.rotVelocityTarget,1-(1-this.lerpFactorRotEnd)**n):this.rotVelocity.lerp(this.rotVelocityTarget,1-(1-this.lerpFactorRotStart)**n),this.euler.x+=this.rotVelocity.x*i,this.euler.y+=this.rotVelocity.y*i+this.groundYRotation,this.rotVelocityTarget.y===0&&this.directionXZ.manhattanLength()===0?this.rotationAccumWhenOrientWithCamera=0:(this.cameraFollow===!1||this.cameraYAxis==="Locked")&&(this.rotationAccumWhenOrientWithCamera+=this.rotVelocity.y*i),this.isFirstPerson===!1&&this.orientMode!=="none"&&this.directionXZ.manhattanLength()>0){if(this.orientMode==="radial"){this.objectToCamXZ.copy(this.objectToCamXZ0).applyAxisAngle(ds,this.euler.y-this.euler0.y);let y=Ei.copy(this.objectToCamXZ).normalize(),x=Do.copy(a).multiplyScalar(i);x.y=0;let w=x.sub(si.copy(y).multiplyScalar(x.dot(y))).cross(y).y;this.euler.y-=Math.atan2(w,this.objectToCamXZ.length())}}else this.rot.y+=this.rotVelocity.y*i+this.groundYRotation,this.rotVelocityTarget.y!==0&&(this.cameraFollow===!1||this.cameraYAxis==="Locked")&&(this.euler.y=this.rot.y);if(this.cameraFollow===!0&&(this.moveMode==="walk"?this.cameraXAxis==="Limit"?this.euler.x=mt.clamp(this.euler.x,-this.maxPolarAngle+this.cameraPolarOffset+1e-6,-this.minPolarAngle+this.cameraPolarOffset-1e-6):this.euler.x=mt.clamp(this.euler.x,-this.PI_2+this.cameraPolarOffset,this.PI_2+this.cameraPolarOffset):this.cameraXAxis==="Limit"&&(this.euler.x=mt.clamp(this.euler.x,-this.PI_2,this.PI_2))),this.moveMode==="fly"?this.rot.x=this.euler.x:this.isFirstPerson&&(t?(Hs.copy(t),Hs.y=0):(Hs.copy(this.euler),Hs.y=0),this.nonColliderRotOffset.makeRotationFromEuler(Hs)),t&&(this.moveMode==="walk"?(this.rot.y=t.y,this.rot.x=0,this.rot.z=0):this.rot.setFromEuler(t),this.rot.y+=this.vrEulerYOffset*z5),pn.setFromAxisAngle(xme,this.rot.x),La.setFromAxisAngle(ds,this.rot.y),La.multiply(pn),pn.setFromAxisAngle(wme,this.rot.z),La.multiply(pn),this.quaternion.copy(La),this.objectRealQuat.multiplyQuaternions(this.quaternion,this.objXZQuat),this.objectRealQuat.multiply(this.objXZQuat),this.colliderWorldQuat.copy(this.objectRealQuat).multiply(this.collider.rotation),this.collisionEnabled)if(this.usePhysics){let y=Ei.copy(a).multiplyScalar(i/this.pixelsPerMeter),x=null;this.didHit=!1;let w=new E;for(let b=0;b<5;b++){let _=y.length(),A=Do.copy(y).normalize();if(x=this.sharedGameControlGlobals.rapierWorld.castShape(this.colliderWorldPosition.divideScalar(this.pixelsPerMeter).add(w),this.colliderWorldQuat,A,(c=this.object.rigidBody)==null?void 0:c.collider(0).shape,_,!1,24,void 0,void 0,this.object.rigidBody),x!==null){this.didHit=!0;let S=this.sharedGameControlGlobals.colliderToEntity.get(x.collider.handle);if(S!==this.lastHitObj&&b===0){this.lastHitObj=S;let P=this.sharedGameControlGlobals.entityToCollisionEvents[S==null?void 0:S.uuid];if(P){for(let D of P)if(D.data.target==="character"){let I=((u=this.sharedGameControlGlobals.rapierWorld)==null?void 0:u.getCollider(x.collider.handle))._parent,B;if(S.cloner){for(let X of S.cloner.children)if(X.rigidBody===I){B=X;break}}D.dispatch(B),S.dispatchEvent(q_)}}}let C=O5.set(x.normal2.x,x.normal2.y,x.normal2.z).applyQuaternion(this.colliderWorldQuat),M=R5.copy(A).multiplyScalar(x.toi).dot(C),T=x.toi;if(T===0&&(this.position.y+=this.offset*this.pixelsPerMeter),M>this.offset&&(T=x.toi*(M-this.offset)/M,w.addScaledVector(A,T)),y.copy(A).multiplyScalar(_-T),Math.acos(-C.y)>this.slopeThresh){let P=this.colliderWorldPosition.divideScalar(this.pixelsPerMeter).add(w),D=Do.copy(x.witness2).applyQuaternion(this.colliderWorldQuat);D.y=0;let I=P.add(D);I.y+=this.stepThresh;let B=this.sharedGameControlGlobals.rapierWorld.castShape(I,this.colliderWorldQuat,y,(h=this.object.rigidBody)==null?void 0:h.collider(0).shape,1,!1,24,void 0,void 0,this.object.rigidBody);B!==null&&B.toi===0&&(C.y=0,C.normalize())}y.addScaledVector(C,-y.dot(C))}else{b===0&&this.directionXZ.manhattanLength()!==0&&(this.lastHitObj=null),w.add(y);break}}this.position.addScaledVector(w,this.pixelsPerMeter),(d=this.object.rigidBody)==null||d.setTranslation(si.copy(this.position).divideScalar(this.pixelsPerMeter),!0),(p=this.object.rigidBody)==null||p.setRotation(pn.copy(this.quaternion).premultiply(this.groundTilt).multiply(this.objXZQuat),!0)}else{let y=this.onObject?1:5,x=a.multiplyScalar(i/y);for(let w=0;w<y;w++)this.position.add(x),w===0&&this.checkTrigger(),this.collisionAdjustment(i/y)}else this.position.addScaledVector(a,i);if(this.moveMode==="walk"&&this.onObject&&(this.velocityTarget.y=0,this.velocity.y=0),this.quaternion.premultiply(this.groundTilt).multiply(this.objXZQuat),this.object.matrix.compose(this.position,this.quaternion,this.scale),this.object.matrixWorldNeedsUpdate=!0,this.object.matrix.multiply(this.nonColliderPosOffset).multiply(this.nonColliderRotOffset),this.quaternion.premultiply(this.groundTiltInv).multiply(this.objXZQuatInv),this.cameraFollow===!0){this.updateFollowArms();let y=this.objectToTarget.add(this.position),x=this.targetToCamera.add(y);rv.lookAt(x,y,ds).setPosition(x),rv.decompose(this.targetPos,this.targetQuat,si),this.camera.quaternion.slerp(this.targetQuat,1-(1-this.lerpFactorRotCamera)**n),this.camera.position.lerp(this.targetPos,1-(1-this.lerpFactorPosCamera)**n),this.camera.updateMatrix(),this.camera.updateMatrixWorld(),this.cameraYAxis==="Limit"&&this.orientMode==="cartesian"&&(this.euler.y=mt.clamp(this.euler.y,this.minAzimuthAngleRel,this.maxAzimuthAngleRel)),this.euler.x=mt.clamp(this.euler.x,-this.PI_2+(this.cameraPolarOffset<0?this.cameraPolarOffset:0),this.PI_2+(this.cameraPolarOffset>0?this.cameraPolarOffset:0))}return this.eulerDelta.set(0,0,0),this.object.dispatchEvent(Mme),this.path.length<2&&this.lastPosition.distanceToSquared(this.position)<this.threshEndTranslate&&Math.abs(this.rotVelocity.x)<this.threshEndRotVel&&Math.abs(this.rotVelocity.y)<this.threshEndRotVel&&(this.camera===void 0||this.isFirstPerson||this.lastCameraPosition.distanceToSquared(this.camera.position)<this.threshEndTranslate&&8*(1-this.lastCameraQuaternion.dot(this.camera.quaternion))<this.threshEndRotate)&&(this.moveMode==="fly"||this.onObject===!0||this.collisionEnabled===!1)&&((m=(f=this.navMeshPathDest)==null?void 0:f.material)==null?void 0:m.opacity)<-.04*((v=(g=this.navMeshPathDest)==null?void 0:g.material)==null?void 0:v.userData.opacity0)?!1:(this.camera&&(this.lastCameraPosition.copy(this.camera.position),this.lastCameraQuaternion.copy(this.camera.quaternion)),this.lastPosition.copy(this.position),this.object.dispatchEvent(Cme),!0)}updateFollowArms(){this.objectToTarget.copy(this.objectToTarget0),this.targetToCamera.copy(this.targetToCamera0);let e=pn.setFromAxisAngle(ds,this.cameraYAxis==="Limit"&&this.orientMode!=="radial"?mt.clamp(this.euler.y-this.euler0.y,this.minAzimuthAngleRel,this.maxAzimuthAngleRel):this.euler.y-this.euler0.y);(this.cameraYAxis!=="Locked"||this.orientMode==="radial")&&this.objectToTarget.applyQuaternion(e);let t;this.cameraXAxis==="Limit"?t=mt.clamp(this.euler.x,-this.maxPolarAngle+this.cameraPolarOffset+1e-6,-this.minPolarAngle+this.cameraPolarOffset-1e-6):t=mt.clamp(this.euler.x,-this.PI_2+this.cameraPolarOffset+1e-6,this.PI_2+this.cameraPolarOffset-1e-6);let r=si.copy(this.cameraPolarAxis0);(this.cameraYAxis!=="Locked"||this.orientMode==="radial")&&r.applyQuaternion(e);let i=La.setFromAxisAngle(r,t);this.cameraYAxis!=="Locked"&&this.targetToCamera.applyQuaternion(e),this.cameraXAxis!=="Locked"&&this.targetToCamera.applyQuaternion(i)}groundTiltAdjustment(e){ds.angleTo(e)*180/Math.PI<15||ds.angleTo(e)*180/Math.PI>85?pn.identity():pn.setFromUnitVectors(ds,e),this.groundTilt.slerp(pn,.06),this.groundTiltInv.copy(this.groundTilt).invert()}checkTrigger(){let e;for(let t=0;t<this.sharedGameControlGlobals.triggers.length;t++){let[r,i,n,s]=this.sharedGameControlGlobals.triggers[t];for(let a=0;a<this.sharedGameControlGlobals.entitiesWithTransformAnim.length;a++){let o=this.sharedGameControlGlobals.entitiesWithTransformAnim[a];if(n===o||s.isValidTriggeringObject(Mt.is(o)?o:o.object)===!1)continue;let l=Rw.copy(n.matrixWorld).decompose(si,pn,Ei).compose(si,pn,Bw).multiply(i),c=rv.copy(o.matrixWorld).invert().multiply(l);r instanceof Ar?e=o.bvhGeometry.boundsTree.intersectsBox(r,c):(zw.radius=r,zw.center.setFromMatrixPosition(c),e=o.bvhGeometry.boundsTree.intersectsSphere(zw)),e?s.currentIntersectedObjects.indexOf(o)===-1&&(s.currentIntersectedObjects.push(o),s.dispatch(),n.dispatchEvent(Rge)):s.currentIntersectedObjects=s.currentIntersectedObjects.filter(u=>u!==o)}}}collisionAdjustment(e){var n;let t=R5.set(0,0,0);this.object.matrix.compose(this.position,this.quaternion,this.scale);let r=rv.multiplyMatrices(this.object.matrix,this.objXZRotMat).multiply(this.collider.matrix).decompose(si,pn,Ei).compose(si,pn,Bw);this.sharedGameControlGlobals.entitiesWithTransformAnim.forEach(s=>{if(s===this.object||s.isDescendantOf(this.object))return;Bn.makeEmpty(),s.updateMatrixWorldSVD();let a=s.matrixWorldRigid,o=Rw.copy(a).invert(),l=yme.copy(Rw).multiply(r);Yr.copy(this.collider.segment),Yr.start.applyMatrix4(l),Yr.end.applyMatrix4(l);let c=O5.copy(this.position).applyMatrix4(o);Bn.expandByPoint(Yr.start),Bn.expandByPoint(Yr.end),Bn.min.addScalar(-this.collider.radius),Bn.max.addScalar(this.collider.radius),s.bvhGeometry.boundsTree.shapecast({traverseBoundsOrder(u){return u.distanceToPoint(Yr.end)},intersectsBounds:u=>u.intersectsBox(Bn),intersectsTriangle:u=>{let h=si,d=Ei,p=u.closestPointToSegment(Yr,h,d);if(p<this.collider.radius){let f=this.collider.radius-p,m=d.sub(h).normalize(),g=Do.copy(c);g.addScaledVector(m,f);let v=g.applyMatrix4(a).sub(this.position);t.add(v),Yr.start.addScaledVector(m,f),Yr.end.addScaledVector(m,f)}}})}),Bn.makeEmpty(),Yr.copy(this.collider.segment),Yr.start.applyMatrix4(r),Yr.end.applyMatrix4(r),Bn.expandByPoint(Yr.start),Bn.expandByPoint(Yr.end),Bn.min.addScalar(-this.collider.radius),Bn.max.addScalar(this.collider.radius),(n=this.sharedGameControlGlobals.staticMeshBVH)==null||n.shapecast({traverseBoundsOrder(s){return s.distanceToPoint(Yr.end)},intersectsBounds:s=>s.intersectsBox(Bn),intersectsTriangle:s=>{let a=si,o=Ei,l=s.closestPointToSegment(Yr,a,o);if(l<this.collider.radius){let c=this.collider.radius-l,u=o.sub(a).normalize();this.alignToGround&&this.groundTiltAdjustment(u),t.addScaledVector(u,c),Yr.start.addScaledVector(u,c),Yr.end.addScaledVector(u,c)}}}),this.onObject=Math.abs(t.y)>Math.abs(e*this.velocity.y*.25),this.onObject&&this.dispatchStopEvent("jump");let i=Math.max(0,t.length()-1e-5);t.normalize().multiplyScalar(i),this.position.add(t)}},f8=H_;f8.isLocked=!1;var Eme=ld(tR());function qa(e,t){let r=new it;if(!e.getAttribute("position"))return r.setAttribute("position",new Ne([],3)),r.setIndex([]),r;let{positions:i,triIndices:n}=i1(e.getAttribute("position"),e.getIndex());return r.setAttribute("position",new Ne(i,3)),r.setIndex(n),t&&r.applyMatrix4(t),r}var Tme=new _e,Pme=new _e,Gs=[[0,0,0],[0,0,0],[0,0,0]];function m8(e){let t=e.elements;Gs[0][0]=t[0],Gs[0][1]=t[4],Gs[0][2]=t[8],Gs[1][0]=t[1],Gs[1][1]=t[5],Gs[1][2]=t[9],Gs[2][0]=t[2],Gs[2][1]=t[6],Gs[2][2]=t[10];let{u:r,v:i}=(0,Eme.SVD)(Gs),n=Tme.set(r[0][0],r[0][1],r[0][2],0,r[1][0],r[1][1],r[1][2],0,r[2][0],r[2][1],r[2][2],0,0,0,0,1),s=Pme.set(i[0][0],i[0][1],i[0][2],0,i[1][0],i[1][1],i[1][2],0,i[2][0],i[2][1],i[2][2],0,0,0,0,1);return n.multiply(s.transpose())}var Dme=class extends WR{constructor(){super(),this.layers.enable(3),this.layers.enable(8)}setFromCamera(e,t){t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,-1).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):t.isPerspectiveCamera?(this.ray.origin.set(e.x,e.y,-1).unproject(t),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):console.error("Raycaster: Unsupported camera type.")}intersectVisibleObjects(e,t=!0,r=[]){return e.forEach(i=>{i.visible&&this.intersectObject(i,t,r)}),r}createRaycastLineHelper(){let e=new Ll({color:65280,linewidth:10}),t=new E(this.ray.origin.x,this.ray.origin.y,this.ray.origin.z),r=new E(this.ray.direction.x,this.ray.direction.y,this.ray.direction.z),i=this.camera.far-this.camera.near,n=new E().addVectors(t,r.multiplyScalar(i)),s=new it;return s.setFromPoints([t,n]),new S0(s,e)}},g8=e=>e instanceof Zf||e instanceof Pu;function Lme(e,t){return e.distance-t.distance}function v8(e,t,r){if(!(!Wa(t)||!t.visible)){ws(t)&&t.raycast(e,r);for(let i of t.children)v8(e,i,r)}}function G_(e,t,r){if(!r.some(n=>cy(e,n)!==void 0))return[];let i=[];return t.children.forEach(n=>v8(e,n,i)),i.sort(Lme),i}function W_(e){let t=[];if(e.length){let r=e[0].object;Wa(r)&&t.push(r);let i=r.parent;for(;i;)g8(i)&&t.push(i),i=i.parent}return t}function cy(e,t){if(ws(t)){if(t.visible){let r=[];return t.raycast(e,r),r.length?r[0]:void 0}}else if(g8(t))return y8(e,t)}function y8(e,t){if(!(!Wa(t)||!t.visible)){if(ws(t)){let r=[];if(t.raycast(e,r),r.length)return r[0]}for(let r of t.children){let i=y8(e,r);if(i)return i}}}function Ime(e,t,r){return{x:(e-(r.left+window.scrollX))/r.width*2-1,y:-((t-(r.top+window.scrollY))/r.height)*2+1}}var Ome=class{constructor(e,t,r,i,n,s,a,o){this.renderer=e,this.publish=t,this.scene=r,this.getCamera=i,this.sharedAssets=n,this.requestRender=s,this.isExport=a,this.frame=o,this.raycaster=new Dme,this.raycasterNeedsUpdate=!0,this._useWindowEvents=!1,this._useWindowEvents=t.mouseEventTarget==="window",this.domElement=e.domElement,this.eventElement=this._useWindowEvents?window:e.domElement}get stopRaycast(){return this.publish.stopRaycast}get page(){return this.scene.activePage}set useWindowEvents(e){this._useWindowEvents=e,this.eventElement=e?window:this.renderer.domElement}get useWindowEvents(){return this._useWindowEvents}updateRaycaster(e){var n;if(!this.raycasterNeedsUpdate)return;this.raycasterNeedsUpdate=!1;let{pageX:t,pageY:r}=((n=e.touches)==null?void 0:n.length)>0?e.touches[0]:e,i=this.domElement.getBoundingClientRect();this.raycaster.setFromCamera(Ime(t,r,i),this.getCamera())}},x8=(e=>(e[e.keydown=0]="keydown",e[e.keyup=1]="keyup",e[e.pointerdown=2]="pointerdown",e[e.pointerup=3]="pointerup",e[e.pointermove=4]="pointermove",e[e.wheel=5]="wheel",e[e.scroll=6]="scroll",e))(x8||{}),_a=class{constructor(e){this.eventContext=e,this.domEventsNeeded=new Set,this.hasVideoAction=!1}connect(){}disconnect(){}},$A=[["start","Start"],["keyDown","KeyDown"],["keyUp","KeyUp"],["mouseDown","MouseDown"],["mouseUp","MouseUp"],["mouseHover","MouseHover"],["collision","Collision"],["lookAt","LookAt"],["follow","Follow"],["scroll","Scroll"]],w8=e=>{var t;return(t=$A.find(([r,i])=>i===e))==null?void 0:t[0]},_m=e=>{var t;return(t=$A.find(([r])=>r===e))==null?void 0:t[1]},Rme=(e,t)=>{let r=w8(e);if(r){let i=new CustomEvent(r,{bubbles:!0});return Object.defineProperty(i,"target",{writable:!1,value:t}),i}},Bme=class extends _a{constructor(e){super(e),this.objectsPerEvents=new Map,this.splineEvents={},this.onBeginEvent=r=>{var s;if(!r.eventName||!r.target||r.eventName==="Scroll")return;let i=(s=this.splineEvents[w8(r.eventName)])==null?void 0:s[r.target.uuid];if(!i)return;r.eventName==="Scroll"&&r.deltaY!==void 0&&Object.assign(i,{deltaY:r.deltaY});let{domElement:n}=this.eventContext;n.dispatchEvent(i)};let{page:t}=this.eventContext;t.traverseEntity(r=>{var i,n;if((i=r.data)!=null&&i.events.length){for(let[s,a]of $A)if(r.data.events.some(o=>o.data.type===a&&!o.data.disabled)){this.objectsPerEvents.has(s)?(n=this.objectsPerEvents.get(s))==null||n.push(r):this.objectsPerEvents.set(s,[r]);let o={id:r.uuid,name:r.name},l=Rme(a,o),c=this.splineEvents[s];c?c[r.uuid]=l:this.splineEvents[s]={[r.uuid]:l}}}})}connect(){this.objectsPerEvents.forEach(e=>{e.forEach(t=>{t.addEventListener("beginEvent",this.onBeginEvent)})})}disconnect(){this.objectsPerEvents.forEach(e=>{e.forEach(t=>{t.removeEventListener("beginEvent",this.onBeginEvent)})})}},zme=class{constructor(e,t,r,i,n,s){if(this.id=e,this.data=t,this.object=r,this.entered=!1,this.alreadyPlayedNonTogglingActions=new Set,this.useToggle=t.toggle,(t.type==="KeyDown"||t.type==="KeyUp"||t.type==="KeyPress")&&!t.key)throw new Error("Missing property");this.actions=En(t,t.actions,i,n,s,r)}disconnect(){on(this.actions)}dispatchHeld(e){this.actions.Create.forEach(t=>{e&&t.dispatchThrottled.cancel(),t.dispatchThrottled()})}dispatch(e=!1){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this?(t.object.currentTransitionEvent=this,t.init()):this.useToggle===!1&&this.alreadyPlayedNonTogglingActions.add(t)}),this.useToggle?(this.actions.Transition.forEach(t=>{t.toggle()}),this.actions.Animation.forEach(t=>{t.toggle()}),this.actions.SwitchCamera.forEach(t=>{t.toggle()})):this.data.type==="MousePress"||this.data.type==="KeyPress"?this.entered||(this.entered=!0,this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Animation.forEach(t=>t.playFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent()),this.actions.Create.forEach(t=>t.dispatchStart())):(this.actions.Transition.some(t=>t.playing)||this.actions.Transition.forEach(t=>{this.alreadyPlayedNonTogglingActions.has(t)===!1&&t.play()}),this.actions.SwitchCamera.some(t=>t.playing)||this.actions.SwitchCamera.forEach(t=>{t.play()}),this.actions.Animation.forEach(t=>{t.play()})),this.actions.Link.forEach(t=>{t.dispatch()}),this.actions.SceneTransition.forEach(t=>{t.dispatch()}),e===!1&&this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch()}),this.actions.Reset.forEach(t=>{t.dispatch()}),this.actions.Audio.forEach(t=>{t.dispatchBasic()}),this.actions.Video.forEach(t=>{t.dispatchBasic()})}dispatchRelease(){this.entered&&(this.entered=!1,this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.Animation.forEach(e=>e.reverseFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.reverseFromCurrent()),this.actions.Create.forEach(e=>e.dispatchStop()))}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Animation.forEach(t=>t.playFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent())),this.actions.Link.forEach(t=>{t.dispatch()}),this.actions.SceneTransition.forEach(t=>{t.dispatch()}),this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch()}),this.actions.Reset.forEach(t=>{t.dispatch()}),this.actions.Audio.forEach(t=>{t.dispatchBasic()}),this.actions.Video.forEach(t=>{t.dispatchBasic()})}},kme=class extends _a{constructor(e,t){super(e),this.objectsPerTypes={MouseDown:[],MouseUp:[],MousePress:[],KeyDown:[],KeyUp:[],KeyPress:[]},this.canvasMouseEvents=[],this.windowMouseEvents=[],this.eventsPerObjects={MouseDown:{},MouseUp:{},MousePress:{},KeyDown:{},KeyUp:{},KeyPress:{}},this.heldKeys={},this.heldKeysPress={},this._prevObjects=[],this.onWindowMouseDown=n=>{(n.target===this.eventContext.domElement||n.target.tagName==="SPLINE-VIEWER")&&this.canvasMouseEvents.forEach(s=>{(s.data.type==="MouseDown"||s.data.type==="MousePress")&&s.dispatch()}),this.windowMouseEvents.forEach(s=>{(s.data.type==="MouseDown"||s.data.type==="MousePress")&&s.dispatch()})},this.onWindowMouseUp=n=>{(n.target===this.eventContext.domElement||n.target.tagName==="SPLINE-VIEWER")&&this.canvasMouseEvents.forEach(s=>{s.data.type==="MouseUp"?s.dispatch():s.data.type==="MousePress"&&s.dispatchRelease()}),this.windowMouseEvents.forEach(s=>{s.data.type==="MouseUp"?s.dispatch():s.data.type==="MousePress"&&s.dispatchRelease()})},this.onMouseDown=n=>{et.length>1||(this.eventContext.updateRaycaster(n),this.handleMouseEvent("MouseDown"))},this.onMouseUp=n=>{et.length>1||(this.eventContext.updateRaycaster(n),this.handleMouseEvent("MouseUp"))},this.onMousePressDown=n=>{et.length>1||(this.eventContext.updateRaycaster(n),this.handleMousePressEvent())},this.onMousePressRelease=n=>{et.length>1||(this.eventContext.updateRaycaster(n),this.handleMousePressEvent(!0))},this.onKeyDown=n=>{this.heldKeys[n.key]||(this.handleKeyEvent(n,"KeyDown"),this.handleKeyEventHeld(n,"KeyDown",!0)),this.heldKeys[n.key]=!0},this.onKeyUp=n=>{this.handleKeyEvent(n,"KeyUp"),this.handleKeyEventHeld(n,"KeyUp",!0)},this.onKeyPressDown=n=>{this.heldKeysPress[n.key]?this.handleKeyEventHeld(n,"KeyPress"):(this.handleKeyEvent(n,"KeyPress"),this.handleKeyEventHeld(n,"KeyPress",!0)),this.heldKeysPress[n.key]=!0},this.onKeyPressUp=n=>{this.handleKeyEvent(n,"KeyPress",!0)},this.releaseHeldKey=n=>{delete this.heldKeys[n.key]},this.releaseHeldKeyPress=n=>{delete this.heldKeysPress[n.key]},this._onUserEvent=({eventName:n,target:s,reverse:a})=>{var l,c,u,h;if(!n||!s)return;let o=_m(n);o&&(o==="MouseDown"||o==="MouseUp"||o==="MousePress"?(s.dispatchEvent({type:"beginEvent",eventName:o}),(c=(l=this.eventsPerObjects[o])==null?void 0:l[s.uuid])==null||c.forEach(d=>{d.dispatchUserEvent(a)})):(o==="KeyDown"||o==="KeyUp"||o==="KeyPress")&&(s.dispatchEvent({type:"beginEvent",eventName:o}),(h=(u=this.eventsPerObjects[o])==null?void 0:u[s.uuid])==null||h.forEach(d=>{d.dispatchUserEvent()})))};let{page:r,sharedAssets:i}=this.eventContext;r.traverseEntity(n=>{var a,o;if(!((a=n.data)!=null&&a.events.length))return;let s=["MouseDown","MouseUp","MousePress","KeyDown","KeyUp","KeyPress"];for(let l of s){let c=this.eventsPerObjects[l];n.data.events.filter(({data:u})=>u.type===l&&u.disabled!==!0).forEach(({id:u,data:h})=>{try{let d=new zme(u,h,n,r,i,t);d.actions.Video.length&&(this.hasVideoAction=!0),(h.type==="MouseDown"||h.type==="MouseUp"||h.type==="MousePress")&&(h.mode==="Canvas"||h.mode==="Window")?h.mode==="Canvas"&&this.canvasMouseEvents.push(d):c[n.uuid]?c[n.uuid].push(d):c[n.uuid]=[d]}catch{}}),(o=c[n.uuid])!=null&&o.length&&this.objectsPerTypes[l].push(n)}})}connect(){var t,r,i,n,s,a;let{domElement:e}=this.eventContext;this.heldKeys={},this.heldKeysPress={},this.domEventsNeeded.clear(),typeof window<"u"&&(window.addEventListener("pointerdown",this.onWindowMouseDown,{capture:!0}),window.addEventListener("pointerup",this.onWindowMouseUp,{capture:!0})),(t=this.objectsPerTypes.MouseDown)!=null&&t.length&&(this.domEventsNeeded.add("pointerdown"),e.addEventListener("pointerdown",this.onMouseDown)),(r=this.objectsPerTypes.MouseUp)!=null&&r.length&&(this.domEventsNeeded.add("pointerup"),e.addEventListener("pointerup",this.onMouseUp)),(i=this.objectsPerTypes.MousePress)!=null&&i.length&&(this.domEventsNeeded.add("pointerdown"),e.addEventListener("pointerdown",this.onMousePressDown),this.domEventsNeeded.add("pointerup"),e.addEventListener("pointerup",this.onMousePressRelease)),(n=this.objectsPerTypes.KeyDown)!=null&&n.length&&(this.domEventsNeeded.add("keydown"),document.addEventListener("keydown",this.onKeyDown),document.addEventListener("keyup",this.releaseHeldKey)),(s=this.objectsPerTypes.KeyUp)!=null&&s.length&&(this.domEventsNeeded.add("keyup"),document.addEventListener("keyup",this.onKeyUp)),(a=this.objectsPerTypes.KeyPress)!=null&&a.length&&(this.domEventsNeeded.add("keydown"),document.addEventListener("keydown",this.onKeyPressDown),document.addEventListener("keyup",this.releaseHeldKeyPress),this.domEventsNeeded.add("keyup"),document.addEventListener("keyup",this.onKeyPressUp)),Object.entries(this.objectsPerTypes).forEach(([o,l])=>{l.forEach(c=>{c.addEventListener("userEvent",this._onUserEvent)})})}disconnect(){let{domElement:e}=this.eventContext;this.domEventsNeeded.clear(),this.heldKeys={},this.heldKeysPress={},typeof window<"u"&&(window.removeEventListener("pointerdown",this.onWindowMouseDown,{capture:!0}),window.removeEventListener("pointerup",this.onWindowMouseUp,{capture:!0})),e.removeEventListener("pointerdown",this.onMouseDown),e.removeEventListener("pointerdown",this.onMousePressDown),e.removeEventListener("pointerup",this.onMouseUp),e.removeEventListener("pointerup",this.onMousePressRelease),document.removeEventListener("keydown",this.onKeyDown),document.removeEventListener("keyup",this.onKeyUp),document.removeEventListener("keydown",this.onKeyPressDown),document.removeEventListener("keyup",this.onKeyPressUp),document.removeEventListener("keyup",this.releaseHeldKey),Object.values(this.eventsPerObjects).forEach(t=>{Object.values(t).forEach(r=>{r.forEach(i=>{i.disconnect()})})}),this.canvasMouseEvents.forEach(t=>{t.disconnect()}),Object.entries(this.objectsPerTypes).forEach(([t,r])=>{r.forEach(i=>{i.removeEventListener("userEvent",this._onUserEvent)})})}handleMouseEvent(e){let{stopRaycast:t,raycaster:r,page:i}=this.eventContext,n=this.objectsPerTypes[e];if(n.length)if(t){let s=G_(r,i,n);W_(s).forEach(a=>{this.eventsPerObjects[e][a.uuid]&&this.handleObjectMouseEventDispatch(a,e)})}else n.forEach(s=>{cy(r,s)&&this.handleObjectMouseEventDispatch(s,e)})}handleMousePressEvent(e=!1){let t="MousePress",r=this.objectsPerTypes[t],i=[];if(r.length){if(!e){let{stopRaycast:n,raycaster:s,page:a}=this.eventContext;if(n){let o=G_(s,a,r);i=W_(o)}else r.forEach(o=>{cy(s,o)&&i.push(o)})}this._prevObjects.length&&this._prevObjects.forEach(n=>{i.includes(n)||this.handleObjectMouseEventDispatchRelease(n,t)}),i.length&&i.forEach(n=>{this.handleObjectMouseEventDispatch(n,t)}),this._prevObjects=i}}handleObjectMouseEventDispatch(e,t){var r,i;e.dispatchEvent({type:"beginEvent",eventName:t}),(i=(r=this.eventsPerObjects[t])==null?void 0:r[e.uuid])==null||i.forEach(n=>{n.dispatch()})}handleObjectMouseEventDispatchRelease(e,t){var r,i;e.dispatchEvent({type:"beginEvent",eventName:t}),(i=(r=this.eventsPerObjects[t])==null?void 0:r[e.uuid])==null||i.forEach(n=>{n.dispatchRelease()})}handleKeyEvent(e,t,r=!1){this.objectsPerTypes[t].forEach(i=>{let n=this.eventsPerObjects[t][i.uuid];n.some(({data:s})=>"key"in s&&s.key===e.key)&&i.dispatchEvent({type:"beginEvent",eventName:t}),n.forEach(s=>{"key"in s.data&&s.data.key===e.key&&(r?s.dispatchRelease():s.dispatch(!0))})})}handleKeyEventHeld(e,t,r=!1){this.objectsPerTypes[t].forEach(i=>{this.eventsPerObjects[t][i.uuid].forEach(n=>{"key"in n.data&&n.data.key===e.key&&n.dispatchHeld(r)})})}},Nme=new E,Fme=new E,b8=class{constructor(e,t,r,i,n){this.actionsIn=En(e,e.inActions,r,i,n,t),this.actionsOut=En(e,e.outActions,r,i,n,t)}disconnect(){on(this.actionsIn),on(this.actionsOut)}},Ume=class extends b8{constructor(e,t,r,i,n,s){super(t,r,i,n,s),this.id=e,this.data=t,this.object=r,this.stage="out",this.objects=[],this.onUpdateMatrix=()=>{for(let d of this.objects)if(!d.visible)return;let c=Nme.setFromMatrixPosition(this.objects[0].matrixWorld),u=Fme.setFromMatrixPosition(this.objects[1].matrixWorld),h=c.distanceTo(u)<=this.distance?"in":"out";if(this.stage!==h){this.stage=h;let d=h==="in"?this.actionsIn:this.actionsOut;d.Audio.forEach(p=>p.dispatchConditional()),d.Video.forEach(p=>p.dispatchConditional()),d.Link.forEach(p=>p.dispatch()),d.Create.forEach(p=>p.dispatch()),d.Destroy.forEach(p=>p.dispatch()),d.Reset.forEach(p=>p.dispatch()),d.Transition.forEach(p=>{p.object.currentTransitionEvent!==this&&(p.object.currentTransitionEvent=this),p.init()}),d.Transition.forEach(p=>p.play()),d.Animation.forEach(p=>p.play()),d.SwitchCamera.forEach(p=>p.play()),d.SceneTransition.forEach(p=>p.dispatch())}};let{distance:a,fromObject:o,toObject:l}=t.condition;this.distance=a;for(let c of[o,l]){if(!c)throw new Error("Missing property");let u=i.find(c);if(!u)throw new Error("Missing property");this.objects.push(u)}}connect(){window.setTimeout(()=>{this.objects.forEach(e=>{e.addEventListener("updateMatrix",this.onUpdateMatrix)}),this.onUpdateMatrix()},0)}disconnect(){super.disconnect(),this.stage="out",this.objects.forEach(e=>{e.removeEventListener("updateMatrix",this.onUpdateMatrix)})}},jme=class extends b8{constructor(e,t,r,i,n,s){var l;super(t,r,i,n,s),this.id=e,this.data=t,this.object=r,this.onBegin=({target:c,state:u})=>{this.toState!==u&&(this.actionsOut.Audio.forEach(h=>h.dispatchConditional()),this.actionsOut.Video.forEach(h=>h.dispatchConditional()),this.actionsOut.Link.forEach(h=>h.dispatch()),this.actionsOut.Create.forEach(h=>h.dispatch()),this.actionsOut.Destroy.forEach(h=>h.dispatch()),this.actionsOut.Reset.forEach(h=>h.dispatch()),this.actionsIn.Transition.forEach(h=>h.pause()),this.object.currentTransitionEvent=this,this.actionsOut.Transition.forEach(h=>h.play()),this.actionsOut.Animation.forEach(h=>h.play()),this.actionsIn.SwitchCamera.forEach(h=>h.pause()),this.actionsOut.SwitchCamera.forEach(h=>h.play()),this.actionsOut.SceneTransition.forEach(h=>h.dispatch()))},this.onComplete=({target:c,state:u})=>{this.toState===u&&(this.actionsIn.Audio.forEach(h=>h.dispatchConditional()),this.actionsIn.Video.forEach(h=>h.dispatchConditional()),this.actionsIn.Link.forEach(h=>h.dispatch()),this.actionsIn.Create.forEach(h=>h.dispatch()),this.actionsIn.Destroy.forEach(h=>h.dispatch()),this.actionsIn.Reset.forEach(h=>h.dispatch()),this.actionsOut.Transition.forEach(h=>h.pause()),this.actionsOut.Transition.forEach(h=>h.pause()),this.object.currentTransitionEvent=this,this.actionsIn.Transition.forEach(h=>h.play()),this.actionsIn.Animation.forEach(h=>h.play()),this.actionsOut.SwitchCamera.forEach(h=>h.pause()),this.actionsIn.SwitchCamera.forEach(h=>h.play()),this.actionsIn.SceneTransition.forEach(h=>h.dispatch()))};let{condition:a}=t;if(!a.object)throw new Error("Missing property");let o=i.find(a.object);if(!o)throw new Error("Missing property");if(this.toObject=o,a.state&&!((l=this.toObject.states)!=null&&l[a.state]))throw new Error("Missing property");this.toState=a.state}connect(){(this.actionsOut.Audio.length||this.actionsOut.Video.length||this.actionsOut.Create.length||this.actionsOut.Destroy.length||this.actionsOut.Transition.length||this.actionsOut.Animation.length||this.actionsOut.SwitchCamera.length||this.actionsOut.SceneTransition.length)&&this.toObject.addEventListener("beginState",this.onBegin),(this.actionsIn.Audio.length||this.actionsIn.Video.length||this.actionsOut.Create.length||this.actionsIn.Destroy.length||this.actionsIn.Transition.length||this.actionsIn.Animation.length||this.actionsIn.SwitchCamera.length||this.actionsIn.SceneTransition.length)&&this.toObject.addEventListener("completeState",this.onComplete)}disconnect(){super.disconnect(),(this.actionsOut.Audio.length||this.actionsOut.Video.length||this.actionsOut.Create.length||this.actionsOut.Destroy.length||this.actionsOut.Transition.length||this.actionsOut.Animation.length||this.actionsOut.SwitchCamera.length||this.actionsOut.SceneTransition.length)&&this.toObject.removeEventListener("beginState",this.onBegin),(this.actionsIn.Audio.length||this.actionsIn.Video.length||this.actionsOut.Create.length||this.actionsIn.Destroy.length||this.actionsIn.Transition.length||this.actionsIn.Animation.length||this.actionsIn.SwitchCamera.length||this.actionsIn.SceneTransition.length)&&this.toObject.removeEventListener("completeState",this.onComplete)}},Vme=class extends _a{constructor(e,t){super(e),this.eventsPerConditions={Comparison:[],Distance:[],State:[]},this.hasVideoAction=!1;let{page:r,sharedAssets:i}=this.eventContext;r.traverseEntity(n=>{var s;if((s=n.data)!=null&&s.events.length){for(let{id:a,data:o}of n.data.events)if(!o.disabled&&o.type==="Conditional")try{let l;o.condition.type==="Comparison"||(o.condition.type==="Distance"?l=new Ume(a,o,n,r,i,t):o.condition.type==="State"&&(l=new jme(a,o,n,r,i,t))),l&&(this.eventsPerConditions[o.condition.type].push(l),(l.actionsIn.Video.length||l.actionsOut.Video.length)&&(this.hasVideoAction=!0))}catch{}}})}connect(){super.connect(),Object.values(this.eventsPerConditions).forEach(e=>e.forEach(t=>t.connect()))}disconnect(){super.disconnect(),Object.values(this.eventsPerConditions).forEach(e=>e.forEach(t=>t.disconnect()))}},pp=new E,Lo=new E,Gl=new E,k5=new gn,Hme=.01,Ot=new E,zr=new E,N5=new E,mc=new ft,kw=new Zr,Gme=new _e,Nw=new Jr,_h=new E,Ws=new E,Sh=.2;function Fw(e,t){!t||(t[0]<t[1]&&(e.x=Math.min(Math.max(e.x,t[0]),t[1])),t[2]<t[3]&&(e.y=Math.min(Math.max(e.y,t[2]),t[3])),t[4]<t[5]&&(e.z=Math.min(Math.max(e.z,t[4]),t[5])))}var Wme=function(){let e=new _e;return(t,r,i)=>{let n=t.obj;e.copy(n.hiddenMatrix),n.parent!==null&&e.premultiply(n.parent.matrixWorld),e.invert(),n.position.copy(r),t.reference==="global"&&Fw(n.position,t.limits),n.position.applyMatrix4(e),t.reference==="parent"?Fw(n.position,t.limits):t.reference==="local"&&(mc.copy(t.quat0).invert(),n.position.sub(t.position0),n.position.applyQuaternion(mc),Fw(n.position,t.limits),mc.invert(),n.position.applyQuaternion(mc),n.position.add(t.position0)),e.multiply(i??n.matrixWorld).decompose(Ot,n.quaternion,zr),n.updateMatrix(),n.hasNonUniformScale&&(n.updateMatrixWorld(),n.updateMatrixWorldSVD()),n instanceof an&&na(n.parent)&&n.invalidateDownstreamBooleanData(!0)}}(),qme=class{constructor(e,t,r,i,n,s){this.object=e,this.data=t,this.dropDestIds=[],this.activeIdx=null,this.wasDragEventTriggered=!1,this.resetDampingFactor=this.data.resetSpeed===0?1:8/this.data.resetSpeed+1,this.snapDampingFactor=this.data.snapSpeed===0?1:8/this.data.snapSpeed+1,this.actionsDrag=En(t,t.dragDropActions.drag,r,i,n,this.object),this.actionsDrop=En(t,t.dragDropActions.drop,r,i,n,this.object);let a=[];this.data.objects.forEach(o=>{let l=r.find(o);!l||l.data.visible!==!1&&(a.push(l),s[l.uuid]&&s[l.uuid].forEach(c=>{let u=r.find(c);!u||u.data.visible!==!1&&a.push(u)}))}),this.data.dropDestinations.forEach(o=>{let l=r.find(o);!l||l.data.visible!==!1&&(this.dropDestIds.push(l.uuid),s[l.uuid]&&s[l.uuid].forEach(c=>{let u=r.find(c);!u||u.data.visible!==!1&&this.dropDestIds.push(u.uuid)}))}),this.dragItems=a.map(o=>(this.data.planeMode==="locked"&&(o.userData.lockedPlane=!0),o.userData.worldPosition0=new E().setFromMatrixPosition(o.matrixWorld),{obj:o,fromPosition:new E().setFromMatrixPosition(o.matrixWorld),pointStart:new E,pointEnd:new E,paused:!0,currentDampingFactor:this.data.dampingFactor,reset:!1,position0:new E().copy(o.position),quat0:new ft().copy(o.quaternion),snapped:!1,orientationMatrix:new _e,limits:this.data.limits,reference:this.data.referenceFrame}))}get activeDragItem(){return this.activeIdx!==null?this.dragItems[this.activeIdx]:null}dispose(){on(this.actionsDrag),on(this.actionsDrop),this.dragItems.forEach(e=>{e.fromPosition.copy(e.obj.userData.worldPosition0),e.pointStart.copy(e.fromPosition),e.pointEnd.copy(e.pointStart),e.obj.recursiveBBoxNeedsUpdate=!0,e.obj.userData.lockedPlane=void 0,e.obj.position.copy(e.position0),e.obj.quaternion.copy(e.quat0),e.obj.updateMatrix()})}},Xme=class extends _a{constructor(e,t){super(e),this.eventManager=t,this.events=[],this.lastDropDestination=null,this.dragTimeout=null,this.onPointerDown=i=>{var o;if(et.length>1)return;this.eventContext.updateRaycaster(i);let{raycaster:n,page:s}=this.eventContext,a=s.raycastWithClones(n);if(this.lastDropDestination=null,a.length===0){this.activeEvent=null;return}for(let l of this.events){let c=0;for(let{obj:u,pointEnd:h,pointStart:d}of l.dragItems){if(u===a[0].object||u===a[0].object.object||Mt.is(u)&&u.isAncestorOf(a[0].object.uuid)){if(l.activeIdx=c,l.activeDragItem.reset=!1,l.activeDragItem.currentDampingFactor=l.data.dampingFactor,l.activeDragItem.snapped=!1,l.data.cursor==="hand"&&this.setCursor("grabbing"),this.eventManager.controlsManager.usePhysics){l.activeDragItem.obj.rigidBody&&l.activeDragItem.obj.rigidBody.setBodyType(2,!0);let p=l.activeDragItem.obj;u.hasNonUniformScale&&u.updateMatrixWorldSVD(),(p.hasNonUniformScale?p.matrixWorldRigid:p.matrixWorld).decompose(Ot,mc,zr),kw.setFromQuaternion(mc),p.prevR===void 0?(p.prevR=kw.clone(),p.prevT=Ot.clone()):(p.prevR.copy(kw),p.prevT.copy(Ot)),this.eventManager.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.push(l.activeDragItem.obj)}this.calcPlaneIntersectPos(u,d,l.data.plane,l.data.referenceFrame),h.copy(d),(this.eventManager.controlsManager.usePhysics&&((o=u.data.physics)==null?void 0:o.rigidBody)==="dynamic"||l.data.drop===!1||l.data.resetOnSnapFail===!1)&&l.activeDragItem.fromPosition.setFromMatrixPosition(l.activeDragItem.obj.matrixWorld),this.activeEvent=l,this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!1);return}c++}}this.activeEvent=null},this.onPointerMove=i=>{var o,l,c,u;if(et.length>1)return;this.eventContext.updateRaycaster(i);let{raycaster:n,page:s}=this.eventContext,a=s.raycastWithClones(n);if(et.length===0){let h=!1;for(let d of this.events){for(let{obj:p}of d.dragItems)if(p===((o=a[0])==null?void 0:o.object)||p===((c=(l=a[0])==null?void 0:l.object)==null?void 0:c.object)||Mt.is(p)&&p.isAncestorOf((u=a[0])==null?void 0:u.object.uuid)){switch(h=!0,d.data.cursor){case"hand":this.setCursor("grab");break;case"move":this.setCursor("move");break}break}if(h)break}h||this.setCursor("default");return}if(this.activeEvent&&this.activeEvent.activeDragItem){let h=this.activeEvent.activeDragItem;h.snapped=!1;let d;if(this.activeEvent.data.drop&&(d=a.filter(p=>h.obj!==p.object&&!h.obj.isAncestorOf(p.object.uuid)&&!(p.object instanceof Zf)&&(this.activeEvent.data.dropOn==="all"||this.activeEvent.dropDestIds.some(f=>f===p.object.uuid||s.scene.find(f).isAncestorOf(p.object.uuid))))[0]),d){let p=N5.copy(d.face.normal).applyMatrix3(Nw.getNormalMatrix(d.object.matrixWorld));if(this.activeEvent.data.snapTo==="center")h.fromPosition.setFromMatrixPosition(d.object.matrixWorld);else if(this.activeEvent.data.snapTo==="surface"){if(h.fromPosition.copy(d.point),this.activeEvent.data.snapSurfaceMode==="bbox"){Ot.copy(p).applyMatrix3(Nw.setFromMatrix4(h.obj.matrixWorld).transpose());let f=h.obj;Ot.x>Sh?zr.x=-f.recursiveBBox.min.x:Ot.x<-Sh&&(zr.x=-f.recursiveBBox.max.x),Ot.y>Sh?zr.y=-f.recursiveBBox.min.y:Ot.y<-Sh&&(zr.y=-f.recursiveBBox.max.y),Ot.z>Sh?zr.z=-f.recursiveBBox.min.z:Ot.z<-Sh&&(zr.z=-f.recursiveBBox.max.z),zr.applyMatrix3(Nw.invert())}else zr.copy(p).multiplyScalar(this.activeEvent.data.snapSurfaceOffset);h.fromPosition.add(zr)}this.activeEvent.data.autoOrient&&(Ot.set(0,1,0).cross(p),Ot.length()<1e-4&&Ot.set(-1,0,0).cross(p),zr.crossVectors(N5,Ot),h.orientationMatrix.makeBasis(Ot,zr,p)),h.pointStart.copy(h.fromPosition),h.pointEnd.copy(h.pointStart),h.currentDampingFactor=this.activeEvent.snapDampingFactor,h.snapped=!0,this.lastDropDestination!==d.object&&(this.lastDropDestination=d.object,this.activeEvent.actionsDrop.Transition.forEach(f=>{f.play()}),this.activeEvent.actionsDrop.Animation.forEach(f=>{f.play()}),this.activeEvent.actionsDrop.Audio.forEach(f=>{f.dispatchGameControl("start")}),this.activeEvent.actionsDrop.Create.forEach(f=>{f.dispatchThrottled()}))}else h.orientationMatrix.makeRotationFromQuaternion(h.quat0),this.lastDropDestination=null,h.currentDampingFactor=this.activeEvent.data.dampingFactor,this.calcPlaneIntersectPos(h.obj,h.pointEnd,this.activeEvent.data.plane,this.activeEvent.data.referenceFrame),this.activeEvent.actionsDrop.Transition.forEach(p=>{p.stop(),p.object.currentState!==null&&p.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrop.Animation.forEach(p=>{p.stop()}),this.activeEvent.actionsDrop.Audio.forEach(p=>{p.dispatchGameControl("stop")});this.activeEvent.actionsDrag.Create.forEach(p=>{p.dispatchThrottled()}),this.activeEvent.wasDragEventTriggered===!1&&(this.activeEvent.wasDragEventTriggered=!0,this.activeEvent.actionsDrag.Transition.forEach(p=>{p.play()}),this.activeEvent.actionsDrag.Animation.forEach(p=>{p.play()}),this.activeEvent.actionsDrag.Audio.forEach(p=>{p.dispatchGameControl("start")})),this.dragTimeout&&window.clearTimeout(this.dragTimeout),this.dragTimeout=window.setTimeout(()=>{!this.activeEvent||(this.activeEvent.wasDragEventTriggered=!1,this.activeEvent.actionsDrag.Audio.forEach(p=>{p.dispatchGameControl("stop")}),this.activeEvent.actionsDrag.Transition.forEach(p=>{p.stop(),p.object.currentState!==null&&p.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrag.Animation.forEach(p=>{p.stop()}))},500),this.updateDragItem(h),h.obj.dispatchEvent({type:"requestRender"})}},this.onPointerUp=i=>{var n;if(this.activeEvent&&this.activeEvent.activeDragItem){this.activeEvent.data.cursor==="hand"&&this.setCursor("grab");let s=((n=this.activeEvent.activeDragItem.obj.data.physics)==null?void 0:n.rigidBody)==="dynamic";this.activeEvent.activeDragItem.snapped===!1&&this.activeEvent.data.drop&&this.activeEvent.data.resetOnSnapFail&&(this.eventManager.controlsManager.usePhysics===!1||!s)&&(this.activeEvent.activeDragItem.reset=this.activeEvent.data.resetOnSnapFail,this.activeEvent.activeDragItem.paused=!1,this.activeEvent.activeDragItem.currentDampingFactor=this.activeEvent.resetDampingFactor),this.eventManager.controlsManager.usePhysics&&s&&(this.eventManager.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.pop(),this.activeEvent.activeDragItem.obj.rigidBody.setBodyType(0,!0),this.activeEvent.activeDragItem.paused=!0),this.activeEvent.wasDragEventTriggered===!0&&(this.activeEvent.wasDragEventTriggered=!1,this.activeEvent.actionsDrag.Transition.forEach(a=>{a.stop(),a.object.currentState!==null&&a.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrag.Animation.forEach(a=>{a.stop()}),this.activeEvent.actionsDrag.Audio.forEach(a=>{a.dispatchGameControl("stop")})),this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!0)}};let r={};e.page.traverseEntity(i=>{i.component&&(r[i.component.uuid]?r[i.component.uuid].push(i.uuid):r[i.component.uuid]=[i.uuid])}),e.page.traverseEntity(i=>{var n;(n=i.data)==null||n.events.filter(s=>s.data.type==="DragDrop"&&!s.data.disabled).forEach(s=>{this.events.push(new qme(i,s.data,e.page,e.sharedAssets,t,r))})})}connect(){if(!this.events.length)return;this.domEventsNeeded.clear(),this.domEventsNeeded.add("pointerdown");let e=this.eventContext.domElement;e.addEventListener("pointerdown",this.onPointerDown),e.addEventListener("pointermove",this.onPointerMove),e.addEventListener("pointerup",this.onPointerUp),this.domEventsNeeded.add("pointermove")}disconnect(){if(!this.events.length)return;this.domEventsNeeded.clear();let e=this.eventContext.domElement;e.removeEventListener("pointerdown",this.onPointerDown),e.removeEventListener("pointermove",this.onPointerMove),e.removeEventListener("pointerup",this.onPointerUp),this.events.forEach(t=>t.dispose())}setCursor(e){this.eventContext.domElement.style.cursor=e}onAnimationFrameDamping(){for(let e of this.events)for(let t of e.dragItems)t.paused||this.updateDragItem(t,!0)}calcPlaneIntersectPos(e,t,r,i){let{getCamera:n,raycaster:s}=this.eventContext;n().getWorldDirection(Lo),Lo.negate();let a=mc.identity();switch(i==="parent"?Gme.multiplyMatrices(e.parent.matrixWorld,e.hiddenMatrix).decompose(Ot,a,zr):i==="local"&&e.matrixWorld.decompose(Ot,a,zr),r){case"x":Ot.set(1,0,0).applyQuaternion(a),_h.copy(Lo).cross(Ot),Ws.copy(Ot).cross(_h);break;case"y":Ot.set(0,1,0).applyQuaternion(a),_h.copy(Lo).cross(Ot),Ws.copy(Ot).cross(_h);break;case"z":Ot.set(0,0,1).applyQuaternion(a),_h.copy(Lo).cross(Ot),Ws.copy(Ot).cross(_h);break;case"xy":Ws.set(0,0,1).applyQuaternion(a);break;case"yz":Ws.set(1,0,0).applyQuaternion(a);break;case"xz":Ws.set(0,1,0).applyQuaternion(a);break;case"adaptive":Lo.angleTo(zr.set(0,1,0))>Math.PI/6?(Ot.crossVectors(zr.set(0,1,0),Lo),Ws.crossVectors(Ot,zr)):Ws.set(0,1,0);break;default:Ws.copy(Lo);break}Gl.setFromMatrixPosition(e.matrixWorld);let o=e.userData.lockedPlane?e.userData.worldPosition0:Gl;if(k5.setFromNormalAndCoplanarPoint(Ws,o),!!s.ray.intersectPlane(k5,t)&&(r==="x"||r==="y"||r==="z")){let l=zr.subVectors(t,o).dot(Ot);t.copy(o).addScaledVector(Ot,l)}}updateDragItem(e,t=!1){var r,i;Gl.setFromMatrixPosition(e.obj.matrixWorld),e.reset==="current"?pp.subVectors(e.fromPosition,Gl).divideScalar(e.currentDampingFactor):e.reset==="original"?(pp.subVectors(e.obj.userData.worldPosition0,Gl).divideScalar(e.currentDampingFactor),e.fromPosition.copy(e.obj.userData.worldPosition0),e.pointStart.copy(e.fromPosition),e.pointEnd.copy(e.pointStart)):pp.subVectors(e.pointEnd,e.pointStart).add(e.fromPosition).sub(Gl).divideScalar(e.currentDampingFactor),e.paused=e.currentDampingFactor>1?pp.length()<Hme:!0,(this.activeEvent&&this.activeEvent.data.dampingFactor===1||t)&&Wme(e,pp.add(Gl),(r=this.activeEvent)!=null&&r.data.drop&&((i=this.activeEvent)!=null&&i.data.autoOrient)?e.orientationMatrix:null),e.obj.dispatchEvent({type:"beginEvent",eventName:"DragDrop"}),this.eventManager.requestRender()}},Ah=new E,Uw=new E,Ia=new E,Oa=new E,F5=new gn,Yme=.01,Qme={type:"requestRender"},Kme=function(){let e=new E,t=new E;return(r,i,n)=>n>0?(e.subVectors(r,i),e.length()<=n?r:t.copy(i).add(e.normalize().multiplyScalar(n))):i}(),U5=function(){let e=new _e;return(t,r)=>{t.position.copy(r),t.parent!==null&&(e.copy(t.parent.matrixWorld).invert(),t.position.applyMatrix4(e)),e.copy(t.hiddenMatrix).invert(),t.position.applyMatrix4(e),t.updateMatrix(),t.hasNonUniformScale&&(t.updateMatrixWorld(),t.updateMatrixWorldSVD()),t instanceof an&&na(t.parent)&&t.invalidateDownstreamBooleanData(!0)}}(),Zme=class{constructor(e,t,r,i,n){this.data=e,this.object=t,this.paused=!1,this.currentDampingFactor=1,this.snapComplete=!1,this.isReset=!1,this.worldPosition0=new E,this.timeoutId=null,this.delayFinished=!0,this.wasOutside=!1,this.data={...N2.defaultData,...e,...e.resetOnPointerLeave===void 0&&{resetOnPointerLeave:!1}},e.target===void 0||e.target==="cursor"||(this.target=r.find(e.target)),this.data.dampingFactor&&(this.currentDampingFactor=this.data.dampingFactor),this.resetDampingFactor=80/this.data.resetSpeed+1,this.object.getWorldPosition(this.worldPosition0),this.actions=En(e,e.actions,r,i,n,t)}},$me=class extends _a{constructor(e,t){super(e),this.events=[],this.pairOfEventListeners=[],this.onMouseMove=i=>{if(!(et.length>1)){this.eventContext.updateRaycaster(i);for(let n of this.events)n.target===void 0&&this.updateSingleEvent(n)}},this.onMouseEnter=i=>{for(let n of this.events)n.target===void 0&&(n.isReset=!1,n.currentDampingFactor=n.data.dampingFactor)},this.onMouseLeave=i=>{for(let n of this.events)n.target===void 0&&(n.data.resetOnPointerLeave&&(n.isReset=!0,n.currentDampingFactor=n.resetDampingFactor),this.updateSingleEvent(n))},this.onTargetChange=i=>()=>{this.updateSingleEvent(i)};let{page:r}=this.eventContext;r.traverseEntity(i=>{var s,a;let n=(s=i.data)==null?void 0:s.events.find(o=>o.data.type==="Follow"&&!o.data.disabled);n&&(!r.data.globalPhysics.usePhysics||((a=i.dataPatched.physics)==null?void 0:a.rigidBody)!=="dynamic")&&this.events.push(new Zme(n.data,i,r,e.sharedAssets,t))})}connect(){if(!this.events.length)return;let{domElement:e,eventElement:t}=this.eventContext;this.domEventsNeeded.clear(),wn&&(this.domEventsNeeded.add("pointerdown"),e.addEventListener("pointerdown",this.onMouseMove)),this.domEventsNeeded.add("pointermove"),t.addEventListener("pointermove",this.onMouseMove),this.eventContext.useWindowEvents||(e.addEventListener("pointerenter",this.onMouseEnter),e.addEventListener("pointerleave",this.onMouseLeave));for(let r of this.events)if(r.target!==void 0){let i=r.target,n=this.onTargetChange(r);this.pairOfEventListeners.push([i,n]),i.addEventListener("requestRender",n)}}disconnect(){if(!this.events.length)return;let{domElement:e,eventElement:t}=this.eventContext;this.domEventsNeeded.clear(),wn&&e.removeEventListener("pointerdown",this.onMouseMove),t.removeEventListener("pointermove",this.onMouseMove),e.removeEventListener("pointerenter",this.onMouseEnter),e.removeEventListener("pointerleave",this.onMouseLeave);for(let[r,i]of this.pairOfEventListeners)r.removeEventListener("requestRender",i);for(let r of this.events)r.paused=!0,r.isReset=!1,on(r.actions)}onAnimationFrameDamping(){for(let e of this.events)e.paused||this.updateSingleEvent(e,!0)}updateSingleEvent(e,t=!1){var a;this.events.forEach(o=>{o.actions.Create.forEach(l=>{l.dispatchThrottled()})});let{plane:r,limitDistance:i,limitDistanceEnabled:n}=e.data;if(e.object.getWorldPosition(Ia),e.isReset)Oa.copy(e.worldPosition0);else if(e.target)e.target.getWorldPosition(Oa);else{let{getCamera:o,raycaster:l}=this.eventContext;if(r==="custom"?(o().getWorldDirection(Uw),Uw.negate(),Ah.copy(Uw)):r==="xy"?Ah.set(0,0,1):r==="xz"?Ah.set(0,1,0):r==="yz"&&Ah.set(1,0,0),F5.setFromNormalAndCoplanarPoint(Ah,Ia),!l.ray.intersectPlane(F5,Oa))return}if(!e.isReset){if(Oa.distanceTo(e.worldPosition0)>i&&n&&e.target)if(e.snapComplete=!1,e.data.snapDelay&&(e.delayFinished=!1,typeof window<"u"&&e.timeoutId!==null&&(window.clearTimeout(e.timeoutId),e.timeoutId=null)),e.wasOutside=!0,e.data.resetAfterDistanceLimit)Oa.copy(e.worldPosition0),e.currentDampingFactor=e.resetDampingFactor;else return;else if(e.wasOutside&&(e.data.snapDelay&&typeof window<"u"&&(e.timeoutId=window.setTimeout(()=>{e.delayFinished=!0,e.paused=!1,this.updateSingleEvent(e)},e.data.snapDelay*1e3)),e.currentDampingFactor=e.data.dampingFactor,e.wasOutside=!1),e.delayFinished===!1)return}e.data.enabledTranslation[0]===!1&&(Oa.x=Ia.x),e.data.enabledTranslation[1]===!1&&(Oa.y=Ia.y),e.data.enabledTranslation[2]===!1&&(Oa.z=Ia.z);let s=Kme(Ia,Oa,e.wasOutside?0:e.data.maxDelta);if(e.currentDampingFactor>1){let o=Ah.subVectors(s,Ia).divideScalar(e.currentDampingFactor);Ia.add(o),t&&U5(e.object,Ia),e.paused=o.length()<Yme}else U5(e.object,s),e.paused=!0;(a=e.object)==null||a.dispatchEvent({type:"beginEvent",eventName:"Follow"}),e.object.dispatchEvent(Qme)}},fp=new E,iv=new E,mp=new _e,Ch=new ft,Io=new ft,gp=new E,vp=new E,Wl=new E,Ra=new E,jw=new gn,Jme=1e-6,ege={type:"requestRender"},tge={type:"changeRotation"},j5=function(){let e=new _e;return function(t,r){t.parent!==null?e.multiplyMatrices(t.parent.matrixWorld,t.hiddenMatrix):e.copy(t.hiddenMatrix),r.premultiply(m8(e).invert()),t.rotation.setFromRotationMatrix(r),t.updateMatrix(),t instanceof an&&na(t.parent)&&t.invalidateDownstreamBooleanData(!0)}}(),rge=class{constructor(e,t,r){this.object=t,this.paused=!1,this.currentDampingFactor=1,this.isReset=!1,this.worldQuaternion0=new ft,this.timeoutId=null,this.delayFinished=!0,this.wasOutside=!1,this.data={...F2.defaultData,...e,...e.resetOnPointerLeave===void 0&&{resetOnPointerLeave:!1}},e.target===void 0||e.target==="cursor"||(this.target=r.find(e.target)),this.data.dampingFactor&&(this.currentDampingFactor=this.data.dampingFactor),this.object.getWorldQuaternion(this.worldQuaternion0),this.resetDampingFactor=80/this.data.resetSpeed+1}},ige=class extends _a{constructor(e){super(e),this.events=[],this.pairOfEventListeners=[],this.pairOfUserEventListeners=[],this.onMouseMove=r=>{if(!(et.length>1)){this._lastMouseEvent=r,this.eventContext.updateRaycaster(r);for(let i of this.events)i.target===void 0&&this.updateSingleEvent(i)}},this.onMouseEnter=r=>{for(let i of this.events)i.target===void 0&&(i.isReset=!1,i.currentDampingFactor=i.data.dampingFactor)},this.onMouseLeave=r=>{for(let i of this.events)i.target===void 0&&(i.data.resetOnPointerLeave&&(i.isReset=!0,i.currentDampingFactor=i.resetDampingFactor),this.updateSingleEvent(i))},this.onScroll=r=>{if(this._lastMouseEvent){let i=new PointerEvent("pointermove",{clientX:this._lastMouseEvent.clientX,clientY:this._lastMouseEvent.clientY,bubbles:!0,cancelable:!0,view:window});this.eventContext.eventElement.dispatchEvent(i)}},this.onTargetChange=r=>()=>{this.updateSingleEvent(r)},this.createUserEventListener=r=>({eventName:i,target:n})=>{if(!i||!n)return;let s=_m(i);s&&s==="LookAt"&&this.updateSingleEvent(r)};let{page:t}=this.eventContext;t.traverseEntity(r=>{var n,s;let i=(n=r.data)==null?void 0:n.events.find(a=>a.data.type==="LookAt"&&!a.data.disabled);i&&(!t.data.globalPhysics.usePhysics||((s=r.dataPatched.physics)==null?void 0:s.rigidBody)!=="dynamic")&&this.events.push(new rge(i.data,r,t))})}connect(){if(!this.events.length)return;let{domElement:e,eventElement:t}=this.eventContext;this.domEventsNeeded.clear(),wn&&(this.domEventsNeeded.add("pointerdown"),e.addEventListener("pointerdown",this.onMouseMove)),this.domEventsNeeded.add("pointermove"),t.addEventListener("pointermove",this.onMouseMove),this.eventContext.useWindowEvents?t.addEventListener("scroll",this.onScroll):(e.addEventListener("pointerenter",this.onMouseEnter),e.addEventListener("pointerleave",this.onMouseLeave));for(let r of this.events){if(r.target!==void 0){let s=this.onTargetChange(r),a=r.target;this.pairOfEventListeners.push([a,s]),a.addEventListener("requestRender",s)}let i=this.createUserEventListener(r),n=r.object;this.pairOfUserEventListeners.push([n,i]),n.addEventListener("userEvent",i)}}disconnect(){if(!this.events.length)return;let{domElement:e,eventElement:t}=this.eventContext;this.domEventsNeeded.clear(),wn&&e.removeEventListener("pointerdown",this.onMouseMove),t.removeEventListener("pointermove",this.onMouseMove),e.removeEventListener("pointerenter",this.onMouseEnter),e.removeEventListener("pointerleave",this.onMouseLeave),t.removeEventListener("scroll",this.onScroll);for(let[r,i]of this.pairOfEventListeners)r.removeEventListener("requestRender",i);for(let[r,i]of this.pairOfUserEventListeners)r.removeEventListener("userEvent",i);for(let r of this.events)r.paused=!0,r.isReset=!1}onAnimationFrameDamping(){for(let e of this.events)e.paused||this.updateSingleEvent(e)}updateSingleEvent(e){var d;let{tilt:t,axis:r,distance:i,plane:n,limitDistance:s,enabledRotation:a,limitDistanceEnabled:o}=e.data,{getCamera:l,raycaster:c}=this.eventContext,{object:u,target:h}=e;if(u.getWorldPosition(gp),!e.isReset)if(e.target)e.target.getWorldPosition(vp);else{if(n==="custom"?(l().getWorldDirection(iv),iv.negate(),jw.setFromNormalAndCoplanarPoint(iv,gp)):(n==="xy"?fp.set(0,0,1):n==="xz"?fp.set(0,1,0):n==="yz"&&fp.set(1,0,0),jw.setFromNormalAndCoplanarPoint(fp,gp)),!c.ray.intersectPlane(jw,vp))return;i>0&&(n==="custom"||n===void 0)&&vp.addScaledVector(iv,i)}if(e.isReset||(h?t==="target"?Wl.copy(h.up).applyMatrix4(mp.extractRotation(h.matrixWorld)).normalize():a.some(p=>p===!1)?(r==="x"?(Ra.set(0,0,1),a[2]===!1&&Ra.set(0,1,0)):r==="y"?(Ra.set(1,0,0),a[0]===!1&&Ra.set(0,0,1)):(Ra.set(0,1,0),a[1]===!1&&Ra.set(1,0,0)),Wl.copy(Ra).applyQuaternion(e.worldQuaternion0).normalize()):Wl.set(0,1,0):n==="custom"?Wl.set(0,1,0):Wl.copy(fp)),e.isReset)Io.copy(e.worldQuaternion0);else if(gp.distanceTo(vp)>s&&o&&h)if(e.data.snapDelay&&(e.delayFinished=!1,typeof window<"u"&&e.timeoutId!==null&&(window.clearTimeout(e.timeoutId),e.timeoutId=null)),e.wasOutside=!0,e.data.resetAfterDistanceLimit)Io.copy(e.worldQuaternion0),e.currentDampingFactor=e.resetDampingFactor;else return;else{if(e.wasOutside&&(e.data.snapDelay&&typeof window<"u"&&(e.timeoutId=window.setTimeout(()=>{e.delayFinished=!0,e.paused=!1,this.updateSingleEvent(e)},e.data.snapDelay*1e3)),e.currentDampingFactor=e.data.dampingFactor,e.wasOutside=!1),e.delayFinished===!1)return;nge(mp,vp,gp,Wl,r,Ra),Io.setFromRotationMatrix(mp),Ch.setFromUnitVectors(Ra.applyQuaternion(Io),Wl),a.some(p=>p===!1)&&t!=="target"&&Io.premultiply(Ch).normalize()}e.currentDampingFactor>1?(u.updateWorldMatrix(!0,!1),Ch.setFromRotationMatrix(m8(u.matrixWorld)),Ch.slerp(Io,1/e.currentDampingFactor),j5(u,mp.makeRotationFromQuaternion(Ch)),e.paused=8*(1-Ch.dot(Io))<Jme):(j5(u,mp.makeRotationFromQuaternion(Io)),e.paused=!0),(d=e.object)==null||d.dispatchEvent({type:"beginEvent",eventName:"LookAt"}),u.dispatchEvent(ege),u.dispatchEvent(tge)}},zn=new E,Br=new E,yr=new E;function nge(e,t,r,i,n,s){let a=e.elements;yr.subVectors(t,r),yr.lengthSq()===0&&(yr.z=1),yr.normalize(),Br.crossVectors(i,yr),Br.lengthSq()===0&&(Math.abs(i.z)===1?yr.x+=1e-4:yr.z+=1e-4,yr.normalize(),Br.crossVectors(i,yr)),Br.normalize(),zn.crossVectors(yr,Br),n==="x"?s.z===1?[Br,zn,yr]=[yr,Br,zn]:(Br.negate(),[Br,yr]=[yr,Br]):n==="y"?s.x===1?[Br,zn,yr]=[zn,yr,Br]:(Br.negate(),[zn,yr]=[yr,zn]):s.x===1&&(Br.negate(),[Br,zn]=[zn,Br]),a[0]=Br.x,a[4]=zn.x,a[8]=yr.x,a[1]=Br.y,a[5]=zn.y,a[9]=yr.y,a[2]=Br.z,a[6]=zn.z,a[10]=yr.z}var sge=class{constructor(e,t,r,i,n,s){this.id=e,this.data=t,this.object=r,this.entered=!1,this.actions=En(t,t.actions,i,n,s,r)}disconnect(){on(this.actions)}dispatchEnter(){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.entered||(this.entered=!0,this.actions.Transition.forEach(e=>e.playFromCurrent()),this.actions.Animation.forEach(e=>e.play()),this.actions.Create.forEach(e=>e.dispatch()),this.actions.Destroy.forEach(e=>e.dispatch()),this.actions.SwitchCamera.forEach(e=>e.playFromCurrent()),this.actions.SceneTransition.forEach(e=>e.dispatch()))}dispatchLeave(){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.entered&&(this.entered=!1,this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.reverseFromCurrent()))}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Animation.forEach(t=>t.playFromCurrent()),this.actions.Create.forEach(t=>t.dispatch()),this.actions.Destroy.forEach(t=>t.dispatch()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent())),this.actions.SceneTransition.forEach(t=>t.dispatch())}},age=class extends _a{constructor(e,t){super(e),this.eventsPerObjects={},this.objects=[],this._prevObjects=[],this.onMouseDown=n=>{et.length>1||(this.eventContext.updateRaycaster(n),this.handleMouseHoverEvent())},this.onMouseUp=n=>{et.length>1||this.handleMouseHoverEvent(!0)},this.onMouseMove=n=>{et.length>1||(this.eventContext.updateRaycaster(n),this.handleMouseHoverEvent())},this.onUserEvent=({eventName:n,target:s,reverse:a})=>{var l;if(!n||!s)return;let o=_m(n);o&&o==="MouseHover"&&(s.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(l=this.eventsPerObjects[s.uuid])==null||l.forEach(c=>c.dispatchUserEvent(a)))};let{page:r,sharedAssets:i}=this.eventContext;r.traverseEntity(n=>{var s,a;if(!(!n.visible||!((s=n.data)!=null&&s.events.length))){for(let{id:o,data:l}of n.data.events)if(!l.disabled&&l.type==="MouseHover")try{let c=new sge(o,l,n,r,i,t);this.eventsPerObjects[n.uuid]?this.eventsPerObjects[n.uuid].push(c):this.eventsPerObjects[n.uuid]=[c]}catch{}(a=this.eventsPerObjects[n.uuid])!=null&&a.length&&this.objects.push(n)}})}connect(){if(!this.objects.length)return;let{domElement:e}=this.eventContext;this.domEventsNeeded.clear(),wn&&(this.domEventsNeeded.add("pointerdown"),e.addEventListener("pointerdown",this.onMouseDown),this.domEventsNeeded.add("pointerup"),e.addEventListener("pointerup",this.onMouseUp)),this.domEventsNeeded.add("pointermove"),e.addEventListener("pointermove",this.onMouseMove),this.objects.forEach(t=>{t.addEventListener("userEvent",this.onUserEvent)})}disconnect(){if(!this.objects.length)return;let{domElement:e}=this.eventContext;this.domEventsNeeded.clear(),wn&&(e.removeEventListener("pointerdown",this.onMouseDown),e.removeEventListener("pointerup",this.onMouseUp)),e.removeEventListener("pointermove",this.onMouseMove),Object.values(this.eventsPerObjects).forEach(t=>{t.forEach(r=>{r.disconnect()})}),this.objects.forEach(t=>{t.removeEventListener("userEvent",this.onUserEvent)})}handleMouseHoverEvent(e=!1){let t=[];if(!e){let{stopRaycast:r,raycaster:i,page:n}=this.eventContext;if(r){let s=G_(i,n,this.objects);t=W_(s)}else this.objects.forEach(s=>{cy(i,s)&&t.push(s)})}this._prevObjects.length&&this._prevObjects.forEach(r=>{var i;t.includes(r)||(r.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(i=this.eventsPerObjects[r.uuid])==null||i.forEach(n=>n.dispatchLeave()))}),t.length&&t.forEach(r=>{var i;r.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(i=this.eventsPerObjects[r.uuid])==null||i.forEach(n=>n.dispatchEnter())}),this._prevObjects=t}},oge=class{constructor(e,t,r,i,n,s){this.id=e,this.data=t,this.object=r,this.scrollCounter=0,this.actions=En(t,t.actions,i,n,s,r)}connect(){this.scrollCounter=0}disconnect(){on(this.actions)}dispatch(e){this.actions.Transition.forEach(i=>{i.object.currentTransitionEvent!==this&&(i.object.currentTransitionEvent=this,i.init())});let t=e>0?1:-1;this.scrollCounter+=t,this.scrollCounter=Math.min(Math.max(this.scrollCounter,0),this.data.steps);let r=this.scrollCounter/this.data.steps;this.actions.Transition.forEach(i=>i.seek(r)),this.actions.Animation.forEach(i=>i.seek(t)),this.actions.Create.forEach(i=>i.dispatchThrottled())}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>{t.playFromCurrent()}),this.actions.Animation.forEach(t=>{t.playFromCurrent()})),this.actions.Create.forEach(t=>t.dispatchThrottled())}},lge=class{constructor(e,t,r,i,n,s,a){this.id=e,this.data=t,this.object=r,this.domElement=s,this.eventManager=a,this.scrollStart=0,this.scrollEnd=0,this.actions=En(t,t.actions,i,n,a,r)}computeScrollBounds(){let e=this.domElement.getBoundingClientRect(),t=document.body,r=document.documentElement,i=window.pageYOffset||r.scrollTop||t.scrollTop,n=r.clientTop||t.clientTop||0,s=Math.round(e.top+i-n);if(this.data.startFrom==="enter"){let a=window.innerHeight,o=e.height,l=this.data.enterAnchor,c=l==="top"?a:l==="bottom"?a-o:a-o*.5;this.scrollStart=s-c}else this.scrollStart=0;this.scrollStart+=this.data.startOffset??0,this.scrollEnd=this.scrollStart+(this.data.endAfter??400),this.box=e,this.computeScroll({x:window.scrollX,y:window.scrollY})}connect(){this.computeScrollBounds()}disconnect(){on(this.actions)}handleResize(){this.computeScrollBounds()}get isInvalidBox(){return this.box===void 0||this.box.width===0&&this.box.height===0&&this.box.top===0&&this.box.bottom===0}computeScroll({x:e,y:t}){this.actions.Transition.forEach(n=>{n.object.currentTransitionEvent!==this&&(n.object.currentTransitionEvent=this,n.init())});let r=this.scrollEnd-this.scrollStart,i=Math.min(1,Math.max(0,(t-this.scrollStart)/r));this.actions.Transition.forEach(n=>n.seek(i)),this.actions.Animation.forEach(n=>n.seek(i)),this.actions.Create.forEach(n=>n.dispatchThrottled())}dispatch(e){this.isInvalidBox&&this.computeScrollBounds(),this.computeScroll(e)}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>{t.playFromCurrent()}),this.actions.Animation.forEach(t=>{t.playFromCurrent()})),this.actions.Create.forEach(t=>t.dispatchThrottled())}},cge=class extends _a{constructor(e,t){super(e),this.wheelEventsPerObject=new Map,this.scrollEventsPerObject=new Map,this.isInview=!0,this.handleResize=()=>{[...this.scrollEventsPerObject.entries()].forEach(([a,o])=>{o.forEach(l=>l.handleResize())})},this.onScroll=a=>{if(!this.isInview)return;let o={y:window.scrollY,x:window.scrollX};[...this.scrollEventsPerObject.entries()].forEach(([l,c])=>{l.dispatchEvent({type:"beginEvent",eventName:"Scroll",scroll:o}),c.forEach(u=>u.dispatch(o))})},this.onWheel=a=>{!this.isInview||a.ctrlKey||[...this.wheelEventsPerObject.entries()].forEach(([o,l])=>{o.dispatchEvent({type:"beginEvent",eventName:"Scroll",deltaY:a.deltaY}),l.forEach(c=>c.dispatch(a.deltaY))})},this.onUserEvent=({eventName:a,target:o,reverse:l})=>{var u;if(!a||!o)return;let c=_m(a);c&&c==="Scroll"&&(o.dispatchEvent({type:"beginEvent",eventName:"Scroll"}),(u=this.wheelEventsPerObject.get(o))==null||u.forEach(h=>{h.dispatchUserEvent(l)}))};let{page:r,sharedAssets:i,domElement:n,isExport:s}=this.eventContext;r.traverseEntity(a=>{var o,l,c;if((o=a.data)!=null&&o.events.length){for(let{id:u,data:h}of a.data.events)if(!h.disabled&&h.type==="Scroll")if(h.trigger==="load"||!s){let d=new oge(u,h,a,r,i,t);this.wheelEventsPerObject.has(a)?(l=this.wheelEventsPerObject.get(a))==null||l.push(d):this.wheelEventsPerObject.set(a,[d])}else{let d=new lge(u,h,a,r,i,n,t);this.scrollEventsPerObject.has(a)?(c=this.scrollEventsPerObject.get(a))==null||c.push(d):this.scrollEventsPerObject.set(a,[d])}}}),this.intersectionObserver=new IntersectionObserver(a=>{let o=a[0];o&&(this.isInview=o.isIntersecting)},{root:null})}connect(){this.intersectionObserver.observe(this.eventContext.domElement),[...this.wheelEventsPerObject.entries()].forEach(([e,t])=>{t.forEach(r=>r.connect()),e.addEventListener("userEvent",this.onUserEvent)}),[...this.scrollEventsPerObject.entries()].forEach(([e,t])=>{t.forEach(r=>r.connect()),e.addEventListener("userEvent",this.onUserEvent)}),[...this.wheelEventsPerObject.values()].some(e=>e.length)&&(this.domEventsNeeded.add("wheel"),window.addEventListener("wheel",this.onWheel)),[...this.scrollEventsPerObject.values()].some(e=>e.length)&&(this.domEventsNeeded.add("scroll"),window.addEventListener("scroll",this.onScroll),window.addEventListener("resize",this.handleResize))}disconnect(){window.removeEventListener("wheel",this.onWheel),window.removeEventListener("scroll",this.onScroll),window.removeEventListener("resize",this.handleResize),this.intersectionObserver.unobserve(this.eventContext.domElement),this.domEventsNeeded.clear(),[...this.wheelEventsPerObject.entries()].forEach(([e,t])=>{t.forEach(r=>r.disconnect()),e.removeEventListener("userEvent",this.onUserEvent)}),[...this.scrollEventsPerObject.entries()].forEach(([e,t])=>{t.forEach(r=>r.disconnect()),e.removeEventListener("userEvent",this.onUserEvent)})}},hge=class{constructor(e,t,r,i,n,s){this.id=e,this.data=t,this.object=r,this.actions=En(t,t.actions,i,n,s,r)}disconnect(){on(this.actions)}dispatch(){this.actions.Transition.forEach(e=>{e.play()}),this.actions.Animation.forEach(e=>{e.play()}),this.actions.SwitchCamera.forEach(e=>{e.play()}),this.actions.SceneTransition.forEach(e=>{e.dispatch()}),this.actions.Create.forEach(e=>{e.dispatchFromStart()}),this.actions.Destroy.forEach(e=>{e.dispatchFromStart()})}dispatchAfter(e){this.actions.Audio.forEach(t=>{(t.interaction.data.triggerAfter??"any")===e&&(t.interaction instanceof fc?t.interaction.audioPlayer.play():t.interaction instanceof F_&&t.interaction.dispatch())}),this.actions.Video.forEach(t=>{let r=t.interaction.data.triggerAfter??"autoplay";r===e&&(t.interaction instanceof Du?t.interaction.play(r==="autoplay"):t.interaction instanceof V_&&t.interaction.dispatch())})}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Animation.forEach(t=>t.playFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent())),this.actions.SceneTransition.forEach(t=>t.dispatch()),this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch()}),this.actions.Audio.forEach(t=>{t.interaction instanceof fc?t.interaction.audioPlayer.play():t.interaction instanceof F_&&t.interaction.dispatch()}),this.actions.Video.forEach(t=>{t.interaction instanceof Du?t.interaction.play():t.interaction instanceof V_&&t.interaction.dispatch()})}},uge=class extends _a{constructor(e,t){super(e),this.eventManager=t,this.eventsPerObject=new Map,this.eventsAfterPerObject=new Map,this.onMouseDown=()=>{[...this.eventsAfterPerObject.entries()].forEach(([r,i])=>{r.dispatchEvent({type:"beginEvent",eventName:"Start"}),i.forEach(n=>{n.dispatchAfter("mouseDown")})})},this.onKeyDown=()=>{[...this.eventsAfterPerObject.entries()].forEach(([r,i])=>{r.dispatchEvent({type:"beginEvent",eventName:"Start"}),i.forEach(n=>{n.dispatchAfter("keyDown")})})},this.onAny=()=>{let{domElement:r,isExport:i}=this.eventContext;(i?document:r).removeEventListener("pointerdown",this.onAny),document.removeEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([n,s])=>{n.dispatchEvent({type:"beginEvent",eventName:"Start"}),s.forEach(a=>{a.dispatchAfter("any")})})},this.onSceneTransitionAudioVideoPlay=()=>{[...this.eventsAfterPerObject.entries()].forEach(([r,i])=>{r.dispatchEvent({type:"beginEvent",eventName:"Start"}),i.forEach(n=>{n.actions.Audio.forEach(s=>{s.interaction instanceof fc&&s.interaction.audioPlayer.play()}),n.actions.Video.forEach(s=>{let a=s.interaction.data.triggerAfter??"autoplay";s.interaction instanceof Du&&s.interaction.play(a==="autoplay")})})})},this.onPlay=()=>{[...this.eventsAfterPerObject.entries()].forEach(([r,i])=>{r.dispatchEvent({type:"beginEvent",eventName:"Start"}),i.forEach(n=>{n.dispatchAfter("autoplay")})})},this.onUserEvent=({eventName:r,target:i,reverse:n})=>{var a,o;if(!r||!i)return;let s=_m(r);s&&s==="Start"&&(i.dispatchEvent({type:"beginEvent",eventName:"Start"}),(a=this.eventsPerObject.get(i))==null||a.forEach(l=>{l.dispatchUserEvent(n)}),(o=this.eventsAfterPerObject.get(i))==null||o.forEach(l=>{l.dispatchUserEvent(n)}))}}connect(){let{sharedAssets:e,page:t}=this.eventContext;if(t.traverseEntity(r=>{var i,n,s,a;if((i=r.data)!=null&&i.events.length)for(let{id:o,data:l}of r.data.events){if(l.disabled||l.type!=="Start")continue;let c=new hge(o,l,r,t,e,this.eventManager);(c.actions.Transition.length||c.actions.Animation.length||c.actions.SwitchCamera.length||c.actions.Create.length||c.actions.Destroy.length||c.actions.SceneTransition.length)&&(this.eventsPerObject.has(r)?(n=this.eventsPerObject.get(r))==null||n.push(c):this.eventsPerObject.set(r,[c])),c.actions.Audio.length&&(this.eventsAfterPerObject.has(r)?(s=this.eventsAfterPerObject.get(r))==null||s.push(c):this.eventsAfterPerObject.set(r,[c])),c.actions.Video.length&&(this.hasVideoAction=!0,this.eventsAfterPerObject.has(r)?(a=this.eventsAfterPerObject.get(r))==null||a.push(c):this.eventsAfterPerObject.set(r,[c]))}}),[...this.eventsAfterPerObject.values()].some(r=>r.length)){if(this.eventManager.activateCount===0){let{domElement:r,isExport:i}=this.eventContext,n=i?document:r;n.addEventListener("pointerdown",this.onMouseDown,{once:!0}),n.addEventListener("mousedown",this.onMouseDown,{once:!0}),document.addEventListener("keydown",this.onKeyDown,{once:!0}),n.addEventListener("pointerdown",this.onAny),n.addEventListener("mousedown",this.onAny),document.addEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([s,a])=>{s.addEventListener("userEvent",this.onUserEvent)})}else this.onSceneTransitionAudioVideoPlay();this.onPlay()}[...this.eventsPerObject.entries()].forEach(([r,i])=>{r.dispatchEvent({type:"beginEvent",eventName:"Start"}),i.forEach(n=>n.dispatch()),r.addEventListener("userEvent",this.onUserEvent)})}disconnect(){if([...this.eventsAfterPerObject.values()].some(e=>e.length)){let{domElement:e,isExport:t}=this.eventContext,r=t?document:e;r.removeEventListener("pointerdown",this.onMouseDown),r.removeEventListener("mousedown",this.onMouseDown),document.removeEventListener("keydown",this.onKeyDown),r.removeEventListener("pointerdown",this.onAny),r.removeEventListener("mousedown",this.onAny),document.removeEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([i,n])=>{i.removeEventListener("userEvent",this.onUserEvent),n.forEach(s=>s.disconnect())})}[...this.eventsPerObject.entries()].forEach(([e,t])=>{e.removeEventListener("userEvent",this.onUserEvent),t.forEach(r=>r.disconnect())}),this.eventsPerObject.clear(),this.eventsAfterPerObject.clear()}},dge=class{constructor(e,t,r,i,n,s){this.id=e,this.data=t,this.object=r,this.disabled=!1,this.actions=En(t,t.actions,i,n,s,r),this.target=t.target,this.useToggle=t.toggle}disconnect(){on(this.actions)}dispatch(e){this.disabled||(this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),this.object.dispatchEvent({type:"beginEvent",eventName:"Collision"}),this.useToggle?(this.actions.Transition.forEach(t=>{t.toggle()}),this.actions.Animation.forEach(t=>{t.toggle()})):(this.actions.Transition.forEach(t=>{t.play()}),this.actions.Animation.forEach(t=>{t.play()})),this.actions.Reset.forEach(t=>{t.dispatch()}),this.actions.Link.forEach(t=>{t.dispatch()}),this.actions.Reset.forEach(t=>{t.dispatch()}),this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch(e??!1)}),this.actions.Audio.forEach(t=>{t.dispatchBasic()}),this.actions.Video.forEach(t=>{t.dispatchBasic()}))}},pge="https://unpkg.com/@splinetool/runtime@0.9.450/build/",fge="https://unpkg.com/@splinetool/navmesh-wasm@0.9.450/build/",mge=`
(async function() {
	const [wasmImport, wasmBinary] = await Promise.all([
		import('${pge}' + 'navmesh.js'),
		fetch('${fge}' + 'navmesh.wasm').then((res) => res.arrayBuffer()),
	]);
	const wasmModule = wasmImport.default;
	self.module = await wasmModule({ wasmBinary });
	postMessage('ready');
})();
`,gge=`
(async function() {
	const [wasmImport, wasmBinary] = await Promise.all([
		import(self.location.origin + '/_libraries/navmesh.js'),
		fetch(self.location.origin + '/_libraries/navmesh.wasm').then((res) => res.arrayBuffer()),
	]);
	const wasmModule = wasmImport.default;
	self.module = await wasmModule({ wasmBinary });
	postMessage('ready');
})();
`,vge=`

onmessage = function(messageEvent) {
	const meshData = messageEvent.data;
	const positions = meshData[0];
	const offset = meshData[1];
	const indices = meshData[2];
	const indicesLength = meshData[3];
	const parameters = meshData[4];

	const module = self.module;
	const rc = new module.rcConfig();
	rc.cs = parameters.cs;
	rc.ch = parameters.ch;
	rc.borderSize = parameters.borderSize ? parameters.borderSize : 0;
	rc.tileSize = parameters.tileSize ? parameters.tileSize : 0;
	rc.walkableSlopeAngle = parameters.walkableSlopeAngle;
	rc.walkableHeight = parameters.walkableHeight;
	rc.walkableClimb = parameters.walkableClimb;
	rc.walkableRadius = parameters.walkableRadius;
	rc.maxEdgeLen = parameters.maxEdgeLen;
	rc.maxSimplificationError = parameters.maxSimplificationError;
	rc.minRegionArea = parameters.minRegionArea;
	rc.mergeRegionArea = parameters.mergeRegionArea;
	rc.maxVertsPerPoly = parameters.maxVertsPerPoly;
	rc.detailSampleDist = parameters.detailSampleDist;
	rc.detailSampleMaxError = parameters.detailSampleMaxError;

	if (!self.navMesh) {
		self.navMesh = new module.NavMesh();
	}
	self.navMesh.build(positions, offset, indices, indicesLength, rc);

	const navmeshData = navMesh.getNavmeshData();
	const arrView = new Uint8Array(module.HEAPU8.buffer, navmeshData.dataPointer, navmeshData.size);
	const ret = new Uint8Array(navmeshData.size);
	ret.set(arrView);
	navMesh.freeNavmeshData(navmeshData);

	postMessage(ret);
}
`,yge=.001,xge={cs:6,ch:2,walkableSlopeAngle:90,walkableHeight:20,walkableClimb:5,walkableRadius:0,maxEdgeLen:12,maxSimplificationError:1.3,minRegionArea:8,mergeRegionArea:20,maxVertsPerPoly:6,detailSampleDist:6,detailSampleMaxError:1},_8,_t,ai;yae.then(e=>{_8=e,_t=new e.Vec3,ai=new e.Vec3});var wge=new E,bge=class{constructor(e=!1,t=!1){this.usePhysics=e,this.isExport=t,this.onPointerDown=r=>{if(et.length!==1)return;let{raycaster:i,page:n}=this.eventContext;this.eventContext.updateRaycaster(r);let s=n.raycastWithClones(i);if(s.length!==0){if(this.gameControl){let a=wge.copy(this.gameControl.colliderWorldPosition);a.y-=this.gameControl.colliderHeight/2,this.gameControl.path=this.computePath(a,s[0].point)}this.eventContext.requestRender()}},this.traverseWithPhysics=(r,i)=>n=>{var d,p,f,m,g,v,y;let s;if(n instanceof As)if(n.objectForSample){if(n.objectForSample.dataPatched.physics.fusedBody)return;s=n.object}else return n.object.dataPatched.physics.fusedBody===!0&&n.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(n instanceof xi)s=n.object;else if(s=n,((d=s.dataPatched.cloner)==null?void 0:d.disabled)===!1&&((p=s.dataPatched.cloner)==null?void 0:p.hideBase)&&((f=s.dataPatched.physics)==null?void 0:f.fusedBody)!==!0)return!0;if(i&&!s.userData.navmesh)return;let a=s.dataPatched;if(!a.visible&&((m=a.physics)==null?void 0:m.enabled)!==!0)return!0;n.updateMatrixWorldSVD();let o=hy(a),l=s.userData.hasDestroy,c=s.userData.hasDrag,u=!1,h=!1;for(let x of a.events)x.data.disabled!==!0&&(x.data.type==="GameControl"?u=!0:x.data.type==="Follow"&&(h=!0));if(u||o||h||l||c)return!0;if(this.usePhysics&&((g=a.physics)==null?void 0:g.rigidBody)==="dynamic"){if(this.usePhysics&&((v=a.physics)!=null&&v.fusedBody))return!0}else if("geometry"in n&&n.geometry&&r.push(qa(n.geometry,n.matrixWorld)),this.usePhysics&&((y=a.physics)==null?void 0:y.fusedBody))return n.traverseObject((x,w)=>{var A,S;if(w===0)return;let b;if(x instanceof As)if(x.objectForSample){if(x.objectForSample.dataPatched.physics.fusedBody)return;b=x.object}else return x.object.dataPatched.physics.fusedBody===!0&&x.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(x instanceof xi)b=x.object;else if(b=x,(A=x.dataPatched.cloner)==null?void 0:A.hideBase)return!0;let _=b.dataPatched;if(!_.visible&&((S=_.physics)==null?void 0:S.enabled)!==!0)return!0;"geometry"in x&&x.geometry&&r.push(qa(x.geometry,x.matrixWorld))}),!0},this.traverseNoPhysics=(r,i)=>n=>{let s;if(n instanceof As)return;n instanceof xi?s=n.object:s=n;let a=s.dataPatched;if(a.physics.enabled==="visibility"?!a.visible:!a.physics.enabled)return!0;if(i&&!s.userData.navmesh)return;let o=n.geometry,l=s.userData.hasDestroy===!0,c=s.userData.hasDrag===!0;if(hy(a)||l||c||s.dataPatched.events.some(u=>u.data.disabled!==!0&&u.data.type==="GameControl"))return!0;o&&r.push(qa(o,n.matrixWorld))},this.navmeshWasm=_8,this.navMesh=new this.navmeshWasm.NavMesh,this._workerURL=URL.createObjectURL(new Blob([(t?mge:gge)+vge])),this._worker=new Worker(this._workerURL)}init(e,t,r){this.gameControl=t,this.eventContext=r,this.resolution=e.ch,this.setDefaultQueryExtent(new E().setScalar(e.ch*e.walkableRadius*1.2)),this._worker.onmessage=()=>{this.createNavMesh(r.page,e,i=>{this.buildFromNavmeshData(i.data)})},this.eventContext.renderer.domElement.addEventListener("pointerdown",this.onPointerDown)}createNavMesh(e,t,r){t.objects.forEach(l=>{var u;let c=e.scene.find(l);c.traverseEntity(h=>{h.userData.navmesh=!0}),(u=c.cloner)==null||u.traverseObject(h=>{h.userData.navmesh=!0})});let i=[],n=(this.usePhysics?this.traverseWithPhysics:this.traverseNoPhysics)(i,t.zones==="custom");if(e.traverseChildren(n),t.objects.forEach(l=>{var u;let c=e.scene.find(l);c.traverseEntity(h=>{h.userData.navmesh=void 0}),(u=c.cloner)==null||u.traverseObject(h=>{h.userData.navmesh=void 0})}),i.length===0)return!1;let s=dc(i),{positions:a,triIndices:o}=i1(s.getAttribute("position"),s.getIndex());return this._worker.postMessage([a,a.length/3,o,o.length,{...xge,...t}]),this._worker.onmessage=r,!0}createDebugNavGeometry(){let e,t,r=this.navMesh.getDebugNavMesh(),i=r.getTriangleCount(),n=new Uint32Array(i*3),s=new Float32Array(i*3*3);for(e=0;e<i*3;e++)n[e]=e;for(e=0;e<i;e++)for(t=0;t<3;t++){let o=r.getTriangle(e).getPoint(t);s[e*9+t*3+0]=o.x,s[e*9+t*3+1]=o.y,s[e*9+t*3+2]=o.z}let a=new it;return a.setIndex(new nt(n,1)),a.setAttribute("position",new nt(s,3)),a}getClosestPoint(e){return _t.x=e.x,_t.y=e.y,_t.z=e.z,this.navMesh.getClosestPoint(_t)}getClosestPointToRef(e,t){_t.x=e.x,_t.y=e.y,_t.z=e.z;let r=this.navMesh.getClosestPoint(_t);t.set(r.x,r.y,r.z)}getRandomPointAround(e,t){return _t.x=e.x,_t.y=e.y,_t.z=e.z,this.navMesh.getRandomPointAround(_t,t)}getRandomPointAroundToRef(e,t,r){_t.x=e.x,_t.y=e.y,_t.z=e.z;let i=this.navMesh.getRandomPointAround(_t,t);r.set(i.x,i.y,i.z)}moveAlong(e,t){return _t.x=e.x,_t.y=e.y,_t.z=e.z,ai.x=t.x,ai.y=t.y,ai.z=t.z,this.navMesh.moveAlong(_t,ai)}moveAlongToRef(e,t,r){return _t.x=e.x,_t.y=e.y,_t.z=e.z,ai.x=t.x,ai.y=t.y,ai.z=t.z,this.navMesh.moveAlong(_t,ai)}computePath(e,t){let r=this.getClosestPoint(t);ai.x=r.x,ai.y=r.y,ai.z=r.z,this.getClosestPoint(e);let i=this.navMesh.computePath(_t,ai),n=i.getPointCount(),s=[];for(let a=0;a<n;a++){let o=i.getPoint(a);s.push(new E(o.x,o.y,o.z))}return s}createCrowd(e,t){return new _ge(this,e,t)}setDefaultQueryExtent(e){_t.x=e.x,_t.y=e.y,_t.z=e.z,this.navMesh.setDefaultQueryExtent(_t)}getDefaultQueryExtent(){return this.navMesh.getDefaultQueryExtent()}buildFromNavmeshData(e){let t=e.length*e.BYTES_PER_ELEMENT,r=this.navmeshWasm._malloc(t),i=new Uint8Array(this.navmeshWasm.HEAPU8.buffer,r,t);i.set(e);let n=new this.navmeshWasm.NavmeshData;n.dataPointer=i.byteOffset,n.size=e.length,this.navMesh.buildFromNavmeshData(n),this.navmeshWasm._free(i.byteOffset)}getNavmeshData(){let e=this.navMesh.getNavmeshData(),t=new Uint8Array(this.navmeshWasm.HEAPU8.buffer,e.dataPointer,e.size),r=new Uint8Array(e.size);return r.set(t),this.navMesh.freeNavmeshData(e),r}getDefaultQueryExtentToRef(e){let t=this.navMesh.getDefaultQueryExtent();e.set(t.x,t.y,t.z)}dispose(){var e;this.navMesh.destroy(),this._worker.terminate(),URL.revokeObjectURL(this._workerURL),(e=this.eventContext)==null||e.renderer.domElement.removeEventListener("pointerdown",this.onPointerDown)}addCylinderObstacle(e,t,r){return _t.x=e.x,_t.y=e.y,_t.z=e.z,this.navMesh.addCylinderObstacle(_t,t,r)}addBoxObstacle(e,t,r){return _t.x=e.x,_t.y=e.y,_t.z=e.z,ai.x=t.x,ai.y=t.y,ai.z=t.z,this.navMesh.addBoxObstacle(_t,ai,r)}removeObstacle(e){this.navMesh.removeObstacle(e)}isSupported(){return this.navmeshWasm!==void 0}},_ge=class{constructor(e,t,r){this.navmeshWasmWrapper=e,this.transforms=[],this.agents=new Array,this.reachRadii=new Array,this._agentDestinationArmed=new Array,this._agentDestination=new Array,this.crowd=new this.navmeshWasmWrapper.navmeshWasm.Crowd(t,r,this.navmeshWasmWrapper.navMesh.getNavMesh())}onReachTarget(e,t){}addAgent(e,t,r){let i=new this.navmeshWasmWrapper.navmeshWasm.dtCrowdAgentParams;i.radius=t.radius,i.height=t.height,i.maxAcceleration=t.maxAcceleration,i.maxSpeed=t.maxSpeed,i.collisionQueryRange=t.collisionQueryRange,i.pathOptimizationRange=t.pathOptimizationRange,i.separationWeight=t.separationWeight,i.updateFlags=7,i.obstacleAvoidanceType=0,i.queryFilterType=0,i.userData=0;let n=this.crowd.addAgent(new this.navmeshWasmWrapper.navmeshWasm.Vec3(e.x,e.y,e.z),i);return this.transforms.push(r),this.agents.push(n),this.reachRadii.push(t.reachRadius?t.reachRadius:t.radius),this._agentDestinationArmed.push(!1),this._agentDestination.push(new E(0,0,0)),n}getAgentPosition(e){return this.crowd.getAgentPosition(e)}getAgentPositionToRef(e,t){let r=this.crowd.getAgentPosition(e);t.set(r.x,r.y,r.z)}getAgentVelocity(e){return this.crowd.getAgentVelocity(e)}getAgentVelocityToRef(e,t){let r=this.crowd.getAgentVelocity(e);t.set(r.x,r.y,r.z)}getAgentNextTargetPath(e){return this.crowd.getAgentNextTargetPath(e)}getAgentNextTargetPathToRef(e,t){let r=this.crowd.getAgentNextTargetPath(e);t.set(r.x,r.y,r.z)}getAgentState(e){return this.crowd.getAgentState(e)}overOffmeshConnection(e){return this.crowd.overOffmeshConnection(e)}agentGoto(e,t){this.crowd.agentGoto(e,new this.navmeshWasmWrapper.navmeshWasm.Vec3(t.x,t.y,t.z));let r=this.agents.indexOf(e);r>-1&&(this._agentDestinationArmed[r]=!0,this._agentDestination[r].set(t.x,t.y,t.z))}agentTeleport(e,t){this.crowd.agentTeleport(e,new this.navmeshWasmWrapper.navmeshWasm.Vec3(t.x,t.y,t.z))}updateAgentParameters(e,t){let r=this.crowd.getAgentParameters(e);t.radius!==void 0&&(r.radius=t.radius),t.height!==void 0&&(r.height=t.height),t.maxAcceleration!==void 0&&(r.maxAcceleration=t.maxAcceleration),t.maxSpeed!==void 0&&(r.maxSpeed=t.maxSpeed),t.collisionQueryRange!==void 0&&(r.collisionQueryRange=t.collisionQueryRange),t.pathOptimizationRange!==void 0&&(r.pathOptimizationRange=t.pathOptimizationRange),t.separationWeight!==void 0&&(r.separationWeight=t.separationWeight),this.crowd.setAgentParameters(e,r)}removeAgent(e){this.crowd.removeAgent(e);let t=this.agents.indexOf(e);t>-1&&(this.agents.splice(t,1),this.transforms.splice(t,1),this.reachRadii.splice(t,1),this._agentDestinationArmed.splice(t,1),this._agentDestination.splice(t,1))}getAgents(){return this.agents}update(e){if(this.navmeshWasmWrapper.navMesh.update(),e<=yge)return;let t=1/60,r=10;{let i=Math.floor(e/t);i>r&&(i=r),i<1&&(i=1);let n=e/i;for(let s=0;s<i;s++)this.crowd.update(n)}for(let i=0;i<this.agents.length;i++){let n=this.agents[i],s=this.getAgentPosition(n);if(this.transforms[i].copy(s),this._agentDestinationArmed[i]){let a=s.x-this._agentDestination[i].x,o=s.z-this._agentDestination[i].z,l=this.reachRadii[i],c=this._agentDestination[i].y-this.reachRadii[i],u=this._agentDestination[i].y+this.reachRadii[i],h=a*a+o*o;s.y>c&&s.y<u&&h<l*l&&(this.onReachTarget(n,this._agentDestination[i]),this._agentDestinationArmed[i]=!1)}}}setDefaultQueryExtent(e){let t=new this.navmeshWasmWrapper.navmeshWasm.Vec3(e.x,e.y,e.z);this.crowd.setDefaultQueryExtent(t)}getDefaultQueryExtent(){return this.crowd.getDefaultQueryExtent()}getDefaultQueryExtentToRef(e){let t=this.crowd.getDefaultQueryExtent();e.set(t.x,t.y,t.z)}getCorners(e){let t,r=this.crowd.getCorners(e),i=r.getPointCount(),n=[];for(t=0;t<i;t++){let s=r.getPoint(t);n.push(new E(s.x,s.y,s.z))}return n}dispose(){this.crowd.destroy()}};function Sge(e){let t=!1;return e.scene.objects.forEach(r=>{r.data.type==="Page"&&!t&&r.data.publish.gameControlObject&&Gf.traverseModuleInstances(e,r.id,(i,n,s)=>{for(let a of s)a.data.type==="GameControl"&&a.data.navmesh.enabled&&(t=!0)})}),t}var Age={type:"change"},V5={type:"changeZoom"},Cge={type:"changePan"},Mh={type:"start"},Eh={type:"end",changed:!0},Mge={type:"end",changed:!1},Vw=new ft,H5=new W,Ege=2*Math.PI,Tge=1e-8,Pge=.01,Hw=new E,nv=new W,Gw=new E,sv=new ft,G5=new _e,Dge={type:"requestRender"},S8=class extends ui{constructor(e,t,r={isPlayMode:!1,isExport:!1}){super(),this.object=e,this.domElement=t,this.options=r,this.enabled=!0,this.useKeyEvents=!0,this.enableDamping=!1,this.enableZoom=!0,this.enableRotate=!0,this.enablePan=!0,this.autoRotate=!1,this.rotationLimitsMode=0,this.panLimitsMode=0,this.rotationSoftLimit=2,this.panSoftLimit=2,this.hoverRotatePanMode=0,this.zoomLimitsEnabled=!1,this.mouseButtons=[0,5],this.mouseButtonsPlay=[3,4,5],this.touches=[null,Ln.DOLLY_ROTATE,Ln.PAN],this.offset=new E,this.eye=new E,this.lastPosition=new E,this.lastQuaternion=new ft,this.current=new W,this.overShoot=new W,this.overRatio=new W,this.spherical=new dP,this.sphericalDelta=new dP,this.panOffset=new E,this.panLeftV=new E,this.panUpV=new E,this.panV=new E,this.rotateStart=new W,this.rotateEnd=new W,this.rotateDelta=new W,this.panStart=new W,this.panEnd=new W,this.panDelta=new W,this.dollyStart=new W,this.dollyEnd=new W,this.dollyDelta=new W,this.rotationRangeFactor=new W,this.panRangeFactor=new W,this.state=-1,this.zoomChanged=!1,this.isPointerDown=!1,this.isThetaFlipped=!1,this.prevScale=0,this.scale=1,this.gesture=!1,this.timer=-1,this.timerHover=-1,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPhi=0,this.maxPhi=Math.PI,this.minTheta=-1/0,this.maxTheta=1/0,this.minH=0,this.maxH=Math.PI,this.minV=-1/0,this.maxV=1/0,this.autoRotateClockwise=!0,this.isPanOverShoot=!1,this.isRotateOverShoot=!1,this.resetHoverEffectOnPointerLeave=!1,this.hasChange=!1,this.useWindowEvents=!1,this.isTouchZoom=!0,this.autoRotateSpeed=2,this.dampingFactor=.125,this.zoomSpeed=2,this.rotateSpeed=1,this.panSpeed=1,this.hoverRotatePanStrength=.1,this.thetaIsFree=!1,this.phiIsFree=!1,this.needsUpdate=!0,this.onCameraChange=i=>{this.object.removeEventListener("beginState",this.onBeginState),this.object.removeEventListener("completeState",this.onCompleteState),this.object.removeEventListener("cameraChange",this.onCameraChange),this.object=i.camera,this.object.addEventListener("beginState",this.onBeginState),this.object.addEventListener("completeState",this.onCompleteState),this.object.addEventListener("cameraChange",this.onCameraChange)},this.update=()=>{this.object.updateWorldMatrix(!0,!1),this.object.matrixWorld.decompose(Gw,sv,Hw),this.offset.copy(Gw).sub(this.target),this.spherical.setFromVector3(this.offset),this.object.isUpVectorFlipped&&(this.spherical.phi*=-1,this.spherical.theta-=Math.PI),this.autoRotate&&this.state===-1&&this.rotateLeft((this.autoRotateClockwise===!0?1:-1)*this.getAutoRotationAngle()),this.rotationLimitsMode!==0&&this.applyLimits(this.sphericalDelta,this.rotationLimitsMode,this.rotationSoftLimit,this.maxTheta,this.minTheta,this.maxPhi,this.minPhi,this.rotationRangeFactor),this.rotationLimitsMode!==2&&(this.spherical.phi+=this.sphericalDelta.phi),(this.rotationLimitsMode!==1||this.autoRotate===!0)&&(this.spherical.theta+=this.sphericalDelta.theta),this.spherical.radius*=this.scale,this.zoomLimitsEnabled&&(this.spherical.radius=Math.max(this.minDistance,Math.min(this.maxDistance,this.spherical.radius))),this.panLimitsMode!==0&&(this.target.applyQuaternion(Vw.copy(sv).invert()),this.panOffset.applyQuaternion(Vw),this.applyLimits(this.panOffset,this.panLimitsMode,this.panSoftLimit,this.maxH,this.minH,this.maxV,this.minV,this.panRangeFactor),this.target.applyQuaternion(sv),this.panOffset.applyQuaternion(sv)),this.panLimitsMode===2&&(this.panOffset.y=0),this.panLimitsMode===1&&(this.panOffset.x=0),this.state===-1&&!this.gesture?(this.panOffset.multiplyScalar(1-this.dampingFactor),this.target.add(this.panOffset)):(this.target.add(this.panOffset),this.panOffset.set(0,0,0)),this.offset.setFromSpherical(this.spherical),Gw.copy(this.target).add(this.offset),this.object.position.copy(this.target).add(this.offset),this.object.parent&&(G5.copy(this.object.parent.matrixWorld).invert(),this.object.position.applyMatrix4(G5));let i=this.spherical.phi%Ege;return this.eye.copy(this.offset).normalize(),this.object.up.copy(Vt.DEFAULT_UP).applyAxisAngle(this.eye,this.object.angleOffsetFromUp),i>0&&i>Math.PI||i<0&&i>-Math.PI?(this.object.up.negate(),this.object.lookAt(this.target),this.object.isUpVectorFlipped=!0):(this.object.lookAt(this.target),this.object.isUpVectorFlipped=!1),this.state===-1||this.enableDamping===!0?(this.sphericalDelta.theta*=1-this.dampingFactor,this.sphericalDelta.phi*=1-this.dampingFactor):this.sphericalDelta.set(0,0,0),this.scale=1,this.zoomChanged||this.lastPosition.distanceToSquared(this.object.position)>Pge||8*(1-this.lastQuaternion.dot(this.object.quaternion))>Tge?(this.dispatchEvent(Age),this.object.dispatchEvent(Dge),this.lastPosition.copy(this.object.position),this.lastQuaternion.copy(this.object.quaternion),this.zoomChanged=!1,!0):(this.isPanOverShoot=!1,this.isRotateOverShoot=!1,this.object.wasMovedBySwitchCameraAction=!1,this.sphericalDelta.set(0,0,0),this.panOffset.set(0,0,0),!1)},this.onPointerDown=i=>{this.enabled!==!1&&(i.pointerType==="touch"||i.pointerType==="pen"&&wn?this.onPointerDownTouch(i):this.onPointerDownMouse(i),this.state!==-1&&(this.isPointerDown=!0,this.dispatchEvent(Mh),this.domElement.addEventListener("pointermove",this.onPointerMove),this.domElement.addEventListener("pointerup",this.onPointerUp),i.stopPropagation(),i.pointerType==="touch"||i.pointerType==="pen"&&wn||this.domElement.setPointerCapture(i.pointerId)))},this.onPointerLeave=i=>{this.resetHoverEffectOnPointerLeave&&!this.useWindowEvents?(this.hoverRotatePanMode===1?(this.sphericalDelta.theta=-this.spherical.theta,this.sphericalDelta.phi=-this.spherical.phi,Hw.subVectors(this.position0,this.target0),this.spherical.setFromVector3(Hw),this.sphericalDelta.theta+=this.spherical.theta,this.sphericalDelta.phi+=this.spherical.phi,this.sphericalDelta.theta/=8,this.sphericalDelta.phi/=8):this.hoverRotatePanMode===2&&this.panOffset.subVectors(this.target0,this.target).divideScalar(8),this.update()):this.pointerLeaveEvent=i},this.onPointerEnter=i=>{this.resetHoverEffectOnPointerLeave||this.pointerLeaveEvent===void 0?nv.set(i.clientX-this.domElement.clientWidth/2,i.clientY-this.domElement.clientHeight/2):nv.set(i.clientX-this.pointerLeaveEvent.clientX,i.clientY-this.pointerLeaveEvent.clientY),this.hoverRotatePanMode===1?(this.rotateDelta.copy(nv).multiplyScalar(this.rotateSpeed*this.hoverRotatePanStrength).rotateAround(H5,-this.object.angleOffsetFromUp),this.rotateLeft(2*Math.PI*this.rotateDelta.x/this.domElement.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/this.domElement.clientHeight),this.rotateStart.set(i.clientX,i.clientY)):this.hoverRotatePanMode===2&&(this.panDelta.copy(nv).multiplyScalar(this.panSpeed*this.hoverRotatePanStrength),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.set(i.clientX,i.clientY)),this.update()},this.onPointerMove=i=>{this.enabled!==!1&&(this.checkRaycastLock()||(i.pointerType==="touch"||i.pointerType==="pen"&&wn?this.onPointerMoveTouch(i):this.onPointerMoveMouse(i),i.stopPropagation()))},this.onPointerUp=i=>{this.isPointerDown=!1,et.length===0&&(this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)),et.length>1&&i.preventDefault(),this.hasChange?this.dispatchEvent(Eh):this.dispatchEvent(Mge),this.state=-1,i&&(i.stopPropagation(),i.pointerType==="touch"||i.pointerType==="pen"&&wn||this.domElement.releasePointerCapture(i.pointerId))},this.onPointerDownMouse=i=>{let n;switch(this.useKeyEvents?n=this.mouseButtons[i.button]:n=this.mouseButtonsPlay[i.button],n){case 0:if(i.altKey===!0&&!i.shiftKey&&!_g(i)){if(this.enableRotate===!1)return;this.handleMouseDownRotate(i),this.state=0}else if(this.key===" "){if(this.enablePan===!1)return;this.handleMouseDownPan(i),this.state=2}break;case 4:if(this.enablePan===!1)return;this.handleMouseDownPan(i),this.state=2;break;case 3:if(_g(i)||i.shiftKey){if(this.enablePan===!1)return;this.handleMouseDownPan(i),this.state=2}else{if(this.enableRotate===!1)return;this.handleMouseDownRotate(i),this.state=0}break;case 5:if(_g(i)||i.shiftKey){if(this.enableRotate===!1)return;this.handleMouseDownRotate(i),this.state=0}else{if(this.enablePan===!1)return;this.handleMouseDownPan(i),this.state=2}break;default:this.state=-1}},this.onPointerMoveMouse=i=>{switch(this.state){case 0:if(this.enableRotate===!1)return;this.handleMouseMoveRotate(i);break;case 1:if(this.enableZoom===!1)return;this.handleMouseMoveDolly(i);break;case 2:if(this.enablePan===!1)return;this.handleMouseMovePan(i);break}this.object.wasMovedByUser=!0},this.onPointerDownTouch=i=>{switch(et.length>1&&i.preventDefault(),this.touches[et.length-1]){case Ln.ROTATE:if(this.enableRotate===!1){this.state=-1;return}this.handleTouchStartRotate(),this.state=3;break;case Ln.PAN:if(this.enablePan===!1){this.state=-1;return}this.handleTouchStartPan(),this.state=4;break;case Ln.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this.handleTouchStartDollyPan(),this.state=5;break;case Ln.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this.handleTouchStartDollyRotate(),this.state=6;break;default:this.state=-1}},this.onPointerMoveTouch=i=>{switch(et.length>1&&i.preventDefault(),this.state){case 3:if(this.enableRotate===!1)return;this.handleTouchMoveRotate(i),this.update();break;case 4:if(this.enablePan===!1)return;this.handleTouchMovePan(i),this.update();break;case 5:if(this.enableZoom===!1&&this.enablePan===!1)return;this.handleTouchMoveDollyPan(i),this.update();break;case 6:if(this.enableZoom===!1&&this.enableRotate===!1)return;this.handleTouchMoveDollyRotate(i),this.update();break;default:this.state=-1}this.object.wasMovedByUser=!0},this.dispatchEndDebounced=tA(()=>this.dispatchEvent(Eh),33),this.onMouseWheel=i=>{this.enabled===!1||this.enableZoom===!1&&this.enablePan===!1||this.checkRaycastLock()||(!this.options.isExport&&this.domElement.clientHeight===document.body.clientHeight&&this.domElement.clientWidth===document.body.clientWidth&&i.preventDefault(),this.dispatchEvent(Mh),this.handleMouseWheel(i),this.dispatchEndDebounced(),this.object.wasMovedByUser=!0)},this.onGesture=i=>{if(i.preventDefault(),this.enabled!==!1&&!this.checkRaycastLock()&&!EB)if(i.type==="gesturechange"){if(this.enableZoom===!1||this.isTouchZoom===!1)return;this.dispatchEvent(Mh),i.scale>this.prevScale?this.dollyIn(this.getZoomScale()):i.scale<this.prevScale&&this.dollyOut(this.getZoomScale()),this.prevScale=i.scale,this.update(),this.object.wasMovedByUser=!0}else this.dispatchEvent(Eh)},this.onContextMenu=i=>{i.preventDefault()},this.onTouchEnd=i=>{i.preventDefault()},this.onKeyDown=i=>{this.enabled!==!1&&(this.key=i.key,i.key===" "&&this.dispatchEvent(Mh))},this.onKeyUp=i=>{this.enabled!==!1&&(this.key=void 0,this.state!==-1&&i.key==="Alt"&&this.onPointerUp(et[0]),i.key===" "&&this.dispatchEvent(Eh))},this.onPointerHover=i=>{i.pointerType!=="mouse"||this.enabled===!1||this.state!==-1||this.hoverRotatePanMode===2&&this.isPanOverShoot||this.hoverRotatePanMode===1&&this.isRotateOverShoot||(this.isPointerDown=!0,this.hoverRotatePanMode===2?this.handleMouseMovePan(i,this.hoverRotatePanStrength):this.hoverRotatePanMode===1&&this.handleMouseMoveRotate(i,this.hoverRotatePanStrength))},this.onBeginState=()=>{this.enabled=!1,this.needsUpdate=!1},this.onCompleteState=i=>{i.isfromEntity&&this.options.isPlayMode||(this.enabled=!0,this.needsUpdate=!0,this.object.updateUp(),this.object.getTarget(this.target))},this.target=this.object.getTarget(),this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.quat0=this.object.quaternion.clone(),this.isUpVectorFlipped0=this.object.isUpVectorFlipped,this.offset.copy(this.object.position).sub(this.target),this.spherical.setFromVector3(this.offset),this.object.isUpVectorFlipped&&(this.spherical.phi*=-1,this.spherical.theta-=Math.PI),this.addEventListenersToCamera()}dispatchEvent(e){e.type==="start"?this.hasChange=!1:this.hasChange=!0,super.dispatchEvent(e)}addEventListenersToCamera(){this.object.addEventListener("beginState",this.onBeginState),this.object.addEventListener("completeState",this.onCompleteState),this.object.addEventListener("cameraChange",this.onCameraChange)}removeEventListenersFromCamera(){this.object.removeEventListener("beginState",this.onBeginState),this.object.removeEventListener("completeState",this.onCompleteState),this.object.removeEventListener("cameraChange",this.onCameraChange)}updateUseWindowEvents(e){if(window.removeEventListener("pointermove",this.onPointerHover),this.domElement.removeEventListener("pointermove",this.onPointerHover),this.useWindowEvents=e,this.hoverRotatePanMode!==0&&(this.useWindowEvents?window.addEventListener("pointermove",this.onPointerHover):this.domElement.addEventListener("pointermove",this.onPointerHover)),this.domElement.removeEventListener("pointerleave",this.onPointerLeave),this.domElement.removeEventListener("pointerenter",this.onPointerEnter),window.removeEventListener("pointerleave",this.onPointerLeave),window.removeEventListener("pointerenter",this.onPointerEnter),this.hoverRotatePanMode!==0&&!this.useWindowEvents){let t=this.useWindowEvents?window:this.domElement;t.addEventListener("pointerleave",this.onPointerLeave),t.addEventListener("pointerenter",this.onPointerEnter)}}fromJSON(e,t){this.setEnableDampingSpeed(e.enableDamping),this.enablePan=e.enablePan,this.enableZoom=e.enableZoom,this.enableRotate=e.enableRotate,this.rotationLimitsMode=e.rotationLimitsMode,this.thetaIsFree=e.rotationHorizontalOffset.min===e.rotationHorizontalOffset.max&&e.rotationHorizontalOffset.min===Math.PI,this.phiIsFree=e.rotationVerticalOffset.min===e.rotationVerticalOffset.max&&e.rotationVerticalOffset.min===Math.PI,this.panLimitsMode=e.panLimitsMode,this.panSoftLimit=e.panSoftLimit,this.rotationSoftLimit=e.rotationSoftLimit,this.hoverRotatePanMode=e.hoverRotatePanMode,this.useWindowEvents=t==="window",this.hoverRotatePanMode!==0&&(this.useWindowEvents?window.addEventListener("pointermove",this.onPointerHover):this.domElement.addEventListener("pointermove",this.onPointerHover));let r=e.hoverRotatePanStrength/100;this.hoverRotatePanStrength=r**2,this.zoomLimitsEnabled=e.zoomLimitsEnabled,this.minZoom=e.zoomLimits.min,this.maxZoom=Math.max(e.zoomLimits.min,e.zoomLimits.max),this.minDistance=1e3/e.zoomLimits.max,this.maxDistance=Math.max(this.minDistance,1e3/e.zoomLimits.min),this.autoRotate=e.autoRotate,this.autoRotateSpeed=e.autoRotateSpeed,this.autoRotateClockwise=e.autoRotateClockwise;let i=this.object.getTarget().applyQuaternion(Vw.copy(this.object.quaternion).invert());this.minV=-e.panVerticalOffset.min+i.y,this.maxV=e.panVerticalOffset.max+i.y,this.minH=-e.panHorizontalOffset.min+i.x,this.maxH=e.panHorizontalOffset.max+i.x,this.panRangeFactor.set(this.maxH-this.minH,this.maxV-this.minV).divideScalar(2),this.rotationRangeFactor.setScalar(Math.PI).divideScalar(4),this.minPhi=qs(this.spherical.phi-e.rotationVerticalOffset.min),this.maxPhi=qs(this.spherical.phi+e.rotationVerticalOffset.max),this.minTheta=qs(qs(this.spherical.theta)-e.rotationHorizontalOffset.min),this.maxTheta=qs(qs(this.spherical.theta)+e.rotationHorizontalOffset.max),this.isThetaFlipped=this.minTheta>this.maxTheta,e.orbitTouches===1&&(this.touches[0]=Ln.ROTATE),e.panTouches===1&&(this.touches[0]=Ln.PAN),e.orbitTouches===2&&(this.touches[1]=Ln.DOLLY_ROTATE),e.panTouches===2&&(this.touches[1]=Ln.DOLLY_PAN),e.orbitTouches===3&&(this.touches[2]=Ln.ROTATE),e.panTouches===3&&(this.touches[2]=Ln.PAN),this.isTouchZoom=e.isTouchZoom,this.resetHoverEffectOnPointerLeave=e.resetHoverEffectOnPointerLeave??!1}connect(){if(this.domElement.addEventListener("contextmenu",this.onContextMenu),this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("wheel",this.onMouseWheel),window.addEventListener("keydown",this.onKeyDown,!1),window.addEventListener("keyup",this.onKeyUp,!1),this.domElement.addEventListener("gesturestart",this.onGesture),this.domElement.addEventListener("gesturechange",this.onGesture),this.domElement.addEventListener("gestureend",this.onGesture),this.domElement.addEventListener("touchend",this.onTouchEnd),this.hoverRotatePanMode!==0&&!this.useWindowEvents){let e=this.useWindowEvents?window:this.domElement;e.addEventListener("pointerleave",this.onPointerLeave),e.addEventListener("pointerenter",this.onPointerEnter)}this.pointerLeaveEvent=void 0}dispose(){this.removeEventListenersFromCamera(),this.domElement.removeEventListener("contextmenu",this.onContextMenu),this.domElement.removeEventListener("pointerdown",this.onPointerDown),this.domElement.removeEventListener("wheel",this.onMouseWheel),window.removeEventListener("keydown",this.onKeyDown,!1),window.removeEventListener("keyup",this.onKeyUp,!1),this.domElement.removeEventListener("pointermove",this.onPointerHover),window.removeEventListener("pointermove",this.onPointerHover),this.domElement.removeEventListener("gesturestart",this.onGesture),this.domElement.removeEventListener("gesturechange",this.onGesture),this.domElement.removeEventListener("gestureend",this.onGesture),this.domElement.removeEventListener("touchend",this.onTouchEnd),this.domElement.removeEventListener("pointerleave",this.onPointerLeave),this.domElement.removeEventListener("pointerenter",this.onPointerEnter),window.removeEventListener("pointerleave",this.onPointerLeave),window.removeEventListener("pointerenter",this.onPointerEnter),this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)}applyLimits(e,t,r,i,n,s,a,o){this.overShoot.set(0,0);let l,c,u;e instanceof E?(l=e.x,c=e.y,this.current.set(this.target.x,this.target.y),u=!0):(l=e.theta,c=e.phi,this.current.set(qs(this.spherical.theta),qs(this.spherical.phi)),u=!1),r===0&&(this.current.x+=l,this.current.y+=c),(t===3||t===2)&&(!u&&this.isThetaFlipped?this.current.x>i&&this.current.x<0?this.overShoot.x=i-this.current.x:this.current.x<n&&this.current.x>0&&(this.overShoot.x=n-this.current.x):this.current.x>i?this.overShoot.x=i-this.current.x:this.current.x<n&&(this.overShoot.x=n-this.current.x)),(t===3||t===1)&&(this.current.y>s?this.overShoot.y=s-this.current.y:this.current.y<a&&(this.overShoot.y=a-this.current.y)),u||(this.overShoot.x=qs(this.overShoot.x),this.overShoot.y=qs(this.overShoot.y)),r!==0?(this.overRatio.copy(this.overShoot).divide(o),this.overRatio.x=Math.min(Math.abs(this.overRatio.x),1),this.overRatio.y=Math.min(Math.abs(this.overRatio.y),1),r===1&&(this.overRatio.x=W5(Math.abs(this.overRatio.x)),this.overRatio.y=W5(Math.abs(this.overRatio.y))),this.isPointerDown||r===1?r===2&&(this.overRatio.x>.9&&!this.thetaIsFree||this.overRatio.y>.9&&!this.phiIsFree)?this.isPointerDown=!1:(l*this.overShoot.x<0&&!this.thetaIsFree&&(l*=1-this.overRatio.x),c*this.overShoot.y<0&&!this.phiIsFree&&(c*=1-this.overRatio.y)):r===2&&(!u&&(this.overRatio.x>.002&&!this.thetaIsFree||this.overRatio.y>.002&&!this.phiIsFree)||u&&(Math.abs(this.overShoot.x)>2||Math.abs(this.overShoot.y)>2)?(this.thetaIsFree||(l=this.overShoot.x*.05),this.phiIsFree||(c=this.overShoot.y*.05),u?this.isPanOverShoot=!0:this.isRotateOverShoot=!0):u?this.isPanOverShoot=!1:this.isRotateOverShoot=!1)):(l+=this.overShoot.x,c+=this.overShoot.y),e instanceof E?(e.x=l,e.y=c):(this.thetaIsFree||(e.theta=l),this.phiIsFree||(e.phi=c))}setEnableDampingSpeed(e){this.enableDamping=e,this.rotateSpeed=e===!0?.2:1}stopDamping(){this.sphericalDelta.theta=0,this.sphericalDelta.phi=0}getAutoRotationAngle(){return 2*Math.PI/60/60*this.autoRotateSpeed}getZoomScale(){return Math.pow(.95,this.zoomSpeed)}rotateLeft(e){this.sphericalDelta.theta-=e}rotateUp(e){this.sphericalDelta.phi-=e}panLeft(e,t){this.panLeftV.setFromMatrixColumn(t,0),this.panLeftV.multiplyScalar(-e),this.panOffset.add(this.panLeftV)}panUp(e,t){this.panUpV.setFromMatrixColumn(t,1),this.panUpV.multiplyScalar(e),this.panOffset.add(this.panUpV)}pan(e,t){let r=this.domElement;if(r&&this.object.isPerspectiveCamera){let i=this.object.position;this.panV.copy(i).sub(this.target);let n=this.panV.length();n*=Math.tan(this.object.fov/2*Math.PI/180),this.panLeft(2*e*n/r.clientHeight,this.object.matrixWorld),this.panUp(2*t*n/r.clientHeight,this.object.matrixWorld)}else r&&this.object.isOrthographicCamera&&(this.panLeft(e*(this.object.right-this.object.left)/this.object.zoom/r.clientWidth,this.object.matrixWorld),this.panUp(t*(this.object.top-this.object.bottom)/this.object.zoom/r.clientHeight,this.object.matrixWorld));this.dispatchEvent(Cge)}dollyOut(e){this.object.isPerspectiveCamera?this.scale/=e:this.object.isOrthographicCamera&&(this.object.zoom*=e,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0),this.dispatchEvent(V5)}dollyIn(e){this.object.isPerspectiveCamera?this.scale*=e:this.object.isOrthographicCamera&&(this.object.zoom/=e,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0),this.dispatchEvent(V5)}zoomOut(e=this.getZoomScale()){this.dispatchEvent(Mh),this.dollyOut(e),this.dispatchEvent(Eh)}zoomIn(e=this.getZoomScale()){this.dispatchEvent(Mh),this.dollyIn(e),this.dispatchEvent(Eh)}handleMouseDownRotate(e){this.rotateStart.set(e.clientX,e.clientY)}handleMouseDownDolly(e){this.dollyStart.set(e.clientX,e.clientY)}handleMouseDownPan(e){this.panStart.set(e.clientX,e.clientY)}handleMouseMoveRotate(e,t=1){e.movementX!==void 0?this.rotateDelta.set(e.movementX,e.movementY):(this.rotateEnd.set(e.clientX,e.clientY),this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart),this.rotateStart.copy(this.rotateEnd)),this.rotateDelta.multiplyScalar(this.rotateSpeed*t).rotateAround(H5,-this.object.angleOffsetFromUp);let r=this.domElement,i=this.useWindowEvents?window.innerHeight:r.clientHeight,n=2*Math.PI*this.rotateDelta.x/i,s=2*Math.PI*this.rotateDelta.y/i;this.rotateLeft(n),this.rotateUp(s),this.update()}handleMouseMoveDolly(e){this.dollyEnd.set(e.clientX,e.clientY),this.dollyDelta.subVectors(this.dollyEnd,this.dollyStart),this.dollyDelta.y>0?this.dollyOut(this.getZoomScale()):this.dollyDelta.y<0&&this.dollyIn(this.getZoomScale()),this.dollyStart.copy(this.dollyEnd),this.update()}handleMouseMovePan(e,t=1){e.movementX!==void 0?this.panDelta.set(e.movementX,e.movementY):(this.panEnd.set(e.clientX,e.clientY),this.panDelta.subVectors(this.panEnd,this.panStart),this.panStart.copy(this.panEnd)),this.panDelta.multiplyScalar(this.panSpeed*t),this.pan(this.panDelta.x,this.panDelta.y),this.update()}handleMouseWheel(e){if(pae===!1&&_g(e)===!1&&Lge(e)===!0){if(this.enablePan===!1)return;this.gesture?(this.panDelta.set(-e.deltaX,-e.deltaY).multiplyScalar(this.panSpeed),this.panDelta.x=Math.min(Math.abs(this.panDelta.x),100)*(this.panDelta.x<0?-1:1),this.panDelta.y=Math.min(Math.abs(this.panDelta.y),100)*(this.panDelta.y<0?-1:1),e.altKey?this.pan(0,this.panDelta.y):e.shiftKey?this.pan(this.panDelta.x,0):this.pan(this.panDelta.x,this.panDelta.y),this.update()):(this.gesture=!0,this.isPointerDown=!0),window.clearTimeout(this.timer),this.timer=window.setTimeout(()=>{this.gesture=!1,this.isPointerDown=!1},30)}else{if(this.enableZoom===!1)return;e.deltaY===0?e.deltaX<0?this.dollyIn(this.getZoomScale()):e.deltaX>0&&this.dollyOut(this.getZoomScale()):e.deltaY<0?this.dollyIn(this.getZoomScale()):e.deltaY>0&&this.dollyOut(this.getZoomScale()),this.update(),this.gesture=!1,this.isPointerDown=!1}}handleTouchStartRotate(){if(et.length===2){let e=.5*(et[0].pageX+et[1].pageX),t=.5*(et[0].pageY+et[1].pageY);this.rotateStart.set(e,t)}else this.rotateStart.set(et[0].pageX,et[0].pageY)}handleTouchStartPan(){if(et.length===2){let e=.5*(et[0].pageX+et[1].pageX),t=.5*(et[0].pageY+et[1].pageY);this.panStart.set(e,t)}else this.panStart.set(et[0].pageX,et[0].pageY)}handleTouchStartDolly(){let e=et[0].pageX-et[1].pageX,t=et[0].pageY-et[1].pageY,r=Math.sqrt(e*e+t*t);this.dollyStart.set(0,r)}handleTouchStartDollyPan(){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchStartDolly(),this.enablePan&&this.handleTouchStartPan()}handleTouchStartDollyRotate(){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchStartDolly(),this.enableRotate&&this.handleTouchStartRotate()}handleTouchMoveRotate(e){if(et.length===2){let r=Gx(e),i=.5*(e.pageX+r.x),n=.5*(e.pageY+r.y);this.rotateEnd.set(i,n)}else{if(e.pointerId!==et[0].pointerId)return;this.rotateEnd.set(e.pageX,e.pageY)}this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart).multiplyScalar(this.rotateSpeed);let t=this.domElement;t&&(this.rotateLeft(2*Math.PI*this.rotateDelta.x/t.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/t.clientHeight)),this.rotateStart.copy(this.rotateEnd)}handleTouchMovePan(e){if(et.length===2){let t=Gx(e),r=.5*(e.pageX+t.x),i=.5*(e.pageY+t.y);this.panEnd.set(r,i)}else{if(e.pointerId!==et[0].pointerId)return;this.panEnd.set(e.pageX,e.pageY)}this.panDelta.subVectors(this.panEnd,this.panStart).multiplyScalar(this.panSpeed),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.copy(this.panEnd)}handleTouchMoveDolly(e){let t=Gx(e),r=e.pageX-t.x,i=e.pageY-t.y,n=Math.sqrt(r*r+i*i);this.dollyEnd.set(0,n),this.dollyDelta.set(0,Math.pow(this.dollyEnd.y/this.dollyStart.y,this.zoomSpeed)),this.dollyOut(this.dollyDelta.y),this.dollyStart.copy(this.dollyEnd)}handleTouchMoveDollyPan(e){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchMoveDolly(e),this.enablePan&&this.handleTouchMovePan(e)}handleTouchMoveDollyRotate(e){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchMoveDolly(e),this.enableRotate&&this.handleTouchMoveRotate(e)}checkRaycastLock(){var e;if(this.object.data.raycastLock){if(this.options.isPlayMode)return!1;{let t=(e=this.options)==null?void 0:e.showCameraLock;return t&&t(),!0}}else return!1}};function qs(e){let t=Math.PI*2;for(;e<=-Math.PI;)e+=t;for(;e>Math.PI;)e-=t;return e}function W5(e){return 1-Math.pow(1-e,4)}function Lge(e){return e.wheelDeltaY===0||e.deltaY===0?Ky&&e.shiftKey&&Math.abs(e.wheelDeltaX)>=120?!1:e.wheelDeltaX?e.wheelDeltaX===-3*e.deltaX:e.deltaMode===0:e.wheelDeltaY?e.wheelDeltaY===-3*e.deltaY:e.deltaMode===0}var q5=class{constructor(e,t,r,i,n,s){this.id=e,this.data=t,this.object=r,this.currentIntersectedObjects=[],this.disabled=!1,this.actions=En(t,t.actions,i,n,s,r),this.target=t.target,this.useToggle=t.toggle,this.triggeringObjects=t.triggeringObjects.map(a=>i.scene.find(a))}isValidTriggeringObject(e){return this.target==="all"?!0:this.triggeringObjects.some(t=>t===e||t.isAncestorOf(e.uuid)||e.isAncestorOf(t.uuid))}disconnect(){on(this.actions)}dispatch(){this.disabled||(this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.object.dispatchEvent({type:"beginEvent",eventName:"Trigger"}),this.useToggle?(this.actions.Transition.forEach(e=>{e.toggle()}),this.actions.SwitchCamera.forEach(e=>{e.toggle()})):(this.actions.Transition.forEach(e=>{e.play()}),this.actions.SwitchCamera.forEach(e=>{e.play()})),this.actions.Link.forEach(e=>{e.dispatch()}),this.actions.Reset.forEach(e=>{e.dispatch()}),this.actions.Create.forEach(e=>{e.dispatch()}),this.actions.Destroy.forEach(e=>{e.dispatch(!1)}),this.actions.Audio.forEach(e=>{e.dispatchBasic()}),this.actions.Video.forEach(e=>{e.dispatchBasic()}),this.actions.SceneTransition.forEach(e=>{e.dispatch()}))}},At;wae.then(e=>At=e);var Er=new E,ps=new ft,Oo=new E,Ww=new Zr(0,0,0,"YXZ"),X5=new Zr(0,0,0,"XYZ"),Ba=new E,Y5=new E,Q5=new E(1,1,1),Th=new ft,qw=new _e,Ige=new _e,Oge={type:"updateMatrix"},q_={type:"beginEvent",eventName:"Collision"},Rge={type:"beginEvent",eventName:"Trigger"};function Bge(e){if(Gf.physicsEnabled(e.scene.objects))return!0;let t=!1;return e.scene.objects.traverse((r,i)=>{if(i.events){for(let n of i.events)if(n.data.disabled!==!0&&n.data.type==="GameControl"&&n.data.collisionEnabled){t=!0;break}}}),t}var hy=e=>e.states.some(t=>t.data.position!==void 0||t.data.rotation!==void 0||t.data.hiddenMatrix!==void 0||t.data.cloner!==void 0||t.data.pathSnapping!==void 0),zge=class{constructor(e){this.eventContext=e,this.isEnabled=!1,this.gameControl=null,this.joysticks=[],this.joystickToGameControls=[],this.sharedGameControlGlobals={entitiesWithTransformAnim:[],entityToCollisionEvents:{},colliderToEntity:new Map,triggers:[],gamePads:[],createdObjects:[],nCreatedPerAction:{}},this.sensorToTriggerEvent={},this.eventManager=void 0,this.needsCollisionDetection=!1,this.initializationCounter=-1,this.rigidBodyToMesh=new Map,this.nActiveRigidBodies=0,this.collisionEvents=[],this.isExport=!1,this.processRigidBody=t=>{if(t.bodyType()!==At.RigidBodyType.Dynamic)return;t.isSleeping()||this.nActiveRigidBodies++;let[r,i,n]=this.rigidBodyToMesh.get(t.handle);if(Er.copy(t.translation()).multiplyScalar(this.pixelsPerMeter),ps.copy(t.rotation()),r.matrixWorld.compose(Er,ps,i),r.hasNonUniformScale&&r.matrixWorld.multiply(r.shearScale),r.dispatchEvent(Oge),n){let s=r.cloner;if(s&&s.objectForSample===void 0){s.matrixWorld.copy(r.matrixWorld);for(let a of s.children)a.updateMatrixWorld(!0)}for(let a of r.children)a.updateMatrixWorld(!0)}},this.accumulator=0,this.handleCollisionEvents=(t,r,i)=>{var a,o,l,c;if(i===!1)return;let n,s;if(this.sensorToTriggerEvent[t]?(n=this.sensorToTriggerEvent[t],s=this.sharedGameControlGlobals.colliderToEntity.get(r)):this.sensorToTriggerEvent[r]&&(n=this.sensorToTriggerEvent[r],s=this.sharedGameControlGlobals.colliderToEntity.get(t)),n&&s&&n.isValidTriggeringObject(s)){n.dispatch();return}for(let u=this.sharedGameControlGlobals.createdObjects.length-1;u>=0;u--){let h=this.sharedGameControlGlobals.createdObjects[u];if(h.userData.hasCollisionDestroy&&(((a=h.rigidBody)==null?void 0:a.collider(0).handle)===t||((o=h.rigidBody)==null?void 0:o.collider(0).handle)===r)){this.sharedGameControlGlobals.createdObjects.splice(u,1),h.removeFromParent(),requestAnimationFrame(()=>{var d;return(d=this.sharedGameControlGlobals.rapierWorld)==null?void 0:d.removeRigidBody(h.rigidBody)});break}}if(((l=this.gameControl)==null?void 0:l.object)===this.sharedGameControlGlobals.colliderToEntity.get(t)){let u=this.sharedGameControlGlobals.colliderToEntity.get(r),h=this.sharedGameControlGlobals.entityToCollisionEvents[u.uuid];if(h===void 0)return;for(let d of h)d.data.target==="character"&&this.dispatchCollisionEvent(d,u,r)}else if(((c=this.gameControl)==null?void 0:c.object)===this.sharedGameControlGlobals.colliderToEntity.get(r)){let u=this.sharedGameControlGlobals.colliderToEntity.get(t),h=this.sharedGameControlGlobals.entityToCollisionEvents[u.uuid];if(h===void 0)return;for(let d of h)d.data.target==="character"&&this.dispatchCollisionEvent(d,u,t)}else{let u=this.sharedGameControlGlobals.colliderToEntity.get(t),h=this.sharedGameControlGlobals.entityToCollisionEvents[u.uuid];if(h!==void 0)for(let f of h)f.data.target==="scene"&&this.dispatchCollisionEvent(f,u,t);let d=this.sharedGameControlGlobals.colliderToEntity.get(r),p=this.sharedGameControlGlobals.entityToCollisionEvents[d==null?void 0:d.uuid];if(p!==void 0)for(let f of p)f.data.target==="scene"&&this.dispatchCollisionEvent(f,d,r)}},this.isExport=e.isExport,this.sharedAssets=e.sharedAssets,this.renderer=e.renderer,this.requestRender=e.requestRender,this.domElement=this.renderer.domElement,this.pixelsPerMeter=p8,this.gravity=this.page.data.globalPhysics.gravity}get page(){return this.eventContext.page}attachVRControllers(e){e.forEach(t=>{t.addEventListener("connected",r=>{"gamepad"in r.data&&"axes"in r.data.gamepad&&this.sharedGameControlGlobals.gamePads.push(r.data.gamepad)})})}markIsDestroyTarget(){this.page.traverseVisibleEntity(e=>{var r,i;let t=e.dataPatched;for(let n of t.events){if(n.data.disabled===!0)continue;let s=(i=(r=n.data.actions)==null?void 0:r.find(a=>a.data.type==="Destroy"))==null?void 0:i.data;if(s)for(let a of s.objects){let o=this.page.scene.find(a);o&&(o.userData.hasDestroy=!0)}}})}markIsDragObject(){this.page.traverseVisibleEntity(e=>{let t=e.dataPatched;for(let r of t.events)if(!(r.data.disabled===!0||r.data.type!=="DragDrop"))for(let i of r.data.objects){let n=this.page.scene.find(i);n&&(n.userData.hasDrag=!0)}})}initBVH(){let e=[];if(this.page.traverseChildren(t=>{var o,l;let r;if(t instanceof As)return;t instanceof xi?r=t.object:r=t;let i=r.dataPatched;if(((o=i.physics)==null?void 0:o.enabled)==="visibility"?!i.visible:!((l=i.physics)!=null&&l.enabled))return!0;let n=t.geometry,s=r.userData.hasDestroy===!0,a=r.userData.hasDrag===!0;if(hy(i)||s||a||r.dataPatched.events.some(c=>c.data.disabled!==!0&&c.data.type==="GameControl"))return t.updateMatrixWorldSVD(),this.addBoundsTree(t),!0;n&&e.push(qa(n,t.matrixWorld))}),e.length>0){let t=dc(e,!1);this.sharedGameControlGlobals.staticMeshBVH=new rf(t)}}addRigidBody(e,t,r){let i=[],n="geometry"in e?e.geometry:void 0,s=t.dataPatched;if((n==null?void 0:n.getAttribute("position"))!==void 0&&i.push(qa(n,e.shearScale)),s.physics.fusedBody){let a=this.gatherChildrenGeom(e,i);e.traverseObject(a),e.children.forEach(l=>l.updateMatrixWorld(!0));let o=e.cloner;o&&o.objectForSample===void 0&&s.physics.rigidBody==="dynamic"&&(o.traverseObject(a),o.children.forEach(l=>l.updateMatrixWorld(!0)))}if(i.length>0){let a,o=!r.fromCreate&&s.physics.rigidBody==="dynamic"||r.fromCreate&&r.dynamic;o?(a=At.RigidBodyDesc.dynamic(),a.setLinearDamping(s.physics.damping).setAngularDamping(s.physics.damping).setAdditionalMass(1e-9).setGravityScale(s.physics.gravityScale).enabledRotations(...s.physics.enabledRotation).enabledTranslations(...s.physics.enabledTranslation)):(r.hasTransformAnim||r.hasFollow||r.hasDrag)&&!r.fromCreate?(a=At.RigidBodyDesc.kinematicPositionBased(),this.sharedGameControlGlobals.entitiesWithTransformAnim.push(e)):a=At.RigidBodyDesc.fixed();let l=dc(i);(e.hasNonUniformScale?e.matrixWorldRigid:e.matrixWorld).decompose(Er,ps,Oo),e.position0=Er.clone().divideScalar(this.pixelsPerMeter),e.rotation0=ps.clone(),Er.divideScalar(this.pixelsPerMeter),a.setTranslation(Er.x,Er.y,Er.z).setRotation(ps),n?l==null||l.scale(1/this.pixelsPerMeter,1/this.pixelsPerMeter,1/this.pixelsPerMeter):l==null||l.scale(Oo.x/this.pixelsPerMeter,Oo.y/this.pixelsPerMeter,Oo.z/this.pixelsPerMeter);let c=this.sharedGameControlGlobals.rapierWorld.createRigidBody(a);o&&this.rigidBodyToMesh.set(c.handle,[e,Oo.clone(),s.physics.fusedBody]);let u=!(s.geometry===void 0||s.geometry.type==="SubdivGeometry"||s.geometry.type==="NonParametricGeometry"||s.geometry.type==="BooleanGeometry"||s.geometry.type==="VectorGeometry"||s.geometry.type==="StarGeometry"||s.geometry.type==="RectangleGeometry"||s.geometry.type==="EllipseGeometry"||s.geometry.type==="TriangleGeometry"||s.geometry.type==="TorusGeometry"||s.geometry.type==="HelixGeometry");try{this.addCollider(c,s.physics,l,t,u)}catch{try{this.addCollider(c,s.physics,l,t,!1)}catch(h){console.error(h)}}e.rigidBody=c}}addBoundsTree(e){var r;let t=[];if(((r=e.geometry)==null?void 0:r.getAttribute("position"))!==void 0&&t.push(qa(e.geometry,e.shearScale)),e.traverseObject(this.gatherChildrenGeom(e,t)),e.children.forEach(i=>i.updateMatrixWorld(!0)),t.length>0){let i=dc(t,!1);e.bvhGeometry=i,e.bvhGeometry.boundsTree=new rf(i),this.sharedGameControlGlobals.entitiesWithTransformAnim.push(e)}}addCollider(e,t,r,i,n=!0){var o,l;if((r==null?void 0:r.getAttribute("position").count)===0||((o=r==null?void 0:r.getIndex())==null?void 0:o.count)===0)return;let s;r&&(t.colliderType==="trimesh"?s=At.ColliderDesc.trimesh(r.getAttribute("position").array,r.getIndex().array):s=At.ColliderDesc.convexMesh(r.getAttribute("position").array,n?r.getIndex().array:void 0)),s.setFrictionCombineRule(At.CoefficientCombineRule.Average).setRestitutionCombineRule(At.CoefficientCombineRule.Average).setDensity(t.density).setFriction(t.friction).setRestitution(t.restitution);let a=this.sharedGameControlGlobals.rapierWorld.createCollider(s,e);this.sharedGameControlGlobals.colliderToEntity.set(a.handle,i),(l=this.sharedGameControlGlobals.entityToCollisionEvents[i.uuid])!=null&&l.some(c=>c.target==="scene")&&a.setActiveEvents(At.ActiveEvents.COLLISION_EVENTS)}gatherChildrenGeom(e,t){return(r,i)=>{var o;if(i===0)return;let n;if(r instanceof As)if(r.objectForSample){if(r.objectForSample.dataPatched.physics.fusedBody)return;n=r.object}else return r.object.dataPatched.physics.fusedBody===!0&&r.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(r instanceof xi)n=r.object;else if(n=r,(o=n.dataPatched.cloner)==null?void 0:o.hideBase)return!0;let s=n.dataPatched;if(s.physics.enabled==="visibility"?!s.visible:!s.physics.enabled)return!0;i===1?e.hasNonUniformScale?r.matrixWorld.multiplyMatrices(e.shearScale,r.hiddenMatrix):r.matrixWorld.copy(r.hiddenMatrix):r.matrixWorld.multiplyMatrices(r.parent.matrixWorld,r.hiddenMatrix),r.matrixWorld.multiply(r.matrix);let a=r.geometry;(a==null?void 0:a.getAttribute("position"))!==void 0&&t.push(qa(a,r.matrixWorld))}}activate(e){var d,p;if(this.isEnabled)return;this.isEnabled=!0,this.eventManager=e,this.usePhysics=this.page.data.globalPhysics.usePhysics;let t=this.page.playCamera,r=!1,i=5,n=8,s=9,a="drag",o=this.page.data.publish.gameControlObject,l=o!==null?this.page.find(o):null,c=null;if(l)for(let f of l.data.events){if(f.data.disabled||f.data.type!=="GameControl")break;let m=l;for(;this.usePhysics&&((d=m=m.parent)==null?void 0:d.parent)!==null&&!((p=m.data.physics)!=null&&p.fusedBody););f.data.collisionEnabled&&(this.needsCollisionDetection=!0),c===null&&(c=f.data)}if(l&&c){r=r||c.camera===t.uuid||l.uuid===t.uuid;let f=new f8(l,this.renderer.domElement,c,this.eventContext.page.data.globalPhysics,this,l.uuid!==t.uuid&&c.camera===t.uuid,t,this.page,this.sharedAssets);this.gameControl=f,c.keyAssignments,i=c.joystickPosLoc,n=c.joystickRotLoc,s=c.jumpTouchButtonLoc,a=c.rotByTouch,wn&&c.touchControl&&(this.joystickToGameControls[i]="pos",c.moveMode==="walk"&&(this.joystickToGameControls[s]="jmp"),a==="joystick"&&(this.joystickToGameControls[n]="rot"))}if(this.gameControl&&this.gameControl.data.navmesh.enabled){let f=this.gameControl.data;if(!this.navigationMeshWrapper){this.navigationMeshWrapper=new bge(this.usePhysics,this.isExport);let m;f.collider.type==="sphere"?m=f.collider.radius*2:m=f.collider.height,m=Math.floor(m/f.navmesh.ch-1),this.navigationMeshWrapper.init({...f.navmesh,walkableHeight:m},this.gameControl,this.eventContext)}}if(r===!1){let{enableRotate:f,enablePan:m,enableZoom:g,autoRotate:v,hoverRotatePanMode:y}=this.eventManager.publish.orbitControls;(f||m||g||v||y!==0)&&(this.orbitControls=new S8(t,this.renderer.domElement,{isExport:this.isExport,isPlayMode:!0}),this.orbitControls.addEventListener("change",this.requestRender),this.orbitControls.addEventListener("end",this.requestRender),this.orbitControls.addEventListener("start",this.requestRender),this.orbitControls.fromJSON(this.eventManager.publish.orbitControls,this.eventManager.publish.mouseEventTarget),this.orbitControls.useKeyEvents=!1,this.orbitControls.addEventListenersToCamera(),this.orbitControls.connect(),this.orbitControls.update())}let u=this.renderer.domElement.width/this.renderer.getPixelRatio(),h=this.renderer.domElement.height/this.renderer.getPixelRatio();this.joystickToGameControls.forEach((f,m)=>{let g=document.body.appendChild(document.createElement("div")),[v,y,x]=this.eventManager.eventContext.publish.joystickSizeAndXYOffset[m],w=(u-5*v)/4+v,b={},_=f==="jmp",A=_?0:v;m<10?(m<5?b.top=A/2:b.bottom=A/2,b.left=A/2+m%5*w):m===10?(b.left=A/2,b.top=h/2):(b.right=A/2,b.top=h/2),b.top?b.top-=y[1]:b.bottom+=y[1],b.left?b.left+=y[0]:b.right-=y[0];for(let M in b)b[M]+="px";if(_){let M=g.appendChild(document.createElement("div"));Object.assign(M.style,b,{position:"absolute",width:v+"px",height:v+"px",backgroundColor:`rgba(255,255,255,${x==="show"?.4:0})`,zIndex:"9999",borderRadius:v+"px",border:x==="show"?"solid 2px rgba(0, 0, 0, .1)":"none",display:"flex",alignItems:"center",justifyContent:"center",touchAction:"none"});let T=v/16*16*.4;x==="show"&&(M.innerHTML=`
						<svg width="${T}" height="${v*.4}" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
							<path d="M2 10L8 4L14 10" stroke="black" stroke-opacity="40%" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
						</svg>
					`),M.addEventListener("pointerdown",()=>{this.gameControl.movementState.jump=1,this.requestRender()}),M.addEventListener("touchend",P=>P.preventDefault()),this.joysticks[m]=[void 0,g];return}let S={zone:g,mode:"static",position:b,size:v};x==="hide"&&(S.restOpacity=0);let C=efe.create(S);C.on("move",(M,T)=>{let P=this.gameControl;f==="pos"?T.force<.2?P.moveForce=0:(P.movementState.movePosZ=Math.sin(-T.angle.radian),P.movementState.movePosX=Math.cos(-T.angle.radian),T.force>1.2?P.movementState.run=1:P.movementState.run=0,T.force<.3?P.moveForce=(T.force-.2)/.1:P.moveForce=1):f==="rot"&&(T.force<.2?P.rotForce=0:(P.movementState.rotPosX=T.vector.y,P.movementState.rotPosY=-T.vector.x,T.force<.3?P.rotForce=(T.force-.2)/.1:P.rotForce=1)),this.requestRender()}),C.on("end",(M,T)=>{let P=this.gameControl;f==="pos"?(P.movementState.movePosZ=0,P.movementState.movePosX=0,P.moveForce=1):f==="rot"&&(P.movementState.rotPosX=0,P.movementState.rotPosY=0,P.rotForce=1)}),this.joysticks[m]=[C,g]}),this.markIsDestroyTarget(),this.markIsDragObject(),this.rebuildBVH(),this.initializationCounter++,window.setTimeout(()=>{this.collisionEvents.forEach(f=>f.disabled=!1)},80)}initPhysics(){var a;(a=this.sharedGameControlGlobals.rapierWorld)==null||a.free(),this.sharedGameControlGlobals.rapierWorld=new At.World(new At.Vector3(0,this.gravity,0)),this.events=new At.EventQueue(!0);let e=[],t=[];if(this.page.traverseChildren(o=>{var v,y,x,w;let l;if(o instanceof As)if(o.objectForSample){if(o.objectForSample.dataPatched.physics.fusedBody)return;l=o.object}else return o.object.dataPatched.physics.fusedBody===!0&&o.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(o instanceof xi)l=o.object;else if(l=o,((v=l.dataPatched.cloner)==null?void 0:v.disabled)===!1&&((y=l.dataPatched.cloner)==null?void 0:y.hideBase)&&((x=l.dataPatched.physics)==null?void 0:x.fusedBody)!==!0)return!0;let c=l.dataPatched,u;for(let b of c.events)b.data.disabled!==!0&&b.data.type==="GameControl"&&(u=b.data);if(!c.physics||(c.physics.enabled==="visibility"?!c.visible:!c.physics.enabled))return!0;o.updateMatrixWorldSVD();let h=hy(c),d=!1,p=l.userData.hasDestroy,f=l.userData.hasDrag,m=!1;for(let b of c.events)if(b.data.disabled!==!0){if(b.data.type==="Collision"){d=!0;let _=new dge(b.id,b.data,l,this.page,this.sharedAssets,this.eventManager);_.disabled=!0,this.collisionEvents.push(_),this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid]&&this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid].every(A=>A.id!==b.id)?this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid].push(_):this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid]=[_]}else if(b.data.type==="Follow"){m=!0;let _=b.data.target;o.traverseVisible(A=>{A.userData.isFollowingObj=_})}}c.physics.rigidBody==="dynamic"&&c.physics.fusedBody===!1&&(o.matrixWorldFusedFalse=o.matrixWorld.clone());let g=o.geometry;if(u!==void 0){let b=At.RigidBodyDesc.kinematicPositionBased();(o.hasNonUniformScale?o.matrixWorldRigid:o.matrixWorld).decompose(Er,ps,Oo),o.position0=Er.clone().divideScalar(this.pixelsPerMeter),o.rotation0=ps.clone(),Er.divideScalar(this.pixelsPerMeter),b.setTranslation(Er.x,Er.y,Er.z).setRotation(ps);let _=this.sharedGameControlGlobals.rapierWorld.createRigidBody(b);o.rigidBody=_;let A;u.collider.type==="sphere"?A=At.ColliderDesc.ball(u.collider.radius/this.pixelsPerMeter):u.collider.type==="capsule"?A=At.ColliderDesc.capsule((u.collider.height/2-u.collider.radius)/this.pixelsPerMeter,u.collider.radius/this.pixelsPerMeter):A=At.ColliderDesc.cuboid(u.collider.width/this.pixelsPerMeter/2,u.collider.height/this.pixelsPerMeter/2,u.collider.depth/this.pixelsPerMeter/2),A.setFrictionCombineRule(At.CoefficientCombineRule.Average).setRestitutionCombineRule(At.CoefficientCombineRule.Average).setDensity(c.physics.density).setFriction(c.physics.friction).setRestitution(c.physics.restitution);let S=this.sharedGameControlGlobals.rapierWorld.createCollider(A,_);this.sharedGameControlGlobals.colliderToEntity.set(S.handle,l),Er.fromArray(u.collider.position).multiply(Oo.setFromMatrixScale(l.matrixWorld)).divideScalar(this.pixelsPerMeter),S.setTranslationWrtParent(Er);let C=new ft().setFromEuler(new Zr().setFromVector3(new E().fromArray(u.collider.rotation)));S.setRotationWrtParent(C),S.setActiveEvents(At.ActiveEvents.COLLISION_EVENTS),this.generateSensorColliderDescs(l,!0)}else c.physics.rigidBody==="dynamic"||h||m||p||f||d?(this.addRigidBody(o,l,{hasFollow:m,hasTransformAnim:h,hasDrag:f}),this.generateSensorColliderDescs(l,c.physics.fusedBody)):(g&&e.push(qa(g,o.matrixWorld)),c.physics.fusedBody&&o.traverseObject((b,_)=>{var M;if(_===0)return;let A;if(b instanceof As)if(b.objectForSample){if(b.objectForSample.dataPatched.physics.fusedBody)return;A=b.object}else return b.object.dataPatched.physics.fusedBody===!0&&b.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(b instanceof xi)A=b.object;else if(A=b,(M=A.dataPatched.cloner)==null?void 0:M.hideBase)return!0;let S=A.dataPatched;if(S.physics.enabled==="visibility"?!S.visible:!S.physics.enabled)return!0;let C=b.geometry;(C==null?void 0:C.getAttribute("position"))!==void 0&&e.push(qa(C,b.matrixWorld))}),this.generateSensorColliderDescs(l,c.physics.fusedBody,t));if(((w=c.physics)==null?void 0:w.fusedBody)===!0||u)return!0}),e.length===0)return;let r=dc(e);r.scale(1/this.pixelsPerMeter,1/this.pixelsPerMeter,1/this.pixelsPerMeter);let i=At.RigidBodyDesc.fixed(),n=this.sharedGameControlGlobals.rapierWorld.createRigidBody(i),s=At.ColliderDesc.trimesh(r.getAttribute("position").array,r.getIndex().array).setFrictionCombineRule(At.CoefficientCombineRule.Multiply).setRestitutionCombineRule(At.CoefficientCombineRule.Multiply).setFriction(1).setRestitution(1);this.sharedGameControlGlobals.rapierWorld.createCollider(s,n);for(let[o,l]of t){let c=this.sharedGameControlGlobals.rapierWorld.createCollider(o,n);this.sensorToTriggerEvent[c.handle]=l}}updatePositions(){return this.nActiveRigidBodies=0,this.sharedGameControlGlobals.rapierWorld.forEachRigidBody(this.processRigidBody),this.nActiveRigidBodies>0}rebuildBVH(){this.usePhysics?(this.gameControl===null||this.needsCollisionDetection)&&this.initPhysics():(this.page.traverseEntity(e=>{for(let t of e.dataPatched.events)if(t.data.type==="Trigger"&&t.data.disabled!==!0){let r=new q5(t.id,t.data,e,this.page,this.sharedAssets,this.eventManager),i=new _e().compose(Ba.fromArray(t.data.position),Th.setFromEuler(X5.fromArray(t.data.rotation)),Q5);if(t.data.triggerZone==="box"){let n=new Ar;n.min.fromArray(t.data.size).multiplyScalar(-.5),n.max.fromArray(t.data.size).multiplyScalar(.5),this.sharedGameControlGlobals.triggers.push([n,i,e,r])}else this.sharedGameControlGlobals.triggers.push([t.data.radius,i,e,r])}}),this.needsCollisionDetection&&this.initBVH())}disconnectEvents(){this.collisionEvents.forEach(e=>e.disconnect()),this.sharedGameControlGlobals.triggers.forEach(e=>e[3].disconnect()),this.sharedGameControlGlobals.triggers.length=0}deactivate(){var e,t,r,i;if(this.isEnabled){this.isEnabled=!1,this.page.traverse(n=>{let s=n;s.matrixWorldFusedFalse&&(s.matrixWorldFusedFalse=void 0),s.rigidBody&&(s.rigidBody=void 0),s.position0&&(s.position0=void 0),s.rotation0&&(s.rotation0=void 0)}),(e=this.sharedGameControlGlobals.rapierWorld)==null||e.free(),this.sharedGameControlGlobals.rapierWorld=void 0,this.sharedGameControlGlobals.staticMeshBVH=void 0,this.accumulator=0,this.sharedGameControlGlobals.entitiesWithTransformAnim=[],this.disconnectEvents(),(t=this.gameControl)==null||t.reset(),(r=this.gameControl)==null||r.dispose(),this.gameControl=null,this.initializationCounter=-1,this.joysticks.forEach(([n,s])=>{n==null||n.destroy(),s.remove()}),this.joystickToGameControls=[],this.joysticks=[],this.orbitControls&&(this.orbitControls.dispose(),this.orbitControls=void 0),(i=this.navigationMeshWrapper)==null||i.dispose(),this.navigationMeshWrapper=void 0;for(let n of Object.values(this.sharedGameControlGlobals.entityToCollisionEvents))n.forEach(s=>s.disconnect());this.sharedGameControlGlobals.entityToCollisionEvents={},this.page.updateMatrixWorld(!0)}}update(e,t,r){if(!this.isEnabled)return!0;let i=!0;if(this.orbitControls!==void 0&&this.orbitControls.needsUpdate&&(i=!this.orbitControls.update()),this.initializationCounter>=0&&this.initializationCounter<2?(this.initializationCounter++,i=!1):this.initializationCounter===2&&this.gameControl&&(i=!this.gameControl.update(e,t,r)&&i),this.usePhysics){let n=.016666666666666666;if(e===0)i=this.stepPhysics()&&i;else{let s=e/1e3;s<n&&s>n*.55&&(s=n),this.accumulator+=s;let a=performance.now(),o=0,l=6;for(;this.accumulator>=n&&o<l&&(i=this.stepPhysics()&&i,this.accumulator-=n,o++,!(performance.now()-a>n*1e3)););this.accumulator=this.accumulator%n}}return i}stepPhysics(){var e;for(let t of this.sharedGameControlGlobals.entitiesWithTransformAnim){(t.hasNonUniformScale?t.matrixWorldRigid:t.matrixWorld).decompose(Er,ps,Oo),Ww.setFromQuaternion(ps);let r=t;r.prevR===void 0?(r.prevR=Ww.clone(),r.prevT=Er.clone()):(r.prevR.copy(Ww),r.prevT.copy(Er)),t.rigidBody.setNextKinematicTranslation(Er.divideScalar(this.pixelsPerMeter)),t.rigidBody.setNextKinematicRotation(ps)}return this.sharedGameControlGlobals.rapierWorld.step(this.events),(e=this.events)==null||e.drainCollisionEvents(this.handleCollisionEvents),!this.updatePositions()}dispatchCollisionEvent(e,t,r){var s;let i=((s=this.sharedGameControlGlobals.rapierWorld)==null?void 0:s.getCollider(r))._parent,n;if(t.cloner){for(let a of t.cloner.children)if(a.rigidBody===i){n=a;break}}e.dispatch(n),t.dispatchEvent(q_)}updateUseWindowEvents(e){var t;(t=this.orbitControls)==null||t.updateUseWindowEvents(e)}generateSensorColliderDescs(e,t,r){let i=Ige.copy(e.matrixWorld).invert();e.traverseEntity((n,s)=>{if(t===!1&&s===1)return!0;for(let a of n.dataPatched.events)if(a.data.type==="Trigger"&&a.data.disabled!==!0){let o=new q5(a.id,a.data,n,this.page,this.sharedAssets,this.eventManager),l;if(a.data.triggerZone==="box"?l=At.ColliderDesc.cuboid(...a.data.size.map(c=>c/(2*this.pixelsPerMeter))):l=At.ColliderDesc.ball(a.data.radius/this.pixelsPerMeter),l.setDensity(0).setSensor(!0).setActiveEvents(At.ActiveEvents.COLLISION_EVENTS),Ba.fromArray(a.data.position),Th.setFromEuler(X5.fromArray(a.data.rotation)),qw.compose(Ba,Th,Q5).premultiply(n.matrixWorld),r?(qw.decompose(Ba,Th,Y5),l.setActiveCollisionTypes(At.ActiveCollisionTypes.KINEMATIC_FIXED|At.ActiveCollisionTypes.DYNAMIC_FIXED)):(qw.premultiply(i).decompose(Ba,Th,Y5),e.rigidBody.bodyType()===At.RigidBodyType.Dynamic||(e.rigidBody.bodyType()===At.RigidBodyType.Fixed?l.setActiveCollisionTypes(At.ActiveCollisionTypes.KINEMATIC_FIXED|At.ActiveCollisionTypes.DYNAMIC_FIXED):l.setActiveCollisionTypes(At.ActiveCollisionTypes.KINEMATIC_KINEMATIC|At.ActiveCollisionTypes.DYNAMIC_KINEMATIC))),Ba.divideScalar(this.pixelsPerMeter),l.setTranslation(Ba.x,Ba.y,Ba.z),l.setRotation(Th),r)r.push([l,o]);else{let c=this.sharedGameControlGlobals.rapierWorld.createCollider(l,e.rigidBody);this.sensorToTriggerEvent[c.handle]=o}}})}};function kge(e){let t=this._clip.duration,r=this._clip.start??0,i=this.loop,n=this.time+e,s=this._loopCount,a=i===w3;if(e===0)return s===-1?n:a&&(s&1)===1?t-(n-r):n;if(i===lR){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(n>=t)n=t;else if(n<0)n=0;else{this.time=n;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,a)):this._setEndings(this.repetitions===0,!0,a)),n>=t||n<r){let o=Math.floor((n-r)/(t-r));n-=(t-r)*o,s+=Math.abs(o);let l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,a||(n=e>0?t:r,this.repetitions===1&&(n=t)),this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(l===1){let c=e<0;this._setEndings(c,!c,a)}else this._setEndings(!1,!1,a);this._loopCount=s,this.time=n,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=n;if(a&&(s&1)===1)return t-(n-r)}return n}var K5=!1,Nge=class{constructor(e,t,r,i){this.scene=e,this.requestRender=t,this.updateDisplayProgress=r,this.animationInspectorState=i,this.clipIdToAction={},this.activeClip=null,this.needsUpdate=!1,this.addClip=n=>{n.data.type==="Empty"&&n.data.animations&&n.data.animations.forEach((s,a)=>{let o=s[0]+"/";if(Array.isArray(n.identity)?o+=n.identity[0]:o+=n.uuid,this.clipIdToAction[o])return;let l=x2.parse(JSON.parse(s[2]));n.animations[a]=l;let c=this.mixer.clipAction(l,n);K5===!1&&(Object.getPrototypeOf(c)._updateTime=kge,K5=!0),c.clampWhenFinished=!0,this.clipIdToAction[o]=c})},this.mixer=new NZ(e),this.scene.traverseEntity(this.addClip)}deleteClip(e,t){let r=this.scene.find(t);if(!r)return;let i=r.animations.find(s=>s.uuid===e);if(!i)return;let n=this.clipIdToAction[e];!n||(n.stop(),this.mixer.uncacheClip(i),delete this.clipIdToAction[e],r.animations=r.animations.filter(s=>s.uuid!==e))}get isPlaying(){return Object.values(this.clipIdToAction).some(e=>e.isRunning())}playFromInspector(e){this.mixer.stopAllAction();let t=this.clipIdToAction[e];!t||(t.play(),this.activeClip=t.getClip(),this.requestRender())}onExitPlayMode(){Object.values(this.clipIdToAction).forEach(e=>{e.repetitions=1/0,e.loop=cR}),this.mixer.stopAllAction(),this.requestRender()}play(e){let t=e.clipId+"/"+e.object,r=this.clipIdToAction[t];if(r)return e&&(e.repeat>=0&&(r.repetitions=e.repeat+1),e.direction==="pingpong"&&e.repeat!==0&&(r.loop=w3)),r.play(),r.paused=!1,this.requestRender(),r}resumeFromInspector(e){let t=this.clipIdToAction[e];!t||(t.play(),t.paused=!1,this.requestRender())}pauseFromInspector(e){let t=this.clipIdToAction[e];!t||(t.paused=!0)}stop(){this.mixer.stopAllAction(),this.requestRender()}update(e){var t;if(this.needsUpdate)this.needsUpdate=!1;else if(this.isPlaying===!1||(t=this.animationInspectorState)!=null&&t.isScrubbing)return;this.mixer.update(e/1e3),this.activeClip&&this.updateDisplayProgress(Math.round(this.mixer.time/this.activeClip.duration*this.maxFrames%this.maxFrames)),this.requestRender()}get maxFrames(){var e,t;return((t=(e=this.activeClip)==null?void 0:e.tracks[0])==null?void 0:t.times.length)??0}setProgressFromInspector(e,t){if(!this.clipIdToAction[t])return;this.activeClip!==this.clipIdToAction[t].getClip()&&this.playFromInspector(t);let r=this.clipIdToAction[t].paused;this.clipIdToAction[t].paused=!1,this.mixer.setTime(Math.min(this.maxFrames?e/this.maxFrames:0,.9999)*this.activeClip.duration),this.requestRender(),r&&(this.clipIdToAction[t].paused=!0)}},Xw=new WeakMap,Fge=class extends R3{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,r,i){let n=new w2(this.manager);n.setPath(this.path),n.setResponseType("arraybuffer"),n.setRequestHeader(this.requestHeader),n.setWithCredentials(this.withCredentials),n.load(e,s=>{this.decodeDracoFile(s,t).catch(i)},r,i)}decodeDracoFile(e,t,r,i){let n={attributeIDs:r||this.defaultAttributeIDs,attributeTypes:i||this.defaultAttributeTypes,useUniqueIDs:!!r};return this.decodeGeometry(e,n).then(t)}decodeGeometry(e,t){let r=JSON.stringify(t);if(Xw.has(e)){let o=Xw.get(e);if(o.key===r)return o.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let i,n=this.workerNextTaskID++,s=e.byteLength,a=this._getWorker(n,s).then(o=>(i=o,new Promise((l,c)=>{i._callbacks[n]={resolve:l,reject:c},i.postMessage({type:"decode",id:n,taskConfig:t,buffer:e},[e])}))).then(o=>this._createGeometry(o.geometry));return a.catch(()=>!0).then(()=>{i&&n&&this._releaseTask(i,n)}),Xw.set(e,{key:r,promise:a}),a}_createGeometry(e){let t=new it;e.index&&t.setIndex(new nt(e.index.array,1));for(let r=0;r<e.attributes.length;r++){let i=e.attributes[r],n=i.name,s=i.array,a=i.itemSize;t.setAttribute(n,new nt(s,a))}return t}_loadLibrary(e,t){let r=new w2(this.manager);return r.setPath(this.decoderPath),r.setResponseType(t),r.setWithCredentials(this.withCredentials),new Promise((i,n)=>{r.load(e,i,void 0,n)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;let e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(r=>{let i=r[0];e||(this.decoderConfig.wasmBinary=r[1]);let n=Uge.toString(),s=["/* draco decoder */",i,"","/* worker */",n.substring(n.indexOf("{")+1,n.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([s]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){let i=new Worker(this.workerSourceURL);i._callbacks={},i._taskCosts={},i._taskLoad=0,i.postMessage({type:"init",decoderConfig:this.decoderConfig}),i.onmessage=function(n){let s=n.data;switch(s.type){case"decode":i._callbacks[s.id].resolve(s);break;case"error":i._callbacks[s.id].reject(s);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+s.type+'"')}},this.workerPool.push(i)}else this.workerPool.sort(function(i,n){return i._taskLoad>n._taskLoad?-1:1});let r=this.workerPool[this.workerPool.length-1];return r._taskCosts[e]=t,r._taskLoad+=t,r})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}};function Uge(){let e,t;onmessage=function(a){let o=a.data;switch(o.type){case"init":e=o.decoderConfig,t=new Promise(function(u){e.onModuleLoaded=function(h){u({draco:h})},DracoDecoderModule(e)});break;case"decode":let l=o.buffer,c=o.taskConfig;t.then(u=>{let h=u.draco,d=new h.Decoder,p=new h.DecoderBuffer;p.Init(new Int8Array(l),l.byteLength);try{let f=r(h,d,p,c),m=f.attributes.map(g=>g.array.buffer);f.index&&m.push(f.index.array.buffer),self.postMessage({type:"decode",id:o.id,geometry:f},m)}catch(f){console.error(f),self.postMessage({type:"error",id:o.id,error:f.message})}finally{h.destroy(p),h.destroy(d)}});break}};function r(a,o,l,c){let u=c.attributeIDs,h=c.attributeTypes,d,p,f=o.GetEncodedGeometryType(l);if(f===a.TRIANGULAR_MESH)d=new a.Mesh,p=o.DecodeBufferToMesh(l,d);else if(f===a.POINT_CLOUD)d=new a.PointCloud,p=o.DecodeBufferToPointCloud(l,d);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!p.ok()||d.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+p.error_msg());let m={index:null,attributes:[]};for(let g in u){let v=self[h[g]],y,x;if(c.useUniqueIDs)x=u[g],y=o.GetAttributeByUniqueId(d,x);else{if(x=o.GetAttributeId(d,a[u[g]]),x===-1)continue;y=o.GetAttribute(d,x)}m.attributes.push(n(a,o,d,g,v,y))}return f===a.TRIANGULAR_MESH&&(m.index=i(a,o,d)),a.destroy(d),m}function i(a,o,l){let c=l.num_faces()*3,u=c*4,h=a._malloc(u);o.GetTrianglesUInt32Array(l,u,h);let d=new Uint32Array(a.HEAPF32.buffer,h,c).slice();return a._free(h),{array:d,itemSize:1}}function n(a,o,l,c,u,h){let d=h.num_components(),p=l.num_points()*d,f=p*u.BYTES_PER_ELEMENT,m=s(a,u),g=a._malloc(f);o.GetAttributeDataArrayForAllPoints(l,h,m,f,g);let v=new u(a.HEAPF32.buffer,g,p).slice();return a._free(g),{name:c,array:v,itemSize:d}}function s(a,o){switch(o){case Float32Array:return a.DT_FLOAT32;case Int8Array:return a.DT_INT8;case Int16Array:return a.DT_INT16;case Int32Array:return a.DT_INT32;case Uint8Array:return a.DT_UINT8;case Uint16Array:return a.DT_UINT16;case Uint32Array:return a.DT_UINT32}}}var tl;function jge(){return tl||(tl=new Fge,tl.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.2/").preload()),tl.decoderPending}async function Vge(e){if(tl){let t={attributeIDs:tl.defaultAttributeIDs,attributeTypes:tl.defaultAttributeTypes,useUniqueIDs:!1},r;try{r=await tl.decodeGeometry(new Int8Array(e).buffer,t)}catch(i){console.error(i)}if(r)return{index:r.index?{array:r.index.array}:void 0,attributes:Object.entries(r.attributes).map(([i,n])=>({name:i,itemSize:n.itemSize,array:n.array}))}}return null}async function Hge(e,t){let[r,i]=jB(z2.deserialize(new Uint8Array(e)));hz(r);let n=[];r.scene.objects.traverse((s,a)=>{a.type==="Mesh"&&a.geometry.type==="NonParametricGeometry"&&a.geometry.data.draco!==void 0&&n.push(a)}),n.length&&await jge();for(let s of n){let a=await Vge(ti(s.geometry.data.draco));if(a){a.index&&(s.geometry.data.index={array:a.index.array,itemSize:1,normalized:!1,type:"Uint32Array"});let o={};a.attributes.forEach(({name:l,array:c,itemSize:u})=>{o[l]={array:c,itemSize:u,type:"Float32Array",normalized:!1}}),s.geometry.data.attributes=o,s.geometry.data.draco=void 0}}return t&&t(r),i.result().data}var Gge=class{constructor(e,t,r,i,n,s,a){this.id=e,this.data=t,this.dataEvent=r,this.object=i,this.stage=!1,this.actions=En(r,t.actions,n,s,a,i)}disconnect(){on(this.actions)}dispatchIn(){this.actions.Audio.forEach(e=>e.dispatchBasic()),this.actions.Video.forEach(e=>e.dispatchBasic()),this.actions.Create.forEach(e=>e.dispatch()),this.actions.Destroy.forEach(e=>e.dispatch()),this.actions.Reset.forEach(e=>e.dispatch()),this.actions.Link.forEach(e=>e.dispatch()),this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.actions.Transition.forEach(e=>e.toggle()),this.actions.Animation.forEach(e=>e.play()),this.actions.SwitchCamera.forEach(e=>e.play()),this.actions.SceneTransition.forEach(e=>e.dispatch())}dispatchOut(){this.actions.Transition.forEach(e=>{e.toggle()})}},Wge=class extends _a{constructor(e,t){super(e),this.eventManager=t,this.breakpoints=[],this.helperResize=(r,i)=>{this.breakpoints.forEach(n=>{let s=U2.deviceToSize(n.data.size),a=n.dataEvent.orientation==="horizontal"?r:i,o;switch(n.data.operator){case"<":o=a<s[0];break;case">":o=a>s[0];break;case"<>":o=a>s[0]&&a<s[1];break}n.stage!==o&&(n.stage=o,n.stage?n.dispatchIn():n.dispatchOut())})},this.onResize=()=>{let{innerWidth:r,innerHeight:i}=window;this.helperResize(r,i)},this.onResizeObserver=new ResizeObserver(r=>{for(let i of r){let{width:n,height:s}=i.contentRect;this.helperResize(n,s)}})}connect(){let{page:e,sharedAssets:t,domElement:r,isExport:i,frame:n}=this.eventContext;i?window.addEventListener("resize",this.onResize):n.preset==="fullscreen"?this.onResizeObserver.observe(r):window.addEventListener("resize",this.onResize),e.traverseEntity(s=>{var a;if(!(!s.visible||!((a=s.data)!=null&&a.events.length)))for(let{data:o}of s.data.events)o.disabled||o.type==="Resize"&&o.breakpoints.forEach(({data:l,id:c})=>{try{let u=new Gge(c,l,o,s,e,t,this.eventManager);this.breakpoints.push(u)}catch{}})})}disconnect(){let{isExport:e,frame:t}=this.eventContext;e?window.removeEventListener("resize",this.onResize):t.preset==="fullscreen"?this.onResizeObserver.disconnect():window.removeEventListener("resize",this.onResize),this.breakpoints.forEach(r=>{r.disconnect()}),this.breakpoints=[]}},Z5=Object.keys(x8).filter(e=>isNaN(Number(e))),qge=class{constructor(e,t,r,i){this.publish=e,this.controlsManager=t,this.animationControls=r,this.eventContext=i,this.isEnabled=!1,this.activateCount=0,this.onResetRaycaster=()=>{this.eventContext.raycasterNeedsUpdate=!0},this.onTouchMovePreventScroll=n=>{(n.touches.length>1||this.preventTouchScroll)&&n.preventDefault()},this.onMouseWheelPreventScroll=n=>{this.preventScroll&&n.preventDefault()},this.stopRaycast=e.stopRaycast,this.preventScroll=e.preventScroll,this.preventTouchScroll=e.preventTouchScroll,this.hideCursor=e.hideCursor,this.requestRender=i.requestRender}activate(){if(this.isEnabled)return;this.isEnabled=!0,this.handlers={Spline:new Bme(this.eventContext),Conditional:new Vme(this.eventContext,this),Start:new uge(this.eventContext,this),Basic:new kme(this.eventContext,this),MouseHover:new age(this.eventContext,this),Scroll:new cge(this.eventContext,this),Follow:new $me(this.eventContext,this),DragDrop:new Xme(this.eventContext,this),LookAt:new ige(this.eventContext),Resize:new Wge(this.eventContext,this)};let{page:e,domElement:t,eventElement:r}=this.eventContext;this.hideCursor&&(t.style.cursor="none"),e.traverseEntity(i=>{i.addEventListener("requestRender",this.requestRender)}),Object.values(this.handlers).forEach(i=>i.connect()),Z5.forEach(i=>{(Object.values(this.handlers).some(n=>n.domEventsNeeded.has(i))||i==="pointerdown"&&this.controlsManager.navigationMeshWrapper)&&(t.addEventListener(i,this.onResetRaycaster),r.addEventListener(i,this.onResetRaycaster))}),t.addEventListener("wheel",this.onMouseWheelPreventScroll),t.addEventListener("touchmove",this.onTouchMovePreventScroll),this.activateCount++}deactivate(){var r;if(!this.isEnabled)return;this.isEnabled=!1;let{page:e,domElement:t}=this.eventContext;t.style.cursor="",Object.values(this.handlers).forEach(i=>i.disconnect()),(r=this.controlsManager.gameControl)==null||r.disposeActions(),this.controlsManager.disconnectEvents(),e.traverseEntity(i=>{i.removeEventListener("requestRender",this.requestRender)}),Z5.forEach(i=>{t.removeEventListener(i,this.onResetRaycaster)}),t.removeEventListener("touchmove",this.onTouchMovePreventScroll),t.removeEventListener("wheel",this.onMouseWheelPreventScroll),this.animationControls.onExitPlayMode()}get isPaused(){return this.isEnabled}pause(){this.deactivate()}resume(){this.activate()}reset(){this.deactivate(),this.activate(),this.controlsManager.page.updateMatrixWorld(!0),this.controlsManager.rebuildBVH()}updateUseWindowEvents(e){let t=this.isEnabled;t&&this.deactivate(),this.eventContext.useWindowEvents=e,t&&this.activate()}},Xge=class{constructor(e,t,r,i,n){this._aspect=1,this.enableResponsive=!1,this._renderer=e,this._camera=t,this._frameSize=new W().copy(r),this._editorSize=new W().copy(i),this._aspect=t.aspect,this._fov=n??t.fov}set frameSize(e){this._frameSize.copy(e)}updateRenderer(){!this._renderer||this._renderer.setSize(this._frameSize.x,this._frameSize.y)}updateViewport(){if(!this._renderer||!this._camera||this._camera.cameraType!=="PerspectiveCamera")return;let e=this._frameSize.x,t=this._frameSize.y,r=this._editorSize.y;this._aspect=e/t,t<=r&&(this._camera.zoom*=r/t),this._renderer.setViewport(0,0,e,t)}updateCamera(e=!0){if(this._camera)if(this._camera.cameraType==="PerspectiveCamera"){let t=this._frameSize.y,r=this._editorSize.y,i=this._fov;if(e&&t>r){let n=Yge(t,1080,2160,1,15)/100;i*=t/r,i*=1-n}this._camera.aspect=this._aspect,this._camera.fov=i,this._camera.updateProjectionMatrix()}else this._camera.setViewplaneSize(this._frameSize.x,this._frameSize.y,this.enableResponsive)}setCamera(e){this._camera=e,this._aspect=e.aspect,this._fov=e.fov}revert(){let e=window.innerWidth,t=window.innerHeight;this._renderer&&(this._renderer.setViewport(0,0,e,t),this._renderer.setSize(e,t)),this._camera&&(this._camera.aspect=e/t,this._camera.fov=this._fov,this._camera.setViewplaneSize(e,t,this.enableResponsive),this._camera.updateProjectionMatrix())}};function Yge(e,t,r,i,n){return(e-t)/(r-t)*(n-i)+i}var Qge=class{get sharedAssets(){return this.shared}constructor(e,t={}){this.shared=new PA(e.shared,t),this.scene=new NA(e.scene,this.sharedAssets)}reset(e,t){this.scene.clearScene(),this.sharedAssets.reset(e.shared),this.scene.resetAfterClear(e.scene,this.sharedAssets)}resetPersonalCameraFromDocumentData(){for(let e of this.scene.children)e instanceof yl&&e.personalCamera.updateState(e.data.camera,{scene:this.scene,shared:this.shared})}dispose(){this.scene.dispose(),this.shared.dispose()}gc(){this.shared.geometryCache.startGc(),this.shared.geometryCache2.startGc(),this.scene.traverseEntity(e=>{e instanceof zi&&e.markGeometryAsReachable(this.shared)}),this.shared.geometryCache.endGc(),this.shared.geometryCache2.endGc()}},Kge=class{constructor({x:e=10,y:t=10}){this._startTime=0;let r=document.getElementById("spe-perfs");r?this.element=r:(this.element=document.createElement("div"),document.body.appendChild(this.element),this.element.style.position="absolute",this.element.style.zIndex="10000",this.element.style.fontFamily="monospace",this.element.style.background="black",this.element.style.color="white",this.element.style.padding="10px",this.element.style.opacity="0.5",this.element.style.fontSize="11px",this.element.setAttribute("id","spe-perfs")),this.element.style.left=`${e}px`,this.element.style.top=`${t}px`}dispose(){var e;(e=this.element.parentElement)==null||e.removeChild(this.element)}start(){this._startTime=performance.now()}end(){let e=performance.now()-this._startTime;this.element.innerHTML=e.toFixed(3)+" ms"}};function Zge(e){let t;if(e.index)for(let r=0;r<e.index.array.length;r+=3)t=e.index.array[r],e.index.array[r]=e.index.array[r+2],e.index.array[r+2]=t}function df(e){return e instanceof Kf?"SubdivObject":e.geometry.type==="NonParametricGeometry"?"NonParametric":"Mesh"}function $ge(e,t){let r={};return e.traverseEntity(i=>{var l;if(!i.visible||!(i instanceof an)||i.type!=="Mesh"||Array.isArray(i.material)||i.states&&Object.keys(i.states).length)return;let n=i.parent;for(;n;){if(n instanceof an&&i.states&&Object.keys(i.states).length)return;n=n.parent}let s=i.material.uuid,a=t.shared.materials[s];if(a){if(!wi.isMergable(a))return}else{let c=(l=t.scene.objects.get(i.uuid))==null?void 0:l.data;if(c&&"material"in c&&typeof c.material!="string"){if(!wi.isMergable(c.material))return;s=wi.getHash(c.material)}}r[s]||(r[s]={});let o=r[s][df(i)];if(o){if(o.push(i),i.cloner)for(let c of i.cloner.children)o.push(c)}else if(r[s][df(i)]=[i],i.cloner)for(let c of i.cloner.children)r[s][df(i)].push(c)}),r}function Jge(e){let t=0;return Object.values(e).forEach(r=>{Object.values(r).forEach(i=>{let n=i.length;n>t&&(t=n)})}),t}function eve(e,t){let r=$ge(t,e),i=Jge(r),n=new Array(i),s=0,a=new Array(i),o=0,l=new Array(i),c=0,u=new Array(i),h=0;for(let[d,p]of Object.entries(r))for(let f of Object.values(p)){if(o=0,c=0,f.forEach(g=>{g instanceof an&&(a[o++]=g.geometry.clone(),l[c++]=g)}),c<2)continue;for(let g=0;g<c;g++)l[g].updateWorldMatrix(!0,!1),a[g].applyMatrix4(l[g].matrixWorld),l[g].matrixWorld.determinant()<0&&Zge(a[g]);let m=dc(a.slice(0,o),!1);if(m){let g;switch(d){case"SubdivObject":{console.warn("Turning subdiv object into mesh"),g=new Ki(m,l[0].material);break}default:{g=new Ki(m,l[0].material);break}}g.castShadow=l[0].castShadow,g.receiveShadow=l[0].receiveShadow,t.add(g);let v=y=>{h=0;for(let x of y)x.children&&v(x.children),x instanceof an&&(Array.isArray(x.material)||r[x.material.uuid]&&r[x.material.uuid][df(x)]&&r[x.material.uuid][df(x)].length>1||(u[h++]=x));for(let x=0;x<h;x++)t.attach(u[x])};for(let y=0;y<c;y++){let x=l[y];v(x.children),n[s++]=x}}}for(let d=0;d<s;d++)n[d].removeFromParent()}var tve=ld(CG(),1),rve=new W;function ive(e){let t="The Spline Runtime only accepts .splinecode files that are generated from Spline export panel.";e.endsWith(".spline")?console.warn(t+" The .spline files are only meant to be used by the Editor."):e.endsWith(".splinecode")||console.warn(t)}var nve=class{constructor(e,{renderOnDemand:t,renderMode:r="auto"}={}){this._viewportMode=1,this._viewportWidth=window.innerWidth,this._viewportHeight=window.innerHeight,this._proxyObjectCache=new Map,this._isPaused=!1,this._renderRequested=!1,this._skipRender=!1,this.time=performance.now(),this.dt=0,this.currentTAAFrame=0,this.disposed=!1,this._requestRenderAutoMode=()=>{this._skipRender=!1},this.requestRender=()=>{this._renderRequested=!0},this.render=i=>{var n,s,a,o,l,c,u,h,d,p,f,m;if(this.time=i,this._lastTime&&(this.dt=this.time-this._lastTime),this._lastTime=this.time,(n=this._perfs)==null||n.start(),!this._renderer){(s=this._perfs)==null||s.end();return}if(!this._isPaused&&(this.renderMode==="manual"&&!this._renderRequested||this.renderMode==="auto"&&this._skipRender)){(a=this._perfs)==null||a.end();return}if(this._renderRequested=!1,this._skipRender=!0,this._controls&&(this._skipRender=this._controls.update(this.dt)),this._eventManager&&((o=this._eventManager.handlers)!=null&&o.Start.hasVideoAction||(l=this._eventManager.handlers)!=null&&l.Basic.hasVideoAction||(c=this._eventManager.handlers)!=null&&c.Conditional.hasVideoAction)&&(this._skipRender=!1),(u=this._animationControls)==null||u.update(this.dt),this._skipRender?(this.currentTAAFrame++,this.currentTAAFrame<32?this._skipRender=!1:this.currentTAAFrame=0):this.currentTAAFrame=0,this._scene&&this._scene.activeCamera!==this._camera&&(this._camera=this._scene.activeCamera),(h=this._eventManager)!=null&&h.isEnabled&&(((d=this._eventManager.handlers)==null?void 0:d.Follow).onAnimationFrameDamping(),((p=this._eventManager.handlers)==null?void 0:p.LookAt).onAnimationFrameDamping(),((f=this._eventManager.handlers)==null?void 0:f.DragDrop).onAnimationFrameDamping()),this._scene&&this._camera){if(this._scene.pathConstraints.applyConstraints(this._scene),this._renderer.sceneTransitionTimeRemaining>0){this._renderer.sceneTransitionTimeRemaining-=this.dt;let g=1-this._renderer.sceneTransitionTimeRemaining/this._renderer.sceneTransitionDuration;this._renderer.pipeline.sceneTransitionPass.uniforms.mixRatio.value=g,this._skipRender=!1}else this._renderer.pipeline.sceneTransitionFromTexture=null;this._renderer.renderSplineScene(this._scene,this._camera)}this.canvas.dispatchEvent(this._renderedEvent),(m=this._perfs)==null||m.end()},this._resize=()=>{var i,n,s,a,o,l,c,u,h,d;if(this._renderer){if(this._viewportMode===1&&this._frameView&&(this._frameView.frameSize=rve.set(this._viewportWidth,this._viewportHeight)),this._renderer.setSize(this._viewportWidth,this._viewportHeight,!1),this._camera=(i=this._scene)==null?void 0:i.activeCamera,(c=this._scene)==null||c.updateViewPlaneSize(((s=(n=this._frameView)==null?void 0:n.frameSize)==null?void 0:s.x)??this._viewportWidth,((o=(a=this._frameView)==null?void 0:a.frameSize)==null?void 0:o.y)??this._viewportHeight,((l=this._frameView)==null?void 0:l.enableResponsive)??!1),this._camera){let p=Object.values(((u=this._data)==null?void 0:u.frames)??{})[0].preset??"fullscreen";(h=this._frameView)==null||h.setCamera(this._camera),(d=this._frameView)==null||d.updateCamera(p!=="fullscreen"),this._camera.cameraType==="PerspectiveCamera"&&(this._camera.aspect=this._viewportWidth/this._viewportHeight),this._camera.updateProjectionMatrix()}this._requestRenderAutoMode()}},this._debouncedResize=tA(this._resize,10),this.canvas=e,this.renderMode=t?"auto":r,this._renderedEvent=new CustomEvent("rendered",{bubbles:!0}),Object.defineProperty(this._renderedEvent,"target",{writable:!1,value:this}),window.location.search.includes("perfs")&&(this._perfs=new Kge({x:10,y:10})),gae(e)}async load(e,t){ive(e),this.disposed=!1;let r=await(await fetch(e,t)).arrayBuffer();await this.start(r)}async start(e,{interactive:t=!0}={}){var a,o,l;if(this.disposed)return;let r=await Hge(e);this._data=r,r.version&&(0,tve.default)(r.version,"0.9.450")>0&&console.warn("Your .splinecode file is more recent than the library. Please upgrade @splinetool/runtime to the latest version."),await Promise.all([GD(r)&&Rce(),tue(r)&&Lce(),Gf.physicsEnabled(r.scene.objects)&&bae(),UD(r)&&Vhe(),Sge(r)&&xae()].filter(Boolean)),(a=this._eventManager)==null||a.deactivate(),(o=this._controls)==null||o.deactivate(),(l=this._scene)==null||l.dispose();let i=new Qge(r);if(i.resetPersonalCameraFromDocumentData(),this._scene=i.scene,this._sharedAssetsManager=i.sharedAssets,this._camera=this._scene.activeCamera,window.location.search.includes("merge-geometries")){let c=performance.now();eve(r,i.scene);let u=performance.now();console.log("Merged geometries in ",u-c," ms")}GD(r)&&this._scene.traverse(c=>{na(c)&&c.recomputeBoolean()}),this._sharedAssetsManager.setRequestRender(()=>{var c;this._requestRenderAutoMode(),(c=this._scene)==null||c.traverse(u=>{u instanceof As&&u.pendingMediaLoad&&u.update()})});let n=Object.keys(r.shared.fonts).map(c=>this._sharedAssetsManager.getFont(c).loadingPromise);Promise.all(n).then(()=>{i.scene.markNeedsUpdateRendererDirty(),this._requestRenderAutoMode()}),UD(r)&&Bge(r)&&await Promise.all(n),this._scene.rewriteEventsBeforeGoToPlayMode(),KA(this._scene.activePage,this._sharedAssetsManager),this._renderer||(this._renderer=new Dpe({canvas:this.canvas,antialias:!1,alpha:!0,stencil:!1,depth:!1,powerPreference:"high-performance"}),this._renderer.hdTransmission=r.scene.publish.hdTransmission===!0,this._renderer.setPixelRatio(window.devicePixelRatio),this._renderer.pipeline.addEventListener("smaaloaded",this._requestRenderAutoMode)),r.scene.blueNoiseTextureData!==void 0&&this._renderer.pipeline.updateBlueNoiseTexture(r.scene.blueNoiseTextureData);let s=Object.values(r.frames)[0];if(this._frameView?this._frameView.setCamera(this._camera):(s.preset==="fullscreen"?(this._viewportMode=1,this.canvas.style.display="block",this.canvas.parentElement&&(this._viewportWidth=this.canvas.parentElement.clientWidth||300,this.canvas.style.width="100%"),this.canvas.parentElement&&(this._viewportHeight=this.canvas.parentElement.clientHeight||150,this.canvas.style.height="100%")):(this._viewportMode=2,this._viewportWidth=s.size[0],this._viewportHeight=s.size[1],this.canvas.style.width=`${this._viewportWidth}px`,this.canvas.style.height=`${this._viewportHeight}px`),this._renderer.setSize(this._viewportWidth,this._viewportHeight,!1),this._frameView=new Xge(this._renderer,this._camera,new W(this._viewportWidth,this._viewportHeight),new W(window.innerWidth,window.innerHeight)),this._frameView.enableResponsive=(s.allowResponsive??!1)&&s.preset==="fullscreen"),t){let c=new Ome(this._renderer,this.data.scene.publish,this._scene,()=>this._scene.activeCamera,this._sharedAssetsManager,this._requestRenderAutoMode,!0,s);this._scene.updateMatrixWorld(!0),this._controls=new zge(c),this._animationControls=new Nge(this._scene,this._requestRenderAutoMode),this._eventManager=new qge(r.scene.publish,this._controls,this._animationControls,c),this._eventManager.activate(),this._controls.activate(this._eventManager)}this._resize(),this.dt===0&&(this.render(performance.now()),setTimeout(()=>{var c;(c=this._renderer)==null||c.setAnimationLoop(this.render)},0)),this._resizeObserverTimeout=setTimeout(()=>{!this._resizeObserver&&this.canvas.parentElement&&(this._resizeObserver=new ResizeObserver(()=>{this._viewportWidth=this.canvas.clientWidth,this._viewportHeight=this.canvas.clientHeight,this._debouncedResize()}),this._resizeObserver.observe(this.canvas.parentElement))},300)}findObjectById(e){var r;let t=(r=this._scene)==null?void 0:r.getObjectByProperty("uuid",e);return this._createProxyObject(t)}findObjectByName(e){var r;let t=(r=this._scene)==null?void 0:r.getObjectByName(e);return this._createProxyObject(t)}getAllObjects(){var t;let e=[];return(t=this._scene)==null||t.traverseEntity(r=>{if(r.uuid!==_d&&!this._scene.isInvisibleObjects(r)&&!(r instanceof yl)){let i=this._createProxyObject(r);i&&e.push(i)}}),e}getSplineEvents(){var e,t;return((t=(e=this._eventManager)==null?void 0:e.handlers)==null?void 0:t.Spline).splineEvents}emitEvent(e,t){var r;(r=this.findObjectById(t)||this.findObjectByName(t))==null||r.emitEvent(e)}emitEventReverse(e,t){var r;(r=this.findObjectById(t)||this.findObjectByName(t))==null||r.emitEventReverse(e)}addEventListener(e,t){this.canvas.addEventListener(e,t)}removeEventListener(e,t){this.canvas.removeEventListener(e,t)}setZoom(e){var t,r;((t=this._controls)==null?void 0:t.orbitControls)instanceof S8&&((r=this._controls)==null||r.orbitControls.zoomOut(e))}get eventManager(){return this._eventManager}get controls(){return this._controls}setSize(e,t){this._viewportWidth=e,this._viewportHeight=t,this._viewportMode=2,this._resize()}setBackgroundColor(e){var a;let{r:t,g:r,b:i,a:n}={r:0,g:0,b:0,a:1},s=new nn(t,r,i,n);try{s.setStyle(e)}catch{console.error("This is not a valid css color",e)}(a=this._scene)==null||a.activePage.setBackgroundColor(s),this._requestRenderAutoMode()}dispose(){var e,t,r,i,n,s,a;this.disposed=!0,(e=this._eventManager)==null||e.deactivate(),(t=this._scene)==null||t.dispose(),(r=this._sharedAssetsManager)==null||r.dispose(),this._proxyObjectCache.forEach(o=>{_P.unsubscribe(o)}),(i=this._renderer)==null||i.setAnimationLoop(null),(n=this._renderer)==null||n.dispose(),this._renderer=void 0,(s=this._sharedAssetsManager)==null||s.dispose(),this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=void 0),this._resizeObserverTimeout!==void 0&&clearTimeout(this._resizeObserverTimeout),this.canvas.style.width="",this.canvas.style.height="",this.canvas.removeAttribute("width"),this.canvas.removeAttribute("height"),this._frameView&&(this._frameView=void 0),(a=this._controls)==null||a.deactivate(),vae(this.canvas)}get isStopped(){return this._isPaused}stop(){var e,t,r;this._isPaused||((e=this._renderer)==null||e.setAnimationLoop(null),this._isPaused=!0,(t=this._eventManager)==null||t.pause(),(r=this._controls)!=null&&r.orbitControls&&(this._controls.orbitControls.enabled=!1))}play(){var e,t,r;!this._isPaused||(this._isPaused=!1,(e=this._eventManager)==null||e.resume(),(t=this._controls)!=null&&t.orbitControls&&(this._controls.orbitControls.enabled=!0),(r=this._renderer)==null||r.setAnimationLoop(this.render))}setGlobalEvents(e){var t;(t=this._eventManager)==null||t.updateUseWindowEvents(e)}get data(){return this._data}_createProxyObject(e){var n;if(e==null)return;if(this._proxyObjectCache.has(e.uuid))return this._proxyObjectCache.get(e.uuid);let t;e.traverseAncestors(s=>{s instanceof yl&&(t=s.name)});let r={name:e.name,uuid:e.uuid,visible:e.visible,intensity:e.intensity,position:e.position,rotation:e.rotation,scale:e.scale,type:e.data.type,page:t,parentUuid:e.parent instanceof yl||e instanceof NA||(n=e.parent)==null?void 0:n.uuid,emitEvent(s){e.dispatchEvent({type:"userEvent",eventName:s})},emitEventReverse(s){e.dispatchEvent({type:"userEvent",eventName:s,reverse:!0})}},i=_P(r,(s,a)=>{var o;typeof e[s]!="object"&&((o=Object.getOwnPropertyDescriptor(e,s))!=null&&o.writable)&&(e[s]=a),this._requestRenderAutoMode(),e.updateMatrix()});return this._proxyObjectCache.set(e.uuid,i),i}},av=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},X_={},sve={get exports(){return X_},set exports(e){X_=e}},yp={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $5;function ave(){if($5)return yp;$5=1;var e=Yn,t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,n=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function a(o,l,c){var u,h={},d=null,p=null;c!==void 0&&(d=""+c),l.key!==void 0&&(d=""+l.key),l.ref!==void 0&&(p=l.ref);for(u in l)i.call(l,u)&&!s.hasOwnProperty(u)&&(h[u]=l[u]);if(o&&o.defaultProps)for(u in l=o.defaultProps,l)h[u]===void 0&&(h[u]=l[u]);return{$$typeof:t,type:o,key:d,ref:p,props:h,_owner:n.current}}return yp.Fragment=r,yp.jsx=a,yp.jsxs=a,yp}(function(e){e.exports=ave()})(sve);const Y_=X_.jsx;var ove="Expected a function",J5=0/0,lve="[object Symbol]",cve=/^\s+|\s+$/g,hve=/^[-+]0x[0-9a-f]+$/i,uve=/^0b[01]+$/i,dve=/^0o[0-7]+$/i,pve=parseInt,fve=typeof av=="object"&&av&&av.Object===Object&&av,mve=typeof self=="object"&&self&&self.Object===Object&&self,gve=fve||mve||Function("return this")(),vve=Object.prototype,yve=vve.toString,xve=Math.max,wve=Math.min,Yw=function(){return gve.Date.now()};function bve(e,t,r){var i,n,s,a,o,l,c=0,u=!1,h=!1,d=!0;if(typeof e!="function")throw new TypeError(ove);t=eL(t)||0,Q_(r)&&(u=!!r.leading,h="maxWait"in r,s=h?xve(eL(r.maxWait)||0,t):s,d="trailing"in r?!!r.trailing:d);function p(_){var A=i,S=n;return i=n=void 0,c=_,a=e.apply(S,A),a}function f(_){return c=_,o=setTimeout(v,t),u?p(_):a}function m(_){var A=_-l,S=_-c,C=t-A;return h?wve(C,s-S):C}function g(_){var A=_-l,S=_-c;return l===void 0||A>=t||A<0||h&&S>=s}function v(){var _=Yw();if(g(_))return y(_);o=setTimeout(v,m(_))}function y(_){return o=void 0,d&&i?p(_):(i=n=void 0,a)}function x(){o!==void 0&&clearTimeout(o),c=0,i=l=n=o=void 0}function w(){return o===void 0?a:y(Yw())}function b(){var _=Yw(),A=g(_);if(i=arguments,n=this,l=_,A){if(o===void 0)return f(l);if(h)return o=setTimeout(v,t),p(l)}return o===void 0&&(o=setTimeout(v,t)),a}return b.cancel=x,b.flush=w,b}function Q_(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function _ve(e){return!!e&&typeof e=="object"}function Sve(e){return typeof e=="symbol"||_ve(e)&&yve.call(e)==lve}function eL(e){if(typeof e=="number")return e;if(Sve(e))return J5;if(Q_(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Q_(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(cve,"");var r=uve.test(e);return r||dve.test(e)?pve(e.slice(2),r?2:8):hve.test(e)?J5:+e}var Ave=bve;function Cve(e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}const Mve=[],Eve={width:"100%",height:"100%"},Tve=ne.forwardRef(function({className:e,children:t,debounceTime:r=300,ignoreDimensions:i=Mve,parentSizeStyles:n,enableDebounceLeadingCall:s=!0,resizeObserverPolyfill:a,...o},l){const c=ne.useRef(null),u=ne.useRef(0),[h,d]=ne.useState({width:0,height:0,top:0,left:0}),p=ne.useMemo(()=>{const f=Array.isArray(i)?i:[i];return Ave(m=>{d(g=>Object.keys(g).filter(v=>g[v]!==m[v]).every(v=>f.includes(v))?g:m)},r,{leading:s})},[r,s,i]);return ne.useEffect(()=>{const f=a||window.ResizeObserver,m=new f(g=>{g.forEach(v=>{const{left:y,top:x,width:w,height:b}=(v==null?void 0:v.contentRect)??{};u.current=window.requestAnimationFrame(()=>{p({width:w,height:b,top:x,left:y})})})});return c.current&&m.observe(c.current),()=>{window.cancelAnimationFrame(u.current),m.disconnect(),p.cancel()}},[p,a]),Y_("div",{style:{...Eve,...n},ref:Cve([l,c]),className:e,...o,children:t({...h,ref:c.current,resize:p})})});ne.forwardRef(({scene:e,style:t,onMouseDown:r,onMouseUp:i,onMouseHover:n,onKeyDown:s,onKeyUp:a,onStart:o,onLookAt:l,onFollow:c,onWheel:u,onLoad:h,renderOnDemand:d=!0,...p},f)=>{const m=ne.useRef(null),[g,v]=ne.useState(!0);return ne.useEffect(()=>{v(!0);let y;const x=[{name:"mouseDown",cb:r},{name:"mouseUp",cb:i},{name:"mouseHover",cb:n},{name:"keyDown",cb:s},{name:"keyUp",cb:a},{name:"start",cb:o},{name:"lookAt",cb:l},{name:"follow",cb:c},{name:"scroll",cb:u}];if(m.current){y=new nve(m.current,{renderOnDemand:d});async function w(){await y.load(e);for(let b of x)b.cb&&y.addEventListener(b.name,b.cb);v(!1),h==null||h(y)}w()}return()=>{for(let w of x)w.cb&&y.removeEventListener(w.name,w.cb);y.dispose()}},[e]),Y_(Tve,{ref:f,parentSizeStyles:t,debounceTime:50,...p,children:()=>Y_("canvas",{ref:m,style:{display:g?"none":"block"}})})});const tL=({...e})=>{const{className:t}=e,r=ne.useRef(null),[i,n]=ne.useState(!0),{scrollYProgress:s}=JO({target:r,offset:["center end","end center"]});return BH(s,"change",a=>{a<1?n(!1):n(!0)}),L.jsx(L.Fragment,{children:L.jsx(Hn.div,{ref:r,className:`absolute min-h-[10px] aspect-square rounded-full z-20 transition-all ${t} ${i?"opacity-100 scale-100 ":"opacity-0 scale-0"}`})})},Pve=()=>{const e=ne.useRef(null);ne.useRef(null),ne.useRef(null),ne.useRef(null);const{scrollYProgress:t}=JO({target:e,offset:["start center","end center"]});return L.jsx("div",{className:"relative min-w-[10%] items-center justify-center",children:L.jsxs("div",{className:"absolute top-0 left-[50%] h-full mt-4",children:[L.jsx(Hn.div,{style:{scaleY:t,transformOrigin:"top"},ref:e,className:"h-full min-w-[3px] max-w-[3px] bg-primary-300 rounded-lg"}),L.jsxs("div",{className:"absolute top-0 left-0 min-w-[3px] max-w-[3px] h-full rounded-lg flex items-center justify-center",children:[L.jsx(tL,{className:"top-0 bg-primary-300"}),L.jsx(tL,{className:"top-[14.8rem] tablet:top-[10rem] laptop:top-[13.5rem] desktop:top-[10.5rem] hd:top-[14rem] bg-primary-300"}),L.jsx("div",{className:"absolute bg-primary-300 min-h-[.2rem] min-w-[1rem] bottom-0"})]})]})})},Qw=({children:e,...t})=>{const{imageUrl:r,title:i,titleSpan:n,spanColor:s,description:a,linkTitle:o,linkTo:l}=t;return L.jsx(L.Fragment,{children:L.jsxs("div",{className:"relative flex flex-col justify-center h-full",children:[r&&L.jsx(Hn.img,{initial:{opacity:0,x:105},whileInView:{opacity:1,x:0},transition:{duration:1},viewport:{once:!0,margin:"-240px"},src:r,alt:"",className:"absolute top-[-25%] right-[-25%] h-full brightness-90 tablet:right-0 tablet:h-[15rem] laptop:top-[0%] laptop:right-[100%] laptop:h-3/4"}),L.jsx(Hn.div,{initial:{opacity:0,x:-75},whileInView:{opacity:1,x:0},transition:{duration:.5},viewport:{once:!0,margin:"-240px"},className:"z-10 flex flex-col justify-center h-full gap-5",children:e})]})})},ov={initial:{opacity:0,x:-80},animate:e=>({opacity:1,x:0,transition:{delay:e*.1,duration:.5}})},Dve=()=>L.jsxs("div",{className:"flex flex-col w-full bg-white overflow-clip",children:[L.jsx(QS,{children:L.jsx("div",{className:"absolute top-0 left-0 w-full h-full",children:L.jsxs("div",{className:"relative z-10 flex flex-col items-center justify-center w-full h-full",children:[L.jsx(cG,{}),L.jsxs("div",{className:"z-10 flex flex-col items-center justify-center w-full gap-10 px-10 text-white",children:[L.jsx("div",{className:"flex flex-col items-center justify-center",children:L.jsx(Hn.h1,{initial:{y:-25,opacity:0},animate:{y:0,opacity:1},transition:{duration:1},className:"z-10 text-center text-md tablet:text-lg laptop:text-xl hd:text-3xl",children:"Dan Murdoch Risk Services"})}),L.jsxs("div",{className:"flex flex-col items-center gap-3",children:[L.jsxs("div",{className:"flex flex-col items-center justify-center gap-1",children:[L.jsx("p",{className:"z-10 text-xs laptop:text-sm hd:text-lg",children:"Providing Global Corporations with"}),L.jsx(EF,{})]}),L.jsxs("div",{className:"flex gap-3",children:[L.jsx(Sp,{to:"contact",children:L.jsx(xs,{variant:"default",size:"xs",className:"w-fit",children:"Get Started"})}),L.jsx(xs,{variant:"outline",size:"xs",className:"w-fit",children:"Our Services"})]})]})]})]})})}),L.jsxs("section",{className:"flex flex-col gap-16 p-10 pt-10 overflow-hidden laptop:overflow-visible laptop:flex-row navTrigger",children:[L.jsxs("div",{className:"flex flex-col items-center justify-center gap-1 laptop:sticky laptop:flex-1 laptop:top-16 laptop:max-h-[calc(100vh-4rem)] z-10",children:[L.jsx("h2",{className:"text-lg font-bold text-center desktop:text-xl hd:text-3xl",children:"WHO ARE WE?"}),L.jsxs("p",{className:"text-sm text-center desktop:text-base hd:text-md",children:["Discover who we are and be part of our ",L.jsx("span",{className:"font-bold text-accent-500",children:"JOURNEY"})]})]}),L.jsxs("div",{className:"flex flex-col flex-1 gap-16",children:[L.jsx(V1,{children:L.jsxs(Qw,{imageUrl:"./images/australia-map.png",children:[L.jsxs("h2",{className:"text-xl font-bold desktop:text-2xl hd:text-3xl",children:["DMRS ",L.jsx("span",{className:"text-primary-300",children:"Australia"})]}),L.jsx("p",{className:"text-xs text-justify desktop:text-sm hd:text-md",children:"Dan Murdoch Risk Services (Australia) Pty Ltd is the parent company of our operational division Dan Murdoch Risk Services (Thailand) Limited."}),L.jsx(xs,{size:"xs",variant:"default",className:" w-fit !bg-accent-400 !ring-accent-400 text-white",children:L.jsx(Sp,{to:"/dmrs-fe/dmrs/australia",children:"Go to DMRS Australia"})})]})}),L.jsx(V1,{children:L.jsxs(Qw,{imageUrl:"./images/thailand-map.png",children:[L.jsxs("h2",{className:"text-xl font-bold desktop:text-2xl hd:text-3xl",children:["DMRS ",L.jsx("span",{className:"text-primary-300",children:"Thailand"})]}),L.jsx("p",{className:"text-xs text-justify desktop:text-sm hd:text-md",children:"Dan Murdoch Risk Services (Thailand) Co. Ltd. staff are trained detectives and intelligence analysts who use both objective and subjective thinking to gather manual online data leading to intelligence for many Fortune 500 companies worldwide."}),L.jsx(xs,{size:"xs",variant:"default",className:" w-fit !bg-accent-400 !ring-accent-400 text-white",children:L.jsx(Sp,{to:"/dmrs-fe/dmrs/thailand",children:"Go to DMRS Thailand"})})]})}),L.jsx(V1,{children:L.jsxs(Qw,{children:[L.jsx("h2",{className:"text-xl font-bold desktop:text-2xl hd:text-3xl",children:"Specialization"}),L.jsx("p",{className:"text-xs text-justify desktop:text-sm hd:text-md",children:"We specialize in pharmaceuticals and the protection of and identifying risks associated with medicines worldwide."}),L.jsx(xs,{size:"xs",variant:"default",className:"w-fit",children:L.jsx(Sp,{to:"/dmrs-fe/contact",children:"Get Started"})})]})})]})]}),L.jsxs("section",{className:"relative flex p-10 pb-10 z-[1] gap-5",children:[L.jsx("div",{className:"absolute top-[-170%] right-[-40%] scale-50 hidden laptop:flex"}),L.jsx(Pve,{}),L.jsxs("div",{className:"flex flex-col laptop:max-w-[55%] gap-10",children:[L.jsxs("div",{className:"flex flex-col gap-3",children:[L.jsxs(Hn.div,{variants:ov,initial:"initial",whileInView:"animate",viewport:{once:!0},custom:1,className:"flex items-center gap-3",children:[L.jsx("div",{className:"flex items-center justify-center p-2 rounded-md bg-black/5 aspect-square",children:L.jsx(hG,{className:"text-sm laptop:text-md hd:text-lg"})}),L.jsxs("h2",{className:"text-lg font-bold laptop:text-xl hd:text-2xl",children:["Our ",L.jsx("span",{className:"text-primary-300",children:"Vision"})]})]}),L.jsx(Hn.p,{variants:ov,initial:"initial",whileInView:"animate",viewport:{once:!0},custom:2,className:"text-xs text-justify laptop:text-sm hd:text-base",children:"Dan Murdoch Risk Services will be the preferred company of choice for online intelligence, investigative consultancy, brand protection and business intelligence advice worldwide offering beneficial solutions for all corporate and personal problems."})]}),L.jsxs("div",{className:"flex flex-col gap-3",children:[L.jsxs(Hn.div,{variants:ov,initial:"initial",whileInView:"animate",viewport:{once:!0},custom:1,className:"flex items-center gap-3",children:[L.jsx("div",{className:"flex items-center justify-center p-2 rounded-md bg-black/5 aspect-square",children:L.jsx(uG,{className:"text-sm laptop:text-md hd:text-lg"})}),L.jsxs("h2",{className:"text-lg font-bold laptop:text-xl hd:text-2xl",children:["Our ",L.jsx("span",{className:"text-primary-300",children:"Mission Statement"})]})]}),L.jsx(Hn.p,{variants:ov,initial:"initial",whileInView:"animate",viewport:{once:!0},custom:2,className:"text-xs text-justify laptop:text-sm hd:text-base",children:"Dan Murdoch Risk Services will offer and deliver to the corporate world and the general public a complete range of business services from intelligence strategies and a true investigative consultancy to proactive solutions and risk management strategies for internal and external problems facing companies and individuals worldwide."})]})]})]}),L.jsxs("section",{className:"relative flex flex-col gap-10 p-10 py-10 mt-16 laptop:flex-row",children:[L.jsx("div",{className:"absolute top-0 left-0 flex w-full h-full",children:L.jsxs("div",{className:"relative w-full h-full",children:[L.jsx("div",{className:"absolute right-0 grid w-3/4 h-full grid-cols-7",children:L.jsx(eR,{cellCount:35,cellClass:"border border-background-dark/5"})}),L.jsx("div",{className:"absolute right-0 w-3/4 h-full bg-gradient-radial from-transparent to-white"})]})}),L.jsxs("div",{className:"z-10 flex flex-col items-center gap-8 laptop:w-[45%]",children:[L.jsxs(Hn.div,{initial:{opacity:0,x:-75},whileInView:{opacity:1,x:0},transition:{duration:.5},viewport:{once:!0,margin:"-50px"},className:"flex items-center hd:flex-row hd:gap-5",children:[L.jsx("img",{src:"./images/sheild-dynamic-color.png",className:"w-1/4",alt:""}),L.jsxs("h2",{className:"text-lg font-bold text-center hd:text-2xl hd:text-left",children:[" What are ",L.jsx("span",{className:"text-primary-300",children:"we"})," offering?"]})]}),L.jsxs("div",{className:"flex flex-col gap-3 text-xs tablet:text-sm tablet:w-3/4 laptop:w-full laptop:px-5 laptop:gap-5 hd:text-base hd:gap-10",children:[L.jsxs("p",{className:"text-justify",children:["The services DMRS offers fall into three broad areas, labeled as ",L.jsx("strong",{children:"Intelligence"}),", ",L.jsx("strong",{children:"Investigations"}),", and ",L.jsx("strong",{children:"Research"}),"."]}),L.jsx("p",{className:"text-justify",children:"While our geographical areas of operation are Asia-wide and Australia we conduct intelligence monitoring and investigations worldwide using our own staff and trusted associates."})]})]}),L.jsx(lG,{})]})]}),Lve="/dmrs-fe/assets/Australia-dots-48b458e2.png",Ive="/dmrs-fe/assets/intelligence-investigations-3ba127d3.png",Ove="/dmrs-fe/assets/dmrs-australia-1-456e3b8f.jpg",Rve="/dmrs-fe/assets/intelligent-intelligence-icon-3053ae2c.png",Bve="/dmrs-fe/assets/intelligent-investigations-mb-987b61d2.png";function lv({animationClass:e,children:t,animationDelay:r}){const i=ne.useRef(null);return ne.useEffect(()=>{const n=()=>{const s=i.current;if(s){const a=s.getBoundingClientRect(),o=window.innerHeight||document.documentElement.clientHeight;a.top<=o&&a.bottom>=0?s.classList.add("animate__animated",e,r):s.classList.remove("animate__animated",e,r)}};return window.addEventListener("scroll",n),()=>{window.removeEventListener("scroll",n)}},[e]),L.jsx("div",{ref:i,children:t})}const zve=()=>{const e=new Array(28),t=ne.useRef([]);function r(i){i.classList.contains("active")||!i||(i.classList.add("fill"),setTimeout(()=>{i.classList.remove("fill")},Math.random()*2*5e3))}return ne.useEffect(()=>{const i=setInterval(()=>{const n=t.current[Math.floor(Math.random()*25)];r(n)},5e3);return()=>clearInterval(i)},[]),ne.useState(0),L.jsxs("div",{className:"flex flex-col w-full bg-white",children:[L.jsx("div",{className:"tablet:z-10",children:L.jsx(QS,{children:L.jsxs("div",{className:"relative flex flex-col items-center justify-center w-full gap-3 text-white",children:[L.jsx("div",{className:"absolute -top-20 w-full h-screen bg-gradient-radial from-background-dark/20 to-background-dark z-[2]"}),L.jsx("div",{className:"absolute -top-20 left-0 grid w-full h-screen grid-cols-7 z-[1] ",children:e.fill(null).map((i,n)=>L.jsx("div",{ref:s=>t.current[n]=s,className:"block border border-background-light/5"},n))}),L.jsxs("div",{className:"flex flex-col items-center justify-center gap-4",children:[L.jsx("h1",{className:"z-10 text-3xl font-bold text-center",children:"DMRS Australia"}),L.jsx(xs,{variant:"outline",size:"sm",className:"z-10",children:"Services"})]})]})})}),L.jsxs("section",{className:"relative navTrigger tablet:z-12",children:[L.jsxs("div",{className:"flex flex-col h-full w-full items-center p-10 gap-12 tablet:p-16 tablet:flex-row laptop:min-h-[768px] laptop:h-full laptop:gap-24 laptop:p-20 ",children:[L.jsx("div",{className:"max-h-[350px] flex w-full tablet:z-10 tablet:w-full tablet:max-h-[500px] z-10  justify-center gap-5",children:L.jsx(lv,{animationClass:"animate__fadeInLeftBig",children:L.jsx("img",{src:Ove,alt:"",className:"object-cover cover rounded-tl-[3.12rem] rounded-br-[3.12rem] h-full w-full"})})}),L.jsxs("div",{className:"flex flex-col w-full gap-10 tablet:z-10 tablet:w-full",children:[L.jsxs("div",{children:[L.jsx(lv,{animationClass:"animate__fadeInTopRight",children:L.jsx("p",{className:"font-bold text-md text-bg-dark laptop:text-xl",children:"Dan Murdoch Risk Services"})}),L.jsx(lv,{animationClass:"animate__fadeInRightBig",children:L.jsx("p",{className:"text-lg font-bold text-primary-300 laptop:text-2xl",children:"Australia"})})]}),L.jsx(lv,{animationClass:"animate__fadeInBottomRight",children:L.jsxs("p",{className:"max-w-lg text-xs text-bg-dark tablet:z-10 tablet:text-sm",children:[L.jsx("strong",{className:"text-accent-800",children:"DMRS "}),L.jsx("strong",{className:"text-primary-400",children:"Australia "}),"Pty Ltd is the parent company for the operational division Dan Murdoch Risk Services (Thailand) Co. Limited."]})})]})]}),L.jsx("img",{src:Lve,alt:"",className:"hidden tablet:absolute tablet:top-0 tablet:bottom-0 tablet:right-0 tablet:w-auto tablet:m-auto tablet:min-h-[600px] tablet:max-h-[850px] tablet:z-0 tablet:block animate__animated animate__pulse"})]}),L.jsx("section",{className:"relative tablet:z-10",children:L.jsx("div",{className:"flex h-full w-full items-center gap-[6rem] p-7 tablet:p-20",children:L.jsxs("div",{className:"flex flex-col tablet:flex-row tablet:p-10 laptop:p-20 justify-center items-center w-full max-h-[450px] p-10 gap-2 mobile:gap-5 rounded-[3.12rem] bg-black",children:[L.jsx("img",{src:Rve,alt:"",className:"object-contain w-1/4"}),L.jsxs("div",{className:"flex flex-col justify-center text-center tablet:text-left",children:[L.jsx("p",{className:"text-sm tablet:text-md laptop:text-lg ",children:L.jsx("strong",{className:"text-primary-300",children:"Intelligent Intelligence"})}),L.jsx("p",{className:"text-sm tablet:text-md laptop:text-lg text-accent-50 ",children:L.jsx("strong",{children:"leads to thoughtful investigations and evidence-filled undercover operations resulting in a safer pharmaceutical environment globally."})})]})]})})}),L.jsx("section",{className:"",children:L.jsxs("div",{className:"flex flex-col h-full laptop:h-[95vh] laptop:min-h-[740px] laptop:min-w-[450px]",children:[L.jsxs("div",{className:"flex flex-col justify-center w-full gap-5 px-10 pt-10 pb-5 laptop:px-20 laptop:pt-20 laptop:pb-10",children:[L.jsx("p",{className:"text-lg font-bold text-center uppercase laptop:text-xl text-bg-dark ",children:"Who are Dan Murdoch Risk Services?"}),L.jsxs("p",{className:"self-center max-w-5xl tablet:min-w-[565px] text-center text-xs text-bg-dark tablet:text-sm",children:[L.jsx("strong",{className:"text-accent-800",children:"DMRS "}),L.jsx("strong",{className:"text-primary-400",children:"Australia "}),"Pty Ltd Pty Ltd operates all services offered under the banners of DMRS, Dan Murdoch Risk Services, Your Intelligence Program, and DMRS VPN."]})]}),L.jsx("div",{className:"flex w-full min-h-[450px] tablet:h-full",children:L.jsx("div",{className:"flex flex-col items-center justify-center w-full bg-no-repeat bg-bottom bg-cover bg-[url('assets/IntelligentIntelligence.png')]"})})]})}),L.jsx("section",{children:L.jsxs("div",{className:"flex flex-col-reverse items-center w-full tablet:min-h-[200px] h-full tablet:flex-row",children:[L.jsxs("div",{className:"flex flex-col items-center w-auto h-full gap-5 p-10 mr-5 tablet:mr-0 laptop:p-20 laptop:pr-5 tablet:items-start",children:[L.jsx("p",{className:"font-bold text-center uppercase laptop:text-2xl text-md tablet:text-lg tablet:text-left text-bg-dark ",children:"Intelligence Investigations"}),L.jsx(xs,{variant:"default",size:"sm",children:"See Brochure"})]}),L.jsxs("div",{className:"flex flex-col w-auto h-full laptop:h-full",children:[L.jsx("img",{src:Ive,alt:"",className:"hidden w-full h-full tablet:block"}),L.jsx("img",{src:Bve,alt:"",className:"w-full tablet:hidden"})]})]})})]})},kve=({width:e,height:t})=>L.jsxs("svg",{width:e,height:t,viewBox:"0 0 107 107",fill:"none",className:"fill-inherit",xmlns:"http://www.w3.org/2000/svg",children:[L.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M68.4315 90.5H82.5V98.3368C81.3175 98.8985 80.5 100.104 80.5 101.5C80.5 103.433 82.067 105 84 105C85.933 105 87.5 103.433 87.5 101.5C87.5 100.104 86.6825 98.8985 85.5 98.3368V90.5H91H92.5V89V83H100.337C100.899 84.1825 102.104 85 103.5 85C105.433 85 107 83.433 107 81.5C107 79.567 105.433 78 103.5 78C102.104 78 100.899 78.8175 100.337 80H91H89.5V81.5V87.5H85.5H84H83H66.875C67.5387 88.4047 68.0674 89.4146 68.4315 90.5ZM61.5179 81H85.5H86.3125L86.7564 80.3194L93.8125 69.5H97.5H98.6273C99.2598 70.4067 100.311 71 101.5 71C103.433 71 105 69.433 105 67.5C105 65.567 103.433 64 101.5 64C99.9145 64 98.5752 65.0543 98.1449 66.5H97.5H93H92.1875L91.7436 67.1806L90.2309 69.5H85.5V65.8551C86.9457 65.4248 88 64.0855 88 62.5C88 60.567 86.433 59 84.5 59C82.567 59 81 60.567 81 62.5C81 63.6894 81.5933 64.7402 82.5 65.3727V71V72.5H84H88.2744L84.6875 78H62.5894C62.3382 79.0498 61.9765 80.0545 61.5179 81ZM59.7147 55.5H72V63V64.3368C70.8175 64.8985 70 66.1038 70 67.5C70 69.433 71.567 71 73.5 71C75.433 71 77 69.433 77 67.5C77 66.1038 76.1825 64.8985 75 64.3368V63V54V52.5H73.5H64.1218C62.8144 53.6641 61.2971 54.5825 59.6367 55.1859C59.6642 55.29 59.6902 55.3947 59.7147 55.5ZM67.2635 48.5H84V52.5V54H85.5H99.3368C99.8985 55.1825 101.104 56 102.5 56C104.433 56 106 54.433 106 52.5C106 50.567 104.433 49 102.5 49C101.104 49 99.8985 49.8175 99.3368 51H87V47V45.5H85.5H68.4605C68.1691 46.5541 67.7653 47.559 67.2635 48.5ZM68.9672 42.5H75.5C75.5417 42.5 75.583 42.4983 75.6238 42.495C76.2559 43.4045 77.3084 44 78.5 44C80.433 44 82 42.433 82 40.5C82 38.567 80.433 37 78.5 37C76.9145 37 75.5752 38.0543 75.1449 39.5H68.8679C68.955 40.1538 69 40.8214 69 41.5C69 41.8361 68.989 42.1696 68.9672 42.5ZM68.3997 33.5H82.9898L89.0854 38.1889L89.4898 38.5H90H97.6273C98.2598 39.4067 99.3106 40 100.5 40C102.433 40 104 38.433 104 36.5C104 34.567 102.433 33 100.5 33C98.9145 33 97.5752 34.0543 97.1449 35.5H90.5102L84.4146 30.8111L84.0102 30.5H83.5H69.7738C69.3953 31.542 68.9346 32.5446 68.3997 33.5ZM70.5045 28H89.5H91V26.5V15.6632C92.1825 15.1015 93 13.8962 93 12.5C93 10.567 91.433 9 89.5 9C87.567 9 86 10.567 86 12.5C86 13.8962 86.8175 15.1015 88 15.6632V25H70.946C70.872 26.0226 70.723 27.0244 70.5045 28ZM69.9481 17H75.3368C75.8985 18.1825 77.1038 19 78.5 19C80.433 19 82 17.433 82 15.5C82 13.567 80.433 12 78.5 12C77.1038 12 75.8985 12.8175 75.3368 14H68.6706C69.1725 14.9579 69.6008 15.9604 69.9481 17Z",fill:"black",className:"fill-inherit"}),L.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M22.0469 85.76L25.5587 83.6608C26.9621 82.1881 29.2128 81.0148 32.2466 81.5204C34.19 81.8443 35.4337 82.8584 36.1525 84.0264C36.8344 85.1344 37 86.3012 37 87C37 87.8284 36.3284 88.5 35.5 88.5C34.6716 88.5 34 87.8284 34 87C34 86.6988 33.9156 86.1156 33.5975 85.5986C33.3163 85.1416 32.81 84.6557 31.7534 84.4796C29.5273 84.1086 28.0841 85.1449 27.3169 86.2317L26.4682 89.1681C26.1645 90.2186 26 91.3363 26 92.5C26 98.9514 31.0232 104 37 104C40.8875 104 44.3475 101.887 46.3174 98.6154L47.5678 96.5391C47.8981 95.0705 47.4152 93.5365 46.5018 92.6231C46.0494 92.1707 45.5116 91.8882 44.9241 91.8057C44.3425 91.724 43.6064 91.8234 42.7285 92.3112C42.0043 92.7135 41.0911 92.4526 40.6888 91.7284C40.2864 91.0042 40.5474 90.091 41.2715 89.6887C42.6436 88.9265 44.0325 88.651 45.3415 88.8349C46.6447 89.018 47.7631 89.6417 48.6232 90.5018C50.2755 92.1542 51.0448 94.7385 50.4964 97.1898L51.3708 98.4802C52.8144 100.61 55.2454 102 58 102C62.4183 102 66 98.4183 66 94C66 90.1301 63.2492 86.896 59.5946 86.1583L57.2659 85.6883C53.5461 87.8054 48.892 88.0764 45.205 85.772C43.0502 84.4253 41.7266 83.003 40.9511 81.6126C40.1708 80.2135 40 78.9439 40 78C40 77.1716 40.6716 76.5 41.5 76.5C42.3284 76.5 43 77.1716 43 78C43 78.5561 43.0941 79.2958 43.5712 80.1514C44.0532 81.0156 44.9795 82.0933 46.795 83.228C49.9228 85.1829 54.3323 84.6082 57.4191 81.9245L57.7623 81.4527C59.1623 79.5285 60 77.1249 60 74.5C60 71.0779 58.5752 68.028 56.3348 65.9304L54.7452 64.4421C53.4708 63.4344 51.6399 62.6381 49.2121 62.9849C47.8021 63.1863 46.4207 63.9093 45.312 64.7963C44.7646 65.2342 44.3108 65.6909 43.9767 66.1021C43.6261 66.5336 43.4675 66.8408 43.423 66.9743C43.1611 67.7602 42.3116 68.185 41.5257 67.923C40.7398 67.6611 40.315 66.8116 40.577 66.0257C40.7824 65.4091 41.1864 64.7789 41.6483 64.2104C42.1266 63.6216 42.7354 63.0157 43.4379 62.4537C44.8292 61.3406 46.6979 60.3136 48.7879 60.015C51.8893 59.572 54.3339 60.4845 56.0912 61.7083C56.6714 60.602 57 59.3429 57 58C57 57.3374 56.9201 56.6975 56.7707 56.0876C55.6445 56.1572 54.2152 56.0729 52.7529 55.6715C50.806 55.137 48.7039 54.01 47.2519 51.8321C46.7924 51.1428 46.9787 50.2115 47.6679 49.7519C48.3572 49.2924 49.2885 49.4787 49.7481 50.1679C50.6961 51.59 52.094 52.3796 53.5471 52.7785C54.6852 53.0909 55.7979 53.1451 56.6164 53.0915L58.612 52.3663C62.866 50.8203 66 46.5776 66 41.5C66 40.0606 65.7482 38.6892 65.2909 37.4273L65.2463 37.4557C64.3197 38.0409 63.19 38.4597 62.0045 38.6127C59.5967 38.9234 56.7998 38.1283 55.1888 35.2285C54.7864 34.5043 55.0474 33.5911 55.7715 33.1888C56.4957 32.7864 57.4089 33.0474 57.8112 33.7715C58.7002 35.3717 60.1533 35.8266 61.6205 35.6373C62.3725 35.5403 63.0865 35.2716 63.6443 34.9193C63.8671 34.7786 64.047 34.6364 64.1895 34.5014L64.7302 33.7009C64.7481 33.6725 64.7668 33.6448 64.7863 33.6179L65.0132 33.282C66.899 30.4906 68 27.1284 68 23.5C68 13.835 60.165 6 50.5 6C49.3664 6 48.2607 6.10739 47.1917 6.31171L46.3757 6.46768C44.4282 7.29859 43.3936 8.60994 42.9552 10.3638C42.7032 11.3715 42.6041 12.4365 42.713 13.3719C42.8227 14.3146 43.1265 15.0051 43.5607 15.4393C44.1464 16.0251 44.1464 16.9749 43.5607 17.5607C42.9749 18.1464 42.0251 18.1464 41.4393 17.5607C40.3735 16.4949 39.8914 15.0791 39.7331 13.7186C39.5739 12.3509 39.7248 10.9159 40.0447 9.63621C40.5678 7.54398 41.7079 5.84024 43.5016 4.62614C42.0973 3.60185 40.3708 3 38.5 3C33.8056 3 30 6.80557 30 11.5C30 11.876 30.0242 12.2448 30.0709 12.6054L30.7301 17.6986L25.9697 15.7711C24.7407 15.2735 23.4038 15 22 15C16.0232 15 11 20.0486 11 26.5C11 29.7097 12.2532 32.5914 14.2573 34.6678L15.1975 35.6419C17.7198 38.0878 20.7161 38.8998 24.1363 38.0447C25.9685 37.5867 27.2303 36.9446 28.1918 36.0911C29.1579 35.2336 29.9213 34.0739 30.6172 32.4186C30.9383 31.655 31.8176 31.2961 32.5813 31.6172C33.345 31.9382 33.7038 32.8176 33.3828 33.5813C32.5787 35.494 31.5921 37.0843 30.1833 38.3348C28.7698 39.5893 27.0316 40.4132 24.8639 40.9551C21.0315 41.9132 17.4849 41.2166 14.4912 38.9775L13.3044 39.4983C7.1919 42.1809 3 48.1404 3 55C3 60.825 6.01713 65.9924 10.6724 69.0683L11.0011 69.2855C12.2937 68.26 14.0068 67.5 16 67.5C19.0382 67.5 20.8972 68.7759 22.5607 70.4393C23.1465 71.0251 23.1464 71.9749 22.5607 72.5607C21.9749 73.1464 21.0251 73.1464 20.4393 72.5607C19.1029 71.2242 17.9619 70.5 16 70.5C15.0988 70.5 14.27 70.7614 13.5641 71.1626L11.1851 73.6464C9.81146 75.0805 9 76.9574 9 79C9 83.294 12.6785 87 17.5 87C19.1842 87 20.7395 86.5415 22.0469 85.76ZM63.1137 84.2584C62.24 83.7988 61.2969 83.4533 60.3042 83.2417C60.3793 83.1097 60.4329 82.9688 60.4647 82.824C60.9571 82.0979 61.3868 81.3229 61.7457 80.5075C62.5512 78.6771 63 76.6428 63 74.5C63 70.2316 61.2192 66.3939 58.3852 63.7404C59.4095 62.0694 60 60.1036 60 58C60 57.0273 59.8737 56.0841 59.6367 55.1859C65.0899 53.2041 69 47.825 69 41.5C69 39.1476 68.4591 36.926 67.4991 34.9614C69.7094 31.6896 71 27.7455 71 23.5C71 12.1782 61.8218 3 50.5 3C49.1765 3 47.8822 3.12543 46.6285 3.36505C44.5477 1.28586 41.674 0 38.5 0C32.723 0 27.941 4.25966 27.1234 9.80945C27.0421 10.3612 27 10.9257 27 11.5C27 12.0051 27.0326 12.5025 27.0957 12.9904C26.1173 12.5943 25.0854 12.3088 24.0143 12.149C23.3566 12.0508 22.684 12 22 12C14.268 12 8 18.4919 8 26.5C8 29.3792 8.81022 32.0623 10.2074 34.3183C10.7528 35.1989 11.3877 36.0145 12.0988 36.7512C11.1459 37.1694 10.2316 37.6566 9.36274 38.2062C3.72789 41.7703 0 47.9604 0 55C0 60.8284 2.55549 66.0746 6.63296 69.7301C7.37928 70.3992 8.17658 71.015 9.01854 71.5713C8.32246 72.298 7.72713 73.1145 7.2537 74.0005C6.45213 75.5005 6 77.1997 6 79C6 85.0751 11.1487 90 17.5 90C18.4364 90 19.3467 89.8929 20.2183 89.6909C21.4267 89.4108 22.5606 88.9481 23.5861 88.335C23.253 89.4874 23.0546 90.7 23.0098 91.9533C23.0033 92.1347 23 92.317 23 92.5C23 100.508 29.268 107 37 107C40.9145 107 44.4538 105.336 46.9944 102.654C47.709 101.899 48.3446 101.064 48.8874 100.163C49.4721 101.026 50.1762 101.801 50.976 102.466C52.8813 104.048 55.3295 105 58 105C64.0751 105 69 100.075 69 94C69 89.771 66.6135 86.0993 63.1137 84.2584ZM27.6293 46.8908C27.9657 46.1338 28.8522 45.7928 29.6092 46.1293L29 47.5C29.6092 46.1293 29.61 46.1296 29.6108 46.13L29.6124 46.1307L29.616 46.1323L29.6245 46.1362L29.6464 46.1463L29.6753 46.1599L29.7094 46.1763C29.7595 46.2009 29.8257 46.2344 29.9058 46.2776C30.0657 46.3639 30.2818 46.4892 30.5352 46.6582C31.0406 46.9951 31.7036 47.5118 32.3649 48.2466C32.9572 48.9046 33.5405 49.7302 34.0071 50.7414L34.0419 50.6854C34.6197 49.7645 35.4237 48.9152 36.5148 48.3913C37.6246 47.8584 38.9101 47.7212 40.3254 48.0357C41.1341 48.2154 41.644 49.0167 41.4643 49.8254C41.2846 50.6341 40.4833 51.144 39.6746 50.9643C38.8399 50.7788 38.2504 50.8858 37.8133 51.0957C37.3576 51.3145 36.9428 51.7065 36.5831 52.2798C35.8406 53.4633 35.5 55.1599 35.5 56.5C35.5 57.6584 35.8541 59.5 38.1708 60.6584C38.9118 61.0288 39.2121 61.9299 38.8416 62.6708C38.4712 63.4118 37.5701 63.7121 36.8292 63.3416C35.34 62.597 34.3473 61.6372 33.6931 60.6361C33.2642 61.3389 32.764 61.9111 32.2465 62.3711C31.5458 62.994 30.8446 63.3841 30.3123 63.6207C30.0452 63.7394 29.817 63.8211 29.6472 63.875C29.5622 63.902 29.4913 63.9222 29.437 63.9366C29.4099 63.9439 29.3868 63.9497 29.3681 63.9543L29.3434 63.9602L29.3335 63.9624L29.3292 63.9634L29.3273 63.9639C29.3263 63.9641 29.3254 63.9643 29 62.5L29.3254 63.9643C28.5167 64.144 27.7154 63.6341 27.5357 62.8254C27.3572 62.0218 27.8594 61.2256 28.6592 61.0392L28.664 61.0379C28.6757 61.0348 28.7015 61.0277 28.7395 61.0156C28.8158 60.9914 28.9392 60.9481 29.0939 60.8793C29.4054 60.7408 29.8292 60.506 30.2535 60.1289C31.0595 59.4124 32 58.0698 32 55.5C32 52.9162 31.0445 51.2639 30.1351 50.2534C29.6714 49.7382 29.2094 49.3799 28.8711 49.1543C28.7026 49.042 28.5672 48.9642 28.481 48.9177C28.438 48.8945 28.4075 48.8792 28.3917 48.8715L28.3802 48.866C27.6306 48.526 27.2944 47.6443 27.6293 46.8908ZM42.5 23.5C42.5 22.6716 41.8284 22 41 22C40.1716 22 39.5 22.6716 39.5 23.5C39.5 25.7312 40.0588 28.6801 42.4394 31.0607C43.618 32.2393 45.1463 32.9413 46.4113 33.4005C46.4794 33.4253 46.5472 33.4494 46.6145 33.473C45.9328 34.1432 45.3251 35.0152 45.0448 36.1362C44.7426 37.345 44.7204 38.5042 45.0664 39.6286C45.4089 40.7417 46.0736 41.6949 46.9394 42.5607C47.5252 43.1464 48.4749 43.1464 49.0607 42.5607C49.6465 41.9749 49.6465 41.0251 49.0607 40.4393C48.4265 39.8051 48.0912 39.2583 47.9337 38.7464C47.7797 38.2458 47.7575 37.655 47.9553 36.8638C48.2426 35.7146 49.4049 34.9805 50.498 34.4284C51.5936 33.875 51.7846 32.0923 50.3772 31.5274C50.0288 31.3875 49.5686 31.2515 49.1374 31.1241L49.1374 31.1241L49.0218 31.0899C48.5225 30.942 47.9857 30.7805 47.435 30.5806C46.3113 30.1727 45.2749 29.6535 44.5607 28.9393C42.9412 27.3199 42.5 25.2688 42.5 23.5Z",fill:"black",className:"fill-inherit"})]}),Nve=({width:e,height:t})=>L.jsxs("svg",{width:e,height:t,viewBox:"0 0 125 107",fill:"none",className:"fill-inherit",xmlns:"http://www.w3.org/2000/svg",children:[L.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M102.792 3H15C8.37258 3 3 8.37259 3 15V67.7053C3 74.3328 8.37258 79.7053 15 79.7053H91.7009C91.6677 80.7351 91.8982 81.7717 92.3923 82.7053L70.6679 82.7053V92.7302C70.6679 93.134 70.9511 94.0547 71.813 95.4418C72.604 96.7149 73.6307 97.9872 74.5056 98.981C76.6857 101.458 75.1319 105.755 71.4757 105.755H47.5698C43.9136 105.755 42.3597 101.458 44.5399 98.981C45.4147 97.9872 46.4414 96.7149 47.2324 95.4418C48.0943 94.0547 48.3775 93.134 48.3775 92.7302V82.7059L15 82.7053C6.71572 82.7053 0 75.9896 0 67.7053V15C0 6.71573 6.71573 0 15 0H102.792C111.077 0 117.792 6.71573 117.792 15V67.7053C117.792 73.4957 114.512 78.5198 109.707 81.0199L107.454 78.7664C111.766 76.947 114.792 72.6796 114.792 67.7053V15C114.792 8.37258 109.42 3 102.792 3ZM51.3775 82.7053H67.6679V92.7302C67.6679 94.8681 69.5363 97.6605 71.2326 99.7551L71.2431 99.7681C71.3211 99.8643 71.3987 99.959 71.4757 100.052C71.7448 100.377 72.007 100.683 72.2537 100.963C72.8463 101.637 72.3727 102.755 71.4757 102.755H47.5698C46.6728 102.755 46.1991 101.637 46.7918 100.963C47.0385 100.683 47.3006 100.377 47.5698 100.052C47.6468 99.959 47.7244 99.8643 47.8023 99.7681L47.8129 99.7551C49.5091 97.6605 51.3775 94.8681 51.3775 92.7302V82.7053Z",fill:"#100F13",className:"fill-inherit"}),L.jsx("path",{d:"M62.8037 52.4116H72.979L76.0533 47.6978H78.0287C78.2888 48.0629 78.7156 48.3009 79.198 48.3009C79.9903 48.3009 80.6326 47.6586 80.6326 46.8663C80.6326 46.074 79.9903 45.4316 79.198 45.4316C78.5523 45.4316 78.0063 45.8581 77.8263 46.4447H75.3745L74.5725 47.6744H72.6513V46.1885C73.2379 46.0084 73.6644 45.4624 73.6644 44.8168C73.6644 44.0245 73.0221 43.3822 72.2298 43.3822C71.4374 43.3822 70.7951 44.0245 70.7951 44.8168C70.7951 45.2992 71.0332 45.7259 71.3982 45.986V48.9275H73.7553L72.3002 51.1585H63.2514C63.1473 51.5974 62.9961 52.0171 62.8037 52.4116Z",fill:"#100F13",className:"fill-inherit"}),L.jsx("path",{d:"M65.6471 56.3056H71.3982V59.5119C70.9199 59.7445 70.5902 60.2351 70.5902 60.8028C70.5902 61.5951 71.2325 62.2374 72.0248 62.2374C72.8172 62.2374 73.4595 61.5951 73.4595 60.8028C73.4595 60.2351 73.1297 59.7444 72.6514 59.5118V56.3056H75.5207V53.2314H78.7268C78.9594 53.7097 79.4501 54.0395 80.0178 54.0395C80.8101 54.0395 81.4524 53.3971 81.4524 52.6048C81.4524 51.8125 80.8101 51.1702 80.0178 51.1702C79.4501 51.1702 78.9594 51.4999 78.7268 51.9783H74.2675V55.0525H71.6149L71.6082 55.0525H64.9966C65.275 55.4296 65.4962 55.8516 65.6471 56.3056Z",fill:"#100F13",className:"fill-inherit"}),L.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M91.4771 55.4913L91.4772 55.4338C91.4772 45.7448 83.6227 37.8902 73.9337 37.8902C64.2463 37.8902 56.3929 45.742 56.3901 55.4286L56.39 55.4862C56.39 65.1752 64.2445 73.0297 73.9336 73.0297C83.6209 73.0297 91.4743 65.178 91.4771 55.4913ZM59.6346 58.1033L59.6385 54.8194L61.8684 55.2695C63.014 55.5007 63.876 56.5163 63.876 57.7287C63.876 59.1143 62.7528 60.2375 61.3672 60.2375C60.8988 60.2375 60.46 60.1096 60.084 59.8854C59.8981 59.3064 59.7474 58.7115 59.6346 58.1033ZM61.0713 62.228C61.1691 62.2343 61.2678 62.2375 61.3672 62.2375C63.8574 62.2375 65.876 60.2188 65.876 57.7287C65.876 56.2713 65.1846 54.9754 64.1119 54.1512C63.5777 53.7407 62.9491 53.4473 62.2641 53.309C62.6617 52.7625 62.9703 52.1427 63.1677 51.4726C63.3296 50.9232 63.4167 50.34 63.4167 49.7357C63.4167 48.7625 63.1908 47.844 62.7905 47.0332C62.7006 46.851 62.6018 46.6743 62.4948 46.5036C63.7393 44.9209 65.3053 43.6028 67.0943 42.6478V45.5753C66.6159 45.8079 66.2862 46.2986 66.2862 46.8663C66.2862 47.6586 66.9285 48.3009 67.7209 48.3009C68.5132 48.3009 69.1555 47.6586 69.1555 46.8663C69.1555 46.2986 68.8258 45.8079 68.3474 45.5753V42.0541C70.0673 41.338 71.9543 40.9426 73.9336 40.9426C81.9657 40.9426 88.477 47.4539 88.4771 55.486C88.449 63.4942 81.9484 69.9774 73.9337 69.9774C68.3556 69.9774 63.511 66.8371 61.0713 62.228ZM60.0469 51.1517C59.8813 51.6826 59.7454 52.2265 59.641 52.7816L59.6401 53.5162L60.6468 52.1324C61.1269 51.4726 61.4167 50.6454 61.4167 49.7357C61.4167 49.5382 61.403 49.3445 61.3767 49.1555L60.0469 51.1517Z",fill:"#100F13",className:"fill-inherit"}),L.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M112.78 62.9336C112.78 68.7612 108.248 73.5304 102.516 73.9093C100.918 72.699 98.8521 72.3955 97.0192 72.9987L94.9541 70.9336H101.78C106.198 70.9336 109.78 67.3518 109.78 62.9336V16.0124C109.78 11.5942 106.198 8.01245 101.78 8.01245H16.0124C11.5941 8.01245 8.01238 11.5942 8.01238 16.0124V62.9336C8.01238 67.3518 11.5941 70.9336 16.0124 70.9336H57.6557C53.7683 66.8991 51.3777 61.4123 51.3777 55.3673C51.3777 46.217 56.8552 38.346 64.7101 34.8543C64.655 34.6432 64.5869 34.4378 64.5066 34.2392C64.4326 34.2976 64.3553 34.3519 64.2763 34.4018C63.9106 34.6328 63.4635 34.7987 62.9941 34.8593C62.0432 34.982 60.9482 34.6691 60.3155 33.5302C60.1814 33.2888 60.2683 32.9844 60.5097 32.8503C60.7511 32.7162 61.0555 32.8032 61.1896 33.0446C61.5817 33.7502 62.2287 33.9497 62.8661 33.8675C63.191 33.8256 63.4996 33.7097 63.7423 33.5563C63.9922 33.3985 64.1319 33.2278 64.1823 33.1017C64.2414 32.9541 64.3629 32.8501 64.5043 32.808C65.2581 31.6489 65.6959 30.2663 65.6959 28.7786C65.6959 24.6901 62.3815 21.3757 58.293 21.3757C57.8138 21.3757 57.3462 21.4211 56.8938 21.5075L56.829 21.5199C56.7781 21.5798 56.7123 21.6284 56.6342 21.6596C55.7545 22.0115 55.2835 22.5885 55.0891 23.3661C54.9832 23.7896 54.9406 24.2403 54.9871 24.6403C55.034 25.0427 55.1653 25.3535 55.3675 25.5556C55.5627 25.7509 55.5627 26.0675 55.3675 26.2627C55.1722 26.458 54.8556 26.458 54.6603 26.2627C54.2477 25.8501 54.0569 25.2975 53.9938 24.7559C53.9305 24.2118 53.9904 23.6377 54.1189 23.1236C54.3486 22.2046 54.8766 21.4754 55.729 20.9877C55.0876 20.461 54.2684 20.146 53.3743 20.146C51.3232 20.146 49.6605 21.8087 49.6605 23.8598C49.6605 24.0238 49.671 24.1848 49.6914 24.3424L49.9111 26.0401L48.3244 25.3976C47.7938 25.1828 47.2166 25.0648 46.611 25.0648C44.0267 25.0648 41.8724 27.2447 41.8724 30.0082C41.8724 31.3846 42.4101 32.6227 43.272 33.5157L43.3904 33.6384C43.4982 33.651 43.6027 33.6987 43.6854 33.7814C44.759 34.855 46.0475 35.2184 47.5145 34.8517C48.2784 34.6607 48.8138 34.3906 49.2252 34.0254C49.6382 33.6589 49.9597 33.167 50.249 32.4787C50.3561 32.2241 50.6492 32.1045 50.9037 32.2115C51.1583 32.3186 51.2779 32.6117 51.1709 32.8662C50.8454 33.6404 50.4496 34.2758 49.8891 34.7733C49.327 35.2722 48.6327 35.6029 47.757 35.8218C46.1534 36.2227 44.6785 35.9027 43.4465 34.9099L42.9544 35.1259C40.3708 36.2597 38.5933 38.7817 38.5933 41.6903C38.5933 44.1599 39.8728 46.3478 41.8412 47.6485L42.0192 47.7661C42.5457 47.2956 43.2822 46.9288 44.1517 46.9288C45.3558 46.9288 46.0903 47.4306 46.7597 48.1C46.9549 48.2952 46.9549 48.6118 46.7597 48.8071C46.5644 49.0023 46.2478 49.0023 46.0526 48.8071C45.4922 48.2467 44.9971 47.9288 44.1517 47.9288C43.3295 47.9288 42.6519 48.4278 42.3133 48.9358C42.2481 49.0337 42.1543 49.1011 42.0504 49.1345L42.0121 49.1745C41.4107 49.8024 41.0526 50.6277 41.0526 51.5278C41.0526 53.4243 42.673 55.0367 44.7664 55.0367C45.4989 55.0367 46.1771 54.8371 46.7481 54.4958L47.9176 53.7968C48.4359 53.0977 49.4051 52.443 50.7921 52.6742C51.0671 52.72 51.3055 52.8007 51.511 52.9063C51.468 53.3008 51.4352 53.6983 51.4129 54.0986C51.2734 53.9094 51.0412 53.7295 50.6277 53.6606C49.6332 53.4948 48.9925 53.9806 48.6666 54.4695C48.6258 54.5306 48.5739 54.5799 48.5153 54.6164L48.2218 55.6319C48.0914 56.083 48.0209 56.5627 48.0209 57.0614C48.0209 59.6851 49.9626 61.7827 52.3705 61.9883C52.4761 62.3307 52.5896 62.6695 52.711 63.0047C49.564 62.9777 47.0209 60.3272 47.0209 57.0614C47.0209 56.9005 47.0271 56.7411 47.0392 56.5835C47.0717 56.1596 47.1472 55.7483 47.2611 55.3542C46.9103 55.5639 46.5284 55.7307 46.1237 55.8469C45.6939 55.9703 45.2383 56.0367 44.7664 56.0367C42.1631 56.0367 40.0526 54.018 40.0526 51.5278C40.0526 50.7086 40.2811 49.9404 40.6803 49.2783C40.8531 48.9917 41.0578 48.7251 41.2899 48.4828C41.0091 48.2973 40.7404 48.0956 40.4852 47.8791C38.7134 46.3761 37.5933 44.1608 37.5933 41.6903C37.5933 38.7228 39.2094 36.1236 41.6297 34.6847C41.9258 34.5087 42.2339 34.35 42.5525 34.2102C42.3141 33.9632 42.0966 33.6946 41.903 33.4075C41.2534 32.4442 40.8724 31.2723 40.8724 30.0082C40.8724 26.7257 43.4417 24.0648 46.611 24.0648C46.9723 24.0648 47.3257 24.0993 47.6685 24.1655C48.0249 24.2342 48.3697 24.3371 48.6997 24.4707C48.6738 24.2707 48.6605 24.0668 48.6605 23.8598C48.6605 23.7044 48.668 23.5508 48.6827 23.3993C48.9141 21.0121 50.9263 19.146 53.3743 19.146C54.6753 19.146 55.8532 19.6731 56.7061 20.5253C57.22 20.4271 57.7505 20.3757 58.293 20.3757C61.5238 20.3757 64.3288 22.199 65.735 24.8729H68.4793C68.7119 24.3945 69.2026 24.0648 69.7702 24.0648C70.5626 24.0648 71.2049 24.7071 71.2049 25.4994C71.2049 26.2917 70.5626 26.9341 69.7702 26.9341C69.2026 26.9341 68.7119 26.6043 68.4793 26.126H66.2687C66.248 26.064 66.2267 26.0023 66.2047 25.9409C66.5227 26.8273 66.6959 27.7827 66.6959 28.7786C66.6959 30.5188 66.1669 32.1355 65.2609 33.4765C65.4147 33.7912 65.5422 34.122 65.6405 34.4657C67.5706 33.7103 69.6309 33.2146 71.7784 33.0214L71.6066 32.8893H65.6236C65.8476 32.4905 66.0401 32.0717 66.1976 31.6361H72.0328L73.7154 32.9304C73.7485 32.9303 73.7816 32.9302 73.8148 32.9302C75.1169 32.9302 76.3932 33.0411 77.6346 33.2541C77.8959 32.9013 78.3153 32.6726 78.788 32.6726C79.4932 32.6726 80.0795 33.1814 80.2 33.8518C89.4811 36.602 96.2519 45.1939 96.2519 55.3673C96.2519 60.8865 94.2591 65.9402 90.9538 69.8483L96.1069 75.0013C97.9131 74.1166 100.156 74.425 101.658 75.9267L123.583 97.8515C125.473 99.7414 125.473 102.806 123.583 104.695C121.693 106.585 118.629 106.585 116.739 104.695L94.8139 82.7706C93.4816 81.4383 93.0885 79.5224 93.6347 77.8457L88.2955 72.5065C87.7879 72.9358 87.261 73.343 86.7162 73.7265L86.9232 73.9336H86.417C82.8248 76.3766 78.4865 77.8044 73.8148 77.8044C69.143 77.8044 64.8048 76.3766 61.2126 73.9336H16.0124C9.93725 73.9336 5.01238 69.0087 5.01238 62.9336V16.0124C5.01238 9.93731 9.93725 5.01245 16.0124 5.01245H101.78C107.855 5.01245 112.78 9.93731 112.78 16.0124V62.9336ZM93.2519 55.3673C93.2519 66.1021 84.5496 74.8044 73.8148 74.8044C63.08 74.8044 54.3777 66.1021 54.3777 55.3673C54.3777 44.6325 63.08 35.9302 73.8148 35.9302C84.5496 35.9302 93.2519 44.6325 93.2519 55.3673Z",fill:"#100F13",className:"fill-inherit"}),L.jsx("path",{d:"M58.8963 78.2394C59.9344 78.2394 60.7759 77.4158 60.7759 76.3997C60.7759 75.3837 59.9344 74.5601 58.8963 74.5601C57.8582 74.5601 57.0166 75.3837 57.0166 76.3997C57.0166 77.4158 57.8582 78.2394 58.8963 78.2394Z",fill:"#100F13",className:"fill-inherit"}),L.jsx("path",{d:"M57.7895 39.6632C57.6239 39.528 57.3832 39.5099 57.196 39.6347C56.9662 39.7878 56.9041 40.0983 57.0573 40.328L57.0798 40.3613L57.1032 40.3953C57.3266 40.1462 57.5554 39.9021 57.7895 39.6632Z",fill:"#100F13",className:"fill-inherit"}),L.jsx("path",{d:"M52.4915 40.5143C52.1722 41.0231 52.0299 41.7418 52.0299 42.3051C52.0299 42.8061 52.1862 43.6114 53.1882 44.1123C53.4352 44.2358 53.5353 44.5362 53.4118 44.7832C53.2883 45.0302 52.9879 45.1303 52.741 45.0068C52.0701 44.6714 51.6544 44.2268 51.4009 43.7735C51.212 44.1303 50.9774 44.4099 50.7347 44.6257C50.458 44.8716 50.1812 45.0256 49.9715 45.1188C49.8663 45.1656 49.7768 45.1976 49.7108 45.2186C49.6777 45.229 49.6504 45.2368 49.6298 45.2423C49.6195 45.2451 49.6108 45.2473 49.6039 45.2489L49.5949 45.2511L49.5915 45.2519L49.59 45.2522L49.5887 45.2525C49.3191 45.3124 49.052 45.1424 48.9921 44.8729C48.9325 44.6047 49.1004 44.3391 49.3674 44.2773L49.3721 44.2761C49.3785 44.2744 49.3908 44.2709 49.4082 44.2654C49.4431 44.2544 49.4976 44.2351 49.5654 44.205C49.7015 44.1445 49.8858 44.0423 50.0703 43.8783C50.4251 43.5629 50.8248 42.9814 50.8248 41.8951C50.8248 40.8042 50.4201 40.1003 50.0308 39.6678C49.8332 39.4482 49.6362 39.2952 49.4911 39.1985C49.4188 39.1503 49.3602 39.1166 49.322 39.096C49.3105 39.0898 49.3009 39.0848 49.2934 39.081L49.2813 39.075L49.2744 39.0716C49.024 38.9586 48.9116 38.6643 49.0233 38.4129C49.1355 38.1606 49.431 38.0469 49.6833 38.1591L49.4802 38.616C49.6833 38.1591 49.6844 38.1595 49.6844 38.1595L49.6856 38.1601L49.6886 38.1615L49.6967 38.1652L49.7205 38.1766C49.7336 38.183 49.7498 38.1911 49.7686 38.2009L49.7969 38.216C49.8597 38.2498 49.9452 38.2994 50.0458 38.3665C50.2466 38.5003 50.5106 38.706 50.7741 38.9988C51.0493 39.3045 51.3204 39.7018 51.5182 40.2029C51.5575 40.1278 51.5995 40.0543 51.6444 39.9828C51.8729 39.6186 52.1875 39.288 52.6104 39.0849C53.0396 38.8788 53.5399 38.8238 54.0978 38.9478C54.3673 39.0077 54.5373 39.2747 54.4774 39.5443C54.4175 39.8139 54.1504 39.9838 53.8808 39.9239C53.5165 39.843 53.2482 39.888 53.0433 39.9864C52.8321 40.0878 52.6472 40.266 52.4915 40.5143Z",fill:"#100F13",className:"fill-inherit"}),L.jsx("path",{d:"M54.3992 28.2785C54.6753 28.2785 54.8992 28.5023 54.8992 28.7785C54.8992 29.5212 55.0845 30.3963 55.7775 31.0892C56.066 31.3778 56.4708 31.589 56.9044 31.7541C57.1178 31.8353 57.3293 31.9021 57.5272 31.9616C57.5783 31.977 57.6301 31.9924 57.6814 32.0075C57.8196 32.0484 57.9544 32.0883 58.0636 32.1254C58.3035 32.2068 58.4544 32.4228 58.4628 32.6587C58.471 32.8861 58.3472 33.0985 58.1423 33.206C57.712 33.4315 57.2591 33.7466 57.1387 34.2284C57.0536 34.5687 57.061 34.8326 57.1315 35.0617C57.2032 35.2945 57.3532 35.5342 57.622 35.803C57.8173 35.9983 57.8173 36.3149 57.622 36.5102C57.4268 36.7054 57.1102 36.7054 56.9149 36.5102C56.5689 36.1641 56.309 35.789 56.1757 35.3558C56.0413 34.9188 56.0487 34.4653 56.1685 33.9859C56.2964 33.4743 56.5998 33.0958 56.9208 32.8197C56.8012 32.7806 56.676 32.7371 56.5486 32.6886C56.0621 32.5034 55.5048 32.2308 55.0704 31.7964C54.1237 30.8497 53.8992 29.6753 53.8992 28.7785C53.8992 28.5023 54.123 28.2785 54.3992 28.2785Z",fill:"#100F13",className:"fill-inherit"}),L.jsx("path",{d:"M74.9057 30.6348H66.4902C66.5821 30.2275 66.6443 29.809 66.6746 29.3817H73.6526V25.5607C73.1742 25.3281 72.8445 24.8374 72.8445 24.2697C72.8445 23.4774 73.4868 22.8351 74.2791 22.8351C75.0715 22.8351 75.7138 23.4774 75.7138 24.2697C75.7138 24.8374 75.3841 25.328 74.9057 25.5606V30.6348Z",fill:"#100F13",className:"fill-inherit"})]}),Fve=({width:e,height:t})=>L.jsxs("svg",{width:e,height:t,viewBox:"0 0 94 94",fill:"none",className:"fill-inherit",xmlns:"http://www.w3.org/2000/svg",children:[L.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M68.7078 49.995C68.7651 50.3024 69.0347 50.5243 69.3474 50.5243H82.2508C83.1966 50.5243 83.8138 51.5172 83.3952 52.3654C83.3312 52.5 82.3538 54.4187 79.5706 56.7526C76.9815 58.9274 72.8324 61.4511 66.456 63.2512C66.1974 63.3242 66.0163 63.5597 66.0163 63.8284C66.0163 63.9719 65.9645 64.1106 65.8704 64.2189L60.3842 70.5405C60.0887 70.881 59.6885 71.1115 59.2451 71.1928C57.4635 71.5195 52.7804 72.3554 52.3199 72.2024C51.9481 72.0793 49.7312 69.9553 48.2236 68.4822C47.435 67.7118 46.1727 67.7118 45.3842 68.4823C43.8766 69.9555 41.6598 72.0796 41.288 72.2027C40.8256 72.3557 36.1441 71.5199 34.3629 71.1931C33.9194 71.1118 33.5191 70.8812 33.2236 70.5406L27.7397 64.2193C27.6457 64.1109 27.5939 63.9722 27.5939 63.8286C27.5939 63.5599 27.4139 63.3247 27.1553 63.2517C25.3444 62.7403 23.7113 62.1753 22.2449 61.5712C16.6922 59.2898 13.4993 56.5156 11.8216 54.6082C10.7189 53.3537 10.2676 52.4771 10.2122 52.3694L10.2103 52.3657C9.79247 51.5171 10.4101 50.5246 11.3559 50.5246H24.2596C24.5722 50.5246 24.842 50.3027 24.8991 49.9953C25.1967 48.4029 25.9108 44.6067 26.6707 40.5731C27.4168 36.6035 28.2134 32.4057 28.7077 29.8619C28.8703 29.0155 29.0007 28.3516 29.0877 27.9341C29.2182 27.2818 29.4563 26.6658 29.7744 26.1045C30.0949 25.5478 30.4932 25.0412 30.9555 24.5987C31.8756 23.7136 33.0337 23.0748 34.3064 22.7005C35.1532 22.4519 36.055 22.3218 36.9797 22.3218C38.6597 22.3218 40.4221 22.7552 42.0427 23.7134C42.9446 24.2472 43.6518 24.5826 44.2125 24.7948C44.7711 25.0047 45.1808 25.096 45.5218 25.137C45.7508 25.1643 45.9475 25.1735 46.1581 25.1735C46.2532 25.1735 46.3504 25.1714 46.452 25.1692C46.563 25.1668 46.6792 25.1643 46.8035 25.1643C47.053 25.1643 47.3414 25.1598 47.671 25.1324C47.9983 25.1004 48.369 25.048 48.7673 24.9544C49.5684 24.7673 50.4977 24.4205 51.5048 23.7498C52.3012 23.2227 53.1435 22.8372 53.995 22.5862C54.8511 22.3376 55.7186 22.2212 56.5677 22.2212C57.9617 22.2212 59.3076 22.5337 60.4954 23.1018C61.6856 23.6698 62.7293 24.4979 63.4755 25.552C63.9768 26.2524 64.3452 27.0578 64.5238 27.9339C64.6061 28.3513 64.7366 29.0152 64.9014 29.8616C65.0662 30.7102 65.2631 31.7437 65.4804 32.889C65.9177 35.1795 66.4373 37.9287 66.9362 40.5728V40.5774C67.6962 44.6064 68.4103 48.4026 68.7078 49.995ZM30.6448 33.3659C30.2099 35.654 29.688 38.4009 29.1891 41.0474C29.0371 41.8575 29.6578 42.6059 30.482 42.6059H63.1262C63.9502 42.6059 64.5741 41.8569 64.4187 41.0477C63.668 37.0781 62.8738 32.8803 62.3839 30.3479C62.2215 29.5038 62.0909 28.842 62.0108 28.4429V28.4405C61.9329 28.0618 61.7933 27.7013 61.5988 27.3613C61.4066 27.0214 61.1548 26.702 60.8504 26.4054C60.2439 25.8167 59.429 25.3445 58.509 25.0639C57.8956 24.8768 57.2386 24.7764 56.568 24.7764C55.9547 24.7764 55.3322 24.8609 54.7187 25.0411C54.1075 25.2191 53.5056 25.4929 52.9311 25.8761C51.9721 26.5149 51.0383 26.9369 50.18 27.213C49.3261 27.489 48.5457 27.6191 47.9003 27.6738C47.47 27.7148 47.097 27.7217 46.804 27.7217C46.7137 27.7205 46.6123 27.7224 46.4998 27.7245C46.3956 27.7264 46.2818 27.7286 46.1586 27.7286C45.8886 27.7286 45.5635 27.7194 45.2019 27.6738C44.8402 27.6283 44.4419 27.5484 43.9979 27.4183C43.1143 27.1581 42.0661 26.6973 40.7363 25.9125C39.5231 25.1962 38.2209 24.8767 36.9803 24.8767C35.9594 24.8767 34.9845 25.0957 34.1605 25.479C33.332 25.8623 32.6636 26.4053 32.2127 27.0417C31.9106 27.466 31.7023 27.9292 31.597 28.4402V28.4426C31.5374 28.7394 31.4513 29.1814 31.3432 29.7356C31.306 29.9267 31.2662 30.1311 31.2239 30.3476C31.1185 30.8954 30.9985 31.5211 30.8673 32.2059C30.7963 32.5762 30.722 32.9639 30.6448 33.3659ZM69.6714 59.4926C74.8373 57.4873 77.8196 55.0781 79.4378 53.3807C79.548 53.2657 79.4656 53.0795 79.3063 53.0795H16.3798C15.4237 53.0795 14.9557 54.184 15.6873 54.7997C18.1661 56.878 22.3683 59.4377 29.2371 61.1625C33.8171 62.31 39.5802 63.0858 46.8038 63.0858C57.1515 63.0858 64.5054 61.4934 69.6714 59.4926Z",fill:"#100F13",className:"fill-inherit"}),L.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M93.3038 46.7212C93.3038 72.4024 72.4851 93.2212 46.8038 93.2212C21.1226 93.2212 0.303833 72.4024 0.303833 46.7212C0.303833 21.04 21.1226 0.221191 46.8038 0.221191C72.4851 0.221191 93.3038 21.04 93.3038 46.7212ZM90.3038 46.7212C90.3038 70.7456 70.8282 90.2212 46.8038 90.2212C22.7794 90.2212 3.30383 70.7456 3.30383 46.7212C3.30383 22.6968 22.7794 3.22119 46.8038 3.22119C70.8282 3.22119 90.3038 22.6968 90.3038 46.7212Z",fill:"#100F13",className:"fill-inherit"})]}),Uve=({title:e,description:t})=>L.jsxs("div",{className:"flex flex-col gap-2 py-6 mobile:gap-2",children:[L.jsx("h2",{className:"text-sm font-bold text-white",children:e}),L.jsx("p",{className:"text-xs text-white",children:t})]}),jve=({name:e,icon:t,subContents:r})=>{const[i,n]=ne.useState(!1);return L.jsxs(Hn.div,{className:`relative overflow-hidden duration-300 ${i?"pb-10 ease-in-out duration-300 scale-105 min-h-[480px]":"min-h-[240px] ease-in-out hover:scale-105 hover:fill-accent-300 duration-300"} flex flex-col text-sm gap-2 w-full ring-1 bg-white ring-gray-400 fill-accent-50 justify-center items-start pl-2 px-8 aspect-video ease-in-out duration-300 hover:text-white mobile:pl-4 mobile:text-md tablet:pl-4 laptop:pl-8 desktop:pl-8 desktop:text-md
        before:content-[' '] before:bg-accent-500 before:min-h-0 before:absolute before:bottom-0 before:left-0 before:w-full before:ease-in-out before:duration-200 ${i?"before:h-full":"before:delay-150 before:hover:min-h-full"}
      `,children:[L.jsx("div",{className:`flex w-full h-full z-10 ${i?"items-start flex-col":"items-center"}`,children:i?r.map((s,a)=>L.jsx(Uve,{className:`${i?"opacity-100":"opacity-0"} duration-200`,title:s.title,description:s.description},a)):e}),L.jsx("span",{className:`absolute top-16 -right-[10%] z-0 ${i?"opacity-25 scale-125 ease-in-out duration-500 rotate-12":" rotate-0"} -top-[20%] -right-[30%] scale-[0.7] mobile:scale-[0.7] mobile:-right-[20%] mobile:top-[0%] tablet:top-0 tablet:-right-[30%] laptop:scale-[0.8] laptop:-right-[4rem] laptop:top-[20%]`,children:t}),L.jsx("span",{className:`absolute z-20 ${i?"text-white":""} text-xs cursor-pointer bottom-4 left-2 mobile:text-sm mobile:left-4 laptop:text-sm laptop:left-8 `,children:L.jsx("button",{onClick:()=>{n(s=>!s)},children:i?"Click to Hide <":"Click to Show >"})})]})},Vve=({children:e,content:t,parentHover:r,active:i,handleSelectActive:n,className:s=null})=>L.jsxs("div",{onClick:()=>n(t),className:`hover:pl-7 hover:grayscale-0 hover:opacity-100 hover:text-primary-300 hover:bg-black/5 text-background-dark flex flex-col px-4 py-4 cursor-pointer transition-all duration-500 ${i?"pl-7 border-accent-400 text-accent-400":r?"grayscale text-background-dark opacity-50":"grayscale-0 text-background-dark opacity-100 border-black/20 "}`,children:[L.jsxs("div",{className:"flex items-center justify-between w-full",children:[L.jsx("h2",{className:`transition-[font-size] ${i?"text-base text-accent-400 font-medium":""}`,children:t.name}),L.jsx(DI,{size:32,className:`transition-[transform] duration-700 ease-in-out ${i?"rotate-[90deg] text-accent-400":"rotate-0"}`})]}),L.jsx("div",{className:`overflow-hidden text-sm duration-1000 text-background-dark transition-[max-height] ease-in-out ${i?"max-h-[50rem]":"max-h-0"}`,children:t.content})]}),Hve=()=>{const e=[{name:"Office 365 SharePoint Development",content:"Experts in the setup and management of cloud computer services for law enforcement and private companies such as Office 365 together with SharePoint administration and management."},{name:"Anonymous Domain Name Registration",content:"Registration of anonymous domain names for our clients, law enforcement, security and investigation consultants worldwide."},{name:"Anonymous Website Hosting",content:"Hosting of pretext and websites anonymously only for our clients and industry personnel."},{name:"Covert Pretext Setups for Police and Investigative services worldwide.",content:"Setup of a complete pretext facility such as pretext website construction, hosting, business address and location services."},{name:"Covert Website Design",content:"Design and building a website to your required specifications."},{name:"Anonymous VPN and high end Proxy facility",content:"Login to our servers from any country by any device including iPhone, ipad other mobile devices and laptops. Traveling to such countries as China, Middle Eastern countries using the VPN service gives you secure access to all your data and online internet content without restriction."}],[t,r]=ne.useState(!1),[i,n]=ne.useState(e[0]),s=a=>{if(a.name===i.name)return;const o=e.findIndex(l=>l.name==a.name);n(e[o])};return L.jsx("div",{className:"z-10 flex-[1]",onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),children:L.jsx("div",{className:"flex flex-col",children:e.map((a,o)=>L.jsx(Vve,{content:a,parentHover:t,active:a.name==(i==null?void 0:i.name),handleSelectActive:s},o))})})},Gve=()=>{let e="300";const t=new Array(28),r=ne.useRef([]);function i(s){s.classList.contains("active")||!s||(s.classList.add("fill"),setTimeout(()=>{s.classList.remove("fill")},Math.random()*2*5e3))}ne.useEffect(()=>{const s=setInterval(()=>{const a=r.current[Math.floor(Math.random()*25)];i(a)},5e3);return()=>clearInterval(s)},[]);const n=[{name:"Intelligence",icon:L.jsx(kve,{width:e,height:e}),subContent:[{title:"Online Intelligence Data Collection and Analysis",description:"Unique manual online intelligence monitoring service. Intelligent intelligence protecting your products and company online. All data collected is secured and displayed within a SharePoint environment for access 24/7 with corporate visual presentations linked to the raw data collected."},{title:"Intellectual Property Protection",description:"Many global Fortune 500 companies leave their trademark, copyright and intellectual property protection in our hands. Many companies in the worldwide pharmaceutical marketplace trust us to protect them with our hands-on manual intelligence and investigative consultancy."}]},{name:"Research",icon:L.jsx(Nve,{width:e,height:e}),subContent:[{title:"Business Intelligence and Research",description:"Background checks within the geographical area of your concern involving in-depth overt and covert research being conducted resulting in fact driven reporting you can rely on."}]},{name:"Investigations",icon:L.jsx(Fve,{width:e,height:e}),subContent:[{title:"Online Investigations",description:'Dan Murdoch Risk Services has set the "industry standard" in online investigations conducting research and pretext engagement leading to undercover investigations and evidence collection on a global footing.'}]}];return L.jsxs("div",{className:"flex flex-col items-center justify-center w-full bg-white overflow-clip",children:[L.jsx(QS,{children:L.jsx("div",{className:"relative z-10 flex flex-col justify-center w-full px-6 text-white",children:L.jsxs("div",{className:"flex flex-col items-center justify-center gap-8 desktop:gap-4",children:[L.jsx("div",{className:"absolute -top-20 w-full h-screen bg-gradient-radial from-background-dark/20 to-background-dark z-[2]"}),L.jsx("div",{className:"absolute -top-20 left-0 grid w-full h-screen grid-cols-7 z-[1] ",children:t.fill(null).map((s,a)=>L.jsx("div",{ref:o=>r.current[a]=o,className:"block border border-background-light/5"},a))}),L.jsx("h1",{className:"z-10 text-xl font-bold mobile:text-center mobile:text-3xl tablet:text-center tablet:text-3xl",children:"DMRS Thailand"}),L.jsx(xs,{variant:"outline",size:"sm",className:"w-full mobile:fit tablet:w-fit z-10",children:"Services"})]})})}),L.jsx("section",{className:"navTrigger",children:L.jsxs("div",{className:"relative flex flex-col w-full gap-6 px-6 py-8 h-fit mobile:py-10 mobile:px-12 mobile:h-fit mobile:flex-col tablet:items-center tablet:px-12 tablet:flex-row laptop:p-20 laptop:gap-24 desktop:gap-20 desktop:px-24",children:[L.jsx("div",{className:"flex w-full h-[300px] bg-gray-200 rounded-tl-[2rem] rounded-br-[2rem] tablet:h-[calc((3/5)*100vh)] tablet:w-1/2 laptop:w-1/2 tablet:rounded-tl-[4rem] tablet:rounded-br-[4rem]"}),L.jsx("img",{src:"/images/thailand-map.png",alt:"",className:"absolute opacity-50 h-full brightness-90 z-0 top-0 hidden mobile:block laptop:right-[20%]"}),L.jsxs("div",{className:"z-10 flex flex-col justify-center w-full gap-4 mobile:w-full mobile:gap-4 tablet:w-1/2 tablet:gap-10",children:[L.jsxs("h2",{className:"font-bold text-md mobile:text-xl tablet:text-xl",children:["Dan Murdoch Risk Services ",L.jsx("strong",{className:"font-bold text-primary-300",children:"Thailand."})]}),L.jsxs("div",{className:"flex flex-col gap-4 text-xs mobile:text-sm laptop:text-sm",children:[L.jsxs("p",{children:[L.jsx("strong",{className:"text-accent-500",children:"DMRS"})," ",L.jsx("strong",{className:"text-primary-300",children:"Thailand"})," Co. Limited is based in Thailand with staff also in the Philippines, Australia, Hong Kong and China with trusted and verified agents in many global locations."]}),L.jsxs("p",{children:["DMRS staff are ",L.jsx("strong",{children:"trained detectives"})," and ",L.jsx("strong",{children:"intelligence analysts"})," who use both objective and subjective thinking to ",L.jsx("strong",{children:"gather online data and intelligence"})," for many Fortune 500 companies worldwide."]}),L.jsxs("p",{children:["Our facilities also offer ",L.jsx("strong",{children:"premier and innovative investigative consultancy"})," in all areas of corporate and personal requirements. DMRS is proud to be focused on the  ",L.jsx("strong",{children:"protection of patients globally"})," through our identification of risks concerned with the illicit trade in counterfeit, sub-standard and suspect medicines together with all associated risks to corporations tasked with the protection of consumers worldwide."]})]})]})]})}),L.jsxs("section",{className:"relative flex items-center w-full h-full px-6 pb-20 overflow-hidden align-middle mobile:px-6 tablet:px-12 tablet:mt-10 laptop:gap-10 desktop:px-[4.5rem]",children:[L.jsxs("div",{className:"flex flex-col justify-start w-full gap-6 h-fit",children:[L.jsxs("div",{className:"flex flex-col items-start gap-2 mobile:pl-6 tablet:pl-6 laptop:pl-12 desktop:pl-[4.5rem]",children:[L.jsx("h2",{className:"z-10 font-bold text-md mobile:text-xl laptop:text-xl",children:"Services"}),L.jsxs("p",{className:"z-10 text-xs mobile:text-sm laptop:text-sm",children:["The services DMRS offers fall into three categories ",L.jsx("strong",{children:"INTELLIGENCE"}),", ",L.jsx("strong",{children:"INVESTIGATIONS"})," and ",L.jsx("strong",{children:"RESEARCH"}),"."]})]}),L.jsx("div",{className:"flex flex-row items-start justify-start h-fit mobile:px-6 tablet:px-6 laptop:px-12 desktop:px-[4.5rem]",children:L.jsx("div",{className:"z-10 flex flex-col w-full gap-8 fill-black hover:text-secondary-200 hover:fill-secondary-200 mobile:flex mobile:flex-col tablet:grid tablet:justify-center tablet:grid-cols-2 tablet:flex-col laptop:grid-cols-2 desktop:grid-cols-3",children:n.map((s,a)=>L.jsx(jve,{name:s.name,icon:s.icon,subContents:s.subContent},a))})})]}),L.jsx("div",{className:"absolute left-0 grid w-full h-screen grid-cols-5 rounded-full -top-10 desktop:grid-cols-8",children:L.jsx(eR,{cellCount:40,cellClass:"border border-background-dark/5"})})]}),L.jsx("section",{className:"flex flex-col items-center justify-center w-full h-full gap-10 px-6 mb-10 tablet:px-12 desktop:px-[4.5rem]",children:L.jsxs("div",{className:"flex flex-col items-start gap-2 mobile:pl-5 tablet:pl-5 laptop:pl-10 desktop:pl-[4.5rem]",children:[L.jsx("h2",{className:"z-10 font-bold text-md mobile:text-xl laptop:text-xl",children:"Other Services"}),L.jsx("p",{className:"z-10 text-xs mobile:text-sm laptop:text-sm",children:"However, as an additional service to our partners, we offer further unique capabilities such as -"}),L.jsx(Hve,{})]})})]})},Wve=()=>{const e=i=>{const n=i.target.name;r(s=>({...s,[n]:i.target.value}))},[t,r]=ne.useState({name:"",email:"",message:""});return L.jsxs("div",{className:"flex flex-col navTrigger",children:[L.jsxs("div",{className:"flex min-h-[90vh] pt-20 bg-white",children:[L.jsxs("div",{className:"flex flex-col items-center justify-center flex-1 px-20",children:[L.jsxs("h2",{className:"self-start text-2xl font-bold uppercase",children:["Contact ",L.jsx("span",{className:"text-primary-300",children:"Us"})]}),L.jsx("p",{className:"text-sm",children:"If you would like to get in touch with us via email, you can use the contact form. Simply fill in your details and your message, and we'll respond as soon as possible."})]}),L.jsxs("form",{className:"flex flex-col self-center flex-1 gap-3 px-20",children:[L.jsx(fu,{className:"!ring-background-dark",label:"Name",name:"name",placeholder:"Enter your name",onInput:e,value:t.name}),L.jsx(fu,{className:"!ring-background-dark",label:"Email Address",name:"email",placeholder:"Enter your email address",onInput:e,value:t.email}),L.jsx(fu,{className:"!ring-background-dark",label:"Message",name:"message",placeholder:"Leave us a message!",onInput:e,value:t.message}),L.jsx(xs,{size:"sm",variant:"outline",children:L.jsx("a",{href:"mailto:test@gmail.com",children:"Send us a message!"})})]})]}),L.jsxs("div",{className:"relative flex items-center justify-center w-full",children:[L.jsx("h2",{className:"absolute text-lg bg-transparent",children:"Our Locations"}),L.jsx("p",{className:"absolute bottom-10 left-10 w-[35%] bg-transparent",children:"Other locations by our verified trusted partners in the global three regions the Americas, EMEA and Asia."}),L.jsx("img",{src:"./images/contact-us-map.png",alt:"",className:"w-full"})]})]})},qve=({content:e,listType:t})=>L.jsx("li",{children:L.jsx("p",{children:e})}),Xve=({content:e,subParagraph:t})=>L.jsxs("div",{className:"flex flex-col gap-6",children:[L.jsx("li",{children:L.jsx("p",{children:e})}),t?L.jsxs("ol",{className:"pl-10 list-decimal",children:[" ",t.map((r,i)=>L.jsx(qve,{content:r.content},i))," "]}):""]}),Yve=()=>{const e=[{content:"When accessing our Website, Dan Murdoch Risk Services will learn certain information about you during your visit. How we will handle information we learn about you depends upon what you do when visiting our site.If you visit our site to read or download information on our pages, we collect and store only the following information about you:",subParagraph:[{content:"The name of the domain from which you access the Internet"},{content:"The date and time you access our site"},{content:"The Internet address of the website you used to link directly to our site"},{content:"No information is stored about visitors to this site"}]},{content:"If you identify yourself by sending us an e-mail containing personal information, then the information collected will be solely used to respond to your message.The information collected is for statistical purposes. Dan Murdoch Risk Services may use software programs to create summary statistics, which are used for such purposes as assessing the number of visitors to the different sections of our site, what information is of most and least interest, determining technical design specifications, and identifying system performance or problem areas."},{content:"For site security purposes and to ensure that this service remains available to all users, Dan Murdoch Risk Services uses software programs to monitor network traffic to identify unauthorized attempts to upload or change information, or otherwise cause damage."},{content:"Dan Murdoch Risk Services will not obtain personally-identifying information about you when you visit our site, unless you choose to provide such information to us, nor will such information be sold or otherwise transferred to unaffiliated third parties without the approval of the user at the time of collection."}];return L.jsx("section",{className:"navTrigger",children:L.jsxs("div",{className:"flex bg-white flex-col w-full gap-6 px-6 py-24 h-fit mobile:py-24 mobile:p-12 mobile:h-fit mobile:flex-col tablet:p-24 tablet:flex-col laptop:px-20 laptop:py-20 laptop:gap-12 desktop:gap-10 desktop:p-36",children:[L.jsxs("div",{children:[L.jsx("h1",{className:"z-10 text-xl font-bold mobile:text-left mobile:text-2xl tablet:text-2xl",children:"PRIVACY POLICY"}),L.jsx("h2",{className:"z-10 text-sm text-accent-800 font-bold mobile:text-left mobile:text-base tablet:text-base",children:"Dan Murdoch Risk Services"})]}),L.jsx("ul",{className:"flex flex-col gap-6",children:e.map((t,r)=>L.jsx(Xve,{content:t.content,subParagraph:t.subParagraph??""},r))})]})})},Qve=({content:e,listType:t})=>L.jsx("li",{children:L.jsx("p",{children:e})}),Kve=({title:e,content:t,subParagraph:r})=>L.jsxs("div",{className:"flex flex-col gap-6",children:[L.jsxs("li",{className:"font-bold",children:[L.jsx("p",{children:e}),L.jsx("p",{className:"font-normal",children:t})]}),r?L.jsxs("ol",{className:'pl-10 list-["a."]',children:[r.map((i,n)=>L.jsx(Qve,{content:i.content},n))," "]}):""]}),Zve=()=>{const e=[{title:"User's Acknowledgment and Acceptance of Terms",content:"When accessing our Website, Dan Murdoch Risk Services will learn certain information about you during your visit. How we will handle information we learn about you depends upon what you do when visiting our site.If you visit our site to read or download information on our pages, we collect and store only the following information about you:",subParagraph:[{content:"The name of the domain from which you access the Internet"},{content:"The date and time you access our site"},{content:"The Internet address of the website you used to link directly to our site"},{content:"No information is stored about visitors to this site"}]},{title:"Description of Services",content:"If you identify yourself by sending us an e-mail containing personal information, then the information collected will be solely used to respond to your message.The information collected is for statistical purposes. Dan Murdoch Risk Services may use software programs to create summary statistics, which are used for such purposes as assessing the number of visitors to the different sections of our site, what information is of most and least interest, determining technical design specifications, and identifying system performance or problem areas."},{title:"a",content:"For site security purposes and to ensure that this service remains available to all users, Dan Murdoch Risk Services uses software programs to monitor network traffic to identify unauthorized attempts to upload or change information, or otherwise cause damage."},{title:"b",content:"Dan Murdoch Risk Services will not obtain personally-identifying information about you when you visit our site, unless you choose to provide such information to us, nor will such information be sold or otherwise transferred to unaffiliated third parties without the approval of the user at the time of collection."}];return L.jsx("section",{className:"navTrigger",children:L.jsx("section",{className:"navTrigger",children:L.jsxs("div",{className:"flex bg-white flex-col w-full gap-6 px-6 py-24 h-fit mobile:py-24 mobile:p-12 mobile:h-fit mobile:flex-col tablet:p-24 tablet:flex-col laptop:px-20 laptop:py-20 laptop:gap-12 desktop:gap-10 desktop:p-36",children:[L.jsxs("div",{children:[L.jsx("h1",{className:"z-10 text-xl font-bold mobile:text-left mobile:text-2xl tablet:text-2xl",children:"TERMS OF USE"}),L.jsx("h2",{className:"z-10 text-sm text-accent-800 font-bold mobile:text-left mobile:text-base tablet:text-base",children:"Dan Murdoch Risk Services"})]}),L.jsx("h2",{className:"z-10 text-sm font-bold mobile:text-left mobile:text-base tablet:text-base",children:"SITE TERMS AND CONDITIONS USE"}),L.jsx("ol",{className:"flex flex-col gap-6 list-decimal pl-5",children:e.map((t,r)=>L.jsx(Kve,{title:t.title,content:t.content,subParagraph:t.subParagraph??""},r))})]})})})},$ve=mF(Xb(L.jsxs(Ro,{path:"/dmrs-fe",element:L.jsx(MF,{}),children:[L.jsx(Ro,{index:!0,element:L.jsx(Dve,{})}),L.jsx(Ro,{path:"dmrs/thailand",element:L.jsx(Gve,{})}),L.jsx(Ro,{path:"dmrs/australia",element:L.jsx(zve,{})}),L.jsx(Ro,{path:"contact",element:L.jsx(Wve,{})}),L.jsx(Ro,{path:"dmrs/terms",element:L.jsx(Zve,{})}),L.jsx(Ro,{path:"dmrs/policy",element:L.jsx(Yve,{})})]}))),Jve=()=>L.jsx(aF,{router:$ve});Kw.createRoot(document.getElementById("root")).render(L.jsx(Yn.StrictMode,{children:L.jsx(Jve,{})}))});export default e0e();
